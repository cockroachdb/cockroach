# Test scenario: Low capacity stores unable to take replicas from high capacity stores.
#
# This test demonstrates that stores with low capacities cannot accept replicas
# from stores with higher capacities, even when they have lower absolute load.
# The transfers fail due to the UTILIZATION override in loadSummaryForDimension(),
# not because the target would have higher load relative to the mean.
#
# Modeled after allocbench/nodes=7/cpu=8/kv/r=95/access=skew/lbr=mmc

set-store
  store-id=1 node-id=1
  store-id=2 node-id=2
  store-id=3 node-id=3
  store-id=4 node-id=4
  store-id=5 node-id=5
  store-id=6 node-id=6
  store-id=7 node-id=7
----
node-id=1 locality-tiers=node=1
  store-id=1 attrs=
node-id=2 locality-tiers=node=2
  store-id=2 attrs=
node-id=3 locality-tiers=node=3
  store-id=3 attrs=
node-id=4 locality-tiers=node=4
  store-id=4 attrs=
node-id=5 locality-tiers=node=5
  store-id=5 attrs=
node-id=6 locality-tiers=node=6
  store-id=6 attrs=
node-id=7 locality-tiers=node=7
  store-id=7 attrs=

# High capacity stores (1000) with high load - these are overloaded
store-load-msg
  store-id=1 node-id=1 load=[900,0,0] capacity=[1000,-1,1000] secondary-load=0 load-time=0s
  store-id=2 node-id=2 load=[900,0,0] capacity=[1000,-1,1000] secondary-load=0 load-time=0s
  store-id=3 node-id=3 load=[900,0,0] capacity=[1000,-1,1000] secondary-load=0 load-time=0s
----

# Low capacity stores (500) with low absolute load but high relative utilization
store-load-msg
  store-id=4 node-id=4 load=[300,0,0] capacity=[500,500,500] secondary-load=0 load-time=0s
  store-id=5 node-id=5 load=[280,0,0] capacity=[500,500,500] secondary-load=0 load-time=0s
  store-id=6 node-id=6 load=[260,0,0] capacity=[500,500,500] secondary-load=0 load-time=0s
  store-id=7 node-id=7 load=[250,0,0] capacity=[500,500,500] secondary-load=0 load-time=0s
----

get-load-info
----
store-id=1 node-id=1 status=ok accepting all reported=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=900 node-adjusted-cpu=900 seq=1
store-id=2 node-id=2 status=ok accepting all reported=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=900 node-adjusted-cpu=900 seq=1
store-id=3 node-id=3 status=ok accepting all reported=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=900 node-adjusted-cpu=900 seq=1
store-id=4 node-id=4 status=ok accepting all reported=[cpu:300ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:300ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=300 node-adjusted-cpu=300 seq=1
store-id=5 node-id=5 status=ok accepting all reported=[cpu:280ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:280ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=280 node-adjusted-cpu=280 seq=1
store-id=6 node-id=6 status=ok accepting all reported=[cpu:260ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:260ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=260 node-adjusted-cpu=260 seq=1
store-id=7 node-id=7 status=ok accepting all reported=[cpu:250ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:250ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=250 node-adjusted-cpu=250 seq=1

# Set up ranges with replicas on high capacity stores (s1, s2, s3) that are overloaded
# Each range contributes significant CPU load
store-leaseholder-msg
store-id=1
  range-id=1 load=[200,0,0] raft-cpu=20
    store-id=1 replica-id=1 type=VOTER_FULL leaseholder=true
    store-id=2 replica-id=2 type=VOTER_FULL
    store-id=3 replica-id=3 type=VOTER_FULL
    config=num_replicas=3 constraints={} voter_constraints={}
  range-id=2 load=[200,0,0] raft-cpu=20
    store-id=1 replica-id=1 type=VOTER_FULL leaseholder=true
    store-id=2 replica-id=2 type=VOTER_FULL
    store-id=4 replica-id=4 type=VOTER_FULL
    config=num_replicas=3 constraints={} voter_constraints={}
  range-id=3 load=[200,0,0] raft-cpu=20
    store-id=1 replica-id=1 type=VOTER_FULL leaseholder=true
    store-id=3 replica-id=3 type=VOTER_FULL
    store-id=5 replica-id=5 type=VOTER_FULL
    config=num_replicas=3 constraints={} voter_constraints={}
  range-id=4 load=[200,0,0] raft-cpu=20
    store-id=2 replica-id=2 type=VOTER_FULL leaseholder=true
    store-id=3 replica-id=3 type=VOTER_FULL
    store-id=6 replica-id=6 type=VOTER_FULL
    config=num_replicas=3 constraints={} voter_constraints={}
----

get-load-info
----
store-id=1 node-id=1 status=ok accepting all reported=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=900 node-adjusted-cpu=900 seq=1
  top-k-ranges (local-store-id=1) dim=CPURate: r3 r2 r1
store-id=2 node-id=2 status=ok accepting all reported=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=900 node-adjusted-cpu=900 seq=1
  top-k-ranges (local-store-id=1) dim=CPURate: r2 r1
store-id=3 node-id=3 status=ok accepting all reported=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=900 node-adjusted-cpu=900 seq=1
  top-k-ranges (local-store-id=1) dim=CPURate: r3 r1
store-id=4 node-id=4 status=ok accepting all reported=[cpu:300ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:300ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=300 node-adjusted-cpu=300 seq=1
  top-k-ranges (local-store-id=1) dim=WriteBandwidth: r2
store-id=5 node-id=5 status=ok accepting all reported=[cpu:280ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:280ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=280 node-adjusted-cpu=280 seq=1
  top-k-ranges (local-store-id=1) dim=WriteBandwidth: r3
store-id=6 node-id=6 status=ok accepting all reported=[cpu:260ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:260ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=260 node-adjusted-cpu=260 seq=1
store-id=7 node-id=7 status=ok accepting all reported=[cpu:250ns/s, write-bandwidth:0 B/s, byte-size:0 B] adjusted=[cpu:250ns/s, write-bandwidth:0 B/s, byte-size:0 B] node-reported-cpu=250 node-adjusted-cpu=250 seq=1

# Try to rebalance from overloaded high capacity store to low capacity stores.
#
# Cluster means (from output below): cpu=541, capacity=714, utilization=75.8%
#
# Current utilization of stores:
# - s1: 900/1000 = 90%
# - s2: 900/1000 = 90%
# - s3: 900/1000 = 90%
# - s4: 300/500 = 60%
# - s5: 280/500 = 56%
# - s6: 260/500 = 52%
# - s7: 250/500 = 50%
#
# Lease transfers add delta of 180 CPU (range load 200 minus raft-cpu 20).
# Replica transfers add delta of 200 CPU (full range load since leaseholder moves too).
#
# Example: transferring r1 replica to s7 (from log lines 297-308):
# - s7 current load: 250
# - Delta: 200 (full range load including raft-cpu since leaseholder moves too)
# - With 1.1x safety margin: 200 * 1.1 = 220 (see loadMultiplierForAddition)
# - s7 load after transfer: 250 + 220 = 470
# - s7 new utilization: 470/500 = 94%
# - s1 load after transfer: 700
#
# KEY INSIGHT: The transfer fails due to UTILIZATION, not mean comparison.
#
# Mean comparison (fractionAbove = load/meanLoad - 1):
#   s7 after transfer: 470/541 - 1 = -0.13 → would be "loadLow" (< -0.1 threshold)
#
# But utilization override kicks in (see loadSummaryForDimension):
#   meanUtil*1.1 = 0.758*1.1 = 0.83 < fractionUsed (0.94)
#   Since fractionUsed >= 0.9 → overloadUrgent
#
# So even though s7 (470 CPU) would have LOWER absolute load than s1 (700 CPU)
# after the transfer, and lower load relative to the mean, the HIGH UTILIZATION
# (94%) triggers the utilization override, making s7 overloadUrgent.
rebalance-stores store-id=1 max-range-move-count=999 fraction-pending-decrease-threshold=1.0
----
[mmaid=1] rebalanceStores begins
[mmaid=1] cluster means: (stores-load [cpu:541ns/s, write-bandwidth:0 B/s, byte-size:0 B]) (stores-capacity [cpu:714ns/s, write-bandwidth:unknown/s, byte-size:714 B]) (nodes-cpu-load 541) (nodes-cpu-capacity 714)
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] evaluating s1: node load overloadSlow, store load overloadSlow, worst dim CPURate
[mmaid=1] overload-continued s1 ((store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))) - within grace period
[mmaid=1] store s1 was added to shedding store list
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] evaluating s2: node load overloadSlow, store load overloadSlow, worst dim CPURate
[mmaid=1] overload-continued s2 ((store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))) - within grace period
[mmaid=1] store s2 was added to shedding store list
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] evaluating s3: node load overloadSlow, store load overloadSlow, worst dim CPURate
[mmaid=1] overload-continued s3 ((store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))) - within grace period
[mmaid=1] store s3 was added to shedding store list
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] evaluating s4: node load loadLow, store load loadNormal, worst dim WriteBandwidth
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] evaluating s5: node load loadLow, store load loadNormal, worst dim WriteBandwidth
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] evaluating s6: node load loadLow, store load loadNormal, worst dim WriteBandwidth
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] evaluating s7: node load loadLow, store load loadNormal, worst dim WriteBandwidth
[mmaid=1] start processing shedding store s1: cpu node load overloadSlow, store load overloadSlow, worst dim CPURate
[mmaid=1] top-K[CPURate] ranges for s1 with lease on local s1: r3:[cpu:200ns/s, write-bandwidth:0 B/s, byte-size:0 B] r2:[cpu:200ns/s, write-bandwidth:0 B/s, byte-size:0 B] r1:[cpu:200ns/s, write-bandwidth:0 B/s, byte-size:0 B]
[mmaid=1] local store s1 is CPU overloaded (overloadSlow >= overloadSlow), attempting lease transfers first
[mmaid=1] considering lease-transfer r3 from s1: candidates are [3 5]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] candidate store 3 was discarded due to (nls=false overloadDim=true pending_thresh=false): sls=(store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))
[mmaid=1] sortTargetCandidateSetAndPick: candidates: s5(SLS:loadNormal, overloadedDimLoadSummary:loadLow), overloadedDim:CPURate, picked s5
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] cannot add load from n1s1 to n5s5 for r3 due to ‹×›: delta([cpu:180ns/s, write-bandwidth:0 B/s, byte-size:0 B]) targetSLS[(store=overloadUrgent worst=CPURate cpu=overloadUrgent writes=loadNormal bytes=loadNormal node=overloadUrgent frac_pending=0.00,0.00(true))] srcSLS[(store=loadNormal worst=CPURate cpu=loadNormal writes=loadNormal bytes=loadNormal node=loadNormal frac_pending=0.00,0.00(true))]
[mmaid=1] considering lease-transfer r2 from s1: candidates are [2 4]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] candidate store 2 was discarded due to (nls=false overloadDim=true pending_thresh=false): sls=(store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))
[mmaid=1] sortTargetCandidateSetAndPick: candidates: s4(SLS:loadNormal, overloadedDimLoadSummary:loadLow), overloadedDim:CPURate, picked s4
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] cannot add load from n1s1 to n4s4 for r2 due to ‹×›: delta([cpu:180ns/s, write-bandwidth:0 B/s, byte-size:0 B]) targetSLS[(store=overloadUrgent worst=CPURate cpu=overloadUrgent writes=loadNormal bytes=loadNormal node=overloadUrgent frac_pending=0.00,0.00(true))] srcSLS[(store=loadNormal worst=CPURate cpu=loadNormal writes=loadNormal bytes=loadNormal node=loadNormal frac_pending=0.00,0.00(true))]
[mmaid=1] considering lease-transfer r1 from s1: candidates are [2 3]
[mmaid=1] load summary for dim=CPURate (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] result(failed): skipping r1 since store not overloaded relative to candidates
[mmaid=1] attempting to shed replicas next
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] considering replica-transfer r3 from s1: store load [cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B]
[mmaid=1] candidates are:
[mmaid=1]  s2: (store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))
[mmaid=1]  s4: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1]  s6: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1]  s7: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1] discarding candidates with higher load than lowestLoadSet(‹×›):  s2(SLS:overloadSlow, overloadedDimLoadSummary:overloadSlow), overloadedDim:CPURate
[mmaid=1] sortTargetCandidateSetAndPick: candidates: s4(SLS:loadNormal, overloadedDimLoadSummary:loadLow) s6(SLS:loadNormal, overloadedDimLoadSummary:loadLow) s7(SLS:loadNormal, overloadedDimLoadSummary:loadLow), overloadedDim:CPURate, picked s6
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] cannot add load from n1s1 to n6s6 for r3 due to ‹×›: delta([cpu:200ns/s, write-bandwidth:0 B/s, byte-size:0 B]) targetSLS[(store=overloadUrgent worst=CPURate cpu=overloadUrgent writes=loadNormal bytes=loadNormal node=overloadUrgent frac_pending=0.00,0.00(true))] srcSLS[(store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] considering replica-transfer r2 from s1: store load [cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B]
[mmaid=1] candidates are:
[mmaid=1]  s3: (store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))
[mmaid=1]  s5: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1]  s6: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1]  s7: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1] discarding candidates with higher load than lowestLoadSet(‹×›):  s3(SLS:overloadSlow, overloadedDimLoadSummary:overloadSlow), overloadedDim:CPURate
[mmaid=1] sortTargetCandidateSetAndPick: candidates: s5(SLS:loadNormal, overloadedDimLoadSummary:loadLow) s6(SLS:loadNormal, overloadedDimLoadSummary:loadLow) s7(SLS:loadNormal, overloadedDimLoadSummary:loadLow), overloadedDim:CPURate, picked s6
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] cannot add load from n1s1 to n6s6 for r2 due to ‹×›: delta([cpu:200ns/s, write-bandwidth:0 B/s, byte-size:0 B]) targetSLS[(store=overloadUrgent worst=CPURate cpu=overloadUrgent writes=loadNormal bytes=loadNormal node=overloadUrgent frac_pending=0.00,0.00(true))] srcSLS[(store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): loadLow, reason: ‹×› [‹×›]
[mmaid=1] considering replica-transfer r1 from s1: store load [cpu:900ns/s, write-bandwidth:0 B/s, byte-size:0 B]
[mmaid=1] candidates are:
[mmaid=1]  s4: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1]  s5: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1]  s6: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1]  s7: (store=loadNormal worst=WriteBandwidth cpu=loadLow writes=loadNormal bytes=loadNormal node=loadLow frac_pending=0.00,0.00(true))
[mmaid=1] sortTargetCandidateSetAndPick: candidates: s4(SLS:loadNormal, overloadedDimLoadSummary:loadLow) s5(SLS:loadNormal, overloadedDimLoadSummary:loadLow) s6(SLS:loadNormal, overloadedDimLoadSummary:loadLow) s7(SLS:loadNormal, overloadedDimLoadSummary:loadLow), overloadedDim:CPURate, picked s7
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadUrgent, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=WriteBandwidth (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=ByteSize (‹×›): loadNormal, reason: ‹×› [‹×›]
[mmaid=1] load summary for dim=CPURate (‹×›): overloadSlow, reason: ‹×› [‹×›]
[mmaid=1] cannot add load from n1s1 to n7s7 for r1 due to ‹×›: delta([cpu:200ns/s, write-bandwidth:0 B/s, byte-size:0 B]) targetSLS[(store=overloadUrgent worst=CPURate cpu=overloadUrgent writes=loadNormal bytes=loadNormal node=overloadUrgent frac_pending=0.00,0.00(true))] srcSLS[(store=overloadSlow worst=CPURate cpu=overloadSlow writes=loadNormal bytes=loadNormal node=overloadSlow frac_pending=0.00,0.00(true))]
[mmaid=1] start processing shedding store s2: cpu node load overloadSlow, store load overloadSlow, worst dim CPURate
[mmaid=1] top-K[CPURate] ranges for s2 with lease on local s1: r2:[cpu:20ns/s, write-bandwidth:0 B/s, byte-size:0 B] r1:[cpu:20ns/s, write-bandwidth:0 B/s, byte-size:0 B]
[mmaid=1] skipping remote store s2: in lease shedding grace period
[mmaid=1] start processing shedding store s3: cpu node load overloadSlow, store load overloadSlow, worst dim CPURate
[mmaid=1] top-K[CPURate] ranges for s3 with lease on local s1: r3:[cpu:20ns/s, write-bandwidth:0 B/s, byte-size:0 B] r1:[cpu:20ns/s, write-bandwidth:0 B/s, byte-size:0 B]
[mmaid=1] skipping remote store s3: in lease shedding grace period
[mmaid=1] rebalancing pass summary [local=s1]:
	overloaded:
		lease-grace: [s2, s3]
		short: [s1]
	failure: [{s1, total: 6, no-cand-to-accept-load:5, not-overloaded:1}]
	no-ranges-evaluated: [s2, s3]
pending(0)
