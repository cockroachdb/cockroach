# Empty constraints - only synthesized empty constraint.
dedup num-replicas=3 num-voters=0
----
 num-replicas=3 num-voters=3

# Single constraint - no combining needed.
dedup num-replicas=3 num-voters=0
constraint num-replicas=3 +region=us-west-1
----
 num-replicas=3 num-voters=3
 constraints:
   +region=us-west-1:3

# Dedup duplicate constraints.
# [+region=us-west-1]: 1 + [+region=us-west-1]: 1 => [+region=us-west-1]: 2
dedup num-replicas=3 num-voters=1
constraint num-replicas=1 +region=us-west-1
constraint num-replicas=1 +region=us-west-1
----
 num-replicas=3 num-voters=1
 constraints:
   +region=us-west-1:2

# Dedup empty constraints from user input and synthesized.
# User specifies [:]:1, synthesis adds [:]:2 => dedupd [:]:3
dedup num-replicas=3 num-voters=0
constraint num-replicas=1
----
 num-replicas=3 num-voters=3
 constraints:
   :1

# No duplicates - different constraints remain separate.
dedup num-replicas=5 num-voters=0
constraint num-replicas=1 +region=us-west-1
constraint num-replicas=2 +region=us-east-1
----
 num-replicas=5 num-voters=5
 constraints:
   +region=us-west-1:1
   +region=us-east-1:2

# Multiple constraints in conjunction - duplicates dedup.
dedup num-replicas=5 num-voters=0
constraint num-replicas=1 +region=us-west-1 +zone=a
constraint num-replicas=2 +region=us-west-1 +zone=a
----
 num-replicas=5 num-voters=5
 constraints:
   +region=us-west-1,+zone=a:3

# Required vs prohibited not dedup - different constraint types.
dedup num-replicas=3 num-voters=0
constraint num-replicas=1 +region=us-west-1
constraint num-replicas=1 -region=us-west-1
----
 num-replicas=3 num-voters=3
 constraints:
   +region=us-west-1:1
   -region=us-west-1:1

# Three duplicates dedup: 1 + 2 + 1 = 4.
dedup num-replicas=5 num-voters=0
constraint num-replicas=1 +region=us-west-1
constraint num-replicas=2 +region=us-west-1
constraint num-replicas=1 +region=us-west-1
----
 num-replicas=5 num-voters=5
 constraints:
   +region=us-west-1:4

# Voter constraints - duplicates dedupd. Normalization also narrows the
# all-replica constraints based on voter constraints,
dedup num-replicas=5 num-voters=3
constraint num-replicas=5
voter-constraint num-replicas=1 +region=us-west-1
voter-constraint num-replicas=1 +region=us-west-1
----
 num-replicas=5 num-voters=3
 constraints:
   :5
 voter-constraints:
   +region=us-west-1:2

# Empty voter constraints dedupd (the case from EdgeCases)
# User specifies [:]:1, synthesis adds [:]:2 => dedupd [:]:3
dedup num-replicas=5 num-voters=3
voter-constraint num-replicas=1
----
 num-replicas=5 num-voters=3
 voter-constraints:
   :1
