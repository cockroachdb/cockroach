gen_cluster nodes=5
----

gen_ranges ranges=500 bytes=300000000
----

gen_load rate=500 max_block=128000 min_block=128000
----

set_capacity store=5 capacity=45000000000
----

eval duration=30m seed=42
----
OK

# Plot the replicas over time per store. With a steady state of writes, we will
# repeatedly hit the disk fullness threshold which causes shedding replicas on
# store 5. This is shown below as it sheds replicas.
plot stat=replicas
----
----

 366 ┤       ╭───╮ ╭╮╭╮─╭╮╭╭╮╭╮╭─╮╭─╮╭──────╮╭╭╮─╭───────────╮╭────────╮╭────────────
 346 ┤   ╭╭──╯╯╭─────╯╰─╯╰─╯╰╯╰───╯╯╰╯───╯╯╰╰─╯╰─╯╯╯╰╯╰╯╰╯╰╯╯╰╯╰╯╰─╯   ╰╯╰─╯  ╰╯
 326 ┤ ╭──╭────╯
 306 ┼╮───╯
 285 ┤╰╮
 265 ┤ │
 245 ┤ ╰╮
 225 ┤  ╰╮
 205 ┤   ╰╮
 185 ┤    │
 165 ┤    ╰─╮
 145 ┤      │
 124 ┤      ╰╮
 104 ┤       ╰─────────────────────╮╭╮
  84 ┤                             ╰╯╰────────────────────────────╮╭╮
  64 ┤                                                            ╰╯╰────────────────
                                          replicas
----
----

# Plot the % of disk storage capacity used. We should see s5 hovering right
# around 92.5-95% (the storage capacity threshold value).
plot stat=disk_fraction_used
----
----

 2.50 ┼╮
 2.33 ┤╰╮
 2.17 ┤ ╰╮
 2.00 ┤  │
 1.83 ┤  ╰╮
 1.67 ┤   ╰╮
 1.50 ┤    ╰╮
 1.33 ┤     ╰╮
 1.17 ┤      ╰╮
 1.00 ┤       ╰─────╮╭───╮╭─────────╮╭────╮╭─╮╭───────────────────────────╮╭──────────
 0.83 ┤             ╰╯   ╰╯         ╰╯    ╰╯ ╰╯                           ╰╯
 0.67 ┤
 0.50 ┤
 0.33 ┤
 0.17 ┤
 0.00 ┼───────────────────────────────────────────────────────────────────────────────
                                      disk_fraction_used
----
----
