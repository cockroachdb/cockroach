skip_under_ci
----

gen_cluster nodes=5
----

gen_ranges ranges=500 placement_type=skewed
----

set_capacity store=5 io_threshold=1
----

assertion type=stat stat=replicas stores=(5) exact_bound=0 ticks=5
----

eval duration=10m seed=42
----
failed assertion sample 1
  stat=replicas value=(=0.00) ticks=5
	store=5 stat=158.00
	store=5 stat=158.00
	store=5 stat=158.00
	store=5 stat=158.00
	store=5 stat=158.00
	store=5 stat=158.00

# Expect s5 to get no replicas due to IO overload. The plot below should show a
# solid line at 0, which will be s5's replica count.
plot stat=replicas
----
initial store values: [s1=500, s2=438, s3=248, s4=156, s5=158] (stddev=143.28, mean=300.00, sum=1500)
last store values: [s1=341, s2=328, s3=337, s4=336, s5=158] (stddev=71.13, mean=300.00, sum=1500)
example_io_overload_1_replicas.png (ff4dd250fe784cc7)

plot stat=leases
----
initial store values: [s1=250, s2=125, s3=62, s4=31, s5=32] (stddev=82.41, mean=100.00, sum=500)
last store values: [s1=170, s2=105, s3=105, s4=105, s5=15] (stddev=49.40, mean=100.00, sum=500)
example_io_overload_1_leases.png (7b5ec504a7546805)
