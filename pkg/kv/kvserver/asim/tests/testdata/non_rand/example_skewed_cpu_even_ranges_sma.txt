skip_under_ci
----

gen_cluster nodes=9 node_cpu_rate_capacity=5000000000
----

# The placement will be skewed, s.t. n1/s1, n2/s2 and n3/s3 will have all the
# replicas initially and n1/s1 will have every lease. Each range is initially
# 256 MiB.
gen_ranges ranges=36 min_key=1 max_key=10000 placement_type=replica_placement bytes=268435456
{s1,s2,s3}:1
----
{s1:*,s2,s3}:1

# 5ms of request CPU per access and 500Âµs of raft CPU per write @ 1000/s.
gen_load rate=1000 rw_ratio=0.95 min_block=100 max_block=100 request_cpu_per_access=5000000 raft_cpu_per_write=500000 min_key=1 max_key=10000
----

# Almost empty workload, which generates no CPU and small amount of writes
# over the second half of the keyspace, scattered over s4-s9.
gen_ranges ranges=72 min_key=10001 max_key=20000 placement_type=replica_placement bytes=268435456
{s4,s5,s6}:1
{s7,s8,s9}:1
----
{s4:*,s5,s6}:1
{s7:*,s8,s9}:1

gen_load rate=1 rw_ratio=0 min_block=1 max_block=1 min_key=10001 max_key=20000
----

setting rebalance_mode=2 replicate_queue_enabled=false lease_queue_enabled=false split_queue_enabled=false rebalance_objective=1
----

eval duration=25m samples=1 seed=42
----
default: OK

print
----
skipped


plot stat=cpu sample=1
----
skipped

plot stat=leases sample=1
----
skipped

plot stat=replicas
----
skipped

plot stat=write_bytes_per_second
----
skipped
