skip_under_ci
----

gen_cluster nodes=10 node_cpu_rate_capacity=800000
----
WARNING: node CPU capacity of â‰ˆ0.00 cores is likely accidental

# Set the rebalance mode to use the mma store rebalancer and disable the lease
# and replicate queues so that only the mma store rebalancer is moving replicas
# or leases.
setting split_queue_enabled=false
----

# This workload will be initially evenly distributed over the cluster.
gen_ranges ranges=100 min_key=0 max_key=10000
----

gen_load rate=5000 rw_ratio=0.95 min_block=100 max_block=100 request_cpu_per_access=100 raft_cpu_per_write=20 min_key=0 max_key=10000
----

# Another workload is added over the second half of the keyspace, which is initially
# only on s1-s3.
gen_ranges ranges=50 min_key=10001 max_key=20000 placement_type=skewed
----

gen_load rate=5000 rw_ratio=0.95 min_block=128 max_block=128 request_cpu_per_access=100000 raft_cpu_per_write=20000 min_key=10001 max_key=20000
----

eval duration=15m samples=1 seed=42 cfgs=(mma-only) metrics=(cpu,write_bytes_per_second,replicas,leases)
----
cpu#1: last:  [s1=54846934, s2=52921485, s3=51803135, s4=51267081, s5=50804428, s6=50881755, s7=50647282, s8=50525189, s9=50888708, s10=50590849] (stddev=1308023.95, mean=51517684.60, sum=515176846)
cpu#1: thrashing: [max(s5)=(freq=922, mag=1.56) (s1=(freq=897, mag=3.14), s2=(freq=896, mag=3.14), s3=(freq=895, mag=2.95), s4=(freq=885, mag=1.68), s5=(freq=922, mag=1.56), s6=(freq=903, mag=1.67), s7=(freq=900, mag=2.34), s8=(freq=896, mag=2.26), s9=(freq=900, mag=2.56), s10=(freq=913, mag=2.09))]
leases#1: first: [s1=37, s2=22, s3=14, s4=13, s5=11, s6=11, s7=10, s8=11, s9=10, s10=11] (stddev=8.07, mean=15.00, sum=150)
leases#1: last:  [s1=15, s2=15, s3=15, s4=16, s5=15, s6=15, s7=15, s8=15, s9=14, s10=15] (stddev=0.45, mean=15.00, sum=150)
leases#1: thrashing: [max(s1)=(freq=22, mag=0.98) (s1=(freq=22, mag=0.98), s2=(freq=20, mag=1.21), s3=(freq=10, mag=0.66), s4=(freq=4, mag=0.25), s5=(freq=0, mag=0.00), s6=(freq=0, mag=0.00), s7=(freq=0, mag=0.00), s8=(freq=2, mag=0.14), s9=(freq=2, mag=0.16), s10=(freq=0, mag=0.00))]
replicas#1: first: [s1=80, s2=70, s3=51, s4=42, s5=37, s6=35, s7=34, s8=33, s9=34, s10=34] (stddev=16.02, mean=45.00, sum=450)
replicas#1: last:  [s1=80, s2=59, s3=47, s4=42, s5=38, s6=38, s7=36, s8=36, s9=38, s10=36] (stddev=13.51, mean=45.00, sum=450)
replicas#1: thrashing: [max(s2)=(freq=18, mag=0.29) (s1=(freq=0, mag=0.00), s2=(freq=18, mag=0.29), s3=(freq=8, mag=0.16), s4=(freq=2, mag=0.05), s5=(freq=0, mag=0.00), s6=(freq=0, mag=0.00), s7=(freq=0, mag=0.00), s8=(freq=2, mag=0.06), s9=(freq=0, mag=0.00), s10=(freq=0, mag=0.00))]
write_bytes_per_second#1: last:  [s1=39525, s2=26018, s3=18332, s4=15205, s5=12566, s6=12630, s7=11413, s8=11354, s9=12670, s10=11323] (stddev=8639.53, mean=17103.60, sum=171036)
write_bytes_per_second#1: thrashing: [max(s6)=(freq=930, mag=1.36) (s1=(freq=906, mag=1.49), s2=(freq=913, mag=2.83), s3=(freq=902, mag=2.84), s4=(freq=900, mag=2.56), s5=(freq=908, mag=2.24), s6=(freq=930, mag=1.36), s7=(freq=908, mag=1.38), s8=(freq=872, mag=1.09), s9=(freq=888, mag=1.67), s10=(freq=921, mag=1.53))]
artifacts[mma-only]: 898f82bb7ceb21ad
