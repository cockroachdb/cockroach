# LogicTest: multiregion-9node-3region-3azs multiregion-9node-3region-3azs-vec-off

statement error PLACEMENT requires that the cluster setting sql.defaults.experimental_domiciling is enabled
CREATE DATABASE no_cluster_setting PRIMARY REGION "ca-central-1" REGIONS "ap-southeast-2", "us-east-1" PLACEMENT RESTRICTED

statement ok
CREATE DATABASE to_be_altered PRIMARY REGION "ca-central-1" REGIONS "ap-southeast-2", "us-east-1"

statement error ALTER DATABASE PLACEMENT requires that the cluster setting sql.defaults.experimental_domiciling is enabled
ALTER DATABASE to_be_altered SET PLACEMENT RESTRICTED

statement ok
SET CLUSTER SETTING sql.defaults.experimental_domiciling.enabled = true

statement ok
SET experimental_enable_domiciling = true;

statement error PLACEMENT RESTRICTED can only be used with SURVIVE ZONE FAILURE
CREATE DATABASE region_survivable_strict PRIMARY REGION "ca-central-1" REGIONS "ap-southeast-2", "us-east-1" SURVIVE REGION FAILURE PLACEMENT RESTRICTED

statement ok
CREATE DATABASE zone_survivable_strict PRIMARY REGION "ca-central-1" REGIONS "ap-southeast-2", "us-east-1" PLACEMENT RESTRICTED

statement error a region-survivable database cannot also have a restricted placement policy
ALTER DATABASE zone_survivable_strict SURVIVE REGION FAILURE

statement ok
CREATE DATABASE region_survivable_default PRIMARY REGION "ca-central-1" REGIONS "ap-southeast-2", "us-east-1" SURVIVE REGION FAILURE

statement error a region-survivable database cannot also have a restricted placement policy
ALTER DATABASE region_survivable_default SET PLACEMENT RESTRICTED
