# LogicTest: local-opt

statement ok
CREATE TABLE partitioned (
    planet STRING, region STRING, subregion STRING, val INT8,
    PRIMARY KEY (planet, region, subregion, val)
    )
  PARTITION BY LIST (planet, region, subregion) (
      PARTITION westcoast VALUES IN (('earth', 'us', 'seatle'), ('earth', 'us', 'cali')),
      PARTITION eu VALUES IN (('earth', 'eu', DEFAULT)),
      PARTITION us VALUES IN (('earth', 'us', DEFAULT)),
      PARTITION earth VALUES IN (('earth', DEFAULT, DEFAULT)),
      PARTITION mars VALUES IN (('mars', DEFAULT, DEFAULT)),
      PARTITION jupiter VALUES IN (('jupiter', DEFAULT, DEFAULT))
      )

statement ok
insert into partitioned values ('earth', 'us', 'seatle', 1);

statement ok
insert into partitioned values ('earth', 'us', 'cali', 2);

statement ok
insert into partitioned values ('earth', 'us', 'cali', 3);

statement ok
insert into partitioned values ('earth', 'eu', '', 4);

statement ok
insert into partitioned values ('mars', '', '', 5);

statement ok
insert into partitioned values ('jupiter', '', '', 6);

statement ok
insert into partitioned values ('jupiter', 'titan', '', 7);

query TTTI
select * from partitioned where val < 7
----
earth    eu  ·       4
earth    us  cali    2
earth    us  cali    3
earth    us  seatle  1
jupiter  ·   ·       6
mars     ·   ·       5

query T
EXPLAIN (OPT, VERBOSE) select * from partitioned where val < 7
----
select
 ├── columns: planet:1 region:2 subregion:3 val:4
 ├── stats: [rows=333.333333, distinct(1)=98.265847, null(1)=0, distinct(2)=98.265847, null(2)=0, distinct(3)=98.265847, null(3)=0, distinct(4)=33.3333333, null(4)=0]
 ├── cost: 390.02
 ├── key: (1-4)
 ├── prune: (1-3)
 ├── scan partitioned
 │    ├── columns: planet:1 region:2 subregion:3 val:4
 │    ├── constraint: /1/2/3/4: [ - /'earth'/'eu') [/'earth'/'eu' - /'earth'/'eu'] [/'earth'/e'eu\x00' - /'earth'/'us'/'cali') [/'earth'/'us'/'cali' - /'earth'/'us'/'cali'/6] [/'earth'/'us'/e'cali\x00' - /'earth'/'us'/'seatle') [/'earth'/'us'/'seatle' - /'earth'/'us'/'seatle'/6] [/'earth'/'us'/e'seatle\x00' - /'jupiter') [/'jupiter' - /'jupiter'] [/e'jupiter\x00' - /'mars') [/'mars' - /'mars'] [/e'mars\x00' - ]
 │    ├── stats: [rows=333.333333, distinct(1)=33.3333333, null(1)=0, distinct(2)=100, null(2)=0, distinct(3)=100, null(3)=0, distinct(4)=100, null(4)=0]
 │    ├── cost: 386.676667
 │    └── key: (1-4)
 └── filters
      └── val < 7 [outer=(4), constraints=(/4: (/NULL - /6]; tight)]
