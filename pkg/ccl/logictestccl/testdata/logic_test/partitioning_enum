
# Enums are not supported as the values for partitioning as of 20.2 because of
# unfortunate interactions during validation. Assert that that is true.

statement ok
CREATE TYPE places AS ENUM ('us', 'eu', 'ap');

statement ok
CREATE TABLE partitioned_table (
    place places, id INT8,
    PRIMARY KEY (place, id)
)
    PARTITION BY LIST (place)
        (
            PARTITION us VALUES IN ('us'),
            PARTITION eu VALUES IN ('eu')
        );

statement ok
SELECT * FROM crdb_internal.tables

statement ok
CREATE TABLE partitioned_table_2 (
    place places, id INT8,
    PRIMARY KEY (place, id)
);

statement ok
ALTER TABLE partitioned_table_2 PARTITION BY LIST (place)
        (
            PARTITION us VALUES IN ('us'),
            PARTITION eu VALUES IN ('eu')
        );

statement ok
SELECT * FROM crdb_internal.tables


statement ok
CREATE TABLE partitioned_table_3 (
    place places, id INT8,
    PRIMARY KEY (place, id)
);

# Ensure that partition validation occurs at write time.

statement error partitions eu and us overlap
ALTER TABLE partitioned_table_3 PARTITION BY RANGE (place)
        (
            PARTITION eu VALUES FROM (MINVALUE) TO ('eu'),
            PARTITION us VALUES FROM ('us') TO (MAXVALUE)
        );

statement ok
SELECT * FROM crdb_internal.tables

