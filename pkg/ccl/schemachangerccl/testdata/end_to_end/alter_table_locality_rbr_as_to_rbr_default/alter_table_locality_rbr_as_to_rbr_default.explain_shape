/* setup */
CREATE DATABASE multiregion_db PRIMARY REGION "us-east1" REGIONS "us-east2", "us-east3";
USE multiregion_db;
CREATE TABLE multiregion_db.public.t (  
  pk INT PRIMARY KEY,
  i INT NOT NULL,
  cr crdb_internal_region NOT NULL DEFAULT 'us-east1',
  INDEX idx(i)
) LOCALITY REGIONAL BY ROW AS cr;

/* test */
EXPLAIN (DDL, SHAPE) ALTER TABLE multiregion_db.public.t SET LOCALITY REGIONAL BY ROW;
----
Schema change plan for ALTER TABLE ‹multiregion_db›.‹public›.‹t› SET LOCALITY REGIONAL BY ROW;
 ├── execute 2 system table mutations transactions
 ├── backfill using primary index t_pkey- in relation t
 │    └── into t_pkey~ (cr, pk; i, crdb_region+)
 ├── execute 2 system table mutations transactions
 ├── merge temporary indexes into backfilled indexes in relation t
 │    └── from t@[6] into t_pkey~
 ├── execute 1 system table mutations transaction
 ├── validate UNIQUE constraint backed by index t_pkey~ in relation t
 ├── execute 2 system table mutations transactions
 ├── backfill using primary index t_pkey~ in relation t
 │    ├── into idx+ (crdb_region+, i: pk)
 │    └── into t_pkey+ (crdb_region+, pk; cr, i)
 ├── execute 2 system table mutations transactions
 ├── merge temporary indexes into backfilled indexes in relation t
 │    ├── from t@[4] into idx+
 │    └── from t@[8] into t_pkey+
 ├── execute 1 system table mutations transaction
 ├── validate UNIQUE constraint backed by index t_pkey+ in relation t
 ├── validate NOT NULL constraint on column crdb_region+ in index t_pkey+ in relation t
 ├── validate UNIQUE constraint backed by index idx+ in relation t
 └── execute 4 system table mutations transactions
