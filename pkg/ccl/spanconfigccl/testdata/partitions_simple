exec-sql
CREATE DATABASE db;
CREATE TABLE db.t(i INT PRIMARY KEY, j INT) PARTITION BY LIST (i) (
PARTITION pi_1_2 VALUES IN (1, 2),
PARTITION pi_3_4 VALUES IN (3, 4),
PARTITION default VALUES IN (default)
);
ALTER DATABASE db CONFIGURE ZONE USING num_replicas=7;
ALTER TABLE db.t CONFIGURE ZONE USING num_voters=5;
----

query-sql
SHOW ZONE CONFIGURATION FOR DATABASE db
----
DATABASE db ALTER DATABASE db CONFIGURE ZONE USING
	range_min_bytes = 134217728,
	range_max_bytes = 536870912,
	gc.ttlseconds = 90000,
	num_replicas = 7,
	constraints = '[]',
	lease_preferences = '[]'

query-sql
SHOW ZONE CONFIGURATION FOR TABLE db.t
----
TABLE db.public.t ALTER TABLE db.public.t CONFIGURE ZONE USING
	range_min_bytes = 134217728,
	range_max_bytes = 536870912,
	gc.ttlseconds = 90000,
	num_replicas = 7,
	num_voters = 5,
	constraints = '[]',
	voter_constraints = '[]',
	lease_preferences = '[]'

query-sql
SHOW ZONE CONFIGURATION FOR PARTITION pi_1_2 OF TABLE db.t
----
TABLE db.public.t ALTER TABLE db.public.t CONFIGURE ZONE USING
	range_min_bytes = 134217728,
	range_max_bytes = 536870912,
	gc.ttlseconds = 90000,
	num_replicas = 7,
	num_voters = 5,
	constraints = '[]',
	voter_constraints = '[]',
	lease_preferences = '[]'

generate-span-configs database-name=db table-name=t
----
Span: /Table/5{3-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------


exec-sql
ALTER PARTITION pi_1_2 OF TABLE db.t CONFIGURE ZONE USING global_reads=true
----

generate-span-configs database-name=db table-name=t
----
Span: /Table/53{-/1/1}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{1-2}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: true
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{2-3}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: true
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/5{3/1/3-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------

exec-sql
ALTER PARTITION pi_3_4 OF TABLE db.t CONFIGURE ZONE USING gc.ttlseconds=5;
ALTER PARTITION pi_3_4 OF TABLE db.t CONFIGURE ZONE USING num_voters=3
----

generate-span-configs database-name=db table-name=t
----
Span: /Table/53{-/1/1}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{1-2}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: true
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{2-3}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: true
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{3-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 5
globalreads: false
numreplicas: 7
numvoters: 3
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{4-5}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 5
globalreads: false
numreplicas: 7
numvoters: 3
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/5{3/1/5-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------

exec-sql
ALTER PARTITION default OF TABLE db.t CONFIGURE ZONE USING num_voters=6
----

generate-span-configs database-name=db table-name=t
----
Span: /Table/53{-/1}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1{-/1}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 6
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{1-2}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: true
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{2-3}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: true
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{3-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 5
globalreads: false
numreplicas: 7
numvoters: 3
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/1/{4-5}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 5
globalreads: false
numreplicas: 7
numvoters: 3
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/53/{1/5-2}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 6
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/5{3/2-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
