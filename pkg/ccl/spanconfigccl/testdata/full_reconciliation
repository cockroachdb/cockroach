# This file tests a full reconciliation scenario when none of the named zone
# entries have been messed with and the user has created a single database
# and a single table inside that database.

exec-sql
CREATE DATABASE db;
CREATE SCHEMA sc;
CREATE TYPE typ AS ENUM();
CREATE TABLE db.t(i INT);
ALTER DATABASE db CONFIGURE ZONE USING num_replicas=7;
ALTER TABLE db.t CONFIGURE ZONE USING num_voters=5;
----

# - User created table above, with ID 55.
#    There should be no entry for IDs 52, 53, and 54 as these belong to the
#    database, schema, and type respectively.
# - All system tables. Note that there should be no entry for pseudo IDs or IDs
#   for which no table exists.
# - NodeLivenessSpan
# - Meta ranges: min -> NodeLiveness start
# - System ranges:
#   - NodeLiveness end -> TimeSeries Start
#   - TimeSeries end -> System Ranges end
# - Time Series Span
full-reconcile
----
Span: /Table/5{6-7}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 7
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/{3-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/{4-5}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/{5-6}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/{6-7}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/{8-9}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/1{1-2}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/1{2-3}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/1{3-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/1{4-5}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/1{5-6}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/{19-20}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/2{0-1}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/2{1-2}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/2{3-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/2{4-5}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/2{5-6}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 600
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/2{6-7}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/2{7-8}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 600
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/2{8-9}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /NamespaceTable/{30-Max}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /{NamespaceTable/Max-Table/32}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/3{2-3}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/3{3-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/3{4-5}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/3{5-6}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/3{6-7}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/3{7-8}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/{39-40}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/4{0-1}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/4{1-2}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/4{2-3}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/4{3-4}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/4{4-5}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/4{5-6}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/4{6-7}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /Table/4{7-8}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /System/NodeLiveness{-Max}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 600
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /{Min-System/NodeLiveness}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 3600
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /System/{NodeLivenessMax-tsd}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /System{tse-/Max}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 5
numvoters: 5
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
Span: /System{/tsd-tse}
rangeminbytes: 134217728
rangemaxbytes: 536870912
gcpolicy:
  ttlseconds: 90000
globalreads: false
numreplicas: 3
numvoters: 3
constraints: []
voterconstraints: []
leasepreferences: []
-----------------------
