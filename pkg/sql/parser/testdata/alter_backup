parse
ALTER BACKUP 'foo' ADD NEW_KMS = 'a' WITH OLD_KMS = 'b'
----
ALTER BACKUP 'foo' ADD NEW_KMS='*****' WITH OLD_KMS='*****' -- normalized!
ALTER BACKUP ('foo') ADD NEW_KMS='*****' WITH OLD_KMS='*****' -- fully parenthesized
ALTER BACKUP '_' ADD NEW_KMS='_' WITH OLD_KMS='_' -- literals removed
ALTER BACKUP 'foo' ADD NEW_KMS='*****' WITH OLD_KMS='*****' -- identifiers removed
ALTER BACKUP 'foo' ADD NEW_KMS='a' WITH OLD_KMS='b' -- passwords exposed

parse
ALTER BACKUP 'foo' ADD NEW_KMS = ('a', 'b') WITH OLD_KMS = ('c', 'd')
----
ALTER BACKUP 'foo' ADD NEW_KMS=('*****', '*****') WITH OLD_KMS=('*****', '*****') -- normalized!
ALTER BACKUP ('foo') ADD NEW_KMS=('*****', '*****') WITH OLD_KMS=('*****', '*****') -- fully parenthesized
ALTER BACKUP '_' ADD NEW_KMS=('_', '_') WITH OLD_KMS=('_', '_') -- literals removed
ALTER BACKUP 'foo' ADD NEW_KMS=('*****', '*****') WITH OLD_KMS=('*****', '*****') -- identifiers removed
ALTER BACKUP 'foo' ADD NEW_KMS=('a', 'b') WITH OLD_KMS=('c', 'd') -- passwords exposed

parse
ALTER BACKUP 'foo' ADD NEW_KMS = ('a', 'b') WITH OLD_KMS = 'c'
----
ALTER BACKUP 'foo' ADD NEW_KMS=('*****', '*****') WITH OLD_KMS='*****' -- normalized!
ALTER BACKUP ('foo') ADD NEW_KMS=('*****', '*****') WITH OLD_KMS='*****' -- fully parenthesized
ALTER BACKUP '_' ADD NEW_KMS=('_', '_') WITH OLD_KMS='_' -- literals removed
ALTER BACKUP 'foo' ADD NEW_KMS=('*****', '*****') WITH OLD_KMS='*****' -- identifiers removed
ALTER BACKUP 'foo' ADD NEW_KMS=('a', 'b') WITH OLD_KMS='c' -- passwords exposed

parse
ALTER BACKUP 'foo' ADD NEW_KMS = 'a' WITH OLD_KMS = ('b', 'c')
----
ALTER BACKUP 'foo' ADD NEW_KMS='*****' WITH OLD_KMS=('*****', '*****') -- normalized!
ALTER BACKUP ('foo') ADD NEW_KMS='*****' WITH OLD_KMS=('*****', '*****') -- fully parenthesized
ALTER BACKUP '_' ADD NEW_KMS='_' WITH OLD_KMS=('_', '_') -- literals removed
ALTER BACKUP 'foo' ADD NEW_KMS='*****' WITH OLD_KMS=('*****', '*****') -- identifiers removed
ALTER BACKUP 'foo' ADD NEW_KMS='a' WITH OLD_KMS=('b', 'c') -- passwords exposed

parse
ALTER BACKUP 'foo' in 'bar' ADD NEW_KMS = 'a' WITH OLD_KMS = 'b'
----
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS='*****' WITH OLD_KMS='*****' -- normalized!
ALTER BACKUP ('foo') IN ('bar') ADD NEW_KMS='*****' WITH OLD_KMS='*****' -- fully parenthesized
ALTER BACKUP '_' IN '_' ADD NEW_KMS='_' WITH OLD_KMS='_' -- literals removed
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS='*****' WITH OLD_KMS='*****' -- identifiers removed
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS='a' WITH OLD_KMS='b' -- passwords exposed

parse
ALTER BACKUP 'foo' in 'bar' ADD NEW_KMS = ('a', 'b') WITH OLD_KMS = ('c', 'd')
----
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS=('*****', '*****') WITH OLD_KMS=('*****', '*****') -- normalized!
ALTER BACKUP ('foo') IN ('bar') ADD NEW_KMS=('*****', '*****') WITH OLD_KMS=('*****', '*****') -- fully parenthesized
ALTER BACKUP '_' IN '_' ADD NEW_KMS=('_', '_') WITH OLD_KMS=('_', '_') -- literals removed
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS=('*****', '*****') WITH OLD_KMS=('*****', '*****') -- identifiers removed
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS=('a', 'b') WITH OLD_KMS=('c', 'd') -- passwords exposed

parse
ALTER BACKUP 'foo' in 'bar' ADD NEW_KMS = ('a', 'b') WITH OLD_KMS = 'c'
----
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS=('*****', '*****') WITH OLD_KMS='*****' -- normalized!
ALTER BACKUP ('foo') IN ('bar') ADD NEW_KMS=('*****', '*****') WITH OLD_KMS='*****' -- fully parenthesized
ALTER BACKUP '_' IN '_' ADD NEW_KMS=('_', '_') WITH OLD_KMS='_' -- literals removed
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS=('*****', '*****') WITH OLD_KMS='*****' -- identifiers removed
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS=('a', 'b') WITH OLD_KMS='c' -- passwords exposed

parse
ALTER BACKUP 'foo' in 'bar' ADD NEW_KMS = 'a' WITH OLD_KMS = ('b', 'c')
----
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS='*****' WITH OLD_KMS=('*****', '*****') -- normalized!
ALTER BACKUP ('foo') IN ('bar') ADD NEW_KMS='*****' WITH OLD_KMS=('*****', '*****') -- fully parenthesized
ALTER BACKUP '_' IN '_' ADD NEW_KMS='_' WITH OLD_KMS=('_', '_') -- literals removed
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS='*****' WITH OLD_KMS=('*****', '*****') -- identifiers removed
ALTER BACKUP 'foo' IN 'bar' ADD NEW_KMS='a' WITH OLD_KMS=('b', 'c') -- passwords exposed

# Test redaction of secrets in URLs.

parse
ALTER BACKUP 'https://user:pass@localhost' ADD NEW_KMS = 'https://foo.com/secret' WITH OLD_KMS = 'https://localhost:8000/bar'
----
ALTER BACKUP 'https://user:redacted@localhost' ADD NEW_KMS='https://foo.com/redacted' WITH OLD_KMS='https://localhost:8000/redacted' -- normalized!
ALTER BACKUP ('https://user:redacted@localhost') ADD NEW_KMS=('https://foo.com/redacted') WITH OLD_KMS=('https://localhost:8000/redacted') -- fully parenthesized
ALTER BACKUP '_' ADD NEW_KMS='_' WITH OLD_KMS='_' -- literals removed
ALTER BACKUP 'https://user:redacted@localhost' ADD NEW_KMS='https://foo.com/redacted' WITH OLD_KMS='https://localhost:8000/redacted' -- identifiers removed
ALTER BACKUP 'https://user:pass@localhost' ADD NEW_KMS='https://foo.com/secret' WITH OLD_KMS='https://localhost:8000/bar' -- passwords exposed

parse
ALTER BACKUP 'foo' IN 'https://user:pass@localhost' ADD NEW_KMS = ('https://foo.com/secret', 'https://www.example.com/bar') WITH OLD_KMS = 'https://localhost:8000/bar'
----
ALTER BACKUP 'foo' IN 'https://user:redacted@localhost' ADD NEW_KMS=('https://foo.com/redacted', 'https://www.example.com/redacted') WITH OLD_KMS='https://localhost:8000/redacted' -- normalized!
ALTER BACKUP ('foo') IN ('https://user:redacted@localhost') ADD NEW_KMS=(('https://foo.com/redacted'), ('https://www.example.com/redacted')) WITH OLD_KMS=('https://localhost:8000/redacted') -- fully parenthesized
ALTER BACKUP '_' IN '_' ADD NEW_KMS=('_', '_') WITH OLD_KMS='_' -- literals removed
ALTER BACKUP 'foo' IN 'https://user:redacted@localhost' ADD NEW_KMS=('https://foo.com/redacted', 'https://www.example.com/redacted') WITH OLD_KMS='https://localhost:8000/redacted' -- identifiers removed
ALTER BACKUP 'foo' IN 'https://user:pass@localhost' ADD NEW_KMS=('https://foo.com/secret', 'https://www.example.com/bar') WITH OLD_KMS='https://localhost:8000/bar' -- passwords exposed
