# Trigger these rules by running `make generate PKG=./pkg/sql/ir/irgen/parser` from the
# repository root to ensure your PATH includes vendored binaries.

SHELL = /usr/bin/env bash

all: irgen.go

.PHONY: irgen.go
irgen.go: irgen.y Makefile
	set -eo pipefail; ret=`goyacc -o irgen.go.tmp -p irgen irgen.y`; \
	  ! echo "$$ret" | grep -F conflicts
	(echo '// Code generated by goyacc.'; \
	 echo '// GENERATED FILE DO NOT EDIT'; \
	 cat $@.tmp) >$@ && rm -f $@.tmp

clean:
	rm -f `cat .gitignore`
