# Centroid is [0,0], query vector is orthogonal to data vectors.
estimate-distances query=[0,2]
[-2,0]
[2,0]
----
L2Squared
  Query = (0, 2)
  Centroid = (0, 0)
  (-2, 0): exact is 8, estimate is 0 ± 5.66
  (2, 0): exact is 8, estimate is 0 ± 5.66
InnerProduct
  Query = (0, 2)
  Centroid = (0, 0)
  (-2, 0): exact is 0, estimate is -4 ± 2.83
  (2, 0): exact is 0, estimate is -4 ± 2.83
Cosine
  Query = (0, 1)
  Centroid = (0, 0)
  (-1, 0): exact is 1, estimate is 0 ± 0.71
  (1, 0): exact is 1, estimate is 0 ± 0.71

# Translate centroid to non-origin point [2,2].
estimate-distances query=[2,4]
[0,2]
[4,2]
----
L2Squared
  Query = (2, 4)
  Centroid = (2, 2)
  (0, 2): exact is 8, estimate is 0 ± 5.66
  (4, 2): exact is 8, estimate is 0 ± 5.66
InnerProduct
  Query = (2, 4)
  Centroid = (0.7071, 0.7071)
  (0, 2): exact is -8, estimate is -6.828 ± 3.69
  (4, 2): exact is -16, estimate is -20 ± 8.85
Cosine
  Query = (0.4472, 0.8944)
  Centroid = (0.5257, 0.8507)
  (0, 1): exact is 0.106, estimate is 0.099 ± 0.03
  (0.8944, 0.4472): exact is 0.2, estimate is 0.201 ± 0.03

# Centroid is [0,0], query vector equals one of the data vectors.
estimate-distances query=[2,0]
[-2,0]
[2,0]
----
L2Squared
  Query = (2, 0)
  Centroid = (0, 0)
  (-2, 0): exact is 16, estimate is 16 ± 5.66
  (2, 0): exact is 0, estimate is 0 ± 5.66
InnerProduct
  Query = (2, 0)
  Centroid = (0, 0)
  (-2, 0): exact is 4, estimate is 4 ± 2.83
  (2, 0): exact is -4, estimate is -4 ± 2.83
Cosine
  Query = (1, 0)
  Centroid = (0, 0)
  (-1, 0): exact is 2, estimate is 2 ± 0.71
  (1, 0): exact is 0, estimate is 0 ± 0.71

# Translate centroid to non-origin point [2,2].
estimate-distances query=[4,2]
[0,2]
[4,2]
----
L2Squared
  Query = (4, 2)
  Centroid = (2, 2)
  (0, 2): exact is 16, estimate is 16 ± 5.66
  (4, 2): exact is 0, estimate is 0 ± 5.66
InnerProduct
  Query = (4, 2)
  Centroid = (0.7071, 0.7071)
  (0, 2): exact is -4, estimate is -2.485 ± 3.69
  (4, 2): exact is -20, estimate is -20 ± 8.85
Cosine
  Query = (0.8944, 0.4472)
  Centroid = (0.5257, 0.8507)
  (0, 1): exact is 0.553, estimate is 0.64 ± 0.21
  (0.8944, 0.4472): exact is 0, estimate is 0 ± 0.21

# Query vector is parallel, but longer, than one of the data vectors.
estimate-distances query=[4,0]
[-2,0]
[2,0]
----
L2Squared
  Query = (4, 0)
  Centroid = (0, 0)
  (-2, 0): exact is 36, estimate is 36 ± 11.31
  (2, 0): exact is 4, estimate is 4 ± 11.31
InnerProduct
  Query = (4, 0)
  Centroid = (0, 0)
  (-2, 0): exact is 8, estimate is 8 ± 5.66
  (2, 0): exact is -8, estimate is -8 ± 5.66
Cosine
  Query = (1, 0)
  Centroid = (0, 0)
  (-1, 0): exact is 2, estimate is 2 ± 0.71
  (1, 0): exact is 0, estimate is 0 ± 0.71

# Query vector is equal to the centroid.
estimate-distances query=[2,2]
[0,2]
[4,2]
----
L2Squared
  Query = (2, 2)
  Centroid = (2, 2)
  (0, 2): exact is 4, estimate is 4
  (4, 2): exact is 4, estimate is 4
InnerProduct
  Query = (2, 2)
  Centroid = (0.7071, 0.7071)
  (0, 2): exact is -4, estimate is -3.243 ± 1.91
  (4, 2): exact is -12, estimate is -13.128 ± 4.57
Cosine
  Query = (0.7071, 0.7071)
  Centroid = (0.5257, 0.8507)
  (0, 1): exact is 0.293, estimate is 0.32 ± 0.09
  (0.8944, 0.4472): exact is 0.051, estimate is 0.05 ± 0.09

# All data vectors are the same, query is the same.
estimate-distances query=[2,2]
[2,2]
[2,2]
[2,2]
----
L2Squared
  Query = (2, 2)
  Centroid = (2, 2)
  (2, 2): exact is 0, estimate is 0
  (2, 2): exact is 0, estimate is 0
  (2, 2): exact is 0, estimate is 0
InnerProduct
  Query = (2, 2)
  Centroid = (0.7071, 0.7071)
  (2, 2): exact is -8, estimate is -8 ± 2.36
  (2, 2): exact is -8, estimate is -8 ± 2.36
  (2, 2): exact is -8, estimate is -8 ± 2.36
Cosine
  Query = (0.7071, 0.7071)
  Centroid = (0.7071, 0.7071)
  (0.7071, 0.7071): exact is 0, estimate is 0 ± 0
  (0.7071, 0.7071): exact is 0, estimate is 0 ± 0
  (0.7071, 0.7071): exact is 0, estimate is 0 ± 0

# All data vectors are the same, query is different.
estimate-distances query=[3,4]
[2,2]
[2,2]
[2,2]
----
L2Squared
  Query = (3, 4)
  Centroid = (2, 2)
  (2, 2): exact is 5, estimate is 5
  (2, 2): exact is 5, estimate is 5
  (2, 2): exact is 5, estimate is 5
InnerProduct
  Query = (3, 4)
  Centroid = (0.7071, 0.7071)
  (2, 2): exact is -14, estimate is -14 ± 5.19
  (2, 2): exact is -14, estimate is -14 ± 5.19
  (2, 2): exact is -14, estimate is -14 ± 5.19
Cosine
  Query = (0.6, 0.8)
  Centroid = (0.7071, 0.7071)
  (0.7071, 0.7071): exact is 0.01, estimate is 0.01 ± 0
  (0.7071, 0.7071): exact is 0.01, estimate is 0.01 ± 0
  (0.7071, 0.7071): exact is 0.01, estimate is 0.01 ± 0

# All data vectors and query vector are zeros.
estimate-distances query=[0,0]
[0,0]
[0,0]
[0,0]
----
L2Squared
  Query = (0, 0)
  Centroid = (0, 0)
  (0, 0): exact is 0, estimate is 0
  (0, 0): exact is 0, estimate is 0
  (0, 0): exact is 0, estimate is 0
InnerProduct
  Query = (0, 0)
  Centroid = (0, 0)
  (0, 0): exact is 0, estimate is 0
  (0, 0): exact is 0, estimate is 0
  (0, 0): exact is 0, estimate is 0
Cosine
  Query = (0, 0)
  Centroid = (0, 0)
  (0, 0): exact is 1, estimate is 1
  (0, 0): exact is 1, estimate is 1
  (0, 0): exact is 1, estimate is 1

# All data vectors are colinear, but at different scales.
estimate-distances query=[10,0]
[1,0]
[4,0]
[16,0]
----
L2Squared
  Query = (10, 0)
  Centroid = (7, 0)
  (1, 0): exact is 81, estimate is 81 ± 25.46
  (4, 0): exact is 36, estimate is 36 ± 12.73
  (16, 0): exact is 36, estimate is 36 ± 38.18
InnerProduct
  Query = (10, 0)
  Centroid = (1, 0)
  (1, 0): exact is -10, estimate is -10
  (4, 0): exact is -40, estimate is -40 ± 19.09
  (16, 0): exact is -160, estimate is -160 ± 95.46
Cosine
  Query = (1, 0)
  Centroid = (1, 0)
  (1, 0): exact is 0, estimate is 0
  (1, 0): exact is 0, estimate is 0
  (1, 0): exact is 0, estimate is 0

# Test more vectors at cloud of locations.
estimate-distances query=[3,4]
[5,-1]
[2,2]
[3,4]
[4,3]
[1,8]
[12,5]
----
L2Squared
  Query = (3, 4)
  Centroid = (4.5, 3.5)
  (5, -1): exact is 29, estimate is 39.4 ± 10.12
  (2, 2): exact is 5, estimate is 6.75 ± 6.52
  (3, 4): exact is 0, estimate is 0 ± 3.54
  (4, 3): exact is 2, estimate is 2 ± 1.58
  (1, 8): exact is 20, estimate is 18.75 ± 12.75
  (12, 5): exact is 82, estimate is 74 ± 17.1
InnerProduct
  Query = (3, 4)
  Centroid = (0.7894, 0.6139)
  (5, -1): exact is -11, estimate is -3.053 ± 12.89
  (2, 2): exact is -14, estimate is -13.93 ± 5.26
  (3, 4): exact is -25, estimate is -25 ± 11.56
  (4, 3): exact is -24, estimate is -24.825 ± 11.44
  (1, 8): exact is -35, estimate is -49.749 ± 21.13
  (12, 5): exact is -56, estimate is -68.367 ± 34.42
Cosine
  Query = (0.6, 0.8)
  Centroid = (0.7827, 0.6224)
  (0.9806, -0.1961): exact is 0.569, estimate is 0.638 ± 0.15
  (0.7071, 0.7071): exact is 0.01, estimate is 0.01 ± 0.02
  (0.6, 0.8): exact is 0, estimate is 0 ± 0.05
  (0.8, 0.6): exact is 0.04, estimate is 0.04 ± 0.01
  (0.124, 0.9923): exact is 0.132, estimate is 0.118 ± 0.14
  (0.9231, 0.3846): exact is 0.138, estimate is 0.143 ± 0.05

# Query is far outside the data cloud.
estimate-distances query=[100,100]
[5,-1]
[2,2]
[3,4]
[4,3]
[1,8]
[12,5]
----
L2Squared
  Query = (100, 100)
  Centroid = (4.5, 3.5)
  (5, -1): exact is 19226, estimate is 18461.199 ± 869.33
  (2, 2): exact is 19208, estimate is 19257 ± 559.78
  (3, 4): exact is 18625, estimate is 18432.5 ± 303.58
  (4, 3): exact is 18625, estimate is 18625 ± 135.77
  (1, 8): exact is 18265, estimate is 18456.875 ± 1094.58
  (12, 5): exact is 16769, estimate is 15995 ± 1468.54
InnerProduct
  Query = (100, 100)
  Centroid = (0.7894, 0.6139)
  (5, -1): exact is -400, estimate is -142.05 ± 447.77
  (2, 2): exact is -400, estimate is -401.161 ± 182.74
  (3, 4): exact is -700, estimate is -724.409 ± 401.54
  (4, 3): exact is -700, estimate is -712.136 ± 397.21
  (1, 8): exact is -900, estimate is -1572.364 ± 733.72
  (12, 5): exact is -1700, estimate is -1997.125 ± 1195.37
Cosine
  Query = (0.7071, 0.7071)
  Centroid = (0.7827, 0.6224)
  (0.9806, -0.1961): exact is 0.445, estimate is 0.473 ± 0.07
  (0.7071, 0.7071): exact is 0, estimate is 0 ± 0.01
  (0.6, 0.8): exact is 0.01, estimate is 0.01 ± 0.02
  (0.8, 0.6): exact is 0.01, estimate is 0.01 ± 0
  (0.124, 0.9923): exact is 0.211, estimate is 0.203 ± 0.06
  (0.9231, 0.3846): exact is 0.075, estimate is 0.077 ± 0.02

# Data cloud is far away from origin.
estimate-distances query=[108,108]
[105,99]
[102,102]
[103,104]
[104,103]
[101,108]
[112,105]
----
L2Squared
  Query = (108, 108)
  Centroid = (104.5, 103.5)
  (105, 99): exact is 90, estimate is 61.2 ± 36.5
  (102, 102): exact is 72, estimate is 75 ± 23.51
  (103, 104): exact is 41, estimate is 32.5 ± 12.75
  (104, 103): exact is 41, estimate is 41 ± 5.7
  (101, 108): exact is 49, estimate is 56.875 ± 45.96
  (112, 105): exact is 25, estimate is 0 ± 48.66
InnerProduct
  Query = (108, 108)
  Centroid = (0.7105, 0.7037)
  (105, 99): exact is -22032, estimate is -22051.043 ± 15376.41
  (102, 102): exact is -22032, estimate is -22031.998 ± 15369.69
  (103, 104): exact is -22356, estimate is -22356.523 ± 15597.48
  (104, 103): exact is -22356, estimate is -22356.52 ± 15597.47
  (101, 108): exact is -22572, estimate is -22597.348 ± 15757.99
  (112, 105): exact is -23436, estimate is -23460.359 ± 16364.57
Cosine
  Query = (0.7071, 0.7071)
  Centroid = (0.7104, 0.7038)
  (0.7276, 0.686): exact is 0, estimate is 0 ± 0
  (0.7071, 0.7071): exact is 0, estimate is 0 ± 0
  (0.7037, 0.7105): exact is 0, estimate is 0 ± 0
  (0.7105, 0.7037): exact is 0, estimate is 0 ± 0
  (0.683, 0.7304): exact is 0.001, estimate is 0.001 ± 0
  (0.7295, 0.6839): exact is 0.001, estimate is 0.001 ± 0

# Test more dimensions.
estimate-distances query=[4,3,7,8]
[5,-1,3,10]
[2,2,-5,4]
[3,4,8,7]
[4,3,7,8]
[1,8,10,12]
[12,5,6,-4]
----
L2Squared
  Query = (4, 3, 7, 8)
  Centroid = (4.5, 3.5, 4.8333, 6.1667)
  (5, -1, 3, 10): exact is 37, estimate is 49.681 ± 18.16
  (2, 2, -5, 4): exact is 165, estimate is 159.348 ± 30.66
  (3, 4, 8, 7): exact is 4, estimate is 4.246 ± 10.64
  (4, 3, 7, 8): exact is 0, estimate is 0.076 ± 8.56
  (1, 8, 10, 12): exact is 59, estimate is 62.744 ± 28.24
  (12, 5, 6, -4): exact is 213, estimate is 182.124 ± 37.37
InnerProduct
  Query = (4, 3, 7, 8)
  Centroid = (0.4644, 0.3612, 0.4988, 0.6364)
  (5, -1, 3, 10): exact is -118, estimate is -116.824 ± 58.08
  (2, 2, -5, 4): exact is -11, estimate is -39.973 ± 36.75
  (3, 4, 8, 7): exact is -136, estimate is -138.041 ± 58.1
  (4, 3, 7, 8): exact is -138, estimate is -137.801 ± 57.98
  (1, 8, 10, 12): exact is -194, estimate is -218.043 ± 89.78
  (12, 5, 6, -4): exact is -73, estimate is -59.739 ± 77.34
Cosine
  Query = (0.3405, 0.2554, 0.5959, 0.681)
  Centroid = (0.4839, 0.3529, 0.3988, 0.6944)
  (0.4303, -0.0861, 0.2582, 0.8607): exact is 0.135, estimate is 0.152 ± 0.06
  (0.2857, 0.2857, -0.7143, 0.5714): exact is 0.866, estimate is 0.619 ± 0.15
  (0.2554, 0.3405, 0.681, 0.5959): exact is 0.014, estimate is 0 ± 0.05
  (0.3405, 0.2554, 0.5959, 0.681): exact is 0, estimate is 0 ± 0.03
  (0.0569, 0.4551, 0.5689, 0.6827): exact is 0.061, estimate is 0.06 ± 0.06
  (0.8072, 0.3363, 0.4036, -0.2691): exact is 0.582, estimate is 0.408 ± 0.13

# Estimate distances for real OpenAI embeddings with 512 dims.
estimate-distances query-feature=5000
----
L2Squared
  Query = (-0.0451, -0.0282, ..., 0.0277, -0.0174)
  Centroid = (-0.0043, 0.0183, ..., -0.0101, -0.0029)
  (-0.0359, 0.033, ..., -0.0048, 0.0074): exact is 0.96, estimate is 1.004 ± 0.04
  (0.0021, 0.0271, ..., 0.0143, -0.014): exact is 0.903, estimate is 0.854 ± 0.04
  (0.0018, 0.0176, ..., -0.0217, -0.0114): exact is 0.988, estimate is 0.948 ± 0.04
  (-0.0325, 0.0174, ..., -0.0016, -0.0127): exact is 1.014, estimate is 1.007 ± 0.05
  (0.0289, -0.0088, ..., -0.0002, -0.0151): exact is 1.013, estimate is 0.945 ± 0.04
  (0.0277, 0.0377, ..., -0.0181, 0.0031): exact is 0.883, estimate is 0.925 ± 0.04
  (-0.0218, 0.0347, ..., -0.0304, 0.0144): exact is 1.102, estimate is 1.017 ± 0.04
  (0.0058, 0.009, ..., -0.0274, 0.0126): exact is 0.957, estimate is 0.945 ± 0.04
  (0.0134, 0.035, ..., -0.0054, 0.0209): exact is 1.268, estimate is 1.232 ± 0.05
  (-0.0329, -0.0195, ..., -0.0056, -0.034): exact is 1.163, estimate is 1.178 ± 0.05
InnerProduct
  Query = (-0.0451, -0.0282, ..., 0.0277, -0.0174)
  Centroid = (-0.0056, 0.0237, ..., -0.0131, -0.0037)
  (-0.0359, 0.033, ..., -0.0048, 0.0074): exact is -0.521, estimate is -0.452 ± 0.03
  (0.0021, 0.0271, ..., 0.0143, -0.014): exact is -0.549, estimate is -0.559 ± 0.02
  (0.0018, 0.0176, ..., -0.0217, -0.0114): exact is -0.507, estimate is -0.5 ± 0.02
  (-0.0325, 0.0174, ..., -0.0016, -0.0127): exact is -0.493, estimate is -0.459 ± 0.03
  (0.0289, -0.0088, ..., -0.0002, -0.0151): exact is -0.494, estimate is -0.522 ± 0.02
  (0.0277, 0.0377, ..., -0.0181, 0.0031): exact is -0.559, estimate is -0.536 ± 0.02
  (-0.0218, 0.0347, ..., -0.0304, 0.0144): exact is -0.45, estimate is -0.431 ± 0.03
  (0.0058, 0.009, ..., -0.0274, 0.0126): exact is -0.522, estimate is -0.5 ± 0.03
  (0.0134, 0.035, ..., -0.0054, 0.0209): exact is -0.367, estimate is -0.33 ± 0.03
  (-0.0329, -0.0195, ..., -0.0056, -0.034): exact is -0.419, estimate is -0.357 ± 0.03
Cosine
  Query = (-0.0451, -0.0282, ..., 0.0277, -0.0174)
  Centroid = (-0.0056, 0.0237, ..., -0.0131, -0.0037)
  (-0.0358, 0.033, ..., -0.0048, 0.0074): exact is 0.48, estimate is 0.55 ± 0.03
  (0.0021, 0.027, ..., 0.0143, -0.014): exact is 0.451, estimate is 0.442 ± 0.02
  (0.0018, 0.0176, ..., -0.0217, -0.0114): exact is 0.494, estimate is 0.5 ± 0.02
  (-0.0325, 0.0174, ..., -0.0016, -0.0127): exact is 0.507, estimate is 0.54 ± 0.03
  (0.0289, -0.0088, ..., -0.0002, -0.0151): exact is 0.506, estimate is 0.478 ± 0.02
  (0.0277, 0.0377, ..., -0.0181, 0.0031): exact is 0.441, estimate is 0.465 ± 0.02
  (-0.0218, 0.0347, ..., -0.0304, 0.0144): exact is 0.551, estimate is 0.57 ± 0.03
  (0.0058, 0.009, ..., -0.0274, 0.0126): exact is 0.478, estimate is 0.501 ± 0.03
  (0.0134, 0.035, ..., -0.0054, 0.0209): exact is 0.634, estimate is 0.672 ± 0.03
  (-0.0329, -0.0195, ..., -0.0056, -0.034): exact is 0.581, estimate is 0.642 ± 0.03

# Do another estimation for the same data vectors, but a different query vector.
estimate-distances query-feature=6000
----
L2Squared
  Query = (-0.0028, 0.0475, ..., -0.0018, 0.0054)
  Centroid = (-0.0043, 0.0183, ..., -0.0101, -0.0029)
  (-0.0359, 0.033, ..., -0.0048, 0.0074): exact is 1.255, estimate is 1.098 ± 0.05
  (0.0021, 0.0271, ..., 0.0143, -0.014): exact is 1.088, estimate is 1.018 ± 0.04
  (0.0018, 0.0176, ..., -0.0217, -0.0114): exact is 1.029, estimate is 1.041 ± 0.04
  (-0.0325, 0.0174, ..., -0.0016, -0.0127): exact is 1.153, estimate is 1.175 ± 0.05
  (0.0289, -0.0088, ..., -0.0002, -0.0151): exact is 1.12, estimate is 1.118 ± 0.05
  (0.0277, 0.0377, ..., -0.0181, 0.0031): exact is 0.81, estimate is 0.907 ± 0.05
  (-0.0218, 0.0347, ..., -0.0304, 0.0144): exact is 1.184, estimate is 1.17 ± 0.05
  (0.0058, 0.009, ..., -0.0274, 0.0126): exact is 0.885, estimate is 0.932 ± 0.05
  (0.0134, 0.035, ..., -0.0054, 0.0209): exact is 1.258, estimate is 1.265 ± 0.05
  (-0.0329, -0.0195, ..., -0.0056, -0.034): exact is 1.342, estimate is 1.347 ± 0.05
InnerProduct
  Query = (-0.0028, 0.0475, ..., -0.0018, 0.0054)
  Centroid = (-0.0056, 0.0237, ..., -0.0131, -0.0037)
  (-0.0359, 0.033, ..., -0.0048, 0.0074): exact is -0.373, estimate is -0.399 ± 0.03
  (0.0021, 0.0271, ..., 0.0143, -0.014): exact is -0.456, estimate is -0.481 ± 0.02
  (0.0018, 0.0176, ..., -0.0217, -0.0114): exact is -0.486, estimate is -0.455 ± 0.02
  (-0.0325, 0.0174, ..., -0.0016, -0.0127): exact is -0.424, estimate is -0.364 ± 0.03
  (0.0289, -0.0088, ..., -0.0002, -0.0151): exact is -0.44, estimate is -0.426 ± 0.03
  (0.0277, 0.0377, ..., -0.0181, 0.0031): exact is -0.595, estimate is -0.549 ± 0.03
  (-0.0218, 0.0347, ..., -0.0304, 0.0144): exact is -0.408, estimate is -0.36 ± 0.03
  (0.0058, 0.009, ..., -0.0274, 0.0126): exact is -0.557, estimate is -0.567 ± 0.03
  (0.0134, 0.035, ..., -0.0054, 0.0209): exact is -0.371, estimate is -0.331 ± 0.03
  (-0.0329, -0.0195, ..., -0.0056, -0.034): exact is -0.329, estimate is -0.323 ± 0.03
Cosine
  Query = (-0.0028, 0.0476, ..., -0.0018, 0.0054)
  Centroid = (-0.0056, 0.0237, ..., -0.0131, -0.0037)
  (-0.0358, 0.033, ..., -0.0048, 0.0074): exact is 0.627, estimate is 0.601 ± 0.03
  (0.0021, 0.027, ..., 0.0143, -0.014): exact is 0.544, estimate is 0.519 ± 0.02
  (0.0018, 0.0176, ..., -0.0217, -0.0114): exact is 0.514, estimate is 0.545 ± 0.02
  (-0.0325, 0.0174, ..., -0.0016, -0.0127): exact is 0.576, estimate is 0.636 ± 0.03
  (0.0289, -0.0088, ..., -0.0002, -0.0151): exact is 0.56, estimate is 0.574 ± 0.03
  (0.0277, 0.0377, ..., -0.0181, 0.0031): exact is 0.405, estimate is 0.451 ± 0.03
  (-0.0218, 0.0347, ..., -0.0304, 0.0144): exact is 0.592, estimate is 0.64 ± 0.03
  (0.0058, 0.009, ..., -0.0274, 0.0126): exact is 0.443, estimate is 0.432 ± 0.03
  (0.0134, 0.035, ..., -0.0054, 0.0209): exact is 0.629, estimate is 0.669 ± 0.03
  (-0.0329, -0.0195, ..., -0.0056, -0.034): exact is 0.671, estimate is 0.677 ± 0.03
