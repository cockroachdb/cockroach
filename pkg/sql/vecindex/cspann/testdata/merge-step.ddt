# ----------------------------------------------------------------------
# Step through typical merge of a partition.
# ----------------------------------------------------------------------

load-index min-partition-size=2 max-partition-size=6 beam-size=2
• 1 [0, 0]
│
├───• 2 [7, 0]
│   │
│   ├───• vec6 [14, 1]
│   └───• vec9 [5, 2]
│
├───• 3 [0.6667, 6]
│   │
│   ├───• vec5 [3, 6]
│   ├───• vec3 [-2, 8]
│   └───• vec8 [1, 4]
│
└───• 4 [2.5, 8.5]
    │
    ├───• vec1 [0, -1]
    ├───• vec7 [0, 0]
    ├───• vec2 [3, 10]
    └───• vec4 [2, 7]
----
Loaded 9 vectors.

# Update merging partition to Merging state.
force-merge partition-key=2 parent-partition-key=1 steps=1
----
• 1 [0, 0]
│
├───• 2 [7, 0] (Merging)
│   │
│   ├───• vec6 [14, 1]
│   └───• vec9 [5, 2]
│
├───• 3 [0.6667, 6]
│   │
│   ├───• vec5 [3, 6]
│   ├───• vec3 [-2, 8]
│   └───• vec8 [1, 4]
│
└───• 4 [2.5, 8.5]
    │
    ├───• vec1 [0, -1]
    ├───• vec7 [0, 0]
    ├───• vec2 [3, 10]
    └───• vec4 [2, 7]

# Move first vector to another partition.
force-merge partition-key=2 parent-partition-key=1 steps=1
----
• 1 [0, 0]
│
├───• 2 [7, 0] (Merging)
│   │
│   └───• vec9 [5, 2]
│
├───• 3 [0.6667, 6]
│   │
│   ├───• vec5 [3, 6]
│   ├───• vec3 [-2, 8]
│   └───• vec8 [1, 4]
│
└───• 4 [2.5, 8.5]
    │
    ├───• vec1 [0, -1]
    ├───• vec7 [0, 0]
    ├───• vec2 [3, 10]
    ├───• vec4 [2, 7]
    └───• vec6 [14, 1]

# Move last vector to another partition.
force-merge partition-key=2 parent-partition-key=1 steps=1
----
• 1 [0, 0]
│
├───• 2 [7, 0] (Merging)
├───• 3 [0.6667, 6]
│   │
│   ├───• vec5 [3, 6]
│   ├───• vec3 [-2, 8]
│   ├───• vec8 [1, 4]
│   └───• vec9 [5, 2]
│
└───• 4 [2.5, 8.5]
    │
    ├───• vec1 [0, -1]
    ├───• vec7 [0, 0]
    ├───• vec2 [3, 10]
    ├───• vec4 [2, 7]
    └───• vec6 [14, 1]

# Remove merging partition from its parent.
force-merge partition-key=2 parent-partition-key=1 steps=1
----
• 1 [0, 0]
│
├───• 4 [2.5, 8.5]
│   │
│   ├───• vec1 [0, -1]
│   ├───• vec7 [0, 0]
│   ├───• vec2 [3, 10]
│   ├───• vec4 [2, 7]
│   └───• vec6 [14, 1]
│
└───• 3 [0.6667, 6]
    │
    ├───• vec5 [3, 6]
    ├───• vec3 [-2, 8]
    ├───• vec8 [1, 4]
    └───• vec9 [5, 2]

# Merging partition should be left empty and orphaned.
format-tree root=2
----
• 2 [7, 0] (Merging)
