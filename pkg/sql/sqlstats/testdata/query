exec-sql db=random_db
CREATE TABLE users (id INT PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice'), (2, 'Bob');
SELECT * FROM users;
----

# Sanity check shouldn't return anything
show-stats app-name=random db=random_db
----

show-stats db=random_db
----
{"count": "1", "fingerprint_id": "0ccc46bc6c67802b", "nodes": [1], "parse_lat_not_zero": true, "plan_distributed": false, "plan_full_scan": false, "plan_hash_set": true, "plan_implicit_txn": null, "plan_lat_not_zero": true, "plan_vectorized": true, "query": "INSERT INTO users VALUES (_, __more__), (__more__)", "run_lat_not_zero": true, "sql_type": "TypeDML", "summary": "INSERT INTO users", "svc_lat_not_zero": true, "transaction_fingerprint_id": "9df1ac6fd11fdf16"}
{"count": "1", "fingerprint_id": "37b2ca708c474dc5", "nodes": [1], "parse_lat_not_zero": true, "plan_distributed": false, "plan_full_scan": false, "plan_hash_set": true, "plan_implicit_txn": null, "plan_lat_not_zero": true, "plan_vectorized": true, "query": "CREATE TABLE users (id INT8 PRIMARY KEY, name STRING)", "run_lat_not_zero": true, "sql_type": "TypeDDL", "summary": "CREATE TABLE users (id INT8 PRIMARY KEY, name STRING)", "svc_lat_not_zero": true, "transaction_fingerprint_id": "9df1ac6fd11fdf16"}
{"count": "1", "fingerprint_id": "7c28ced2bd338516", "nodes": [1], "parse_lat_not_zero": true, "plan_distributed": false, "plan_full_scan": false, "plan_hash_set": true, "plan_implicit_txn": null, "plan_lat_not_zero": true, "plan_vectorized": true, "query": "SET database = random_db", "run_lat_not_zero": true, "sql_type": "TypeDML", "summary": "SET database = random_db", "svc_lat_not_zero": true, "transaction_fingerprint_id": "d34b739e3b3232c9"}
{"count": "1", "fingerprint_id": "7fd884e70da98969", "nodes": [1], "parse_lat_not_zero": true, "plan_distributed": false, "plan_full_scan": true, "plan_hash_set": true, "plan_implicit_txn": null, "plan_lat_not_zero": true, "plan_vectorized": true, "query": "SELECT * FROM users", "run_lat_not_zero": true, "sql_type": "TypeDML", "summary": "SELECT * FROM users", "svc_lat_not_zero": true, "transaction_fingerprint_id": "9df1ac6fd11fdf16"}

exec-sql db=random_db app-name=transactions
BEGIN;
INSERT INTO users VALUES (3, 'Charlie');
INSERT INTO users VALUES (4, 'Diana');
COMMIT;
----

exec-sql db=random_db app-name=transactions
BEGIN;
INSERT INTO users VALUES (5, 'Eve');
INSERT INTO users VALUES (6, 'Frank');
COMMIT;
----

show-stats db=random_db app-name=transactions
----
{"count": "4", "fingerprint_id": "fc79fa2c575ca57f", "nodes": [1], "parse_lat_not_zero": true, "plan_distributed": false, "plan_full_scan": false, "plan_hash_set": true, "plan_implicit_txn": null, "plan_lat_not_zero": true, "plan_vectorized": true, "query": "INSERT INTO users VALUES (_, __more__)", "run_lat_not_zero": true, "sql_type": "TypeDML", "summary": "INSERT INTO users", "svc_lat_not_zero": true, "transaction_fingerprint_id": "6ec013af967a009f"}

show-txn-stats db=random_db app-name=transactions
----
{"commit_lat_not_zero": true, "count": "2", "statement_fingerprint_ids": ["fc79fa2c575ca57f", "fc79fa2c575ca57f"], "svc_lat_not_zero": true, "txn_fingerprint_id": "6ec013af967a009f"}
