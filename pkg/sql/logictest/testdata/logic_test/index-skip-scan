# LogicTest: local

statement ok
SET VECTORIZE = OFF

statement ok
CREATE TABLE abc (a INT8, b INT8, c INT8, PRIMARY KEY (a, b, c))

statement ok
INSERT INTO abc VALUES (1, 10, 100), (1, 20, 300), (2, 30, 400), (3, 40, 500), (2, 40, 500)

statement ok
INSERT INTO abc VALUES (1, 10, 200), (1, 20, 400), (2, 30, 500), (3, 400, 600), (2, 40, 700)

statement ok
ALTER TABLE abc INJECT STATISTICS '[
{
  "columns": ["a"],
  "created_at": "2018-01-01 1:00:00.00000+00:00",
  "row_count": 1000,
  "distinct_count": 10,
  "null_count": 0
},
{
  "columns": ["b"],
  "created_at": "2018-01-01 1:00:00.00000+00:00",
  "row_count": 1000,
  "distinct_count": 10,
  "null_count": 0
},
{
  "columns": ["c"],
  "created_at": "2018-01-01 1:00:00.00000+00:00",
  "row_count": 1000,
  "distinct_count": 10,
  "null_count": 0
}]'

query I
SELECT DISTINCT ON (a) a FROM abc
----
1
2
3

query III
SELECT DISTINCT ON (a) * FROM abc
----
1  10  100
2  30  400
3  40  500

query III
SELECT DISTINCT ON (a, b) * FROM abc
----
1  10   100
1  20   300
2  30   400
2  40   500
3  40   500
3  400  600

query I
SELECT count(DISTINCT a) FROM abc
----
3

query T
SELECT array_agg(DISTINCT a) FROM abc
----
{1,2,3}
