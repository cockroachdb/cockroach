# LogicTest: default

# SEQUENCE CREATION

statement ok
CREATE SEQUENCE foo

# A sequence with the same name can't be created again.
statement error pgcode 42P07 relation "foo" already exists
CREATE SEQUENCE foo

statement error pgcode 42601 conflicting or redundant options
CREATE SEQUENCE bar INCREMENT 5 MAXVALUE 1000 INCREMENT 2

# Sequences are in the same namespace as tables.
statement error pgcode 42P07 relation "foo" already exists
CREATE TABLE foo (k BYTES PRIMARY KEY, v BYTES)

# You can't create with 0 increment.
statement error pgcode 22023 INCREMENT must not be zero
CREATE SEQUENCE zero_test INCREMENT 0

# Drop table on sequences doesn't work; you have to use DROP SEQUENCE.
statement error pgcode 42809 "foo" is not a table
DROP TABLE foo

# DML ERRORS

statement error pgcode XX000 cannot run INSERT on sequence "foo" - sequences are not updateable
INSERT INTO foo VALUES (1, 2, 3)

statement error pgcode XX000 cannot run UPDATE on sequence "foo" - sequences are not updateable
UPDATE foo SET value = 5

statement error pgcode XX000 cannot run DELETE on sequence "foo" - sequences are not updateable
DELETE FROM foo

statement error pgcode XX000 cannot run TRUNCATE on sequence "foo" - sequences are not updateable
TRUNCATE foo

# USING THE nextval() FUNCTION

# `select * from foo` currently returns 0 columns & 0 rows;
# testing against that is a Test-Script syntax error.

query I
SELECT nextval('foo')
----
1

query I
SELECT nextval('foo')
----
2

# You can create a sequence with different increment.

statement ok
CREATE SEQUENCE bar INCREMENT 5

query I
SELECT nextval('bar')
----
1

query I
SELECT nextval('bar')
----
6

# You can create a sequence with different start and increment.

statement ok
CREATE SEQUENCE baz START 2 INCREMENT 5

query I
SELECT nextval('baz')
----
2

query I
SELECT nextval('baz')
----
7
