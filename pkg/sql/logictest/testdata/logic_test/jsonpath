query T
SELECT pg_typeof(JSONPATH '$.a')
----
jsonpath

query T
SELECT '$.a'::JSONPATH
----
$.a

statement ok
CREATE TABLE a (j JSONPATH)

statement ok
INSERT INTO a VALUES ('$.something'), ('$.other.thing'), ('$.another.thing'), ('$.a[*].b.c[*]')

query T rowsort
SELECT * FROM a;
----
$.something
$.other.thing
$.another.thing
$.a[*].b.c[*]

query T
SELECT '$'::JSONPATH
----
$

query T
SELECT '$.*'::JSONPATH
----
$.*

query T
SELECT 'strict $'::JSONPATH
----
strict $

query T
SELECT 'lax $'::JSONPATH
----
lax $

query T
SELECT '$.1a[*]'::JSONPATH
----
$.1a[*]

query T
SELECT '$.a1[*]'::JSONPATH
----
$.a1[*]

query T
SELECT '$.a[*] ? (@.b == 1 && @.c != 1)'::JSONPATH
----
$.a[*] ? (@.b == 1 && @.c != 1)

query T
SELECT '$.a[*] ? (@.b != 1)'::JSONPATH
----
$.a[*] ? (@.b != 1)

query T
SELECT '$.a[*] ? (@.b < 1)'::JSONPATH
----
$.a[*] ? (@.b < 1)

query T
SELECT '$.a[*] ? (@.b <= 1)'::JSONPATH
----
$.a[*] ? (@.b <= 1)

query T
SELECT '$.a[*] ? (@.b > 1)'::JSONPATH
----
$.a[*] ? (@.b > 1)

query T
SELECT '$.a[*] ? (@.b >= 1)'::JSONPATH
----
$.a[*] ? (@.b >= 1)

query T
SELECT '$.a ? (@.b == 1).c ? (@.d == 2)'::JSONPATH
----
$.a ? (@.b == 1).c ? (@.d == 2)

query T
SELECT '$.a?(@.b==1).c?(@.d==2)'::JSONPATH
----
$.a?(@.b==1).c?(@.d==2)

query T
SELECT '$  .  a  ?  (  @  .  b  ==  1  )  .  c  ?  (  @  .  d  ==  2  )  '::JSONPATH
----
$  .  a  ?  (  @  .  b  ==  1  )  .  c  ?  (  @  .  d  ==  2  )

query T
SELECT '$.a.type()'::JSONPATH
----
$.a.type()

query B
SELECT '$'::JSONPATH IS NULL
----
false

query B
SELECT '$'::JSONPATH IS NOT NULL
----
true

query B
SELECT '$'::JSONPATH IS NOT DISTINCT FROM NULL
----
false

query B
SELECT '$'::JSONPATH IS DISTINCT FROM NULL
----
true

statement error invalid jsonpath
SELECT ''::JSONPATH

statement error unimplemented: column j has type jsonpath, which is not indexable
CREATE TABLE b (j JSONPATH, PRIMARY KEY(j))

statement error pq: unimplemented: column j has type jsonpath\[\], which is not indexable
CREATE TABLE c (j JSONPATH[], PRIMARY KEY(j))

statement ok
SELECT * FROM a WHERE j IS NULL

statement error unsupported comparison operator
SELECT * FROM a WHERE j = '$.a'

## Jsonpath checks that shouldn't work when the type is fully implemented

query T
SELECT '$.'::JSONPATH
----
$.

query T
SELECT 'word $'::JSONPATH
----
word $

query T
SELECT '$a'::JSONPATH;
----
$a

query B
SELECT '$'::JSONPATH IS NOT DISTINCT FROM '$'::JSONPATH
----
true

query B
SELECT '$'::JSONPATH IS DISTINCT FROM '$'::JSONPATH
----
false
