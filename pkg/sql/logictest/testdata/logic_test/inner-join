# LogicTest: local-opt fakedist-opt

statement ok
CREATE TABLE abc (a INT, b INT, c INT, PRIMARY KEY (a, c));
INSERT INTO abc VALUES (1, 1, 2), (2, 1, 1), (2, NULL, 2)

statement ok
CREATE TABLE def (d INT, e INT, f INT, PRIMARY KEY (f, e));
INSERT INTO def VALUES (1, 1, 2), (2, 1, 0), (NULL, 2, 1)

query III rowsort
SELECT * from abc WHERE EXISTS (SELECT * FROM def WHERE a=d)
----
1  1     2
2  1     1
2  NULL  2

# Test lookup inner joins created from semi-joins.
query III rowsort
SELECT * from abc WHERE EXISTS (SELECT * FROM def WHERE a=f)
----
1  1     2
2  1     1
2  NULL  2

query III rowsort
SELECT * from abc WHERE EXISTS (SELECT * FROM def WHERE a=f AND c=e)
----
1  1  2
2  1  1

query III rowsort
SELECT * from abc WHERE EXISTS (SELECT * FROM def WHERE a=f AND d+b>1)
----
2  1  1
