subtest stmt_source_equiv

query TTTII
SHOW COMPLETIONS AT OFFSET 5 FOR 'creat'
----
CREATE       NULL  NULL  NULL  NULL
CREATEDB     NULL  NULL  NULL  NULL
CREATELOGIN  NULL  NULL  NULL  NULL
CREATEROLE   NULL  NULL  NULL  NULL

query TTTII
SELECT * FROM [SHOW COMPLETIONS AT OFFSET 5 FOR 'creat']
----
CREATE       NULL  NULL  NULL  NULL
CREATEDB     NULL  NULL  NULL  NULL
CREATELOGIN  NULL  NULL  NULL  NULL
CREATEROLE   NULL  NULL  NULL  NULL

subtest end

subtest case_insensitivity

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 5 FOR 'creat']
----
CREATE
CREATEDB
CREATELOGIN
CREATEROLE

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 5 FOR 'CREAT']
----
CREATE
CREATEDB
CREATELOGIN
CREATEROLE

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 10 FOR 'SHOW CREAT']
----
CREATE
CREATEDB
CREATELOGIN
CREATEROLE

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 10 FOR 'show creat']
----
CREATE
CREATEDB
CREATELOGIN
CREATEROLE

subtest end

subtest no_completion_at_space

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 6 FOR 'creat ']
----

subtest end

subtest only_one_kw_completion

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 3 FOR 'sel']
----
SELECT

subtest end

subtest complete_before_suffix

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 3 FOR 'create ta']
----
CREATE

subtest end

subtest complete_middle_of_keyword

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 2 FOR 'select']
----
SELECT

subtest end

subtest multi_character_runes

# This completion looks strange. Is it correct?
query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 2 FOR 'ä½ å¥½ï¼Œæˆ‘çš„åå­—æ˜¯é²å‹ƒ SELECT']
----
ä½ å¥½ï¼Œæˆ‘çš„åå­—æ˜¯é²å‹ƒ

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 11 FOR 'ä½ å¥½ï¼Œæˆ‘çš„åå­—æ˜¯é²å‹ƒ SELECT']
----

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 12 FOR 'ä½ å¥½ï¼Œæˆ‘çš„åå­—æ˜¯é²å‹ƒ SELECT']
----
SELECT

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 25 FOR 'ğŸ˜‹ğŸ˜‹ğŸ˜‹ ğŸ˜‹ğŸ˜‹ğŸ˜‹']
----

query T
SELECT completion FROM [SHOW COMPLETIONS AT OFFSET 9 FOR 'JalapeÃ±o']
----

subtest end
