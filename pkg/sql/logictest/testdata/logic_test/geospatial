statement ok
CREATE TABLE geo_table(
  id int primary key,
  geog geography(geometry, 4326),
  geom geometry(point, 4326),
  orphan geography,
  FAMILY f (orphan)
)

statement ok
INSERT INTO geo_table VALUES
  (1, 'POINT(1.0 1.0)', 'POINT(2.0 2.0)', 'POINT(3.0 3.0)'),
  (2, 'LINESTRING(1.0 1.0, 2.0 2.0)', 'POINT(1.0 1.0)', 'POINT(3.0 3.0)')

query ITTT rowsort
SELECT * FROM geo_table
----
1  0101000020E6100000000000000000F03F000000000000F03F                                          010100000000000000000000400000000000000040  0101000020E610000000000000000008400000000000000840
2  0102000020E610000002000000000000000000F03F000000000000F03F00000000000000400000000000000040  0101000000000000000000F03F000000000000F03F  0101000020E610000000000000000008400000000000000840

query T rowsort
SELECT orphan FROM geo_table
----
0101000020E610000000000000000008400000000000000840
0101000020E610000000000000000008400000000000000840

query TTBTTTB rowsort
SHOW COLUMNS FROM geo_table
----
id      INT8                      false  NULL  路  {primary}  false
geog    GEOGRAPHY(GEOMETRY,4326)  true   NULL  路  {}         false
geom    GEOMETRY(POINT,4326)      true   NULL  路  {}         false
orphan  GEOGRAPHY(GEOMETRY,4326)  true   NULL  路  {}         false

statement error column bad_pk is of type geography and thus is not indexable
CREATE TABLE bad_geog_table(bad_pk geography primary key)

statement error column bad_pk is of type geometry and thus is not indexable
CREATE TABLE bad_geom_table(bad_pk geometry primary key)

statement error column geog is of type geography and thus is not indexable
CREATE INDEX geog_idx ON geo_table(geog)

statement error column geom is of type geometry and thus is not indexable
CREATE INDEX geom_idx ON geo_table(geom)

statement ok
CREATE TABLE geo_array_table(id int, geog geography array, geom geometry array)

statement ok
INSERT INTO geo_array_table VALUES (
  1,
  array['POINT(1.0 1.0)'::geography, 'LINESTRING(2.0 2.0, 3.0 3.0)'::geography],
  array['POINT(1.0 1.0)'::geometry, 'LINESTRING(2.0 2.0, 3.0 3.0)'::geometry]
)

query ITT
SELECT * FROM geo_array_table
----
1  {0101000020E6100000000000000000F03F000000000000F03F,0102000020E6100000020000000000000000000040000000000000004000000000000008400000000000000840}  {0101000000000000000000F03F000000000000F03F,0102000000020000000000000000000040000000000000004000000000000008400000000000000840}

query TT
SELECT NULL::geometry, NULL::geography
----
NULL  NULL

subtest binary_predicates

statement ok
CREATE TABLE geom_binary_predicates_test (
  id INT PRIMARY KEY,
  geom GEOMETRY
)

statement ok
INSERT INTO geom_binary_predicates_test VALUES
  (0, NULL),
  (1, 'POLYGON((-1.0 0.0, 0.0 0.0, 0.0 1.0, -1.0 1.0, -1.0 0.0))'),
  (2, 'POINT(-0.5 0.5)'),
  (3, 'POLYGON((0.0 0.0, 1.0 0.0, 1.0 1.0, 0.0 1.0, 0.0 0.0))'),
  (4, 'POINT(0.5 0.5)'),
  (5, 'POLYGON((-0.1 0.0, 1.0 0.0, 1.0 1.0, -0.1 1.0, -0.1 0.0))'),
  (6, 'LINESTRING(-0.5 0.5, 0.5 0.5)')

# TODO(otan): use ST_AsText when implemented instead of IDs.
query IIBBBBBBBBB
SELECT
  a.id,
  b.id,
  ST_Covers(a.geom, b.geom),
  ST_CoveredBy(a.geom, b.geom),
  ST_Contains(a.geom, b.geom),
  ST_Crosses(a.geom, b.geom),
  ST_Equals(a.geom, b.geom),
  ST_Intersects(a.geom, b.geom),
  ST_Overlaps(a.geom, b.geom),
  ST_Touches(a.geom, b.geom),
  ST_Within(a.geom, b.geom)
FROM geom_binary_predicates_test a
JOIN geom_binary_predicates_test b ON (1=1)
ORDER BY a.id, b.id
----
0  0  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
0  1  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
0  2  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
0  3  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
0  4  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
0  5  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
0  6  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
1  0  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
1  1  true   true   true   false  true   true   false  false  true
1  2  true   false  true   false  false  true   false  false  false
1  3  false  false  false  false  false  true   false  true   false
1  4  false  false  false  false  false  false  false  false  false
1  5  false  false  false  false  false  true   true   false  false
1  6  false  false  false  true   false  true   false  false  false
2  0  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
2  1  false  true   false  false  false  true   false  false  true
2  2  true   true   true   false  true   true   false  false  true
2  3  false  false  false  false  false  false  false  false  false
2  4  false  false  false  false  false  false  false  false  false
2  5  false  false  false  false  false  false  false  false  false
2  6  false  true   false  false  false  true   false  true   false
3  0  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
3  1  false  false  false  false  false  true   false  true   false
3  2  false  false  false  false  false  false  false  false  false
3  3  true   true   true   false  true   true   false  false  true
3  4  true   false  true   false  false  true   false  false  false
3  5  false  true   false  false  false  true   false  false  true
3  6  false  false  false  true   false  true   false  false  false
4  0  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
4  1  false  false  false  false  false  false  false  false  false
4  2  false  false  false  false  false  false  false  false  false
4  3  false  true   false  false  false  true   false  false  true
4  4  true   true   true   false  true   true   false  false  true
4  5  false  true   false  false  false  true   false  false  true
4  6  false  true   false  false  false  true   false  true   false
5  0  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
5  1  false  false  false  false  false  true   true   false  false
5  2  false  false  false  false  false  false  false  false  false
5  3  true   false  true   false  false  true   false  false  false
5  4  true   false  true   false  false  true   false  false  false
5  5  true   true   true   false  true   true   false  false  true
5  6  false  false  false  true   false  true   false  false  false
6  0  NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL   NULL
6  1  false  false  false  true   false  true   false  false  false
6  2  true   false  false  false  false  true   false  true   false
6  3  false  false  false  true   false  true   false  false  false
6  4  true   false  false  false  false  true   false  true   false
6  5  false  false  false  true   false  true   false  false  false
6  6  true   true   true   false  true   true   false  false  true
