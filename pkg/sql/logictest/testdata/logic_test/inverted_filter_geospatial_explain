# LogicTest: !fakedist-metadata !3node-tenant

# EXPLAIN test cases for using invertedFilterer on an inverted geospatial index.

statement ok
CREATE TABLE geo_table2(
  k int,
  geom geometry,
  k_plus_one int,
  PRIMARY KEY (k, k_plus_one),
  INVERTED INDEX geom_index(geom)
)

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT k FROM geo_table2 WHERE ST_Intersects('POINT(3.0 3.0)'::geometry, geom)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkl1v2jAUhu_3K6xzA0hesRM-Wl8xrWHLRIFBpG1qIpThIxYt2JltJibEf5-SdKPQgtpcJDofr_0-OWcH9lcOAubBKHgfkY3JyXA2uSP3wdfp6F04Js3bcB7NP49a5KHlZ92wQr1w6fccPfLlYzALiHWLTDk0FpfONhvTSTiOmv4VI_4VazWE-BBM7oJo9o2W0nUrAQpKSxyna7Qg7oFDQqEweonWalOmdlVDKLcgGIVMFRtXphMKS20QxA5c5nIEAVFpZIapRNNmQEGiS7O8Ora8bJEpidvBwTJQmBepsoK0Oe96Nx7vsk6P9a47vZt-7-0zyT5JlSQ-I9r9QGMh2VPQG3ewZF26QhB8T19uO1S_0TiUwyx3aNC0-bH3f_VgWxiiFRlwQWzpm1iXGidiiGO_341j5rE4Zuz_y2PRbfUJYiCo5As6hzGQE0YKk40TZMDpwD8L7L0G-JPO1MOYvGPUwmTr1Pw5nlH9X8TpajHOOHv6XHeexA3xeO8GXuvAdBbIfw3QDG2hlcUjmHMns31CAeUK6-W2emOWODV6WV1Th5NKVyUkWldXeR2Eqi6VBh-L-UWxd1nsXRT7J-Jk_-ZvAAAA___zeE2X

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT k, k_plus_one FROM geo_table2 WHERE ST_Intersects('POINT(3.0 3.0)'::geometry, geom)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUUl1v2jAUfd-vsO5LQfKKnfDR-olpDVsmCgwibVMToQxfsajBzmxnYkL89ylJtxa6IpqHRPfcc-xzcu8O7M8cBCyCcfA-IqXJyWg-vSV3wdfZ-F04Ia2bcBEtPo_b5IFyT8n9sshLu9QKG_Ia9dKl33P0yJePwTwg1i0z5dBYXDnbuphNw0nU8i8Z8S9Z-0KID8H0Nojm32gl3bQToKC0xEm6QQviDjgkFAqjV2itNhW0qwmh3IJgFDJVlK6CEworbRDEDlzmcgQBUWVkjqlE02FAQaJLs7w-trpsmSmJ2-GjZaCwKFJlBelw3vOuPd5j3T7rX3X714P-2_-AA5IqSXxGtPuBxkKyp6BL92jJunSNIPienm87VL_QOJSjLHdo0HT4ofe__WBbGKIVGXJBbOWbWJcaJ2KIY3_Qi2PmsThm7N_LY9FN_QliIKjkGcxRDOQoI4Vp6QQZcjr0XwzsvSbwJ52phzF5h1ELk21S8_twRs1_EcerxTjj7Plz1X1WX4inezf02udl8l-TaY620MriQZ6XTmb7hALKNTb7bXVpVjgzelVf05TTWlcDEq1rurwpQtW0KoNPxfyk2Dst9k6K_SNxsn_zJwAA__8jeVKx
