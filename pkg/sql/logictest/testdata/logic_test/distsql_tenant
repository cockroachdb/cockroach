# LogicTest: 3node-tenant

statement ok
CREATE TABLE t (k INT PRIMARY KEY, v INT, w INT, x INT,
   FAMILY fam_0 (k),
   FAMILY fam_1 (x),
   FAMILY fam_2 (v, w)
)

statement ok
INSERT INTO t VALUES (23, 1, 2, 3), (34, 3, 4, 8);

# TODO(harding): When we can make a more deterministic configuration for multi-
# pod, showcase actual distribution.
query T
EXPLAIN SELECT * FROM t WHERE k < 10 OR (k > 20 AND k < 29) OR k > 40
----
distribution: full
vectorized: true
·
• scan
  missing stats
  table: t@t_pkey
  spans: [ - /9] [/21 - /28] [/41 - ]

# This should be a local query, even though it uses two spans due to the column
# family configuration.
query T
EXPLAIN SELECT v, w FROM t WHERE k = 23
----
distribution: local
vectorized: true
·
• scan
  missing stats
  table: t@t_pkey
  spans: [/23 - /23]

query II
SELECT v, w FROM t WHERE k = 23
----
1  2

