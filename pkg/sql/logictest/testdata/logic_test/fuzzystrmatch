statement ok
CREATE TABLE fuzzystrmatch_table(
  id int primary key,
  a text,
  b text
)

statement ok
INSERT INTO fuzzystrmatch_table VALUES
  (1, 'apple', 'banana'),
  (2, '', 'pear'),
  (3, 'üòÑ', 'üêØ'),
  (4, null, 'a'),
  (5, 'a', null),
  (6, null, null),
  (7, 'apple', 'apple'),
  (8, 'a', 'abcd')

statement error levenshtein argument exceeds maximum length of 255 characters
SELECT levenshtein(lpad('', 256, 'x'), '')

statement error levenshtein argument exceeds maximum length of 255 characters
SELECT levenshtein(lpad('', 256, 'x'), '', 2, 3, 4)

query TTII
SELECT a, b, levenshtein(a, b), levenshtein(a, b, 2, 3, 4) FROM fuzzystrmatch_table ORDER BY id
----
apple  banana  5     18
¬∑      pear    4     8
üòÑ      üêØ       1     4
NULL   a       NULL  NULL
a      NULL    NULL  NULL
NULL   NULL    NULL  NULL
apple  apple   0     0
a      abcd    3     6

statement error levenshtein_less_equal argument exceeds maximum length of 255 characters
SELECT levenshtein_less_equal(lpad('', 256, 'x'), '', 4)

statement error levenshtein_less_equal argument exceeds maximum length of 255 characters
SELECT levenshtein_less_equal(lpad('', 256, 'x'), '', 4, 2, 3, 4)

query TTII
SELECT a, b, levenshtein_less_equal(a, b, 3), levenshtein_less_equal(a, b, 2, 3, 4, 12) FROM fuzzystrmatch_table ORDER BY id
----
apple  banana  4     13
¬∑      pear    4     8
üòÑ      üêØ       1     4
NULL   a       NULL  NULL
a      NULL    NULL  NULL
NULL   NULL    NULL  NULL
apple  apple   0     0
a      abcd    3     6


query T
SELECT soundex('hello world!')
----
H464

query TTI
SELECT soundex('Anne'), soundex('Ann'), difference('Anne', 'Ann');
----
A500 A500 4

query TTI
SELECT soundex('Anne'), soundex('Andrew'), difference('Anne', 'Andrew');
----
A500 A536 2

query TTI
SELECT soundex('Anne'), soundex('Margaret'), difference('Anne', 'Margaret');
----
A500 M626 0

query TTTI
SELECT soundex('Anne'), soundex(NULL), difference('Anne', NULL), difference(NULL, 'Bob');
----
A500  NULL  NULL  NULL
