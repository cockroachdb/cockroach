statement ok
CREATE TABLE a (id INT PRIMARY KEY)

statement ok
CREATE TABLE b (id INT PRIMARY KEY)

query TTTTI
SHOW TABLES FROM test
----
public  a  table  root  0
public  b  table  root  0

statement ok
INSERT INTO a VALUES (3),(7),(2)

query I rowsort
SELECT * FROM a
----
2
3
7

statement ok
DROP TABLE a

# The "updating privileges" clause in the SELECT statement is for excluding jobs
# run by an unrelated startup migration.
# TODO (lucy): Update this if/when we decide to change how these jobs queued by
# the startup migration are handled.
query TT
SELECT job_type, status FROM [SHOW JOBS] WHERE user_name = 'root' AND (job_type = 'SCHEMA CHANGE GC' OR (job_type = 'SCHEMA CHANGE' AND description != 'updating privileges'))
----
SCHEMA CHANGE     succeeded
SCHEMA CHANGE GC  running

query TTTTI
SHOW TABLES FROM test
----
public  b  table  root  0

statement error pgcode 42P01 relation "a" does not exist
SELECT * FROM a

statement error pq: \[53 AS a\]: descriptor is being dropped
SELECT * FROM [53 AS a]

statement error pgcode 42P01 relation "a" does not exist
DROP TABLE a

statement ok
DROP TABLE IF EXISTS a

statement ok
CREATE TABLE a (id INT PRIMARY KEY)

query I
SELECT * FROM a
----

statement ok
GRANT CREATE ON DATABASE test TO testuser

user testuser

statement ok
CREATE SCHEMA s

user root

statement ok
CREATE TABLE s.t()

user testuser

# Being the owner of schema s should allow testuser to drop table s.t.
statement ok
DROP TABLE s.t
