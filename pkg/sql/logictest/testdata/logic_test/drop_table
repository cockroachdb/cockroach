# LogicTest: default

statement ok
CREATE TABLE a (id INT PRIMARY KEY)

statement ok
CREATE TABLE b (id INT PRIMARY KEY)

query T colnames
SHOW TABLES FROM test
----
Table
a
b

statement ok
INSERT INTO a VALUES (3),(7),(2)

query I rowsort
SELECT * FROM a
----
2
3
7

statement ok
DROP TABLE a

query T colnames
SHOW TABLES FROM test
----
Table
b

statement error relation "a" does not exist
SELECT * FROM a

statement error relation "a" does not exist
DROP TABLE a

statement ok
DROP TABLE IF EXISTS a

statement ok
CREATE TABLE a (id INT PRIMARY KEY)

statement ok
INSERT INTO a VALUES (5),(6),(8)

query I
SELECT * FROM a
----
5
6
8

# DROP followed by CREATE in the same transaction.
statement ok
BEGIN

statement ok
DROP TABLE a

statement ok
CREATE TABLE a (id INT PRIMARY KEY)

statement ok
INSERT INTO a VALUES (1)

statement ok
COMMIT

statement ok
INSERT INTO a VALUES (2)

query I
SELECT * FROM a
----
1
2

statement ok
INSERT INTO b VALUES (5),(6),(8)

# DROP followed by RENAME in the same transaction.
statement ok
BEGIN

statement ok
DROP TABLE a

statement ok
ALTER TABLE b RENAME TO a

statement ok
INSERT INTO a VALUES (4)

statement ok
COMMIT

query I
SELECT * FROM a
----
4
5
6
8

statement ok
CREATE VIEW v AS select id from a

# DROP VIEW followed by CREATE in the same transaction.
statement ok
BEGIN

statement ok
DROP VIEW v

statement ok
CREATE VIEW v AS select id from a

statement ok
COMMIT

query I
SELECT * FROM v
----
4
5
6
8
