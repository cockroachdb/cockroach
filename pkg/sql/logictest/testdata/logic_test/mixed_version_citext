# LogicTest: cockroach-go-testserver-25.2

# Sanity check that CITEXT type is only allowed to be used once the cluster is
# upgraded to 25.3.

statement error pgcode 42704 type \"citext\" does not exist
CREATE TABLE c (c CITEXT);

statement error pgcode 42704 type \"citext\" does not exist
CREATE TABLE ca (ca CITEXT[]);

statement error pgcode 42704 type \"citext\" does not exist
SELECT 'A'::CITEXT

statement error pgcode 42704 type \"citext\" does not exist
SELECT ARRAY['A', 'B']::CITEXT[]

upgrade 0

statement error pgcode 0A000 citext not supported until version 25.3
CREATE TABLE c (c CITEXT);

statement error pgcode 0A000 citext not supported until version 25.3
CREATE TABLE ca (ca CITEXT[]);

statement error pgcode 0A000 citext not supported until version 25.3
SELECT 'A'::CITEXT

statement error pgcode 0A000 citext\[\] not supported until version 25.3
SELECT ARRAY['A', 'B']::CITEXT[]

upgrade 1

upgrade 2

statement ok
SET CLUSTER SETTING version = crdb_internal.node_executable_version()

statement ok
CREATE TABLE c (c CITEXT);

statement ok
CREATE TABLE ca (ca CITEXT[]);

statement ok
SELECT 'A'::CITEXT

statement ok
SELECT ARRAY['A', 'B']::CITEXT[]
