# LogicTest: default

subtest rows_from_multiple_srfs

query TTTTT
EXPLAIN (VERBOSE) SELECT * FROM ROWS FROM(information_schema._pg_expandarray(array[5,6,7]), generate_series(1,4))
----
function scan    ·     ·                                                 (x, n, generate_series)  ·
 ├── generator   ·     ·                                                 (x, n)                   ·
 │               expr  information_schema._pg_expandarray(ARRAY[5,6,7])  ·                        ·
 └── generator   ·     ·                                                 (generate_series)        ·
·                expr  generate_series(1, 4)                             ·                        ·

subtest rows_from_scalar_func

query TTTTT
EXPLAIN (VERBOSE) SELECT * FROM ROWS FROM(generate_series(1,4), greatest(1,2,4,5))
----
function scan    ·              ·                      (generate_series, "greatest")  ·
 ├── generator   ·              ·                      (generate_series)              ·
 │               expr           generate_series(1, 4)  ·                              ·
 └── values      ·              ·                      ("greatest")                   ·
·                size           1 column, 1 row        ·                              ·
·                row 0, expr 0  5                      ·                              ·


subtest rows_from_scalar_op

query TTTTT
EXPLAIN (VERBOSE) SELECT * FROM ROWS FROM(generate_series(1,4), NULLIF(1,2))
----
function scan    ·              ·                      (generate_series, "NULLIF(1, 2)")  ·
 ├── generator   ·              ·                      (generate_series)                  ·
 │               expr           generate_series(1, 4)  ·                                  ·
 └── values      ·              ·                      ("NULLIF(1, 2)")                   ·
·                size           1 column, 1 row        ·                                  ·
·                row 0, expr 0  1                      ·                                  ·

subtest rows_from_simplify

query TTT
EXPLAIN SELECT * FROM ROWS FROM (generate_series(1,3))
----
generator  ·  ·

query TTT
EXPLAIN SELECT * FROM ROWS FROM (COALESCE(1,2,3))
----
values  ·     ·
·       size  1 column, 1 row
