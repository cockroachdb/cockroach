# LogicTest: 5node-dist

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

# Prevent the merge queue from immediately discarding our splits.
statement ok
SET CLUSTER SETTING kv.range_merge.queue_enabled = false;

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW EXPERIMENTAL_RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lT9v2zAQxfd-iuLWUpCPpPxHk9csSZF2Kzyo5iEw4JgCSQNJA3_3QhKExEZyFCV7lOT3fsd3D-YbHKyh--qZPJR_AEGABAEKBGgQUMBGQO3slry3rvlJJ7gzL1DOBOwO9TE0rzcCttYRlG8QdmFPUMLv6u-eHqky5PIZCDAUqt2-xdRu91y51_XL6z8QkOUN8uEYyu9rhM1JgD2Gd18fqieCEk9iHLuYzpYp7F_WBXI5Xpx5jT--9Fdj_Itr-L_bWmfIkfnM9JMh7m1m61yen_ErvD7D4_DVIbe6XGa5Si5OAn1-DbpMoferxbGrHeg_H-svh6cn2fRUluvk3SXQF9egyxR6n628Uba9_2KsvxqenmLT01n7n5q2uwT68hp0mULvs1U3yrb3X47118PT02x6RZa8uQT2ajpbprD7XPWNcu39Vze6yh_J1_bgadAtOmvuYTJP1N3b3h7dln46u20x3eNDq2tfGPKh-yq7h7tD96kZ8KMYWbHixZIV6zMxXorVFLHmz4z83AWrXvDiOSte8uLFlEMvp4hXrBgjiSFfMoy1jK9ZZHSc1DPki4ZFZHS-ajiPyPmuxWbnyxZT823DVWR0vm9yFpHzjYvMLvnCXao3p2__AwAA__8Gyc4Q

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslsFum0AQhu99imquXYRnF-yYUw695NJUaW8VBwqjCMlhrWWRkkZ-9wqQnGDZs7vAEfA_P5_nk9fv0OiKfhQv1EL2BxAESBCgQEACAlLIBRyNLqlttek_MgYeqlfINgLq5tjZ_nYuoNSGIHsHW9sDQQa_i78HeqKiIhNvQEBFtqgPQ83R1C-Febt_ffsHAqK4r3zsbPb1HiE_CdCd_Zjb2uKZIMOT8O_-Xre2bkobp9NiZr4Mmf-ZDVeAU7Pg0J8uuVnwMbdrtKnIUDWZmp-4V5Ab71dIQxh_aWPJxBIvx3-7OX87mY8BC-T2F8soVsF6OtrPX992pp4hdKvgqVl46M83FVT680kWT0VxErw9R_sZbzdzewF0uAqemoWH_nzT7Sl_PsXiJdHwAx62PUf7Ge9u5vYC6HAVPDULD_35pttL_PkSFi-Ngnfn6D7D7WfuLoANV4BTs-DQn-72sX6l4Inao25aujjer0_e9Mc-Vc80_kdodWdK-ml0OdSMl49DbrhRUWvHpzhePDTjo_4FP4eRDSeTMF6GJRtWfLNa0pyw4ZRvTtmwlHx6y6Z3fHi3BPqODe_55v2SZnQ45pJskWXIa4YOz3CRaMibhg7VkHfNVc67hg7ZcJFtyOuGDt9wkXCSF046hJNhwuWnL_8DAAD__3evCbE=

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk9r20AQxe_9FGGuXSPNSvIfQSGHUvAlKWlurQ-qNASBozWrFSQN_u5FEjiRiWdXuz5K6zdvfn4PtG_QqIruimdqIf8NCAIkCEhAQAoCMtgJOGhVUtsq3f9kFGyrF8hjAXVz6Ez_eiegVJogfwNTmz1BDo_F3z09UFGRjmIQUJEp6v1gc9D1c6Ffb19e_4GARdRb_qj3hnR-c4s3f7o4TsqbJM_z7d3jGgTcd6Y_gd1RgOrMu2lriieCHI_CfbHvdWvqpjRRNt2KmS_nzP8Ijh7k9G0OeuKFju7s6UWD97ldo3RFmqrJ1N2RW0HGzitkcxh_KW1IRxLPx3-9OH85mY8z4uXSjeQiSq7bbMtqp_926dnsOehe7CHddoVHd_ppt6U7vWThk0WUXjd4y2on9pVn8DPQ0Ys9JHhXeHSnnwafuNMnLHy6GD4qVwzestqJfe0Z_Ax09GIPCd4VHt3pp8Gn7vQpC58trhu7ZbET-cYz9hng6EEeErorOrqzX77CfGLwQO1BNS2dXWU-nxz3Vxyqnmi8D7Wq0yX91KocbMbH-0E3vKioNeMpjg_bZjzqF_woRlacTsR4LpasOOGdkxDnlBVnvHPGiqXk1UtWveLFqxDoNSve8M6bEGe0dMxWsqCWIV8ztPQMg4qGfNPQUjXku2Yz57uGlrJhUNuQrxta-oZBhZN84aSlcHJe4XbHL_8DAAD__7pfV6Q=

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslkFr20AQhe_9FWauXSPNSoptQSGHUvAlKWlurQ-qNASBozWrFSQN_u9FEjiRiWdXuz5K6zdvPr8H2jdoVEV3xTO1kP8GBAESBCQgIAUBGewEHLQqqW2V7n8yCrbVC-SxgLo5dKZ_vRNQKk2Qv4GpzZ4gh8fi754eqKhIRzEIqMgU9X6wOej6udCvty-v_0DAMuotf9R7Qzpf3OLiTxfHSfltkeZ5vr17XIOA-870R7A7ClCdeXdtTfFEkONRuG_2vW5N3ZQmyqZrMfPlnPkfydEDnRboTp54kaM7enrR4H1u1yhdkaZqMnV35FaQsfMK2RzGX0ob0pHE8_FfL86_mczHGely4UZyGSVXbrZlt9Ofe-PZ7DnsXvAB3XZlR3f4abelO7xk2ZNllF45eMtuJ_iVZ_Az2NELPiB4V3Z0h58Gn7jDJyx7uhy-KdcM3rLbCX7tGfwMdvSCDwjelR3d4afBp-7wKcueLa8cu2WzE_rGM_YZ5OiBHhC6Kzm6o1--wnxi8EDtQTUtnV1lPp8c91ccqp5ovA-1qtMl_dSqHGzGx_tBN7yoqDXjKY4P22Y86hf8KEZWnE7EeC6WrDjhnZMQ55QVZ7xzxoql5NU3rHrFi1ch0GtWvOGdNyHOaOmYrWRBLUO-ZmjpGQYVDfmmoaVqyHfNZs53DS1lw6C2IV83tPQNgwon-cJJS-HkvMLtjl_-BwAA__8tpFef

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyklE2vojAUhvfzKyZnXQJtwQ9WbN3oxMxuwoKhJ4ZEKWlLotfw328oC69GSUuXtH19nr6p5w6tFLivLqgh_wcUCDAgwIFACgQyKAl0StaotVTjkSmwE1fIEwJN2_VmXC4J1FIh5HcwjTkj5PC3-n_GI1YCVZwAAYGmas4W06nmUqlbcb19AYEoHpGH3uS_C0oKBuVAQPbm8dPaVCeEnA5kGT5zxTNS0I949hH_oPatVAIViidiObwR3MtIdjFNXk6-Z_MnNnW_Op27esyimC_p3kNg5S7g0T5zF2CzAjyK0yUNeAis3QU8GuDuAnxWII3s_8O7AQ-BjbuARwOpu0A6K5BFS-7vgd-64hfOnzf4I-pOthqdpksyzicUJ5yGmZa9qvGPkrXFTJ8Hm7MLArWZdtn0sWvtlu3nZ5iGhNlsmNKndPKa5iHoNCSchYRXIeF1SHgTEt4GvRK_N1YOv74DAAD__2Uv0Ls=

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lk9vm0AQxe_9FNVcswjPADbh5GsuSZX2VnGgZhVZcrxowVLSyN-94o-U2A0zu1t65M_bN7-Zx7JvcDS1vq-edQvFT0BQQKAgAQUpKMigVNBYs9Nta2z_yii4q1-gWCnYH5tT198uFeyM1VC8QbfvDhoK-FH9OuhHXdXaxitQUOuu2h8Gm8bunyv7un15_Q0Kori3fDh1xdctqi1BeVZgTt370m1XPWko8Kzc7b8b22kbZ5fOW7px86JZr3cLY2ttdf23Q3n-pKB7E5kmxqtWTKXM1pH4MH9sOaJHz5NZ_zSg57gObHr2n5pO6Nf0dQA00VVJeDO7_iZk_WSJ9aU-It_H9OL1Ofv8wh49MstFNqYoTkI2CqGAqb-hmaVgWPKidf1E3Whxs8gnSu64PG0SxWnIbIUCJtpQWAqFxcSL1nW2brSYLzLbxB2Xp02j4S_sPVuhgIk2FJZCYTH1onWdrRst3i4y29Qdl6fNopDJCvYTaygqhaJi5sHqOlc3VlotfmT6xOxRt405ttrpL77qzwG6ftLjuaE1J7vT36zZDTbj5cOgG27Uuu3Gpzhe3B3HR32BH8XIiulCjNdiYsVr3jlhxSkvTllxxpedseIN77xmxTnvvPkXcc6PKuPrvuVTshJiwodMyAnyKUMSzPmcCdNGPmgoJA35qEnkfNZQ-EaQT5tEzscNc8FcCJxgzgeOhMARHziBnIRtTQgc8YGTdkU-cCQEjvz2tvL85U8AAAD__1n32lY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk9v4jwQh-_vp3g11xqFGScBcuKwl162q-7eVhyyxKoitQlyjNRuxXdfQZBS3DJjJxz5M_6NHz8e-R2atjLfyxfTQfEbEBQQKNCgIAUFGWwU7Gy7NV3X2uNf-oL76hWKuYK62e3d8euNgm1rDRTv4Gr3bKCAX-WfZ_NoysrYZA4KKuPK-vkUs7P1S2nf1q9vf0HBLDlGPuxd8f8a1Zpgc1DQ7t2wdOfKJwMFHlR4_M_WOmOT7DJ5TXdhWRST9a3uXN1sXYLeRtc4pF2N0jFRH6liFoFVX81PR2Alf6OhXLNRXMk_xhCu-dWoIWHftLYy1lQX628OXDP68yFfa2ExAq1Gf_m7q-svL9bHCHU4cxKaJXrMlRQaOG8wv8mVFLKGK_kJZ_SVjOGaR4ENvZRhYMnf6rhLGUqW_IOMv5QUTpZYsHqWpGOMFRo4g13cxFghazCWJhsbwRUXUWBDjQ0DS_5WxxkbSpb8g4w3VoeT1SzYdHZ6m0QbKzRwBru8ibFC1mCsnmxsBFdcRoENNTYMLPlbHWdsKFnyDzLe2DScbMqCzWZjfBXiz1hXN_FVyBp8TSf7GkEVVxFYQ20Nw0r-RsfZGsqV_GOc9kz_IurRdLu26Yz3XP965fnxGW-qJ9O_-bt2b7fmh223p5j-48Op7vRFZTrX_4r9h_um_-nY4MdiZIuJLya2OL8oRr9Ys8Upn5yyxRlfnE1pO2eLF3zygi3WAu4lW73ii1e8JXNBE14ygRnylqGwb-Q9Qy2U86ZJvfOqoeAa8rJhLpTzukm9877hUgjnhUPBOOSVE3on3jgS5hoJg02abJNGG_HGkTDciFeOBOVo0nwj3jgSJhzxypGgHPHKSb3zxmlhyGleOS0op3nl_N43h__-BQAA__-v0ktg

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lk9vozAQxe_7KVZzrRGZMSQpJ669tKvu3lY5sMGqIqVxZIjUbpXvvgogtQllxnazR_6M3_zmPYzfYGdrc189mwaK34CggECBBgUZKMhhpWDv7No0jXWnV_qCu_oFipmCzW5_aE-3VwrW1hko3qDdtFsDBfyq_mzNo6lq49IZKKhNW222nczebZ4r91q-vP4FBUl6knw4tMX3ElVJsDoqsIf2femmrZ4MFHhU_vI_rWuNS_Nz5ZJu_LRoUutdwrraOFOPFVbHTxq6t4ndp3gxiqGVyT50CPPHkSOGzFyVerKFLGLsOB9NRZX6xlsz_8L4OyHGAsIwC-YR_EQXbeHN5PqLmPX1NdaXZon8HLOz16fkl2fyGJBgLsApJamO2TaEBob5juMbs22EwFIYrf8H6weMi2t-sOQPznPrJM1iXBYaGKDHzDEuB8CiDqP1d9kPGJfXdFn7g_PcWdL9p4NdFhoYoMfMMS4HwGIWRuvvsh8w3l7T5cwfnOfOkxiPBfkBeUwc43EAKuYhrP4O--HS7H8drz7RfDTN3u4a4_W3n53OC6Z-Mv35orEHtzY_nF13Mv3lQ1fX3ahN0_ZPsb-42_WPTg1-LEa2mM6K8bKY2OI5r6zZ4owvztjinG87Z4sXvPKcLV7yyouvFC95q3K-71s-JTMhJnzIhJwgnzIkQZzPmeA28kFDIWnIR00i57OGwjeCfNokcj5uuBTEhcAJ4nzgSAgc8YETyEnY1oTAER84aVfkA0dC4Chsb1sdv_0LAAD__-Wy5UM=

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkTFLBDEQhXt_xTF1YJO9LpWFzTUqtrJFSIYjEDNLZiLCsf9dNinOE09Wr8zM--a9R06QKeCje0MG-woGJgVzIY_MVNZRFxzCB1itIOa5yjqeFHgqCPYEEiUhWEjkXdq9u1SRd3rQoCCguJiaflFAVc40izsiWLOofzqYwWxyGK86nA_XTCVgwfDt4g8ZHiJLzF6G8UIL9wauJdj_peML8kyZcVM3vSbEcMReh6kWj8-FfLPpz6fGtUFAlr4d--OQ26p9wlfY3AKPv8L7C1gv03L3GQAA___qN9W_

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1v2kgUhu_3V6Bztas1smds82FpJVZVpEaKkirhrvKFg6cBiWBrbKTQiP9eAaGpbTivBydzVwrPzOtznpPjV1plqbpNnlVB0XcS5JAkh3xyKCCHQoodynU2U0WR6d1PDsB1-kKR59Bila_L3X_HDs0yrSh6pXJRLhVFNE0el-peJanSrkcOpapMFsv9NblePCd6M3nZ_CSH-u7uyrt1GfUmkuKtQ9m6fDv3_bjHTW-eFPPqQRNB8TZ2qCiTJ0WR2DqX5Qvt5JNn872fs15lOlVapZWT4h2JfnLiIb8mxfxBlXe5K2o9mG5yFfWub6dX9w9XX6a9_29uyKGl-lH-PRH__KcXT_P9v34_uqg9-vtj-SZlf8h0qbQrwnql_j17ftCibKcq8nboiRC3WT_LXenVa3zy-rByvWhvleCscmXf9T_Fe4OEA1sJ5dmEFswXlswHhT-aP7jUfNm-sZJtrN93g09RzyDh0FZCeTahBfWkJfVA4Y_qDS9Vz2_fWJ9tbNDfL9uPV88g4chWQnk2oQX1fEvqgcIf1Rtdql7QvrEB29iw_yniGeQb28knz-azoF1gSTtQ9qN24494zTxx_r0q8mxVqFZvkN6uZip9UoceFNlaz9Q3nc321xw-3u25_UtEqory8K08fLheHb7aBWwPD7vAQnSiw070mKeFQc2kGTzsAtdqZkqHnegxT8s67f1J-xXYq8M-Cwd8twIWloK_OuwyHzwM5oOH0XwAGswHoMF8DLrMBw-D-eBhNB-ABvMBaDAfQ9bSES_pqMt8jLsYzsPAcB5GhgMaGA5otAFM1mbzL6nJ3jSl4RIw2pzGONBcNLZIRVUhedEFv0aA6aKxR0xUBzRwHdBIdoQD2xGOdG_sUCPdeRrpztNQd4Aj3QGOdG8s0qruA6B7Y6cY6d7YKUa68zTSnaeh7gBHugMc6d7Yp0a68zTSnaeh7gBHugMc6d7YqtV3bY_XXTZ2C6t7vP3rVwAAAP__s7hG0Q==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v4jgUxd_3UyA_7WqDgn3NX2klVjOVplLVjlreRjykxFOQKEFJkMpU_e4jYIASk3viJPDGv-N7fXzPTzHvYhGF5j54NYkY_BBSeEIJT5DwhBaeaIuxJ5ZxNDFJEsWbn-wEt-GbGLQ8MVssV-nm47EnJlFsxOBdpLN0bsRAjILnuXk0QWhivyU8EZo0mM23ZZbx7DWI18O39S_hiaa_KfmwSgeNoRLjD09Eq_S4bpIGL0YM5IdXvPbXWZLOFpPUb58WHsrM-kfJ87oxDZLpmd8fe1AuPXzev6zBACplgKzXAZ3bxHGd1SKKQxOb8GSl7Sq5baoWaPPYQvtSLSCnji10KrTgleryW5BMn0z6sPQp49RovTSDxu396Obx6ebLqPH_3Z3wxNz8TP8eyn_-i2cv0-2rw4Tlb6vrMmFPUZya2CfLtX9z1-8VsO2cI38WPdPEfdSMlr5uZT0-W75_Ul46pJcLr6-aPjnzC1Q_DGXngvxycaAWC6iUBbJeD3RuExXxIUsSrMYWkFN5BHNroTLB5JUIBiZsTzDLtaIEU8UDpNj8UNPXzggB1Q9T0b0gQhwckLVYQKUskPV6oHObqJhfVRIhNbaAnMpDiFsLlRGiroQQMGF7hFiuFUUIFQ8QsfnRze1dxw0hoPphKnoXRIiDA7IWC6iUBbJeD3RuExXzSyURUmMLyKk8hLi1UBkhdCWEgAnbI8RyrShCdPEAaTY_7aYzQEDtw0z0LwgQh_3LGgygUgbIeh3QuU1UzK4uiY8aW0BO5eHDrYXK-NBXwgeYsD0-LNfK_A1zZv1HkyyjRWIK_cPS2nhmwhezO4MkWsUT8z2OJtsyu7cPW932g9Ak6e5buXtzu9h9tWnws1hmxfKzWJ-IpZtYUhW1kpXU_Spq6vJqxTpOvOPElm7zlXmxBOfFq5WqoqZWJXWPV2vW8Q4vbjuIVVbcYcVd_qy7rBjsuceKNQh2n6dCC2DBgooTF3g1BAMvh2QAcoQGXo7YIC20nBqvgPEWW1zwANSID0COAAHkiBBIDuIiLcKcGo-s4xGTkVuYkDxkZAccO48ZtHWeM7IHilukcQo7r4Zh5-Uw7ECOws7LYdh5yipAWcWjBkwsUKOwAzkKO5CjsCM5mHjFU1aBoVP8E1xGboVd8ahRGhw7jxq0dZ40CpBGWaRxCTtQo7ADOQo7koOwAzl86ucpqwBlFY8aFHZAWXRuAJMo7ACTKOxAjiaepyyBqSH-gpyRW2EnHjUEHuiIRw3YOvGkIUAaskjjEnagRmEHchR2JAdhB3IUduIpS4CyxKMG3fIBZdG5AUyiez7AJLroAzmaeJ6yhI6dvzVn5HbYedRo8ECnedRktz7--Ot3AAAA__9B5tay

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl09v2kAQxe_9FGhOrWJkZr0miaVKVFUOkdKkSrhVHBy8JUgEW2sjhUZ89wqMSvjjfSxr3Fv48_PbeTOzj7zTNE3Uffyqcop-EZNHgjwKyCNJHoU08CjT6VDleaqXXymB2-SNoo5H42k2K5ZvDzwaplpR9E7FuJgoiqgfP0_Uo4oTpf0OeZSoIh5PVjKZHr_Get57m_8hj9r-UvJhVkStnqDBwqN0VmyemxfxSFHEC-947adUF0r74bZsjy92Hr8hnuetlzh_2QVosNgcQdgc4WP5XEP9wQn1c80GyMozbJ6T6kRplRwUPupbB8r5ofRIPaniIfPFjpX9eaai1u19_-bx6eZ7v_Xt7o48mqjfxeceX3z5qsejl_LPfx5zpcehW30HTn6fttPMF9t9qJLvbsmzxXyZxssXbT-wXjCgvh6w7jkXzMaAWhwITnCAa7ZAVp6huRXjxlZMHN9iYexw0Pal9YwD9XWHL8854xYGcC0OBCc4wDVbICvP0NyMi8ZmPDi-xYGxw7K9-kFjN-NAfd3hq3POuIUBXIsDwQkOcM0WyMozNDfjQWMzLo9vsTR2OGxbTzjQXvf3-pwTblE-11B_cEL9XLMBsvIMzc23_C__Chw41KPKs3Saq6N-5XeWZalkpEqz8nSmh-qnTocrmfLlw4pbvZGovCg_5fLF7bT8aHnAjzDvwvwRllsw28HccaJDF1o4aQugLYyOB2bHAwvHhR2847gtHbrQwklbAG1pdBy0KzTComvuV9dIX5rhS5f1MsNovQANPDPTaL0ADbSvjI5fmx2_dlkvM4zWC9BgxM00Wi9AA202Zwi6ivdu0-0EEiCC9q5Tqwwy0zCEAI5KN-MwhgCO1Pcu1W3jJTB-71a12RVAo2VBOJpYM47WBeFI3RwpqG3mSGGQKewUKoCG--IWKwCH--IWLGxOFgbRwk7ZAmi4L27pAnC4L275IpzyRZjzRYB8EU75Ami0LwhHpbvlC8KRujlfBMgX4ZQvgEb7gnA0sW75gnCkbpcvg8WnvwEAAP__lb5OxQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzE2F1r48YXBvD7_6cwc_UvKyOfMyO_QcGl3YvANilJ7oovvPY0MWQtI8mw6ZLvXmyHKtZI59Hoxb3bTfJojh5pfoz9Q-3ijb1dfbOpmv-pSAWKVaC0CpRRgYrUMlD7JF7bNI2T45-cAzeb72o-CtR2tz9kxx8vA7WOE6vmP1S2zV6smqvH1dcXe29XG5uEIxWojc1W25fTMvtk-22VvC6-v_6tAjUMj0veHbL5YMFq-Rao-JDl102z1ZNVc3oL6q_9ECeZTcLoctkFfaq8PPtc_rdtmm136yykUXGF450kG5vYzXywoMJy-RW-vg6eV-mzk16-5SNpn5E-tk1R-7pNg7rZaaO676hR3-w80Q77HleOlF8nPq9Vdp_S3NrvPclnmvQ4k1-X-UzTGjMddmVTLY9J9CclM_9ukyf7YLO7fWgKTT6-7u18cHP7-Pn-4fOvj4NfvnxRgXqxf2X_X9Cnn35Otk_P53_--9JX39ms87Zv42G8D01UrKGcuNHF-uSx46UNH_Iw1N7CgtXft_y4qbDg8rmwdDVhffoed1G4aVA4O33UNbZu4-w8096MpU4983tTqoztdia_LquMLZ-pP2PpasZy_T3H4pbTw9B4GwdWf99yk6bGgcvnxvHVjPPomyZdFG4aFM5OH3WNq9s4O8-0N-O4U0_83pQq47qdya_LKuPKZ-rPOL6acbr-ntPiljPD0ydaP-PA6u9bbtrUOHD53Dh9NeM8-qZpF4WbBoWz00dd4-o2zs4z7c043aknfm9KlXHdzuTXZZVx5TP1Z5y-mnGm_p4z4paLht7CgbXfN9ysqXDg8rlw5mrCebRNs_Z1mwZ1s9NGXd_q9s3OE-3NN9OpJX7vSZVv3c7k12WVb-Uz9eeb-U--CywZ6t6m-3iX2lpf842Ot2U3T_ZcUxofkrX9I4nXp2XO_7075U4_2Ng0O_-Wzv-52Z1_dRzwY5jEMMthLobpY3h8ESa_MLVKc9QmrU2btNFyWouNG7lxI4YjORyJc0_kseUwtUozeNhyWoOHLacNeNhjsfGpHJ54hLkYnorhmbzyTH7LxkAFYApCRVaFACvUyhWQRrCAOJIFxBEtII5sIRkXArqQzAsBX6gVMCCNhAFxRAyII2NAHCFDsjIEmCHZGQLQUCtpSKaGR-AMIVPDgBp2qPE6g8hpeAiR4_AUIsfhMUSOIyvYoeayeA2Kl6lhQA071PhYAdLIChBHVoA4sgLEkRXsUHNZPLp3mZpC3LGCZWqAFSxLwzPw0sjUaECNdqjxsQKkkRUgjqwAcWQFiMPPLPKBToMDnZap0YAa7VDjYwVIIytAHFkB4sgKEEdWaPlAp9HwMjWFuGOFlqkBVmhZGj0FL41MjQbUaIcaLyvkNLRCjkMr5Di0Qo4jK4x8oDPgQGdkagygxsgfoMBmB2lkBYgjK0AcWQHiyAoDvphCq8vUFOKOFUampmjF8u1__wQAAP__UoYtAQ==

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v2jwUxu_fT4HO1TvNKLGT8CdSpU5TpyFVdGq527hIiVeQKEFOkMqqfveJUNSF0PPEScldafKzDz6_h-NnWiWxHkePOqXwJ0kSpEiQR4J8EhTQVNDaJDOdponZvbIHRvETha6gxWq9yXb_ngqaJUZT-EzZIltqCmkS3S_1rY5ibRyXBMU6ixbLfJu1WTxGZnv5tP1DgrrObstvi2WmTdi5lJ1fG9f1Zh0VhuFoPBmQoJtNtntC0xdBySZ73fRtr_ttZx6l8-Iu-ftTQWkWPWgK5YuoV3xgX7y--Ojq1bvVv62zWSUm1kbHhZWmOxK9cuIIvkfp_E5nN2tHHrVvsl3rsDMaT65u766-Tjpfrq9J0FL_zv6_lJ8uzOJhnv_17ld_-1qeTVPuEpNp48jg-KQ-v7u-X-HYTp3I66Inihgn3WTtKPf4jE9uHxS2l9Wdk5xzjuo6XvuRsSi_V6f8c4dGthsa2VJoQFsOoenVDY2q3nbFtt3rOn771lqU369T_rmtVe1aq1qyFrTlYG2_rrVe9bZ7bNv9bn4BaNlai_IHdco_t7Veu9Z6LVkL2nKwdlDXWr9623227UG3fWctih_aF39uY_12jfVbMhY05WDs8COu1CfWv9XpOlmlutJt2d2dmY4f9L4HabIxM_3DJLN8m_3Hm5zLbz2xTrP9U7X_MFrtH-0KrA73m8BSNqKDRvSQp6XFmSk7uN8EPjozWzpoRA95Wh3T7r-0V4DdY9hjYZ_vls_CSvJbB03ywcMgHzyM8gFokA9Ag3z0muSDh0E-eBjlA9AgH4AG-eizlg54SQdN8jFsYjgPA8N5GBkOaGA4oNEEsBmb5V9Sm7lpS8MhYDU5rXGguSxNkYKqUvGiS36MANNlaY7YqA5o4DqgkewIB7YjHOlemqFWuvM00p2noe4AR7oDHOleGqRF3XtA99JMsdK9NFOsdOdppDtPQ90BjnQHONK9NE-tdOdppDtPQ90BjnQHONK9NFWLd22X112VZgur-_Tlv78BAAD__9a7lLA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FWhWrWpkzwdflq6Uqr1Vka5IlbBrWfjiabBEMLKNFBrlv1dAgeDB7_F4DLsEc2aOz7znkc07W6WxnkSvOmfhX4wzjwnmMck8ppjHemzmsXWWznWep9nuKwfBOH5jYeCxZLXeFLuPZx6bp5lm4TsrkmKpWcim0felftJRrDM_YB6LdREly_026yx5jbLtw9v2X-axrr_b8vdkWegs7Dzwzt-bIJDzjgjDcDyZDpnHHjfF7gqbfXgs3RTnTfMietEs5B9efWO_JXmRrOaF37t0Zax_lnzfdhZRvrjy_bMHYePhczi8QTr6i008slE8vN18VKWJ8zqbVZrFOtPxxUr7VSptigDYPFvo3coCSupsoe9gwWvk8o8oXzzr4nHty1JS0-1ah53xZPr16fnrr9POL9--MY8t9T_Fjw_8py9Z8rLY_1VjwgY2E_acZoXOfGmk9nPl-sMasV1L5P9Fr5iYpN107augnPHV7UcX23OLblPV9kXXl-2iD1g7TWz_huiziadRPi7wqxsQbzchVWnCkTy8IfxatICSqoKfnQVn-PE7wQ9M2BF-Rmp14Sfq10uQ7ZJdX7VLH2DtNDKDG9LHIh7eKB8X-tQNiLebkKo04Vh90ZA-LVpASVXRx86CM33EnegDJuxIHyO1uvSR9eslyXap7v79q0X6AGunkRnekD4W8fBG-bjQp25AvN2EVKUJx-rLhvRp0QJKqoo-dhac6SPvRB8wYUf6GKnVpY-qXy9FtqvXbZc9wNhpYEY3ZI9FOLxBOi7kqRsPbzcfVWnCsfaqIXlatICSqiKPnQVn8qg7kQdM2JE8RmpNfnK6sv6TztfpKte1fk0Kdpnp-EUfziBPN9lc_5ml8_02h38f97r9B7HOi8NVfvhnvDpc2hn8LOZlMf8sVhdibifm0kUtuJN65KKWA1otyMQlnbgkt-7RO9NiDs6LVgvhopaBk3pIqxWZeJ8W9yzEoizuk-IBfdYDUgzueUiKFSj2iKZCALBgQMWKC7QagoGWQzIAOUIDLUds4AZaLoMXIHiDLTZ4AGrEByBHgAByRAgkB3XhBmEug0fR0YgpyQ1McBoyvA-OncYMunWaM3wINjdIY1V2Wg3LTsth2YEclZ2Ww7LTlBWAsoJGDZhYoEZlB3JUdiBHZUdyMPGCpqwAQyfoJ7iS3Ci7oFEjFDh2GjXo1mnSCEAaYZDGpuxAjcoO5KjsSA7KDuTwqZ-mrACUFTRqUNkBZdG5AUyisgNMorIDOZp4mrISTI2kX5BLcqPskkaNBA90kkYNuHVJk0YC0kiDNDZlB2pUdiBHZUdyUHYgR2WXNGUloKykUYPe8gFl0bkBTKL3fIBJ9KIP5GjiacpKdOz0W3NJbpadRo0CD3SKRk351mcfP_wXAAD___7XJKA=

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1v2koUhvf3V1hnda_uIHvGNh-WIlFVqYoUkSph17Jw8DQgEYzGRgqN-O8VEJqCyXk9dvAuBD8zx3OelzMvtEgTPYyfdEbRd5IkSJEgnwQFJCiksaClSSc6y1KzfWQPDJJnijxBs8VylW__PRY0SY2m6IXyWT7XFNEofpjrOx0n2rgeCUp0Hs_mu22WZvYUm3X_ef2LBLXc7ZZfZvNcm8jpS-fHyvP8ieNHUTQYjrok6HaVR05f0XgjKF3lr5u-7fWwdqZxNj3epS9pvBkLyvL4UVMkN6Ja8aF98frKkR9bvXq3-rd1VovUJNro5Gil8ZZEj5w5gq9xNr3X-e3SlSftG62XOnIGw9H13f3155Hz6eaGBM31z_zfvvzvyswep7u__ry6PHn1t9fybZpyn5pcG1eGpyf1_7vrByWO7dyJvC56pohh2kqXrvJOz_js9uHR9rK8c5JzzlUt128-Mhblt6uUf-nQyGZDIxsKDWjLITTtqqFR5duu2Lb7LTdo3lqL8jtVyr-0tapZa1VD1oK2HKztVLXWL992n2170NpdABq21qL8bpXyL22t36y1fkPWgrYcrO1WtTYo3_aAbXvYat5Zi-J79sVf2tigWWODhowFTTkY2_uIK_WZ9e90tkwXmS51W_a2Z6aTR73vQZauzER_M-lkt83-4-2O2916Ep3l-2_V_sNgsf9qW2B5uFMHlrIWHdaiezwtLc5M2cGdOvDJmdnSYS26x9PqlPb-pv0j2DuFfRYO-G4FLKwkv3VYJx88DPLBwygfgAb5ADTIR7tOPngY5IOHUT4ADfIBaJCPDmtpl5e0WycfvTqG8zAwnIeR4YAGhgMaTQCbsVn8JbWZm7Y0HAJWk9MaB5rLwhQ5UlUqXnTJjxFguizMERvVAQ1cBzSSHeHAdoQj3Qsz1Ep3nka68zTUHeBId4Aj3QuD9Fj3NtC9MFOsdC_MFCvdeRrpztNQd4Aj3QGOdC_MUyvdeRrpztNQd4Aj3QGOdC9M1eO7tsfrrgqzhdV9vPnndwAAAP__u-iUug==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mEuP4kYcxO_5FFafEsXI7gePsbQSUbJRRlox0Qy3hIMXdwZLLEa2kZaM5rtHQIDBjf_ldhtuvKq7XP2vn2ze2CpL9CT-pgsW_cU485lgPpPMZ4r5rM9mPlvn2VwXRZbvfnIQPCbfWRT6LF2tN-Xu45nP5lmuWfTGyrRcahaxafx1qZ91nOg8CJnPEl3G6XK_zTpPv8X5dvx9-y_zWS_Ybfl7uix1Hnlj7v29CUM592QURY-T6Yj57GlTRt5YsNm7z7JNed60KONXzSL-7jc39ltalOlqXgb9S1djXln_LPm69RZxsbjy-7MHYePhYzi8RTr6k8ebxyNbxcO7zUfVmjivs1lleaJznVystF-l1qYIgc2zhf6tLKCkzhYGDhb8Vi7_iIvFiy6f1oGsJDXdrnXkPU6mn59fPv869X758oX5bKn_KX8c858-5enrYv_qNGH1lzW0mbCXLC91HkgjtZ9r1x81iO1aIv8vesXEJOtl60CF1Yyvbv9wsT236DZV7UD0Atkt-oC108QObog-m3ha5eMCv6YB8W4TUrUmHMnDW8KvQwsoqTr42Vlwhh-_E_zAhB3hZ6TWFH6ieb0E2S7ZC1S39AHWTiMzvCF9LOLhrfJxoU_TgHi3CalaE47VFy3p06EFlFQdfewsONNH3Ik-YMKO9DFSa0of2bxekmyX6u2fvzqkD7B2GpnRDeljEQ9vlY8LfZoGxLtNSNWacKy-bEmfDi2gpOroY2fBmT7yTvQBE3akj5FaU_qo5vVSZLv6vW7ZA4ydBubhhuyxCIe3SMeFPE3j4d3mo2pNONZetSRPhxZQUnXksbPgTB51J_KACTuSx0itzV9OV9Z_1sU6WxW60b9J4S4znbzqwxkU2Saf6z_zbL7f5vD2aa_bf5Doojx8yw9vHleHr3YGP4p5Vcw_itWFmNuJuXRRC-6kfnBRyyGtFmTikk5cklv36Z1pMQfnRauFcFHL0Ek9otWKTHxAi_sWYlEVD0jxkD7rISkG1zwixQoU-4GmQgiwYEDFigu0GoKBlkMyADlCAy1HbOAGWi6DFyB4gy02eABqxAcgR4AAckQIJAd14QZhLoNH0dGIqcgNTHAaMnwAjp3GDLp0mjN8BDY3SGNVdloNy07LYdmBHJWdlsOy05QVgLKCRg2YWKBGZQdyVHYgR2VHcjDxgqasAEMn6Du4itwou6BRIxQ4dho16NJp0ghAGmGQxqbsQI3KDuSo7EgOyg7k8K6fpqwAlBU0alDZAWXRuQFMorIDTKKyAzmaeJqyEkyNpB-QK3Kj7JJGjQQ3dJJGDbh0SZNGAtJIgzQ2ZQdqVHYgR2VHclB2IEdllzRlJaCspFGDnvIBZdG5AUyi53yASfSgD-Ro4mnKSnTs9FNzRW6WnUaNAjd0ikZN9dJn7z_8FwAA__9LeSSq

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllGL2kwUhu-_XyHn6itMiDNJ3DVQsJSFCosW17uSi6yZquA6YRJh7eJ_L0m6WKM9Z6aj6WU0z8w7cx7I-wZblclJ-iILiL8BBwYCGATAIAQGESQMcq0WsiiUrl5pgHH2CnGfwXqb78rq54TBQmkJ8RuU63IjIYZ5-ryRM5lmUvt9YJDJMl1v6m1yvX5J9X70uv8BDDy_2nK6K-PeiLORgOTAQO3KX0sfV3ze91ZpsTpd6x1JGBRlupQQ8wP7u5SRaUrBRtw1pfhjyuNSu63SmdQyO1ksqUjqlQtH_ZIWqydZTnOft-Yx3-cy7o0n84fZ08Pnee_T4yMw2Mjv5f918A8f9Xq5en_AhnU8X-BwvgvhJ8pTuc-j9k1c3Ds82ZubG8AxA3zh-cENTbXIOTDPeX1Xebeu8q5dFeZzEOgcAs8Pb-iLRc4785zX90V064vo2pfAfA4BOofQqz9Bt_LFIue9ec7r-xJ060vQtS-h-RxCdA6Rd0NbLFIOTVNe35WwW1fCf9mbLkSbySJX20IataJ-dTiZLWVzWYXa6YX8qtWi3qZ5nNZc_Y3PZFE2_4rmYbxt_qoCmsMDF3joAnOn3DzCaW5xZcIOHrjAQxeYO-VuXdkZLdp0_3c6wO87QGF-emf9Nh26CI7DhOA4TAiOw5TgBE0IHrkIjsOE4DhMCI7DlOAETQg-cBH8zkVRHCYUxWFCURymFCVoQtF7F0VxmFAUhwlFcZhSlKAJRYcuinKnnkDQhKQETVhK0JSmFE51Bbey4NYW3OqCY19wKwzcqTHws8pgZStOU7biNGUrTpO2Ejhlq01ZOp-ZTVuypSlbrfqSNU7ZelYeUFuTw38_AwAA__8RXVfC

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4kwYxe_fTyFz9S5E4jOT-A8WXHYLWyjt0nq3eJGa2SpYI0mEuqXffVFZrYl5zkzGdC-t_WVOTp5zMuOrWCaxvo2edSaGPwUJT0jhCSU8EQhPhGLiiVWaTHWWJen2X_bAdfwihh1PzJerdb7988QT0yTVYvgq8nm-0GIoxtHjQt_rKNap3xGeiHUezRe7ZVbp_DlKN6OXzW_hiba_XfJunQ9bI_JGUkzePJGs8-Olszx60mJIb5758t_mWT5fTnM_PF373BJH6nHTmkXZ7DxyVCJtlLw3goydkN6IKp1QtZygJqwIKqUcL7VeJmmsUx2fXGx3lUqxsoPFHlWETakwsOyoouugwqsl9HuUzR50frfyVcGv8Walh63r2_HV_cPV13Hry82N8MRC_8r_393Ep8_p_Gn294NZAHuXdfk2aScrX4VFJ86u3T9ZmywixyXOl21f1WkfIOAwQN3G28fGCgsvLPrH1AtqwoygUopj8ql-_1xQhYFlVf1jp8K5f-ij-0eaD75k5161_aBOBwABh4fYa7wDLKwgCy8sOsDUC2rCjKBSimP6ZP0OuKAKA8uqOsBOhXMHyI_uAGU--Iqd-6C9OyhYdwAQcHiI_cY7wMIKsvDCogNMvaAmzAgqpTimT9XvgAuqMLCsqgPsVDh3gProDgjMBz9g5z5s12kAsPzhEQ4abwALI8jYCYv8mzpBTVgRVEpxTF5QP_8XVGFgWVX-7VQ45z_4l79DnJF2r7NVssy00a8Mne3N6fhJ783KknU61T_SZLpbZv_xbsft_hDrLN9_S_sP18v9V1uB72EqwvQeDk5gsoNJOtEDF1p2XWileFqyjiveccUuHfIr8zAB3TwtO050z4VWYNIC1nHwsEMLWBbhLguDm-7xg9LlJ6XP0gMeHrgEm4dRsAENgs3TKNg8jYJNoEtRmfK1ArINaBRugKN0IxxMOsBRvomvVEJ4qV04vJRx4usF3TrfLwRSTqWGsXoF8zR8BwMcvYR5HL6FeRymla9X6gPjS_1qlVaehmnlcZhWgKOR5XGY1lLLnhgvCWyf-JYt4KW0ylLV2KRV8k0jwe5N8vsYYBygUVoRDtIKcJRWgMNNM1-yMgTGl1rWJq2ARmkFOEorwtHI8jhKq-S3sLIPcL5lC3g5rfwuFt063zSqA85apaaxSSugUVoRDtIKcJRWgKO0Kr5klQTGl1rW6pTL0_CYy-PwnAtwdNDlcZRWxW9lFbKOb9kCXkqr4veyxVufvP33JwAA___vJvVt

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1r4kAUhu_3V8hc7dJIPCdRq7DgshS2UNql9W7xIjWzVbBGkgh1i_998QOsSXPeOYq5qx9vZvJknnfGvpt5Etv76NVmpv_HkPEMG88ExjOh8UzbjDyzSJOxzbIk3XxlF7iN30y_5ZnpfLHMN2-PPDNOUmv67yaf5jNr-mYYPc_so41im_ot45nY5tF0th1mkU5fo3Q1eFv9M55p-pshH5Z5vzEgb8BmtPZMsswPl87y6MWaPq099-GfkjS3qd8-HnnAV9JYh_jzqjGJskkhTWa0PsyHNfP5iIM0PIJKHsEJPOiSQMLKCR2uk6SxTW1cnsVoE3b41if39ivKJk82f1j4XCA7XC1sv3F7P7x5fLr5OWz8uLsznpnZv_nXAX37nk5fJtu_DgwqabdPoM1F2nRVef3OyfCoAst90kwWfnCMpGr47tHwpFjM0lr2uekHp9gNJrDn26nNbg0QHRFXv92I0CWRhJUTqs1vqslvN9pcpO3sN7uvJxaXU9D0w1MEAxPY32C3NsEUQEhHxFUwNyJ0SSRh5YRqE4xrEsyNNhdpOwsWuK-nQFxOYXN7iFQLBiawv8Hr2gRTACEdEVfB3IjQJZGElROqTbCgJsHcaHORtrNgoft6CsXl1G6eohcYfn97vdr0UuAgDQ9Xudx40CWBhJUTqk2usCa53GhzkfZJP_8-uf6jzRbJPLNOv-xaG2Y2frG7J5Ely3Rsf6fJeDvM7uXDNrd9I7ZZvvuUdi9u57uPNhP8GKZimD6Gw6Mw6cJEZ6W756Q5OCvdk9MsEg9k4oGCOOvCBeLadPecdIG4Nt2T06FIvC0Tb4vhjvysO_KzBnp1xfS1HL4-x005jNwEaeCmnEZugjRwsye3YQvUYalMNXaCNNITxYGfII4ERXFgKJUq9Rg8A_BypwJJqdQux4OHYPBSvah2QTkNt0EQR_ugHIcbIYgD20juVuoA8KV2Vekmp6FuII50k-NQNxBHusk7C4GthUolq9JNLlkGJcuaki0fvlQlq44D3UAc6Ybi6OAplyyDkuVSyWp0A2mkG4oD3UAc6YbiQDeWNxgGGwzL51egG8sly6BkWVOy5cFVJauOI91UJauOI93kkmVQsqw5wJeXnOoEr44j3VRneHUc6SZvMAHYYAL5XyJF3UbrL_8DAAD__1z9cyQ=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9r40YUBfD3foowTy0rI8-dK8c2FFzahQaWpCR5K37w2tPEkLWMJMOmS7774j-gWBPfM6OR_bZJ9miujmZ-yP6hVvnC3s6-2VKN_1VaJYpUooxKFKtEZWqaqHWRz21Z5sX2v-wDN4vvatxP1HK13lTbX08TNc8Lq8Y_VLWsXqwaq8fZ1xd7b2cLW6R9laiFrWbLl90y62L5bVa8Tr6__q8S1Uu3S95tqvHVRCcTUtO3ROWbqr50Wc2erBrrt8R_-Ye8qGyRZscrT-iT31oUstZfy7JaruZVqhs3OtH1ao2l6vTX16vnWfnsJKdv9TgmZJz3zessoHpzsg5uUT01y_DtPmvVPTUfdVfdD06OU19ns8qLhS3s4uhKu6ucHNi4m-VUI9fnGsHt7NQIw4gRklZT_j0rnx9sdbdOudHU4-vajq9ubh8_3z98_vPx6o8vX1SiXux_1a8T_dvvxfLpefevkxugvq1Ri43NTmufTpvV9-jto0oOV_1gitu8l6_TrN8s-eP1j9HUAXJIcKTUS00btcEAh4YHnagN1qrV1hdRO6T7QVD5vm77lU_NOtq57ds-NR_2edzW3aHpbhc_tzscwe3Mz-2wEaLd1hdy229js9Oat9vkf3ZJPLqml3IbN8EAhzu87sRNsFbtJl3EzYDu9XVQ-b5u-pVPzTrauenbPjUf9nncpO7QcreLn5sdjuB25udm2AjRbtKF3PTb2Oy05u2m8T-7Rjy63Nt9lA92EwxwuMNhJ26CtWo3zUXcDOheD4PK93XTr3xq1tHOTd_2qfmwz-Om6Q4td7v4udnhCG5nfm6GjRDtprmQm34bm53WvN1k_7PL4tHNem3UBMsf7m_UiZpgrVpNvoiaAc3rUUD1vmb6VU_NMtqZ6ds9NR_1eczk7sByN4ufmR2O4HbmZ2bYCNFm8oXM9NvY7LTW6rvVDxa4t-U6X5XW62vT_rY0u3iy-4dQ5ptibv8p8vlumf2Pd7vc7hcLW1b7v-r9Dzer_Z-2A74PazFMcpiaYf0-PDgK67Cwvo5JU1TaRKUZpI3YOMuNsxjO5HAmzg3GlsN6GJOmqLSJSjNID8TGQfg6IEzN8FAMj-RnPZJR6Mtza9mUDKEiq6IBK9o5YMdxA-LOCQthCaSRSyCOYAJxJBOII5q0zIsGvmjnpB3HByDuHLUQn0AaAQXiSCgQR0SBODJKy87oEYjL0jTijlNatob64CUCvL8Aqgi8waBXGNkaAtZQlDUgDd-B4qwBcfgWFGcNydYQsIZkawhYQ1HWgDSyBsSRNSCOrAFxZA3J1hCwhmRrCFhDsjUGWGPirDGyNQZYY2RrDLDGRFkD0sgaEEfWgDiyBsThRy7ZGgOsMbI1BlhjoqwBaWQNiCNrQBxZA-LIGiNbY4A1RrbGAGuMbA0DazjOGpatYWANy9YwsIajrAFpZA2II2tAHFkD4sgalq1hYA3L1jCwhqOsAWlkDYgja0AcWQPiyBqWrWFgDcvWMLCGZWsyYE0WaM307ZefAQAA__-hbRsd

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4koYxu_Pp5C5OodG4rwTtQoHPBwKWyjt0nq3eJGa2SpYI0mEusXvvhgFa2Z9n3kV413982Qmv8zvmbGfap4m9jF-t7nq_1BaBYpUoIwKVKQC1VajQC2ydGzzPM02X9kG7pMP1W8FajpfLIvN26NAjdPMqv6nKqbFzKq-GsavM_ts48RmYUsFKrFFPJ2Vwyyy6XucrQYfq18qUM1wM-TTsug3BjoYkBqtA5Uui_2l8yJ-s6qv14H_8C9pVtgsbB-OPKAbbqx9_HXVmMT5pJLWarTez4ck8_mKQ4t4BANzFIk5AYl2mQQDcwPGlKGJjs5rf500S2xmE_cBjTZh9K1yyuWQ1dv8FueTF1s8LUKqcB6uFrbfuH8c3j2_3P0_bPz38KACNbM_i78H-p9_s-nbpPxrj-Io-PYJ4KkKXt8cvX7nZID6CJbHtJkuQnOI5Njw3YPhtWBpcys7pGZoTnEdTGDHt1Ob6xIgQiL-tvtB0S6VC9uur2W7rsl2P_BUBe9tO_mvLmIXl2mG0Sm6gQnsbrBbm24CIFpIxF83PyjapXJh3ehaulFNuvmBpyp4b92M_-oy7OKKmuVxU6wbmMDuBm9r000ARAuJ-OvmB0W7VC6sm7mWbqYm3fzAUxW8t26R_-qK2MXVbp4iGxh-d3u92mQT4NAiHv6q-SHRLpMLqxZdS7WoJtX8wFMV_Ek_G_9w_WebL9J5br1-EbY2zGzyZrdPI0-X2dh-z9JxOcz25VOZK99IbF5sP9XbF_fz7UebCX4N62pYfw1HB2EtC2t9Vrp7TprMWekenyaWuOGJGwFxkoUrxKXp7jnpCnFpusenI5Z4myfeZsMd_ll3-GcN9Oqy6Vs-fHuOm3wYuQnSwE0-jdwEaeBmj2_DFqhDp0wldoI00hPFgZ8gjgRFcWCodir1EDwB8HynAkm10y6Hg0dgcKdeRLsgn4bbIIijfZCPw40QxIFtmu9W3QHgnXYV6canoW4gjnTj41A3EEe68TuLBluLdkpWpBtfsgRKliQl6x6-RCUrjgPdQBzphuLo4MmXLIGSJadkJbqBNNINxYFuII50Q3GgG_EbDIENhvjzK9CN-JIlULIkKVl3cFHJiuNIN1HJiuNIN75kCZQsSQ7w7pITneDFcaSb6AwvjiPd-A3GgA3G8P8Sqeo2Wv_1OwAA__-5bIE5

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9r40YUBfD3foowTy2RkefOlf9BwaVdaGBJSpK34gevPU0MWctIMmwa8t0X_wHFmvieGY_st02yx3N1ZuaHkje1zOf2dvrdlmr0r9IqUaQSZVSiWCUqU5NErYp8ZssyLzb_ZRe4mf9Qo26iFsvVutp8e5KoWV5YNXpT1aJ6sWqkHqffXuy9nc5tkXZVoua2mi5etsusisX3afE6_vH6v0pUJ90sebeuRldjnYxJTd4Tla-r-qPLavpk1Ui_J_7LP-RFZYs0O1x5TNd-a1HIWn8tymqxnFWpbjzoWNerNZaq099er56n5bOTnLzX45iQcT42r7OQ6pOxOdoIn9A-Nfug62Rsrr3XzE7aBWpuelu70Ds6Tv0562VezG1h5weftP2UowMb99gca6R_rhHczo6NMIgYITlpyr-n5fODre5WKTeaenxd2dHVze3jl_uHL38-Xv3x9atK1Iv9r_p1rH_7vVg8PW__dfQA1I81POF8s9Pa9XG9uh69fVbJ_lM_meI27-SrNOs2S_58_UM-dYAhEiEpdVJzit9ggH3DvVb8BmvVfuuL-B3SfS-sfH_B_fqnZiNRgvvuAzW3_TyC6_b4dA-On-AtjuB25id42AjRgusLCe53vtlpzVtw8r_FJF5i00n5FEHBAPsn7LciKFirFpQuImhA97ofVr6_oH79U7ORKEF994Ga234eQak9vtyD4ydoiyO4nfkJGjZCtKB0IUH9zjc7rXkLavxvsREvMXe2v-gHCwoG2D_hoBVBwVq1oOYiggZ0rwdh5fsL6tc_NRuJEtR3H6i57ecR1LTHl3tw_ARtcQS3Mz9Bw0aIFtRcSFC_881Oa96Csv8tZvESZ51T_ATL759v2IqfYK3aT76InwHN62FI9f56-rVPzT6i9PTdBWpu-nn05Pboco-Nn54tjuB25qdn2AjRevKF9PQ73-y0dtLfYD9Z4N6Wq3xZWq8_r3Y3pdn5k91tQpmvi5n9p8hn22V2X95tc9tvzG1Z7X6qd1_cLHc_2gz4MazFMMlhaob1x3DvIKzDwrofk6aotIlKM0gbsXGWG2cxnMnhTJwbjC2H9SAmTVFpE5VmkO6JjYNwPyBMzfBADA_lvR7KKHTlubVsSoZQkVXRgBXtXLDDuAFx54aFsATSyCUQRzCBOJIJxBFNWuZFA1-0c9MO4z0Qd65aiE8gjYACcSQUiCOiQBwZpWVn9BDEZWkacccpLVtDXfASAd5fAFUE3mDQK4xsDQFrKMoakIbvQHHWgDh8C4qzhmRrCFhDsjUErKEoa0AaWQPiyBoQR9aAOLKGZGsIWEOyNQSsIdkaA6wxcdYY2RoDrDGyNQZYY6KsAWlkDYgja0AcWQPi8Fcu2RoDrDGyNQZYY6KsAWlkDYgja0AcWQPiyBojW2OANUa2xgBrjGwNA2s4zhqWrWFgDcvWMLCGo6wBaWQNiCNrQBxZA-LIGpatYWANy9YwsIajrAFpZA2II2tAHFkD4sgalq1hYA3L1jCwhmVrMmBNFmjN5P2XnwEAAP__gaclQA==

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl09v4kgUxO_7KdA77WobmdfdJomllViNIk2kKBkl3EYcHNwTkAi2bCOFifjuI_5oCP-63G7w3AL4Rz3X63KFD5qmiXmI30xB0XdiEiRJkCJBmgSFNBCU5enQFEWaLy9ZA3fJO0UdQeNpNiuXbw8EDdPcUPRB5bicGIqoH79MzJOJE5MHHRKUmDIeT1YyWT5-i_N5733-kwS1g6Xk46yMWj0peooGC0HprNx-dVHGr4YiXojq8s9pXpo8CHeVe_Lf31osenJPa4u_zFujuBjt0UyDxXYe6TLPZzv4PH6oGn7wJQ3RJwfafk-aJyY3yeEUgyVc4aoj9_Y1LkbPpnzMArnnbH-emah199C_fXq-_dJv_X9_T4Im5kf5d4__-S8fv45Wf209OOl2WOHmZtNjgx-d-SFtp1kgw70rj2t3d7TZ4aTZDlog24GqEz0wwOaodRuLnosh53JE1XCEL2mJPjlQY-HjhsInq-9bWtet2oGuEwAwwGbdV40FwMEQPpcjqoYjfElL9MmBGguAbCgAqvq-lXXdur36D8k5AGCAzbqvGwuAgyF8LkdUDUf4kpbokwM1FgDVUAB09X1r67rDdp3jD-Q3y75p7Pg72MHn8UPV8IMvaYg-OVBjh1__gd8eRyZ6MkWWTgtT6ZdFZ3lPJnk1a6eKdJYPzbc8Ha5k1i8fV9zqjcQU5fpTXr-4m64_Wg74GeZ9mD_DegdmN5g7XnToQ0svbQm0pdVxZXdcOTgu3eA9x13p0IeWXtoSaGur42BdoRWWXfu-ulb6yg5f-cTLDqN4ARp4ZqdRvAANtK-tjt_YHb_xiZcdRvECNDjidhrFC9BAm-0dgh7FB0_T3QaSoIIOHqdOHWSnYQkBHN26HYc1BHCkfvBQ3TVeA-MPnqouWQE0CgvC0Ym14yguCEfq9kpBa7NXCoNOYa9SATTMi1-tABzmxa9Y2N4sDKqFvboF0DAvfu0CcJgXv36RXv0i7f0iQb9Ir34BNMoLwtGt-_ULwpG6vV8k6Bfp1S-ARnlBODqxfv2CcKTu1i-DxV-_AgAA__-X82_y

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl09v4kgUxO_7KdA77WobmdfdJomllViNIk2kKBkl3EYcHNwTkAi2bCOFifjuI_5oCP-63G7w3AL4Rz3X63KFD5qmiXmI30xB0XdiEiRJkCJBmgSFNBCU5enQFEWaLy9ZA3fJO0UdQeNpNiuXbw8EDdPcUPRB5bicGIqoH79MzJOJE5MHHRKUmDIeT1YyWT5-i_N5733-kwS1g6Xk46yMWj0peooGC0HprNx-dVHGr4YiXojq8s9pXpo8CHeVe_Lf31osenJPa4u_zFujuBjt0UyDxXYe6TLPZzv4PH6oGn7wJQ3RJwfafk-aJyY3yeEUgyVc4aoj9_Y1LkbPpnzMArnnbH-emah199C_fXq-_dJv_X9_T4Im5kf5d4__-S8fv45Wf209OOl2WOHmZtNjgx-d-SFtp1kgw70rj2t3d7TZ4aTZDlog24GqEz0wwOaodRuLnosh53JE1XCEL2mJPjlQY-HjhsInq-9bWtet2oGuEwAwwGbdV40FwMEQPpcjqoYjfElL9MmBGguAbCgAqvq-lXXdur36D8k5AGCAzbqvGwuAgyF8LkdUDUf4kpbokwM1FgDVUAB09X1r67rDdp3jD-Q3y75p7Pg72MHn8UPV8IMvaYg-OVBjh1__gd8eRyZ6MkWWTgtT6ZdFZ3lPJnk1a6eKdJYPzbc8Ha5k1i8fV9zqjcQU5fpTXr-4m64_Wg74GeZ9mD_DegdmN5g7XnToQ0svbQm0pdVxZXdcOTgu3eA9x13p0IeWXtoSaGur42BdoRWWXfu-ulb6yg5f-cTLDqN4ARp4ZqdRvAANtK-tjt_YHb_xiZcdRvECNDjidhrFC9BAm-0dgh7FB0_T3QaSoIIOHqdOHWSnYQkBHN26HYc1BHCkfvBQ3TVeA-MPnqouWQE0CgvC0Ym14yguCEfq9kpBa7NXCoNOYa9SATTMi1-tABzmxa9Y2N4sDKqFvboF0DAvfu0CcJgXv36RXv0i7f0iQb9Ir34BNMoLwtGt-_ULwpG6vV8k6Bfp1S-ARnlBODqxfv2CcKTu1i-DxV-_AgAA__-X82_y

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpgQZ5K4a6BgKQsVFi2udyUXWTNVwXXCJMLaxXcvSbpYo56T6eD0Muo38-ecD_zfYKsyOUlfZAHxD-DAQACDABiEwCCChEGu1UIWhdLVTxpgnL1C3Gew3ua7svo4YbBQWkL8BuW63EiIYZ4-b-RMppnUfh8YZLJM15v6mlyvX1K9H73ufwEDz6-unO7KuDfibCQgOTBQu_LP0ccTn_e9VVqsTs96RxIGRZkuJcT8wP4tZeQypbia8njUbqt0JrXMTg5LKpL6yYVX_ZYWqydZTnOft_Yx3-cy7o0n84fZ08PXee_L4yMw2Mif5cc6-KfPer1cvT8cx9CawfHlAouXu5B8ojyV-zxqj-Hi3eHJ3bz7-jm2fl94fnBDTQ1yDtzmFFdzOhCVOxVVdF-CQJcQeH54Q1kMct65zSmu5nQgi3AqS9B9CQG6hNCr_3luJYtBznu3OcXVnA5kCZzKEnZfQoguIfJuqIpByqHLlOJqSgeihP-tK13INZNFrraF7NSE-tWbyWwpm0kVaqcX8rtWi_qa5nFac_X_eiaLsvlWNA_jbfNVFbA7PLCBhzYwt8rNI5zmBiMTZvDABh7awNwqd2tkZ7Ro0_2_6QCfd4DC_HRm_TYd2giOw4TgOEwIjsOU4ARNCB7ZCI7DhOA4TAiOw5TgBE0IPrAR_M5GURwmFMVhQlEcphQlaELRextFcZhQFIcJRXGYUpSgCUWHNopyq55A0ISkBE1YStCUphROdQW7smDXFuzqgmVfsCsM3Kox8LPKYGQrTlO24jRlK06TthI4ZatJWTrfmUlbMqUpW436kjFO2XpWHlBbk8OH3wEAAP__BoVUrA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4loUxd_vp5D9dC9E4j4n8R9c6OVOYQqlHVrfBh9Sc6YK1kgSoU7pdx9URmti9srJn86jtb-cdVb2WjnxjVZRaO6CF5PQ-DsxOaTIIU0OeeSQT1OH1nE0M0kSxbt_OQA34SuNew4tVutNuvvz1KFZFBsav1G6SJeGxjQJnpbmwQShid0eORSaNFgs98us48VLEG-vXrc_yaGuu1vyfpOOO1fsXCmavjsUbdLTpZM0eDY05nen_PJfFkm6WM1S1z9f-9ISJ-pp25kHyfwyclKibJR8NIKbcUJXcoLbsMIrlHK61GYVxaGJTXh2sf1VCsWqHhZ7UuG3paKEZScV_RoqnEpCvwbJ_NGk92tXZ_yabNdm3Lm5m1w_PF7_P-n8d3tLDi3Nj_Tv_Sb--TdePM9_fziNXeHmBs1afBd1o7Wr_awNF9cenq3NFnmT4uaqrqurVA8QcJyefuvVY2NFU17oSl5wG2Z4hVJqxp6rl0-DKkpYVlQ-dipqlw9_avmo8lOvxKHXXderUgBAwPEODlovAAsruCkvdCUvuA0zvEIpNaOnqhdAgypKWFZUAHYqaheA-tQC0OWnXotD73X37wfWBQAEHO_gsPUCsLCCm_JCV_KC2zDDK5RSM3q6egE0qKKEZUUFYKeidgHoTy0Ar_zUe-LQ-90q8QfLH-_fqPX4WxjBzTihKznBbVjhFUqpGTuvevgbVFHCsqLw26moHX7vj_32cEHXg0nW0SoxpX5Z6O12ZsJnc3AqiTbxzHyLo9l-mcPH-z23_0NokvTwLR8-3KwOX-0EfoQ5C_NH2DuD2Q5mVYse1aFVvw6ttUwr0XEtO67FpX15ZRlmoFumVa8WPahDazBpnug4uNm-BayycF-EwaYH8qD05UkZivRIhkd1gi3DKNiABsGWaRRsmUbBZtClqEzlWgHZBjQKN8BRuhEOJh3gKN8sVyojPNcuEp7LOMv1grYu9wuDlHOuYawewTINn8EARw9hGYdPYRmHaZXrlYfA-Fy_WqVVpmFaZRymFeBoZGUcpjXXsmfGKwbHJ7llM3gurSpXNTZpVXLTKHB6U_I5BhgHaJRWhIO0AhylFeDw0CyXrPKB8bmWtUkroFFaAY7SinA0sjKO0qrkI6waAlxu2QyeT6t8ikVbl5tG98C7Vq5pbNIKaJRWhIO0AhylFeAorVouWa2A8bmWtXrLlWn4mivj8D0X4OhFV8ZRWrV8lNXIOrllM3gurVo-y2a3Pn3_61cAAAD__5LJ8lc=

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ls9q20AQh-99CjOnlq6RdiX5j6DgUgINhCQkORSKDoq1jQ2OJVYyxA1-92I7JpXlzE9r2brFsb7Z0cw3nn2leZro6_hZ5xT-JkmCFAnySJBPggKKBGUmHes8T836kS1wmbxQ6AqazrNFsf53JGicGk3hKxXTYqYppIf4cabvdJxo47gkKNFFPJ1tjsnM9Dk2y9HL8i8J6jrrI28WRdgZKYpWgtJF8Rb3PdzjsjOJ80k50EhStIoE5UX8pCmUK3FcfkHd_GSj_NSH-b3HWcxTk2ijk1KkaE2iRw685M84n9zr4iZz5F4PHpaZDjsXv35c3D50vl9dkaCZ_lN8Hskv38z0abL568P3fn8nz6bm96kptHFksF-mrx_G92vU7FA53oIeSOI67aaZo9z9Ah88PigdL-srJTmlHNV1vLNIb5Fhr36Gp9Retqu9bEN7UPWd9r1jtVf1u6rYrnpdxz-LdxYZ9utneErvVLveqTa8A1Xfedc_1juvflc9tqt-d7NjT--dRYaD-hme0juvXe-8NrwDVd95NzjWO79-V322q0H3LNZZ5Desm98pnfPbdc5vwzlQ851zw1NcLQ_Ev9N5ls5zXevW6K4LppMnvW1Ani7MWN-adLw5ZvvxZsNt7g6Jzovtt2r74XK-_WqdYH243wSWshEdNKKHPC0taqbs4H4TeK9mtnTQiB7ytNqn3f9prwS7-7DHwj7fLZ-FleSPDprMBw-D-eBhNB-ABvMBaDAfvSbzwcNgPngYzQegwXwAGsxHn7V0wEs6aDIfwyaG8zAwnIeR4YAGhgMabQCbtVn9JbXZm7Y0XAJWm9MaB5rLyhYpqSoVL7rk1wgwXVb2iI3qgAauAxrJjnBgO8KR7pUdaqU7TyPdeRrqDnCkO8CR7pVFWta9B3Sv7BQr3Ss7xUp3nka68zTUHeBId4Aj3Sv71Ep3nka68zTUHeBId4Aj3StbtXzXdnndVWW3sLpHq0__AgAA__-EA0JE

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1rOkcUxu_7KeRctXRlnRdfoWBpAw2EJCS5KBQvNu40CsaV3RViQ757Uf9q3HHPM-Ou3vn2zDnzzHl-7PhJ8yQ299G7yWjwDwkKSFJAigLSFFCbRgEt0mRssixJ1z_ZCm7jDxq0AprOF8t8_fEooHGSGhp8Uj7NZ4YG9BK9zsyTiWKThi0KKDZ5NJ1tyizS6XuUroYfq_8ooGa4LvmwzAeNoaTRV0DJMj-sm-XRm6GB-Arca_85zfLpfJyH7ePCQ1FY_yB5XTUmUTY58ftDD9Knh-_7F84GFBs8FFdnGSDqdUCXNnFYZzlP0tikJj5aabNKaZuyBdo8tNC-VAvIqUMLnQotBGd1-VeUTZ5N_rAIVcGpl9XCDBo3f_9x8_jS-P3ujgKamX_zn4fil9_S6dtk88phvLo-4_WcpLlJQ2VZ9mvp-j0Hz07Z8WPRE03cJ81kEepW0eCT5ftH5YVHdLnkhrIZKm94ger7iexcEF4-DnhY4IovVwtEvR7o0iYqskOcia8aW0BOleHLr4XK-BLXwBcYrx2-LMtc8SXd0yPZ8KhmqL35AarvR6J7QX54OCA8LHDlh6sFol4PdGkTFcMrz-RHjS0gp8r44ddCZX7Ia_ADjNeOH5ZlrvxQ7ulRbHh0c3PF8eMHqL4fid4F-eHhgPCwwJUfrhaIej3QpU1UDK86kx81toCcKuOHXwuV-aGuwQ8wXjt-WJa58kO7p0ez4Wk3vekBau8Hon9BenjsXzgb4MoOVwNEvQ7o0iYqBlefyY4aW0BOlbHDr4XK7NDXYAcYrx07LMvO-evlxPpPJlsk88w4_avSWhtm4jezPYAsWaZj85gm402Z7duHjW7zQWyyfPut2L65nW-_Wjf4XSyKYvFdrI_Ewk8sVBW1FJXU_Spq1eXVknVc8Y4rtnSbr8yLBTgvXi1lFbVqVVL3eLVmHe_w4raHWBbFHVbc5c-6y4rBnnusWINg93kqtAAWLKh4cYFXQzDwckgGIEdo4OWIDcJCy7HxEhhvscUHD0CN-ADkCBBAjgiB5CAuwiLMsfHIOh4xBbmFCcFDRnTAsfOYQVvnOSN6oLhFGq-w82oYdl4Oww7kKOy8HIadp6wElJU8asDEAjUKO5CjsAM5CjuSg4mXPGUlGDrJP8EV5FbYJY8aqcGx86hBW-dJIwFppEUan7ADNQo7kKOwIzkIO5DDp36eshJQVvKoQWEHlEXnBjCJwg4wicIO5GjiecoqMDWKvyAX5FbYFY8aBR7oFI8asHXFk0YB0iiLND5hB2oUdiBHYUdyEHYgR2FXPGUVoKziUYNu-YCy6NwAJtE9H2ASXfSBHE08T1mFjp2_NRfkdth51GjwQKd51BS3Pvr66f8AAAD__wCg0iU=

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1r20wUhffvrzB39ZbIyHc0chJBwaVkEUiTkGRRKF4o1tQxOJYYyRA3-L8XW6b-nqPxyNr5Q4_O3HPv1dEnTdJE3cfvKqfoFzF5JMijgDyS5FFIfY8ynQ5Unqd6cUkJ3CYfFHU8Gk2yabH4ue_RINWKok8qRsVYUUQv8etYPak4UdrvkEeJKuLReCmT6dF7rGe9j9kf8qjtLyQfpkXU6gnqzz1Kp8X6vnkRDxVFPPeqaz-nulDaD7dle3yxc_s18TprvcX52y5A_fn6CMLmCJvlcw31ByfUzzUbII-eYX2fVCdKq-SgcKWrDpTzQ-mhelbFQ-aLHStfZpmKWjc_v988vrS-3d2RR2P1u_i_xxdfvurR8K38-M9gPmpwWKG46eTQwQ-e-T5tp5kvwp0rD2t3t7TZYrJMg-WLth9YrxZQX41W95yrZWNALQ4EJzjANVsgj56hueXiZpZLVO-vMLY3aPvSesCB-qq9l-cccAsDuBYHghMc4JotkEfP0NyAi2YGPKje38DYXtlevsTYDThQX7X36pwDbmEA1-JAcIIDXLMF8ugZmhvwoJkBl9X7K43tDdvW4w20V829Pud4W5TPNdQfnFA_12yAPHqG5oZbNv_uf-BETyrP0kmuKr3ZdxY1qWSoSqfydKoH6lGng6VM-fVhyS1_SFRelP9y-eV2Uv61OOAmzLswb8JyC2Y7mDtOdOhCCydtAbSF0fHA7Hhg4biwg3cct6VDF1o4aQugLY2Og3aFRlh0zf3qGulLM3zpsl5mGK0XoIFnZhqtF6CB9pXR8Wuz49cu62WG0XoBGoy4mUbrBWigzeYMQY_ivafpdgIJEEF7j1OrDDLTMIQAjko34zCGAI7U9x6q28ZLYPzeU9VmVwCNlgXhaGLNOFoXhCN1c6SgtpkjhUGmsFOoABrui1usABzui1uwsDlZGEQLO2ULoOG-uKULwOG-uOWLcMoXYc4XAfJFOOULoNG-IByV7pYvCEfq5nwRIF-EU74AGu0LwtHEuuULwpG6Xb705__9DQAA___30EpA

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Etv20YUBeB9f4UwqxahQN07Q72AAiraLAKkcZB4UaDQQpGmtgBHFEgKiGv4vxd6oLQ45D0cPrRLbB_O5SHnw0gvahdv7KfVd5uq-d-KVKBYBUqrQBkVqEgtA7VP4rVN0zg5_sk58GHzQ81Hgdru9ofs-ONloNZxYtX8RWXb7MmqubpffXuyX-xqY5NwpAK1sdlq-3RaZp9sv6-S58WP539VoIbhccm7QzYfLFgtXwMVH7L8umm2erBqTq9B_bW_xklmkzC6XnZB7yovzz6X_2ObZtvdOgtpVFzheCfJxiZ2Mx8sqLBcfoVvz4PHVfropJev-UjaZ6S3bVPUvm7ToG522qjuO2rUNztPtMO-x5Uj5deJz2uV3ac0t_Z7T_KZJj3O5NdlPtO0xkyHXdlUy2MS_UnJzH_a5MF-tdndPjSFJu-f93Y-eP_X7-8_3w9--_hRBerJ_pP9vKB3v_yabB8ez__8_42vvq1Zi9sqmflTPIz3oYmKBZTjNrpanDz2urTVQx6G2ttWsPpls4-b2goun9tKN7PVp-9xF4WbBoWz00ddXes2zs4z7U1X6lQyvzelStduZ_LrskrX8pn605VuoyvX33As7jc9DI03cGD1y36bNAUOXD4Hjm8GnEffNOmicNOgcHb6qAtc3cbZeaa9AcedYuL3plQB1-1Mfl1WAVc-U3_A8W2A0_U3nBb3mxmePsX6AQdWv-y3aVPgwOVz4PTNgPPom6ZdFG4aFM5OH3WBq9s4O8-0N-B0p5j4vSlVwHU7k1-XVcCVz9QfcPo2wJn6G86I-y0aevMG1r7stllT3sDlc97MzXjzaJtm7es2Depmp426uNXtm50n2htuplNI_N6TKty6ncmvyyrcymfqDzdz-y__Sib6YtN9vEttra_2Rsd7spsHe-4ojQ_J2n5O4vVpmfN_70650w82Ns3Ov6Xzfz7szr86Dvg2TGKY5TAXw_Q2PL4Kk1-YWqU5apPWpk3aaDmtxcaN3LgRw5EcjsS5J_LYcphapRk8bDmtwcOW0wY87LHY-FQOTzzCXAxPxfBMXnkmv2VjoAIwBaEiq0KAFWrlCkgjWEAcyQLiiBYQR7aQjAsBXUjmhYAv1AoYkEbCgDgiBsSRMSCOkCFZGQLMkOwMAWiolTQkU8MjcIaQqWFADTvUeJ1B5DQ8hMhxeAqR4_AYIseRFexQc128BsXL1DCghh1qfKwAaWQFiCMrQBxZAeLICnaouS4e3btMTSHuWMEyNcAKlqXhGXhpZGo0oEY71PhYAdLIChBHVoA4sgLE4WcW-UCnwYFOy9RoQI12qPGxAqSRFSCOrABxZAWIIyu0fKDTaHiZmkLcsULL1AArtCyNnoKXRqZGA2q0Q42XFXIaWiHHoRVyHFohx5EVRj7QGXCgMzI1BlBj5A9QYLODNLICxJEVII6sAHFkhQFfTKHVZWoKcccKI1NTtGL5-tN_AQAA__95kCh8

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1r40gQhu_7K0yddtk2UrckfwgCWZYMEwhJSHwYmPFBsXpig2OZlgzxhPz3QXJMRpZTr1qKdYsjPapy1_O69EKrJNbX0ZNOKfxOkgQpEuSRIJ8EBTQVtDbJTKdpYvJbdsBl_EyhK2ixWm-y_N9TQbPEaApfKFtkS00hTaKHpb7TUayN45KgWGfRYlmUWZvFU2S258_bXySo7-QlvyyWmTZh71z2fmxc15v1VBiGl9eTEQm62WT5FZq-Cko22VvR91oP2948SuflKsX9U0FpFj1qCuWraNZ8YN-8Pvvs7tWH3b8_Z7NKTKyNjktPmuYkuuXIEXyN0vm9zm7WjjwY32S71mHv4tv_F7eT3n9XVyRoqX9mf5_Lf87M4nFe_PXh937_Tp7NRO4Tk2njyODwmP798Pl-jTM7dhxvDz3SxHXST9aOcg8P-Gj5oFRe1hdOcsI5qu943efFov1Bk_ZPnRjZbWJkF4kBM9knZtA0Mar-zBU7c6_v-N0ra9H-sEn7p1ZWdaus6kJZMJO9ssOmynr1Z-6xM_f7xd7vWFmL9kdN2j-1sl63ynpdKAtmsld21FRZv_7MfXbmQb97YS2aH9s3f2pd_W519bvQFUxkr-v4M16jjzz_TqfrZJXqWm_Ibn5gOn7UuwGkycbM9K1JZkWZ3cebgitedmKdZruravfhcrW7lDdYHx62gaVsRQet6DFPS4szU3bwsA18cGa2dNCKHvO0OqTdP2mvBLuHsMfCPj8tn4WV5EsHbfLBwyAfPIzyAWiQD0CDfAza5IOHQT54GOUD0CAfgAb5GLKWjnhJR23yMW5jOA8Dw3kYGQ5oYDig0QawWZvVX1KbvWlLwyVgtTmtcaC5rGyRkqpS8aJLfo0A02Vlj9ioDmjgOqCR7AgHtiMc6V7ZoVa68zTSnaeh7gBHugMc6V5ZpGXdB0D3yk6x0r2yU6x052mkO09D3QGOdAc40r2yT61052mkO09D3QGOdAc40r2yVcvv2i6vu6rsFlb36etfvwMAAP__P5uQKA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v8kYcxO_9FGhPrWpk7wtvlh4pVftUjRQlUcKhUsvBwdtgiWBkGyk0ynevgALBi__j9RpuCWZ2x7P_-cnmgy3SWN9Hbzpn4V-MM48J5jHJPKaYx3ps4rFllk51nqfZ5is7wW38zsLAY8liuSo2H088Nk0zzcIPViTFXLOQjaOXuX7SUawzP2Aei3URJfPtNssseYuy9c37-l_msa6_2fL3ZF7oLOzc8M7fqyCQ044Iw_D2fjxkHntYFZsrbPLpsXRVHDfNi-hVs5B_evWN_ZbkRbKYFn7v1JWx_lHysu7Monx25vtHD8LGw9dweIN09DebeGSjeHi7-ahKE8d1Vos0i3Wm45OVtqtU2hQBsHm00LuUBZTU0ULfwYLXyOUfUT571sXD0pelpMbrpQ473__89fvjuPPL3R3z2Fz_U_x4w3_6liWvs-1fNcZrYDNez2lW6MyXRmQ_V64_rJHZuTj-X_SMifu0my59FZQDPrv96GR7blFsqte-6PqyXe4Ba4dx7V-QezbxNMrHhXx1A-LtJqQqTThihzckX4sWUFJV5LOz4Ew-fg3ygfHak8-IrC75RP1uCbJasuurdtEDrB3mZXBB9FjEwxvl44KeugHxdhNSlSYcey8aoqdFCyipKvTYWXBGj7gGesB47dFjRFYXPbJ-tyRZLdXdvna1iB5g7TAvwwuixyIe3igfF_TUDYi3m5CqNOHYe9kQPS1aQElVocfOgjN65DXQA8Zrjx4jsrroUfW7pchq9brtggcYO0zL6ILgsQiHN0jHBTt14-Ht5qMqTTh2XjXETosWUFJV2LGz4IwddQ3sgPHaY8eIrMnPTGfWf9L5Ml3kutYvSMEmMB2_6t0B5Okqm-rHLJ1ut9n9-7DVbT-IdV7srvLdP7eL3aWNwa9iXhbzr2J1IuZ2Yi5d1II7qUcuajmg1YJMXNKJS3LrHr0zLebgvGi1EC5qGTiph7RakYn3aXHPQizK4j4pHtBnPSDF4J6HpFiBYo9oKgQACwZUrLhAqyEYaDkkA5AjNNByxAZuoOU0eAGCN9higwegRnwAcgQIIEeEQHJQF24Q5jR4FB2NmJLcwASnIcP74NhpzKBbpznDh2BzgzRWZafVsOy0HJYdyFHZaTksO01ZASgraNSAiQVqVHYgR2UHclR2JAcTL2jKCjB0gn6CK8mNsgsaNUKBY6dRg26dJo0ApBEGaWzKDtSo7ECOyo7koOxADp_6acoKQFlBowaVHVAWnRvAJCo7wCQqO5CjiacpK8HUSPoFuSQ3yi5p1EjwQCdp1IBblzRpJCCNNEhjU3agRmUHclR2JAdlB3JUdklTVgLKSho16C0fUBadG8Akes8HmEQv-kCOJp6mrETHTr81l-Rm2WnUKPBAp2jUlG998vnDfwEAAP__h_QgGA==

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2koQhu_Pr7Dm6hydRfaubT4sRaKqUjVSlEQJF5VaLhy8DUgEo7WRQiP-ewWEpmAyr9cOzl0pPDvjnefN-JlmaaKv4kedUfSdJAlSJMgnQQEJCmkoaG7Skc6y1Kx_sgUukieKPEGT2XyRr_97KGiUGk3RM-WTfKopokF8P9W3Ok60cT0SlOg8nkw3ZeZm8hibZf9p-YsEtdx1yS-Taa5N5PSl82Pheb4-c2QURRdXgy4Jul7kkdNXNFwJShf5S9XXYvdLZxxn4_0yfUnD1VBQlscPmiK5EtW6D-27Hzn--zav3mz-9ZzFLDWJNjrZO2m4JtFPjtzA1zgb3-n8eu7Kg_ENlnMdOeffPp_fDJxPl5ckaKp_5v_25X9nZvIw3vzrz3PLg-d-fSbfZiB3qcm1cWV4eE3_v3l-UOLOjl3Hy6FHmrhKW-ncVd7hBR8tH-6Vl-V9k5xvrmq5_gfkxaL_dpX-T5wY2WxiZBOJASPZJaZdNTGq_MgVO3K_5QYfoKxF_50q_Z9YWdWssqoJZcFIdsp2qirrlx-5z448aG3WftPKWvTfrdL_iZX1m1XWb0JZMJKdst2qygblRx6wIw9bHyCsRfc9--5PrGvQrK5BE7qCgex07b3Ha_SR8291Nk9nmS71huytL0wnD3o7gCxdmJG-MeloU2b78XrDbV52Ep3l22_V9sPFbPvVusHycKcOLGUtOqxF93haWtyZsoM7deCDO7Olw1p0j6fVIe39Tft7sHcI-ywc8NMKWFhJvnRYJx88DPLBwygfgAb5ADTIR7tOPngY5IOHUT4ADfIBaJCPDmtpl5e0WycfvTqG8zAwnIeR4YAGhgMabQCbtVn8S2qzN21puASsNqc1DjSXhS2yp6pUvOiSXyPAdFnYIzaqAxq4DmgkO8KB7QhHuhd2qJXuPI1052moO8CR7gBHuhcW6b7ubaB7YadY6V7YKVa68zTSnaeh7gBHugMc6V7Yp1a68zTSnaeh7gBHugMc6V7Yqvvv2h6vuyrsFlb34eqf3wEAAP__4CmQMg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mEuP4kYcxO_5FFafEsXI7gcvSysRJRtlpNXMapdDpISDF3cGSyxGtpGGjOa7R0CAwY3_5XYbbryqu1z9r59sXtkqS_Rj_F0XLPqLceYzwXwmmc8U81mfzXy2zrO5Loos3_3kIHhIXlgU-ixdrTfl7uOZz-ZZrln0ysq0XGoWsWn8bam_6DjReRAynyW6jNPlfpt1nn6P8-3kZfsv81kv2G35e7osdR55E-79vQlDqT94PIqih8fpiPnsaVNG3kSw2ZvPsk153rUo42fNIv7mN3f2W1qU6WpeBv1LWxNeWf8s-bb1FnGxuPL7swdh4-F9OrxFPHNPNk9HtkqHdxuPqjVxXmezyvJE5zq5WGm_Sq1NEQKbZwv9W1lASZ0tDBws-K1c_hEXi6-6fFoHspLUdLvWkffxz18_fp56v3z6xHy21P-UP074Tx_y9Hmxf3Uar_prGtqM19csL3UeSCOyn2vXHzXI7Foc_y96xcRj1svWgQqrAV_dfnyxPbfoNVXrQPQC2TH3gLfTvA5uyD2bfFoF5EC-pvnwbgNStSYcscNbkq9DCyipOvLZWXAmH78H-cB4HclnRNaUfKJ5tQTZLNkLVMfoAd5OAzO8IXos8uGtAnJAT9N8eLcBqVoTjr0XLdHToQWUVB167Cw4o0fcAz1gvI7oMSJrih7ZvFqSbJbq7Z-6ukQP8HYamNEN0WORD28VkAN6mubDuw1I1Zpw7L1siZ4OLaCk6tBjZ8EZPfIe6AHjdUSPEVlT9Kjm1VJks_q9jsEDnJ3GZXxD8Fikw1vE44CdpunwbuNRtSYcO69aYqdDCyipOuzYWXDGjroHdsB4HbFjRNbmb6Yr63_RxTpbFbrRP0jhLjCdPOvDARTZJp_rz3k2329zePu01-0_SHRRHr7lhzcPq8NXO4Pvxbwq5u_F6kLM7cRcuqgFd1KPXdRySKsFmbikE5fk1n16Z1rMwXnRaiFc1DJ0Uo9otSITH9DivoVYVMUDUjykz3pIisE1j0ixAsUe01QIARYMqFhxgVZDMNBySAYgR2ig5YgN3EDLZfACBG-wxQYPQI34AOQIEECOCIHkoC7cIMxl8Cg6GjEVuYEJTkOGD8Cx05hBl05zho_A5gZprMpOq2HZaTksO5CjstNyWHaasgJQVtCoARML1KjsQI7KDuSo7EgOJl7QlBVg6AR9B1eRG2UXNGqEAsdOowZdOk0aAUgjDNLYlB2oUdmBHJUdyUHZgRze9dOUFYCygkYNKjugLDo3gElUdoBJVHYgRxNPU1aCqZH0A3JFbpRd0qiR4IZO0qgBly5p0khAGmmQxqbsQI3KDuSo7EgOyg7kqOySpqwElJU0atBTPqAsOjeASfScDzCJHvSBHE08TVmJjp1-aq7IzbLTqFHghk7RqKle-uzth_8CAAD__2gGICI=

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1r2zAUhu_3K8K52kDGkWynjWGQMQorlKZ0uRgMX7ixlgTS2MgONCv578P2SpaPnSPtJN6lEz_SK50H_L7CKs_0ffqsS4i_gwQBCgQEICAEAREkAgqTT3VZ5qZ-pQVusxeI-wIWq2Jd1T8nAqa50RC_QrWolhpimKRPS_2o00wbvw8CMl2li2WzTWEWz6nZjF42P0GA59dbjtdV3BtJMVKQbAXk6-r30rsVnza9eVrO99d6QxIBZZXONMRyK_4tZWSbUomR5KZUf025W2q9yk2mjc72FktqknrlxFG_pOX8q67GhS8P5jHZFDru3Xz7fPMw6X26uwMBS_2jet-k_vDRLGbztwdsUrvDBYzDnUh-n3t54cvo8BpO7h3u7S3txy-x8fvK84MLauqQc2Cf8_yiym5FlZ2KquyHoNAhBJ4fXlAWh5xX9jnPL4vqVhbVqSyB_RACdAih13x5LiWLQ85r-5znlyXoVpagU1lC-yGE6BAi74KqOKQc2qY8vyhht6KE_60rncj1qMsiX5Xaqgn165PpbKbbmyrztZnqB5NPm23ax3HDNd_1TJdV-69qH25X7V91QHt4wIGHHFiycssIp6XDlSk3eMCBhxxYsnIfXNkRrQ7p_p90gN93gMJy_876h3TIERyHCcFxmBAchynBCZoQPOIIjsOE4DhMCI7DlOAETQg-4Ah-xVEUhwlFcZhQFIcpRQmaUPSaoygOE4riMKEoDlOKEjSh6JCjqGT1BIImJCVowlKCpjSlcKor8MoCry3w6gKzL_AKg2Q1BnlUGZxsxWnKVpymbMVp0lYCp2x1KUvHM3NpS640ZatTX3LGKVuPygNqa7J99ysAAP__OltTOg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r2zAUxd_3KYKeNnBwrmTnHwwytsIKpS1dHwYjD26sNYE0DrYDzUq_-0jCksaO75GsuHtM0591fHzPsZQXsUhifR096UwMfwkSnpDCE0p4IhCeCMXYE8s0megsS9LNv-yAy_hZDDuemC2Wq3zz57EnJkmqxfBF5LN8rsVQ3EcPc32no1infkd4ItZ5NJtvl1mms6coXY-e13-EJ9r-ZsmbVT5sjcgbSTF-9USyyg-XzvLoUYshvXrmy3-bZflsMcn98HjtU0scqId1axpl09PIQYm0UfLWCDJ2QnojqnRC1XKCmrAiqJRyuNRqkaSxTnV8dLHtVSrFyg4We1ARNqXCwLKDiq6DCq-W0O9RNv2h85ulrwp-3a-Xeti6-Pn14va-9eXqSnhirn_nH7d38OlzOnuc_vtglr7eeS2-TtrJ0ldh0YaTa_eP1iaLvHFx82XbV3WqBwjYT0-38eqxscLCC4vyMfWCmjAjqJTiGHuqXz5nVGFgWVX52KlwLh961_KR5lMv2aFXbT-oUwBAwP4J9hovAAsryMILiwIw9YKaMCOolOIYPVm_AM6owsCyqgKwU-FcAPJdC0CZT71ihz5ob88H1gUABOyfYL_xArCwgiy8sCgAUy-oCTOCSimO0VP1C-CMKgwsqyoAOxXOBaDetQAC86kP2KEP23XiD5bfP79B4_G3MIKMnbAIv6kT1IQVQaUUx9gF9cN_RhUGllWF306Fc_iD__bbwwlddzpbJotMG_2y0NncmY4f9c6pLFmlE32bJpPtMruPN1tu-4dYZ_nuW9p9uFzsvtoIfAtTEaa3cHAEkx1M0okeuNCy60IrxdOSdVzxjit26ZBfmYcJ6OZp2XGiey60ApMWsI6Dhx1awLIId1kY3HSPH5QuPyl9lh7w8MAl2DyMgg1oEGyeRsHmaRRsAl2KypSvFZBtQKNwAxylG-Fg0gGO8k18pRLCS-3C4aWME18v6Nb5fiGQcio1jNUrmKfhOxjg6CXM4_AtzOMwrXy9Uh8YX-pXq7TyNEwrj8O0AhyNLI_DtJZa9sh4SWD7xLdsAS-lVZaqxiatkm8aCXZvkt_HAOMAjdKKcJBWgKO0AhxumvmSlSEwvtSyNmkFNEorwFFaEY5GlsdRWiW_hZV9gPMtW8DLaeV3sejW-aZRHXDWKjWNTVoBjdKKcJBWgKO0AhylVfElqyQwvtSyVqdcnobHXB6H51yAo4Muj6O0Kn4rq5B1fMsW8FJaFb-XLd76-PXD3wAAAP__OP3w5Q==

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1r4kAUhu_3V8hc7dJIPCdRq7DgshS2UNrS9mJh8SI1s1WwRpIIdYv_ffEDrElz3jmKuasfb2byZJ53xr6bWRLb2-jVZqb_x5DxDBvPBMYzofFM2ww9M0-Tkc2yJF1_ZRu4jt9Mv-WZyWy-yNdvDz0zSlJr-u8mn-RTa_rmKXqe2gcbxTb1W8Yzsc2jyXQzzDydvEbpcvC2_Gc80_TXQ94t8n5jQN6AzXDlmWSR7y-d5dGLNX1aee7DPyZpblO_fTjygC-ksfbx52VjHGXjQprMcLWfD2vm8xEHOfNgbxBU8giO4EHnBBJWTmh_nSSNbWrj8iyG67DDtz65t19RNn60-d3c5wLZp-Xc9htXv39e3T81ftzcGM9M7d_864C-fU8nL-PNX3sAlajbR6DmImq6qLx-52hyVMHkNmkmcz845FE1fPdgeFKsZGkh-9z0g2PUBhPY8e3UprYGiIKIQm43InROJGHlhGqTm-qQ2w01F1E7y83ui4nFtRQ0_fAYu8AEdjfYrc0uBRBSEFHY5UaEzokkrJxQbXZxHXa5oeYiame7AvfFFIhrKWxuzo5qu8AEdjd4WZtdCiCkIKKwy40InRNJWDmh2uwK6rDLDTUXUTvbFbovplBcS-3mMW6B4Xe316vNLQUOcuahMMuNB50TSFg5odrMCuswyw01F1Ef9ZPvk-s_2GyezDLr9GuutQZm4xe7fQxZskhH9j5NRpthti_vNrnNG7HN8u2ntH1xPdt-tJ7gxzAVw_QxHB6ESRcmOindPSXNwUnpnpxmkXggEw8UxFkXLhDXprunpAvEtemenA5F4m2ZeFsMd-Rn3ZGfNdCrK6Yv5fDlKW7KYeQmSAM35TRyE6SBmz25DVugDktlqrETpJGeKA78BHEkKIoDQ6lUqYfgGYCXOxVISqV2ORw8BIOX6kW1C8ppuA2CONoH5TjcCEEc2EZyt1IHgC-1q0o3OQ11A3GkmxyHuoE40k3eWQhsLVQqWZVucskyKFnWlGz58KUqWXUc6AbiSDcURwdPuWQZlCyXSlajG0gj3VAc6AbiSDcUB7qxvMEw2GBYPr8C3VguWQYly5qSLQ-uKll1HOmmKll1HOkmlyyDkmXNAb685FQneHUc6aY6w6vjSDd5gwnABhPI_xIp6jZcffkfAAD__4H1bqE=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9r20gUBfD3_RRhnnapjDx3Rv4HC152C1soTWnzsLD4wbVnE0NqGUmGZkO-e_EfUKyJ77mjkf3WJD2aq6OZH7Kf1Tpfuk_z765Uk3-VVokilSijEmVVojI1S9SmyBeuLPNi918OgQ_LH2rST9RqvdlWu1_PErXIC6cmz6paVY9OTdTd_Nuj--LmS1ekfZWopavmq8f9Mpti9X1ePE1_PP2vEtVLd0vebqvJzVQnU1Kzl0Tl26q-dFnN752a6JdEvvzXvKhckWanK0_pnWwtClnrr1VZrdaLKtWNG53qerXGUnX629PNw7x88JKzl3ocEzLO6-Z1Jq2ekqk5W4dtUT01y5B2n7XqnpqPuqvuB2fHqa-zXefF0hVueXKl_VXODmz8zXKukeGlRvA7OzfCKGKEpNWUf8_Lh6-uut2kttHU3dPGTW7e__Pn-893N398_KgS9ej-q36d6t9-L1b3D_t_nX369T2NW-xq61X27jxYfUFpb_VxvOobU3zKe_kmzfrNht9e_1RMHcAGp0ZKvdS0IRsMcGx40AnZYK2abH0VskO6H8jLD0BbVj4162iHtrR9aj7sy6CtuxPT3y4ytDscwe9MhnbYCNFo62ugLdvV1qtMjDbJDy6x59b0UtsGTTDA8Q6HnaAJ1qrRpKugGdC9HsrLD0BTVj4162iHprR9aj7sy6BJ3YnlbxcZmh2O4HcmQzNshGg06Rpoyna19SoTo2nkB9ew59b29p_gg9EEAxzvcNQJmmCtGk1zFTQDutcjefkBaMrKp2Yd7dCUtk_Nh30ZNE13YvnbRYZmhyP4ncnQDBshGk1zDTRlu9p6lYnRtPKDa9lzm_XakAmWP97fuBMywVo1mfYqZAY0r8fS6gPAlFVPzTLagSntnpqP-jJg2u608jeLDMwOR_A7k4EZNkI0mPYaYMp2tfUqa_V96hsLfHHlJl-XTvRVaX_XmFveu8MTKPNtsXCfi3yxX-bw4-0-t__F0pXV4a_68MOH9eFPuwFfhzUbJj5MzbB-HR6chHVYWA9j0hSVNlFpC9KGbdzyjVs2nPHhjJ0bjM2H9SgmTVFpE5W2ID1gGwfhYUCYmuERGx7zz3rMo9Dn59a8KRlChVdFA1a0d8BO4wbEvRMWwhJII5dAHMEE4kgmEEc0aZ4XDXzR3kk7jQ9A3DtqIT6BNAIKxJFQII6IAnFklOad0WMQ56VpxD2nNG8N9cFLBHh_AVQReINBrzC8NQSsoShrQBq-A8VZA-LwLSjOGuKtIWAN8dYQsIairAFpZA2II2tAHFkD4sga4q0hYA3x1hCwhnhrDLDGxFljeGsMsMbw1hhgjYmyBqSRNSCOrAFxZA2Iw49cvDUGWGN4awywxkRZA9LIGhBH1oA4sgbEkTWGt8YAawxvjQHWGN4aC6yxcdZY3hoLrLG8NRZYY6OsAWlkDYgja0AcWQPiyBrLW2OBNZa3xgJrbJQ1II2sAXFkDYgja0AcWWN5ayywxvLWWGCN5a3JgDVZoDWzl19-BgAA___gtBaa

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4koYxu_Pp5C5OodG4rwTtQoHPBwKWyhtaXuxsHiRmtkqWCNJhLrF774YBWtmfZ95FeNd_fNkJr_M75mxn2qWJvY-fre56v9QWgWKVKCMClSkAtVWw0DNs3Rk8zzN1l_ZBG6TD9VvBWoymy-K9dvDQI3SzKr-pyomxdSqvnqJX6f2ycaJzcKWClRii3gyLYeZZ5P3OFsOPpa_VKCa4XrIh0XRbwx0MCA1XAUqXRS7S-dF_GZVX68C_-Gf06ywWdjeH3lAV9xYu_jrsjGO83ElrdVwtZsPSebzFYcW8QgG5iAScwQS7TIJBuYKjClDEx2c1-46aZbYzCbuAxquw-hb5ZTLIau3-S3Ox8-2eJiHVOH8spzbfuPm-_83jy-N_-7uVKCm9mfx90D_8282eRuXf-04HKTePoI6Vanrq4PX7xxNTx9gcp8203lo9nkcGr67N7wWrGtuWYfUDM0xooMJbPl2ahNdAkRIxF91PyjapXJm1fWlVNd1qO5HnarUvVUn_6VF7MoyzTA6xjUwge0NdmtzTQBEC4n4u-YHRbtUzuwaXco1qsM1P-pUpe7tmvFfWoZdWVGzPGWKXQMT2N7gdW2uCYBoIRF_1_ygaJfKmV0zl3LN1OGaH3WqUvd2LfJfWhG7strNY0wDw29vr1ebaQIcWsTD3zM_JNplcmbPokt5FtXhmR91qlI_6qfiH67_ZPN5Osut16_A1hqYTd7s5lHk6SIb2ccsHZXDbF4-lLnyjcTmxeZTvXlxO9t8tJ7g17CuhvXXcLQX1rKw1ielu6ekyZyU7vFpYokbnrgRECdZuEJcmu6ekq4Ql6Z7fDpiibd54m023OGfdYd_1kCvLpu-5sPXp7jJh5GbIA3c5NPITZAGbvb4NmyBOnTKVGInSCM9URz4CeJIUBQHhmqnUvfBEwDPdyqQVDvtsj94BAZ36kW0C_JpuA2CONoH-TjcCEEc2Kb5btUdAN5pV5FufBrqBuJINz4OdQNxpBu_s2iwtWinZEW68SVLoGRJUrLu4UtUsuI40A3EkW4ojg6efMkSKFlySlaiG0gj3VAc6AbiSDcUB7oRv8EQ2GCIP78C3YgvWQIlS5KSdQcXlaw4jnQTlaw4jnTjS5ZAyZLkAO8uOdEJXhxHuonO8OI40o3fYAzYYAz_L5GqbsPVX78DAAD__1x4fLE=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9rGzkUBfD3_RRBT7tkjK2rO_4HC152C1soTWnzsLD4wbW1iSH1mJkxNFvy3Yv_wMRSfI9kjf3WJD3WnSPpxyQ_1KpY2I-zb7ZS43-VVpkilSmjMsUqU7maZmpdFnNbVUW5_S_7wPvFdzXuZWq5Wm_q7benmZoXpVXjH6pe1k9WjdX97OuT_WxnC1t2eypTC1vPlk-7Zdbl8tusfJ58f_5fZarT3S55t6nHNxOdTUhNXzJVbOrmo6t69mDVWL9k4ct_Kcralt38eOUJ3YatRTFr_bWs6uVqXne186AT3azmLNWkvz7fPM6qRy85fWnGMTHjvG5e5zHVZxNzshE-o31y-6DbbGJug9fMz9oFcje9rV3onxyn-ZzNqigXtrSLo0_afcrJgY1_bE41MrjUCH5np0YYJoyQnTXl37Pq8Yut79Zddpq6f17b8c27f_589-n-5o8PH1Smnux_9a8T_dvv5fLhcfevk7vfPNPojMPNXmW3p-nqBZT2Vh-HT31jio9Fp1h3857b8NvrH9upIwCR_OhSp2vOwRsMcGi43wreYK0Gb30VvGO678eVH853WP_kNpLEd-g-kLvtl-Fbt2enf3DC-G5xBL-zML7jRkjmW1-D77DDzV5lwXxT-BUm8QabTpfP4RMMcHjCQSt8grUaPukqfEZ0rwdx5YfzGdY_uY0k8Rm6D-Ru-2X4pPbs8g9OGJ8tjuB3FsZn3AjJfNI1-Aw73OxVFsynCb_CRrzB3Nn9fh_NJxjg8ITDVvgEazV8mqvwGdG9HsaVH85nWP_kNpLEZ-g-kLvtl-HTtGeXf3DC-GxxBL-zMD7jRkjm01yDz7DDzV5lwXxy-BVm8QbnnXPwBMsfnm_UCp5grQZPvgqeEc3rUUz14XSGtU9uH0l0hu4CuZt-GTq5Pbf8YxNGZ4sj-J2F0Rk3QjKdfA06ww43e5Wd9XfXNxb4bKt1saps0J9Ue9vG7OLB7negKjbl3H4qi_lumf2Xd7vc7hsLW9X7n-r9F-9X-x9tB3wd1mKY5DC5Yf063D8K67iwHqSkKSltktIM0kZsnOXGWQzncjgX5wZjy2E9TElTUtokpRmk-2LjIDyICJMbHorhkbzXIxmFnjy3lk3JESqyKhqwor0Ldhw3IO7dsBiWQBq5BOIIJhBHMoE4oknLvGjgi_Zu2nG8D-LeVYvxCaQRUCCOhAJxRBSII6O07IwegbgsjRP3nNKyNdQDLxHg_QVQReANBr3CyNYQsIaSrAFp-A6UZg2Iw7egNGtItoaANSRbQ8AaSrIGpJE1II6sAXFkDYgja0i2hoA1JFtDwBqSrTHAGpNmjZGtMcAaI1tjgDUmyRqQRtaAOLIGxJE1IA5_5ZKtMcAaI1tjgDUmyRqQRtaAOLIGxJE1II6sMbI1BlhjZGsMsMbI1jCwhtOsYdkaBtawbA0DazjJGpBG1oA4sgbEkTUgjqxh2RoG1rBsDQNrOMkakEbWgDiyBsSRNSCOrGHZGgbWsGwNA2tYtiYH1uSR1kxffvkZAAD__1SHILg=

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l19r4kwUxu_fTyHn6n15R-KZmdg2sOCyFLZQ2tL2YmHxIjWzVbAmJBHqFr_74h_W-m-eTEZzVzU_nzPPOWee-kGTNDF38ZspKPpJTIIkCVIkSJOgkPqCsjwdmKJI88UjK-AmeaeoI2g0yabl4u2-oEGaG4o-qByVY0MRPccvY_No4sTkQYcEJaaMR-OlTJaP3uJ81nuf_SZB7WAheT8to1ZPip6i_lxQOi03X12U8auhiOeiuvxTmpcmD8Jt5Z78_68Wi57c0drgL7PWMC6GOzRTf76pR7rU89kOPo0fqoYffE5D9NGCNt-T5onJTbJfRX8BV3jqwNm-x8XwyZT3WSB3nH2eZSZqXf_4dv3w3Pp6e0uCxuZX-W-P__uSj16Hy782Bhy1OqxwsunkUNUHC75L22kWyHDnycPa3S1tdhgz25QFsh2oOnsHCljPWbexvXMx5FSOqBqO8Dkt0UcLamzzuInNk9WbLa29Vu1A15l-UMC61xeNTb-DIXwqR1QNR_icluijBTU2_bKJ6VfVm62svdbt5T9GztMPClj3-rKx6XcwhE_liKrhCJ_TEn20oMamXzUx_bp6s7W112G7zuwD-XWnrxqbfQc7-DR-qBp-8DkN0UcLamzyddO_Nw6U82iKLJ0UptKvic7iQCZ5NSubinSaD8xDng6WMquX90tu-UZiinL1Ka9e3ExWHy0K_AzzLsyfYb0FsxvMHS869KGll7YE2tLquLI7rhwcl27wjuOudOhDSy9tCbS11XHQrtAKy669X10rfWGHL3zWyw6j9QI08MxOo_UCNNC-tDp-ZXf8yme97DBaL0CDEbfTaL0ADbTZniHoKt67TbcTSIII2rtOnTLITsMQAjg6uh2HMQRwpL53qW4br4Hxe7eqy64AGi0LwtHE2nG0LghH6vZIQW2zRwqDTGGvUAE03Be_WAE43Be_YGF7sjCIFvbKFkDDffFLF4DDffHLF-mVL9KeLxLki_TKF0CjfUE4OrpfviAcqdvzRYJ8kV75Ami0LwhHE-uXLwhH6m750p__8ycAAP__jgprag==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9rG0cUBfD3fgozTy1dId07s_oHBZU20ECIQ-KHQtGDIk1tgaMVuyuIG_zdiySTtWaie2Z2R3qL7RzN1ZmdHyN9U5tiZd8vvthKTf9RpDLFKlNaZcqoTOVqnqltWSxtVRXl_r8cA29XX9V0kKn1Zrur97-eZ2pZlFZNv6l6XT9aNVV3i8-P9qNdrGzZH6hMrWy9WD8eltmW6y-L8mn29ek_lalef7_k7a6e3sw4m2k1f85Usaubl67qxb1VU3rOwpf_VJS1Lfv56coz_vX7WpTN-OxaHLPWn-uqXm-WdZ-cNzqjZjVnqSb9-enmYVE9eMn5czOOjhnndfOUJ6netKie3TJCu89bdc_uVqfqfnh2nOZ1dpuiXNnSrk5e6fAqZwfW_sNyrpHRpUbwOzs3wrjDCFmrKf9aVA-fbH277RunqbunrZ3evPn7jzcf7m5-f_dOZerR_lv_PKNffivX9w-Hf53d_eY9TdLW-r7oFdu-yd13_2PMBieLU8SRlk50n3t93YZTMMDLmR4m4RSs1XBKV-E0pvthovJNi_LZraMdqKHts7vZlwGV0mnmPy5hoCYcwe8sDNS4ETqDStcAlcPPFYvHSvf6po1pYICXYzVKYhpYqzGNr2JaRPc0SlS-aVE-u3W0My20fXY3-zKmcTpQ_MclzLSEI_idhZkWN0Jn0_gapunwc6XFY2V6h8-m0aaBAV6O1TiJaWCtxjR9FdMiuqdxovJNi_LZraOdaaHts7vZlzFNpwPFf1zCTEs4gt9ZmGlxI3Q2TV_DNBN-rox4rPJeG9HA8i-HapJENLBWI5q5imgRzdMkSfWmRfXsltHOs9Du2d3qy3hm0mHiPyxhniUcwe8szLO4ETp7Zq79Rd4Pxvloq22xqWzQ13SD_Ruyq3t7LKgqduXSfiiL5WGZ44-3h9zhFytb1ce_0vGHt5vjn_YDvg6TGGY5zG6YXoeHJ2GKC1OnNOdd0tp0SRstp7XYuJEbN2I4l8O5OPdIHlsOU6c0g82W0xpstpw2YLOHYuNjOTyKCLMbHovhibzyRH7KhkAFYApCRVaFACvUyRWQRrCAOJIFxBEtII5sIRkXArqQzAsBX6gTMCCNhAFxRAyII2NAHCFDsjIEmCHZGQLQUCdpSKaGB-AOIVPDgBr2qIm6g8hpeAmR4_AWIsfhNUSOIyvYo-a0eA2Kl6lhQA171MRYAdLIChBHVoA4sgLEkRXsUXNaPHrvMjVO3LOCZWqAFSxLwxPw0MjUaECN9qiJsQKkkRUgjqwAcWQFiMPPLPKFToMLnZap0YAa7VETYwVIIytAHFkB4sgKEEdWaPlCp9HwMjVO3LNCy9QAK7QsjR6Dh0amRgNqtEdNlBVyGlohx6EVchxaIceRFUa-0BlwoTMyNQZQY-QPUOCwgzSyAsSRFSCOrABxZIUBX0yh1WVqnLhnhZGpca2YP__0fwAAAP__yy0SOA==

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpgQZ5K4a6BgKQtdWNZl60Wh5CJrpiq4TphEWLv47iVJF2s052Q6OHsZ9Zv5c84H_q-wUZm8T59lAfFP4MBAAIMAGITAIIKEQa7VXBaF0tVPGuA2e4F4yGC1ybdl9XHCYK60hPgVylW5lhDDLH1ay0eZZlL7Q2CQyTJdretrcr16TvVu8rL7DQw8v7pyui3jwYSziYBkz0Bty79HH0582g2WabE8PusNSRgUZbqQEPM9-7-UkcuUojPl4ajtRulMapkdHZZUJPWTM6_6LS2W32U5zX3e2sdsl8t4cPPj683DbPDl7g4YrOWv8mOd-tNnvVos3x4OM2gN4PBmgcWbnYl9rzyV-zxqz-Ds3eHR3bz_7jm2e194fnBBRw1yjtzmFJ05HVjK3Vkq-m9AoBsIPD-8oCkGOa_c5hSdOR2YItyZEvTfQIBuIPTqP5xLmWKQ89ptTtGZ04EpgTtTwv4bCNENRN4FPTFIOXaZUnSmdGBJ-D796EyoR1nkalPIXu1nWL2WzBayGVOhtnouH7Sa19c0j9Oaq__LM1mUzbeiebjdNF9VAfvDIxt4bANzq9w8wmluMDJhBo9s4LENzK1yt0Z2Qos2PfyXDvB5ByjMj2c2bNOhjeA4TAiOw4TgOEwJTtCE4JGN4DhMCI7DhOA4TAlO0ITgIxvBr2wUxWFCURwmFMVhSlGCJhS9tlEUhwlFcZhQFIcpRQmaUHRsoyi36gkETUhK0ISlBE1pSuFUV7ArC3Ztwa4uWPYFu8LArRoDP6kMRrbiNGUrTlO24jRpK4FTtpqUpdOdmbQlU5qy1agvGeOUrSflAbU12X_4EwAA__9qz1Ak

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1r20oQhu_PrzBzdQ7IyLMr-QsOpLSBBkIS0lwUii8UaxsbHMtIMsQN-e_FNrVjyZpXq4_00nEe7eyreUYrv9IyCs1N8GwSGv8gJocUOaTJIY8c8mni0CqOpiZJonj7L3vgKnyhcc-h-XK1Trd_njg0jWJD41dK5-nC0JgegseFuTdBaGK3Rw6FJg3mi90yq3j-HMSbi5fNL3Ko626XvF2n484FOxeKJm8ORev0eOkkDZ4MjfnNKb_8l3mSzpfT1PVP1z63xJF63HRmQTI7jxwrUTaVvA-Cm0lCV0qC24jCKyzleKn1MopDE5vw5GK7qxQWq3q42GMVfltVlIjsWEW_RhVOpUK_Bsnsm0lvV67O5PWwWZlx5_L758u7h86n62tyaGF-pv_udvDf__H8afbnw7HnCnc2aDbfm6gbrVztZzM4u_bwZG22kE1yzVVdV1eZO6CAQ-v0W587NlE0lYWulAW3EYZXWEpN57n65GmwihKRFU0euypqTx7-uMmjyre8Ejted12viv2ggMPtG7Ruv0UU3FQWulIW3EYYXmEpNb1T1e1vsIoSkRXZb1dFbfvVx9mvy7e8Fjve6-5eC6ztBwUcbt-wdfstouCmstCVsuA2wvAKS6npna5uf4NVlIisyH67Kmrbrz_Ofq98y3tix_vdKu6D5Q83b9S6-xZBcDNJ6EpJcBtReIWl1HTOq25-g1WUiKzIfLsqapvv_Z3fG84UdW-SVbRMTKlfE3rbbZnwyexjSqJ1PDV3cTTdLbP_eLvjdn8ITZLuv-X9h6vl_qttge9hzsL8HvZOYLaDWdWiR3Vo1a9Day3TSkxcy4lrcWlfXlmGGdQt06pXix7UoTXoNE9MHNxs3wJWWbgvwmDTA7lR-nKnDEV6JMOjOmLLMBIb0EBsmUZiyzQSm8EsRcNUHivAbUAjuQGO7EY46HSAI79ZHqmM8Nx0kfCc4yyPF7R1eb4wsJxzE8bqESzT8BkMcPQQlnH4FJZxaKs8XnkIgs_NVytbZRraKuPQVoCjlpVxaGtuyp4Erxgcn-Qpm8FztqrcqLGxVcmTRoHTm5LPMSA4QCNbEQ5sBTiyFeDw0CwPWeWD4HNT1sZWQCNbAY5sRThqWRlHtir5CKuGAJenbAbP2yqfYtHW5Umje-BdKzdpbGwFNLIV4cBWgCNbAY5s1fKQ1QoEn5uyVm-5Mg1fc2UcvucCHL3oyjiyVctHWY2ik6dsBs_ZquWzbHbrk7d_fgcAAP__F-ztzw==
