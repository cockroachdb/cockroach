# LogicTest: 5node-dist

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

# Prevent the merge queue from immediately discarding our splits.
statement ok
SET CLUSTER SETTING kv.range_merge.queue_enabled = false;

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTITI colnames
SHOW EXPERIMENTAL_RANGES FROM TABLE xyz
----
start_key  end_key  range_id  replicas  lease_holder
NULL       /2       1         {1}       1
/2         /3       2         {2}       2
/3         /4       3         {3}       3
/4         /5       4         {4}       4
/5         NULL     5         {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lc1vnDAQxe_9K6q51tXuGNgPTnvNJanS3ioOFI8ipA1GtpGSRvu_V4BQuqtkzIc58vF7b_zmSX6DSiu6z5_JQvobEARIEBCBgBgEJJAJqI0uyFpt2l964E69QLoVUFZ149rXmYBCG4L0DVzpzgQp_Mr_nOmRckVmswUBilxenjub2pTPuXk9vbz-BQEPjUu_nhCyiwDduHdF6_InghQvYp5rssRVTnH9qY0js8Gbc57w26f60Rz9JIT-u6w2igypj0Q_GOJef9f1Rl6f8TP7-Moexy8Nw1VlgusuXFU8rsMqce4qR-rv5urL8anJcLua4LoPtyuP65ClXCnLQX8_Vz8an1oUblcTXA_hduVxHbKMVspy0D_M1Y_HpxaH29UE12O4XXlchyzjlbIc9I8rXcePZGtdWRp1E27bu5TUE_V3r9WNKeiH0UVn0z8-dFz3QpF1_VfZP9xV_ad2wP9hZOGIhyULx1cw3sLREjjmz4z83AlL73l4x8IHHt4vOfRhCXxkYfQkhnzJ0Ncyvmae0XFRz5AvGiae0fmq4c6D813zzc6XzUfzbcOjZ3S-b3LrwfnGeWaXfOFu6ezy5V8AAAD__wH6wcY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslU1r20AQhu_9FWWuXbBnV7JjnXLoJZempL0VHVRpCAJHa3ZXkDT4vxdb4ETGnv3yUZLfeffxPLDvMOiOfjQvZKH6AwgCJAhQIKAAASXUAnZGt2StNoefTIGH7hWqpYB-2I3u8LoW0GpDUL2D692WoILfzd8tPVHTkVksQUBHrum3x5qd6V8a83b_-vYPBDyOrvp6j1DvBejRfUy0rnkmqHAvwlu_99b1Q-sW5bySmS9j5n-mwiwslYSF4VzF1YKPueOgTUeGutnUes8dQS6Dj1DGMP7SxpFZSDwf_-3q_NVsPkas7nZCelpPf9sqUcgYqiwslYSF4VxzIWU4l7zdtjytJ6x14rYiqDALSyVhYTjXfFsqnEvdblue1hPWXeK2IqgwC0slYWE413xbRThXcbtteVpPWJvEbUVQYRaWSsLCcK7rV_OFgieyOz1YOruiL09eHq5u6p5puuetHk1LP41ujzXT4-Mxd3zRkXXTV5weHobp0-GAn8PIhotZGM_Dkg0rvlnlNBdsuOSbSzYsJZ9esek1H17nQN-x4Q3fvMlpRo9jPsmyLENeM_R4hlmiIW8aelRD3jVfOe8aemTDLNuQ1w09vmGWcJIXTnqEk3HC1fsv_wMAAP__BkP9WA==

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lkFr4zAQhe_7K8JcVxCPbCeNYaGHZSGXdun2tuuD1x6KIbWCJEO7Jf99cQxpHZqRZEGOlvLmzZf3DnqDTjV0Vz2TgeI3IAiQICAFARkIyKEUsNeqJmOUHn4yCrbNCxSJgLbb93Y4LgXUShMUb2BbuyMo4LH6u6MHqhrSywQENGSrdne02ev2udKvty-v_0DAj3ZnSReLW1z86ZMkrRdpURTbu0cQcN_b4QLKgwDV23c3Y6snggIPwn-j762xbVfbZT5dh5kvQ-Z_JMYgZPoWwJzOYkZ_6OyiwfvcvlO6IU3NZGp54FaQifcKeQjjL6Ut6aXE8_FfL85fTeZjQK7XabJjo9NfuprZ5BDiIOSIJvsyoz_0tMnSH1peJ2bHRifk9cyYA4gxCDkiZl9m9Ieexpz6Q6fXidmx0Qn5ZmbMAcQYhBwRsy8z-kNPY878obPrxOzY6IS8mRlzADEGIUfE7MuM_tCXnx-fGDyQ2avO0Nkz5PPJyfA8oeaJxreMUb2u6adW9dFm_Lw_6o4HDRk73uL4se3Gq2HBj2JkxdlEjOdiyYpT3jmNcc5Ycc4756xYSl69YtVrXryOgb5hxRveeRPjjI6OuUoW1TLka4aOnmFU0ZBvGjqqhnzXXOZ819BRNoxqG_J1Q0ffMKpwki-cdBROhhWuPHz5HwAA__9soUkq

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk9r20AQxe_9FGauXbBmJdmxoJBDKfiSlDS3VgdVGoLA0ZrdFSQN_u5FFjiRiWf_CHzUrt-8-fm9w75Bpxq6q57JQPEbEARIEJCCgAwE5FAK2GtVkzFKDz8ZBdvmBYpEQNvtezsclwJqpQmKN7Ct3REU8Fj93dEDVQ3pZQICGrJVuzva7HX7XOnX25fXfyDgR7uzpIvFLS7-9EmS1t8WWVEU27tHEHDf2-EGyoMA1dt3O2OrJ4ICD8J_pe-tsW1X22U-3YeZL0Pmf0TGIGZaoDdyGoWM_szZRYP3uX2ndEOamsnU8sCtIBPvFfIQxl9KW9JLiefjv16cv5rMx4BYr9Rkx0qn_3QV2eQQ5CDm-Cb7IqM_87TJ0p9ZXilmx0on5nVkzAHIGMQcH7MvMvozT2NO_ZnTK8XsWOnEfBMZcwAyBjHHx-yLjP7M05gzf-bsSjE7VjoxbyJjDkDGIOb4mH2R0Z_58vPjE4MHMnvVGTp7hnw-ORmeJ9Q80fiWMarXNf3Uqj7ajJ_3R93xoCFjx1scP7bdeDUs-FGMrDibiPFcLFlxyjunc5wzVpzzzjkrlpJXr1j1mhev50DfsOIN77yZ44yOjrlKNqtlyNcMHT3DWUVDvmnoqBryXXOZ811DR9lwVtuQrxs6-oazCif5wklH4WRY4crDl_8BAAD__93PSSU=

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lLtugzAYhfc-RXVmV8GG3JhYsyRV1K1ioPhXhJRgZBspacS7V4EhTURaqN3Rl4-P88s6Z5RK0jo7kEH8Dg4GAYYQDBEYpkgZKq1yMkbpy5UOWMkj4oChKKvaXrZThlxpQnyGLeyeEOMt-9jTljJJehKAQZLNin2rqXRxyPQpOZ4-wbCpbfyccJYIpA2Dqu31o8ZmO0LMG_Y38fR3sWAJfygWD8VXX10qLUmTvHGlTc-vrdWLqiY8uLvZ7w5v3Hx4aO512iPEM6_TFsPFwmviEeK518ThcHHoNfEI8cJr4mi4OPKaeIR4-W8d0iPekqlUaWhQQwSXjiG5o66QjKp1Tq9a5a2mW25art2QZGx3KrrFqmyP2sl8h7kLLH6EOb-hg3s6dFFHLvDUBZ65wHMXeOECL51eybg3ljZPXwEAAP__0V3EcQ==

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lkFv2zAMhe_7FQOv1RCTthPXp1x7aYdut8EHLyaKAGlkyA7Qrsh_HxIbaJPFpKKpx9h-evzIJylvsLUN39fP3EH5CxAMEBhIwUAGBnKoDLTOrrjrrDt8MgjumhcoEwPrbbvrD48rAyvrGMo36Nf9hqGEn_XvDT9y3bCbJWCg4b5eb442rVs_1-51-fL6Bww87Pry6xLNkqDaG7C7_n3Rrq-fGErcG3_jH9b17Gb5qeeSbvy8aNLr3cK6hh03_zpU-wsF3dtvtp3hWRPGUibrSK9h_thsRK9up5POWUC3cR7Y7vyT2k14XbvnAdBEZyXhzeT6i5D10xjra31EuY_ZyedT9sWJPV6R1qhHg2I89jU0qxQMSVG3pB8lLqJsSfLH9KP0naViPFKGQlIoJKZRZ-lHiUWUWab-mH6UvrNUjEfKUEgKhcQs6iz9KPE2yiwzf0w_St9ZKsYjZSgkhUJiHnWWfpSURP_bc8HskbvWbjv2uomTw13OzRMPd39nd27F351dHW2Gnw9H3fFBw10_vMXhx912eHUo8KMYRTGdiPFcTKJ4LjunojiTxZkozuWyc1G8kJ3noriQnRf_Iy7kUeVy3bdyShIlJnLIlJygnDIkxVzOmTJtlIOGStJQjppGLmcNlT2Ccto0cjluWCjmSuAUczlwpASO5MAp5KQca0rgSA6cdirKgSMlcHTd2Vbtv_wNAAD__9Tyzgw=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslj9v2zAQxfd-iuLWELDvKMm2Jg9dsjRF2q3woFpEIMCRDEoGkgb-7oEtA4qZ-I6UOPrP47t7_N2Bb1A3pflZPJsW8r-AoIBAgQYFCShIYaNgb5utadvGnv7SC-7LF8jnCqp6f-hOX28UbBtrIH-Drup2BnL4U_zbmUdTlMbO5qCgNF1R7c42e1s9F_Z1_fL6HxQ8HLr8-xrVmmBzVNAcuuHQtiueDOR4VP7GvxvbGTtLrz3XdOfnRSFeP6q2q-ptN0OnxTUObjetdIjVxzwx9QpU33RORgRKbou-iaajEiX3An0SzW5aDQ6HurGlsaa8On9z5IrRn6_3VgmLEdFqdI-_u3n-8up8DIAm6hAKxpfGsihDKHgNQ_gpxuAhDMkzizqEfoGS2-K4IfRNlNwLDB9C8k-UohIqGF8CXUQhVPAaCKXJhAbkiYuohPoFSm6L4wj1TZTcCwwnVPsnqqMSKhhfAl1GIVTwGgjVkwkNyBOXUQn1C5TcFscR6psouRcYTmjin2gSlVDB-BLoKgqhgtdAaDKZ0IA8cRWVUL9AyW1xHKG-iZJ7gdOe2l9YPZp239StcZ7cX588Pz3FTflk-nd72xzs1vyyzfZs0398OOvOX5Sm7fpfsf9wX_c_nQr8KEZWTLyYWHF2JUZXrFlxwjsnrDjlxemUsjNWvOCdF6xYC3EvWfWKF694SuYCJjxkQmbIU4ZC38hzhlqQ86RJtfOoocAa8rBhJsh53KTaed5wKZjzwKFAHPLICbUTTxwJe42ExSZttkmrjXjiSFhuxCNHAnI0ab8RTxwJG4545EhAjnjkpNp54rSw5DSPnBaQ0zxybu2b47f3AAAA__96Jz8W

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lk9vm0AQxe_9FNVcvZU9A9iEE9dckirtreJAzSiy5HjRgqWkkb97ZUBKbMLMQsiRP7NvfvPeLrzCwRZ8lz9xBckfQDBAYCAAAyEYiCAzUDq75aqy7vxKW3BbPEOyMrA7lMf6fDszsLWOIXmFelfvGRL4nf_d8wPnBbvlCgwUXOe7fSNTut1T7l7S55d_YOD-WCffUzQpQXYyYI_126JVnT8yJHgy_sK_rKvZLaNLzZQWflo0qPUmYV3Bjou-Qnb6oKE7-8OWS7waQtfKYB_BGOb3w0b0m7ZJg0HxcMLAcd2bh0mDhbdm9InBN0LC8AnHDX89gZ_oqi1cDK6_mbJ-MMf62ixRnmN48fqQfHwhjyOyO-tBoQh3c-3HdspBMQaS5t6gfqC4mXODkj-wJ6-nq4pwB9tnneLqCEgM5nbVDxTjOV0N_IE9eT1dVYQ72D7rFFdHQGI4t6t-oHgzp6uhP7Anr6erinAH22ed4uoISIzmdtUPlFZf9Yv0geYDV6U9VOz1xV6dv_lcPHL7j1DZo9vyT2e3jUx7ed_UNTcKrur2KbYXt4f20bnB98UoFtNFMV4Xk1i8lpUDsTiUi0OxOJLbjsTijay8FotjWXnzmeJYtiqS-76RU7JSYiKHTMkJyilDUsTlnCluoxw0VJKGctQ0cjlrqOwRlNOmkctxw1gRVwKniMuBIyVwJAdOISflWFMCR3LgtFNRDhwpgaNxZ1t2-vY_AAD__5Vz2Pk=

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkTFLBDEQhXt_xTF1YJO9LpWFzTUqtrJFSIYjEDNLZiLCsf9dNinOE09Wr8zM--a9R06QKeCje0MG-woGJgVzIY_MVNZRFxzCB1itIOa5yjqeFHgqCPYEEiUhWEjkXdq9u1SRd3rQoCCguJiaflFAVc40izsiWLOofzqYwWxyGK86nA_XTCVgwfDt4g8ZHiJLzF6G8UIL9wauJdj_peML8kyZcVM3vSbEcMReh6kWj8-FfLPpz6fGtUFAlr4d--OQ26p9wlfY3AKPv8L7C1gv03L3GQAA___qN9W_

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9r2zAQx9_3V4R72phGLNnOD8MgYxRWKO1o8zb84MZaE0hjIzvQrOR_H0madbbT-1rxpre69ud0On0up2daZam-Th51QdEPkiRIkSCfBAUkKKRYUG6ymS6KzOw-OQCX6RNFnqDFKl-Xu3_HgmaZ0RQ9U7kol5oimib3S32rk1SbvkeCUl0mi-V-mdwsHhOzmTxtfpGgm3UZ9SaK4q2gbF2-RHwNdL_pzZNiXg0xkRRvY0FFmTxoiuRWnJdZ-L8zU29m9hpnvcpMqo1OK5HiHYk-ObG9b0kxv9PlTd6XtbpPN7mOepfX04vbu4uv096XqysStNQ_y_cT-eGzWTzM93_92bqsbf11W75Nwe8yU2rTl2G9Uh_fjB-0KNupirwEPZHEdfYpy_vKq9f45PJhZXnZ3ifp1nSLzAZuTZduTZeOTAcFP5o-ONd01f5AlVvVLDIbulVNuVVNOVINFPyo2vBc1fz2B-q7Vc0is5Fb1Xy3qvmOVAMFP6o2Ole1oP2BBm5Vs8hs7Fa1wK1qgSPVQMGPqo3_xVXxRPxbXeTZqtCtboHermY6fdCHMyiytZnp7yab7Zc5PN7suf3FINVFeXirDg-Xq8OrXYLt4WEXWMpOdNiJHvO0tKiZsoOHXeBazWzpsBM95mlVp72_ab8Ce3XYZ-GAP62AhZXklw679AcPg_7gYdQfgAb9AWjQH4Mu_cHDoD94GPUHoEF_ABr0x5C1dMRLOurSH-MuhvMwMJyHkeGABoYDGk0Am7HZ_CW1mZu2NBwCVpPTGgeay8YUqagqFS-65McIMF025oiN6oAGrgMayY5wYDvCke6NGWqlO08j3Xka6g5wpDvAke6NQVrVfQB0b8wUK90bM8VKd55GuvM01B3gSHeAI90b89RKd55GuvM01B3gSHeAI90bU7V61_Z43VVjtrC6x9t3vwMAAP__ibc6hw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE9v4kgQxe_7KVCfdrVeQXc1f6WVWO1EmkhRMkq4jTg4uCcgEYxsI4WJ8t1HwADBjeu53YZb_vC66lXX-8nmXSziyNyHryYVg-9CikAoEQgSgdAiEG0xDsQyiScmTeNk85Gd4DZ6E4NWIGaL5Srb_HkciEmcGDF4F9ksmxsxEKPweW4eTRiZpNkSgYhMFs7m2zLLZPYaJuvh2_qnCMTDKhs0hkqMPwIRr7LjiWkWvhgxkB9B-apfZmk2W0yyZvu05FDmzj9KnteNaZhOz3z-2INy6eGzc-llnSpZl_V614VNHM9ZLeIkMomJTk7anlLYpmqBNo8ttC_VAprUsYWORwtBpS6_hun0yWQPyyblJjVaL82gcXs_unl8uvl_1Pjv7k4EYm5-ZH8O5V__JrOX6fanw4YV2-q6bNhTnGQmaZI1tb8Lz--VGNu5ifw-9EwT9_E_8bKpW_kZny3fPykvHXJbH7FA1cMydi5ILBfnXtapknVZr3dd2IQnLmRFYtXYAppUEbHcWvAmlrwSscCG7YllTa0ssVT54Kj6kAGqHrahe0FkODiXXtapknVZr3dd2IRnXlVFZNTYAppUETLcWvBGhroSMsCG7ZFhTa0sMqh8cKg-ZICqh23oXRAZDs6ll3WqZF3W610XNuGZV6qIjBpbQJMqQoZbC97IoCshA2zYHhnW1MoiQ5cPjq4PGaDqYRv6F0SGg3PpZZ0qWZf1eteFTXjmVVdERo0toEkVIcOtBW9k6CshA2zYHhnW1Kp8lXLm_EeTLuNFakp9S9LazMxEL2Z3B2m8SibmWxJPtmV2vz5sdds_RCbNdv-Vu19uF7t_bRr8LJZ5sfws1idi6SaW5KNW0kvd91FTl1crduLET5zY0m2-Mi-W4L54tVI-amp5qXu8WrMT7_DitoNY5cUdVtzl77rLioHnHivWINh9ngotgAULKk5c4NUQDLwckgHIERp4OWKDtNByOngFBm-xxQUPQI34AOQIEECOCIHkIC7SIszp4NHoeMTk5BYmJA8Z2QHXzmMGWec5I3uguEUap7Dzahh2Xg7DDuQo7Lwchp2nrAKUVTxqwMYCNQo7kKOwAzkKO5KDjVc8ZRVYOsU_weXkVtgVjxqlwbXzqEHWedIoQBplkcYl7ECNwg7kKOxIDsIO5PCpn6esApRVPGpQ2AFl0b0BTKKwA0yisAM52niesgS2hvgX5JzcCjvxqCHwQEc8aoB14klDgDRkkcYl7ECNwg7kKOxIDsIO5CjsxFOWAGWJRw16yweURfcGMIne8wEm0Ys-kKON5ylL6Nr5t-ac3A47jxoNHug0j5q89fHHH78CAAD__555ymg=

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElktv2k4Uxff_T4Hu6l_FFdyxIYmlSlRVFpHSpErYVSwcPCVIBFtjI4VGfPcKjEp4eI6Ha9wdr5_PnPuYwzvNkljfR686o_AnMXmkyCOfPArIoy4NPUpNMtJZlpjVTwrgNn6jsOPRZJbO89XHQ49GidEUvlM-yaeaQhpEz1P9qKNYm3aHPIp1Hk2ma5nUTF4js-i_LX6TRw_zPGz1FQ2XHiXzfPvELI_GmkJeetVVnxKTa9Pu7gr2-WLv8VviedF6ibKXfYCGy-0RlMsRPhpnkXP_BOdcs_Wg9Azb5yQm1kbHR4Ur_eqIne_ajPWTzh_Sttor4mCR6rB1ez-4eXy6-TZofb27I4-m-lf-f58vPn0xk_FL8fJvjbm0xl2ZvyMnv08-J2lb7fahTL63I88Ok1XfSgHVzWD1zrlSLsZFzv0TnHPN1oPSMzS3UtzYSqnqrVX1zTRQ3XT28pwz7WCcRc79E5xzzdaD0jM0N9OqsZn2q7fWr2-mgeqms1fnnGkH4yxy7p_gnGu2HpSeobmZ9hub6aB6a4P6Zhqobjp7fc6ZdjDOIuf-Cc65ZutB6Rmam-ngn_ydP3KoR52lySzTlf6pd1a2dDzWRbGyZG5G-odJRmuZ4u3Dmlt_EOssL77l4s3trPhqdcCPMO_D_BEOdmB2g7kjorsSWom0FdBW1or79or7DhVXbvBexV3proRWIm0FtANrxUG7ulZY9ez96lnpSzt8KVkvO4zWC9CgZnYarReggfaVteLX9opfS9bLDqP1AjQYcTuN1gvQQJvtGYKu4oPbdDeBFIigg-vUKYPsNAwhgCPrdhzGEMCR-sGlulv4ABT-4FZ12RVAo2VBOJpYO47WBeFI3R4pqG32SGGQKSwKFUDDfZHFCsDhvsiChe3JwiBaWJQtgIb7IksXgMN9keWLEuWLsueLAvmiRPkCaLQvCEfWZfmCcKRuzxcF8kWJ8gXQaF8QjiZWli8IR-pu-TJc_vcnAAD__w2vQns=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzE2M1u4zYUBeB9n8LgqsWosO8l_QsUcNHOIsA0KZLsCi88NpsYyFiGJAOTBnn3wnFQxaJ0D2lR7i5_R7w6Ej8wflHbdG2vl99srmZ_KVKJYpUorRJlVKKGapGoXZaubJ6n2eFPjoGr9Xc1GyRqs93ti8OPF4lapZlVsxdVbIonq2bqfvn1yd7a5dpm_YFK1NoWy83T2zK7bPNtmT3Pvz__oxJ1sy9mvTmrxWui0n1RXjEvlg9Wzeg18V_1Ls0Km_WHpwvO6VPj5Tnk8r9v8mKzXRV9GlRXONxJtraZXc96c6osV17h63PvcZk_OunFazmSDhnpY880bFO0OaNodnpobnp4VtPsPMuITY8aRyqvkx7XqrtPaW4d9oaUM407nCmsy3KmicdM-23dVItDEv1Jzcx_2OzB3tniZtc3lSbvn3d21ru6vv98e_f5t_ver1--qEQ92b-LH-f06adfss3D4_HL_1765jubRm_7Ov053fXNsFpDPW6Dk_UpYK_HMxWs-r7VR-eaCi5fmkoXMzWk51E8U_2KZqcHX1N9m2bnWXZmKkX1K-wNaTI17kxhXTaZWj9Td6bSxUxl_73G8UwDq75vtfG5poHLl6bxxUwL6JnG8UzzK5qdHnxN822anWfZmWkc1Y-wN6TJtLgzhXXZZFr9TN2ZxhczTfvvNR3PNLDq-1abnGsauHxpmr6YaQE90ySeaX5Fs9ODr2m-TbPzLDszTUf1I-wNaTIt7kxhXTaZVj9Td6bpi5lm_PeaiWcaWPV9q03PNQ1cvjTNXMy0gJ5pGs80v6LZ6cHXNN-m2XmWnZlmovoR9oY0mRZ3prAum0yrn6k708z_8nlezVC3Nt-l29x6fVQ3ONyWXT_YY015us9W9s8sXb0tc_z25i339oO1zYvjb-n4zdX2-KvDgB_DJIZZDnM1TB_Do5MwhYWpVZqHbdLatEkbLae12LiRGzdieCiHh-LcY3lsOUyt0gwetpzW4GHLaQMe9khsfCKHxwFhroYnYngqrzyV37IRUAGYglCRVSHACrVyBaQRLCCOZAFxRAuII1tIxoWALiTzQsAXagUMSCNhQBwRA-LIGBBHyJCsDAFmSHaGADTUShqSqeEBOEPI1DCghh1qgs4gchoeQuQ4PIXIcXgMkePICnaoOS1eg-JlahhQww41IVaANLICxJEVII6sAHFkBTvUnBaP7l2mphJ3rGCZGmAFy9LwFLw0MjUaUKMdakKsAGlkBYgjK0AcWQHi8H8W-UCnwYFOy9RoQI12qAmxAqSRFSCOrABxZAWIIyu0fKDTaHiZmkrcsULL1AArtCyNnoCXRqZGA2q0Q02QFXIaWiHHoRVyHFohx5EVRj7QGXCgMzI1BlBj5H-gwGYHaWQFiCMrQBxZAeLICgM-mEKry9RU4o4VRqamasXi9Yd_AwAA__-aTCC3

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlk1r20AQhu_9FWZOLd1i7UryhyCQUlJqCE5JfGt9UKxtbHAssZIhbsh_L7ZjUkn2vForCN2iSM_uaOd5PXqmVRzpcfioUwp-kSRBigS5JMgjQT5NBSUmnuk0jc32kT0wip4ocAQtVsk62_57KmgWG03BM2WLbKkpoEl4v9S3Ooy06TokKNJZuFjutknM4jE0m8unzV8S9H2xzLQJOpey83vtOO6so4IgGI0nJOhmnW1v0PRFULzOXnd72-R-05mH6Ty__O75qaA0Cx80BfJFnFe1b1O1vnjnstXJst_WWa9iE2mjo9xK0y2JHjny7j_CdH6ns5ukKwsNm2wSHXRG48nV7d3Vt0nn6_U1CVrqP9nHS_npwiwe5ru_Tr7622u5Nt24i02mTVf6xZP6fHJ9r8KxHTuR10WPFDGOv8RJVznFMz66vZ_bXlaXTbYnIhZV91oUEdlsRGRDEQHdOESkd25EVPVuq_Y4alF1v0WOqmYdVQ05CrpxcLR_rqNu9W677XHUoupBixx1m3XUbchR0I2Do4NzHfWqd9trj6MWVQ9b5KjXrKNeQ46CbhwcHb7H5_CR9W91msSrVFf60nW2Z6ajB73vQRqvzUz_NPFst83-8mbH7b5hIp1m-7tqfzFa7W9tC6wO9-vAUtai_Vr0kKelxZkpO7hfBy6cmS3t16KHPK2KtPM_7eZgpwi7LOzx3fJYWEl-a79OPngY5IOHUT4ADfIBaJCPXp188DDIBw-jfAAa5APQIB991tIBL-mgTj6GdQznYWA4DyPDAQ0MBzSaADZjs_xLajM3bWk4BKwmpzUONJelKZJTVSpedMmPEWC6LM0RG9UBDVwHNJId4cB2hCPdSzPUSneeRrrzNNQd4Eh3gCPdS4M0r3sP6F6aKVa6l2aKle48jXTnaag7wJHuAEe6l-aple48jXTnaag7wJHuAEe6l6Zq_lvb4XVXpdnC6j59-fAvAAD__93yhjY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K9BctaorPB98WYqUqk1VpIisEu52uXDwbLBEMLKNFDbKf18BCwQPfo-HMb5LMGfm-Mx7Htm8s0US6VH4qjMWfGWceUwwj0nmMcU81mETjy3TZKqzLEk3X9kJhtEbC3yPxYvlKt98PPHYNEk1C95ZHudzzQI2Dp_n-lGHkU7bPvNYpPMwnm-3Wabxa5iub9_WP5jH_ovnuU6D1i1vfVv5vpy2RBAEw9GYeexhlW8usMmHx5JVftwty8MXzQL-4VV39G-c5fFimrc7p3aM9Y-S53VrFmazM98_ehA2Hj6nwq1i0TcWuciLcuH1BqNKTRzXWS2SNNKpjk5W2q5SalP4wObRQudaFlBSRwtdBwveRS7_D7PZk84flm1ZSGq8XuqgNRyN7x6f7v4Zt_6-v2cem-vv-e-3_I-bNH6Zbf-qMGE9mwl7StJcp21ppPZn6fr9CrGdS-TXomdMjJK_kmVb-cWMz24_ONmeW5S6GdQBR4dB7V4RdTapWMXigLqqufB6g1GlJhw5wy9EXY0WUFJlqLOz4Iw63hDqwITtUWekVhV1onqrRDOsAY4Ok9K7ImssUuFWsTiwpmouvN5gVKkJx6KLC1lTowWUVBlr7Cw4s0Y0xBowYXvWGKlVZY2s3irZDGuAo8Ok9K_IGotUuFUsDqypmguvNxhVasKx6PJC1tRoASVVxho7C86skQ2xBkzYnjVGalVZo6q3SjXDGuDoMCmDK7LGIhVuFYsDa6rmwusNRpWacCy6upA1NVpASZWxxs6CM2tUQ6wBE7ZnjZHaJT8XnVn_UWfLZJHpSr8E-ZvMdPSid2eQJat0qr-kyXS7ze7fh61u-0Gks3x3le_-GS52lzYGP4t5Ucw_i9WJmNuJuXRRC-6kHrioZY9WCzJxSScuya079M60mIPzotVCuKil76Tu02pFJt6lxR0LsSiKu6S4R591jxSDe-6TYgWKPaCp4AMsGFCx4gKthmCg5ZAMQI7QQMsRG7iBltPgBQjeYIsNHoAa8QHIESCAHBECyUFduEGY0-BRdDRiCnIDE5yGDO-CY6cxg26d5gzvg80N0liVnVbDstNyWHYgR2Wn5bDsNGUFoKygUQMmFqhR2YEclR3IUdmRHEy8oCkrwNAJ-gmuIDfKLmjUCAWOnUYNunWaNAKQRhiksSk7UKOyAzkqO5KDsgM5fOqnKSsAZQWNGlR2QFl0bgCTqOwAk6jsQI4mnqasBFMj6Rfkgtwou6RRI8EDnaRRA25d0qSRgDTSII1N2YEalR3IUdmRHJQdyFHZJU1ZCSgradSgt3xAWXRuAJPoPR9gEr3oAzmaeJqyEh07_dZckJtlp1GjwAOdolFTvPXJx28_AwAA__8jwRYm

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll9v2jwUxu_fTxGdq3eaJ2In4U-kSkxTpyFVdGq523KREq8gURI5QSqr-O4TpIwloX5iUkW5KyU_-8Tn93D8Qus4ktPwSabk_yBOjAQxcoiRS4w8ChglKp7LNI3V_pEcmETP5NuMlutkk-3_HTCax0qS_0LZMltJ8mkWPqzknQwjqXo2MYpkFi5Xh20StXwK1Xb8vP1NjL4uV5lUvjXm1s-NbTtzy_F9fzKdEaPbTeZbY0HBjlG8yV53O23ysLUWYbooLj_mFOwCRmkWPkry-Y5dVrVnUrW8svi7li3eLPu0zmYdq0gqGRVWCvYkeuTMu38L08W9zG6THi81bLZNpG9NprPru_vrLzPr880NMVrJX9n_Y_7hSi0fF4e__r46L7366bUck27cxyqTqse98kl9fHN9t8axnTuR10XPFDGNP8VJT9jlMz67vVfYnteXjXcnIgZV9zsUEd5uRHhLEQHdOEakf2lERP1ui-44alD1oEOOinYdFS05CrpxdHRwqaNO_W473XHUoOphhxx12nXUaclR0I2jo8NLHXXrd9vtjqMGVY865KjbrqNuS46CbhwdHb3HdfjM-ncyTeJ1KmvddO39mcnoUeY9SOONmsvvKp4ftsk_3h64wx0mkmmWfyvyD5N1_tW-wPrwoAnMeSPaa0SP9DQ3ODNhBg-awKUzM6W9RvRIT4sybf9LOwXYLsOOFnb13XK1sOD6rb0m-dDDIB96GOUD0CAfgAb56DfJhx4G-dDDKB-ABvkANMjHQGvpUC_psEk-Rk0M18PAcD2MDAc0MBzQaAKYjM3qL6nJ3DSl4RAwmpzGONCcV6ZIQVUu9KJz_RgBpvPKHDFRHdDAdUAj2REObEc40r0yQ41019NIdz0NdQc40h3gSPfKIC3q3ge6V2aKke6VmWKku55GuutpqDvAke4AR7pX5qmR7noa6a6noe4AR7oDHOlemarFu7at111UZotW92D3358AAAD__8GFhkA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mEtv6kYcxff9FNasWtUVngcvS1eiam9VpCtSJexaFg6eBksEI9tIoVG-ewVcIHjw_3gY4x2vM3N85n9-snlnqzTWk-hV5yz8m3HmM8F8JpnPFPNZl818ts7Suc7zNNv95CAYx28sDHyWrNabYvfxzGfzNNMsfGdFUiw1C9k0el7qRx3FOusEzGexLqJkud9mnSWvUbYdvW3_Yz77I1kWOgu9Eff-2QSBnHsyDMPxZMp89rApQm8k2OzDZ-mmOO-WF9GLZiH_8Os7-j3Ji2Q1LzrdSzsjXlr_LHneeosoX1z5_dmDsPHwORVuFYv-4vHaucibcuHNBqMqTZzX2azSLNaZji9W2q9SaVMEwObZQvdeFlBSZws9Bwv-TS7_jPLFky4e1h1ZSmq6XevQG0-mXx-fvv429X799o35bKn_LX4c8Z--ZMnLYv_qNGHVl9W3mbCnNCt01pFGaj9Xrj-oEdu1RL4vesXEJP0lXXdUUM746vbDi-25RanbQR1wdBrU3h1RZ5OKVSwOqKubC282GFVpwpEz_EbUNWgBJVWFOjsLzqjjLaEOTNgRdUZqdVEn6rdKtMMa4Og0Kf07ssYiFW4ViwNr6ubCmw1GVZpwLLq4kTUNWkBJVbHGzoIza0RLrAETdmSNkVpd1sj6rZLtsAY4Ok3K4I6ssUiFW8XiwJq6ufBmg1GVJhyLLm9kTYMWUFJVrLGz4Mwa2RJrwIQdWWOkVpc1qn6rVDusAY5OkzK8I2ssUuFWsTiwpm4uvNlgVKUJx6KrG1nToAWUVBVr7Cw4s0a1xBowYUfWGKnd8nfRlfUfdb5OV7mu9U9QsMtMxy_6cAZ5usnm-q8sne-3Obx92Ov2H8Q6Lw7f8sOb8erw1c7gZzEvi_lnsboQczsxly5qwZ3UQxe17NNqQSYu6cQluXWX3pkWc3BetFoIF7UMnNQDWq3IxHu0uGshFmVxjxT36bPuk2JwzQNSrECxhzQVAoAFAypWXKDVEAy0HJIByBEaaDliAzfQchm8AMEbbLHBA1AjPgA5AgSQI0IgOagLNwhzGTyKjkZMSW5ggtOQ4T1w7DRm0KXTnOEDsLlBGquy02pYdloOyw7kqOy0HJadpqwAlBU0asDEAjUqO5CjsgM5KjuSg4kXNGUFGDpB38GV5EbZBY0aocCx06hBl06TRgDSCIM0NmUHalR2IEdlR3JQdiCHd_00ZQWgrKBRg8oOKIvODWASlR1gEpUdyNHE05SVYGok_YBckhtllzRqJLihkzRqwKVLmjQSkEYapLEpO1CjsgM5KjuSg7IDOSq7pCkrAWUljRr0lA8oi84NYBI95wNMogd9IEcTT1NWomOnn5pLcrPsNGoUuKFTNGrKlz77-OH_AAAA__9uuhYw

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllGL2kwUhu-_XyHn6itM0ZlEdw0ULGWhwqLF9a7kImtOVXCdMImwdvG_F00Xa7TnZHoguYzJM_POmQd832BrU5wkL5hD9B00KDCgIAAFISjoQ6wgc3aBeW7d8ZMSGKevEPUUrLfZrjj-HCtYWIcQvUGxLjYIEcyT5w3OMEnRdXugIMUiWW9O22Ru_ZK4_eh1_xMUTHdF1BlpNTIQHxTYXfF70fNaz_vOKslXl6u8I7GCvEiWCJE-qH_L1-fzGTXS0nzmr_nOS-221qXoML1YLD6S3Cc3Dvk1yVdPWEyzrq7cwXyfYdQZT-YPs6eHL_PO58dHULDBH8X_p-AfPrn1cvX-QF3T-XyB4Hw3wk_sR5t1db86iZt7hxd76_p3r9tw0yPfoA03dbNu6qbdNPXnb9rwwyPfXRt-mGb9ME37EdSff9CGHx757tvwI2jWj6BpP8L68w_b8MMj37ANP8Jm_Qjb7D43os0wz-w2x1rNpnc8HKZLLIeV251b4DdnF6dtysfpiTv9b6eYF-VbUz6Mt-WrY8D68EACDyWwFuXWfZrWHiMzfvBAAg8lsBblrozsijZVuvcnHdDzDkhYX86sV6VDieA0zAhOw4zgNMwJztCM4H2J4DTMCE7DjOA0zAnO0IzgA4ngdxJFaZhRlIYZRWmYU5ShGUXvJYrSMKMoDTOK0jCnKEMzig4limpRT2BoRlKGZixlaE5TDue6gqwsyNqCrC4I-4KsMGhRY9BXlcHLVprmbKVpzlaaZm1lcM5Wn7J0fWc-bcmX5mz16kveOGfrVXkgbY0P__0KAAD__x91S3g=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4koYxu_Pp5C5OgfmoO9M_AsLLruFLZR2ab1bvEjNbBWsCUmEuqXffVFZrYl5nxkn6V7a9ue8eTK_J5O-ilUcmdvw2WRi9EOQkEIJKbSQIhBSdMVUiiSNZybL4nT7J3vgOnoRo44Ui1Wyzrc_nkoxi1MjRq8iX-RLI0ZiEj4uzb0JI5O2O0KKyOThYrlbJkkXz2G6Gb9sfgkp7tb5qDUmOVZi-iZFvM6PX5rl4ZMRI3qT9gt_XWT5YjXL293TVc8tcaQeN615mM3PI8dJlMsk7yMgiwyUHFNlBvqiDKiJEILKUY5ftV7FaWRSE5182e5bKodVHTzscYpuU1NYRHacoucxhbxo0G9hNn8w-V3S1oW8JpvEjFrXt5Or-4erL5PW55sbIcXS_Mz_3V3Ef5_SxdP8zwc79fr1pnwb_x8nbd0tJnF27cHJ2uQgW619AxY-bJxe433jEoFFBg59Y5sBNRFCUDmKp-l0ed_UOIVFZFV94zaFd9_QR_eNst_wqlbnwcKHm9dv3HmHCMgiAwfnbTOgJkIIKkfxtE1d7nyNU1hEVuW82xTezquPdl7bb3hdq_Ng4cPNGzTuvEMEZJGBg_O2GVATIQSVo3japi93vsYpLCKrct5tCm_n9Uc7H9hv-KBW58HCh5s3bNx5hwjIIgMH520zoCZCCCpH8bQtuNz5GqewiKzKebcpvJ0P_ub_Es6Mdm-yJF5lxuo_BZ3txZnoyezDyuJ1OjPf03i2W2b_8W7H7X4QmSzf_5b2H65X-19tB3wPUxGm93BwApMbTMqLHvrQqudDa83Tik1c84lrdukuvzIPE5ibp1XHi-770BrstIBNHNzsrgOsinCPhcFF9_mN0uN3yoClhzw89BGbh5HYgAZi8zQSm6eR2AS6FJUpXyvAbUAjuQGO7EY42OkAR34TX6mE8FK7cHjJceLrBV063y8ELKdSwzg9gnkaPoMBjh7CPA6fwjwObeXrlQYg-FK_OtnK09BWHoe2AhxtWR6HtpZa9iR4ReD4xLdsAS_ZqkpV42Kr4ptGgdOb4s8xIDhAI1sRDmwFOLIV4PDQzJes6oLgSy3rYiugka0AR7YiHG1ZHke2Kv4IqwYA51u2gJdt5U-x6NL5ptEd8K5VahoXWwGNbEU4sBXgyFaAI1s1X7JageBLLev0lsvT8DWXx-F7LsDRiy6PI1s1f5TVKDq-ZQt4yVbNn2WLlz59--d3AAAA__8EA-kj

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFtr4lwUhu-_XyHr6huaQddO1CoMOAyFKZR2aL0bvEjNnipYE5IIdYr_ffAA1qRZ714eclcPb9bOkzzvjn2neRzZ-_DVZtT_TUweGfLIJ48C8qhNI4-SNB7bLIvT9Ve2gdvojfotj6bzZJGv3x55NI5TS_13yqf5zFKfhuHzzD7aMLJps0UeRTYPp7PNmCSdvobpcvC2_EsePSzyfmPA3sDQaOVRvMj3B83y8MVSn1ee--CnOM1t2mwfzhyYK2nWPv68bEzCbFJIM41W-_UYzXo-gmA3En4lCf8IEnxJFEHlgvbHidPIpjYqr2K0Djt865Nz-xlmkyebPyRNU2A6XCa237i9H948Pt38GDa-392RRzP7J_9_wF--pdOXyeavPYNK2u0jaJsibb6qPH7naHhcgeU-_honTf8QSdX47sF4VtzGZ_UZDN5x7dTmswaEGwlXn91I8CVRBJULqs1nrslnN9qmSNvZZ-N-H5mzCgUG706sW5tQChDsRsJVKDcSfEkUQeWCahPK1CSUG21TpO0slO9-H_lnFQoM3p3YdW1CKUCwGwlXodxI8CVRBJULqk0ovyah3GibIm1noQL3-yg4q1Bg8O7EerUJpQDBbiRchXIjwZdEEVQuqDahgpqEcqNtirSP-gn3yfEfbZbE88w6_TprrZnZ6MVur0QWL9Kx_ZXG482Y7cuHTW7zRmSzfPspb1_czrcfrRf4MczFMH8MBwdh1oWZT0p3T0kb_6R0T04bkbgvE_cVxI0uXCCuTXdPSReIa9M9OR2IxNsy8bYY7sjXuiNfa6BXV0xfy-HrU9yUw8hNkAZuymnkJkgDN3tyG7ZAHZbKVGMnSCM9URz4CeJIUBQHhnKpUg_BGwBe7lQgKZfa5XB4AIaX6kW1C8ppuA2CONoH5TjcCEEc2MZyt3IHgC-1q0o3OQ11A3GkmxyHuoE40k3eWRhsLVwqWZVucskaULJGU7Llhy9VyarjQDcQR7qhOHrwlEvWgJI1pZLV6AbSSDcUB7qBONINxYFuRt5gDNhgjPz8CnQzcskaULJGU7Ll4aqSVceRbqqSVceRbnLJGlCyRvMAX77lVE_w6jjSTfUMr44j3eQNxgcbjC__S6So22j1378AAAD__4JFZto=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9r40YUBfD3foowTy2rYs-dK_-Dgku70MCSlCRvxQ9ee5oYspaRZNh0yXcvsQ2KZ-J7Rpqx3zbJHt-ro9EPJT_Uuljam_k3W6nJP0qrTJHKlFGZYpWpXM0ytSmLha2qonz7L_vA9fK7mvQztVpvtvXbt2eZWhSlVZMfql7Vz1ZN1MP867O9s_OlLXt9lamlreer592YTbn6Ni9fpt9f_lOZut3Wk6upzqakZq-ZKrZ186FVPX-0aqJfs_DB90VZ27KXH8-c0qewWdRm1p-rql6tF3VPO5c41c00Z1ST_vpy9TSvnrzk7LVZx7RZ533nOg8q3ZwsgjuUTm4Noa3nnVon9yanan1wcp3mc7brolza0i6PPmn3KScXNv4xOdXI8Fwr-J2dWmEUsULWacu_5tXTva1vNz12mnp42djJ1fXNw-e7-89_PFz9_uWLytSz_bf-eap_-a1cPT7t_nXyADSXNe5wsNlr7dNprfoBvX1UyeFTP9jipvi12PTyvlvyx_OPudQtzEjqNBh8aHaQxGkwq3FaX8TpNp0PkjodVjq5NXRzOrR1cm_yeZzW6ZD0j0mY0wlX8DsLc7rdCtFO6ws5HXaw2Wst2GkKf2YpqZNg8OHKhkmcBLMaJ-kiTrboXA-TOhlWOrk1dHMytHVyb_J5nKR0SPnHJMzJhCv4nYU52W6FaCfpQk6GHWz2Wgt20oQ_syapk2Dw4cpGSZwEsxonzUWcbNG5HiV1Mqx0cmvo5mRo6-Te5PM4adIh5R-TMCcTruB3FuZkuxWinTQXcjLsYLPXWrCTHP7MclInweDDlY2TOAlmNU7yRZxs0bkeJ3UyrHRya-jmZGjr5N7k8zjJ6ZDyj0mYkwlX8DsLc7LdCtFO8oWcDDvY7LXW6e-jHwy4s9WmWFc26E-f_bfS7PLR7m9CVWzLhf27LBa7Mfsvb3e53TeWtqr3P9X7L67X-x-9Lfg-rMUwyWFyw_p9eHAU1u3CehiTpqi0iUozSBuxcZYbZzGcy-Fc3BusLYf1KCZNUWkTlWaQHoiNg_CwRZjc8EgMj-V7PZZR6Mt7a9mUHKEiq6IBK9p7wI7jBsS9J6wNSyCNXAJxBBOII5lAHNGkZV408EV7T9pxfADi3qPWxieQRkCBOBIKxBFRII6M0rIzegzisjRO3HNKy9ZQH7xEgPcXQBWBNxj0CiNbQ8AairIGpOE7UJw1IA7fguKsIdkaAtaQbA0BayjKGpBG1oA4sgbEkTUgjqwh2RoC1pBsDQFrSLbGAGtMnDVGtsYAa4xsjQHWmChrQBpZA-LIGhBH1oA4_JVLtsYAa4xsjQHWmChrQBpZA-LIGhBH1oA4ssbI1hhgjZGtMcAaI1vDwBqOs4ZlaxhYw7I1DKzhKGtAGlkD4sgaEEfWgDiyhmVrGFjDsjUMrOEoa0AaWQPiyBoQR9aAOLKGZWsYWMOyNQysYdmaHFiTt7Rm9vrT_wEAAP__vfcO0w==

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1r6lgUhu_nV8i-mqEZdK1ErcKAw1CYQmkPrXcHL1KzTxWskSRCPcX_fvADrNnH9e7lR7yrH29W8iTPu7f9NNM0sY_xu81N97shExg2gQlNYCITmKYZBGaWpUOb52m2-somcJ98mG4jMOPpbF6s3h4EZphm1nQ_TTEuJtZ0TT9-ndhnGyc2qzdMYBJbxOPJeswsG7_H2aL3sfhpAvM0L7q1HgU9NoNlYNJ5sTtoXsRv1nRpGfgPfkmzwmb15v7MHt9Is3bx10VtFOejUprMYLk7H9acz1cQ5Eki6IUHYYRHwCCXRtALb8BMHZTo4HntjpNmic1s4t6awSqMvrU-5fXI8mX-H-ejF1s8zepcItxfzGy3dv_Yv3t-ufuvX_v34cEEZmJ_FH_26K9_svHbaP3XDsVB8M0jwHMZPN0cPH7raIB0AMtj-nc6q4f7SA6Nb--NJ8VDfVa7weAt11ZldmtAeJLwt9sPBrk0Lmw3XctuqshuP_BcBu9tN_s_VXxWvcDg7YW1K9NLAYI8Sfjr5QeDXBoX1ouvpRdXpJcfeC6D99Yr9H-qwrPqBQZvL-y2Mr0UIMiThL9efjDIpXFhvcJr6RVWpJcfeC6D99Yr8n-qorPqBQZvL6xTmV4KEORJwl8vPxjk0riwXtG19Ioq0ssPPJfBH_XT7zfHf7b5LJ3m1utXXWPFzCZvdnM38nSeDe23LB2ux2xePq1z6zcSmxebT2nz4n66-Wh1gl_DVA7T13C0FyZdmOikdPuUNIcnpTtymkXioUw8VBBnXbhEXJtun5IuEdemO3I6Eok3ZeJNMdyS73VLvtdAr7aYvpXDt6e4KYeRmyAN3JTTyE2QBm525DZsgDp0ylRjJ0gjPVEc-AniSFAUB4aSU6n74BmAlzsVSEpOu-wPj8Bwp15Uq6CchssgiKN1UI7DhRDEgW0kdyu1AHinXVW6yWmoG4gj3eQ41A3EkW7yykJgaSGnZFW6ySXLoGRZU7Lu5ktVsuo40A3EkW4ojjaecskyKFl2SlajG0gj3VAc6AbiSDcUB7qxvMAwWGBY3r8C3VguWQYly5qSdYerSlYdR7qpSlYdR7rJJcugZFmzgXcfOdUOXh1Huqn28Oo40k1eYEKwwITyv0TKug2Wf_wKAAD__0XrdO8=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9r40YUBfD3foowTy1RsefOlf9BwaVdaGBJSpK34gevPU0MWctIMmwa8t1LbIPiGfuekWfst02yx_fqaPRDyZtaFnN7O_1uKzX6R2mVKVKZMipTrDKVq0mmVmUxs1VVlB__ZRu4mf9Qo26mFsvVuv749iRTs6K0avSm6kX9YtVIPU6_vdh7O53bstNVmZrberp42YxZlYvv0_J1_OP1P5Wpu3U9uhrrbExq8p6pYl03H1rV0yerRvo9Cx_8UJS1LTv5_swxXYfNojaz_lxU9WI5qzvaucSxbqY5o5r0t9er52n17CUn7806ps06nzvXeVjp2dgc7YJP6J3cJug6G5vr4Jn5Sf2Te7tT9d87uk7zOetlUc5taed7n7T5lKMLG__AHGukf64V_M6OrTCIWCE7acu_ptXzg63vVh12mnp8XdnR1c3t45f7hy9_PF79_vWrytSL_bf-eax_-a1cPD1v_nX0ADSXNTzhfLPX2vVxt7oBvR2qZPepB7a4LX4tVp2865Z8eP4-nLqFHknFBoN3zfaSiA1mNWLri4jdpvNearHDeie3iSixQ_sn93afR2ydjkv_wISJnXAFv7MwsdutEC22vpDYYeebvdaCxabwp5eSigkG766sn0RMMKsRky4iZovOdT-1mGG9k9tElJih_ZN7u88jJqXjyj8wYWImXMHvLEzMditEi0kXEjPsfLPXWrCYJvzpNUnFBIN3VzZIIiaY1YhpLiJmi871ILWYYb2T20SUmKH9k3u7zyOmSceVf2DCxEy4gt9ZmJjtVogW01xIzLDzzV5rwWJy-NPLScUEg3dXNkwiJpjViMkXEbNF53qYWsyw3sltIkrM0P7Jvd3nEZPTceUfmDAxE67gdxYmZrsVosXkC4kZdr7Za-2kv6MeGHBvq1WxrGzQn0i7H6XZ-ZPd3oSqWJcz-3dZzDZjtl_ebXKbb8xtVW9_qrdf3Cy3P_pY8HNYi2GSw-SG9edwby-s24V1PyZNUWkTlWaQNmLjLDfOYjiXw7m4N1hbDutBTJqi0iYqzSDdExsH4X6LMLnhgRgeyvd6KKPQlffWsik5QkVWRQNWtPeA7ccNiHtPWBuWQBq5BOIIJhBHMoE4oknLvGjgi_aetP14D8S9R62NTyCNgAJxJBSII6JAHBmlZWf0EMRlaZy455SWraEueIkA7y-AKgJvMOgVRraGgDUUZQ1Iw3egOGtAHL4FxVlDsjUErCHZGgLWUJQ1II2sAXFkDYgja0AcWUOyNQSsIdkaAtaQbI0B1pg4a4xsjQHWGNkaA6wxUdaANLIGxJE1II6sAXH4K5dsjQHWGNkaA6wxUdaANLIGxJE1II6sAXFkjZGtMcAaI1tjgDVGtoaBNRxnDcvWMLCGZWsYWMNR1oA0sgbEkTUgjqwBcWQNy9YwsIZlaxhYw1HWgDSyBsSRNSCOrAFxZA3L1jCwhmVrGFjDsjU5sCZvac3k_af_AwAA__8KPxj2

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl0tr20AUhff9FeauWjrFvleSkwgKLiXQQEhK4l3xQrGmscGxxEiGuMH_vfhBHb_maDy2uvNDn8_VmXt08BuNs1TfJS-6oPgXMSkSUhSQopAURdRTlJusr4siM_NLlsBN-kpxS9FwnE_K-cc9Rf3MaIrfqByWI00xdZOnkX7QSapNs0WKUl0mw9FCJjfDl8RMO6_TP6ToflLGjY6oTkC9maJsUq5_tCiTZ00xz1R14cfMlNo0o03Njnz-p8WqI1taa_xp2hgkxWCLZurN1vOIyzzvjWBfJ4IjnOBzWhEeHGj9O5lJtdHp7hS9OVzhqj339iMpBo-6vM-bsuVpd5rruHFz171-eLz-3m18u70lRSP9u_zY4U9fzfB5sHi19uCg21GFm5uM9w2-d-a77EuWNyXaunK_dntDmx127KRhA8KrFWvXFjYXI3ydCI5wgs9pRXhwoNrCxjWFTaqfs5x04YHw6pgvalt4ByPY14ngCCf4nFaEBweqbeGlpoUPqp9zcNKFB8KrY76sbeEdjGBfJ4IjnOBzWhEeHKi2hQ9qWviw-jmHJ114ILw65qvaFt7BCPZ1IjjCCT6nFeHBgWpb-PA__H_YM9GDLvJsXOhK_w5a83vS6bNeOlVkE9PXP03WX8gs394vuMUHqS7K5be8fHMzXn41H_A9zNswv4fDDZjdYG550ZEPLV7aArTF6nhgdzxwcFzc4C3HXenIhxYvbQHaodVxcFyRFZa2_bzaVvrCDl_4xMsOo3gBGnhmp1G8AA20L62OX9kdv_KJlx1G8QI0WHE7jeIFaKDN9g5Bj-Kdp-lmAwmooJ3HqVMH2WlYQgBHt27HYQ0BHKnvPFQ3jQ-B8TtPVZesABqFBeFoY-04igvCkbq9UtCx2SuFQaewV6kAGubFr1YADvPiVyxsbxYG1cJe3QJomBe_dgE4zItfv4hXv4i9XwT0i3j1C6BRXhCObt2vXxCO1O39IqBfxKtfAI3ygnC0sX79gnCk7tYvvdmHvwEAAP__DBZjqA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl0tr20AUhff9FeauWjrFvleSkwgKLiXQQEhK4l3xQrGmscGxxEiGuMH_vfhBHb_maDy2uvNDn8_VmXt08BuNs1TfJS-6oPgXMSkSUhSQopAURdRTlJusr4siM_NLlsBN-kpxS9FwnE_K-cc9Rf3MaIrfqByWI00xdZOnkX7QSapNs0WKUl0mw9FCJjfDl8RMO6_TP6ToflLGjY6oTkC9maJsUq5_tCiTZ00xz1R14cfMlNo0o03Njnz-p8WqI1taa_xp2hgkxWCLZurN1vOIyzzvjWBfJ4IjnOBzWhEeHGj9O5lJtdHp7hS9OVzhqj339iMpBo-6vM-bsuVpd5rruHFz171-eLz-3m18u70lRSP9u_zY4U9fzfB5sHi19uCg21GFm5uM9w2-d-a77EuWNyXaunK_dntDmx127KRhA8KrFWvXFjYXI3ydCI5wgs9pRXhwoNrCxjWFTaqfs5x04YHw6pgvalt4ByPY14ngCCf4nFaEBweqbeGlpoUPqp9zcNKFB8KrY76sbeEdjGBfJ4IjnOBzWhEeHKi2hQ9qWviw-jmHJ114ILw65qvaFt7BCPZ1IjjCCT6nFeHBgWpb-PA__H_YM9GDLvJsXOhK_w5a83vS6bNeOlVkE9PXP03WX8gs394vuMUHqS7K5be8fHMzXn41H_A9zNswv4fDDZjdYG550ZEPLV7aArTF6nhgdzxwcFzc4C3HXenIhxYvbQHaodVxcFyRFZa2_bzaVvrCDl_4xMsOo3gBGnhmp1G8AA20L62OX9kdv_KJlx1G8QI0WHE7jeIFaKDN9g5Bj-Kdp-lmAwmooJ3HqVMH2WlYQgBHt27HYQ0BHKnvPFQ3jQ-B8TtPVZesABqFBeFoY-04igvCkbq9UtCx2SuFQaewV6kAGubFr1YADvPiVyxsbxYG1cJe3QJomBe_dgE4zItfv4hXv4i9XwT0i3j1C6BRXhCObt2vXxCO1O39IqBfxKtfAI3ygnC0sX79gnCk7tYvvdmHvwEAAP__DBZjqA==

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllGL2kwUhu-_XyHn6itM0ZlEdw0ULGWhwqLF9a7kImtOVXCdMDPC2sX_XjRdrNHOyfRAchmTZ-adMw_4vsFW5zjJXtBC8h0kCFAgIAIBMQjoQyqgMHqB1mpz_KQExvkrJD0B622xc8efUwELbRCSN3Brt0FIYJ49b3CGWY6m2wMBObpsvTltU5j1S2b2o9f9TxAw3bmkM5JipCA9CNA793vR81rP-84qs6vLVd6RVIB12RIhkQfxb_n6zeRTf813Xmq31SZHg_nFYumRpD65ccivmV09oZsWXVm5g_m-wKQznswfZk8PX-adz4-PIGCDP9z_p-AfPpn1cvX-cB5DZQbnw0WMw91IPtEfddGV_eoYbu4dX-wt61-8bEPMgHyDNsSUzYopGxVT1R--akOOgHx3bcihmpVDNSpHVH_4URtyBOS7b0OOqFk5okbliOsPP25DjoB8wzbkiJuVI26t79zINUNb6K3FWm2mdzwZ5kssJ2X1zizwm9GL0zbl4_TEnf6rc7SufKvKh_G2fHUMWB8ecOAhB5as3LLvp2XAyFQYPODAQw4sWbkrI7uiVZXu_UlH_nlHXlhezqxXpWOO4H6YENwPE4L7YUpwgiYE73ME98OE4H6YENwPU4ITNCH4gCP4HUdRP0wo6ocJRf0wpShBE4recxT1w4SifphQ1A9TihI0oeiQo6hk9QSCJiQlaMJSgqY0pXCqK_DKAq8t8OoCsy_wCoNkNQZ5VRmCbPXTlK1-mrLVT5O2Ejhla0hZur6zkLYUSlO2BvWlYJyy9ao8eG1ND__9CgAA___b20hi

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmM1q20AUhfd9CnNXLajYd0b-hUJKG2ggJCXxrnihWNPY4FhGkiFuyLsX29SOJesejUZKl07yea6O5jsa5YWWUWhugieT0OgXMXmkyCNNHvnkUZcmHq3iaGqSJIq3f7IHrsJnGnU8mi9X63T744lH0yg2NHqhdJ4uDI1oHDwszJ0JQhO3O-RRaNJgvtgts4rnT0G8uXje_CGPbtfpqHXB3oWiyatH0To9fmmSBo-GRvzqlV_4-zxJ58tp2u6ernpuiSP1sGnNgmR2HjlOomwmeRsBu2agK2XATYTgF45y_Kr1MopDE5vw5Mt231I4rOrgYY9TdJuaokRkxyl6DlN4lQb9ESSze5Perto6k9d4szKj1tXN-PLu_vLbuPX1-po8Wpjf6cfdRXz6Es8fZ_8-HLdd4cX16434Jvocrdq6m43h7NqDk7XZwrRaywYsfNg1vcbLxiYC1wx0pQy4iRD8wlEcNefqZVPjFCUiKyobuymcy4bftWxU-d2uahUeLHy4c_3GhbeIgF0z0JUy4CZC8AtHcVRNVRe-xilKRFYkvN0UzsKrdxVel9_tulbhwcKHOzdoXHiLCNg1A10pA24iBL9wFEfVdHXha5yiRGRFwttN4Sy8flfh_fK73a9VeLDw4c4NGxfeIgJ2zUBXyoCbCMEvHMVRNb-68DVOUSKyIuHtpnAW3v9v_z84M9edSVbRMjGl_jvQ2V6ZCR_NPqkkWsdT8zOOprtl9h9vd9zuB6FJ0v1vef_harn_1XbAtzBnYX4L-ycw28GsnOihC616LrTWMq3ExLWcuBaX7soryzCDuWVadZzovgutwU7zxcTBze5awCoL90QYXHRf3ig9eacMRHoow0MXsWUYiQ1oILZMI7FlGonNoEtRmcq1AtwGNJIb4MhuhIOdDnDkN8uVygjPtYuE5xxnuV7Qpcv9wsByzjWM1SNYpuEzGODoISzj8Cks49BWuV55AILP9auVrTINbZVxaCvA0ZaVcWhrrmVPglcMjk9yy2bwnK0qVzU2tiq5aRQ4vSn5HAOCAzSyFeHAVoAjWwEOD81yyaouCD7Xsja2AhrZCnBkK8LRlpVxZKuSj7BqAHC5ZTN43lb5FIsuXW4a3QHvWrmmsbEV0MhWhANbAY5sBTiyVcslqxUIPteyVm-5Mg1fc2UcvucCHL3oyjiyVctHWY2ik1s2g-ds1fJZNnvpk9cPfwMAAP__buTmDQ==

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8K52phGLNnOh2GQMQorlLa0vRgMX7ix1gTS2MgONCv57yNJQ2c7Oa8VD901jR_p-Og5efVKyyzV18mzLij6RZIEKRLkk6CABIUUC8pNNtVFkZntI3vgMn2hyBM0X-arcvvvWNA0M5qiVyrn5UJTRA_J40Lf6STVpu-RoFSXyXyx2yY38-fErCcv6z8k6GZVRr2JongjKFuVbyu-L_S47s2SYlZdYiIp3sSCijJ50hTJjTivshBXJjtVpk5W9r7OapmZVBudVlaKtyR65Mjr_UiK2b0ub_K-rPX9YZ3rqHfx8_vF7UPv29UVCVro3-XHifz01cyfZru_Tr73-zv5Nt2-z0ypTV-G9TZ9Prl-0KJnx9rxtuiRIq6zL1neV169wUe3Dyvby_YySbeaW1Q2cKu5dKu5dKE56PZB88G5mqv2p6ncemZR2dCtZ8qtZ8qFZ6DbB8-G53rmtz9N361nFpWN3Hrmu_XMd-EZ6PbBs9G5ngXtTzNw65lFZWO3ngVuPQtceAa6ffBs_D-uh0fWv9NFni0L3erm520bptMnvT-AIluZqb412XS3zf7jzY7b3QdSXZT7b9X-w-Vy_9W2wPbwsAssZSc67ESPeVpa9EzZwcMucK1ntnTYiR7ztKrT3r-0X4G9OuyzcMCfVsDCSvJbh13mg4fBfPAwmg9Ag_kANJiPQZf54GEwHzyM5gPQYD4ADeZjyFo64iUddZmPcRfDeRgYzsPIcEADwwGNEsAmNpu_pDa5aUvDELBKTmscaC4bKVJRVSpedMnHCDBdNnLERnVAA9cBjWRHOLAd4Uj3RoZa6c7TSHeehroDHOkOcKR7I0irug-A7o1MsdK9kSlWuvM00p2noe4AR7oDHOneyFMr3Xka6c7TUHeAI90BjnRvpGr1ru3xuqtGtrC6x5sPfwMAAP__S381-g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mN1rGkEUxd_7V8h9aukWnQ8_oWBpAw2EJCR5KBQfNu40CsaV3RViQ_73olaNO-49M-7qWz48c--5c8-PXV9pGkfmOnw2KfV-k6CAJAWkKCBNATVpENAsiYcmTeNk-ZG14DJ6oV4joPF0Ns-Wfx4ENIwTQ71XysbZxFCPHsLHibkzYWSSeoMCikwWjierMrNk_Bwmi_7L4i8FdDPPerW-pMFbQPE8252YZuGToZ54C9yr_hin2Xg6zOrN_ZJ9kTt_J3lc1EZhOjrw-V0P0qeH986Fg_V8a7uy6ijrolrvurCJ3TnzaZxEJjHR3kmrUwrblA3Q5q6F5qlaQJPatdAq0UJwVJc_w3R0b7KbWV3lJvWwmJle7eLX94vbh9q3qysKaGL-ZB_74tPXZPw0Wv3ksF5tn_W6j5PMJHVljexz4fkdh5kdGsf_Qw80cR1_iWd13cgP-GD57l554RHa6nAFqm43sXVCXPk4d7DuiitX66Ja77qwiZKsEEfiqsIW0KSKcOXXQmlciXPgCqzXBlfWyFxxJd1TI6vjBai6XYX2CXnh4Vw4WHflhat1Ua13XdhEybDKI3lRYQtoUkW88GuhNC_kOXgB1mvDC2tkrrxQ7qlR1fECVN2uQueEvPBwLhysu_LC1bqo1rsubKJkWNWRvKiwBTSpIl74tVCaF-ocvADrteGFNTJXXmj31OjqeAGqblehe0JeeDgXDtZdeeFqXVTrXRc2UTKs-kheVNgCmlQRL_xaKM0LfQ5egPXa8MIa2TFfnxw4_86ks3iaGqdvRhrLgZnoyawvII3nydDcJvFwVWb9681Kt_pDZNJs_V-x_uVyuv7XssH3YpEXi_divScWfmKhyqilKKXullGrNq-W7MQVP3HFlm7ylXmxAPfFq6Uso1aNUuoOr9bsxFu8uOkhlnlxixW3-btus2LgucOKNQh2l6dCA2DBgooXF3g1BAMvh2QAcoQGXo7YICy07A9egsFbbPHBA1AjPgA5AgSQI0IgOYiLsAizP3g0Oh4xObmFCcFDRrTAtfOYQdZ5zogOKG6RxivsvBqGnZfDsAM5Cjsvh2HnKSsBZSWPGrCxQI3CDuQo7ECOwo7kYOMlT1kJlk7yT3A5uRV2yaNGanDtPGqQdZ40EpBGWqTxCTtQo7ADOQo7koOwAzl86ucpKwFlJY8aFHZAWXRvAJMo7ACTKOxAjjaep6wCW6P4F-Sc3Aq74lGjwAOd4lEDrCueNAqQRlmk8Qk7UKOwAzkKO5KDsAM5CrviKasAZRWPGvSWDyiL7g1gEr3nA0yiF30gRxvPU1aha-ffmnNyO-w8ajR4oNM8avLWB28f_gUAAP__TrDF2w==

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk9v2kAQxe_9FGhOreIKZm2TxFIlqiqHSGkSJTlUqjg4eEqQCLbWRgqN-O4VGJXwb5-XNb4l4J_fvNmZfbzTJE3kNn6VnKLfxOSRIo988iggj0Lqe5TpdCB5nurFIyVwnbxR1PFoNMmmxeLjvkeDVAtF71SMirFQRE_x81geJE5EtzvkUSJFPBovZTI9eo31rPc2-0se3U2LqNVT1J97lE6L9RvzIh4KRTz3qqs-proQ3Q43BXt8tvX6NfE8a73E-cs2QP35ugRlU8JH4-zk3D_COddsPThYw_o9qU5ES7JXuNJTe-z8FD2URynusrbaauLTLJOodfXrx9X9U-v7zQ15NJY_xecen335pkfDl_LP_w3mgw0OK5ibTvYVvrfm2_RrmrVVuPXkfu3uhjZbzFR9ywRUVyPVPeUy2Rh3cu4f4Zxrth4crKG5ZeJmlklVP1dV30AD1dWxnp9yoC2Ms5Nz_wjnXLP14GANzQ20amag_ern6tc30EB1dawXpxxoC-Ps5Nw_wjnXbD04WENzA-03M9BB9XMN6htooLo61stTDrSFcXZy7h_hnGu2HhysobmBDpr__b6nogfJs3SSS6Vf552FJ0mGUnYqT6d6IPc6HSxlyn_vltzyg0TyovyWy3-uJ-VXiwI_wrwN80c42IDZDuaOEx260MpJWwFtZey4b-64b9FxZQdvddyWDl1o5aStgHZg7Dg4rtAIq675vLpG-twMn7uslxlG6wVo0DMzjdYL0ED7wtjxS3PHL13Wywyj9QI0GHEzjdYL0ECbzRmCruKd23QzgRSIoJ3r1CqDzDQMIYAj62YcxhDAkfrOpbrZ-AA0fudWtdkVQKNlQTiaWDOO1gXhSN0cKejYzJHCIFPYKVQADffFLVYADvfFLVjYnCwMooWdsgXQcF_c0gXgcF_c8kU55Ysy54sC-aKc8gXQaF8Qjqy75QvCkbo5XxTIF-WUL4BG-4JwNLFu-YJwpG6XL_35p38BAAD__2XuPfY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F-L20YUBfD3fgozTy1Rse-d8V8ouLR5CKTZkOxDofjBsae7ho1lJBmyDfvdi9dLtNZI98xYI73tv6O5OtL8mPV3tU-39sP6q83V4h9FKlGsEqVVooxK1FitEnXI0o3N8zQ7_ck58G77TS1GidrtD8fi9ONVojZpZtXiuyp2xYNVC3W7_vJgP9n11mbDkUrU1hbr3cPzMods93WdPS6_Pf6nEnVzLBaDJavVU6LSY1FeMS_Wd1Yt6CnxX_VzmhU2G44vF1zSm8bLc8jl_9zlxW6_KYY0qq5wupNsazO7XQyWVFmuvMKXx8H9Or930qunciQdMtLrnmncpmhzRdHs9NDc9Piqptl5lhGbnjSOVF4nPa9Vd5_S3DrsDSlnmnY4U1iX5Uwzj5mO-7qpVqck-pOamf-y2Z39bIubw9BUmrx9PNjF4O3ff7z9eDv4_f17lagH-2_x85Le_PJbtru7P3_5441vvq15i9uqmflD-mt6GJpxtYB61kYXi1PALo-nKVj1ZZNPrtUUXL7UlHrTNKTnSTxN_YpmpwdfTX2bZudZdqYpRZUr7A1p0jTuTGFdNmlaP1N3mlI_mrL_RuN4oIFVX_bZ9FrQwOVL0Lg30AJ6pmk80PyKZqcHX9B8m2bnWXYGGkfFI-wNaQIt7kxhXTaBVj9Td6BxP6Bp_42m44EGVn3ZZ7NrQQOXL0HTvYEW0DPN4oHmVzQ7PfiC5ts0O8-yM9B0VDzC3pAm0OLOFNZlE2j1M3UHmu4HNOO_0Uw80MCqL_tsfi1o4PIlaKY30AJ6pnk80PyKZqcHX9B8m2bnWXYGmomKR9gb0gRa3JnCumwCrX6m7kAz_X-AVzPRJ5sf0n1uvT6eG53uyW7v7LmjPD1mG_sxSzfPy5y_vXnOPf9ga_Pi_Fs6f_Nuf_7VacDXYRLDLIe5GqbX4clFmMLC1CrN4zZpbdqkjZbTWmzcyI0bMTyWw2Nx7qk8thymVmkGD1tOa_Cw5bQBD3siNj6Tw9OAMFfDMzE8l1eey2_ZBKgATEGoyKoQYIVauQLSCBYQR7KAOKIFxJEtJONCQBeSeSHgC7UCBqSRMCCOiAFxZAyII2RIVoYAMyQ7QwAaaiUNydTwCJwhZGoYUMMONUFnEDkNDyFyHJ5C5Dg8hshxZAU71FwWr0HxMjUMqGGHmhArQBpZAeLIChBHVoA4soIdai6LR_cuU1OJO1awTA2wgmVpeA5eGpkaDajRDjUhVoA0sgLEkRUgjqwAcfg_i3yg0-BAp2VqNKBGO9SEWAHSyAoQR1aAOLICxJEVWj7QaTS8TE0l7lihZWqAFVqWRs_ASyNTowE12qEmyAo5Da2Q49AKOQ6tkOPICiMf6Aw40BmZGgOoMfI_UGCzgzSyAsSRFSCOrABxZIUBH0yh1WVqKnHHCiNTU7Vi9fTT_wEAAP__t4McMg==

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll1r2zAUhu_3K8K52phGLNnOh6HQMTpWKG1pczHYcuHGWhNIYyMr0Kz0v48kDZ3j9LxWXIzv6tqPdKzzvDl-okWa6Mv4QecU_SJJghQJ8klQQIJCGgvKTDrReZ6a9SNb4Dx5pMgTNFtkS7v-91jQJDWaoieyMzvXFNEovpvrGx0n2nQ9EpRoG8_mm20yM3uIzer0cfWXBH2fza02UedUdn4vPc-fdFQUReeXIxJ0tbTrGzR-FpQu7ctur5vcrTrTOJ8Wl988PxaU2_heUySfxXFVhy5V65N3Llu9WfbrOstFahJtdFJYabwm0SMH3v1HnE9vtb3KunKvYaNVpqPO2c9vZ9ejzteLCxI013_sx1P56cTM7qebv95879d38l1acZsaq01XhvvH9PnN9YMKZ3boOF4WPVDEZfolzbrK2z_gg9uHhe1lddNke_LhUHWvRfmQzeZDNpEP0IpdPnrH5kNVb7Vqj6AOVfdbJKhqVlDVhKCgFTtB-8cK6ldvtd8eQR2qHrRIUL9ZQf0mBAWt2Ak6OFbQoHqrg_YI6lD1sEWCBs0KGjQhKGjFTtDhe3wCH1j_RudZush1pa9bb31gOrnX2wbk6dJM9LVJJ5tttpdXG27z6ZLo3G7vqu3F-WJ7a11gdbhfB5ayFh3Wooc8LR3OTLnB_Trw3pm50mEtesjTap_2_qf9Auztwz4LB3y3AhZWkt86rJMPHgb54GGUD0CDfAAa5KNXJx88DPLBwygfgAb5ADTIR5-1dMBLOqiTj2Edw3kYGM7DyHBAA8MBjSaAy9gs_5K6zE1XGg4Bp8npjAPNZWmKFFSVihdd8mMEmC5Lc8RFdUAD1wGNZEc4sB3hSPfSDHXSnaeR7jwNdQc40h3gSPfSIC3q3gO6l2aKk-6lmeKkO08j3Xka6g5wpDvAke6leeqkO08j3Xka6g5wpDvAke6lqVr81vZ43VVptrC6j58__AsAAP__XY-Brg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v2kgYhe_3V6C52tV6heeDL0uRsmpTNVKURAkXlVouHDwNlghGtpFCo_z3CigQPPg9Hsb4LsGcmeMz73lk88ZmSaRvwxedseA748xjgnlMMo8p5rEOG3lsniZjnWVJuvrKRnAdvbLA91g8my_y1ccjj42TVLPgjeVxPtUsYMPwaaofdBjptO0zj0U6D-Ppept5Gr-E6fLydfmLeexLPM11GrQueevHwvfluCWCILi-HTKP3S3y1QU2evdYssj3u2V5-KxZwN-96o4-x1kez8Z5u3Nox1h_L3latiZhNjny_b0HYePhYyrcKhZ9YZGLPCkXXm8wqtTEfp3FLEkjneroYKX1KqU2hQ9s7i10zmUBJbW30HWw4J3k8muYTR51fjdvy0JSw-VcB62rb5-u7oet_29umMem-mf-9yX_5yKNnyfrvyqMV89mvB6TNNdpWxqR_Vu6fr9CZsfi-LPoERO3yX_JvK38YsBHtx8cbM8tGt0M54Cj3ZR2z8g5m1SsYnHgXNVceL3BqFITjpDhJ3KuRgsoqTLO2Vlw5hxvgnNgvLacMyKryjlRvVKiGdAAR7sx6Z0RNBapcKtYHEBTNRdebzCq1IRjy8WJoKnRAkqqDDR2FpxBI5oADRivLWiMyKqCRlavlGwGNMDRbkz6ZwSNRSrcKhYH0FTNhdcbjCo14dhyeSJoarSAkioDjZ0FZ9DIJkADxmsLGiOyqqBR1SulmgENcLQbk8EZQWORCreKxQE0VXPh9QajSk04tlydCJoaLaCkykBjZ8EZNKoJ0IDx2oLGiOyUn4iOrP-gs3kyy3SlX3_8VWA6etabA8iSRTrW92kyXm-z-fdurVt_EOks31zlm3-uZ5tLK4Mfxbwo5h_F6kDM7cRcuqgFd1IPXNSyR6sFmbikE5fk1h16Z1rMwXnRaiFc1NJ3UvdptSIT79LijoVYFMVdUtyjz7pHisE990mxAsUe0FTwARYMqFhxgVZDMNBySAYgR2ig5YgN3EDLYfACBG-wxQYPQI34AOQIEECOCIHkoC7cIMxh8Cg6GjEFuYEJTkOGd8Gx05hBt05zhvfB5gZprMpOq2HZaTksO5CjstNyWHaasgJQVtCoARML1KjsQI7KDuSo7EgOJl7QlBVg6AT9BFeQG2UXNGqEAsdOowbdOk0aAUgjDNLYlB2oUdmBHJUdyUHZgRw-9dOUFYCygkYNKjugLDo3gElUdoBJVHYgRxNPU1aCqZH0C3JBbpRd0qiR4IFO0qgBty5p0khAGmmQxqbsQI3KDuSo7EgOyg7kqOySpqwElJU0atBbPqAsOjeASfSeDzCJXvSBHE08TVmJjp1-ay7IzbLTqFHggU7RqCne-uj9r98BAAD__8OMEZ4=

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll9r2zwUxu_fT2HO1TumEUu288dQyBgdK5S2tLkYbL5wY60JpLGRFWhW8t1Hkmad7VSPFRfju6bxTzrW-T05eqZlmsir-FHmFP4gTowEMfKIkU-MAooYZSqdyjxP1faRPXCRPFHoMpovs5Xe_jtiNE2VpPCZ9FwvJIU0ie8X8lbGiVQ9lxglUsfzxW6bTM0fY7UeP61_E6Ov84WWKnTG3Pm5cl1Pnjk8DMOLqwkxul7p0BkLijaM0pV-2e51l_u1M4vzWXH9MadoEzHKdfwgKeQbdlrZgU3ZU8d716rFm1W_rrNapiqRSiaFlaItiR458urf4nx2J_V11uOlhk3WmQyd8-9fzm8mzufLS2K0kL_0_2P-4UzNH2a7v_6-Ny-99-s7eTaduEuVlqrHg_IxfXxzfb_GmR07jpdFjxRxlX5Ks55wywd8dPugsD2vLxrvUD4syu53Jx-83XzwNvIBOnHIR__UfIj6nRYdEtSi7EF3BBXtCiraEBR04iDo4FRBvfqd9jokqEXZw-4I6rUrqNeGoKATB0GHpwrq1--03yFBLcoedUdQv11B_TYEBZ04CDp6jyvwkfVvZZ6ly1zWut262wOTyYPcNyBPV2oqb1Q63W2z_3i943ZXl0Tmev-t2H-4WO6_2hZYHx40gTlvRAeN6JGZ5hZnJuzgQRO4dGa2dNCIHplpUabdf2mvALtl2DPCvrlbvhEW3Lx10CQfZhjkwwyjfAAa5APQIB_9JvkwwyAfZhjlA9AgH4AG-RgYLR2aJR02yceoieFmGBhuhpHhgAaGAxpNAJuxWf0ltZmbtjQcAlaT0xoHmvPKFCmoyoVZdG4eI8B0XpkjNqoDGrgOaCQ7woHtCEe6V2aole5mGulupqHuAEe6AxzpXhmkRd37QPfKTLHSvTJTrHQ300h3Mw11BzjSHeBI98o8tdLdTCPdzTTUHeBId4Aj3StTtXjXds26i8psMeoebf77EwAA___5-4G4

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFtv4kYcxd_7Kax5alVXeC7cLEWialM1UpRECQ8r7fLg4NlgiWBkGylslO--AhYIHvw_Htv4jduZOT7zPz_ZvLNFHOq74FWnzP_KOHOZYC6TzGWKuazLJi5bJvFUp2mcbH6yE9yEb8z3XBYtlqts8_HEZdM40cx_Z1mUzTXz2Th4nutHHYQ66XjMZaHOgmi-3WaZRK9Bsh69rX8wl_0XzTOd-M6IO99Wnif1lcN937-5GzOX3a8y3xkJNvlwWbzKjtulWfCimc8_3PKW_o3SLFpMs0731M-I59Y_Sp7XzixIZ2d-f_QgbDx8joVb5TJ1ZOlYZKVYeLO5qEITx3VWizgJdaLDk5W2qxTaFB6webTQvZQFlNTRQq-GBbeSy_-DdPaks_tlR-aSGq-X2neuv_xz_TB2_r69ZS6b6-_Z7yP-x1USvcy2rw7jVXxNfZvxeoqTTCcdaUT2Z-H6gxKZnYvj16JnTNzFf8XLjvLyAZ_dfniyPbcodEucA5YOY9q7IOdsYrHKpTrnysbCm81FFZqoCRlekXMNWkBJFXHOzkJtzvE2OAfGa885I7KynBPlGyVaAg2wdJiT_gVBYxELt8qlOmjKxsKbzUUVmqjZclERNA1aQEkVgcbOQm3QiDZAA8ZrDxojsrKgkeUbJVsCDbB0mJPBBUFjEQu3yqU6aMrGwpvNRRWaqNlyWRE0DVpASRWBxs5CbdDINkADxmsPGiOysqBR5RulWgINsHSYk-EFQWMRC7fKpTpoysbCm81FFZqo2XJVETQNWkBJFYHGzkJt0Kg2QAPGaw8aI7IqfxGdWf9Rp8t4kepS__54m8B0-KJ3B5DGq2SqH5J4ut1m9_Z-q9t-EOo0233Ld29uFruvNgY_i3lezD-L1YmY24m5rKMWvJZ6WEct-7RakIlLOnFJbt2ld6bFHJwXrRaijlp6tdQDWq3IxHu0uGshFnlxjxT36bPuk2JwzQNSrECxhzQVPIAFAypWXKDVEAy0HJIByBEaaDliAzfQchq8AMEbbLHBA1AjPgA5AgSQI0IgOagLNwhzGjyKjkZMTm5ggtOQ4T1w7DRm0KXTnOEDsLlBGquy02pYdloOyw7kqOy0HJadpqwAlBU0asDEAjUqO5CjsgM5KjuSg4kXNGUFGDpB38Hl5EbZBY0aocCx06hBl06TRgDSCIM0NmUHalR2IEdlR3JQdiCHd_00ZQWgrKBRg8oOKIvODWASlR1gEpUdyNHE05SVYGok_YCckxtllzRqJLihkzRqwKVLmjQSkEYapLEpO1CjsgM5KjuSg7IDOSq7pCkrAWUljRr0lA8oi84NYBI95wNMogd9IEcTT1NWomOnn5pzcrPsNGoUuKFTNGrylz75-O1nAAAA__-ffBGo

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll2L2kAUhu_7K-RctTBFZxLdNVCwlIUuLOuy9aJQcpE1pyq4TpiMsHbxvxdNF-tHz8n0QHIZk2fmnTMP-L7CyuZ4nz1jCckP0KDAgIIIFMSgoA-pgsLZKZaldbtPKuA2f4Gkp2CxKtZ-93OqYGodQvIKfuGXCAlMsqclPmKWo-v2QEGOPlss99sUbvGcuc3oZfMLFIzXPumMtBoZSLcK7Nr_WfSw1tOmM8_K-fEqb0iqoPTZDCHRW_V_-fp8PqNGWprP_DPfYan1yrocHeZHi6U7kvvkwiG_ZuX8G_px0dUndzDZFJh0br5_uXmYdD7f3YGCJf707_epP3xyi9n87YG6o8PhIsHhLiS_tx9t0dX90zFc3Ds-2lvXv3jdhpgB-QZtiKmbFVM3KqapP3zThhwB-a7akMM0K4dpVI6o_vCjNuQIyHfdhhxRs3JEjcoR1x9-3IYcAfmGbcgRNytH3FrfuZDrEcvCrkqs1WZ6u5NhPsNqUqVduyk-ODvdb1M9jvfc_r86x9JXb031cLuqXu0C1ocHEngogbUot-7TtA4YmQmDBxJ4KIG1KPfJyM5oc0r3_qYjet4RCevjmfVO6VgiOA0zgtMwIzgNc4IzNCN4XyI4DTOC0zAjOA1zgjM0I_hAIviVRFEaZhSlYUZRGuYUZWhG0WuJojTMKErDjKI0zCnK0IyiQ4miWtQTGJqRlKEZSxma05TDua4gKwuytiCrC8K-ICsMWtQY9FllCLKVpjlbaZqzlaZZWxmcszWkLJ3fWUhbCqU5W4P6UjDO2XpWHkhb0-273wEAAP__OWBG8A==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r2zwUxu_fTxF09Q40kiM5f2GQsRVWKG3pejEYuXBjrQmksbEdaFb63UcSljR2fB4psrvLtP1Fx4_1eyz3RSzjyFyHTyYTo5-ChBRKSKGFFIGQoismUiRpPDVZFqebP9kBl9GzGHWkmC-TVb758USKaZwaMXoR-TxfGDES9-HDwtyZMDJpuyOkiEwezhfbZZJ0_hSm6_Hz-reQ4maVj1pjkmMlJq9SxKv88KVZHj4aMaJXab_w13mWz5fTvN09XvXUEgfqYd2ahdnsNHKYRLlM8jYCsshAyTFVZqDPyoCaCCGoHOXwVatlnEYmNdHRl22_pXJY1cHDHqboNjWFRWSHKXoeU8izBv0WZrPvJr9J2rqQ1_06MaPWxY8vF7f3rc9XV0KKhfmV_7-9gg-f0vnj7O8HO-_69UZ8HX-Mk7buFmM4ufbgaG1yMK3WsgEL73dNr_GycYnAIgOHsrHNgJoIIagcxVNzOr9sapzCIrKqsnGbwrts6F3LRtnvdlWr8GDh_Z3rNy68QwRkkYGD8LYZUBMhBJWjeKqmzhe-xiksIqsS3m0Kb-HVuwqv7Xe7rlV4sPD-zg0aF94hArLIwEF42wyoiRCCylE8VdPnC1_jFBaRVQnvNoW38PpdhQ_sd3tQq_Bg4f2dGzYuvEMEZJGBg_C2GVATIQSVo3iqFpwvfI1TWERWJbzbFN7CB__s_wcn5rozWRIvM2P134HO5spM9Gh2SWXxKp2a2zSebpfZfbzZctsfRCbLd7-l3YfL5e5XmwHfwlSE6S0cHMHkBpPyooc-tOr50FrztGIT13ziml26y6_MwwTm5mnV8aL7PrQGOy1gEwc3u-sAqyLcY2Fw0X1-o_T4nTJg6SEPD33E5mEkNqCB2DyNxOZpJDaBLkVlytcKcBvQSG6AI7sRDnY6wJHfxFcqIbzULhxecpz4ekGXzvcLAcup1DBOj2Cehs9ggKOHMI_DpzCPQ1v5eqUBCL7Ur0628jS0lcehrQBHW5bHoa2llj0KXhE4PvEtW8BLtqpS1bjYqvimUeD0pvhzDAgO0MhWhANbAY5sBTg8NPMlq7og-FLLutgKaGQrwJGtCEdblseRrYo_wqoBwPmWLeBlW_lTLLp0vml0B7xrlZrGxVZAI1sRDmwFOLIV4MhWzZesViD4Uss6veXyNHzN5XH4ngtw9KLL48hWzR9lNYqOb9kCXrJV82fZ4qVPXv_7EwAA__8-uOSb

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFtr4lwUhu-_XyH76huaQddK1CoMOAyFKZS2tL0YGLxIzZ4qWBOSCHWK_33wANakWe9eHnJXD2_WzpM87459N7M4srfhq81M_7ch4xk2nvGNZwLjmbYZeiZJ45HNsjhdfWUTuI7eTL_lmcksmeert4eeGcWpNf13k0_yqTV98xQ-T-2DDSObNlvGM5HNw8l0PSZJJ69huhi8Lf4az9zN835jQN6AzXDpmXie7w6a5eGLNX1aeu6DH-M0t2mzvT9zwBfSrF38edEYh9m4kCYzXO7Ww5r1fARBDiTYG_iVJPwDSNA5UQSVC9odJ04jm9qovIrhKuzwrU_O7WeYjR9tfpc0ucD0aZHYfuPq14-r-6fG95sb45mp_ZP_P6Av39LJy3j91w5AJer2Aai5iJouKo_fOZgcVTC5jb_GSdPf51E1vrs3nhT38EllBoO3XDu1yawB4UBCIbMbCToniqByQbXJTHXI7Iaai6idZWb3m4hPahMYvD2xbm02KUCQAwmFTW4k6JwogsoF1WYT12GTG2ouona2yXe_ifyT2gQGb0_ssjabFCDIgYTCJjcSdE4UQeWCarPJr8MmN9RcRO1sU-B-EwUntQkM3p5YrzabFCDIgYTCJjcSdE4UQeWCarMpqMMmN9RcRH3Qz7ZPjv9gsySeZdbpF1lrBcxGL3ZzGbJ4no7sfRqP1mM2L-_WufUbkc3yzae0eXE923y0WuDHMBXD9DEc7IVJFyY6Kt09Js3-UemenGaRuC8T9xXEWRcuENemu8ekC8S16Z6cDkTibZl4Wwx35Gvdka810Ksrpi_l8OUxbsph5CZIAzflNHITpIGbPbkNW6AOS2WqsROkkZ4oDvwEcSQoigNDqVSp--AZgJc7FUhKpXbZHx6A4aV6Ue2CchpugyCO9kE5DjdCEAe2kdyt1AHgS-2q0k1OQ91AHOkmx6FuII50k3cWAlsLlUpWpZtcsgxKljUlW374UpWsOg50A3GkG4qjB0-5ZBmULJdKVqMbSCPdUBzoBuJINxQHurG8wTDYYFh-fgW6sVyyDEqWNSVbHq4qWXUc6aYqWXUc6SaXLIOSZc0DfPmWUz3Bq-NIN9UzvDqOdJM3GB9sML78L5GibsPlf_8CAAD__5eaYlc=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9rG0cUBfD3fgozTy3ZIs2du_oHBZU20ECIQ-KHQtGDIk1tgaMVuyuIa_zdiyXBWjPSPbM7I73Fdo7u3bOzP9Z-VutiaT_Nv9tKTf5RWmWKVKaMyhSrTOVqlqlNWSxsVRXl63_ZBz4sf6hJP1Or9WZbv357lqlFUVo1eVb1qn60aqLu5t8e7Rc7X9qy11eZWtp6vnrcjdmUq-_z8mn64-k_lanbbT25mepsSmr2kqliWzcfWtXze6sm-iULH_y1KGtb9vLjmVN6FzaL2sz6c1XVq_Wi7mnnEqe6meaMatLfnm4e5tWDl5y9NOuYNuu87VznuHTKpuZsEdyhdHJrCG0979Q6uTc5VeuDs-s0n7NdF-XSlnZ59Em7Tzm7sPGPyblGhpdawe_s3AqjiBWyTlv-Na8evtr6dtNjp6m7p42d3Lz_-4_3n-9ufv_4UWXq0f5b_zzVv_xWru4fdv86e_ebaxp3ONXsVfbuPFX9gNJO9XH41BNbfCp-LTa9vO82fHr-sZW6BRhJkQaDD80OkiANZjVI66sg3abzQVKkw0ont4ZuSIe2Tu5NvgzSOp2Q_jEJQzrhCn5nYUi3WyEaaX0NpMNONXuVBSNN4Q8sJUUSDD5c2TAJkmBWgyRdBckWnethUiTDSie3hm5IhrZO7k2-DJKUTij_mIQhmXAFv7MwJNutEI0kXQPJsFPNXmXBSJrwB9YkRRIMPlzZKAmSYFaDpLkKki0616OkSIaVTm4N3ZAMbZ3cm3wZJE06ofxjEoZkwhX8zsKQbLdCNJLmGkiGnWr2KgtGksMfWE6KJBh8uLJxEiTBrAZJvgqSLTrX46RIhpVObg3dkAxtndybfBkkOZ1Q_jEJQzLhCn5nYUi2WyEaSb4GkmGnmr3KOv1N9MSAL7baFOvKBv25s__amF3e2_0dqIptubCfy2KxG7P_8naX231jaat6_1O9_-LDev-j1wXfhrUYJjlMbli_DQ-OwrpdWA9j0hSVNlFpBmkjNs5y4yyGczmci3uDteWwHsWkKSptotIM0gOxcRAetgiTGx6J4bF8r8cyCn15by2bkiNUZFU0YEV7D9hx3IC494S1YQmkkUsgjmACcSQTiCOatMyLBr5o70k7jg9A3HvU2vgE0ggoEEdCgTgiCsSRUVp2Ro9BXJbGiXtOadka6oOXCPD-Aqgi8AaDXmFkawhYQ1HWgDR8B4qzBsThW1CcNSRbQ8Aakq0hYA1FWQPSyBoQR9aAOLIGxJE1JFtDwBqSrSFgDcnWGGCNibPGyNYYYI2RrTHAGhNlDUgja0AcWQPiyBoQh79yydYYYI2RrTHAGhNlDUgja0AcWQPiyBoQR9YY2RoDrDGyNQZYY2RrGFjDcdawbA0Da1i2hoE1HGUNSCNrQBxZA-LIGhBH1rBsDQNrWLaGgTUcZQ1II2tAHFkD4sgaEEfWsGwNA2tYtoaBNSxbkwNr8pbWzF5--j8AAP__7ZsKUA==

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1r6lgUhu_nV8i-mqEZdK1ErcKAw1CYQmlL24sDBy9Ss08VrJEkQj3F_37wA6zZx_Xu5Ue8qx9vVvIkz7u3_TSTNLH38bvNTfe7IRMYNoEJTWAiE5im6QdmmqUDm-dptvzKOnCbfJhuIzCjyXRWLN_uB2aQZtZ0P00xKsbWdM1L_Dq2TzZObFZvmMAktohH49WYaTZ6j7N572P-0wTmYVZ0az0Kemz6i8Cks2J70LyI36zp0iLwH_ycZoXN6s3dmT2-kmZt46_z2jDOh6U0mf5iez6sOZ-vIMiTRNAL98IID4BBLo2gF16BmToo0d7z2h4nzRKb2cS9Nf1lGH1rdcqrkeXL_D_Oh8-2eJjWuUT4ZT613drNt_9uHl9q_97dmcCM7Y_izx799U82ehuu_tpy2Eu9eQB1LlOnq73Hbx1Mj_YwuU__Tqf1cJfHvvHtnfGkeKJPqjYYvOHaqkxtDQhPEv5q-8Egl8aZ1aZLqU1VqO1HncvUvdVm_0eKT-oWGLy5sHZlbilAkCcJf7f8YJBL48xu8aXc4irc8qPOZereboX-j1R4UrfA4M2FXVfmlgIEeZLwd8sPBrk0zuxWeCm3wirc8qPOZerebkX-j1R0UrfA4M2FdSpzSwGCPEn4u-UHg1waZ3YrupRbURVu-VHnMvWDfu795vhPNp-mk9x6_ZJrLIHZ5M2ub0WezrKBfczSwWrM-uXDKrd6I7F5sf6U1i9uJ-uPlif4NUzlMH0NRzth0oWJjkq3j0lzeFS6I6dZJB7KxEMFcdaFS8S16fYx6RJxbbojpyOReFMm3hTDLflet-R7DfRqi-lrOXx9jJtyGLkJ0sBNOY3cBGngZkduwwaoQ6dMNXaCNNITxYGfII4ERXFgKDmVugueAXi5U4Gk5LTL7vAIDHfqRbUKymm4DII4WgflOFwIQRzYRnK3UguAd9pVpZuchrqBONJNjkPdQBzpJq8sBJYWckpWpZtcsgxKljUl626-VCWrjgPdQBzphuJo4ymXLIOSZadkNbqBNNINxYFuII50Q3GgG8sLDIMFhuX9K9CN5ZJlULKsKVl3uKpk1XGkm6pk1XGkm1yyDEqWNRt495FT7eDVcaSbag-vjiPd5AUmBAtMKP9LpKxbf_HHrwAAAP__2dVwZw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9rG0cUBfD3fgozTy3eIs2du_oHBZU20ECIQ-KHQtGDIk1tgaMVuyuIG_zdiyXBWjPSPbOa0b7Fdo7u3bOzP9b-odbF0n6cf7OVmvyjtMoUqUwZlSlWmcrVLFObsljYqirK1_-yD7xffleTfqZW6822fv32LFOLorRq8kPVq_rJqom6n399sp_tfGnLXl9lamnr-eppN2ZTrr7Ny-fp9-f_VKbutvXkZqqzKanZS6aKbd18aFXPH6ya6JcsfPCXoqxt2cuPZ07pNmwWtZn156qqV-tF3dPOJU51M80Z1aS_Pt88zqtHLzl7adYxbdZ527nOw0rPpuZsF3xB7-Q2QbfZ1NwGz8wv6p_c252q_8HZdZrP2a6LcmlLuzz6pN2nnF3Y-AfmXCPDa63gd3ZuhVHECtlFW_41rx6_2Ppu02OnqfvnjZ3cvPv7j3ef7m9-__BBZerJ_lv_PNW__FauHh53_zp795trGl9wuNmr7PY8Wv2A0k71cfjUE1t8LH4tNr287zZ8ev6xmroFHUm5BoMPzQ6ScA1mNVzrTrhu0_kgNddhvZPbRBTXof2Te7uvw7VOZ6V_YMK4TriC31kY1-1WiOZad8F12OFmr7Jgrin80aWkXILBhysbJuESzGq4pE64bNG5HqbmMqx3cpuI4jK0f3Jv93W4pHRW-QcmjMuEK_idhXHZboVoLqkLLsMON3uVBXNpwh9dk5RLMPhwZaMkXIJZDZemEy5bdK5HqbkM653cJqK4DO2f3Nt9HS5NOqv8AxPGZcIV_M7CuGy3QjSXpgsuww43e5UFc8nhjy4n5RIMPlzZOAmXYFbDJXfCZYvO9Tg1l2G9k9tEFJeh_ZN7u6_DJaezyj8wYVwmXMHvLIzLditEc8ldcBl2uNmr7KK_nZ4Y8NlWm2Jd2aA_i_ZfG7PLB7u_A1WxLRf2U1ksdmP2X97tcrtvLG1V73-q91-8X-9_9Lrg27AWwySHyQ3rt-HBUVi3C-thTJqi0iYqzSBtxMZZbpzFcC6Hc3FvsLYc1qOYNEWlTVSaQXogNg7CwxZhcsMjMTyW7_VYRqEv761lU3KEiqyKBqxo7wE7jhsQ956wNiyBNHIJxBFMII5kAnFEk5Z50cAX7T1px_EBiHuPWhufQBoBBeJIKBBHRIE4MkrLzugxiMvSOHHPKS1bQ33wEgHeXwBVBN5g0CuMbA0BayjKGpCG70Bx1oA4fAuKs4ZkawhYQ7I1BKyhKGtAGlkD4sgaEEfWgDiyhmRrCFhDsjUErCHZGgOsMXHWGNkaA6wxsjUGWGOirAFpZA2II2tAHFkD4vBXLtkaA6wxsjUGWGOirAFpZA2II2tAHFkD4sgaI1tjgDVGtsYAa4xsDQNrOM4alq1hYA3L1jCwhqOsAWlkDYgja0AcWQPiyBqWrWFgDcvWMLCGo6wBaWQNiCNrQBxZA-LIGpatYWANy9YwsIZla3JgTd7SmtnLT_8HAAD__839FG4=

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l0tr204Uxff_T2Hu6l86xb5XkpMICi4l0EBIQpJFoXihWNPY4FhiJEPc4O9e_KB-z9F4bO380M_n6sw9OviDRlmq75I3XVD8i5gUCSkKSFFIiiLqKspN1tNFkZnZJQvgJn2nuKVoMMrH5ezjrqJeZjTFH1QOyqGmmJ6Tl6F-1EmqTbNFilJdJoPhXCY3g7fETDrvkz-k6H5cxo2OqE5A3amibFyufrQok1dNMU9VdeGnzJTaNKNNzY58_qfFqiNbWiv8ZdLoJ0V_i2bqTlfziMs860awrxPBEU7wOa0IDw60-p3MpNrodHeK7gyucNWee_uRFP0nXd7nTdny9HmS67hx_fP79cNz49vtLSka6t_l_x3-9NUMXvvzVysDDlodVbiz8Wjf1HsHvsu-ZHlToq0r92u3N7TZYcFOmjQgvNyvdm1JczHC14ngCCf4nFaEBweqLWlcR9Kk-iHLSbcdCC_P-KK2bXcwgn2dCI5wgs9pRXhwoNq2XerY9qD6IQcn3XYgvDzjy9q23cEI9nUiOMIJPqcV4cGBatv2oI5tD6sfcnjSbQfCyzO-qm3bHYxgXyeCI5zgc1oRHhyotm0P6_7PsGecR13k2ajQlf4RtGY3pNNXvbCpyMampx9M1pvLLN7ez7n5B6kuysW3vHhzM1p8NRtwHeZtmNfhcANmN5hbXnTkQ4uXtgBtsToe2B0PHBwXN3jLcVc68qHFS1uAdmh1HBxXZIWlbT-vtpW-sMMXPvGywyhegAae2WkUL0AD7Uur41d2x6984mWHUbwADVbcTqN4ARpos71D0KN452m62UACKmjncerUQXYalhDA0a3bcVhDAEfqOw_VTeNDYPzOU9UlK4BGYUE42lg7juKCcKRurxR0bPZKYdAp7FUqgIZ58asVgMO8-BUL25uFQbWwV7cAGubFr10ADvPi1y_i1S9i7xcB_SJe_QJolBeEo1v36xeEI3V7vwjoF_HqF0CjvCAcbaxfvyAcqbv1S3f6398AAAD___MLXyA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F9rG0cUBfD3fgozTy3dIt07o79QUGkDDYQ4JH4oFD1stFNb4GjF7griBn_3Ykl0rZnonhntaN9iO0f37tndH2N_U5uysO_zL7ZW878VqUyxypRWmTIqUyO1zNS2Kle2rsvq5b8cAm-Lr2o-zNR6s901L99eZmpVVlbNv6lm3TxaNVd3-edH-9Hmha0GQ5Wpwjb5-nE_Zlutv-TV0-Lr078qU7e7Zn6z4Gyh1fI5U-WuaT-0bvJ7q-b0nIUP_lRWja0Go9OZC_75_1mULfjsLI6Z9ce6btabVTMg5xIX1E5zRrXpz083D3n94CWXz-06Omad153TqGPp5oLS2a0htPXRRa2ze5NTtT4-u077ObtNWRW2ssXJJ-0_5ezC2n9MzjUyudYKfmfnVph2WCG7aMs_8_rhk21utwPjNHX3tLXzmzd__f7mw93Nb-_eqUw92n-aHxf006_V-v5h_6-zd7-9plnaWt-Xv5TbgRm5V_99xoYnwyniZU4KKBh8fJfHSQAFs1pAqRdAYzofJwU0rHR2a7gM0NDW2b3J1wGU0unlPyZhgCZcwe8sDNC4FToDSn0AyuHvEyc1DAw-vk6TJIaBWa1h3IthEZ3TJKlhYaWzW8NlhoW2zu5Nvo5hnA4Q_zEJMyzhCn5nYYbFrdDZMO7DMB3-PumkhoHBx9dpmsQwMKs1TPdiWETnNE1qWFjp7NZwmWGhrbN7k69jmE4HiP-YhBmWcAW_szDD4lbobJjuwzAT_j6ZpIaBwcfXaZbEMDCrNcz0YlhE5zRLalhY6ezWcJlhoa2ze5OvY5hJB4j_mIQZlnAFv7Mww-JW6GyY6fuPcd9Z56Ott-WmtkF_ahu-XJAt7u2hoLrcVSv7oSpX-zGHL2_3uf03Cls3h5_S4Yu3m8OPXhZ8HSYxzHKY3TC9Do9PwhQXpk5pHnVJa9MlbbSc1mLjRm7ciOGRHB6Je0_kteUwdUozuNlyWoObLacNuNljsfGpHJ5EhNkNT8XwTJ48k5-yMVABmIJQkVUhwAp1cgWkESwgjmQBcUQLiCNbSMaFgC4k80LAF-oEDEgjYUAcEQPiyBgQR8iQrAwBZkh2hgA01EkakqnhIThDyNQwoIY9aqLOIHIaHkLkODyFyHF4DJHjyAr2qDktXoPiZWoYUMMeNTFWgDSyAsSRFSCOrABxZAV71JwWj65dpsaJe1awTA2wgmVpeAYeGpkaDajRHjUxVoA0sgLEkRUgjqwAcfg7i3yg0-BAp2VqNKBGe9TEWAHSyAoQR1aAOLICxJEVWj7QabS8TI0T96zQMjXACi1Lo6fgoZGp0YAa7VETZYWchlbIcWiFHIdWyHFkhZEPdAYc6IxMjQHUGPkXKPCygzSyAsSRFSCOrABxZIUBf5hC02VqnLhnhZGpca1YPv_wXwAAAP__ZZkF7g==

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltFq2zAUhu_3FOFcbaCRSHbSxjDIGIUVSlO6XAyGL9z4LAmkkZEUaFby7iP2ShYn07F2wL507E_6dfRB_lfY6Bzvs2e0kPwACQIUCIhAQAwChpAKKIyeo7XaHD6pgNv8BZKBgNWm2LrDz6mAuTYIySu4lVsjJDDLntb4iFmOpj8AATm6bLUutynM6jkzu8nL7hcImG5d0ptIMVGQ7gXorfuz6HGtp11vmdnl6SpvSCrAumyBkMi9-L98w3byqX_mOy613WiTo8H8ZLH0QFKfXDjk18wuv6GbFn1Zu4PZrsCkd_P9y83DrPf57g4ErPGne1-m_vDJrBbLt4fjDGoDOJ4sYpzsQux7_VEXfTmsz-Di3vHJ3rL5rcsurAzIN-rCStmulbI9K1XzyasuzAjId9WFGapdM1R7ZkTNJx91YUZAvusuzIjaNSNqz4y4-eTjLswIyDfuwoy4XTPibjrOhVCPaAu9sdiowQwOx8J8gdWYrN6aOT4YPS-3qR6nJVf-P-doXfVWVQ-3m-rVIWBzeMSBxxxYsnLLoZ-WASNTYfCIA485sGTlro3sjFZ1evA3HfnnHXlheTqzQZ2OOYL7YUJwP0wI7ocpwQmaEHzIEdwPE4L7YUJwP0wJTtCE4COO4FccRf0woagfJhT1w5SiBE0oes1R1A8TivphQlE_TClK0ISiY46iktUTCJqQlKAJSwma0pTCqa7AKwu8tsCrC8y-wCsMktUY5FllCLLVT1O2-mnKVj9N2krglK0hZen8zkLaUihN2RrUl4Jxytaz8uC1Nd2_-x0AAP__MSFD2g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r20gUxd_3U5j7tAta7Dsj_4WFLG2ggZCENA-F4gfFmsYGxzKSDHFDvnuxTa1Ysu7RaKT00Ul-nquj-R2N8kqrKDQ3wbNJaPKdmDxS5JEmj3zyqE9Tj9ZxNDNJEsW7PzkAV-ELTXoeLVbrTbr78dSjWRQbmrxSukiXhib0EDwuzb0JQhN3e-RRaNJgsdwvs44Xz0G8vXjZ_iSPbjfppHPB3oWi6ZtH0SbNvjRJgydDE37zqi_8eZGki9Us7fZPVz23REY9bjvzIJmfR7JJlM0k7yNg1wx0rQy4jRD80lGyr9qsojg0sQlPvmz_LaXDqh4eNpui39YUFSLLphg4TOHVGvRLkMy_mvR23dW5vB62azPpXH77dHn30Pn_-po8Wpof6d_7K_jnv3jxNP_9IdtzpVc2bDbfm-jfaN3V_XwGZ9cenazNFpo12jRg4eOWGbTeNDYRuGaga2XAbYTgl47i6DjXb5oGp6gQWVnT2E3h3DT8cU2jqm911ajtYOHjbRu2brtFBOyaga6VAbcRgl86iqNnqr7tDU5RIbIy2-2mcLZdfZztuvpW143aDhY-3rZR67ZbRMCuGehaGXAbIfilozh6puvb3uAUFSIrs91uCmfb9cfZ7lff6n6jtoOFj7dt3LrtFhGwawa6VgbcRgh-6SiOnvn1bW9wigqRldluN4Wz7f6f-Z_BmaHuTbKOVomp9B-B3u6yTPhkDjEl0Saembs4mu2XOXy83XP7H4QmSQ-_5cOHq9XhV7sB38Och_k97J_AbAezcqLHLrQauNBay7QSE9dy4lpcui-vLMMM5pZp1XOihy60BjvNFxMHN7tvAas8PBBhcNFDeaMM5J0yEumxDI9dxJZhJDaggdgyjcSWaSQ2gy5FZSrXCnAb0EhugCO7EQ52OsCR3yxXKiO80C4SXnCc5XpBly73CwPLudAwVo9gmYbPYICjh7CMw6ewjENb5XrlEQi-0K9Wtso0tFXGoa0AR1tWxqGthZY9CV4xOD7JLZvDC7aqQtXY2KrkplHg9KbkcwwIDtDIVoQDWwGObAU4PDTLJav6IPhCy9rYCmhkK8CRrQhHW1bGka1KPsKqEcDlls3hRVvlUyy6dLlpdA-8axWaxsZWQCNbEQ5sBTiyFeDIVi2XrFYg-ELLWr3lyjR8zZVx-J4LcPSiK-PIVi0fZTWKTm7ZHF6wVctn2fylT9_--hUAAP__5OXhhQ==
