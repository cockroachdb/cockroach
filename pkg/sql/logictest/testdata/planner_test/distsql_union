# LogicTest: 5node-dist

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

# Prevent the merge queue from immediately discarding our splits.
statement ok
SET CLUSTER SETTING kv.range_merge.queue_enabled = false;

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW EXPERIMENTAL_RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lk9vozAQxe_7Kaq5rhEZY_KHU669tKt2b6sc2DCqIqUY2Y7UbpXvvgKE2kTN2CbkCPS9-fnNU50PqHVFD-UrWSj-AIIACQIyEKBAQA4bAY3RW7JWm_ZPesF99QbFTMCubg6ufb0RsNWGoPgAt3N7ggJ-l3_39ERlRSadgYCKXLnbd2Mas3stzfv67f0fCHhuytoWd0naTn48uOJujbA5CtAH92lvXflCUOBRjEPIJ0OQMQjP2jgyKZ4lsMafF_2zMf75FP6fttpUZKj6zvQbiAed6CaVp2e8NF6djMfwDWLABlOZpFl0jSIg5hNCyBiIYdE4dtGB_vOx_jI8RBkSYpakKnqTERCLCSFkDMSQtLxR0oP_Yqx_Fh5iFhKiSrr_vnGbjIBYTgghYyCGpLMbJT34L8f6q_AQVUiIeRK9xwiE1WQIMgZhSFndKOXBf3WjnwBPZBtdWwq6fWft_U3VC_X3vdUHs6VfRm-7Mf3jY6frXlRkXf9V9g_3df-pBfwqRlac8WLJitWJGM_F2TVixZ8Zee6cVS948ZwVL3nx4ppDL68Rr1gxehJDvmToaxlfMw86XtUz5IuGuQedrxrOPXK-az52vmw-Nd82XHnQ-b7JmUfON87DLvnCnas3xx__AwAA__-BxeXG

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslkFvozAQhe_7K6q5riMyNiQNpx720st21e5tlQMbRhVSipFtpHar_PcVIKUlasY2cATnzZsv7wn5HWpd0s_ihSzkfwBBgAQBCgSkICCDvYDG6ANZq033k0FwX75CvhZQ1U3rutd7AQdtCPJ3cJU7EuTwu_h7pEcqSjLJGgSU5Irq2Ns0pnopzNvd69s_EPDUFLXNb1ZJ5_zQuvzmDmF_EqBb9zHeuuKZIMeTCF_hR2VdVR9cko39mfkyZv5nRFyOUU1ixHDI9KrBx9y21qYkQ-Vo6v7ErSDXwStkMYxP2jgyicTL8d-vzt-M5mNEjgExJnKVqOiyepY4_4ubiWWNgVySUk2ixHDMcV1lOKYMoVSrJI3O0rPEmXI7McsISFySUk2ixHDMcZYqHFOFUKar_lMfl6VniTPl7cQsIyBxSUo1iRLDMcdZpuGYaQhltopO0rPCmXE3MckIRFyOUU1ixHDI69eBLwweyTa6tnRxLfh68rq7LlD5TMPdwurWHOiX0YfeZnh86HX9i5KsG05xeLivh6Nuwc9iZMXpSIyXYsmKFe-s5jinrDjjnTNWLCWv3rDqLS_ezoG-ZcU73nk3xxk9HfOVbFbLkK8ZenqGs4qGfNPQUzXku-Yz57uGnrLhrLYhXzf09A1nFU7yhZOewsm4wu1P3_4HAAD__6taIWc=

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk1r4zAQhu_7K8JcV8Eeyc6HYKGHZSGXdml7283Baw_FkFpBkqHdkv9eHENah0aSrRxj95139PiB6g0aVdFt8UwG5B9AYMCBgQAGGTDIYctgr1VJxijd_Ukf2FQvIFMGdbNvbfd4y6BUmkC-ga3tjkDCY_FvR_dUVKSTFBhUZIt6d6zZ6_q50K83L6__gcHDvmiMnM2TrvlXvbOk5ewGZ3_bNBXlTEgpN7ePK2Bw19ruDWwPDFRrP7qNLZ4IJB5Y-H4_a2PrprRJPlzOMZ-Pmf_5_DgdAP0YQ0BMIoDhCLKLBR9z20bpijRVg6nbg2sFngavkI8544PSlnTC8Xz894vzF4P5OOIrB3zkhM8TcV3PPRueEC8mej6GQAyCGNNDGWA4hKHpPBwCD2Eg5kl2XQ08G54QLCdqMIIAxiCI0SCUAYZDGGogwiGIEAbZ_Pjv54oaeDY8IVhN1GAEAYxBEKNBKAMMhzDUIAuHkIUwyOfXlcCz3wnAeqIEI86P0wHEKBBKAMMRXL76fFFwT2avGkNnV6CvJ6fd1YiqJ-rvUUa1uqTfWpXHmv7n3TF3fFCRsf1b7H9smv5Vt-DnMDrD2SCM52HuDAt3s4hpzpzh3N2cO8Ocu9MLZ3rpDi9jDr1yhtfu5nVMM3oc80kWZRm6NUOPZxglGrpNQ49q6HbNV-52DT2yYZRt6NYNPb5hlHDcLRz3CMfHCbc9fHsPAAD__4-gb1o=

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk1r4zAQhu_7K8JcV8Ee2c6HYKGHZSGXdml7283Baw_FkFpGkqHdkv9ebENah0aSrRxt5513_PiB6A1qWdJt_kwaxB9AYMCBQQIMUmCQwZ5Bo2RBWkvV_WQI7MoXEDGDqm5a093eMyikIhBvYCpzIBDwmP870D3lJakoBgYlmbw69DWNqp5z9Xrz8vofGDw0ea3FYhl1zb-qgyElFje4-NvGcVL8WKRCiN3t4wYY3LWmewT7IwPZmo9ybfInAoFH5r_gz0qbqi5MlI23s8znU-Z_BoDzCdAC_QEkswCgP4H0YsHH3LaWqiRF5Wjq_mhbgcfeK2RT3vFBKkMq4ng-_vvF-avRfJzwkT2-ccSXUXJlzx0rnhivZno-BUEIgwDTfRGgP4Ox6dyfAfdBkCyj9MoaOFY8MVjP1GACAgxhEKCBLwL0ZzDWIPFnkPggSJf9v881NXCseGKwmanBBAQYwiBAA18E6M9grEHqzyD1QZAtryyBY8ETge1MCSYAwPkEAhTwBYD-BC4ffb4ouCfdyFrT2RHo68lxdzSi8omGc5SWrSrot5JFXzNc3vW5_kZJ2gxPcbjY1cOjbsHPYbSG01EYz8PcGk7szUlIc2oNZ_bmzBrm3J5eWdNre3gd8tIba3hrb96GNKPDMZdkQZahXTN0eIZBoqHdNHSohnbXXOV219AhGwbZhnbd0OEbBgnH7cJxh3B8mnD747f3AAAA___-6W9V

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyklE2PqjAUhvf3V5izLoEW8IMVWzd64727CQuGnhgSpaQtiY7hv0-AhaPRSQ9d0vbJ--RtOTdolMRdeUYD2QdwYCCAQQwMEmCQQsGg1apCY5QejkzAVl4gixjUTdvZYblgUCmNkN3A1vaEkMH_8vOEBywl6jACBhJtWZ_GmFbX51Jf88v1Cxj8a8vGZIsgHJL3nc0WOWe5gKJnoDp7TzC2PCJkvGfzLFKihWA5f2sh3lrcw7tGaYka5UNw0b_w3KlAtSGPnk6-zo4fsrl7A9yhgVAEYTznJggeS7IH4S6Eu4dw8YiDMJnTB8FjRfYg9BG7e8QuHkkw_knkPggea7IHoY_E3SNx8UiDOW0QLDZEi5lz64XFAU2rGoNOUyka5hrKI05D0KhOV_hXq2qMmT73IzcuSDR22hXTx7YZt8aafsLcBxa_wpw_0NEzHftEJz5w6gMvfeCVD7z2gTder4T2xor-z3cAAAD__18c6HE=

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lk9vm0AQxe_9FNFcswhmAJtw8jWXpEp6qzhQs4osJSxasJQ08nev-CMldsPMsqVH_gzv_WbeLvsOtan0XfmiW8h_AoICAgUxKEhAQQqFgsaavW5bY_tXxoLb6hXySMGhbo5df7tQsDdWQ_4O3aF71pDDj_LXs37QZaVtGIGCSnfl4XmQaezhpbRvu9e336DgsSnrNr8Kwl75_tjlVztUO4LipMAcuw-FtiufNOR4Uu4uHo3ttA3TcwM7unbTolmtDwljK2119bdCcfrC0J0JTBPiRUcmK7M-4iXMnzuPuLz18ayNxKP1uPHsffqfek-4rPcbD2iiC0t4Pfv9rc_34zW-L_UR-T4mZ6_PyWdn8rggug7JDSkIY59tQ_Axtdk3uuTNTD7QrgvWDRq3qyxYcqd2go6DMPGZtOBjgvZlJl9mjH2gXSftBo3ZKpOO3amdoJNg-F8vnrTgY4L2ZSZfZkx8oF0n7QaNN6tMOnGndoJOA585Cy4mZF9i8iXGdDmy65TdkCla_aj1hdiDbhtTt9rp7x_15wddPenxvNGao93r79bsB5nx8n6oG25Uuu3Gpzhe3Nbjo97g52Jki-msGC-LiS3e8MoxW5zwxQlbnPK2U7Z4yytv2OKMV97-S3HGjyrlfd_wKYmEmPAhE3KCfMqQBHE-Z8K0kQ8aCklDPmoSOZ81FNYI8mmTyPm4YSaIC4ETxPnAkRA44gMnkJOwrQmBIz5w0q7IB46EwNGyva04ffsTAAD__ysR8gw=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysl09v4jwQxu_vp6jmWqMw44Q_OXF4L71sV-3eVhyyxKoi0QQ5QWq34ruvIEgpbpmxHY5Anzzjn3-20g-om9L8KF5NC_lvQFBAoECDghQUZLBWsLPNxrRtY49_0gceyjfIpwqqerfvjl-vFWwaayD_gK7qtgZy-FX82ZonU5TGJlNQUJquqLanmp2tXgv7vnp7_wsKnndF3eZ3k-TY_Ljv8rsVqhXB-qCg2XdDQ9sVLwZyPCj_KZ4b2xmbZJcDrOjer4tCuv6v2q6qN12CznpXOLRdrdIhVZ_hYhZOV18dI42gS-56ffFmUXjJ3U0fvLOrVUPDvm5saawpL56_PnDD6K97fW2EeQRaje7j768-f3HxfAwwyEOghCaJjjmgwhzndc5uckCFruGAfqEafEBD8M5i-PoeUT--5K447oj6AiZ3P8OPKPkDJh--epKkMf4Kc5z5zm_ir9A1-Euj_Q3Ai_MYvr7--vEld8Vx_voCJnc_w_3V_oC1D990cnqLCfZXmOPMd3ETf4WuwV892t8AvLiI4evrrx9fclcc568vYHL3M9zf1B9w6sM3m8TYK0xxpru8ib1C12BvOtreALi4DKfr664fXXLXG-euL15yd3Pc6_03VU-m3TV1a5zX_O-fPD2-_pvyxfT_K7TN3m7MT9tsTjX9x8dT7vRFadqu_xX7Dw91_9NxwM9hZMPEh4kNzy7C6IY1G0755pQNZ3w4GzP2jA3P-eY5G9YC7gWbXvLhJW_JVNCEl0xghrxlKKwbec9QC3HeNGl2XjUUXENeNpwJcV43aXbeN1wI5bxwKBiHvHLC7MQbR8K9RsLFJt1so6424o0j4XIjXjkSlKNR9xvxxpFwwxGvHAnKEa-cNDtvnBYuOc0rpwXlNK-cO_v68N-_AAAA__90nGMW

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0ljFvo0AQhfv7FdG0XoRnFmyHijZNckquO7ngzCqy5HjRgqXkIv_3kwEpsQkzy8ZX2mZ475v3WPMOe1ua--LF1JD9BgQFBAo0KEhAQQprBZWzG1PX1p0u6QbuylfI5gq2--rQnL5eK9hYZyB7h2bb7Axk8Kv4szOPpiiNi-egoDRNsd21MpXbvhTuLX99-wsKnqpiX2c3UXxSfjg02U2OKidYHxXYQ_OhUDfFs4EMj8rfxZN1jXFxem4gp5mfFo1qfUhYVxpnyqHC-viFoXsb2SrGi430VkZ96CnMnzePGLB6letRJ0nA9nExWI7K9cxbM_1GCq0QkwThtCQWAfxEF7ZwNnr_Zcj99TXuL-0S-T0mZ5ePya_O5HFCkT16HFMU65BDRPDRr3nY4pBDZAozBUH7P75-3Li85uNL_vxe-DqKk5DMBR89-xA9JPMJzKiDoP0z9-PG1TUz1_78XvhJ1P6jT85c8NGzD9FDMp_AjEkQtH_mftx4e83ME39-L_w0CklccNGTD8FDEp9AjGkAsn_eftQ0_1-vZV9oPpq6svvaeL0lzE_vGaZ8Nt17SW0PbmN-OrtpZbqPD-1c-0Vp6qb7FbsPd_vup5PBz8PIDtPZMF4OEzu84JU1O5zwwwk7nPK2U3Z4ySsv2OEVr7z8zvCKjyrlfd_yLZkLNeFLJvQE-ZYhCeJ8z4S0kS8aCk1DvmoSOd81FJ4R5NsmkfN1w5UgLhROEOcLR0LhiC-cQE7CsSYUjvjCSaciXzgSCkfTzrb18ce_AAAA___ZWPz5

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkTFLBDEQhXt_xTF1YJO9LpWFzTUqtrJFSIYjEDNLZiLCsf9dNinOE09Wr8zM--a9R06QKeCje0MG-woGJgVzIY_MVNZRFxzCB1itIOa5yjqeFHgqCPYEEiUhWEjkXdq9u1SRd3rQoCCguJiaflFAVc40izsiWLOofzqYwWxyGK86nA_XTCVgwfDt4g8ZHiJLzF6G8UIL9wauJdj_peML8kyZcVM3vSbEcMReh6kWj8-FfLPpz6fGtUFAlr4d--OQ26p9wlfY3AKPv8L7C1gv03L3GQAA___qN9W_

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v2jwUxu_fT4HO1TvNKLGT8CfSJKap0ipV7VS4m3KREq8gURI5QSqr-O4TUNYlIX5i0vpuDH72k3N-pycvtE4TeRs_yZzCn8SJkSBGHjHyiVFAEaNMpXOZ56na_-QIXCfPFLqMlutsU-z_O2I0T5Wk8IWKZbGSFNIsfljJexknUjkuMUpkES9Xh2sytXyK1XbyvP1NjKZZvM7DXt_Z33y3KcLeRFC0Y5Ruitfj30592PYWcb4onzfhFO0iRnkRP0oK-Y5dFjOwGlM0xnw7Z7NOVSKVTEonRXsS_eTMs36P88VUFneZwysdmW0zGfaub2dX99Orb7Pe15sbYrSSv4r_J_zTF7V8XBz-9ffReeXR3x7LM6n-NFWFVA4PqpX63Hi-36Js5yryeuiZELdpP80c4VZrfPb6oHQ9by8XbyGXI_qO9yFTYBB0YDmoaAxqYQ64pTkA9T_NweDSORDt-yva9NfrO_6HiGgQdGg5qGgMakFEYUlEUP-TiMNLRfTa99dr01-_f1jL7y-iQdCR5aCiMagFET1LIoL6n0QcXSqi376_fpv-Bv0P0dAg5thqTNEY04KEviUJQfVPEo7f4_X0zPn3Ms_SdS5bvXm6-5rJ5FEee5CnGzWXP1Q6P1xz_Hh34A6vG4nMi-O34vjhen38ah-wPTzsAnPeiQ460WM9zQ1qJszgYRe4UjNTOuhEj_W0qNLuv7RXgt0q7GlhX98tXwsLrr866DIfehjMhx5G8wFoMB-ABvMx6DIfehjMhx5G8wFoMB-ABvMx1Fo60ks66jIf4y6G62FguB5GhgMaGA5otAFM1mb9L6nJ3jSl4RIw2pzGONCc17ZISVUu9KJz_RoBpvPaHjFRHdDAdUAj2REObEc40r22Q41019NIdz0NdQc40h3gSPfaIi3rPgC613aKke61nWKku55GuutpqDvAke4AR7rX9qmR7noa6a6noe4AR7oDHOle26rld21Xr7uo7Rat7tHuvz8BAAD__yMtXoc=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF-P4jYUxd_7KZCfWjUo2Nf8i1SJql2pI61mqoG3iocscQcklkRJkJau5rtXwAJDTO6Jk8Ab_459cnzPTwnfxSaOzHP41WQi-EdI4QklPEHCE1p4oi_mnkjSeGGyLE73PzkKnqJvIuh5YrVJtvn-47knFnFqRPBd5Kt8bUQgZuGXtXk1YWRSvyc8EZk8XK0P2yTp6muY7ibfdv8JT0yTcJMFna6_3_llmwediRLzd0_E2_yyfJaHb0YE8t2rbuHPVZavNovc71_vP5GF9S-SL7vOMsyWN35_8aBcPHyMQbaXA9XKQbYbhC41cVlnu4nTyKQmulrpsEqpTdUDNi8W-veygJK6WBg0sODVcvlXmC2nJn9JfCokNdslJug8Pc8-vU4__THr_P75s_DE2vyb_zyRv_yWrt6Wh1fnCSu_rKHLhE3jNDepT1Zqv5auP6oQ261Efix6w8Rz3I0TX_eKGd_cfny1vXQocYUO-6rrkzPNgInzbA7uSDOXINpMgmolIduNQpeaaAgTWZNnLVpASZXxzM1CY57JB_EMTNiJZ1ZqVXmmqvdIVakRdX3tDBRg4jwcwzsCxSEI2WYSVCsJ2W4UutREwzarmkBp0QJKqgwobhYaA0U9CChgwk5AsVKrChSq3iOqUiPdPTwVuQEFmDgPx-iOQHEIQraZBNVKQrYbhS410bDNVBMoLVpASZUBxc1CY6DQg4ACJuwEFCu1qkDR1Xukq9So33XGCbBwHo3xHXHiEINsLweqlYNsNwhdaqJhk3VNmLRoASVVBhM3C41hoh8EEzBhJ5hYqdX5--bG-q8mS-JNZir9M9PbZ2aiN3M8gyzepgvzdxovDtsc374cdIcPIpPlx2_l8c3T5vjV3uBHsSyK5UexvhJLN7GkJmolG6nHTdQ05NWKTZz4xIndus_vzIslOC9erVQTNfUaqUe8WrOJD3hx30GsiuIBKx7yZz1kxeCaR6xYg2KPeSr0ABYsqDhxgVdDMPBySAYgR2jg5YgN0kLLdfAKBG-xxQUPQI34AOQIEECOCIHkoC7SIsx18Cg6HjEFuYUJyUNGDsCx85hBl85zRo7A5hZpnMrOq2HZeTksO5CjsvNyWHaesgpQVvGoARML1KjsQI7KDuSo7EgOJl7xlFVg6BR_B1eQW2VXPGqUBsfOowZdOk8aBUijLNK4lB2oUdmBHJUdyUHZgRze9fOUVYCyikcNKjugLDo3gElUdoBJVHYgRxPPU5bA1BD_gFyQW2UnHjUEbuiIRw24dOJJQ4A0ZJHGpexAjcoO5KjsSA7KDuSo7MRTlgBliUcNesoHlEXnBjCJnvMBJtGDPpCjiecpS-jY-afmgtwuO48aDW7oNI-a4qXP33_6PwAA___UW-5o

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl81u4koQhff3KVCt7lWMTLUbkli6EqNRFpEyySiwG7FwcA9BIthqGylMxLuPwGgIP-7jpo1nF34-V_WpOn3CB82TWD1Gbyqj8AcxeSTIo4A8kuRRl0YepToZqyxL9PorBXAfv1PY8Wg6Txf5-u2RR-NEKwo_KJ_mM0UhDaOXmXpWUay03yGPYpVH09mmTKqnb5Fe9t-Xv8ijQRrNs7DV9teVnxZ52OoLGq08Shb57vFZHk0UhbzyqrcwSHSutN_dr97nq4PH74iXZes1yl4PARqtdi0ImxY-q8D1yRCcIQPXrIMs7WH3nETHSqv4ZOFK3zpxnG9KT9RA5U-pLw4UHS5TFbbuH4d3z4O7r8PWl4cH8mimfub_9vnqv__1dPJa_PlHYy7VuOt2vhOdPybtJPXF_hzKyvf2yrPFmlXYMl-0_cDabqCJ7Z71Lmk3Gx3qFCI4QwiuWQlZ2kNzhuPGDCeqT1pUGXTQ9qX1xoMmtoO-vuTGW-jAdQoRnCEE16yELO2huY0XjW18UH3SQZVBy_bmXx-7jQdNbAd9c8mNt9CB6xQiOEMIrlkJWdpDcxsfNLbxsvqkZZVBd9vW-w5a2I759pL7bqEC1ydDcIYMXLMOsrSH5rZd_pWfECeaelZZmswzVenXQWd9LBVPVCFWliz0WH3XyXhTpnj5tOE2b8Qqy4tPuXhxPy8-Wjf4GeZDmD_Dcg9mO5g7TnTXhRZOtQWoLYyKB2bFAwvFhR18oLgt3XWhhVNtAWpLo-JgXF0jLHrmefWM9LUZvnaxlxlG9gI00MxMI3sBGtS-MSp-a1b81sVeZhjZC9Bgxc00shegQW02Zwi6io9u0_0EEiCCjq5Tqwwy0zCEAI6ObsZhDAEcVT-6VPeFl0D4o1vVxiuARmZBONpYM47sgnBU3RwpaGzmSGGQKewUKoCGfnGLFYBDv7gFC5uThUG0sFO2ABr6xS1dAA794pYvwilfhDlfBMgX4ZQvgEZ-QTg6ulu-IBxVN-eLAPkinPIF0MgvCEcb65YvCEfV7fJltPrndwAAAP__Uglmew==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzE2E9v4kYYBvB7PwWaU6s1MvPOmD-WKlG1e4i0Taokt4oDC9MEKYuRbaRNo3z3Cozq4LHfZ8bY7G03yeN5_djz08Cb2CZrc7v8ZjIR_y2kCASJQCgRCC0CEYlFIHZpsjJZlqSHPykCN-vvIh4FYrPd7fPDjxeBWCWpEfGbyDf5ixGxeFx-fTH3Zrk2aTgSgVibfLl5OS6zSzfflunr_PvrvyIQD7vlNosHw_Cw8t0-jwdzEov3QCT7vLx8li-fjIjle-A-wkOS5iYNo_PV5_JT4-XJ5_J_bLJ8s13loRxVVzjcSbo2qVnHg7msLFde4evr4HmZPVvpxXs5kvIZ6WPpMuqsdd2idbJKaa49alU7WQ-2w9rHjSOV10mKteruk5tb-b0u5UyTHmfy67Kcaeow035bN9XikER_UjPznyZ9Mg8mv9uFutLk4-vOxIOb28fP9w-ff38c_PbliwjEi_kn_3kuP_3ya7p5ei7--f9L33xns87bvk2GyS7UUbWGeulGZ-tLj43vsO9DGobK21swxGnnj9t6Cy5feiuv5q1P7eMOe9cteierFldxXYsn69H2Jq7sVDe_F6ZJ3G5n8uuySdz6mfoTV15NXHLfeuSy89Qw1N7igSFOO2_SVjxw-VI8upp4HrXLSYe96xa9k1WLq3iuxZP1aHsTjzrVxe-FaRKv25n8umwSr36m_sSjq4mn3Leectl5enj87OsnHhjitPOmbcUDly_FU1cTz6N2Oe2wd92id7JqcRXPtXiyHm1v4qlOdfF7YZrE63Ymvy6bxKufqT_x1NXE0-5bT7vsvGjo7R0Y4bTvZm29A5cvvdNX886jdDnrrHXdonWySnHVzrV2sh5sb9rpTmXxe12atOt2Jr8um7Srn6k_7fQP-Q6xZqh7k-2SbWacvh4cHW7LrJ9MUVOW7NOV-StNVsdliv_eHXPHH6xNlhe_lcV_brbFrw4DfgxLNkx8mKph-TE8PgtLv7C8KE3RJWmlL0lrxacV27jmG9dsOOLDETv3hB-bD8uL0gQeNp9W4GHzaQ0e9phtfMqHJx5hqoanbHjGrzzj37IxUAGYglDhVZGAFXmRKyCNYAFxJAuII1pAHNkieVwk0EXyvEjgi7wIGJBGwoA4IgbEkTEgjpCRvDISMCN5ZySARl4kjeSpoRE4Q_DUEKCGLGq8ziB8Gh5C-Dg8hfBxeAzh48gKsqg5L16B4nlqCFBDFjU-VoA0sgLEkRUgjqwAcWQFWdScF4_unaemEresIJ4aYAXx0tAMvDQ8NQpQoyxqfKwAaWQFiCMrQBxZAeLwMwt_oFPgQKd4ahSgRlnU-FgB0sgKEEdWgDiyAsSRFYo_0Ck0PE9NJW5ZoXhqgBWKl0ZNwUvDU6MANcqixssKPg2t4OPQCj4OreDjyArNH-g0ONBpnhoNqNH8Byiw2UEaWQHiyAoQR1aAOLJCgy-m0Oo8NZW4ZYXmqalasXj_6b8AAAD__0XRRLc=

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v2jwUxu_fTxGdq3eaUWIn4U-kSp2mTkOq6FS427hIiVeQKImcIJVV_e5TQlEXAn7ipOSuNPnZHJ_fw_ELbeJITsInmVLwkzgxEsTIJUYeMfJpzihR8UKmaazyV_bAOHqmwGG02iTbLP_3nNEiVpKCF8pW2VpSQLPwYS3vZRhJZTvEKJJZuFoX2yRq9RSq3fXz7g8xmibhJg2snp3v_G21zqQKrGtu_do6jruwRBAE48lsSIzutln-hOavjOJt9rb3-5YPO2sZpsvyZsX7c0ZpFj5KCvgra1aD37gGefXRRYizRbyvs93EKpJKRqWV5jmJXjlxEt_DdDmV2V1i86NmznaJDKzxZHZzP735OrO-3N4So7X8nf1_zT9dqdXjsvjrbOnvZbkmvZnGKpPK5v7xSX0-u75X49hOncjboie-xCTuxYktnOMzPrm9X9qe11eP11DPFj3b7T5ABlX0W1Rx6QjxbiPEO4oQ6M4hQv2mERL1uy_qdN_t2V73DhtUMWhRxaUdFt06LDpyGHTn4PCgqcNu_e67dbrv9YqrQscOG1QxbFHFpR12u3XY7chh0J2Dw8OmDnv1u-_V6b7f695ggxpGjWu4tL9et_56HfkLenPwd_QRV_ET69_LNIk3qax1y3byM5PRo9z3II23aiF_qHhRbLP_eFdwxf0okmm2fyr2H8ab_aP8C9aHB21gzlvRfit6pKe5wZkJM3jQBj46M1Pab0WP9LQ4pp1_abcEO8ewq4U9fbc8LSy4fmu_TT70MMiHHkb5ADTIB6BBPvpt8qGHQT70MMoHoEE-AA3yMdBaOtRLOmyTj1Ebw_UwMFwPI8MBDQwHNJoAJmOz-ktqMjdNaTgEjCanMQ4055UpUlKVC73oXD9GgOm8MkdMVAc0cB3QSHaEA9sRjnSvzFAj3fU00l1PQ90BjnQHONK9MkjLuveB7pWZYqR7ZaYY6a6nke56GuoOcKQ7wJHulXlqpLueRrrraag7wJHuAEe6V6Zq-a7t6HUXldmi1X3--t_fAAAA___lQaxm

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K9BctaqRPR98xNJKqdqtGmmVVAl3bS68eJpYYrFlG2lplP9eAQWCB79nxmO4SzBn5vjMex7ZvLFlnur75JuuWPwX4yxgggVMsoApFrARew5YUeZzXVV5ufnKTnCXfmdxFLBsWazqzcfPAZvnpWbxG6uzeqFZzGbJ14V-1EmqyzBiAUt1nWSL7TZFmX1LyvXt9_W_LGBPRbKs4sEw3Oz8e7aodRkPbvng71UUyflAxHF8dz-bsoA9rOrNFfb8HrB8VR_3rurkRbOYvwf2_n7LqjpbzutwdGrOWP8o-boevCbV65nvHz0IFw8fM-LdQ9KfXFKSnVLi_cakWk0c11kt8zLVpU5PVtqu0mpTRMDm0cLoUhZQUkcLYw8LQSeXfyTV65OuH4pQNpKarQsdD-7uZ58fnz7_Ohv88uULC9hC_1P_eMt_-lRmL6_bvywmbOIyYU95WesylEZqP7euP7WI7Vwi_y96xsR9PsyLUEXNjM9uf3OyPXeouEXDQzEMZb8gBA4Pgzu-IAhdUvKJyQeFtjnxfoNSrSY8OcQ7orBHCyipNhS6WfBGIb8SCsGE7VFopGaLQmHfMmFTMjkMVb8sAg4PkzO5IIscUuI-MfmwyDYn3m9QqtWEJwhERxb1aAEl1cYiNwveLBJXYhGYsD2LjNRsWSTtWyZtSqaG2ze1HlkEHB4mZ3pBFjmkxH1i8mGRbU6836BUqwlPEMiOLOrRAkqqjUVuFrxZJK_EIjBhexYZqdmySNm3TNmUbDTsl0TA32Fubi5IIoeMePeQfDhkmxLvNybVasITAqojh3q0gJJq45CbBW8OqStxCEzYnkNGal1-qjqz_qOuinxZaatfoaJNZjp90bszqPJVOdd_lvl8u83u34etbvtBqqt6d5Xv_rlb7i5tDH4U86aYfxSrEzF3E3PpoxbcS33jo5YTWi3IxCWduCS3HtE702IOzotWC-GjlpGXekqrFZn4mBaPHMSiKR6T4gl91hNSDO55SooVKPYNTYUIYMGAihMXaDUEAy2HZAByhAZajtjADbScBi9A8AZbXPAA1IgPQI4AAeSIEEgO6sINwpwGj6KjEdOQG5jgNGT4GBw7jRl06zRn-BRsbpDGqey0GpadlsOyAzkqOy2HZacpKwBlBY0aMLFAjcoO5KjsQI7KjuRg4gVNWQGGTtBPcA25UXZBo0YocOw0atCt06QRgDTCII1L2YEalR3IUdmRHJQdyOFTP01ZASgraNSgsgPKonMDmERlB5hEZQdyNPE0ZSWYGkm_IDfkRtkljRoJHugkjRpw65ImjQSkkQZpXMoO1KjsQI7KjuSg7ECOyi5pykpAWUmjBr3lA8qicwOYRO_5AJPoRR_I0cTTlJXo2Om35obcLDuNGgUe6BSNmuatP7__8F8AAAD__zB7PFY=

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1v2kAQhu_9FdacWnWRvWubD0uRqKpURYpIFbi1Pjh4G5AIttZGCo347xUQmtom-3px8C0EHg-z87zMPtMqieU4epQZBT-JEyNBjFxi5BEjn0JGqUpmMssStfvIARjFTxQ4jBardJ3v_h0ymiVKUvBM-SJfSgpoGt0v5Z2MYqlshxjFMo8Wy32ZVC0eI7UZPm3-EKNJGq2ywOrYu8rfFstcqsAacuvX2nHcmeUGQTAaT_vE6HadB9ZQULhllKzzl9qvJe831jzK5sViQ07hNmSU5dGDpIBv2Xk9-Gf3IK8s_r5NiDebeH3OepWoWCoZF54U7kj0kRMn8T3K5hOZ36Y2Lw1zukllYI3G0-u7yfXXqfXl5oYYLeXv_OOQf7pSi4f5_q9_rfNS669tuSazmSQql8rmfvmkPr_5fK_GsZ06kZeHnvgS46STpLZwymd8srxfKM_rq8drqGeLju22HyCDLroNurh0hHi7EeItRQhM5xih7rkREvWnL-pM3-3YXvsOG3TRa9DFpR0W7TosWnIYTOfocO9ch93603frTN_r7K8KLTts0EW_QReXdtht12G3JYfBdI4O98912Ks_fa_O9P1O-wYb9DA4u4dL--u166_Xkr9gNkd_B-9xFT_x_DuZpckqk7Vu2c7uzGT8IA8zyJK1mskfKpntyxxe3u65_f0olll-eFccXoxWh7d2X7A-3GsCc96I9hvRAz3NDc5MmMG9JnDpzExpvxE90NOiTDv_024Bdsqwq4U9_bQ8LSy4vrTfJB96GORDD6N8ABrkA9AgH90m-dDDIB96GOUD0CAfgAb56Gkt7esl7TfJx6CJ4XoYGK6HkeGABoYDGm0Ak7VZ_SU12ZumNFwCRpvTGAea88oWKajKhV50rl8jwHRe2SMmqgMauA5oJDvCge0IR7pXdqiR7noa6a6noe4AR7oDHOleWaRF3btA98pOMdK9slOMdNfTSHc9DXUHONId4Ej3yj410l1PI931NNQd4Eh3gCPdK1u1eNd29LqLym7R6h5uP_wNAAD__8vMrHA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFtr40Ycxd_7KcQ8tVRGmosvESy4tFsaWJKS-K3Ng9aaJgKvJSQZNg357sV2Y8ca639mNHLefDszR2f-54fkF7YuMn2TftM1S_5inIVMsJBJFjLFQjZmDyErq2Kp67qotj_ZC66z7yyJQ5avy02z_fghZMui0ix5YU3erDRL2CL9utJ3Os10FcUsZJlu0ny126as8m9p9Tz__vwvC9l9ma7rJBhF251_z1eNrpJgzoO_N3Esl4FMkuT6ZjFjIbvdNEkwF-zhNWTFpjnuXTfpo2YJfw3t_f2W102-XjbR-NTcnLfWP0q-PgdPaf105vdHD8LFw_uMeP-Q9KeA26cke6XEh41JdZo4rrNZF1WmK52drLRbpdOmiIHNo4XxpSygpI4WJh4Wwl4u_0jrp3vd3JaRbCW1eC51ElzfLD7f3X_-dRH88uULC9lK_9P8OOc_faryx6fdq8OEdV_W1GXC7ouq0VUkjdR-7lx_ZhHbuUT-X_SMiZtiVJSRitsZn93-6mR77lBxi4ZHYhTJYUEIHB4Gd3JBELqk5BOTDwptc-LDBqU6TXhyiPdE4YAWUFJdKHSz4I1C_kEoBBP2hkIjNVsUCvuWCZuSyVGkhmURcHiYnOkFWeSQEveJyYdFtjnxYYNSnSY8QSB6smhACyipLha5WfBmkfggFoEJe2ORkZoti6R9y6RNydRo96Q2IIuAw8PkzC7IIoeUuE9MPiyyzYkPG5TqNOEJAtmTRQNaQEl1scjNgjeL5AexCEzYG4uM1GxZpOxbpmxKNh4NSyLg7zA3VxckkUNGvH9IPhyyTYkPG5PqNOEJAdWTQwNaQEl1ccjNgjeH1AdxCEzYG4eM1Pr8VXVm_Ttdl8W61lb_QsXbzHT2qPdnUBebaqn_rIrlbpv929udbvdBputm_y3fv7le77_aGnwv5m0xfy9WJ2LuJubSRy24l_rKRy2ntFqQiUs6cUluPaZ3psUcnBetFsJHLWMv9YxWKzLxCS0eO4hFWzwhxVP6rKekGFzzjBQrUOwrmgoxwIIBFScu0GoIBloOyQDkCA20HLGBG2g5DV6A4A22uOABqBEfgBwBAsgRIZAc1IUbhDkNHkVHI6YlNzDBacjwCTh2GjPo0mnO8BnY3CCNU9lpNSw7LYdlB3JUdloOy05TVgDKCho1YGKBGpUdyFHZgRyVHcnBxAuasgIMnaDv4Fpyo-yCRo1Q4Nhp1KBLp0kjAGmEQRqXsgM1KjuQo7IjOSg7kMO7fpqyAlBW0KhBZQeURecGMInKDjCJyg7kaOJpykowNZJ-QG7JjbJLGjUS3NBJGjXg0iVNGglIIw3SuJQdqFHZgRyVHclB2YEclV3SlJWAspJGDXrKB5RF5wYwiZ7zASbRgz6Qo4mnKSvRsdNPzS25WXYaNQrc0CkaNe1Lf3j94b8AAAD__35sPGA=

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll-L2kwUxu_fTyHn6i1MiDNJ3DVQsJSFLixa1LuSi6yZquBmwkyEtYvfvSTpYv3TOZkeTS9j8pt5Zs4PfN4gV5kcpy_SQPwNODAQwCAABiEwiCBhUGi1kMYoXX3SAI_ZK8R9Buu82JbVzwmDhdIS4jco1-VGQgzz9HkjpzLNpPb7wCCTZbre1NsUev2S6t3odfcDGMyKNDdxz_OrnSfbMu6NOBsJSPYM1Lb8tcNh4eddb5Wa1fGS70jCwJTpUkLM9-zvwkaOYQUbcWpY8cewh6W2udKZ1DI7WiypSOyTCyf-kprVTJaTwucn05nvChn3Hsfzh-ns4fO89-npCRhs5Pfy_zr4h496vVy9P9hmdjhfQDjfhfBj5anC59HpTVzcOzzam7cXgbcQwReeH9zQW4e4A-e41zeXd2su79pc0X4cos04As8Pb2iPQ9w757jXt0d0a4_o2p6g_TiCNuMIvfrP6lb2OMS9d457fXuCbu0JurYnbD-OsM04Iu-G7jiEHTqGvb45YbfmhP-yb12INpWmULmRrdpUvzqczJayuSyjtnohv2q1qLdpHic1V7eBTJqyeSuah8e8eVUFbA8PKPCQAnNSbh7Zae5wZcINHlDgIQXmpNwnV3ZGi1O6_zsd2O87sML8-M76p3RIEdwOI4LbYURwO4wJjtCI4BFFcDuMCG6HEcHtMCY4QiOCDyiC31EUtcOIonYYUdQOY4oiNKLoPUVRO4woaocRRe0wpihCI4oOKYpyUk9AaERShEYsRWhMUwzHugKtLNDaAq0uEPsCrTBwUmPgZ5XByVY7jdlqpzFb7TRqK4JjtrqUpfOZubQlVxqz1akvOeOYrWflwWprsv_vZwAAAP__3WZveA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4kwYxe_fTyFz9S5E4jOT-Cew4LJb2EJpl9a7xYvUzFbBmpBEqFv63ReV1ZqY58wkpntp7S9zcvKckxlfxSqO9G34rDMR_BQkHCGFI5RwhCcc4YupI5I0nuksi9Ptv-yB6-hFBD1HLFbJOt_-eeqIWZxqEbyKfJEvtQjEJHxc6nsdRjp1e8IRkc7DxXK3TJIunsN0M37Z_BaOeEjCVRZ0uu525bt1HnTG5IylmL45Il7nxxWyPHzSIqA3x1zFt0WWL1az3PVPJZxb4kg9bjrzMJufR45KpI2S936QrSHSGVOlIaqWIdSGI16llOOl1qs4jXSqo5OL7a5SKVb2sNijCr8tFQaWHVX0G6hwagn9HmbzB53fJa4q-DXZJDroXN9Oru4frr5OOl9uboQjlvpX_v_uJj59ThdP878fzHI4uKzLt3E3TlzlF504u_bwZG2ySJ5B8FzZdVWdLgI6DnPUb72LbByxt8SijUwtoTY88SqlNOwBqt9GF1RhYFlVG9mpaNxG9NFtJM3nX5qMv-q6Xp1GADoOz3LQeiNYOEL2llg0gqkl1IYnXqWUhlmU9RvhgioMLKtqBDsVjRtBfnQjKPP5Vybj73V3RwrrRgA6Ds9y2HojWDhC9pZYNIKpJdSGJ16llIZZVPUb4YIqDCyragQ7FY0bQX10I3jm8--ZjL_frdMHQMXhSY5a7wMLP8jWEIs2MDWE2nDEq5TSMIde_Ta4oAoDy6rawE5F4zbw_uXvF2ek3essiVeZNvp1ore9OR096b1ZWbxOZ_pHGs92y-w_3u243R8ineX7b2n_4Xq1_2or8D1MRZjew94JTHYwyUb0qAkt-01opXhaso4r3nHFLu3zK_MwAd08LXuN6EETWoFJ81jHwcP2LWBZhPssDG56wA9Kn5-UIUuPeHjUJNg8jIINaBBsnkbB5mkUbAJdisqUrxWQbUCjcAMcpRvhYNIBjvJNfKUSwkvtwuGljBNfL-jW-X4hkHIqNYzVK5in4TsY4OglzOPwLczjMK18vdIQGF_qV6u08jRMK4_DtAIcjSyPw7SWWvbEeElg-8S3bAEvpVWWqsYmrZJvGgl2b5LfxwDjAI3SinCQVoCjtAIcbpr5kpU-ML7UsjZpBTRKK8BRWhGORpbHUVolv4WVQ4DzLVvAy2nld7Ho1vmmUT1w1io1jU1aAY3SinCQVoCjtAIcpVXxJaskML7UslanXJ6Gx1weh-dcgKODLo-jtCp-K6uQdXzLFvBSWhW_ly3e-vTtvz8BAAD__zpQDTI=

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1r4kAUhu_3V8hc7dJInJOoNbDgshS2UNqlerd4kZrZKlgTkgh1i_998QPUpDnvnIi5qx-vc_I4zzuxH2oZR-YxfDOZCv4orRxFylGecpSvHNVVE0claTw1WRan27fsA_fRuwo6jpovk1W-fXriqGmcGhV8qHyeL4wK1Dh8WZhnE0YmdTvKUZHJw_lit0ySzt_CdD18X_9Tjhol4TILWm13u_LTKg9aQ-0MSU02jopX-XGFLA9fjQr0xrGfYhSnuUnd7vkAQ7rh1jrGX9atWZjNCmmtJpvjPCSZ55SKroHFq8Ti1cCir8nFrxzo-DlxGpnUROUpJtuwxbs-ubZfYTYbmfwpcakAeLxOTNC6fxzfPY_ufo5bPx4elKMW5m_-dai_fU_nr7PdX0cGlbS7NWhTkba-qfz8Xm14ugLLY9yOE9c7R1K1fP9seS3Y0xZb2qW269VxHcxxwNxrzHUJl1pgbG23A6OvScavHKgx23VDttvRpiJta9vJfluRza7y2q5fRzcwx-E6-43pJuCia4Gx1c0OjL4mGb9yoMZ0o4Z0s6NNRdrWunn228qz2VV-e3e7KdYNzHG4ztvGdBNw0bXA2OpmB0Zfk4xfOVBjunkN6WZHm4q0rXXz7beVb7Oruu06soEpDlc5aEw2ARVdA4utanZY9DW5-JUDNaaa35BqdrSpSLvWz8ZPPv_ZZEm8zIzVL8LOlpmJXs3-m8jiVTo1v9N4ultm__Bpl9s9EZks37-q9w_ul_uXtgOehnUxrE_D_llYy8JaX5TuX5Im76L0gE8TS9zjiXsC4iQLF4hL0_1L0gXi0vSAT_ss8S5PvMuGe_x33eO_a6BXn03f8uHbS9zkw8hNkAZu8mnkJkgDNwd8G3ZAHZbKVGInSCM9URz4CeJIUBQHhupSpZ6DJwCe71QgqS61y_niPli8VC-iU5BPw2MQxNE5yMfhQQjiwDbNd6vuAfCldhXpxqehbiCOdOPjUDcQR7rxJ4sGR4sulaxIN75kCZQsSUq2fPMlKllxHOgG4kg3FEc3nnzJEihZKpWsRDeQRrqhONANxJFuKA50I_6AIXDAEH__CnQjvmQJlCxJSra8uKhkxXGkm6hkxXGkG1-yBEqWJDfw5S0nuoMXx5Fuont4cRzpxh8wHjhgPP5fIkXdJpsv_wMAAP__epmK2g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F1r40YUBuD7_gozVy0rY8-Zkb-g4NIuNLAkJcld8YXXniaGrGUkGTZd8t8Xf4BiTXzeMxrZd7GdV3N0zsyD7B9qnS3d7fybK9TkX6VVokglyqhEWZWoVM0StcmzhSuKLN_9yyFws_yuJv1Erdabbbl7e5aoRZY7NfmhylX54tREPc6_vrh7N1-6vNdXiVq6cr562S-zyVff5vnr9Pvr_ypRD5v5uph0ur3dynfbctKZ6mRKavaWqGxbVisU5fzJqYl-S-RVPGR56fJeelrAlD7J1qKQtf5aFeVqvSh7una_U12tVluqSn997TzPi2cvOXuryjEh5bwfgE7DJ2DOdsU2mADVeyIdQdpoBFSfeFsjGJwtp7rOdp3lS5e75cmV9lc5W7Dx98y5jgwvVYLfs3MljCJKSBpV-fe8eH5w5d2mZ2udenzduEnn5vbx8_3D5z8fO398-aIS9eL-K3-d6t9-z1dPz_u_zm6A6rbGDTa29br26TxdfUHfPmrJ8aofVHGbdbNNL-3Xm_zx-qd26gBABH70qNszTQwHdRwbPWjFcLBWZbi-iuEhIxg0mYFUcdkMqN6VZopLh0D1mV9Gcd0eof6ukSneYgl-z2SKh5UQrbi-kuKyjW29rokVJ_kRJskJNt2ebaIoqON4o8NWFAVrVYrSVRQNGIEeNpmBVFHZDKjelWaKSodA9ZlfRlFqjzB_18gUbbEEv2cyRcNKiFaUrqSobGNbr2tiRY38CBvJCbbd_Zf-YEVBHccbHbWiKFirUtRcRdGAEehRkxlIFZXNgOpdaaaodAhUn_llFDXtEebvGpmiLZbg90ymaFgJ0YqaKykq29jW65pYUSs_wlZygtNuE0NBFcfbHLdiKFirMtRexdCAAehx-ASkgsomQPWeNBNUOgKqT_wygtr2-PL3jEzQFkvweyYTNKyEaEHtlQSVbWzrda3Rb7IfLHDvik22Lpzo59b-rmlu-eQOQyiybb5w_-TZYr_M4eXdPrd_Y-mK8vCpPry4WR8-2hX4PqzZMPFhqof1-_DgJKzDwnoYk6aotIlKW5A2bMct33HLhlM-nLJ1g7L5sB7FpCkqbaLSFqQHbMdBeBgQpnp4xIbH_KzHPAp9vm7Nm5IiVHhVNGBFewfsNG5A3DthISyBNHIJxBFMII5kAnFEk-Z50cAX7Z200_gAxL2jFuITSCOgQBwJBeKIKBBHRmneGT0GcV6aWtxzSvPWUB88RIDnF0AVgScY9AjDW0PAGoqyBqThM1CcNSAOn4LirCHeGgLWEG8NAWsoyhqQRtaAOLIGxJE1II6sId4aAtYQbw0Ba4i3xgBrTJw1hrfGAGsMb40B1pgoa0AaWQPiyBoQR9aAOPzKxVtjgDWGt8YAa0yUNSCNrAFxZA2II2tAHFljeGsMsMbw1hhgjeGtscAaG2eN5a2xwBrLW2OBNTbKGpBG1oA4sgbEkTUgjqyxvDUWWGN5ayywxkZZA9LIGhBH1oA4sgbEkTWWt8YCayxvjQXWWN6aFFiTBloze_vlZwAAAP__klEy0w==

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4kwYxe_fTyFz9S6NxHkmag0suCyFLZR2qd4tXqRmtgrWhCRC3eJ3X4yCNbPOmSdivKt_Tmbyy_zOjP0QyyTWj9GbzkX4S0jhCRKeUMITgfBEV0w8kWbJVOd5km2_sgvcx-8i7HhivkxXxfbtiSemSaZF-CGKebHQIhTj6GWhn3UU68zvCE_Euojmi3KYNJu_Rdl6-L7-IzwxSqNlHrba_nbkp1URtobSG5KYbDyRrIrDCHkRvWoRyo3nPotRkhU687vHExjSjW2sQ_xl3ZpF-aySlmKyOcyHOPP5TEXWweIN1UkyqgYZaaLxhuoGjMkjFJyc1-E6SRbrTMfmc5psw-hb5ZTLIau3-SPKZyNdPKU-VXCP16kOW_eP47vn0d33cevbw4PwxEL_Lv4fyi9fs_nrrPzrgOIk-G4N8FQFL29OXr9XG6A8geUxaSepr46RnBq-fzS8ZKxwhwXuU9tXdcwH89hj7jVmPodLPTDu7ruxkSacC7svr-W-bMh9N_BUBe_sPrkvMnJZY6rtB3XkA_PY32e_MfkYXGQ9MO7yubGRJpwLy0fXko8aks8NPFXBO8un3BeZclljQbs8mLLlA_PY3-dtY_IxuMh6YNzlc2MjTTgXlk9dSz7VkHxu4KkK3lm-wH2RBS5rrNuuox6Yxf4uB42px6Ai62BxF8-NjDTRXFi84FriBQ2J5waequBr_dz8x_WfdZ4my1w7_ZLsbJnp-FXvnkaerLKp_pkl03KY3cunMle-Eeu82H0qdy_ul7uPthP8HJbVsPwcDo7CkheW8qx0_5w0qbPSA3uarMSVnbhiECdeuEKcm-6fk64Q56YH9nRgJd61E-9awz37s-7ZnzXQq29N39rDt-e4aQ8jN0EauGlPIzdBGrg5sLdhB9ShUaYcO0Ea6YniwE8QR4KiODBUGpV6DJ4AeHunAkml0S7HgwdgcKNeWLugPQ23QRBH-6A9DjdCEAe2SXu3yh4Ab7QrSzd7GuoG4kg3exzqBuJIN_vOIsHWIo2SZelmL1kCJUuckjUPX6ySZceBbiCOdENxdPC0lyyBkiWjZDm6gTTSDcWBbiCOdENxoBvZNxgCGwzZz69AN7KXLIGSJU7JmoOzSpYdR7qxSpYdR7rZS5ZAyRLnAG8uOdYJnh1HurHO8Ow40s2-wSiwwSj7v0Squk02__0NAAD__0WKmO8=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F1r40YXB_D751OYuXpKZOQ5M_IbFFzahQaWpCS5K77Q2tPEkLWMJMOmS7578Qso1sTnf6SRfbe29685Omfmh6Kfap0t3V363RVq-rfSKlKkImVUpKyKVKLmkdrk2cIVRZbv_sshcLv8oaaDSK3Wm225-3oeqUWWOzX9qcpV-erUVD2l317dg0uXLo8HKlJLV6ar1_0ym3z1Pc3fZj_e_lWRetyk62La68e7le-35bQ309GM1Pw9Utm2rFYoyvTZqal-j-RVPGZ56fI4OS1gRjeytajJWn-sinK1XpSxrt3vTFer1Zaq0t_eei9p8eIl5-9VOaZJOR8HoJMWE4hm5mxjbIshUL0tdBPNzI14zaTVMKg--66GMTxbTnWd7TrLly53y5Mr7a9ytmDj755zHRldqgS_Z-dKGAeUELWq8s-0eHl05f0mtrVOPb1t3LR3e_f05eHxy-9Pvd--flWRenX_lP-f6V9-zVfPL_t_nd0A1W1NWuxv63Xt5jxiA0HfPmvJ8aqfVHGX9bNNnAzqTf58_VNFdQNKBJLE1I9NG81BHcdGDzvRHKxVaa6vonmTEQxbzUDuuWwMVG9MkOfScVB9-pfxXHeHqb9_ZJ53WILfM5nnzUoI9lxfyXPZ_rZe18Sek_wwk-Qsm35s23gK6jje6KgTT8Falad0FU8bjECPWs1A7qlsDFRvTJCn0nFQffqX8ZS6w8zfPzJPOyzB75nM02YlBHtKV_JUtr-t1zWxp0Z-mI3kLNv-_pVAY09BHccbHXfiKVir8tRcxdMGI9DjVjOQeyobA9UbE-SpdBxUn_5lPDXdYebvH5mnHZbg90zmabMSgj01V_JUtr-t1zWxp1Z-mK3kLCf9NpqCKo63OelEU7BWpam9iqYNBqAnLSYgt1Q2BKq3JchS6TCoPvvLWGq7g8zfPTJLOyzB75nM0mYlBFtqr2SpbH9br2ut3t1-ssCDKzbZunCi17KDXdPc8tkdhlBk23zh_sqzxX6Zw8f7fW7_xdIV5eFXffhwuz78tCvwY1izYeLDVA_rj-HhSVg3C-tRSJqC0iYobUHasB23fMctG074cMLWDcrmw3ockqagtAlKW5Aesh0H4VGDMNXDYzY84Wc94VEY8HVr3pQEocKrogEr2jtgp3ED4t4Ja8ISSCOXQBzBBOJIJhBHNGmeFw180d5JO40PQdw7ak18AmkEFIgjoUAcEQXiyCjNO6MnIM5LU4t7TmneGhqAhwjw_AKoIvAEgx5heGsIWENB1oA0fAYKswbE4VNQmDXEW0PAGuKtIWANBVkD0sgaEEfWgDiyBsSRNcRbQ8Aa4q0hYA3x1hhgjQmzxvDWGGCN4a0xwBoTZA1II2tAHFkD4sgaEId_cvHWGGCN4a0xwBoTZA1II2tAHFkD4sgaEEfWGN4aA6wxvDUGWGN4ayywxoZZY3lrLLDG8tZYYI0NsgakkTUgjqwBcWQNiCNrLG-NBdZY3hoLrLFB1oA0sgbEkTUgjqwBcWSN5a2xwBrLW2OBNZa3JgHWJA2tmb__778AAAD__1XvPPY=

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl19r6kgYxu_3U8h7tcuOxHdmYtvAgstS2EJpl-rd4kVq5lTBmpBEqKf43Q_-4Vj_zZPJaM5d1fz6PnneefLoJ83SxDzF76ag6H9iEiRJkCJBmgSFNBSU5enIFEWary7ZAA_JB0UdQZNZNi9Xbw8FjdLcUPRJ5aScGopoEL9OzYuJE5MHHRKUmDKeTNdjsnzyHueL3sfiOwnqZ_GsiFrtYDX5eV5GrZ4UPUXDpaB0Xu4mFGX8Zijipaiuop_mpcmDcF9AT_75cxaLnjyYtcNfF61xXIwPaKbhcqdHuuj56gpf1BZVwxa-pi_6rKDd_0nzxOQmOVYxXMEVrjpxb__GxbhvyucskAcGDxaZiVoPT4P7l_79P4PW34-PJGhqvpW_9_iPv_LJ23j9186Ds26HFW5uPjsl_KTmp7SdZoEMD648Pbu7N5sdDlyF8xbIdqDqBBHo2J64bmNBdPHlwsaoGsbwNZ3RZwU1FkVuKIqy-tplla2rdqDrxAHo2G79prE4OPjCFzZG1TCGr-mMPiuosTjIhuKgqq9dVdm6bq-_SznHAejYbv22sTg4-MIXNkbVMIav6Yw-K6ixOKiG4qCrr11X2XrYrhMGoGK787vGwuDgCl_UFlXDFr6mL_qsoMaioH_Bb5YTil5MkaWzwlT6RdJZ3ZNJ3szGqSKd5yPzX56O1mM2L5_X3PqNxBTl5lPevHiYbT5aCfwK8yHMX2G9B7MbzB0vOvShpddsCWZLq-PK7rhycFy6wQeOu9KhDy29ZkswW1sdB-sKrbDs2vfVtdI3dvjGJ152GMUL0MAzO43iBWgw-9bq-J3d8TufeNlhFC9AgyNup1G8AA1ms71D0KP46Gm630ASVNDR49Spg-w0LCGAo1u347CGAI6mHz1U943XwPijp6pLVgCNwoJwdGLtOIoLwtF0e6WgtdkrhUGnsFepABrmxa9WAA7z4lcsbG8WBtXCXt0CaJgXv3YBOMyLX79Ir36R9n6RoF-kV78AGuUF4ejW_foF4Wi6vV8k6Bfp1S-ARnlBODqxfv2CcDTdrV-Gy99-BAAA__-6Roeo

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl19r6kgYxu_3U8h7tcuOxHdmYtvAgstS2EJpl-rd4kVq5lTBmpBEqKf43Q_-4Vj_zZPJaM5d1fz6PnneefLoJ83SxDzF76ag6H9iEiRJkCJBmgSFNBSU5enIFEWary7ZAA_JB0UdQZNZNi9Xbw8FjdLcUPRJ5aScGopoEL9OzYuJE5MHHRKUmDKeTNdjsnzyHueL3sfiOwnqZ_GsiFrtYDX5eV5GrZ4UPUXDpaB0Xu4mFGX8Zijipaiuop_mpcmDcF9AT_75cxaLnjyYtcNfF61xXIwPaKbhcqdHuuj56gpf1BZVwxa-pi_6rKDd_0nzxOQmOVYxXMEVrjpxb__GxbhvyucskAcGDxaZiVoPT4P7l_79P4PW34-PJGhqvpW_9_iPv_LJ23j9186Ds26HFW5uPjsl_KTmp7SdZoEMD648Pbu7N5sdDlyF8xbIdqDqBBHo2J64bmNBdPHlwsaoGsbwNZ3RZwU1FkVuKIqy-tplla2rdqDrxAHo2G79prE4OPjCFzZG1TCGr-mMPiuosTjIhuKgqq9dVdm6bq-_SznHAejYbv22sTg4-MIXNkbVMIav6Yw-K6ixOKiG4qCrr11X2XrYrhMGoGK787vGwuDgCl_UFlXDFr6mL_qsoMaioH_Bb5YTil5MkaWzwlT6RdJZ3ZNJ3szGqSKd5yPzX56O1mM2L5_X3PqNxBTl5lPevHiYbT5aCfwK8yHMX2G9B7MbzB0vOvShpddsCWZLq-PK7rhycFy6wQeOu9KhDy29ZkswW1sdB-sKrbDs2vfVtdI3dvjGJ152GMUL0MAzO43iBWgw-9bq-J3d8TufeNlhFC9AgyNup1G8AA1ms71D0KP46Gm630ASVNDR49Spg-w0LCGAo1u347CGAI6mHz1U943XwPijp6pLVgCNwoJwdGLtOIoLwtF0e6WgtdkrhUGnsFepABrmxa9WAA7z4lcsbG8WBtXCXt0CaJgXv3YBOMyLX79Ir36R9n6RoF-kV78AGuUF4ejW_foF4Wi6vV8k6Bfp1S-ARnlBODqxfv2CcDTdrV-Gy99-BAAA__-6Roeo

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllGL2kwUhu-_XyHn6itMiDNJ3DVQsJSFCosW9a7kImumKriZMBNh7eJ_L0m6WKOZk-lgcpk1T-adcx7Y9x1SkfBZ_MoVhD-AAgEGBDwg4AOBACICmRRrrpSQxSsVME3eIBwS2KXZIS_-HBFYC8khfId8l-85hLCKX_Z8weOES3cIBBKex7t9eUwmd6-xPE7ejr-AwDKLUxUOHLc4eX7Iw8GEkgmD6ERAHPI_J5w__HIcbGO1vfzkBxIRUHm84RDSE_m3sEEPYVlj2POnDqmQCZc8ufhYVJDYKzdu_C1W2yXP55lLa9tZHTMeDqaz1dNi-fR1Nfjy_AwE9vxn_n8Z_NNnudtsPx7OY6jN4Hw5z-JyN5LPhCMylwb1Mdw82784m7a3gLawwGWO691RWoO4o17issa4HWhLO9WWtd8Fa7MLz3H9O6pjEPehl7isMW4H6rBO1fHa78JrswvfKf9H3Usdg7iPvcRljXE7UMfrVB2__S78NrsInDuKYxB23ENY1hi2A2383jrWjVwLrjKRKt6qQQ2Lm_Fkw6tJKXGQa_5dinV5TPU4L7myASRc5dWvrHqYptVPRcD28MgGHtvA1Co3DfQ0NRgZM4NHNvDYBqZWuWsju6JZnR7-TXv6eXtamF7ObFinfRvB9TAiuB5GBNfDmOAIjQge2AiuhxHB9TAiuB7GBEdoRPCRjeAPNorqYURRPYwoqocxRREaUfTRRlE9jCiqhxFF9TCmKEIjio5tFKVWPQGhEUkRGrEUoTFNMRzrCnZlwa4t2NUFy75gVxioVWOgV5XByFY9jdmqpzFb9TRqK4JjtpqUpeudmbQlUxqz1agvGeOYrVflQWtrdPrvdwAAAP__prFsYg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmE9r40gUxO_7KUyfdkFGft2S_wgWsuwEJhCSIfFt8EGxemKDYwlJhnhCvvtgm7FjyXqlVkuZo-P81NWlV6WW38Q6jvRd-KIzEXwXJBwhhSOUcIQnHOGLmSOSNJ7rLIvT3b8cgJvoVQQDRyzXySbf_XnmiHmcahG8iXyZr7QIxDR8WukHHUY6dQfCEZHOw-Vqv0ySLl_CdHv1uv0pHPGYhOss6PXd3cr3mzzoXZFzJcXs3RHxJj-tkOXhsxYBvTv1VXxZZvlyPc9d_1zCpSVO1NO2twizxWXkpESaKPnoB7VqiGpkCHXhiFcp5XSpzTpOI53q6Oxi-6tUipUDLPakwu9KRQ3LTiqGFiqcRkK_htniUef3iasKfk23iQ56N3fT64fH6_-nvf9ub4UjVvpH_vd-E__8my6fF78_nMaucnOjdi2-i_tx4iq_aMPFtcdna5NB7GqkzpV9VzUpIqDjOETDzovIxJGWLVGNLKEuPPEqpViWADWvohZV1LCsqorMVFhXEX1qFcn6wy_rzL7qu16TOgA6jjdy1HkdGDhCLVuiGllCXXjiVUqxDKJsXgctqqhhWVUdmKmwrgP5qXWg6g-_qjP7Xn__JmFcB0DH8UaOO68DA0eoZUtUI0uoC0-8SimWQVTN66BFFTUsq6oDMxXWdaA-tQ68-sPv1Zl9v9-kDICK422cdF4GBn5Qq4aoRoZQF454lVIsQ-g1r4IWVdSwrKoKzFRYV4H3x36zuKDrQWdJvM50rV8kBrud6ehZH5zK4k0619_SeL5f5vDxfs_t_xDpLD98S4cPN-vDVzuBH2EqwvQR9s5gMoNJWtETG1oObWileFqyjiveccUu7fMr8zAB3TwtB1b0yIZWYNI81nFws30DWBbhIQuDTY_4QRnykzJm6QkPT2yCzcMo2IAGweZpFGyeRsEm0KWoTPlaAdkGNAo3wFG6EQ4mHeAo38RXKiG81C4cXso48fWCts73C4GUU6lhjB7BPA2fwQBHD2Eeh09hHodp5euVxsD4Ur8apZWnYVp5HKYV4GhkeRymtdSyZ8ZLAscnvmULeCmtslQ1JmmVfNNIcHqT_DkGGAdolFaEg7QCHKUV4PDQzJes9IHxpZY1SSugUVoBjtKKcDSyPI7SKvkjrBwDnG_ZAl5OK3-KRVvnm0YNwLtWqWlM0gpolFaEg7QCHKUV4Citii9ZJYHxpZY1esvlafiay-PwPRfg6EWXx1FaFX-UVcg6vmULeCmtij_LFrc-e__rVwAAAP__sgcKHA==

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1r20AQhu_9FWZOLV0j7Uryh6DgUgINhCQkORSKDoq1jQ2OJVYyxA3-78V2TCrLmVdr2brVtZ_d0czzZvRK8zTR1_Gzzin8TZIEKRLkkSCfBAUUCcpMOtZ5npr1T7bAZfJCoStoOs8Wxfq_I0Hj1GgKX6mYFjNNIT3EjzN9p-NEG8clQYku4ulsc01mps-xWY5eln9J0H0Wz_Ow03XWN98sirAzUhStBKWL4u3491Mfl51JnE_K540kRatIUF7ET5pCuRLHlRlYlikblak-LPP9nMU8NYk2OimdFK1J9JMDz_ozzif3urjJHLk3kYdlpsPOxa8fF7cPne9XVyRopv8Un0fyyzczfZps_vXhc78_k2fT-vvUFNo4Mthv09cPz_dr9OxQO94OPVDEddpNM0e5-w0-eH1Qul7WN0vWMMtRXcc7SwQsCu1ZF3rKEMh2QyDbCAFo_i4EvWNDoOoPV9UZrtd1_LNYaFFo37rQU1qo2rVQtWEhaP7Owv6xFnr1h-vVGa7f3Wzj01toUejAutBTWui1a6HXhoWg-TsLB8da6Ncfrl9nuEH3LA5alDm0LPOUBvrtGui3YSBo_c7A4SleSQ-cf6fzLJ3nutbbprtumE6e9HYAebowY31r0vHmmu3Hmw23ectIdF5sv1XbD5fz7VfrAuvD_SawlI3ooBE95Glp0TNlB_ebwHs9s6WDRvSQp9U-7f5PeyXY3Yc9Fvb5afksrCR_ddAkHzwM8sHDKB-ABvkANMhHr0k-eBjkg4dRPgAN8gFokI8-a-mAl3TQJB_DJobzMDCch5HhgAaGAxptAJu1Wf1LarM3bWm4BKw2pzUONJeVLVJSVSpedMmvEWC6rOwRG9UBDVwHNJId4cB2hCPdKzvUSneeRrrzNNQd4Eh3gCPdK4u0rHsP6F7ZKVa6V3aKle48jXTnaag7wJHuAEe6V_aple48jXTnaag7wJHuAEe6V7Zq-V3b5XVXld3C6h6tPv0LAAD__56IWfo=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mN9r4kocxd_vXyHzdC83EueHvwIXvOwWtlDa0vZhYfEhNbNVsCYkEeqW_u-LumrNmO-ZSaJv_jozJ2e-50PiO1vEkb4NX3XGgh-MM48J5jHJPKaYx7ps7LEkjSc6y-J0_ZOt4Dp6Y0HHY7NFsszXH489NolTzYJ3ls_yuWYBewqf5_pBh5FO_Q7zWKTzcDbfbJOks9cwXY3eVr-Yxx6TcJEFrba_3vlumQetkWDjD4_Fy_ywfJaHL5oF_MOzt_B1luWzxST3u8f7j3hh_YPkedWahtn0xO8PHoSLh88xcNccij4PHmSlHHizQahSE4d1los4jXSqo6OVNquU2hQdYPNgoXsuCyipg4VeDQteJZffwmz6qPO7xJeFpJ5WiQ5aV9-_XN0_tf6_uWEem-uf-d8j_s9_6exlunllMV59l_F6jNNcp740Ivu3dP2BRWan4viz6AkTt3E7TnzVKQZ8cvvh0fbcocEWBfZF25fOKAMm9oPZOyPKXIJwT8IWZrZJ8GajUKUmapKEV4RZgxZQUmUwc7NQG2b8EjAD47WDmRGZLcyEfYmETYdk21fONAEm9pPRPyNNHILg7knY0sQ2Cd5sFKrURM0qi4o0adACSqqMJm4WatNEXIImYLx2NDEis6WJtC-RtOmQam8ehtxoAkzsJ2NwRpo4BMHdk7CliW0SvNkoVKmJmlWWFWnSoAWUVBlN3CzUpom8BE3AeO1oYkRmSxNlXyJl06Fu25klwMJ-LoZnZIlDDNw1B1uS2ObAmw1ClZqoWWNVkSQNWkBJlZHEzUJtkqhLkASM144kRmRV_rI5sf6DzpJ4kWmrf2M668B09KK3B5DFy3Si79N4stlm-_Zuo9t8EOks337Lt2-uF9uv1gY_i3lRzD-L1ZGYu4m5rKMWvJZ6WEct-7RakIlLOnFJbt2ld6bFHJwXrRaijlp2aqkHtFqRifdocddBLIriHinu02fdJ8XgmgekWIFiD2kqdAAWDKg4cYFWQzDQckgGIEdooOWIDdxAy3HwAgRvsMUFD0CN-ADkCBBAjgiB5KAu3CDMcfAoOhoxBbmBCU5DhvfAsdOYQZdOc4YPwOYGaZzKTqth2Wk5LDuQo7LTclh2mrICUFbQqAETC9So7ECOyg7kqOxIDiZe0JQVYOgEfQdXkBtlFzRqhALHTqMGXTpNGgFIIwzSuJQdqFHZgRyVHclB2YEc3vXTlBWAsoJGDSo7oCw6N4BJVHaASVR2IEcTT1NWgqmR9ANyQW6UXdKokeCGTtKoAZcuadJIQBppkMal7ECNyg7kqOxIDsoO5KjskqasBJSVNGrQUz6gLDo3gEn0nA8wiR70gRxNPE1ZiY6dfmouyM2y06hR4IZO0agpXvr446_fAQAA__8-NOnb

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l01r20wUhffvrzB39ZbIyHc0chJBwaVkEUiTkGRRKF4o1tQxOJYYyRA3-L8XW6b-nqPxyNrFH4_unXPvmRN_0iRN1H38rnKKfhGTR4I8CsgjSR6F1Pco0-lA5XmqF18pgdvkg6KOR6NJNi0Wb_c9GqRaUfRJxagYK4roJX4dqycVJ0r7HfIoUUU8Gi_LZHr0HutZ72P2hzx6zuJJHrXa_qLyw7SIWj1B_blH6bRYPz4v4qGiiOde9RaeU10o7Yfb1Xt8sfP4NfE6a73F-dsuQP35ugVh08KmClyfDMEJMnDNOsijPayfk-pEaZUcLFzpWweO80PpoXpWxUPmix1FX2aZilo3P7_fPL60vt3dkUdj9bv4v8cXX77q0fCt_POfwHxU4LDC4aaTQ40f7Pk-baeZL8Kdbx6u3d2qzRYLVmG_fNH2A2ujgSZWG9Y9p9FsdKhTiOAEIbhmJeTRHpqzGjdjNVF9zKLKlIO2L63XHTSxmvLlOdfdQgeuU4jgBCG4ZiXk0R6aW3fRzLoH1cccVJmybC__3bFbd9DEaspX51x3Cx24TiGCE4TgmpWQR3tobt2DZtZdVh-zrDLlsG297KCF1Yyvz7nsFipwfTIEJ8jANesgj_bQ3KrL5n8zHOjoSeVZOslVpV8EncWZVDJUpVJ5OtUD9ajTwbJM-fJhyS3fSFRelJ9y-eJ2Un60aHAT5l2YN2G5BbMdzB0nOnShhVNtAWoLo-KBWfHAQnFhB-8obkuHLrRwqi1AbWlUHIwrNMKia55X10hfmuFLF3uZYWQvQAPNzDSyF6BB7Suj4tdmxa9d7GWGkb0ADVbcTCN7ARrUZnOGoKt47zbdTiABImjvOrXKIDMNQwjg6OhmHMYQwFH1vUt1W3gJhN-7VW28AmhkFoSjjTXjyC4IR9XNkYLGZo4UBpnCTqECaOgXt1gBOPSLW7CwOVkYRAs7ZQugoV_c0gXg0C9u-SKc8kWY80WAfBFO-QJo5BeEo6O75QvCUXVzvgiQL8IpXwCN_IJwtLFu-YJwVN0uX_rz__4GAAD__1I0YfY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Etv20YUBeB9f4UwqxahQM2doR4ECqhoswiQxkHsRYFCC0Wa2gIcUSApIG7g_17ogdLikPfM8LVLbB_O5SHnw0g_xD7Zmk_rbyYT8d9CikCQCIQSgdAiEJFYBeKQJhuTZUl6-pNL4MP2u4gngdjtD8f89ONVIDZJakT8Q-S7_NmIWDysvz6bL2a9NWk4EYHYmny9ez4vc0h339bpy_L7y78iEPeH9T6LR-PwtPLdMY9HSxKr10Akx7y4fJavH42I5WvgPsJ9kuYmDaPb1ZfyXe3lyefyf-yyfLff5KGclFc43Um6NanZxqOlLC1XXOHry-hpnT1Z6dVrMZLyGelt6TLqrHXdoHWySqmvPWpUO1kPtsPap7UjFddJLmtV3Sc3t_J7XYqZZj3O5NdlMdPcYabjvmqq1SmJ_qRi5j9N-mjuTX53CHWpyYeXg4lH7__6_f3nh9FvHz-KQDybf_Kfl_LdL7-mu8enyz__f-Prb2vR4rYqZv6UjJNDqKNyAdXGTW4Wlx5b3mHHhzQOlbe0YIjrnp82lRZcvpBWDiatT-3TDnvXDXonqxZXa12LJ-vR9mat7NQ1vxemztpuZ_Lrss7a6pn6s1YOYy257zty2XZqHGpv7sAQ1203a8oduHzBHQ3GnUftctZh77pB72TV4sqda_FkPdreuKNOafF7Yeq463Ymvy7ruKueqT_uaBjulPu-Uy7bTo_Pn3f9uANDXLfdvCl34PIFd2ow7jxql_MOe9cNeierFlfuXIsn69H2xp3qlBa_F6aOu25n8uuyjrvqmfrjTg3DnXbfd9pl20Vjb-zACNdNt2iKHbh8gZ0eDDuP0uWis9Z1g9bJKsWVOtfayXqwvVGnO2XF73Wpo67bmfy6rKOueqb-qNPDf2lYMdEXkx2SfWacvhKcnO7JbB_NpaMsOaYb8zlNNudlLv-9O-fOP9iaLL_8Vl7-82F_-dVpwLdhyYaJD1M5LN-Gpzdh6ReWrdIUtUkr3SatFZ9WbOOab1yz4YgPR-zcM35sPixbpQk8bD6twMPm0xo87Cnb-JwPzzzCVA7P2fCCX3nBv2VToAIwBaHCqyIBK7KVKyCNYAFxJAuII1pAHNkieVwk0EXyvEjgi2wFDEgjYUAcEQPiyBgQR8hIXhkJmJG8MxJAI1tJI3lqaALOEDw1BKghixqvMwifhocQPg5PIXwcHkP4OLKCLGpui1egeJ4aAtSQRY2PFSCNrABxZAWIIytAHFlBFjW3xaN756kpxS0riKcGWEG8NLQALw1PjQLUKIsaHytAGlkB4sgKEEdWgDj8zMIf6BQ40CmeGgWoURY1PlaANLICxJEVII6sAHFkheIPdAoNz1NTiltWKJ4aYIXipVFz8NLw1ChAjbKo8bKCT0Mr-Di0go9DK_g4skLzBzoNDnSap0YDajT_AQpsdpBGVoA4sgLEkRUgjqzQ4IsptDpPTSluWaF5aspWrF5_-i8AAP__CvRAMg==

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9r2zwUxu_fT2HO1TumYEu288dQ6BgdK5S2tLkYbLlwY60JpLGRHWhW-t2HnYbOcaLHihvdNbV_Uo7O78nRCy3TRF7HTzKn6CdxYiSIkU-MAmIU0oRRptKpzPNUla9sgMvkmSKP0XyZrYry3xNG01RJil6omBcLSRGN44eFvJNxIpXrEaNEFvF8UW2TqflTrNbnz-s_xOg-i5d55PTccudv80UhVeScc-fXyvP8qSOiKLq8Hg-J0c2qKJ_Q5JVRuire9n7f8mHtzOJ8Vt-sen_CKC_iR0kRf2XH1RAeXYM8--gixMEi3tdZLVOVSCWT2kqTkkSv7DmJ73E-u5fFTebynWaO15mMnIsfXy9ux86XqytitJC_i__P-aczNX-cVX8drPu9Jt-kMfepKqRyebh7TJ8Prh-0OLN9x_G26J4vcZ320swV3u4B790-rG3P23vHW3jnip7r20-PQRX9DlWcOj_cbn64jfyA1mzz0z82P6J960Wb1vs9N7AvsEEVgw5VnFpgYVdgYUNg0JqtwINjBfbbt95v0_qgV90QLAtsUMWwQxWnFti3K7BvQ2DQmq3Aw2MFDtq3PmjT-rBnX1-DGkZH13BqeQO78gY25AWN2co7-ojr957172SepctctrpZe-WByeRRbhqQpys1lbcqnVbbbD7eVFx1LUpkXmyeis2Hy-XmUfkF28ODLjDnneiwEz3S09zgzIQZPOgC75yZKR12okd6WuzS3r-0X4O9XdjXwoG-W4EWFly_ddglH3oY5EMPo3wAGuQD0CAf_S750MMgH3oY5QPQIB-ABvkYaC0d6iUddsnHqIvhehgYroeR4YAGhgMaTQCTsdn8JTWZm6Y0HAJGk9MYB5rzxhSpqcqFXnSuHyPAdN6YIyaqAxq4DmgkO8KB7QhHujdmqJHuehrprqeh7gBHugMc6d4YpHXd-0D3xkwx0r0xU4x019NIdz0NdQc40h3gSPfGPDXSXU8j3fU01B3gSHeAI90bU7V-1_b0uovGbNHqPnn9728AAAD___m9p94=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1r40YYhe_7K8xctVRGmg9_RLCQ0m5pYEmWTS4KbS601jQWeC0hybBuyH8vtms71ljvmdHIvkssn5mjM-95kPzKlnmq75NvumLxX4yzgAkWMMkCpljARuw5YEWZz3RV5eXmKzvBXfqdxVHAsmWxqjcfPwdslpeaxa-szuqFZjF7Sr4u9BedpLoMIxawVNdJtthuU5TZt6Rc335f_8sC9lgkyyoeDMPNzr9ni1qX8eCWD_5eRZGcDUQcx3f3T1MWsIdVvbnCnt8Clq_q495VnbxoFvO3wN7fb1lVZ8tZHY5OzRnrHyVf14N5Us3PfP_oQbh4eJ8R7x6S_uCSkuyUEu83JtVq4rjOapmXqS51erLSdpVWmyICNo8WRpeygJI6Whh7WAg6ufwjqeaPun4oQtlI6mld6Hjw8c9fP35-Gvzy6RML2EL_U_94y3_6UGYv8-1fFuM1cRmvx7ysdRlKI7KfW9efWmR2Lo7_Fz1j4j4f5kWoombAZ7e_OdmeO_Tbot6hGIayXwoCh4epHV-Qgi4p-cTkw0HbnHi_QalWE54Q4h052KMFlFQbB90seHOQX4ODYLz2HDQis-WgsK-YsGmYHIaqXxABh4exmVwQRA4pcZ-YfEBkmxPvNyjVasKTAqIjiHq0gJJqA5GbBW8QiWuACIzXHkRGZLYgkvYVkzYNU8PtC1qPIAIOD2MzvSCIHFLiPjH5gMg2J95vUKrVhCcFZEcQ9WgBJdUGIjcL3iCS1wARGK89iIzIbEGk7CumbBo2GvaLIeDvMDQ3F8SQQ0a8e0g-ELJNifcbk2o14UkA1RFCPVpASbVByM2CN4TUNSAExmsPISOyLj9PnVn_i66KfFlpq1-eok1gOn3RuwOo8lU505_LfLbdZvfvw1a3_SDVVb27ynf_3C13lzYG34t5U8zfi9WJmLuJufRRC-6lvvFRywmtFmTikk5ckluP6J1pMQfnRauF8FHLyEs9pdWKTHxMi0cOYtEUj0nxhD7rCSkG9zwlxQoU-4amQgSwYEDFiQu0GoKBlkMyADlCAy1HbOAGWk6DFyB4gy0ueABqxAcgR4AAckQIJAd14QZhToNH0dGIacgNTHAaMnwMjp3GDLp1mjN8CjY3SONUdloNy07LYdmBHJWdlsOy05QVgLKCRg2YWKBGZQdyVHYgR2VHcjDxgqasAEMn6Ce4htwou6BRIxQ4dho16NZp0ghAGmGQxqXsQI3KDuSo7EgOyg7k8KmfpqwAlBU0alDZAWXRuQFMorIDTKKyAzmaeJqyEkyNpF-QG3Kj7JJGjQQPdJJGDbh1SZNGAtJIgzQuZQdqVHYgR2VHclB2IEdllzRlJaCspFGD3vIBZdG5AUyi93yASfSiD-Ro4mnKSnTs9FtzQ26WnUaNAg90ikZN89af3374LwAA__9lNDfO

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElk1v2kAQhu_9FdacWnWRvWubD0uRqKpUjRQlUcKhUuuDg7cBiWBrbaTQiP9eAaGpbbKvFwdzC4HHw-w8L7PPNE9ieRU9yoyCn8SJkSBGLjHyiJFPIaNUJWOZZYlaf2QLXMRPFDiMpvN0ka__HTIaJ0pS8Ez5NJ9JCmgU3c_krYxiqWyHGMUyj6azTZlUTR8jtRw-Lf8Qo7s0mmeB1bHXlb9NZ7lUgTXk1q-F47jyzOJBEFxcjfrE6HqRB9ZQULhilCzyl-KvNe-X1iTKJsVqQ07hKmSU5dGDpICv2GFN-Ac3Mbbc9-1BvNnD63MW80TFUsm48KRwTaKP7DmI71E2uZP5dWrz0jBHy1QG1vmPr-c3I-vL5SUxmsnf-cch_3Smpg-TzV__-ualvl97ck3mcpeoXCqb--Vj-vzm870aZ7bvOF4euudLXCWdJLWFUz7gveX9QnleXzteQztbdGz3BOkxaKPboI0j54e3mx_eRn7AZHb56R6aH1F_8qLO5N2O7Z1AYIM2eg3aOLLAol2BRRsCg8nsBO4dKrBbf_Juncl7nc0FoW2BDdroN2jjyAK77QrstiEwmMxO4P6hAnv1J-_VmbzfOYG-Bk0MDm7iyPJ67crrtSEvmMtO3sF7XL_3PP9WZmkyz2Stm7WzPjAZP8jtALJkocbyRiXjTZnty-sNt7kWxTLLt--K7YuL-fat9ResD_eawJw3ov1G9EBPc4MzE2ZwrwlcOjNT2m9ED_S0KNPO_7RbgJ0y7GphTz8tTwsLri_tN8mHHgb50MMoH4AG-QA0yEe3ST70MMiHHkb5ADTIB6BBPnpaS_t6SftN8jFoYrgeBobrYWQ4oIHhgEYbwGRtVn9JTfamKQ2XgNHmNMaB5ryyRQqqcqEXnevXCDCdV_aIieqABq4DGsmOcGA7wpHulR1qpLueRrrraag7wJHuAEe6VxZpUfcu0L2yU4x0r-wUI931NNJdT0PdAY50BzjSvbJPjXTX00h3PQ11BzjSHeBI98pWLd61Hb3uorJbtLqHqw9_AwAA__-YNKfo

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFtr40Ycxd_7KcQ8tVRGmosvESy4tFsaWJJlk4dCmwetNU0EXktIMmwa8t2L7caONdb_zGhkv_l2Zo7O_M8PyS9sVWT6Jv2ma5b8xTgLmWAhkyxkioVszB5CVlbFQtd1UW1-shNcZ99ZEocsX5XrZvPxQ8gWRaVZ8sKavFlqlrD79OtSf9FppqsoZiHLdJPmy-02ZZV_S6vn-ffnf1nI7sp0VSfBKNrs_Hu-bHSVBHMe_L2OY6k_BDxJkuub-xkL2e26SYK5YA-vISvWzWHzukkfNUv4a2hv8Le8bvLVoonGx-7mvLX-QfL1OXhK66cTvz94EC4e3ofE-6e0CKR9SLJXSHzYlFSnicM661VRZbrS2dFK21U6bYoY2DxYGJ_LAkrqYGHiYSHs5fKPtH66081tGclWUvfPpU6Cj3_--vHzffDLp08sZEv9T_PjnP_0ocofn7av9uPVfU1Tl_G6K6pGV5E0Ivu5c_2ZRWan4vh_0RMmbopRUUYqbgd8cvuro-25Q70t2h2JUSQHpiCwuB_byRkp6BKTT04eHLSNiQ-bk-o04Qkh3pODA1pASXVx0M2CNwf5JTgIxuuNg0ZkthwU9g0TNgWTo0gNDCJgcT830zOCyCEm7pOTB4hsY-LD5qQ6TXhSQPQE0YAWUFJdIHKz4A0icQkQgfF6A5ERmS2IpH3DpE3B1Gj7fDYkiIDF_dzMzggih5i4T04eILKNiQ-bk-o04UkB2RNEA1pASXWByM2CN4jkJUAExusNREZktiBS9g1TNgUbjwbGEDC4n5qrM2LIISTePyUPCNmGxIdNSXWa8CSA6gmhAS2gpLog5GbBG0LqEhAC4_UGISOyPn9PnVj_i67LYlVrq3-e4k1gOnvUuwOoi3W10J-rYrHdZvf2dqvbfpDputl9y3dvrle7rzYG34t5W8zfi9WRmLuJufRRC-6lvvJRyymtFmTikk5ckluP6Z1pMQfnRauF8FHL2Es9o9WKTHxCi8cOYtEWT0jxlD7rKSkG1zwjxQoU-4qmQgywYEDFiQu0GoKBlkMyADlCAy1HbOAGWo6DFyB4gy0ueABqxAcgR4AAckQIJAd14QZhjoNH0dGIackNTHAaMnwCjp3GDLp0mjN8BjY3SONUdloNy07LYdmBHJWdlsOy05QVgLKCRg2YWKBGZQdyVHYgR2VHcjDxgqasAEMn6Du4ltwou6BRIxQ4dho16NJp0ghAGmGQxqXsQI3KDuSo7EgOyg7k8K6fpqwAlBU0alDZAWXRuQFMorIDTKKyAzmaeJqyEkyNpB-QW3Kj7JJGjQQ3dJJGDbh0SZNGAtJIgzQuZQdqVHYgR2VHclB2IEdllzRlJaCspFGDnvIBZdG5AUyi53yASfSgD-Ro4mnKSnTs9FNzS26WnUaNAjd0ikZN-9IfXn_4LwAA__9DIDfY

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllFr2zwUhu-_XxHO1TeQcSTbaWMYZIzCCqUpbS4GwxdurCWB1DKSA81K_vuwvZLFyXSsncS7dOxHeqXzQN43yFUm79MXaSD-BhwYCGAQAIMQGESQMCi0mktjlK4-aYDb7BXiIYNVXmzK6ueEwVxpCfEblKtyLSGGWfq8lo8yzaT2h8Agk2W6WtfbFHr1kurt5HX7Axg8FWlu4oHnVztPN2U8mHA2EZDsGKhN-WuH_cLP28EyNcvDJd-RhIEp04WEmO_Y34WNHMMKNuHUsOKPYfdLbXKlM6lldrBYUpHYJydO_CU1yydZTguft6Yz2xYyHtx8_XzzMBt8ursDBmv5vfy_Tv3ho14tlu8PtoHtDxcQDnci-b3yVOHzqH0NJ_cOD_bm3S3gHSzwhecHF5TWIe7IOe75teX9ast71VZ0n4XoMovA88MLquMQ98o57vnVEf2qI3pVJ-g-i6DLLEKv_o-6lDoOca-d455fnaBfdYJe1Qm7zyLsMovIu6A4DmHHjmHPr03YrzbhP-tYJ3I9SlOo3MhODWpYnUxmC9nclFEbPZcPWs3rbZrHac3VDSCTpmzeiubhNm9eVQG7wyMKPKbAnJSbR3aaO1yZcINHFHhMgTkpd-vKjmjRpoe_04H9vgMrzA_vbNimQ4rgdhgR3A4jgtthTHCERgSPKILbYURwO4wIbocxwREaEXxEEfyKoqgdRhS1w4iidhhTFKERRa8pitphRFE7jChqhzFFERpRdExRlJN6AkIjkiI0YilCY5piONYVaGWB1hZodYHYF2iFgZMaAz-qDE622mnMVjuN2WqnUVsRHLPVpSwdz8ylLbnSmK1OfckZx2w9Kg9WW5Pdfz8DAAD__7IPavA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4kwYxe_fTyFz9S5E4jOT-Cew4LJb2EJpS9uLhcWL1MxWwZqQRKhb-t0XldWamOfMJKZ7ae0vc3LynJMZX8UyjvR1-KwzEfwUJBwhhSOUcIQnHOGLiSOSNJ7qLIvTzb_sgMvoRQQ9R8yXySrf_HniiGmcahG8inyeL7QIxEP4uNB3Oox06vaEIyKdh_PFdpkknT-H6Xr8sv4tHHGfhMss6HTdzco3qzzojMkZSzF5c0S8yg8rZHn4pEVAb465im_zLJ8vp7nrH0s4tcSBelx3ZmE2O40clEgbJe_9IFtDpDOmSkNULUOoDUe8SimHS62WcRrpVEdHF9tepVKs7GGxBxV-WyoMLDuo6DdQ4dQS-j3MZvc6v0lcVfDrYZ3ooHPx4-vF7UPny9WVcMRC_8r_397Bp8_p_Gn294NZCAfntfg67saJq_yiDSfXHh6tTRaxM0idK7uuqlNEQMd-iPqtF5GNI_aWWFSRqSXUhidepZSGJUD1q-iMKgwsq6oiOxWNq4g-tIqk-fBLk9lXXderUwdAx_5BDlqvAwtHyN4SizowtYTa8MSrlNIwiLJ-HZxRhYFlVXVgp6JxHcgPrQNlPvzKZPa97vYkYV0HQMf-QQ5brwMLR8jeEos6MLWE2vDEq5TSMIiqfh2cUYWBZVV1YKeicR2oD60Dz3z4PZPZ97t1ygCo2D_GUetlYOEH2RpiUQWmhlAbjniVUhqG0KtfBWdUYWBZVRXYqWhcBd4_-83ihK47nSXxMtNGv0j0Nnemoye9cyqLV-lU36bxdLvM7uPNltv-IdJZvvuWdh8ul7uvNgLfw1SE6T3sHcFkB5NsRI-a0LLfhFaKpyXruOIdV-zSPr8yDxPQzdOy14geNKEVmDSPdRw8bN8ClkW4z8Lgpgf8oPT5SRmy9IiHR02CzcMo2IAGweZpFGyeRsEm0KWoTPlaAdkGNAo3wFG6EQ4mHeAo38RXKiG81C4cXso48fWCbp3vFwIpp1LDWL2CeRq-gwGOXsI8Dt_CPA7TytcrDYHxpX61SitPw7TyOEwrwNHI8jhMa6llj4yXBLZPfMsW8FJaZalqbNIq-aaRYPcm-X0MMA7QKK0IB2kFOEorwOGmmS9Z6QPjSy1rk1ZAo7QCHKUV4WhkeRylVfJbWDkEON-yBbycVn4Xi26dbxrVA2etUtPYpBXQKK0IB2kFOEorwFFaFV-ySgLjSy1rdcrlaXjM5XF4zgU4OujyOEqr4reyClnHt2wBL6VV8XvZ4q1P3v77EwAA__8vwwiq

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1r8lgUhe_nV8i5muGNxL0TtQYGHIYXplDa0vZiYPAiNWeqYE1IItQp_vfBD7AmzV5nK-aufizPzuN51on9NMs0sffxuy1M9I8h4xk2ngmMZ0Ljmb6ZeCbL06ktijTfvmUfuE0-TNTzzHyZrcrt0xPPTNPcmujTlPNyYU1kXuLXhX2ycWJzv2c8k9gyni92y2T5_D3O1-OP9X_GM89ZvCyiTtffrvywKqPOmLwxm8nGM-mqPK5QlPGbNRFtPPcpntO8tLnfPx1gzD-ktY7x13VnFhezSprMZHOchzXzfKVCWizsjYNGLMEZWOiaXMLGgY6fk-aJzW1Sn2KyDTu865tr-ysuZs-2fMh8rgB-WWc26vz8-8-fjy-dP-7ujGcW9t_y1zH99ns-f5vt_joCaETdPwM1V1HTj8bPH5xNjhqY3KfdNPODUx5Nyw9PlifFhnbYzz53_eAc0cEcB8yD1kTXcNGDUajuBoauSSZsHKg11akN1d1QcxW1s-rsvqfYZUsFXT88xzUwx-E6h625puBCejAK19zA0DXJhI0DteYat-GaG2quonZ2LXDfU4HLlgq7u7tMtWtgjsN13rTmmoIL6cEoXHMDQ9ckEzYO1JprQRuuuaHmKmpn10L3PRW6bKl-9xzTwBSHqxy1ZpqCCmmxKDxzw0LX5BI2DtSaZ2Ebnrmh5irqs34qfvP5T7bI0mVhnX4F9rbAbPJm919Dka7yqX3M0-lumf3Dh11u90Rii3L_Ku0f3C73L20H_Bqmapi-hsOTMOnCRBelh5ekObgoPZLTLBIPZOKBgjjrwhXi2vTwknSFuDY9ktOhSLwvE--L4YH8XQ_k7xroNRTTN3L45hI35TByE6SBm3IauQnSwM2R3IY9UIe1MtXYCdJITxQHfoI4EhTFgaFUq9RT8AzAy50KJKVau5wuHoLFa_WiOgXlNDwGQRydg3IcHoQgDmwjuVtpAMDX2lWlm5yGuoE40k2OQ91AHOkmnywEjhaqlaxKN7lkGZQsa0q2fvOlKll1HOgG4kg3FEc3nnLJMihZrpWsRjeQRrqhONANxJFuKA50Y_mAYXDAsHz_CnRjuWQZlCxrSra-uKpk1XGkm6pk1XGkm1yyDEqWNTfw9S2nuoNXx5Fuqnt4dRzpJh8wAThgAvlfIlXdJptf_g8AAP__S8iGVw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F1r40YUBuD7_oowVy0rY8-ZI39BwaVd6MKyWTa5KBRfaO1pYshaRpJh0yX_ffEHKNbE553RyL6L7byao3NmHmT_UOt8aT9l32yppv8qrRJFKlFGJYpVolI1T9SmyBe2LPNi9y-HwIfldzUdJGq13myr3dvzRC3ywqrpD1Wtqierpuo--_pkv9hsaYv-QCVqaats9bRfZlOsvmXF8-z78_8qUXebbF1Ob3r93cq322p6M9PJjNT8JVH5tqpXKKvswaqpfkn8q7jLi8oW_fS0gBm981uLQtb6a1VWq_Wi6uvG_c50vVpjqTr99fnmMSsfneT8pS7HhJTzegA6DZwAJTNztivcYgLU7InvCNJWI6DmxLsawfBsOfV1tuu8WNrCLk-utL_K2YKNu2fOdWR0qRLcnp0rYRxRQtKqyr-z8vHOVrebPjc6df-8sdOb9__8-f7z_c0fHz-qRD3Z_6pfZ_q334vVw-P-r7PTr-9p0mJXs9Oyd-fdGng07a1-HK_6RhWf8l6-6aeDZoffXv8UTh2ghwcefer1TRvAQR3HRg87ARysVQOurwJ4yAiGwTMIINxvBtTsSjvCfYdAzZlfhnDdnZ_urvEjvMMS3J75ER5WQjTh-hqE--1qdlrmTTj5n1_yOb6m1-c2hII6jjc66oRQsFZNKF2F0IAR6FHwDAII9ZsBNbvSjlDfIVBz5pchlLrzy901foR2WILbMz9Cw0qIJpSuQajfrmanZd6EGv_za3yOL_f23_WDCQV1HG903AmhYK2aUHMVQgNGoMfBMwgg1G8G1OxKO0J9h0DNmV-GUNOdX-6u8SO0wxLcnvkRGlZCNKHmGoT67Wp2WuZNKPufX_Y5vmmvDaCgiuNtTjoBFKxVA8pXATRgAHoSOIEAPv0mQM2etOPTdwTUnPhl-OTu7HL3jB-fHZbg9syPz7ASovnka_Dpt6vZaVmr32HfWOCLLTf5urReP7EOdh2zywd7mECZb4uF_Vzki_0yh5e3-9z-jaUtq8On-vDiw_rw0a7A12EthkkOUzOsX4eHJ2EdFtajmDRFpU1UmkHaiB1nueMshlM5nIp1g7LlsB7HpCkqbaLSDNJDseMgPAoIUzM8FsMTedYTGYWBXLeWTUkRKrIqGrCinQN2Gjcg7pywEJZAGrkE4ggmEEcygTiiScu8aOCLdk7aaXwI4s5RC_EJpBFQII6EAnFEFIgjo7TsjJ6AuCxNI-44pWVraAAeIsDzC6CKwBMMeoSRrSFgDUVZA9LwGSjOGhCHT0Fx1pBsDQFrSLaGgDUUZQ1II2tAHFkD4sgaEEfWkGwNAWtItoaANSRbY4A1Js4aI1tjgDVGtsYAa0yUNSCNrAFxZA2II2tAHH7lkq0xwBojW2OANSbKGpBG1oA4sgbEkTUgjqwxsjUGWGNkawywxsjWMLCG46xh2RoG1rBsDQNrOMoakEbWgDiyBsSRNSCOrGHZGgbWsGwNA2s4yhqQRtaAOLIGxJE1II6sYdkaBtawbA0Da1i2JgXWpIHWzF9--RkAAP__fc8uUA==

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF-L4kgUxd_3U0g97dKReG9FbQMLLsvADgzTw3Q_LCw-ZExtKzgmJBHGbfzui1GwTY116kaMb-2fk6r8Ur9TZb-pdZaaz8l3U6r4H0UqUKwCpVWgIhWooZoFKi-yuSnLrNh_5RD4mP5Q8SBQy3W-qfZvzwI1zwqj4jdVLauVUbF6Sb6tzFeTpKYIBypQqamS5aoeJi-W35NiO_2x_U8F6jlP1mXc64f7kZ82VdybUjBlNdsFKttUpxHKKnk1KqZd4D-L56yoTBEOzycw5QfXWKf4t21vkZSLRprUbHeaD0vm854KtcESTPVFMroFGbLRBFP9AMaUEYouzut0naxITWFS-znN9mH0rXrK9ZDN2_wrKRfPpnrKQ27gftnmJu59-PvPD19een98-qQCtTL_Vr9O6bffi-Xrov7rxOEi9WEL6tykTg8Xrz9qTY8uMPmc9bM81Oc8Lg0_PhueBMvbY3WH3A91G-3BPI6YR51pL-HSDoy_-H5syIZzY_HpXuJTF-L7UecmdW_x2X-Fsc8C0_0wamMemMfxPsedmSfgQu3A-Jvnx4ZsODc2j-9lHndhnh91blL3Nk_7rzDts8Cifn0eFZsH5nG8z8fOzBNwoXZg_M3zY0M2nBubp-9lnu7CPD_q3KTubV7kv8IinwU27LfxDszieJeTzrwTUKE2WPyt8yNDNpobWxfdy7qoC-v8qHOTequfmD-5_ldT5tm6NF6_Hgd7YCZ9NYdHUWabYm6-FNm8Hubw8qnO1W-kpqwOn9Lhxcf14aP9BN-HqRmm9-HoLEyyMNFV6fE1adZXpSfuNDuJazdxLSDOsnCDuDQ9vibdIC5NT9zpyEl86CY-dIZH7mc9cj9roNfYmX50hx-vcdMdRm6CNHDTnUZugjRwc-JuwwGoQ6tMJXaCNNITxYGfII4ERXFgKFmVeg6eAXh3pwJJyWqX88EjMLhVL6Jd0J2G2yCIo33QHYcbIYgD28jdrTQC4K12FenmTkPdQBzp5o5D3UAc6ebeWQhsLWSVrEg3d8kyKFmWlKx9-BKVrDgOdANxpBuKo4Onu2QZlCxbJSvRDaSRbigOdANxpBuKA93YvcEw2GDYfX4FurG7ZBmULEtK1h5cVLLiONJNVLLiONLNXbIMSpYlB3h7yYlO8OI40k10hhfHkW7uDUaDDUa7_yXS1G22--X_AAAA__-UMpRn

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F1r40YUBuD7_gozVy2RkefMyF9QcGkXurBslk0uCsUXWnuaGLKWkWTYNOS_L_4AxZr4vEca2Xdre1_N0TkzD4pe1Dpbus_pd1eo6b9Kq0iRipRRkbIqUomaR2qTZwtXFFm--y-HwMflDzUdRGq13mzL3dfzSC2y3KnpiypX5ZNTU3WffntyX126dHk8UJFaujJdPe2X2eSr72n-PPvx_L-K1N0mXRfTXj_erXy7Lae9mY5mpOavkcq2ZbVCUaYPTk31aySv4i7LS5fHyWkBM7qRrUVN1vprVZSr9aKMde1-Z7parbZUlf723HtMi0cvOX-tyjFNynk7AJ20mEA0M2cbY1sMgeptoZtoZm7EayathkH12Xc1jOHZcqrrbNdZvnS5W55caX-VswUbf_ec68joUiX4PTtXwjighKhVlX-nxeOdK283sa116v5546a9D__8-eHLfe-PT59UpJ7cf-WvM_3b7_nq4XH_r7PTr-5p0mJzW69lN-cFGwia9l4_jld9p4rPWT_bxMmg3uH31z8lVDdwRMBITP3YtKEc1HFs9LATysFaFeX6KpQ3GcGw1QzkmMvGQPXGBGEuHQfVp38ZzHV3kvr7R4Z5hyX4PZNh3qyEYMz1NTCXbW7rtUyMOclPMkkOsunHtg2moI7jjY46wRSsVWFKV8G0wQj0qNUM5JjKxkD1xgRhKh0H1ad_GUypO8n8_SPDtMMS_J7JMG1WQjCmdA1MZZvbei0TY2rkJ9lIDrLt798ENMYU1HG80XEnmIK1KkzNVTBtMAI9bjUDOaayMVC9MUGYSsdB9elfBlPTnWT-_pFh2mEJfs9kmDYrIRhTcw1MZZvbei0TY2rlJ9lKDnLSb0MpqOJ4m5NOKAVrVZTaq1DaYAB60mICckhlQ6B6W4IglQ6D6rO_DKS2O8X83SODtMMS_J7JIG1WQjCk9hqQyja39VrW6n3tOwt8dcUmWxdO9Cp2sOuYWz64wwSKbJsv3Jc8W-yXOXy83ef2XyxdUR5-1YcPH9eHn3YFvg1rNkx8mOph_TY8PAnrZmE9CklTUNoEpS1IG7bjlu-4ZcMJH07YukHZfFiPQ9IUlDZBaQvSQ7bjIDxqEKZ6eMyGJ_ysJzwKA75uzZuSIFR4VTRgRXsH7DRuQNw7YU1YAmnkEogjmEAcyQTiiCbN86KBL9o7aafxIYh7R62JTyCNgAJxJBSII6JAHBmleWf0BMR5aWpxzynNW0MD8BABnl8AVQSeYNAjDG8NAWsoyBqQhs9AYdaAOHwKCrOGeGsIWEO8NQSsoSBrQBpZA-LIGhBH1oA4soZ4awhYQ7w1BKwh3hoDrDFh1hjeGgOsMbw1BlhjgqwBaWQNiCNrQBxZA-LwTy7eGgOsMbw1BlhjgqwBaWQNiCNrQBxZA-LIGsNbY4A1hrfGAGsMb40F1tgwayxvjQXWWN4aC6yxQdaANLIGxJE1II6sAXFkjeWtscAay1tjgTU2yBqQRtaAOLIGxJE1II6ssbw1FlhjeWsssMby1iTAmqShNfPXX34GAAD__9RrOG4=

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l19r4kwYxe_fTyHP1fvyjsRnZmLbwILLUthCaUvbi4XFi9TMVsGakESoW_zui39Y6785mYzmrmp-fU7OMydHP2iSJuYufjMFRT-JSZAkQYoEaRIUUl9QlqcDUxRpvrhkBdwk7xR1BI0m2bRcvN0XNEhzQ9EHlaNybCii5_hlbB5NnJg86JCgxJTxaLwck-Wjtzif9d5nv0nQUxZPiqjVDhaT76dl1OpJ0VPUnwtKp-VmQlHGr4YinovqKp7SvDR5EG4L6Mn__85i0ZM7szb4y6w1jIvhDs3Un2_0SBc9n13hk9qiatjC5_RFHxW0-T9pnpjcJPsq-gu4wlUH7u17XAyfTHmfBXLH4OdZZqLW9Y9v1w_Pra-3tyRobH6V__b4vy_56HW4_GtjwFGrwwp3Np0cUn1Q8F3aTrNAhjtXHp7d3ZrNDqetwmELZDtQdVIIdKyPW7exFLr4cmJjVA1j-JzO6KOCGsshN5FDWX3nssrKVTvQdbIAdKxXftFYFhx84RMbo2oYw-d0Rh8V1FgWZBNZUNV3rqqsXLeXX6GcswB0rFd-2VgWHHzhExujahjD53RGHxXUWBZUE1nQ1Xeuq6w8bNdJAlCxXvhVY0lwcIVPaouqYQuf0xd9VFBjOdBN_045IOfRFFk6KUylXyGdxQ2Z5NWsbCrSaT4wD3k6WI5Zvbxfcss3ElOUq0959eJmsvpoIfAzzLswf4b1FsxuMHe86NCHll6zJZgtrY4ru-PKwXHpBu847kqHPrT0mi3BbG11HKwrtMKya99X10pf2OELn3jZYRQvQAPP7DSKF6DB7Eur41d2x6984mWHUbwADY64nUbxAjSYzfYOQY_ivafpdgNJUEF7j1OnDrLTsIQAjm7djsMaAjiavvdQ3TZeA-P3nqouWQE0CgvC0Ym14yguCEfT7ZWC1mavFAadwl6lAmiYF79aATjMi1-xsL1ZGFQLe3ULoGFe_NoF4DAvfv0ivfpF2vtFgn6RXv0CaJQXhKNb9-sXhKPp9n6RoF-kV78AGuUF4ejE-vULwtF0t37pz__5EwAA__9cCIMg

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82N-KGzcUBvD7PoXRVUvHjHWk8T8ouLSBBkI2ZPeiUHwxsdVdw8ZjZsaQbdh3L7aXzFpan0-akecua-ezzpwj_ZD9XWyLtfmYfzWVmP8jpEgEiUQokQgtEpGJZSJ2ZbEyVVWUh_9yCrxffxPzUSI2292-Pry8TMSqKI2Yfxf1pn40Yi7u8i-P5rPJ16ZMRyIRa1Pnm8fjMrty8zUvnxbfnv4Tibjd5dtqPhimh5Vv9vV8sKBkocTyORHFvm5WqOr83oi5fE78q7gtytqUaXZewIJ-_bGWTBZ0cS0KWevPTVVvtqs6ldbzLmSzmrVUk_7yNHjIqwcnuXxuylEh5bwegMxiTkC3mADZPfEdQdZqBGRPPNYIxhfLaT5nvy3KtSnN-uyTjp9ysWDl7plLHZlcqwS3Z5dKmHYoIWlV5V959XBr6ptdqq1O3T3tzHzw7u8_3n26G_z-4YNIxKP5t_55IX_5rdzcPxz_dXH6zTPN4rb1YzEsdqnO7Kd_27TR2eIy4GR7HOyUhqlqgyuo4-Voj6PgCtZqcJW94BoygnHcGegWMyC7K-149R0C2TO_Dq8ynm3urvHjNWIJbs_8eA0roTOvsg9eyf94kc_pUsNUtxEO1PFyuiZRhANrNcJRL8IFjEBO4s5At5gB2V1pJ5zvEMie-XWEo3i8uLvGT7iIJbg98xMurITOwlEfwin_46V8TpceHr_FBgsH6ng5XdMowoG1GuFUL8IFjEBO485At5gB2V1pJ5zvEMie-XWEU_F4cXeNn3ARS3B75idcWAmdhVN9CKf9j5f2OV3ZsI1voIqXszWL4htYq_FN9-JbwADkLOYEdIsJkN2Tdrr5joDsiV9HNx2PFnfP-OkWsQS3Z366hZXQWTfd9w-Ab5Tz2VS7YlsZr5_3RocHMut7c2pQVezLlflUFqvjMqc_b4654wtrU9Wnd-Xpj_fb01uHAl-HJRsmPkx2WL4Oj8_CMiwsO6Up65JWuktaKz6t2I5rvuOaDWd8OGPrnvBl82HZKU1g2HxagWHzaQ2GPWY7PuXDk4Aw2eEpG57xK8_4XTYGKgBTECq8KhKwIju5AtIIFhBHsoA4ogXEkS2Sx0UCXSTPiwS-yE7AgDQSBsQRMSCOjAFxhIzklZGAGck7IwE0spM0kqeGRuAOwVNDgBpyqAm6g_BpeAnh4_AWwsfhNYSPIyvIoea88Qo0nqeGADXkUBNiBUgjK0AcWQHiyAoQR1aQQ81549Gz89RYcccK4qkBVhAvDc3ApuGpUYAa5VATYgVIIytAHFkB4sgKEIffWfgLnQIXOsVTowA1yqEmxAqQRlaAOLICxJEVII6sUPyFTqHieWqsuGOF4qkBViheGjUFm4anRgFqlENNkBV8GlrBx6EVfBxawceRFZq_0GlwodM8NRpQo_kvUOCwgzSyAsSRFSCOrABxZIUGP0yh1XlqrLhjheapsa1YPv_0fwAAAP__DLUp7g==

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltFq4kAUhu_3KeRc7cKEOJPE1sCCy1LYQqml9WJhyUVqzqpgkzAToW7x3ZckW1yjzsl0MLmM-mX-OecD_zdIswTv4xdUEP4CDgwEMPCAgQ8MAogY5DKbo1KZLH9SA7fJK4RDBqs03xTlxxGDeSYRwjcoVsUaIYRZ_LzGR4wTlO4QGCRYxKt1dUwuVy-x3E5et3-AwVMepyocOG558nRThIMJZxMB0Y5Btin-nbB_8fN2sIzV8vCV70jEQBXxAiHkO_axsEEPYcXZsPtXbdJMJigxOXhZVJLUT07c-Eeslk9YTHOXN7Yz2-YYDm5-fr95mA2-3d0BgzX-Lj5Xqb98lavF8v1hP4PGAPY38yxudiL2feZkucuD5gxOnu0fnM3bK8BbKOAKx_UuaKxB3FEvccXZuB04y7tzVrRfhGizCM9x_Qt6YxD3qpe44mzcDrwR3XnjtV-E12YRvlP9NV3KG4O4173EFWfjduCN1503fvtF-G0WETgXtMYg7LiHsOJs2A6c8fvpVSdCPaLKs1Rhq9Y0LK-FyQLrMalsI-f4ILN5dUz9OK246l8_QVXU34r64TatvyoDtodHNvDYBuZWuXmgp7nByIQZPLKBxzYwt8rdGNkRLZr08H_a08_b08L8cGbDJu3bCK6HCcH1MCG4HqYEJ2hC8MBGcD1MCK6HCcH1MCU4QROCj2wEv7JRVA8TiuphQlE9TClK0ISi1zaK6mFCUT1MKKqHKUUJmlB0bKMot-oJBE1IStCEpQRNaUrhVFewKwt2bcGuLlj2BbvCwK0aAz-qDEa26mnKVj1N2aqnSVsJnLLVpCwd78ykLZnSlK1GfckYp2w9Kg9aW6Pdp78BAAD__7amZ9o=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmE9r40gUxO_7KUyfdkFGft2S_wgWsuwEJhCSkOQwMPigWD2xwbGEJEM8Id99sM3YsWS9UqulzNFxfurq0qtSy29iFUf6JnzRmQi-CxKOkMIRSjjCE47wxdQRSRrPdJbF6fZf9sBV9CqCgSMWq2Sdb_88dcQsTrUI3kS-yJdaBOIxfFrqex1GOnUHwhGRzsPFcrdMki5ewnRz8br5KRzxkISrLOj13e3Kt-s86F2QcyHF9N0R8To_rpDl4bMWAb079VV8WWT5YjXLXf9UwrkljtTTpjcPs_l55KhEmij56Ae1aohqZAh14YhXKeV4qfUqTiOd6ujkYrurVIqVAyz2qMLvSkUNy44qhhYqnEZCv4bZ_EHnt4mrCn49bhId9C6__X9599j77_paOGKpf-R_73bwz7_p4nn--8Nx5ip3NmrX35u4Hyeu8osenF17fLI2GWSuRuRc2XdVkxYCOg4TNOy8hUwcadkS1cgS6sITr1KKZQNQ8x5qUUUNy6p6yEyFdQ_R5_WQrD_5ss7gq77rNekCoONwF0edd4GBI9SyJaqRJdSFJ16lFMsUyuZd0KKKGpZVdYGZCusukJ_XBar-5Ks6g-_1dy8Qxl0AdBzu4rjzLjBwhFq2RDWyhLrwxKuUYplC1bwLWlRRw7KqLjBTYd0F6vO6wKs_-V6dwff7TZoAqDjcw0nnTWDgB7VqiGpkCHXhiFcpxTKBXvMeaFFFDcuqesBMhXUPeH_md4ozou51lsSrTNf6FWKw3ZaOnvXepixepzN9l8az3TL7j7c7bveHSGf5_lvaf7ha7b_aCvwIUxGmj7B3ApMZTNKKntjQcmhDK8XTknVc8Y4rdmmfX5mHCejmaTmwokc2tAKT5rGOg5vtG8CyCA9ZGGx6xA_KkJ-UMUtPeHhiE2weRsEGNAg2T6Ng8zQKNoEuRWXK1wrINqBRuAGO0o1wMOkAR_kmvlIJ4aV24fBSxomvF7R1vl8IpJxKDWP0COZp-AwGOHoI8zh8CvM4TCtfrzQGxpf61SitPA3TyuMwrQBHI8vjMK2llj0xXhI4PvEtW8BLaZWlqjFJq-SbRoLTm-TPMcA4QKO0IhykFeAorQCHh2a-ZKUPjC-1rElaAY3SCnCUVoSjkeVxlFbJH2HlGOB8yxbwclr5UyzaOt80agDetUpNY5JWQKO0IhykFeAorQBHaVV8ySoJjC-1rNFbLk_D11weh--5AEcvujyO0qr4o6xC1vEtW8BLaVX8Wba49en7X78CAAD__-LGBZQ=
