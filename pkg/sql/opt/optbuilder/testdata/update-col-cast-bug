exec-ddl
create table t (a int2, b int2, c int2 as (a + b) virtual)
----

build format=show-types
update t set a = (with cte as (select 1:::int8) select t.c from cte limit 1)
----
with &1 (cte)
 ├── project
 │    ├── columns: int8:11(int!null)
 │    ├── values
 │    │    └── () [type=tuple]
 │    └── projections
 │         └── 1 [as=int8:11, type=int]
 └── update t
      ├── columns: <none>
      ├── fetch columns: a:6(int2) b:7(int2) t.c:8(int2) rowid:9(int)
      ├── update-mapping:
      │    ├── a_new:14 => a:1
      │    └── column15:15 => t.c:3
      └── project
           ├── columns: column15:15(int2) a:6(int2) b:7(int2) t.c:8(int2) rowid:9(int!null) crdb_internal_mvcc_timestamp:10(decimal) a_new:14(int2)
           ├── project
           │    ├── columns: a_new:14(int2) a:6(int2) b:7(int2) t.c:8(int2) rowid:9(int!null) crdb_internal_mvcc_timestamp:10(decimal)
           │    ├── project
           │    │    ├── columns: t.c:8(int2) a:6(int2) b:7(int2) rowid:9(int!null) crdb_internal_mvcc_timestamp:10(decimal)
           │    │    ├── scan t
           │    │    │    ├── columns: a:6(int2) b:7(int2) rowid:9(int!null) crdb_internal_mvcc_timestamp:10(decimal)
           │    │    │    └── computed column expressions
           │    │    │         └── t.c:8
           │    │    │              └── (a:6::INT8 + b:7::INT8)::INT2 [type=int2]
           │    │    └── projections
           │    │         └── (a:6::INT8 + b:7::INT8)::INT2 [as=t.c:8, type=int2]
           │    └── projections
           │         └── subquery [as=a_new:14, type=int2]
           │              └── max1-row
           │                   ├── columns: c:13(int2)
           │                   └── limit
           │                        ├── columns: c:13(int2)
           │                        ├── project
           │                        │    ├── columns: c:13(int2)
           │                        │    ├── limit hint: 1.00
           │                        │    ├── with-scan &1 (cte)
           │                        │    │    ├── columns: int8:12(int!null)
           │                        │    │    ├── mapping:
           │                        │    │    │    └──  int8:11(int) => int8:12(int)
           │                        │    │    └── limit hint: 1.00
           │                        │    └── projections
           │                        │         └── t.c:8 [as=c:13, type=int2]
           │                        └── 1 [type=int]
           └── projections
                └── (a_new:14::INT8 + b:7::INT8)::INT2 [as=column15:15, type=int2]
