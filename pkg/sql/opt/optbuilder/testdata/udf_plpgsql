exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  BEGIN
    RETURN a;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:3
                     ├── project
                     │    ├── columns: stmt_return_1:3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── variable: a:1 [as=stmt_return_1:3]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  BEGIN
    RETURN a + b;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:3
                     ├── project
                     │    ├── columns: stmt_return_1:3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── plus [as=stmt_return_1:3]
                     │              ├── variable: a:1
                     │              └── variable: b:2
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:5
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:5]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:4
                     ├── project
                     │    ├── columns: stmt_return_1:4
                     │    ├── project
                     │    │    ├── columns: c:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=c:3]
                     │    │              └── null
                     │    └── projections
                     │         └── variable: c:3 [as=stmt_return_1:4]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT := 0;
  BEGIN
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:5
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:5]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:4!null
                     ├── project
                     │    ├── columns: stmt_return_1:4!null
                     │    ├── project
                     │    │    ├── columns: c:3!null
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── const: 0 [as=c:3]
                     │    └── projections
                     │         └── variable: c:3 [as=stmt_return_1:4]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    c := 0;
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:6
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:6]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:5!null
                     ├── project
                     │    ├── columns: stmt_return_1:5!null
                     │    ├── project
                     │    │    ├── columns: c:4!null
                     │    │    ├── project
                     │    │    │    ├── columns: c:3
                     │    │    │    ├── values
                     │    │    │    │    └── tuple
                     │    │    │    └── projections
                     │    │    │         └── cast: INT8 [as=c:3]
                     │    │    │              └── null
                     │    │    └── projections
                     │    │         └── const: 0 [as=c:4]
                     │    └── projections
                     │         └── variable: c:4 [as=stmt_return_1:5]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    IF a < b THEN
      c := a;
    END IF;
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:12
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:12]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_if_3:11
                     ├── project
                     │    ├── columns: stmt_if_3:11
                     │    ├── project
                     │    │    ├── columns: c:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=c:3]
                     │    │              └── null
                     │    └── projections
                     │         └── case [as=stmt_if_3:11]
                     │              ├── true
                     │              ├── when
                     │              │    ├── lt
                     │              │    │    ├── variable: a:1
                     │              │    │    └── variable: b:2
                     │              │    └── subquery
                     │              │         └── project
                     │              │              ├── columns: stmt_if_1:9
                     │              │              ├── project
                     │              │              │    ├── columns: c:8
                     │              │              │    ├── values
                     │              │              │    │    └── tuple
                     │              │              │    └── projections
                     │              │              │         └── variable: a:1 [as=c:8]
                     │              │              └── projections
                     │              │                   └── udf: stmt_if_1 [as=stmt_if_1:9]
                     │              │                        ├── args
                     │              │                        │    ├── variable: c:8
                     │              │                        │    ├── variable: a:1
                     │              │                        │    └── variable: b:2
                     │              │                        ├── params: c:4 a:5 b:6
                     │              │                        └── body
                     │              │                             └── project
                     │              │                                  ├── columns: stmt_return_2:7
                     │              │                                  ├── values
                     │              │                                  │    └── tuple
                     │              │                                  └── projections
                     │              │                                       └── variable: c:4 [as=stmt_return_2:7]
                     │              └── subquery
                     │                   └── project
                     │                        ├── columns: stmt_if_1:10
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── udf: stmt_if_1 [as=stmt_if_1:10]
                     │                                  ├── args
                     │                                  │    ├── variable: c:3
                     │                                  │    ├── variable: a:1
                     │                                  │    └── variable: b:2
                     │                                  ├── params: c:4 a:5 b:6
                     │                                  └── body
                     │                                       └── project
                     │                                            ├── columns: stmt_return_2:7
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── variable: c:4 [as=stmt_return_2:7]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    IF a < b THEN
      c := a;
    ELSE
      c := b;
    END IF;
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:13
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:13]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_if_3:12
                     ├── project
                     │    ├── columns: stmt_if_3:12
                     │    ├── project
                     │    │    ├── columns: c:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=c:3]
                     │    │              └── null
                     │    └── projections
                     │         └── case [as=stmt_if_3:12]
                     │              ├── true
                     │              ├── when
                     │              │    ├── lt
                     │              │    │    ├── variable: a:1
                     │              │    │    └── variable: b:2
                     │              │    └── subquery
                     │              │         └── project
                     │              │              ├── columns: stmt_if_1:9
                     │              │              ├── project
                     │              │              │    ├── columns: c:8
                     │              │              │    ├── values
                     │              │              │    │    └── tuple
                     │              │              │    └── projections
                     │              │              │         └── variable: a:1 [as=c:8]
                     │              │              └── projections
                     │              │                   └── udf: stmt_if_1 [as=stmt_if_1:9]
                     │              │                        ├── args
                     │              │                        │    ├── variable: c:8
                     │              │                        │    ├── variable: a:1
                     │              │                        │    └── variable: b:2
                     │              │                        ├── params: c:4 a:5 b:6
                     │              │                        └── body
                     │              │                             └── project
                     │              │                                  ├── columns: stmt_return_2:7
                     │              │                                  ├── values
                     │              │                                  │    └── tuple
                     │              │                                  └── projections
                     │              │                                       └── variable: c:4 [as=stmt_return_2:7]
                     │              └── subquery
                     │                   └── project
                     │                        ├── columns: stmt_if_1:11
                     │                        ├── project
                     │                        │    ├── columns: c:10
                     │                        │    ├── values
                     │                        │    │    └── tuple
                     │                        │    └── projections
                     │                        │         └── variable: b:2 [as=c:10]
                     │                        └── projections
                     │                             └── udf: stmt_if_1 [as=stmt_if_1:11]
                     │                                  ├── args
                     │                                  │    ├── variable: c:10
                     │                                  │    ├── variable: a:1
                     │                                  │    └── variable: b:2
                     │                                  ├── params: c:4 a:5 b:6
                     │                                  └── body
                     │                                       └── project
                     │                                            ├── columns: stmt_return_2:7
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── variable: c:4 [as=stmt_return_2:7]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    i INT := a;
  BEGIN
    LOOP
      IF i >= b THEN EXIT; END IF;
      i := i + 1;
    END LOOP;
    RETURN i;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 5);
----
project
 ├── columns: f:20
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:20]
           ├── args
           │    ├── const: 1
           │    └── const: 5
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_loop_3:19
                     ├── project
                     │    ├── columns: stmt_loop_3:19
                     │    ├── project
                     │    │    ├── columns: i:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── variable: a:1 [as=i:3]
                     │    └── projections
                     │         └── udf: stmt_loop_3 [as=stmt_loop_3:19]
                     │              ├── args
                     │              │    ├── variable: i:3
                     │              │    ├── variable: a:1
                     │              │    └── variable: b:2
                     │              ├── params: i:8 a:9 b:10
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_5:18
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_5:18]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── ge
                     │                                  │    │    ├── variable: i:8
                     │                                  │    │    └── variable: b:10
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: loop_exit_1:16
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:16]
                     │                                  │                        ├── args
                     │                                  │                        │    ├── variable: i:8
                     │                                  │                        │    ├── variable: a:9
                     │                                  │                        │    └── variable: b:10
                     │                                  │                        ├── params: i:4 a:5 b:6
                     │                                  │                        └── body
                     │                                  │                             └── project
                     │                                  │                                  ├── columns: stmt_return_2:7
                     │                                  │                                  ├── values
                     │                                  │                                  │    └── tuple
                     │                                  │                                  └── projections
                     │                                  │                                       └── variable: i:4 [as=stmt_return_2:7]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_4:17
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_4 [as=stmt_if_4:17]
                     │                                                      ├── args
                     │                                                      │    ├── variable: i:8
                     │                                                      │    ├── variable: a:9
                     │                                                      │    └── variable: b:10
                     │                                                      ├── params: i:11 a:12 b:13
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: stmt_loop_3:15
                     │                                                                ├── project
                     │                                                                │    ├── columns: i:14
                     │                                                                │    ├── values
                     │                                                                │    │    └── tuple
                     │                                                                │    └── projections
                     │                                                                │         └── plus [as=i:14]
                     │                                                                │              ├── variable: i:11
                     │                                                                │              └── const: 1
                     │                                                                └── projections
                     │                                                                     └── udf: stmt_loop_3 [as=stmt_loop_3:15]
                     │                                                                          ├── args
                     │                                                                          │    ├── variable: i:14
                     │                                                                          │    ├── variable: a:12
                     │                                                                          │    └── variable: b:13
                     │                                                                          └── recursive-call
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    sum INT := 0;
    i INT := a;
  BEGIN
    IF a IS NOT NULL AND b is NOT NULL THEN
      LOOP
        IF i >= b THEN EXIT; END IF;
        sum := sum + i;
        i := i + 1;
      END LOOP;
    END IF;
    RETURN sum;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(0, 0);
----
project
 ├── columns: f:27
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:27]
           ├── args
           │    ├── const: 0
           │    └── const: 0
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_if_6:26
                     ├── project
                     │    ├── columns: stmt_if_6:26
                     │    ├── project
                     │    │    ├── columns: i:4 sum:3!null
                     │    │    ├── project
                     │    │    │    ├── columns: sum:3!null
                     │    │    │    ├── values
                     │    │    │    │    └── tuple
                     │    │    │    └── projections
                     │    │    │         └── const: 0 [as=sum:3]
                     │    │    └── projections
                     │    │         └── variable: a:1 [as=i:4]
                     │    └── projections
                     │         └── case [as=stmt_if_6:26]
                     │              ├── true
                     │              ├── when
                     │              │    ├── and
                     │              │    │    ├── is-not
                     │              │    │    │    ├── variable: a:1
                     │              │    │    │    └── null
                     │              │    │    └── is-not
                     │              │    │         ├── variable: b:2
                     │              │    │         └── null
                     │              │    └── subquery
                     │              │         └── project
                     │              │              ├── columns: stmt_loop_3:24
                     │              │              ├── values
                     │              │              │    └── tuple
                     │              │              └── projections
                     │              │                   └── udf: stmt_loop_3 [as=stmt_loop_3:24]
                     │              │                        ├── args
                     │              │                        │    ├── variable: sum:3
                     │              │                        │    ├── variable: i:4
                     │              │                        │    ├── variable: a:1
                     │              │                        │    └── variable: b:2
                     │              │                        ├── params: sum:10 i:11 a:12 b:13
                     │              │                        └── body
                     │              │                             └── project
                     │              │                                  ├── columns: stmt_if_5:23
                     │              │                                  ├── values
                     │              │                                  │    └── tuple
                     │              │                                  └── projections
                     │              │                                       └── case [as=stmt_if_5:23]
                     │              │                                            ├── true
                     │              │                                            ├── when
                     │              │                                            │    ├── ge
                     │              │                                            │    │    ├── variable: i:11
                     │              │                                            │    │    └── variable: b:13
                     │              │                                            │    └── subquery
                     │              │                                            │         └── project
                     │              │                                            │              ├── columns: stmt_if_1:21
                     │              │                                            │              ├── values
                     │              │                                            │              │    └── tuple
                     │              │                                            │              └── projections
                     │              │                                            │                   └── udf: stmt_if_1 [as=stmt_if_1:21]
                     │              │                                            │                        ├── args
                     │              │                                            │                        │    ├── variable: sum:10
                     │              │                                            │                        │    ├── variable: i:11
                     │              │                                            │                        │    ├── variable: a:12
                     │              │                                            │                        │    └── variable: b:13
                     │              │                                            │                        ├── params: sum:5 i:6 a:7 b:8
                     │              │                                            │                        └── body
                     │              │                                            │                             └── project
                     │              │                                            │                                  ├── columns: stmt_return_2:9
                     │              │                                            │                                  ├── values
                     │              │                                            │                                  │    └── tuple
                     │              │                                            │                                  └── projections
                     │              │                                            │                                       └── variable: sum:5 [as=stmt_return_2:9]
                     │              │                                            └── subquery
                     │              │                                                 └── project
                     │              │                                                      ├── columns: stmt_if_4:22
                     │              │                                                      ├── values
                     │              │                                                      │    └── tuple
                     │              │                                                      └── projections
                     │              │                                                           └── udf: stmt_if_4 [as=stmt_if_4:22]
                     │              │                                                                ├── args
                     │              │                                                                │    ├── variable: sum:10
                     │              │                                                                │    ├── variable: i:11
                     │              │                                                                │    ├── variable: a:12
                     │              │                                                                │    └── variable: b:13
                     │              │                                                                ├── params: sum:14 i:15 a:16 b:17
                     │              │                                                                └── body
                     │              │                                                                     └── project
                     │              │                                                                          ├── columns: stmt_loop_3:20
                     │              │                                                                          ├── project
                     │              │                                                                          │    ├── columns: i:19 sum:18
                     │              │                                                                          │    ├── project
                     │              │                                                                          │    │    ├── columns: sum:18
                     │              │                                                                          │    │    ├── values
                     │              │                                                                          │    │    │    └── tuple
                     │              │                                                                          │    │    └── projections
                     │              │                                                                          │    │         └── plus [as=sum:18]
                     │              │                                                                          │    │              ├── variable: sum:14
                     │              │                                                                          │    │              └── variable: i:15
                     │              │                                                                          │    └── projections
                     │              │                                                                          │         └── plus [as=i:19]
                     │              │                                                                          │              ├── variable: i:15
                     │              │                                                                          │              └── const: 1
                     │              │                                                                          └── projections
                     │              │                                                                               └── udf: stmt_loop_3 [as=stmt_loop_3:20]
                     │              │                                                                                    ├── args
                     │              │                                                                                    │    ├── variable: sum:18
                     │              │                                                                                    │    ├── variable: i:19
                     │              │                                                                                    │    ├── variable: a:16
                     │              │                                                                                    │    └── variable: b:17
                     │              │                                                                                    └── recursive-call
                     │              └── subquery
                     │                   └── project
                     │                        ├── columns: stmt_if_1:25
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── udf: stmt_if_1 [as=stmt_if_1:25]
                     │                                  ├── args
                     │                                  │    ├── variable: sum:3
                     │                                  │    ├── variable: i:4
                     │                                  │    ├── variable: a:1
                     │                                  │    └── variable: b:2
                     │                                  ├── params: sum:5 i:6 a:7 b:8
                     │                                  └── body
                     │                                       └── project
                     │                                            ├── columns: stmt_return_2:9
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── variable: sum:5 [as=stmt_return_2:9]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    sum INT := 0;
    i INT := a;
  BEGIN
    LOOP
      IF i >= b THEN EXIT; END IF;
      IF i = 2 THEN 
        i := i + 1;
        CONTINUE;
      END IF;
      sum := sum + i;
      i := i + 1;
    END LOOP;
    RETURN sum;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(5, -5);
----
project
 ├── columns: f:33
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:33]
           ├── args
           │    ├── const: 5
           │    └── const: -5
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_loop_3:32
                     ├── project
                     │    ├── columns: stmt_loop_3:32
                     │    ├── project
                     │    │    ├── columns: i:4 sum:3!null
                     │    │    ├── project
                     │    │    │    ├── columns: sum:3!null
                     │    │    │    ├── values
                     │    │    │    │    └── tuple
                     │    │    │    └── projections
                     │    │    │         └── const: 0 [as=sum:3]
                     │    │    └── projections
                     │    │         └── variable: a:1 [as=i:4]
                     │    └── projections
                     │         └── udf: stmt_loop_3 [as=stmt_loop_3:32]
                     │              ├── args
                     │              │    ├── variable: sum:3
                     │              │    ├── variable: i:4
                     │              │    ├── variable: a:1
                     │              │    └── variable: b:2
                     │              ├── params: sum:10 i:11 a:12 b:13
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_7:31
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_7:31]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── ge
                     │                                  │    │    ├── variable: i:11
                     │                                  │    │    └── variable: b:13
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: loop_exit_1:29
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:29]
                     │                                  │                        ├── args
                     │                                  │                        │    ├── variable: sum:10
                     │                                  │                        │    ├── variable: i:11
                     │                                  │                        │    ├── variable: a:12
                     │                                  │                        │    └── variable: b:13
                     │                                  │                        ├── params: sum:5 i:6 a:7 b:8
                     │                                  │                        └── body
                     │                                  │                             └── project
                     │                                  │                                  ├── columns: stmt_return_2:9
                     │                                  │                                  ├── values
                     │                                  │                                  │    └── tuple
                     │                                  │                                  └── projections
                     │                                  │                                       └── variable: sum:5 [as=stmt_return_2:9]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_4:30
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_4 [as=stmt_if_4:30]
                     │                                                      ├── args
                     │                                                      │    ├── variable: sum:10
                     │                                                      │    ├── variable: i:11
                     │                                                      │    ├── variable: a:12
                     │                                                      │    └── variable: b:13
                     │                                                      ├── params: sum:14 i:15 a:16 b:17
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: stmt_if_6:28
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── case [as=stmt_if_6:28]
                     │                                                                          ├── true
                     │                                                                          ├── when
                     │                                                                          │    ├── eq
                     │                                                                          │    │    ├── variable: i:15
                     │                                                                          │    │    └── const: 2
                     │                                                                          │    └── subquery
                     │                                                                          │         └── project
                     │                                                                          │              ├── columns: stmt_loop_3:26
                     │                                                                          │              ├── project
                     │                                                                          │              │    ├── columns: i:25
                     │                                                                          │              │    ├── values
                     │                                                                          │              │    │    └── tuple
                     │                                                                          │              │    └── projections
                     │                                                                          │              │         └── plus [as=i:25]
                     │                                                                          │              │              ├── variable: i:15
                     │                                                                          │              │              └── const: 1
                     │                                                                          │              └── projections
                     │                                                                          │                   └── udf: stmt_loop_3 [as=stmt_loop_3:26]
                     │                                                                          │                        ├── args
                     │                                                                          │                        │    ├── variable: sum:14
                     │                                                                          │                        │    ├── variable: i:25
                     │                                                                          │                        │    ├── variable: a:16
                     │                                                                          │                        │    └── variable: b:17
                     │                                                                          │                        └── recursive-call
                     │                                                                          └── subquery
                     │                                                                               └── project
                     │                                                                                    ├── columns: stmt_if_5:27
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── udf: stmt_if_5 [as=stmt_if_5:27]
                     │                                                                                              ├── args
                     │                                                                                              │    ├── variable: sum:14
                     │                                                                                              │    ├── variable: i:15
                     │                                                                                              │    ├── variable: a:16
                     │                                                                                              │    └── variable: b:17
                     │                                                                                              ├── params: sum:18 i:19 a:20 b:21
                     │                                                                                              └── body
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: stmt_loop_3:24
                     │                                                                                                        ├── project
                     │                                                                                                        │    ├── columns: i:23 sum:22
                     │                                                                                                        │    ├── project
                     │                                                                                                        │    │    ├── columns: sum:22
                     │                                                                                                        │    │    ├── values
                     │                                                                                                        │    │    │    └── tuple
                     │                                                                                                        │    │    └── projections
                     │                                                                                                        │    │         └── plus [as=sum:22]
                     │                                                                                                        │    │              ├── variable: sum:18
                     │                                                                                                        │    │              └── variable: i:19
                     │                                                                                                        │    └── projections
                     │                                                                                                        │         └── plus [as=i:23]
                     │                                                                                                        │              ├── variable: i:19
                     │                                                                                                        │              └── const: 1
                     │                                                                                                        └── projections
                     │                                                                                                             └── udf: stmt_loop_3 [as=stmt_loop_3:24]
                     │                                                                                                                  ├── args
                     │                                                                                                                  │    ├── variable: sum:22
                     │                                                                                                                  │    ├── variable: i:23
                     │                                                                                                                  │    ├── variable: a:20
                     │                                                                                                                  │    └── variable: b:21
                     │                                                                                                                  └── recursive-call
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    sum INT := 0;
    i INT := a;
    j INT;
  BEGIN
    LOOP
      IF i >= b THEN EXIT; END IF;
      j := 0;
      LOOP
        IF j >= i THEN EXIT; END IF;
        sum := sum + j;
        j := j + 1;
      END LOOP;
      i := i + 1;
    END LOOP;
    RETURN sum;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 5)
----
project
 ├── columns: f:51
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:51]
           ├── args
           │    ├── const: 1
           │    └── const: 5
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_loop_3:50
                     ├── project
                     │    ├── columns: stmt_loop_3:50
                     │    ├── project
                     │    │    ├── columns: j:5 sum:3!null i:4
                     │    │    ├── project
                     │    │    │    ├── columns: i:4 sum:3!null
                     │    │    │    ├── project
                     │    │    │    │    ├── columns: sum:3!null
                     │    │    │    │    ├── values
                     │    │    │    │    │    └── tuple
                     │    │    │    │    └── projections
                     │    │    │    │         └── const: 0 [as=sum:3]
                     │    │    │    └── projections
                     │    │    │         └── variable: a:1 [as=i:4]
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=j:5]
                     │    │              └── null
                     │    └── projections
                     │         └── udf: stmt_loop_3 [as=stmt_loop_3:50]
                     │              ├── args
                     │              │    ├── variable: sum:3
                     │              │    ├── variable: i:4
                     │              │    ├── variable: j:5
                     │              │    ├── variable: a:1
                     │              │    └── variable: b:2
                     │              ├── params: sum:12 i:13 j:14 a:15 b:16
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_9:49
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_9:49]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── ge
                     │                                  │    │    ├── variable: i:13
                     │                                  │    │    └── variable: b:16
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: loop_exit_1:47
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:47]
                     │                                  │                        ├── args
                     │                                  │                        │    ├── variable: sum:12
                     │                                  │                        │    ├── variable: i:13
                     │                                  │                        │    ├── variable: j:14
                     │                                  │                        │    ├── variable: a:15
                     │                                  │                        │    └── variable: b:16
                     │                                  │                        ├── params: sum:6 i:7 j:8 a:9 b:10
                     │                                  │                        └── body
                     │                                  │                             └── project
                     │                                  │                                  ├── columns: stmt_return_2:11
                     │                                  │                                  ├── values
                     │                                  │                                  │    └── tuple
                     │                                  │                                  └── projections
                     │                                  │                                       └── variable: sum:6 [as=stmt_return_2:11]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_4:48
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_4 [as=stmt_if_4:48]
                     │                                                      ├── args
                     │                                                      │    ├── variable: sum:12
                     │                                                      │    ├── variable: i:13
                     │                                                      │    ├── variable: j:14
                     │                                                      │    ├── variable: a:15
                     │                                                      │    └── variable: b:16
                     │                                                      ├── params: sum:17 i:18 j:19 a:20 b:21
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: stmt_loop_6:46
                     │                                                                ├── project
                     │                                                                │    ├── columns: j:22!null
                     │                                                                │    ├── values
                     │                                                                │    │    └── tuple
                     │                                                                │    └── projections
                     │                                                                │         └── const: 0 [as=j:22]
                     │                                                                └── projections
                     │                                                                     └── udf: stmt_loop_6 [as=stmt_loop_6:46]
                     │                                                                          ├── args
                     │                                                                          │    ├── variable: sum:17
                     │                                                                          │    ├── variable: i:18
                     │                                                                          │    ├── variable: j:22
                     │                                                                          │    ├── variable: a:20
                     │                                                                          │    └── variable: b:21
                     │                                                                          ├── params: sum:30 i:31 j:32 a:33 b:34
                     │                                                                          └── body
                     │                                                                               └── project
                     │                                                                                    ├── columns: stmt_if_8:45
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── case [as=stmt_if_8:45]
                     │                                                                                              ├── true
                     │                                                                                              ├── when
                     │                                                                                              │    ├── ge
                     │                                                                                              │    │    ├── variable: j:32
                     │                                                                                              │    │    └── variable: i:31
                     │                                                                                              │    └── subquery
                     │                                                                                              │         └── project
                     │                                                                                              │              ├── columns: loop_exit_5:43
                     │                                                                                              │              ├── values
                     │                                                                                              │              │    └── tuple
                     │                                                                                              │              └── projections
                     │                                                                                              │                   └── udf: loop_exit_5 [as=loop_exit_5:43]
                     │                                                                                              │                        ├── args
                     │                                                                                              │                        │    ├── variable: sum:30
                     │                                                                                              │                        │    ├── variable: i:31
                     │                                                                                              │                        │    ├── variable: j:32
                     │                                                                                              │                        │    ├── variable: a:33
                     │                                                                                              │                        │    └── variable: b:34
                     │                                                                                              │                        ├── params: sum:23 i:24 j:25 a:26 b:27
                     │                                                                                              │                        └── body
                     │                                                                                              │                             └── project
                     │                                                                                              │                                  ├── columns: stmt_loop_3:29
                     │                                                                                              │                                  ├── project
                     │                                                                                              │                                  │    ├── columns: i:28
                     │                                                                                              │                                  │    ├── values
                     │                                                                                              │                                  │    │    └── tuple
                     │                                                                                              │                                  │    └── projections
                     │                                                                                              │                                  │         └── plus [as=i:28]
                     │                                                                                              │                                  │              ├── variable: i:24
                     │                                                                                              │                                  │              └── const: 1
                     │                                                                                              │                                  └── projections
                     │                                                                                              │                                       └── udf: stmt_loop_3 [as=stmt_loop_3:29]
                     │                                                                                              │                                            ├── args
                     │                                                                                              │                                            │    ├── variable: sum:23
                     │                                                                                              │                                            │    ├── variable: i:28
                     │                                                                                              │                                            │    ├── variable: j:25
                     │                                                                                              │                                            │    ├── variable: a:26
                     │                                                                                              │                                            │    └── variable: b:27
                     │                                                                                              │                                            └── recursive-call
                     │                                                                                              └── subquery
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: stmt_if_7:44
                     │                                                                                                        ├── values
                     │                                                                                                        │    └── tuple
                     │                                                                                                        └── projections
                     │                                                                                                             └── udf: stmt_if_7 [as=stmt_if_7:44]
                     │                                                                                                                  ├── args
                     │                                                                                                                  │    ├── variable: sum:30
                     │                                                                                                                  │    ├── variable: i:31
                     │                                                                                                                  │    ├── variable: j:32
                     │                                                                                                                  │    ├── variable: a:33
                     │                                                                                                                  │    └── variable: b:34
                     │                                                                                                                  ├── params: sum:35 i:36 j:37 a:38 b:39
                     │                                                                                                                  └── body
                     │                                                                                                                       └── project
                     │                                                                                                                            ├── columns: stmt_loop_6:42
                     │                                                                                                                            ├── project
                     │                                                                                                                            │    ├── columns: j:41 sum:40
                     │                                                                                                                            │    ├── project
                     │                                                                                                                            │    │    ├── columns: sum:40
                     │                                                                                                                            │    │    ├── values
                     │                                                                                                                            │    │    │    └── tuple
                     │                                                                                                                            │    │    └── projections
                     │                                                                                                                            │    │         └── plus [as=sum:40]
                     │                                                                                                                            │    │              ├── variable: sum:35
                     │                                                                                                                            │    │              └── variable: j:37
                     │                                                                                                                            │    └── projections
                     │                                                                                                                            │         └── plus [as=j:41]
                     │                                                                                                                            │              ├── variable: j:37
                     │                                                                                                                            │              └── const: 1
                     │                                                                                                                            └── projections
                     │                                                                                                                                 └── udf: stmt_loop_6 [as=stmt_loop_6:42]
                     │                                                                                                                                      ├── args
                     │                                                                                                                                      │    ├── variable: sum:40
                     │                                                                                                                                      │    ├── variable: i:36
                     │                                                                                                                                      │    ├── variable: j:41
                     │                                                                                                                                      │    ├── variable: a:38
                     │                                                                                                                                      │    └── variable: b:39
                     │                                                                                                                                      └── recursive-call
                     └── const: 1

# Dijkstra's Algorithm
#
#        ┌─┬────8──┬─┬──7────┬─┐
#  ┌─────┤1│       │2│       │3├─────┐
#  │     └┬┘       └┬┴───┐   └┬┘     │
#  │      │         │    │    │      │
#  4      │         2    │    │      9
#  │      │         │    │    │      │
# ┌┴┐     │        ┌┴┐   │    │     ┌┴┐
# │0│    11    ┌───┤8│   │    14    │4│
# └┬┘     │    │   └┬┘   │    │     └┬┘
#  │      │    7    │    │    │      │
#  8      │    │    6    │    │      10
#  │      │    │    │    │    │      │
#  │     ┌┴┬───┘   ┌┴┐   └───┬┴┐     │
#  └─────┤7│       │6│       │5├─────┘
#        └─┴────1──┴─┴──4────┴─┘
#
# Encode the graph as a series of undirected edges, where "a" and "b" are the
# "to" and "from" nodes and "weight" is the weight of the edge.
exec-ddl
CREATE TABLE edges (a INT, b INT, weight INT);
----

# Get the number of vertexes in the graph.
exec-ddl
CREATE FUNCTION vertexes() RETURNS INT AS $$ SELECT max(greatest(a, b)) + 1 FROM edges $$ LANGUAGE SQL;
----

# Get the maximum int32 value.
exec-ddl
CREATE FUNCTION max_int() RETURNS INT AS $$ SELECT 2147483647 $$ LANGUAGE SQL;
----

# Get the weight of the edge between the two given nodes, if any.
exec-ddl
CREATE FUNCTION graph(x INT, y INT) RETURNS INT AS $$
  SELECT coalesce((SELECT weight FROM edges WHERE (a = x AND b = y) OR (a = y AND b = x) LIMIT 1), 0);
$$ LANGUAGE SQL;
----

# Replace the element at the given index of the array with the given value.
exec-ddl
CREATE FUNCTION replace_arr(arr INT[], idx INT, val INT) RETURNS INT[] AS $$
  DECLARE
    i INT;
    n INT := array_length(arr, 1);
    res INT[] := ARRAY[]::INT[];
  BEGIN
    i := 0;
    LOOP
      IF i = idx THEN
        res := res || val;
      ELSE
        res := res || arr[i+1];
      END IF;
    i := i + 1;
    IF i >= n THEN EXIT; END IF;
    END LOOP;
    RETURN res;
  END
$$ LANGUAGE PLpgSQL;
----

# Return the node with the minimum distance from the source node known so far
# out of the nodes that don't already have a shortest path calculated.
exec-ddl
CREATE FUNCTION min_distance(dist INT[], spt_set INT[]) RETURNS INT AS $$
  DECLARE
    n INT := vertexes();
    i INT;
    min INT := max_int();
    min_index INT := 0;
  BEGIN
    i := 0;
    LOOP
      IF spt_set[i+1] = 0 AND dist[i+1] <= min THEN
        min := dist[i+1];
        min_index := i;
      END IF;
    i := i + 1;
    IF i >= n THEN EXIT; END IF;
    END LOOP;
    RETURN min_index;
  END
$$ LANGUAGE PLPGSQL;
----

# Implement dijkstra's algorithm using the "edges" table.
exec-ddl
CREATE FUNCTION dijkstra(src INT) RETURNS INT[] AS $$
  DECLARE
    n INT := vertexes();
    i INT;
    count INT;
    dist INT[] := ARRAY[]::INT[];
    spt_set INT[] := ARRAY[]::INT[];
    u INT;
  BEGIN
    i := 0;
    LOOP
      dist := dist || max_int();
      spt_set := spt_set || 0;
      i := i + 1;
      IF i >= n THEN EXIT; END IF;
    END LOOP;
    dist := replace_arr(dist, src, 0);
    count := 0;
    LOOP
      u := min_distance(dist, spt_set);
      spt_set := replace_arr(spt_set, u, 1);
      i := 0;
      LOOP
        IF
          spt_set[i+1] = 0 AND
          graph(u, i) > 0 AND
          dist[u+1] <> max_int() AND
          dist[u+1] + graph(u, i) < dist[i+1]
        THEN
          dist := replace_arr(dist, i, dist[u+1] + graph(u, i));
        END IF;
      i := i + 1;
      IF i >= n THEN EXIT; END IF;
      END LOOP;
    count := count + 1;
    IF count >= n THEN EXIT; END IF;
    END LOOP;
    RETURN dist;
  END
$$ LANGUAGE PLPGSQL;
----

# Run dijkstra's algorithm using node 0 as the source.
build format=show-scalars
SELECT i AS "Vertex", dist[i+1] AS "Distance From Source"
FROM generate_series(0, vertexes() - 1) f(i), dijkstra(0) g(dist);
----
project
 ├── columns: Vertex:10 "Distance From Source":288
 ├── inner-join-apply
 │    ├── columns: generate_series:10 dijkstra:287
 │    ├── project-set
 │    │    ├── columns: generate_series:10
 │    │    ├── values
 │    │    │    └── tuple
 │    │    └── zip
 │    │         └── function: generate_series
 │    │              ├── const: 0
 │    │              └── minus
 │    │                   ├── udf: vertexes
 │    │                   │    └── body
 │    │                   │         └── limit
 │    │                   │              ├── columns: "?column?":9
 │    │                   │              ├── project
 │    │                   │              │    ├── columns: "?column?":9
 │    │                   │              │    ├── scalar-group-by
 │    │                   │              │    │    ├── columns: max:8
 │    │                   │              │    │    ├── project
 │    │                   │              │    │    │    ├── columns: column7:7
 │    │                   │              │    │    │    ├── scan edges
 │    │                   │              │    │    │    │    └── columns: a:1 b:2 weight:3 rowid:4!null crdb_internal_mvcc_timestamp:5 tableoid:6
 │    │                   │              │    │    │    └── projections
 │    │                   │              │    │    │         └── function: greatest [as=column7:7]
 │    │                   │              │    │    │              ├── variable: a:1
 │    │                   │              │    │    │              └── variable: b:2
 │    │                   │              │    │    └── aggregations
 │    │                   │              │    │         └── max [as=max:8]
 │    │                   │              │    │              └── variable: column7:7
 │    │                   │              │    └── projections
 │    │                   │              │         └── plus [as="?column?":9]
 │    │                   │              │              ├── variable: max:8
 │    │                   │              │              └── const: 1
 │    │                   │              └── const: 1
 │    │                   └── const: 1
 │    ├── project-set
 │    │    ├── columns: dijkstra:287
 │    │    ├── values
 │    │    │    └── tuple
 │    │    └── zip
 │    │         └── udf: dijkstra
 │    │              ├── args
 │    │              │    └── const: 0
 │    │              ├── params: src:11
 │    │              └── body
 │    │                   └── limit
 │    │                        ├── columns: stmt_loop_11:286
 │    │                        ├── project
 │    │                        │    ├── columns: stmt_loop_11:286
 │    │                        │    ├── project
 │    │                        │    │    ├── columns: i:27!null n:21 count:23 dist:24!null spt_set:25!null u:26
 │    │                        │    │    ├── project
 │    │                        │    │    │    ├── columns: u:26 n:21 i:22 count:23 dist:24!null spt_set:25!null
 │    │                        │    │    │    ├── project
 │    │                        │    │    │    │    ├── columns: spt_set:25!null n:21 i:22 count:23 dist:24!null
 │    │                        │    │    │    │    ├── project
 │    │                        │    │    │    │    │    ├── columns: dist:24!null n:21 i:22 count:23
 │    │                        │    │    │    │    │    ├── project
 │    │                        │    │    │    │    │    │    ├── columns: count:23 n:21 i:22
 │    │                        │    │    │    │    │    │    ├── project
 │    │                        │    │    │    │    │    │    │    ├── columns: i:22 n:21
 │    │                        │    │    │    │    │    │    │    ├── project
 │    │                        │    │    │    │    │    │    │    │    ├── columns: n:21
 │    │                        │    │    │    │    │    │    │    │    ├── values
 │    │                        │    │    │    │    │    │    │    │    │    └── tuple
 │    │                        │    │    │    │    │    │    │    │    └── projections
 │    │                        │    │    │    │    │    │    │    │         └── udf: vertexes [as=n:21]
 │    │                        │    │    │    │    │    │    │    │              └── body
 │    │                        │    │    │    │    │    │    │    │                   └── limit
 │    │                        │    │    │    │    │    │    │    │                        ├── columns: "?column?":20
 │    │                        │    │    │    │    │    │    │    │                        ├── project
 │    │                        │    │    │    │    │    │    │    │                        │    ├── columns: "?column?":20
 │    │                        │    │    │    │    │    │    │    │                        │    ├── scalar-group-by
 │    │                        │    │    │    │    │    │    │    │                        │    │    ├── columns: max:19
 │    │                        │    │    │    │    │    │    │    │                        │    │    ├── project
 │    │                        │    │    │    │    │    │    │    │                        │    │    │    ├── columns: column18:18
 │    │                        │    │    │    │    │    │    │    │                        │    │    │    ├── scan edges
 │    │                        │    │    │    │    │    │    │    │                        │    │    │    │    └── columns: a:12 b:13 weight:14 rowid:15!null crdb_internal_mvcc_timestamp:16 tableoid:17
 │    │                        │    │    │    │    │    │    │    │                        │    │    │    └── projections
 │    │                        │    │    │    │    │    │    │    │                        │    │    │         └── function: greatest [as=column18:18]
 │    │                        │    │    │    │    │    │    │    │                        │    │    │              ├── variable: a:12
 │    │                        │    │    │    │    │    │    │    │                        │    │    │              └── variable: b:13
 │    │                        │    │    │    │    │    │    │    │                        │    │    └── aggregations
 │    │                        │    │    │    │    │    │    │    │                        │    │         └── max [as=max:19]
 │    │                        │    │    │    │    │    │    │    │                        │    │              └── variable: column18:18
 │    │                        │    │    │    │    │    │    │    │                        │    └── projections
 │    │                        │    │    │    │    │    │    │    │                        │         └── plus [as="?column?":20]
 │    │                        │    │    │    │    │    │    │    │                        │              ├── variable: max:19
 │    │                        │    │    │    │    │    │    │    │                        │              └── const: 1
 │    │                        │    │    │    │    │    │    │    │                        └── const: 1
 │    │                        │    │    │    │    │    │    │    └── projections
 │    │                        │    │    │    │    │    │    │         └── cast: INT8 [as=i:22]
 │    │                        │    │    │    │    │    │    │              └── null
 │    │                        │    │    │    │    │    │    └── projections
 │    │                        │    │    │    │    │    │         └── cast: INT8 [as=count:23]
 │    │                        │    │    │    │    │    │              └── null
 │    │                        │    │    │    │    │    └── projections
 │    │                        │    │    │    │    │         └── array: [as=dist:24]
 │    │                        │    │    │    │    └── projections
 │    │                        │    │    │    │         └── array: [as=spt_set:25]
 │    │                        │    │    │    └── projections
 │    │                        │    │    │         └── cast: INT8 [as=u:26]
 │    │                        │    │    │              └── null
 │    │                        │    │    └── projections
 │    │                        │    │         └── const: 0 [as=i:27]
 │    │                        │    └── projections
 │    │                        │         └── udf: stmt_loop_11 [as=stmt_loop_11:286]
 │    │                        │              ├── args
 │    │                        │              │    ├── variable: n:21
 │    │                        │              │    ├── variable: i:27
 │    │                        │              │    ├── variable: count:23
 │    │                        │              │    ├── variable: dist:24
 │    │                        │              │    ├── variable: spt_set:25
 │    │                        │              │    ├── variable: u:26
 │    │                        │              │    └── variable: src:11
 │    │                        │              ├── params: n:272 i:273 count:274 dist:275 spt_set:276 u:277 src:278
 │    │                        │              └── body
 │    │                        │                   └── project
 │    │                        │                        ├── columns: stmt_if_12:285
 │    │                        │                        ├── project
 │    │                        │                        │    ├── columns: i:282 dist:280 spt_set:281
 │    │                        │                        │    ├── project
 │    │                        │                        │    │    ├── columns: spt_set:281 dist:280
 │    │                        │                        │    │    ├── project
 │    │                        │                        │    │    │    ├── columns: dist:280
 │    │                        │                        │    │    │    ├── values
 │    │                        │                        │    │    │    │    └── tuple
 │    │                        │                        │    │    │    └── projections
 │    │                        │                        │    │    │         └── concat [as=dist:280]
 │    │                        │                        │    │    │              ├── variable: dist:275
 │    │                        │                        │    │    │              └── udf: max_int
 │    │                        │                        │    │    │                   └── body
 │    │                        │                        │    │    │                        └── limit
 │    │                        │                        │    │    │                             ├── columns: "?column?":279!null
 │    │                        │                        │    │    │                             ├── project
 │    │                        │                        │    │    │                             │    ├── columns: "?column?":279!null
 │    │                        │                        │    │    │                             │    ├── values
 │    │                        │                        │    │    │                             │    │    └── tuple
 │    │                        │                        │    │    │                             │    └── projections
 │    │                        │                        │    │    │                             │         └── const: 2147483647 [as="?column?":279]
 │    │                        │                        │    │    │                             └── const: 1
 │    │                        │                        │    │    └── projections
 │    │                        │                        │    │         └── concat [as=spt_set:281]
 │    │                        │                        │    │              ├── variable: spt_set:276
 │    │                        │                        │    │              └── const: 0
 │    │                        │                        │    └── projections
 │    │                        │                        │         └── plus [as=i:282]
 │    │                        │                        │              ├── variable: i:273
 │    │                        │                        │              └── const: 1
 │    │                        │                        └── projections
 │    │                        │                             └── case [as=stmt_if_12:285]
 │    │                        │                                  ├── true
 │    │                        │                                  ├── when
 │    │                        │                                  │    ├── ge
 │    │                        │                                  │    │    ├── variable: i:282
 │    │                        │                                  │    │    └── variable: n:272
 │    │                        │                                  │    └── subquery
 │    │                        │                                  │         └── project
 │    │                        │                                  │              ├── columns: loop_exit_1:283
 │    │                        │                                  │              ├── values
 │    │                        │                                  │              │    └── tuple
 │    │                        │                                  │              └── projections
 │    │                        │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:283]
 │    │                        │                                  │                        ├── args
 │    │                        │                                  │                        │    ├── variable: n:272
 │    │                        │                                  │                        │    ├── variable: i:282
 │    │                        │                                  │                        │    ├── variable: count:274
 │    │                        │                                  │                        │    ├── variable: dist:280
 │    │                        │                                  │                        │    ├── variable: spt_set:281
 │    │                        │                                  │                        │    ├── variable: u:277
 │    │                        │                                  │                        │    └── variable: src:278
 │    │                        │                                  │                        ├── params: n:28 i:29 count:30 dist:31 spt_set:32 u:33 src:34
 │    │                        │                                  │                        └── body
 │    │                        │                                  │                             └── project
 │    │                        │                                  │                                  ├── columns: stmt_loop_4:271
 │    │                        │                                  │                                  ├── project
 │    │                        │                                  │                                  │    ├── columns: count:72!null dist:71
 │    │                        │                                  │                                  │    ├── project
 │    │                        │                                  │                                  │    │    ├── columns: dist:71
 │    │                        │                                  │                                  │    │    ├── values
 │    │                        │                                  │                                  │    │    │    └── tuple
 │    │                        │                                  │                                  │    │    └── projections
 │    │                        │                                  │                                  │    │         └── udf: replace_arr [as=dist:71]
 │    │                        │                                  │                                  │    │              ├── args
 │    │                        │                                  │                                  │    │              │    ├── variable: dist:31
 │    │                        │                                  │                                  │    │              │    ├── variable: src:34
 │    │                        │                                  │                                  │    │              │    └── const: 0
 │    │                        │                                  │                                  │    │              ├── params: arr:35 idx:36 val:37
 │    │                        │                                  │                                  │    │              └── body
 │    │                        │                                  │                                  │    │                   └── limit
 │    │                        │                                  │                                  │    │                        ├── columns: stmt_loop_3:70
 │    │                        │                                  │                                  │    │                        ├── project
 │    │                        │                                  │                                  │    │                        │    ├── columns: stmt_loop_3:70
 │    │                        │                                  │                                  │    │                        │    ├── project
 │    │                        │                                  │                                  │    │                        │    │    ├── columns: i:41!null n:39 res:40!null
 │    │                        │                                  │                                  │    │                        │    │    ├── project
 │    │                        │                                  │                                  │    │                        │    │    │    ├── columns: res:40!null i:38 n:39
 │    │                        │                                  │                                  │    │                        │    │    │    ├── project
 │    │                        │                                  │                                  │    │                        │    │    │    │    ├── columns: n:39 i:38
 │    │                        │                                  │                                  │    │                        │    │    │    │    ├── project
 │    │                        │                                  │                                  │    │                        │    │    │    │    │    ├── columns: i:38
 │    │                        │                                  │                                  │    │                        │    │    │    │    │    ├── values
 │    │                        │                                  │                                  │    │                        │    │    │    │    │    │    └── tuple
 │    │                        │                                  │                                  │    │                        │    │    │    │    │    └── projections
 │    │                        │                                  │                                  │    │                        │    │    │    │    │         └── cast: INT8 [as=i:38]
 │    │                        │                                  │                                  │    │                        │    │    │    │    │              └── null
 │    │                        │                                  │                                  │    │                        │    │    │    │    └── projections
 │    │                        │                                  │                                  │    │                        │    │    │    │         └── function: array_length [as=n:39]
 │    │                        │                                  │                                  │    │                        │    │    │    │              ├── variable: arr:35
 │    │                        │                                  │                                  │    │                        │    │    │    │              └── const: 1
 │    │                        │                                  │                                  │    │                        │    │    │    └── projections
 │    │                        │                                  │                                  │    │                        │    │    │         └── array: [as=res:40]
 │    │                        │                                  │                                  │    │                        │    │    └── projections
 │    │                        │                                  │                                  │    │                        │    │         └── const: 0 [as=i:41]
 │    │                        │                                  │                                  │    │                        │    └── projections
 │    │                        │                                  │                                  │    │                        │         └── udf: stmt_loop_3 [as=stmt_loop_3:70]
 │    │                        │                                  │                                  │    │                        │              ├── args
 │    │                        │                                  │                                  │    │                        │              │    ├── variable: i:41
 │    │                        │                                  │                                  │    │                        │              │    ├── variable: n:39
 │    │                        │                                  │                                  │    │                        │              │    ├── variable: res:40
 │    │                        │                                  │                                  │    │                        │              │    ├── variable: arr:35
 │    │                        │                                  │                                  │    │                        │              │    ├── variable: idx:36
 │    │                        │                                  │                                  │    │                        │              │    └── variable: val:37
 │    │                        │                                  │                                  │    │                        │              ├── params: i:49 n:50 res:51 arr:52 idx:53 val:54
 │    │                        │                                  │                                  │    │                        │              └── body
 │    │                        │                                  │                                  │    │                        │                   └── project
 │    │                        │                                  │                                  │    │                        │                        ├── columns: stmt_if_6:69
 │    │                        │                                  │                                  │    │                        │                        ├── values
 │    │                        │                                  │                                  │    │                        │                        │    └── tuple
 │    │                        │                                  │                                  │    │                        │                        └── projections
 │    │                        │                                  │                                  │    │                        │                             └── case [as=stmt_if_6:69]
 │    │                        │                                  │                                  │    │                        │                                  ├── true
 │    │                        │                                  │                                  │    │                        │                                  ├── when
 │    │                        │                                  │                                  │    │                        │                                  │    ├── eq
 │    │                        │                                  │                                  │    │                        │                                  │    │    ├── variable: i:49
 │    │                        │                                  │                                  │    │                        │                                  │    │    └── variable: idx:53
 │    │                        │                                  │                                  │    │                        │                                  │    └── subquery
 │    │                        │                                  │                                  │    │                        │                                  │         └── project
 │    │                        │                                  │                                  │    │                        │                                  │              ├── columns: stmt_if_4:66
 │    │                        │                                  │                                  │    │                        │                                  │              ├── project
 │    │                        │                                  │                                  │    │                        │                                  │              │    ├── columns: res:65
 │    │                        │                                  │                                  │    │                        │                                  │              │    ├── values
 │    │                        │                                  │                                  │    │                        │                                  │              │    │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                  │              │    └── projections
 │    │                        │                                  │                                  │    │                        │                                  │              │         └── concat [as=res:65]
 │    │                        │                                  │                                  │    │                        │                                  │              │              ├── variable: res:51
 │    │                        │                                  │                                  │    │                        │                                  │              │              └── variable: val:54
 │    │                        │                                  │                                  │    │                        │                                  │              └── projections
 │    │                        │                                  │                                  │    │                        │                                  │                   └── udf: stmt_if_4 [as=stmt_if_4:66]
 │    │                        │                                  │                                  │    │                        │                                  │                        ├── args
 │    │                        │                                  │                                  │    │                        │                                  │                        │    ├── variable: i:49
 │    │                        │                                  │                                  │    │                        │                                  │                        │    ├── variable: n:50
 │    │                        │                                  │                                  │    │                        │                                  │                        │    ├── variable: res:65
 │    │                        │                                  │                                  │    │                        │                                  │                        │    ├── variable: arr:52
 │    │                        │                                  │                                  │    │                        │                                  │                        │    ├── variable: idx:53
 │    │                        │                                  │                                  │    │                        │                                  │                        │    └── variable: val:54
 │    │                        │                                  │                                  │    │                        │                                  │                        ├── params: i:55 n:56 res:57 arr:58 idx:59 val:60
 │    │                        │                                  │                                  │    │                        │                                  │                        └── body
 │    │                        │                                  │                                  │    │                        │                                  │                             └── project
 │    │                        │                                  │                                  │    │                        │                                  │                                  ├── columns: stmt_if_5:64
 │    │                        │                                  │                                  │    │                        │                                  │                                  ├── project
 │    │                        │                                  │                                  │    │                        │                                  │                                  │    ├── columns: i:61
 │    │                        │                                  │                                  │    │                        │                                  │                                  │    ├── values
 │    │                        │                                  │                                  │    │                        │                                  │                                  │    │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                  │                                  │    └── projections
 │    │                        │                                  │                                  │    │                        │                                  │                                  │         └── plus [as=i:61]
 │    │                        │                                  │                                  │    │                        │                                  │                                  │              ├── variable: i:55
 │    │                        │                                  │                                  │    │                        │                                  │                                  │              └── const: 1
 │    │                        │                                  │                                  │    │                        │                                  │                                  └── projections
 │    │                        │                                  │                                  │    │                        │                                  │                                       └── case [as=stmt_if_5:64]
 │    │                        │                                  │                                  │    │                        │                                  │                                            ├── true
 │    │                        │                                  │                                  │    │                        │                                  │                                            ├── when
 │    │                        │                                  │                                  │    │                        │                                  │                                            │    ├── ge
 │    │                        │                                  │                                  │    │                        │                                  │                                            │    │    ├── variable: i:61
 │    │                        │                                  │                                  │    │                        │                                  │                                            │    │    └── variable: n:56
 │    │                        │                                  │                                  │    │                        │                                  │                                            │    └── subquery
 │    │                        │                                  │                                  │    │                        │                                  │                                            │         └── project
 │    │                        │                                  │                                  │    │                        │                                  │                                            │              ├── columns: loop_exit_1:62
 │    │                        │                                  │                                  │    │                        │                                  │                                            │              ├── values
 │    │                        │                                  │                                  │    │                        │                                  │                                            │              │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                  │                                            │              └── projections
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                   └── udf: loop_exit_1 [as=loop_exit_1:62]
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                        ├── args
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                        │    ├── variable: i:61
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                        │    ├── variable: n:56
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                        │    ├── variable: res:57
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                        │    ├── variable: arr:58
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                        │    ├── variable: idx:59
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                        │    └── variable: val:60
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                        ├── params: i:42 n:43 res:44 arr:45 idx:46 val:47
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                        └── body
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                             └── project
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                                  ├── columns: stmt_return_2:48
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                                  ├── values
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                                  │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                                  └── projections
 │    │                        │                                  │                                  │    │                        │                                  │                                            │                                       └── variable: res:44 [as=stmt_return_2:48]
 │    │                        │                                  │                                  │    │                        │                                  │                                            └── subquery
 │    │                        │                                  │                                  │    │                        │                                  │                                                 └── project
 │    │                        │                                  │                                  │    │                        │                                  │                                                      ├── columns: stmt_loop_3:63
 │    │                        │                                  │                                  │    │                        │                                  │                                                      ├── values
 │    │                        │                                  │                                  │    │                        │                                  │                                                      │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                  │                                                      └── projections
 │    │                        │                                  │                                  │    │                        │                                  │                                                           └── udf: stmt_loop_3 [as=stmt_loop_3:63]
 │    │                        │                                  │                                  │    │                        │                                  │                                                                ├── args
 │    │                        │                                  │                                  │    │                        │                                  │                                                                │    ├── variable: i:61
 │    │                        │                                  │                                  │    │                        │                                  │                                                                │    ├── variable: n:56
 │    │                        │                                  │                                  │    │                        │                                  │                                                                │    ├── variable: res:57
 │    │                        │                                  │                                  │    │                        │                                  │                                                                │    ├── variable: arr:58
 │    │                        │                                  │                                  │    │                        │                                  │                                                                │    ├── variable: idx:59
 │    │                        │                                  │                                  │    │                        │                                  │                                                                │    └── variable: val:60
 │    │                        │                                  │                                  │    │                        │                                  │                                                                └── recursive-call
 │    │                        │                                  │                                  │    │                        │                                  └── subquery
 │    │                        │                                  │                                  │    │                        │                                       └── project
 │    │                        │                                  │                                  │    │                        │                                            ├── columns: stmt_if_4:68
 │    │                        │                                  │                                  │    │                        │                                            ├── project
 │    │                        │                                  │                                  │    │                        │                                            │    ├── columns: res:67
 │    │                        │                                  │                                  │    │                        │                                            │    ├── values
 │    │                        │                                  │                                  │    │                        │                                            │    │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                            │    └── projections
 │    │                        │                                  │                                  │    │                        │                                            │         └── concat [as=res:67]
 │    │                        │                                  │                                  │    │                        │                                            │              ├── variable: res:51
 │    │                        │                                  │                                  │    │                        │                                            │              └── indirection
 │    │                        │                                  │                                  │    │                        │                                            │                   ├── variable: arr:52
 │    │                        │                                  │                                  │    │                        │                                            │                   └── plus
 │    │                        │                                  │                                  │    │                        │                                            │                        ├── variable: i:49
 │    │                        │                                  │                                  │    │                        │                                            │                        └── const: 1
 │    │                        │                                  │                                  │    │                        │                                            └── projections
 │    │                        │                                  │                                  │    │                        │                                                 └── udf: stmt_if_4 [as=stmt_if_4:68]
 │    │                        │                                  │                                  │    │                        │                                                      ├── args
 │    │                        │                                  │                                  │    │                        │                                                      │    ├── variable: i:49
 │    │                        │                                  │                                  │    │                        │                                                      │    ├── variable: n:50
 │    │                        │                                  │                                  │    │                        │                                                      │    ├── variable: res:67
 │    │                        │                                  │                                  │    │                        │                                                      │    ├── variable: arr:52
 │    │                        │                                  │                                  │    │                        │                                                      │    ├── variable: idx:53
 │    │                        │                                  │                                  │    │                        │                                                      │    └── variable: val:54
 │    │                        │                                  │                                  │    │                        │                                                      ├── params: i:55 n:56 res:57 arr:58 idx:59 val:60
 │    │                        │                                  │                                  │    │                        │                                                      └── body
 │    │                        │                                  │                                  │    │                        │                                                           └── project
 │    │                        │                                  │                                  │    │                        │                                                                ├── columns: stmt_if_5:64
 │    │                        │                                  │                                  │    │                        │                                                                ├── project
 │    │                        │                                  │                                  │    │                        │                                                                │    ├── columns: i:61
 │    │                        │                                  │                                  │    │                        │                                                                │    ├── values
 │    │                        │                                  │                                  │    │                        │                                                                │    │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                                                │    └── projections
 │    │                        │                                  │                                  │    │                        │                                                                │         └── plus [as=i:61]
 │    │                        │                                  │                                  │    │                        │                                                                │              ├── variable: i:55
 │    │                        │                                  │                                  │    │                        │                                                                │              └── const: 1
 │    │                        │                                  │                                  │    │                        │                                                                └── projections
 │    │                        │                                  │                                  │    │                        │                                                                     └── case [as=stmt_if_5:64]
 │    │                        │                                  │                                  │    │                        │                                                                          ├── true
 │    │                        │                                  │                                  │    │                        │                                                                          ├── when
 │    │                        │                                  │                                  │    │                        │                                                                          │    ├── ge
 │    │                        │                                  │                                  │    │                        │                                                                          │    │    ├── variable: i:61
 │    │                        │                                  │                                  │    │                        │                                                                          │    │    └── variable: n:56
 │    │                        │                                  │                                  │    │                        │                                                                          │    └── subquery
 │    │                        │                                  │                                  │    │                        │                                                                          │         └── project
 │    │                        │                                  │                                  │    │                        │                                                                          │              ├── columns: loop_exit_1:62
 │    │                        │                                  │                                  │    │                        │                                                                          │              ├── values
 │    │                        │                                  │                                  │    │                        │                                                                          │              │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                                                          │              └── projections
 │    │                        │                                  │                                  │    │                        │                                                                          │                   └── udf: loop_exit_1 [as=loop_exit_1:62]
 │    │                        │                                  │                                  │    │                        │                                                                          │                        ├── args
 │    │                        │                                  │                                  │    │                        │                                                                          │                        │    ├── variable: i:61
 │    │                        │                                  │                                  │    │                        │                                                                          │                        │    ├── variable: n:56
 │    │                        │                                  │                                  │    │                        │                                                                          │                        │    ├── variable: res:57
 │    │                        │                                  │                                  │    │                        │                                                                          │                        │    ├── variable: arr:58
 │    │                        │                                  │                                  │    │                        │                                                                          │                        │    ├── variable: idx:59
 │    │                        │                                  │                                  │    │                        │                                                                          │                        │    └── variable: val:60
 │    │                        │                                  │                                  │    │                        │                                                                          │                        ├── params: i:42 n:43 res:44 arr:45 idx:46 val:47
 │    │                        │                                  │                                  │    │                        │                                                                          │                        └── body
 │    │                        │                                  │                                  │    │                        │                                                                          │                             └── project
 │    │                        │                                  │                                  │    │                        │                                                                          │                                  ├── columns: stmt_return_2:48
 │    │                        │                                  │                                  │    │                        │                                                                          │                                  ├── values
 │    │                        │                                  │                                  │    │                        │                                                                          │                                  │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                                                          │                                  └── projections
 │    │                        │                                  │                                  │    │                        │                                                                          │                                       └── variable: res:44 [as=stmt_return_2:48]
 │    │                        │                                  │                                  │    │                        │                                                                          └── subquery
 │    │                        │                                  │                                  │    │                        │                                                                               └── project
 │    │                        │                                  │                                  │    │                        │                                                                                    ├── columns: stmt_loop_3:63
 │    │                        │                                  │                                  │    │                        │                                                                                    ├── values
 │    │                        │                                  │                                  │    │                        │                                                                                    │    └── tuple
 │    │                        │                                  │                                  │    │                        │                                                                                    └── projections
 │    │                        │                                  │                                  │    │                        │                                                                                         └── udf: stmt_loop_3 [as=stmt_loop_3:63]
 │    │                        │                                  │                                  │    │                        │                                                                                              ├── args
 │    │                        │                                  │                                  │    │                        │                                                                                              │    ├── variable: i:61
 │    │                        │                                  │                                  │    │                        │                                                                                              │    ├── variable: n:56
 │    │                        │                                  │                                  │    │                        │                                                                                              │    ├── variable: res:57
 │    │                        │                                  │                                  │    │                        │                                                                                              │    ├── variable: arr:58
 │    │                        │                                  │                                  │    │                        │                                                                                              │    ├── variable: idx:59
 │    │                        │                                  │                                  │    │                        │                                                                                              │    └── variable: val:60
 │    │                        │                                  │                                  │    │                        │                                                                                              └── recursive-call
 │    │                        │                                  │                                  │    │                        └── const: 1
 │    │                        │                                  │                                  │    └── projections
 │    │                        │                                  │                                  │         └── const: 0 [as=count:72]
 │    │                        │                                  │                                  └── projections
 │    │                        │                                  │                                       └── udf: stmt_loop_4 [as=stmt_loop_4:271]
 │    │                        │                                  │                                            ├── args
 │    │                        │                                  │                                            │    ├── variable: n:28
 │    │                        │                                  │                                            │    ├── variable: i:29
 │    │                        │                                  │                                            │    ├── variable: count:72
 │    │                        │                                  │                                            │    ├── variable: dist:71
 │    │                        │                                  │                                            │    ├── variable: spt_set:32
 │    │                        │                                  │                                            │    ├── variable: u:33
 │    │                        │                                  │                                            │    └── variable: src:34
 │    │                        │                                  │                                            ├── params: n:81 i:82 count:83 dist:84 spt_set:85 u:86 src:87
 │    │                        │                                  │                                            └── body
 │    │                        │                                  │                                                 └── project
 │    │                        │                                  │                                                      ├── columns: stmt_loop_7:270
 │    │                        │                                  │                                                      ├── project
 │    │                        │                                  │                                                      │    ├── columns: i:172!null u:134 spt_set:171
 │    │                        │                                  │                                                      │    ├── project
 │    │                        │                                  │                                                      │    │    ├── columns: spt_set:171 u:134
 │    │                        │                                  │                                                      │    │    ├── project
 │    │                        │                                  │                                                      │    │    │    ├── columns: u:134
 │    │                        │                                  │                                                      │    │    │    ├── values
 │    │                        │                                  │                                                      │    │    │    │    └── tuple
 │    │                        │                                  │                                                      │    │    │    └── projections
 │    │                        │                                  │                                                      │    │    │         └── udf: min_distance [as=u:134]
 │    │                        │                                  │                                                      │    │    │              ├── args
 │    │                        │                                  │                                                      │    │    │              │    ├── variable: dist:84
 │    │                        │                                  │                                                      │    │    │              │    └── variable: spt_set:85
 │    │                        │                                  │                                                      │    │    │              ├── params: dist:88 spt_set:89
 │    │                        │                                  │                                                      │    │    │              └── body
 │    │                        │                                  │                                                      │    │    │                   └── limit
 │    │                        │                                  │                                                      │    │    │                        ├── columns: stmt_loop_3:133
 │    │                        │                                  │                                                      │    │    │                        ├── project
 │    │                        │                                  │                                                      │    │    │                        │    ├── columns: stmt_loop_3:133
 │    │                        │                                  │                                                      │    │    │                        │    ├── project
 │    │                        │                                  │                                                      │    │    │                        │    │    ├── columns: i:104!null n:99 min:102 min_index:103!null
 │    │                        │                                  │                                                      │    │    │                        │    │    ├── project
 │    │                        │                                  │                                                      │    │    │                        │    │    │    ├── columns: min_index:103!null n:99 i:100 min:102
 │    │                        │                                  │                                                      │    │    │                        │    │    │    ├── project
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    ├── columns: min:102 n:99 i:100
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    ├── project
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    ├── columns: i:100 n:99
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    ├── project
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │    ├── columns: n:99
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │    ├── values
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │    │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │         └── udf: vertexes [as=n:99]
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │              └── body
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                   └── limit
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        ├── columns: "?column?":98
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        ├── project
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    ├── columns: "?column?":98
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    ├── scalar-group-by
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    ├── columns: max:97
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    ├── project
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    │    ├── columns: column96:96
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    │    ├── scan edges
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    │    │    └── columns: a:90 b:91 weight:92 rowid:93!null crdb_internal_mvcc_timestamp:94 tableoid:95
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    │         └── function: greatest [as=column96:96]
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    │              ├── variable: a:90
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    │              └── variable: b:91
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │    └── aggregations
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │         └── max [as=max:97]
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    │              └── variable: column96:96
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │         └── plus [as="?column?":98]
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │              ├── variable: max:97
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        │              └── const: 1
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    │                        └── const: 1
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │         └── cast: INT8 [as=i:100]
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    │              └── null
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │         └── udf: max_int [as=min:102]
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │              └── body
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │                   └── limit
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │                        ├── columns: "?column?":101!null
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │                        ├── project
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │                        │    ├── columns: "?column?":101!null
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │                        │    ├── values
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │                        │    │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │                        │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │                        │         └── const: 2147483647 [as="?column?":101]
 │    │                        │                                  │                                                      │    │    │                        │    │    │    │                        └── const: 1
 │    │                        │                                  │                                                      │    │    │                        │    │    │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │    │    │         └── const: 0 [as=min_index:103]
 │    │                        │                                  │                                                      │    │    │                        │    │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │    │         └── const: 0 [as=i:104]
 │    │                        │                                  │                                                      │    │    │                        │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │         └── udf: stmt_loop_3 [as=stmt_loop_3:133]
 │    │                        │                                  │                                                      │    │    │                        │              ├── args
 │    │                        │                                  │                                                      │    │    │                        │              │    ├── variable: n:99
 │    │                        │                                  │                                                      │    │    │                        │              │    ├── variable: i:104
 │    │                        │                                  │                                                      │    │    │                        │              │    ├── variable: min:102
 │    │                        │                                  │                                                      │    │    │                        │              │    ├── variable: min_index:103
 │    │                        │                                  │                                                      │    │    │                        │              │    ├── variable: dist:88
 │    │                        │                                  │                                                      │    │    │                        │              │    └── variable: spt_set:89
 │    │                        │                                  │                                                      │    │    │                        │              ├── params: n:112 i:113 min:114 min_index:115 dist:116 spt_set:117
 │    │                        │                                  │                                                      │    │    │                        │              └── body
 │    │                        │                                  │                                                      │    │    │                        │                   └── project
 │    │                        │                                  │                                                      │    │    │                        │                        ├── columns: stmt_if_6:132
 │    │                        │                                  │                                                      │    │    │                        │                        ├── values
 │    │                        │                                  │                                                      │    │    │                        │                        │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                        └── projections
 │    │                        │                                  │                                                      │    │    │                        │                             └── case [as=stmt_if_6:132]
 │    │                        │                                  │                                                      │    │    │                        │                                  ├── true
 │    │                        │                                  │                                                      │    │    │                        │                                  ├── when
 │    │                        │                                  │                                                      │    │    │                        │                                  │    ├── and
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │    ├── eq
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │    │    ├── indirection
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │    │    │    ├── variable: spt_set:117
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │    │    │    └── plus
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │    │    │         ├── variable: i:113
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │    │    │         └── const: 1
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │    │    └── const: 0
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │    └── le
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │         ├── indirection
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │         │    ├── variable: dist:116
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │         │    └── plus
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │         │         ├── variable: i:113
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │         │         └── const: 1
 │    │                        │                                  │                                                      │    │    │                        │                                  │    │         └── variable: min:114
 │    │                        │                                  │                                                      │    │    │                        │                                  │    └── subquery
 │    │                        │                                  │                                                      │    │    │                        │                                  │         └── project
 │    │                        │                                  │                                                      │    │    │                        │                                  │              ├── columns: stmt_if_4:130
 │    │                        │                                  │                                                      │    │    │                        │                                  │              ├── project
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    ├── columns: min_index:129 min:128
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    ├── project
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    │    ├── columns: min:128
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    │    ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    │    │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    │         └── indirection [as=min:128]
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    │              ├── variable: dist:116
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    │              └── plus
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    │                   ├── variable: i:113
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    │                   └── const: 1
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                  │              │         └── variable: i:113 [as=min_index:129]
 │    │                        │                                  │                                                      │    │    │                        │                                  │              └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                  │                   └── udf: stmt_if_4 [as=stmt_if_4:130]
 │    │                        │                                  │                                                      │    │    │                        │                                  │                        ├── args
 │    │                        │                                  │                                                      │    │    │                        │                                  │                        │    ├── variable: n:112
 │    │                        │                                  │                                                      │    │    │                        │                                  │                        │    ├── variable: i:113
 │    │                        │                                  │                                                      │    │    │                        │                                  │                        │    ├── variable: min:128
 │    │                        │                                  │                                                      │    │    │                        │                                  │                        │    ├── variable: min_index:129
 │    │                        │                                  │                                                      │    │    │                        │                                  │                        │    ├── variable: dist:116
 │    │                        │                                  │                                                      │    │    │                        │                                  │                        │    └── variable: spt_set:117
 │    │                        │                                  │                                                      │    │    │                        │                                  │                        ├── params: n:118 i:119 min:120 min_index:121 dist:122 spt_set:123
 │    │                        │                                  │                                                      │    │    │                        │                                  │                        └── body
 │    │                        │                                  │                                                      │    │    │                        │                                  │                             └── project
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  ├── columns: stmt_if_5:127
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  ├── project
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  │    ├── columns: i:124
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  │    ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  │    │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  │         └── plus [as=i:124]
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  │              ├── variable: i:119
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  │              └── const: 1
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                  └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                       └── case [as=stmt_if_5:127]
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            ├── true
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            ├── when
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │    ├── ge
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │    │    ├── variable: i:124
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │    │    └── variable: n:118
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │    └── subquery
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │         └── project
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │              ├── columns: loop_exit_1:125
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │              ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │              │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │              └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                   └── udf: loop_exit_1 [as=loop_exit_1:125]
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                        ├── args
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                        │    ├── variable: n:118
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                        │    ├── variable: i:124
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                        │    ├── variable: min:120
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                        │    ├── variable: min_index:121
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                        │    ├── variable: dist:122
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                        │    └── variable: spt_set:123
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                        ├── params: n:105 i:106 min:107 min_index:108 dist:109 spt_set:110
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                        └── body
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                             └── project
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                                  ├── columns: stmt_return_2:111
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                                  ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                                  │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                                  └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            │                                       └── variable: min_index:108 [as=stmt_return_2:111]
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                            └── subquery
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                 └── project
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                      ├── columns: stmt_loop_3:126
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                      ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                      │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                      └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                           └── udf: stmt_loop_3 [as=stmt_loop_3:126]
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                                ├── args
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                                │    ├── variable: n:118
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                                │    ├── variable: i:124
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                                │    ├── variable: min:120
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                                │    ├── variable: min_index:121
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                                │    ├── variable: dist:122
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                                │    └── variable: spt_set:123
 │    │                        │                                  │                                                      │    │    │                        │                                  │                                                                └── recursive-call
 │    │                        │                                  │                                                      │    │    │                        │                                  └── subquery
 │    │                        │                                  │                                                      │    │    │                        │                                       └── project
 │    │                        │                                  │                                                      │    │    │                        │                                            ├── columns: stmt_if_4:131
 │    │                        │                                  │                                                      │    │    │                        │                                            ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                            │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                            └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                                 └── udf: stmt_if_4 [as=stmt_if_4:131]
 │    │                        │                                  │                                                      │    │    │                        │                                                      ├── args
 │    │                        │                                  │                                                      │    │    │                        │                                                      │    ├── variable: n:112
 │    │                        │                                  │                                                      │    │    │                        │                                                      │    ├── variable: i:113
 │    │                        │                                  │                                                      │    │    │                        │                                                      │    ├── variable: min:114
 │    │                        │                                  │                                                      │    │    │                        │                                                      │    ├── variable: min_index:115
 │    │                        │                                  │                                                      │    │    │                        │                                                      │    ├── variable: dist:116
 │    │                        │                                  │                                                      │    │    │                        │                                                      │    └── variable: spt_set:117
 │    │                        │                                  │                                                      │    │    │                        │                                                      ├── params: n:118 i:119 min:120 min_index:121 dist:122 spt_set:123
 │    │                        │                                  │                                                      │    │    │                        │                                                      └── body
 │    │                        │                                  │                                                      │    │    │                        │                                                           └── project
 │    │                        │                                  │                                                      │    │    │                        │                                                                ├── columns: stmt_if_5:127
 │    │                        │                                  │                                                      │    │    │                        │                                                                ├── project
 │    │                        │                                  │                                                      │    │    │                        │                                                                │    ├── columns: i:124
 │    │                        │                                  │                                                      │    │    │                        │                                                                │    ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                                                │    │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                                                │    └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                                                │         └── plus [as=i:124]
 │    │                        │                                  │                                                      │    │    │                        │                                                                │              ├── variable: i:119
 │    │                        │                                  │                                                      │    │    │                        │                                                                │              └── const: 1
 │    │                        │                                  │                                                      │    │    │                        │                                                                └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                                                     └── case [as=stmt_if_5:127]
 │    │                        │                                  │                                                      │    │    │                        │                                                                          ├── true
 │    │                        │                                  │                                                      │    │    │                        │                                                                          ├── when
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │    ├── ge
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │    │    ├── variable: i:124
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │    │    └── variable: n:118
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │    └── subquery
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │         └── project
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │              ├── columns: loop_exit_1:125
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │              ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │              │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │              └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                   └── udf: loop_exit_1 [as=loop_exit_1:125]
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                        ├── args
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                        │    ├── variable: n:118
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                        │    ├── variable: i:124
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                        │    ├── variable: min:120
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                        │    ├── variable: min_index:121
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                        │    ├── variable: dist:122
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                        │    └── variable: spt_set:123
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                        ├── params: n:105 i:106 min:107 min_index:108 dist:109 spt_set:110
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                        └── body
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                             └── project
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                                  ├── columns: stmt_return_2:111
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                                  ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                                  │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                                  └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                                                          │                                       └── variable: min_index:108 [as=stmt_return_2:111]
 │    │                        │                                  │                                                      │    │    │                        │                                                                          └── subquery
 │    │                        │                                  │                                                      │    │    │                        │                                                                               └── project
 │    │                        │                                  │                                                      │    │    │                        │                                                                                    ├── columns: stmt_loop_3:126
 │    │                        │                                  │                                                      │    │    │                        │                                                                                    ├── values
 │    │                        │                                  │                                                      │    │    │                        │                                                                                    │    └── tuple
 │    │                        │                                  │                                                      │    │    │                        │                                                                                    └── projections
 │    │                        │                                  │                                                      │    │    │                        │                                                                                         └── udf: stmt_loop_3 [as=stmt_loop_3:126]
 │    │                        │                                  │                                                      │    │    │                        │                                                                                              ├── args
 │    │                        │                                  │                                                      │    │    │                        │                                                                                              │    ├── variable: n:118
 │    │                        │                                  │                                                      │    │    │                        │                                                                                              │    ├── variable: i:124
 │    │                        │                                  │                                                      │    │    │                        │                                                                                              │    ├── variable: min:120
 │    │                        │                                  │                                                      │    │    │                        │                                                                                              │    ├── variable: min_index:121
 │    │                        │                                  │                                                      │    │    │                        │                                                                                              │    ├── variable: dist:122
 │    │                        │                                  │                                                      │    │    │                        │                                                                                              │    └── variable: spt_set:123
 │    │                        │                                  │                                                      │    │    │                        │                                                                                              └── recursive-call
 │    │                        │                                  │                                                      │    │    │                        └── const: 1
 │    │                        │                                  │                                                      │    │    └── projections
 │    │                        │                                  │                                                      │    │         └── udf: replace_arr [as=spt_set:171]
 │    │                        │                                  │                                                      │    │              ├── args
 │    │                        │                                  │                                                      │    │              │    ├── variable: spt_set:85
 │    │                        │                                  │                                                      │    │              │    ├── variable: u:134
 │    │                        │                                  │                                                      │    │              │    └── const: 1
 │    │                        │                                  │                                                      │    │              ├── params: arr:135 idx:136 val:137
 │    │                        │                                  │                                                      │    │              └── body
 │    │                        │                                  │                                                      │    │                   └── limit
 │    │                        │                                  │                                                      │    │                        ├── columns: stmt_loop_3:170
 │    │                        │                                  │                                                      │    │                        ├── project
 │    │                        │                                  │                                                      │    │                        │    ├── columns: stmt_loop_3:170
 │    │                        │                                  │                                                      │    │                        │    ├── project
 │    │                        │                                  │                                                      │    │                        │    │    ├── columns: i:141!null n:139 res:140!null
 │    │                        │                                  │                                                      │    │                        │    │    ├── project
 │    │                        │                                  │                                                      │    │                        │    │    │    ├── columns: res:140!null i:138 n:139
 │    │                        │                                  │                                                      │    │                        │    │    │    ├── project
 │    │                        │                                  │                                                      │    │                        │    │    │    │    ├── columns: n:139 i:138
 │    │                        │                                  │                                                      │    │                        │    │    │    │    ├── project
 │    │                        │                                  │                                                      │    │                        │    │    │    │    │    ├── columns: i:138
 │    │                        │                                  │                                                      │    │                        │    │    │    │    │    ├── values
 │    │                        │                                  │                                                      │    │                        │    │    │    │    │    │    └── tuple
 │    │                        │                                  │                                                      │    │                        │    │    │    │    │    └── projections
 │    │                        │                                  │                                                      │    │                        │    │    │    │    │         └── cast: INT8 [as=i:138]
 │    │                        │                                  │                                                      │    │                        │    │    │    │    │              └── null
 │    │                        │                                  │                                                      │    │                        │    │    │    │    └── projections
 │    │                        │                                  │                                                      │    │                        │    │    │    │         └── function: array_length [as=n:139]
 │    │                        │                                  │                                                      │    │                        │    │    │    │              ├── variable: arr:135
 │    │                        │                                  │                                                      │    │                        │    │    │    │              └── const: 1
 │    │                        │                                  │                                                      │    │                        │    │    │    └── projections
 │    │                        │                                  │                                                      │    │                        │    │    │         └── array: [as=res:140]
 │    │                        │                                  │                                                      │    │                        │    │    └── projections
 │    │                        │                                  │                                                      │    │                        │    │         └── const: 0 [as=i:141]
 │    │                        │                                  │                                                      │    │                        │    └── projections
 │    │                        │                                  │                                                      │    │                        │         └── udf: stmt_loop_3 [as=stmt_loop_3:170]
 │    │                        │                                  │                                                      │    │                        │              ├── args
 │    │                        │                                  │                                                      │    │                        │              │    ├── variable: i:141
 │    │                        │                                  │                                                      │    │                        │              │    ├── variable: n:139
 │    │                        │                                  │                                                      │    │                        │              │    ├── variable: res:140
 │    │                        │                                  │                                                      │    │                        │              │    ├── variable: arr:135
 │    │                        │                                  │                                                      │    │                        │              │    ├── variable: idx:136
 │    │                        │                                  │                                                      │    │                        │              │    └── variable: val:137
 │    │                        │                                  │                                                      │    │                        │              ├── params: i:149 n:150 res:151 arr:152 idx:153 val:154
 │    │                        │                                  │                                                      │    │                        │              └── body
 │    │                        │                                  │                                                      │    │                        │                   └── project
 │    │                        │                                  │                                                      │    │                        │                        ├── columns: stmt_if_6:169
 │    │                        │                                  │                                                      │    │                        │                        ├── values
 │    │                        │                                  │                                                      │    │                        │                        │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                        └── projections
 │    │                        │                                  │                                                      │    │                        │                             └── case [as=stmt_if_6:169]
 │    │                        │                                  │                                                      │    │                        │                                  ├── true
 │    │                        │                                  │                                                      │    │                        │                                  ├── when
 │    │                        │                                  │                                                      │    │                        │                                  │    ├── eq
 │    │                        │                                  │                                                      │    │                        │                                  │    │    ├── variable: i:149
 │    │                        │                                  │                                                      │    │                        │                                  │    │    └── variable: idx:153
 │    │                        │                                  │                                                      │    │                        │                                  │    └── subquery
 │    │                        │                                  │                                                      │    │                        │                                  │         └── project
 │    │                        │                                  │                                                      │    │                        │                                  │              ├── columns: stmt_if_4:166
 │    │                        │                                  │                                                      │    │                        │                                  │              ├── project
 │    │                        │                                  │                                                      │    │                        │                                  │              │    ├── columns: res:165
 │    │                        │                                  │                                                      │    │                        │                                  │              │    ├── values
 │    │                        │                                  │                                                      │    │                        │                                  │              │    │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                  │              │    └── projections
 │    │                        │                                  │                                                      │    │                        │                                  │              │         └── concat [as=res:165]
 │    │                        │                                  │                                                      │    │                        │                                  │              │              ├── variable: res:151
 │    │                        │                                  │                                                      │    │                        │                                  │              │              └── variable: val:154
 │    │                        │                                  │                                                      │    │                        │                                  │              └── projections
 │    │                        │                                  │                                                      │    │                        │                                  │                   └── udf: stmt_if_4 [as=stmt_if_4:166]
 │    │                        │                                  │                                                      │    │                        │                                  │                        ├── args
 │    │                        │                                  │                                                      │    │                        │                                  │                        │    ├── variable: i:149
 │    │                        │                                  │                                                      │    │                        │                                  │                        │    ├── variable: n:150
 │    │                        │                                  │                                                      │    │                        │                                  │                        │    ├── variable: res:165
 │    │                        │                                  │                                                      │    │                        │                                  │                        │    ├── variable: arr:152
 │    │                        │                                  │                                                      │    │                        │                                  │                        │    ├── variable: idx:153
 │    │                        │                                  │                                                      │    │                        │                                  │                        │    └── variable: val:154
 │    │                        │                                  │                                                      │    │                        │                                  │                        ├── params: i:155 n:156 res:157 arr:158 idx:159 val:160
 │    │                        │                                  │                                                      │    │                        │                                  │                        └── body
 │    │                        │                                  │                                                      │    │                        │                                  │                             └── project
 │    │                        │                                  │                                                      │    │                        │                                  │                                  ├── columns: stmt_if_5:164
 │    │                        │                                  │                                                      │    │                        │                                  │                                  ├── project
 │    │                        │                                  │                                                      │    │                        │                                  │                                  │    ├── columns: i:161
 │    │                        │                                  │                                                      │    │                        │                                  │                                  │    ├── values
 │    │                        │                                  │                                                      │    │                        │                                  │                                  │    │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                  │                                  │    └── projections
 │    │                        │                                  │                                                      │    │                        │                                  │                                  │         └── plus [as=i:161]
 │    │                        │                                  │                                                      │    │                        │                                  │                                  │              ├── variable: i:155
 │    │                        │                                  │                                                      │    │                        │                                  │                                  │              └── const: 1
 │    │                        │                                  │                                                      │    │                        │                                  │                                  └── projections
 │    │                        │                                  │                                                      │    │                        │                                  │                                       └── case [as=stmt_if_5:164]
 │    │                        │                                  │                                                      │    │                        │                                  │                                            ├── true
 │    │                        │                                  │                                                      │    │                        │                                  │                                            ├── when
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │    ├── ge
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │    │    ├── variable: i:161
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │    │    └── variable: n:156
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │    └── subquery
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │         └── project
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │              ├── columns: loop_exit_1:162
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │              ├── values
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │              │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │              └── projections
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                   └── udf: loop_exit_1 [as=loop_exit_1:162]
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                        ├── args
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                        │    ├── variable: i:161
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                        │    ├── variable: n:156
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                        │    ├── variable: res:157
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                        │    ├── variable: arr:158
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                        │    ├── variable: idx:159
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                        │    └── variable: val:160
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                        ├── params: i:142 n:143 res:144 arr:145 idx:146 val:147
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                        └── body
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                             └── project
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                                  ├── columns: stmt_return_2:148
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                                  ├── values
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                                  │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                                  └── projections
 │    │                        │                                  │                                                      │    │                        │                                  │                                            │                                       └── variable: res:144 [as=stmt_return_2:148]
 │    │                        │                                  │                                                      │    │                        │                                  │                                            └── subquery
 │    │                        │                                  │                                                      │    │                        │                                  │                                                 └── project
 │    │                        │                                  │                                                      │    │                        │                                  │                                                      ├── columns: stmt_loop_3:163
 │    │                        │                                  │                                                      │    │                        │                                  │                                                      ├── values
 │    │                        │                                  │                                                      │    │                        │                                  │                                                      │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                  │                                                      └── projections
 │    │                        │                                  │                                                      │    │                        │                                  │                                                           └── udf: stmt_loop_3 [as=stmt_loop_3:163]
 │    │                        │                                  │                                                      │    │                        │                                  │                                                                ├── args
 │    │                        │                                  │                                                      │    │                        │                                  │                                                                │    ├── variable: i:161
 │    │                        │                                  │                                                      │    │                        │                                  │                                                                │    ├── variable: n:156
 │    │                        │                                  │                                                      │    │                        │                                  │                                                                │    ├── variable: res:157
 │    │                        │                                  │                                                      │    │                        │                                  │                                                                │    ├── variable: arr:158
 │    │                        │                                  │                                                      │    │                        │                                  │                                                                │    ├── variable: idx:159
 │    │                        │                                  │                                                      │    │                        │                                  │                                                                │    └── variable: val:160
 │    │                        │                                  │                                                      │    │                        │                                  │                                                                └── recursive-call
 │    │                        │                                  │                                                      │    │                        │                                  └── subquery
 │    │                        │                                  │                                                      │    │                        │                                       └── project
 │    │                        │                                  │                                                      │    │                        │                                            ├── columns: stmt_if_4:168
 │    │                        │                                  │                                                      │    │                        │                                            ├── project
 │    │                        │                                  │                                                      │    │                        │                                            │    ├── columns: res:167
 │    │                        │                                  │                                                      │    │                        │                                            │    ├── values
 │    │                        │                                  │                                                      │    │                        │                                            │    │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                            │    └── projections
 │    │                        │                                  │                                                      │    │                        │                                            │         └── concat [as=res:167]
 │    │                        │                                  │                                                      │    │                        │                                            │              ├── variable: res:151
 │    │                        │                                  │                                                      │    │                        │                                            │              └── indirection
 │    │                        │                                  │                                                      │    │                        │                                            │                   ├── variable: arr:152
 │    │                        │                                  │                                                      │    │                        │                                            │                   └── plus
 │    │                        │                                  │                                                      │    │                        │                                            │                        ├── variable: i:149
 │    │                        │                                  │                                                      │    │                        │                                            │                        └── const: 1
 │    │                        │                                  │                                                      │    │                        │                                            └── projections
 │    │                        │                                  │                                                      │    │                        │                                                 └── udf: stmt_if_4 [as=stmt_if_4:168]
 │    │                        │                                  │                                                      │    │                        │                                                      ├── args
 │    │                        │                                  │                                                      │    │                        │                                                      │    ├── variable: i:149
 │    │                        │                                  │                                                      │    │                        │                                                      │    ├── variable: n:150
 │    │                        │                                  │                                                      │    │                        │                                                      │    ├── variable: res:167
 │    │                        │                                  │                                                      │    │                        │                                                      │    ├── variable: arr:152
 │    │                        │                                  │                                                      │    │                        │                                                      │    ├── variable: idx:153
 │    │                        │                                  │                                                      │    │                        │                                                      │    └── variable: val:154
 │    │                        │                                  │                                                      │    │                        │                                                      ├── params: i:155 n:156 res:157 arr:158 idx:159 val:160
 │    │                        │                                  │                                                      │    │                        │                                                      └── body
 │    │                        │                                  │                                                      │    │                        │                                                           └── project
 │    │                        │                                  │                                                      │    │                        │                                                                ├── columns: stmt_if_5:164
 │    │                        │                                  │                                                      │    │                        │                                                                ├── project
 │    │                        │                                  │                                                      │    │                        │                                                                │    ├── columns: i:161
 │    │                        │                                  │                                                      │    │                        │                                                                │    ├── values
 │    │                        │                                  │                                                      │    │                        │                                                                │    │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                                                │    └── projections
 │    │                        │                                  │                                                      │    │                        │                                                                │         └── plus [as=i:161]
 │    │                        │                                  │                                                      │    │                        │                                                                │              ├── variable: i:155
 │    │                        │                                  │                                                      │    │                        │                                                                │              └── const: 1
 │    │                        │                                  │                                                      │    │                        │                                                                └── projections
 │    │                        │                                  │                                                      │    │                        │                                                                     └── case [as=stmt_if_5:164]
 │    │                        │                                  │                                                      │    │                        │                                                                          ├── true
 │    │                        │                                  │                                                      │    │                        │                                                                          ├── when
 │    │                        │                                  │                                                      │    │                        │                                                                          │    ├── ge
 │    │                        │                                  │                                                      │    │                        │                                                                          │    │    ├── variable: i:161
 │    │                        │                                  │                                                      │    │                        │                                                                          │    │    └── variable: n:156
 │    │                        │                                  │                                                      │    │                        │                                                                          │    └── subquery
 │    │                        │                                  │                                                      │    │                        │                                                                          │         └── project
 │    │                        │                                  │                                                      │    │                        │                                                                          │              ├── columns: loop_exit_1:162
 │    │                        │                                  │                                                      │    │                        │                                                                          │              ├── values
 │    │                        │                                  │                                                      │    │                        │                                                                          │              │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                                                          │              └── projections
 │    │                        │                                  │                                                      │    │                        │                                                                          │                   └── udf: loop_exit_1 [as=loop_exit_1:162]
 │    │                        │                                  │                                                      │    │                        │                                                                          │                        ├── args
 │    │                        │                                  │                                                      │    │                        │                                                                          │                        │    ├── variable: i:161
 │    │                        │                                  │                                                      │    │                        │                                                                          │                        │    ├── variable: n:156
 │    │                        │                                  │                                                      │    │                        │                                                                          │                        │    ├── variable: res:157
 │    │                        │                                  │                                                      │    │                        │                                                                          │                        │    ├── variable: arr:158
 │    │                        │                                  │                                                      │    │                        │                                                                          │                        │    ├── variable: idx:159
 │    │                        │                                  │                                                      │    │                        │                                                                          │                        │    └── variable: val:160
 │    │                        │                                  │                                                      │    │                        │                                                                          │                        ├── params: i:142 n:143 res:144 arr:145 idx:146 val:147
 │    │                        │                                  │                                                      │    │                        │                                                                          │                        └── body
 │    │                        │                                  │                                                      │    │                        │                                                                          │                             └── project
 │    │                        │                                  │                                                      │    │                        │                                                                          │                                  ├── columns: stmt_return_2:148
 │    │                        │                                  │                                                      │    │                        │                                                                          │                                  ├── values
 │    │                        │                                  │                                                      │    │                        │                                                                          │                                  │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                                                          │                                  └── projections
 │    │                        │                                  │                                                      │    │                        │                                                                          │                                       └── variable: res:144 [as=stmt_return_2:148]
 │    │                        │                                  │                                                      │    │                        │                                                                          └── subquery
 │    │                        │                                  │                                                      │    │                        │                                                                               └── project
 │    │                        │                                  │                                                      │    │                        │                                                                                    ├── columns: stmt_loop_3:163
 │    │                        │                                  │                                                      │    │                        │                                                                                    ├── values
 │    │                        │                                  │                                                      │    │                        │                                                                                    │    └── tuple
 │    │                        │                                  │                                                      │    │                        │                                                                                    └── projections
 │    │                        │                                  │                                                      │    │                        │                                                                                         └── udf: stmt_loop_3 [as=stmt_loop_3:163]
 │    │                        │                                  │                                                      │    │                        │                                                                                              ├── args
 │    │                        │                                  │                                                      │    │                        │                                                                                              │    ├── variable: i:161
 │    │                        │                                  │                                                      │    │                        │                                                                                              │    ├── variable: n:156
 │    │                        │                                  │                                                      │    │                        │                                                                                              │    ├── variable: res:157
 │    │                        │                                  │                                                      │    │                        │                                                                                              │    ├── variable: arr:158
 │    │                        │                                  │                                                      │    │                        │                                                                                              │    ├── variable: idx:159
 │    │                        │                                  │                                                      │    │                        │                                                                                              │    └── variable: val:160
 │    │                        │                                  │                                                      │    │                        │                                                                                              └── recursive-call
 │    │                        │                                  │                                                      │    │                        └── const: 1
 │    │                        │                                  │                                                      │    └── projections
 │    │                        │                                  │                                                      │         └── const: 0 [as=i:172]
 │    │                        │                                  │                                                      └── projections
 │    │                        │                                  │                                                           └── udf: stmt_loop_7 [as=stmt_loop_7:270]
 │    │                        │                                  │                                                                ├── args
 │    │                        │                                  │                                                                │    ├── variable: n:81
 │    │                        │                                  │                                                                │    ├── variable: i:172
 │    │                        │                                  │                                                                │    ├── variable: count:83
 │    │                        │                                  │                                                                │    ├── variable: dist:84
 │    │                        │                                  │                                                                │    ├── variable: spt_set:171
 │    │                        │                                  │                                                                │    ├── variable: u:134
 │    │                        │                                  │                                                                │    └── variable: src:87
 │    │                        │                                  │                                                                ├── params: n:184 i:185 count:186 dist:187 spt_set:188 u:189 src:190
 │    │                        │                                  │                                                                └── body
 │    │                        │                                  │                                                                     └── project
 │    │                        │                                  │                                                                          ├── columns: stmt_if_10:269
 │    │                        │                                  │                                                                          ├── values
 │    │                        │                                  │                                                                          │    └── tuple
 │    │                        │                                  │                                                                          └── projections
 │    │                        │                                  │                                                                               └── case [as=stmt_if_10:269]
 │    │                        │                                  │                                                                                    ├── true
 │    │                        │                                  │                                                                                    ├── when
 │    │                        │                                  │                                                                                    │    ├── and
 │    │                        │                                  │                                                                                    │    │    ├── and
 │    │                        │                                  │                                                                                    │    │    │    ├── and
 │    │                        │                                  │                                                                                    │    │    │    │    ├── eq
 │    │                        │                                  │                                                                                    │    │    │    │    │    ├── indirection
 │    │                        │                                  │                                                                                    │    │    │    │    │    │    ├── variable: spt_set:188
 │    │                        │                                  │                                                                                    │    │    │    │    │    │    └── plus
 │    │                        │                                  │                                                                                    │    │    │    │    │    │         ├── variable: i:185
 │    │                        │                                  │                                                                                    │    │    │    │    │    │         └── const: 1
 │    │                        │                                  │                                                                                    │    │    │    │    │    └── const: 0
 │    │                        │                                  │                                                                                    │    │    │    │    └── gt
 │    │                        │                                  │                                                                                    │    │    │    │         ├── udf: graph
 │    │                        │                                  │                                                                                    │    │    │    │         │    ├── args
 │    │                        │                                  │                                                                                    │    │    │    │         │    │    ├── variable: u:189
 │    │                        │                                  │                                                                                    │    │    │    │         │    │    └── variable: i:185
 │    │                        │                                  │                                                                                    │    │    │    │         │    ├── params: x:250 y:251
 │    │                        │                                  │                                                                                    │    │    │    │         │    └── body
 │    │                        │                                  │                                                                                    │    │    │    │         │         └── limit
 │    │                        │                                  │                                                                                    │    │    │    │         │              ├── columns: coalesce:258
 │    │                        │                                  │                                                                                    │    │    │    │         │              ├── project
 │    │                        │                                  │                                                                                    │    │    │    │         │              │    ├── columns: coalesce:258
 │    │                        │                                  │                                                                                    │    │    │    │         │              │    ├── values
 │    │                        │                                  │                                                                                    │    │    │    │         │              │    │    └── tuple
 │    │                        │                                  │                                                                                    │    │    │    │         │              │    └── projections
 │    │                        │                                  │                                                                                    │    │    │    │         │              │         └── coalesce [as=coalesce:258]
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              ├── subquery
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │    └── max1-row
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │         ├── columns: weight:254
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │         └── limit
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              ├── columns: weight:254
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              ├── project
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │    ├── columns: weight:254
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │    └── select
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │         ├── columns: a:252!null b:253!null weight:254 rowid:255!null crdb_internal_mvcc_timestamp:256 tableoid:257
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │         ├── scan edges
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │         │    └── columns: a:252 b:253 weight:254 rowid:255!null crdb_internal_mvcc_timestamp:256 tableoid:257
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │         └── filters
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │              └── or
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                   ├── and
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                   │    ├── eq
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                   │    │    ├── variable: a:252
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                   │    │    └── variable: x:250
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                   │    └── eq
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                   │         ├── variable: b:253
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                   │         └── variable: y:251
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                   └── and
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                        ├── eq
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                        │    ├── variable: a:252
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                        │    └── variable: y:251
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                        └── eq
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                             ├── variable: b:253
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              │                             └── variable: x:250
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              │              └── const: 1
 │    │                        │                                  │                                                                                    │    │    │    │         │              │              └── const: 0
 │    │                        │                                  │                                                                                    │    │    │    │         │              └── const: 1
 │    │                        │                                  │                                                                                    │    │    │    │         └── const: 0
 │    │                        │                                  │                                                                                    │    │    │    └── ne
 │    │                        │                                  │                                                                                    │    │    │         ├── indirection
 │    │                        │                                  │                                                                                    │    │    │         │    ├── variable: dist:187
 │    │                        │                                  │                                                                                    │    │    │         │    └── plus
 │    │                        │                                  │                                                                                    │    │    │         │         ├── variable: u:189
 │    │                        │                                  │                                                                                    │    │    │         │         └── const: 1
 │    │                        │                                  │                                                                                    │    │    │         └── udf: max_int
 │    │                        │                                  │                                                                                    │    │    │              └── body
 │    │                        │                                  │                                                                                    │    │    │                   └── limit
 │    │                        │                                  │                                                                                    │    │    │                        ├── columns: "?column?":259!null
 │    │                        │                                  │                                                                                    │    │    │                        ├── project
 │    │                        │                                  │                                                                                    │    │    │                        │    ├── columns: "?column?":259!null
 │    │                        │                                  │                                                                                    │    │    │                        │    ├── values
 │    │                        │                                  │                                                                                    │    │    │                        │    │    └── tuple
 │    │                        │                                  │                                                                                    │    │    │                        │    └── projections
 │    │                        │                                  │                                                                                    │    │    │                        │         └── const: 2147483647 [as="?column?":259]
 │    │                        │                                  │                                                                                    │    │    │                        └── const: 1
 │    │                        │                                  │                                                                                    │    │    └── lt
 │    │                        │                                  │                                                                                    │    │         ├── plus
 │    │                        │                                  │                                                                                    │    │         │    ├── indirection
 │    │                        │                                  │                                                                                    │    │         │    │    ├── variable: dist:187
 │    │                        │                                  │                                                                                    │    │         │    │    └── plus
 │    │                        │                                  │                                                                                    │    │         │    │         ├── variable: u:189
 │    │                        │                                  │                                                                                    │    │         │    │         └── const: 1
 │    │                        │                                  │                                                                                    │    │         │    └── udf: graph
 │    │                        │                                  │                                                                                    │    │         │         ├── args
 │    │                        │                                  │                                                                                    │    │         │         │    ├── variable: u:189
 │    │                        │                                  │                                                                                    │    │         │         │    └── variable: i:185
 │    │                        │                                  │                                                                                    │    │         │         ├── params: x:260 y:261
 │    │                        │                                  │                                                                                    │    │         │         └── body
 │    │                        │                                  │                                                                                    │    │         │              └── limit
 │    │                        │                                  │                                                                                    │    │         │                   ├── columns: coalesce:268
 │    │                        │                                  │                                                                                    │    │         │                   ├── project
 │    │                        │                                  │                                                                                    │    │         │                   │    ├── columns: coalesce:268
 │    │                        │                                  │                                                                                    │    │         │                   │    ├── values
 │    │                        │                                  │                                                                                    │    │         │                   │    │    └── tuple
 │    │                        │                                  │                                                                                    │    │         │                   │    └── projections
 │    │                        │                                  │                                                                                    │    │         │                   │         └── coalesce [as=coalesce:268]
 │    │                        │                                  │                                                                                    │    │         │                   │              ├── subquery
 │    │                        │                                  │                                                                                    │    │         │                   │              │    └── max1-row
 │    │                        │                                  │                                                                                    │    │         │                   │              │         ├── columns: weight:264
 │    │                        │                                  │                                                                                    │    │         │                   │              │         └── limit
 │    │                        │                                  │                                                                                    │    │         │                   │              │              ├── columns: weight:264
 │    │                        │                                  │                                                                                    │    │         │                   │              │              ├── project
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │    ├── columns: weight:264
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │    └── select
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │         ├── columns: a:262!null b:263!null weight:264 rowid:265!null crdb_internal_mvcc_timestamp:266 tableoid:267
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │         ├── scan edges
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │         │    └── columns: a:262 b:263 weight:264 rowid:265!null crdb_internal_mvcc_timestamp:266 tableoid:267
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │         └── filters
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │              └── or
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                   ├── and
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                   │    ├── eq
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                   │    │    ├── variable: a:262
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                   │    │    └── variable: x:260
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                   │    └── eq
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                   │         ├── variable: b:263
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                   │         └── variable: y:261
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                   └── and
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                        ├── eq
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                        │    ├── variable: a:262
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                        │    └── variable: y:261
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                        └── eq
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                             ├── variable: b:263
 │    │                        │                                  │                                                                                    │    │         │                   │              │              │                             └── variable: x:260
 │    │                        │                                  │                                                                                    │    │         │                   │              │              └── const: 1
 │    │                        │                                  │                                                                                    │    │         │                   │              └── const: 0
 │    │                        │                                  │                                                                                    │    │         │                   └── const: 1
 │    │                        │                                  │                                                                                    │    │         └── indirection
 │    │                        │                                  │                                                                                    │    │              ├── variable: dist:187
 │    │                        │                                  │                                                                                    │    │              └── plus
 │    │                        │                                  │                                                                                    │    │                   ├── variable: i:185
 │    │                        │                                  │                                                                                    │    │                   └── const: 1
 │    │                        │                                  │                                                                                    │    └── subquery
 │    │                        │                                  │                                                                                    │         └── project
 │    │                        │                                  │                                                                                    │              ├── columns: stmt_if_8:248
 │    │                        │                                  │                                                                                    │              ├── project
 │    │                        │                                  │                                                                                    │              │    ├── columns: dist:247
 │    │                        │                                  │                                                                                    │              │    ├── values
 │    │                        │                                  │                                                                                    │              │    │    └── tuple
 │    │                        │                                  │                                                                                    │              │    └── projections
 │    │                        │                                  │                                                                                    │              │         └── udf: replace_arr [as=dist:247]
 │    │                        │                                  │                                                                                    │              │              ├── args
 │    │                        │                                  │                                                                                    │              │              │    ├── variable: dist:187
 │    │                        │                                  │                                                                                    │              │              │    ├── variable: i:185
 │    │                        │                                  │                                                                                    │              │              │    └── plus
 │    │                        │                                  │                                                                                    │              │              │         ├── indirection
 │    │                        │                                  │                                                                                    │              │              │         │    ├── variable: dist:187
 │    │                        │                                  │                                                                                    │              │              │         │    └── plus
 │    │                        │                                  │                                                                                    │              │              │         │         ├── variable: u:189
 │    │                        │                                  │                                                                                    │              │              │         │         └── const: 1
 │    │                        │                                  │                                                                                    │              │              │         └── udf: graph
 │    │                        │                                  │                                                                                    │              │              │              ├── args
 │    │                        │                                  │                                                                                    │              │              │              │    ├── variable: u:189
 │    │                        │                                  │                                                                                    │              │              │              │    └── variable: i:185
 │    │                        │                                  │                                                                                    │              │              │              ├── params: x:202 y:203
 │    │                        │                                  │                                                                                    │              │              │              └── body
 │    │                        │                                  │                                                                                    │              │              │                   └── limit
 │    │                        │                                  │                                                                                    │              │              │                        ├── columns: coalesce:210
 │    │                        │                                  │                                                                                    │              │              │                        ├── project
 │    │                        │                                  │                                                                                    │              │              │                        │    ├── columns: coalesce:210
 │    │                        │                                  │                                                                                    │              │              │                        │    ├── values
 │    │                        │                                  │                                                                                    │              │              │                        │    │    └── tuple
 │    │                        │                                  │                                                                                    │              │              │                        │    └── projections
 │    │                        │                                  │                                                                                    │              │              │                        │         └── coalesce [as=coalesce:210]
 │    │                        │                                  │                                                                                    │              │              │                        │              ├── subquery
 │    │                        │                                  │                                                                                    │              │              │                        │              │    └── max1-row
 │    │                        │                                  │                                                                                    │              │              │                        │              │         ├── columns: weight:206
 │    │                        │                                  │                                                                                    │              │              │                        │              │         └── limit
 │    │                        │                                  │                                                                                    │              │              │                        │              │              ├── columns: weight:206
 │    │                        │                                  │                                                                                    │              │              │                        │              │              ├── project
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │    ├── columns: weight:206
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │    └── select
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │         ├── columns: a:204!null b:205!null weight:206 rowid:207!null crdb_internal_mvcc_timestamp:208 tableoid:209
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │         ├── scan edges
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │         │    └── columns: a:204 b:205 weight:206 rowid:207!null crdb_internal_mvcc_timestamp:208 tableoid:209
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │         └── filters
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │              └── or
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                   ├── and
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                   │    ├── eq
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                   │    │    ├── variable: a:204
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                   │    │    └── variable: x:202
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                   │    └── eq
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                   │         ├── variable: b:205
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                   │         └── variable: y:203
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                   └── and
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                        ├── eq
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                        │    ├── variable: a:204
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                        │    └── variable: y:203
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                        └── eq
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                             ├── variable: b:205
 │    │                        │                                  │                                                                                    │              │              │                        │              │              │                             └── variable: x:202
 │    │                        │                                  │                                                                                    │              │              │                        │              │              └── const: 1
 │    │                        │                                  │                                                                                    │              │              │                        │              └── const: 0
 │    │                        │                                  │                                                                                    │              │              │                        └── const: 1
 │    │                        │                                  │                                                                                    │              │              ├── params: arr:211 idx:212 val:213
 │    │                        │                                  │                                                                                    │              │              └── body
 │    │                        │                                  │                                                                                    │              │                   └── limit
 │    │                        │                                  │                                                                                    │              │                        ├── columns: stmt_loop_3:246
 │    │                        │                                  │                                                                                    │              │                        ├── project
 │    │                        │                                  │                                                                                    │              │                        │    ├── columns: stmt_loop_3:246
 │    │                        │                                  │                                                                                    │              │                        │    ├── project
 │    │                        │                                  │                                                                                    │              │                        │    │    ├── columns: i:217!null n:215 res:216!null
 │    │                        │                                  │                                                                                    │              │                        │    │    ├── project
 │    │                        │                                  │                                                                                    │              │                        │    │    │    ├── columns: res:216!null i:214 n:215
 │    │                        │                                  │                                                                                    │              │                        │    │    │    ├── project
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │    ├── columns: n:215 i:214
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │    ├── project
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │    │    ├── columns: i:214
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │    │    ├── values
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │    │    │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │    │    └── projections
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │    │         └── cast: INT8 [as=i:214]
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │    │              └── null
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │    └── projections
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │         └── function: array_length [as=n:215]
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │              ├── variable: arr:211
 │    │                        │                                  │                                                                                    │              │                        │    │    │    │              └── const: 1
 │    │                        │                                  │                                                                                    │              │                        │    │    │    └── projections
 │    │                        │                                  │                                                                                    │              │                        │    │    │         └── array: [as=res:216]
 │    │                        │                                  │                                                                                    │              │                        │    │    └── projections
 │    │                        │                                  │                                                                                    │              │                        │    │         └── const: 0 [as=i:217]
 │    │                        │                                  │                                                                                    │              │                        │    └── projections
 │    │                        │                                  │                                                                                    │              │                        │         └── udf: stmt_loop_3 [as=stmt_loop_3:246]
 │    │                        │                                  │                                                                                    │              │                        │              ├── args
 │    │                        │                                  │                                                                                    │              │                        │              │    ├── variable: i:217
 │    │                        │                                  │                                                                                    │              │                        │              │    ├── variable: n:215
 │    │                        │                                  │                                                                                    │              │                        │              │    ├── variable: res:216
 │    │                        │                                  │                                                                                    │              │                        │              │    ├── variable: arr:211
 │    │                        │                                  │                                                                                    │              │                        │              │    ├── variable: idx:212
 │    │                        │                                  │                                                                                    │              │                        │              │    └── variable: val:213
 │    │                        │                                  │                                                                                    │              │                        │              ├── params: i:225 n:226 res:227 arr:228 idx:229 val:230
 │    │                        │                                  │                                                                                    │              │                        │              └── body
 │    │                        │                                  │                                                                                    │              │                        │                   └── project
 │    │                        │                                  │                                                                                    │              │                        │                        ├── columns: stmt_if_6:245
 │    │                        │                                  │                                                                                    │              │                        │                        ├── values
 │    │                        │                                  │                                                                                    │              │                        │                        │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                        └── projections
 │    │                        │                                  │                                                                                    │              │                        │                             └── case [as=stmt_if_6:245]
 │    │                        │                                  │                                                                                    │              │                        │                                  ├── true
 │    │                        │                                  │                                                                                    │              │                        │                                  ├── when
 │    │                        │                                  │                                                                                    │              │                        │                                  │    ├── eq
 │    │                        │                                  │                                                                                    │              │                        │                                  │    │    ├── variable: i:225
 │    │                        │                                  │                                                                                    │              │                        │                                  │    │    └── variable: idx:229
 │    │                        │                                  │                                                                                    │              │                        │                                  │    └── subquery
 │    │                        │                                  │                                                                                    │              │                        │                                  │         └── project
 │    │                        │                                  │                                                                                    │              │                        │                                  │              ├── columns: stmt_if_4:242
 │    │                        │                                  │                                                                                    │              │                        │                                  │              ├── project
 │    │                        │                                  │                                                                                    │              │                        │                                  │              │    ├── columns: res:241
 │    │                        │                                  │                                                                                    │              │                        │                                  │              │    ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                  │              │    │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                  │              │    └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                  │              │         └── concat [as=res:241]
 │    │                        │                                  │                                                                                    │              │                        │                                  │              │              ├── variable: res:227
 │    │                        │                                  │                                                                                    │              │                        │                                  │              │              └── variable: val:230
 │    │                        │                                  │                                                                                    │              │                        │                                  │              └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                  │                   └── udf: stmt_if_4 [as=stmt_if_4:242]
 │    │                        │                                  │                                                                                    │              │                        │                                  │                        ├── args
 │    │                        │                                  │                                                                                    │              │                        │                                  │                        │    ├── variable: i:225
 │    │                        │                                  │                                                                                    │              │                        │                                  │                        │    ├── variable: n:226
 │    │                        │                                  │                                                                                    │              │                        │                                  │                        │    ├── variable: res:241
 │    │                        │                                  │                                                                                    │              │                        │                                  │                        │    ├── variable: arr:228
 │    │                        │                                  │                                                                                    │              │                        │                                  │                        │    ├── variable: idx:229
 │    │                        │                                  │                                                                                    │              │                        │                                  │                        │    └── variable: val:230
 │    │                        │                                  │                                                                                    │              │                        │                                  │                        ├── params: i:231 n:232 res:233 arr:234 idx:235 val:236
 │    │                        │                                  │                                                                                    │              │                        │                                  │                        └── body
 │    │                        │                                  │                                                                                    │              │                        │                                  │                             └── project
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  ├── columns: stmt_if_5:240
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  ├── project
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  │    ├── columns: i:237
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  │    ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  │    │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  │    └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  │         └── plus [as=i:237]
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  │              ├── variable: i:231
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  │              └── const: 1
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                  └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                       └── case [as=stmt_if_5:240]
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            ├── true
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            ├── when
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │    ├── ge
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │    │    ├── variable: i:237
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │    │    └── variable: n:232
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │    └── subquery
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │         └── project
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │              ├── columns: loop_exit_1:238
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │              ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │              │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │              └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                   └── udf: loop_exit_1 [as=loop_exit_1:238]
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                        ├── args
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                        │    ├── variable: i:237
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                        │    ├── variable: n:232
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                        │    ├── variable: res:233
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                        │    ├── variable: arr:234
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                        │    ├── variable: idx:235
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                        │    └── variable: val:236
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                        ├── params: i:218 n:219 res:220 arr:221 idx:222 val:223
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                        └── body
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                             └── project
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                                  ├── columns: stmt_return_2:224
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                                  ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                                  │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                                  └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            │                                       └── variable: res:220 [as=stmt_return_2:224]
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                            └── subquery
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                 └── project
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                      ├── columns: stmt_loop_3:239
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                      ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                      │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                      └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                           └── udf: stmt_loop_3 [as=stmt_loop_3:239]
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                                ├── args
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                                │    ├── variable: i:237
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                                │    ├── variable: n:232
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                                │    ├── variable: res:233
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                                │    ├── variable: arr:234
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                                │    ├── variable: idx:235
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                                │    └── variable: val:236
 │    │                        │                                  │                                                                                    │              │                        │                                  │                                                                └── recursive-call
 │    │                        │                                  │                                                                                    │              │                        │                                  └── subquery
 │    │                        │                                  │                                                                                    │              │                        │                                       └── project
 │    │                        │                                  │                                                                                    │              │                        │                                            ├── columns: stmt_if_4:244
 │    │                        │                                  │                                                                                    │              │                        │                                            ├── project
 │    │                        │                                  │                                                                                    │              │                        │                                            │    ├── columns: res:243
 │    │                        │                                  │                                                                                    │              │                        │                                            │    ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                            │    │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                            │    └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                            │         └── concat [as=res:243]
 │    │                        │                                  │                                                                                    │              │                        │                                            │              ├── variable: res:227
 │    │                        │                                  │                                                                                    │              │                        │                                            │              └── indirection
 │    │                        │                                  │                                                                                    │              │                        │                                            │                   ├── variable: arr:228
 │    │                        │                                  │                                                                                    │              │                        │                                            │                   └── plus
 │    │                        │                                  │                                                                                    │              │                        │                                            │                        ├── variable: i:225
 │    │                        │                                  │                                                                                    │              │                        │                                            │                        └── const: 1
 │    │                        │                                  │                                                                                    │              │                        │                                            └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                                 └── udf: stmt_if_4 [as=stmt_if_4:244]
 │    │                        │                                  │                                                                                    │              │                        │                                                      ├── args
 │    │                        │                                  │                                                                                    │              │                        │                                                      │    ├── variable: i:225
 │    │                        │                                  │                                                                                    │              │                        │                                                      │    ├── variable: n:226
 │    │                        │                                  │                                                                                    │              │                        │                                                      │    ├── variable: res:243
 │    │                        │                                  │                                                                                    │              │                        │                                                      │    ├── variable: arr:228
 │    │                        │                                  │                                                                                    │              │                        │                                                      │    ├── variable: idx:229
 │    │                        │                                  │                                                                                    │              │                        │                                                      │    └── variable: val:230
 │    │                        │                                  │                                                                                    │              │                        │                                                      ├── params: i:231 n:232 res:233 arr:234 idx:235 val:236
 │    │                        │                                  │                                                                                    │              │                        │                                                      └── body
 │    │                        │                                  │                                                                                    │              │                        │                                                           └── project
 │    │                        │                                  │                                                                                    │              │                        │                                                                ├── columns: stmt_if_5:240
 │    │                        │                                  │                                                                                    │              │                        │                                                                ├── project
 │    │                        │                                  │                                                                                    │              │                        │                                                                │    ├── columns: i:237
 │    │                        │                                  │                                                                                    │              │                        │                                                                │    ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                                                │    │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                                                │    └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                                                │         └── plus [as=i:237]
 │    │                        │                                  │                                                                                    │              │                        │                                                                │              ├── variable: i:231
 │    │                        │                                  │                                                                                    │              │                        │                                                                │              └── const: 1
 │    │                        │                                  │                                                                                    │              │                        │                                                                └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                                                     └── case [as=stmt_if_5:240]
 │    │                        │                                  │                                                                                    │              │                        │                                                                          ├── true
 │    │                        │                                  │                                                                                    │              │                        │                                                                          ├── when
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │    ├── ge
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │    │    ├── variable: i:237
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │    │    └── variable: n:232
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │    └── subquery
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │         └── project
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │              ├── columns: loop_exit_1:238
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │              ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │              │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │              └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                   └── udf: loop_exit_1 [as=loop_exit_1:238]
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                        ├── args
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                        │    ├── variable: i:237
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                        │    ├── variable: n:232
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                        │    ├── variable: res:233
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                        │    ├── variable: arr:234
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                        │    ├── variable: idx:235
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                        │    └── variable: val:236
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                        ├── params: i:218 n:219 res:220 arr:221 idx:222 val:223
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                        └── body
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                             └── project
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                                  ├── columns: stmt_return_2:224
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                                  ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                                  │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                                  └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                                                          │                                       └── variable: res:220 [as=stmt_return_2:224]
 │    │                        │                                  │                                                                                    │              │                        │                                                                          └── subquery
 │    │                        │                                  │                                                                                    │              │                        │                                                                               └── project
 │    │                        │                                  │                                                                                    │              │                        │                                                                                    ├── columns: stmt_loop_3:239
 │    │                        │                                  │                                                                                    │              │                        │                                                                                    ├── values
 │    │                        │                                  │                                                                                    │              │                        │                                                                                    │    └── tuple
 │    │                        │                                  │                                                                                    │              │                        │                                                                                    └── projections
 │    │                        │                                  │                                                                                    │              │                        │                                                                                         └── udf: stmt_loop_3 [as=stmt_loop_3:239]
 │    │                        │                                  │                                                                                    │              │                        │                                                                                              ├── args
 │    │                        │                                  │                                                                                    │              │                        │                                                                                              │    ├── variable: i:237
 │    │                        │                                  │                                                                                    │              │                        │                                                                                              │    ├── variable: n:232
 │    │                        │                                  │                                                                                    │              │                        │                                                                                              │    ├── variable: res:233
 │    │                        │                                  │                                                                                    │              │                        │                                                                                              │    ├── variable: arr:234
 │    │                        │                                  │                                                                                    │              │                        │                                                                                              │    ├── variable: idx:235
 │    │                        │                                  │                                                                                    │              │                        │                                                                                              │    └── variable: val:236
 │    │                        │                                  │                                                                                    │              │                        │                                                                                              └── recursive-call
 │    │                        │                                  │                                                                                    │              │                        └── const: 1
 │    │                        │                                  │                                                                                    │              └── projections
 │    │                        │                                  │                                                                                    │                   └── udf: stmt_if_8 [as=stmt_if_8:248]
 │    │                        │                                  │                                                                                    │                        ├── args
 │    │                        │                                  │                                                                                    │                        │    ├── variable: n:184
 │    │                        │                                  │                                                                                    │                        │    ├── variable: i:185
 │    │                        │                                  │                                                                                    │                        │    ├── variable: count:186
 │    │                        │                                  │                                                                                    │                        │    ├── variable: dist:247
 │    │                        │                                  │                                                                                    │                        │    ├── variable: spt_set:188
 │    │                        │                                  │                                                                                    │                        │    ├── variable: u:189
 │    │                        │                                  │                                                                                    │                        │    └── variable: src:190
 │    │                        │                                  │                                                                                    │                        ├── params: n:191 i:192 count:193 dist:194 spt_set:195 u:196 src:197
 │    │                        │                                  │                                                                                    │                        └── body
 │    │                        │                                  │                                                                                    │                             └── project
 │    │                        │                                  │                                                                                    │                                  ├── columns: stmt_if_9:201
 │    │                        │                                  │                                                                                    │                                  ├── project
 │    │                        │                                  │                                                                                    │                                  │    ├── columns: i:198
 │    │                        │                                  │                                                                                    │                                  │    ├── values
 │    │                        │                                  │                                                                                    │                                  │    │    └── tuple
 │    │                        │                                  │                                                                                    │                                  │    └── projections
 │    │                        │                                  │                                                                                    │                                  │         └── plus [as=i:198]
 │    │                        │                                  │                                                                                    │                                  │              ├── variable: i:192
 │    │                        │                                  │                                                                                    │                                  │              └── const: 1
 │    │                        │                                  │                                                                                    │                                  └── projections
 │    │                        │                                  │                                                                                    │                                       └── case [as=stmt_if_9:201]
 │    │                        │                                  │                                                                                    │                                            ├── true
 │    │                        │                                  │                                                                                    │                                            ├── when
 │    │                        │                                  │                                                                                    │                                            │    ├── ge
 │    │                        │                                  │                                                                                    │                                            │    │    ├── variable: i:198
 │    │                        │                                  │                                                                                    │                                            │    │    └── variable: n:191
 │    │                        │                                  │                                                                                    │                                            │    └── subquery
 │    │                        │                                  │                                                                                    │                                            │         └── project
 │    │                        │                                  │                                                                                    │                                            │              ├── columns: loop_exit_5:199
 │    │                        │                                  │                                                                                    │                                            │              ├── values
 │    │                        │                                  │                                                                                    │                                            │              │    └── tuple
 │    │                        │                                  │                                                                                    │                                            │              └── projections
 │    │                        │                                  │                                                                                    │                                            │                   └── udf: loop_exit_5 [as=loop_exit_5:199]
 │    │                        │                                  │                                                                                    │                                            │                        ├── args
 │    │                        │                                  │                                                                                    │                                            │                        │    ├── variable: n:191
 │    │                        │                                  │                                                                                    │                                            │                        │    ├── variable: i:198
 │    │                        │                                  │                                                                                    │                                            │                        │    ├── variable: count:193
 │    │                        │                                  │                                                                                    │                                            │                        │    ├── variable: dist:194
 │    │                        │                                  │                                                                                    │                                            │                        │    ├── variable: spt_set:195
 │    │                        │                                  │                                                                                    │                                            │                        │    ├── variable: u:196
 │    │                        │                                  │                                                                                    │                                            │                        │    └── variable: src:197
 │    │                        │                                  │                                                                                    │                                            │                        ├── params: n:173 i:174 count:175 dist:176 spt_set:177 u:178 src:179
 │    │                        │                                  │                                                                                    │                                            │                        └── body
 │    │                        │                                  │                                                                                    │                                            │                             └── project
 │    │                        │                                  │                                                                                    │                                            │                                  ├── columns: stmt_if_6:183
 │    │                        │                                  │                                                                                    │                                            │                                  ├── project
 │    │                        │                                  │                                                                                    │                                            │                                  │    ├── columns: count:180
 │    │                        │                                  │                                                                                    │                                            │                                  │    ├── values
 │    │                        │                                  │                                                                                    │                                            │                                  │    │    └── tuple
 │    │                        │                                  │                                                                                    │                                            │                                  │    └── projections
 │    │                        │                                  │                                                                                    │                                            │                                  │         └── plus [as=count:180]
 │    │                        │                                  │                                                                                    │                                            │                                  │              ├── variable: count:175
 │    │                        │                                  │                                                                                    │                                            │                                  │              └── const: 1
 │    │                        │                                  │                                                                                    │                                            │                                  └── projections
 │    │                        │                                  │                                                                                    │                                            │                                       └── case [as=stmt_if_6:183]
 │    │                        │                                  │                                                                                    │                                            │                                            ├── true
 │    │                        │                                  │                                                                                    │                                            │                                            ├── when
 │    │                        │                                  │                                                                                    │                                            │                                            │    ├── ge
 │    │                        │                                  │                                                                                    │                                            │                                            │    │    ├── variable: count:180
 │    │                        │                                  │                                                                                    │                                            │                                            │    │    └── variable: n:173
 │    │                        │                                  │                                                                                    │                                            │                                            │    └── subquery
 │    │                        │                                  │                                                                                    │                                            │                                            │         └── project
 │    │                        │                                  │                                                                                    │                                            │                                            │              ├── columns: loop_exit_2:181
 │    │                        │                                  │                                                                                    │                                            │                                            │              ├── values
 │    │                        │                                  │                                                                                    │                                            │                                            │              │    └── tuple
 │    │                        │                                  │                                                                                    │                                            │                                            │              └── projections
 │    │                        │                                  │                                                                                    │                                            │                                            │                   └── udf: loop_exit_2 [as=loop_exit_2:181]
 │    │                        │                                  │                                                                                    │                                            │                                            │                        ├── args
 │    │                        │                                  │                                                                                    │                                            │                                            │                        │    ├── variable: n:173
 │    │                        │                                  │                                                                                    │                                            │                                            │                        │    ├── variable: i:174
 │    │                        │                                  │                                                                                    │                                            │                                            │                        │    ├── variable: count:180
 │    │                        │                                  │                                                                                    │                                            │                                            │                        │    ├── variable: dist:176
 │    │                        │                                  │                                                                                    │                                            │                                            │                        │    ├── variable: spt_set:177
 │    │                        │                                  │                                                                                    │                                            │                                            │                        │    ├── variable: u:178
 │    │                        │                                  │                                                                                    │                                            │                                            │                        │    └── variable: src:179
 │    │                        │                                  │                                                                                    │                                            │                                            │                        ├── params: n:73 i:74 count:75 dist:76 spt_set:77 u:78 src:79
 │    │                        │                                  │                                                                                    │                                            │                                            │                        └── body
 │    │                        │                                  │                                                                                    │                                            │                                            │                             └── project
 │    │                        │                                  │                                                                                    │                                            │                                            │                                  ├── columns: stmt_return_3:80
 │    │                        │                                  │                                                                                    │                                            │                                            │                                  ├── values
 │    │                        │                                  │                                                                                    │                                            │                                            │                                  │    └── tuple
 │    │                        │                                  │                                                                                    │                                            │                                            │                                  └── projections
 │    │                        │                                  │                                                                                    │                                            │                                            │                                       └── variable: dist:76 [as=stmt_return_3:80]
 │    │                        │                                  │                                                                                    │                                            │                                            └── subquery
 │    │                        │                                  │                                                                                    │                                            │                                                 └── project
 │    │                        │                                  │                                                                                    │                                            │                                                      ├── columns: stmt_loop_4:182
 │    │                        │                                  │                                                                                    │                                            │                                                      ├── values
 │    │                        │                                  │                                                                                    │                                            │                                                      │    └── tuple
 │    │                        │                                  │                                                                                    │                                            │                                                      └── projections
 │    │                        │                                  │                                                                                    │                                            │                                                           └── udf: stmt_loop_4 [as=stmt_loop_4:182]
 │    │                        │                                  │                                                                                    │                                            │                                                                ├── args
 │    │                        │                                  │                                                                                    │                                            │                                                                │    ├── variable: n:173
 │    │                        │                                  │                                                                                    │                                            │                                                                │    ├── variable: i:174
 │    │                        │                                  │                                                                                    │                                            │                                                                │    ├── variable: count:180
 │    │                        │                                  │                                                                                    │                                            │                                                                │    ├── variable: dist:176
 │    │                        │                                  │                                                                                    │                                            │                                                                │    ├── variable: spt_set:177
 │    │                        │                                  │                                                                                    │                                            │                                                                │    ├── variable: u:178
 │    │                        │                                  │                                                                                    │                                            │                                                                │    └── variable: src:179
 │    │                        │                                  │                                                                                    │                                            │                                                                └── recursive-call
 │    │                        │                                  │                                                                                    │                                            └── subquery
 │    │                        │                                  │                                                                                    │                                                 └── project
 │    │                        │                                  │                                                                                    │                                                      ├── columns: stmt_loop_7:200
 │    │                        │                                  │                                                                                    │                                                      ├── values
 │    │                        │                                  │                                                                                    │                                                      │    └── tuple
 │    │                        │                                  │                                                                                    │                                                      └── projections
 │    │                        │                                  │                                                                                    │                                                           └── udf: stmt_loop_7 [as=stmt_loop_7:200]
 │    │                        │                                  │                                                                                    │                                                                ├── args
 │    │                        │                                  │                                                                                    │                                                                │    ├── variable: n:191
 │    │                        │                                  │                                                                                    │                                                                │    ├── variable: i:198
 │    │                        │                                  │                                                                                    │                                                                │    ├── variable: count:193
 │    │                        │                                  │                                                                                    │                                                                │    ├── variable: dist:194
 │    │                        │                                  │                                                                                    │                                                                │    ├── variable: spt_set:195
 │    │                        │                                  │                                                                                    │                                                                │    ├── variable: u:196
 │    │                        │                                  │                                                                                    │                                                                │    └── variable: src:197
 │    │                        │                                  │                                                                                    │                                                                └── recursive-call
 │    │                        │                                  │                                                                                    └── subquery
 │    │                        │                                  │                                                                                         └── project
 │    │                        │                                  │                                                                                              ├── columns: stmt_if_8:249
 │    │                        │                                  │                                                                                              ├── values
 │    │                        │                                  │                                                                                              │    └── tuple
 │    │                        │                                  │                                                                                              └── projections
 │    │                        │                                  │                                                                                                   └── udf: stmt_if_8 [as=stmt_if_8:249]
 │    │                        │                                  │                                                                                                        ├── args
 │    │                        │                                  │                                                                                                        │    ├── variable: n:184
 │    │                        │                                  │                                                                                                        │    ├── variable: i:185
 │    │                        │                                  │                                                                                                        │    ├── variable: count:186
 │    │                        │                                  │                                                                                                        │    ├── variable: dist:187
 │    │                        │                                  │                                                                                                        │    ├── variable: spt_set:188
 │    │                        │                                  │                                                                                                        │    ├── variable: u:189
 │    │                        │                                  │                                                                                                        │    └── variable: src:190
 │    │                        │                                  │                                                                                                        ├── params: n:191 i:192 count:193 dist:194 spt_set:195 u:196 src:197
 │    │                        │                                  │                                                                                                        └── body
 │    │                        │                                  │                                                                                                             └── project
 │    │                        │                                  │                                                                                                                  ├── columns: stmt_if_9:201
 │    │                        │                                  │                                                                                                                  ├── project
 │    │                        │                                  │                                                                                                                  │    ├── columns: i:198
 │    │                        │                                  │                                                                                                                  │    ├── values
 │    │                        │                                  │                                                                                                                  │    │    └── tuple
 │    │                        │                                  │                                                                                                                  │    └── projections
 │    │                        │                                  │                                                                                                                  │         └── plus [as=i:198]
 │    │                        │                                  │                                                                                                                  │              ├── variable: i:192
 │    │                        │                                  │                                                                                                                  │              └── const: 1
 │    │                        │                                  │                                                                                                                  └── projections
 │    │                        │                                  │                                                                                                                       └── case [as=stmt_if_9:201]
 │    │                        │                                  │                                                                                                                            ├── true
 │    │                        │                                  │                                                                                                                            ├── when
 │    │                        │                                  │                                                                                                                            │    ├── ge
 │    │                        │                                  │                                                                                                                            │    │    ├── variable: i:198
 │    │                        │                                  │                                                                                                                            │    │    └── variable: n:191
 │    │                        │                                  │                                                                                                                            │    └── subquery
 │    │                        │                                  │                                                                                                                            │         └── project
 │    │                        │                                  │                                                                                                                            │              ├── columns: loop_exit_5:199
 │    │                        │                                  │                                                                                                                            │              ├── values
 │    │                        │                                  │                                                                                                                            │              │    └── tuple
 │    │                        │                                  │                                                                                                                            │              └── projections
 │    │                        │                                  │                                                                                                                            │                   └── udf: loop_exit_5 [as=loop_exit_5:199]
 │    │                        │                                  │                                                                                                                            │                        ├── args
 │    │                        │                                  │                                                                                                                            │                        │    ├── variable: n:191
 │    │                        │                                  │                                                                                                                            │                        │    ├── variable: i:198
 │    │                        │                                  │                                                                                                                            │                        │    ├── variable: count:193
 │    │                        │                                  │                                                                                                                            │                        │    ├── variable: dist:194
 │    │                        │                                  │                                                                                                                            │                        │    ├── variable: spt_set:195
 │    │                        │                                  │                                                                                                                            │                        │    ├── variable: u:196
 │    │                        │                                  │                                                                                                                            │                        │    └── variable: src:197
 │    │                        │                                  │                                                                                                                            │                        ├── params: n:173 i:174 count:175 dist:176 spt_set:177 u:178 src:179
 │    │                        │                                  │                                                                                                                            │                        └── body
 │    │                        │                                  │                                                                                                                            │                             └── project
 │    │                        │                                  │                                                                                                                            │                                  ├── columns: stmt_if_6:183
 │    │                        │                                  │                                                                                                                            │                                  ├── project
 │    │                        │                                  │                                                                                                                            │                                  │    ├── columns: count:180
 │    │                        │                                  │                                                                                                                            │                                  │    ├── values
 │    │                        │                                  │                                                                                                                            │                                  │    │    └── tuple
 │    │                        │                                  │                                                                                                                            │                                  │    └── projections
 │    │                        │                                  │                                                                                                                            │                                  │         └── plus [as=count:180]
 │    │                        │                                  │                                                                                                                            │                                  │              ├── variable: count:175
 │    │                        │                                  │                                                                                                                            │                                  │              └── const: 1
 │    │                        │                                  │                                                                                                                            │                                  └── projections
 │    │                        │                                  │                                                                                                                            │                                       └── case [as=stmt_if_6:183]
 │    │                        │                                  │                                                                                                                            │                                            ├── true
 │    │                        │                                  │                                                                                                                            │                                            ├── when
 │    │                        │                                  │                                                                                                                            │                                            │    ├── ge
 │    │                        │                                  │                                                                                                                            │                                            │    │    ├── variable: count:180
 │    │                        │                                  │                                                                                                                            │                                            │    │    └── variable: n:173
 │    │                        │                                  │                                                                                                                            │                                            │    └── subquery
 │    │                        │                                  │                                                                                                                            │                                            │         └── project
 │    │                        │                                  │                                                                                                                            │                                            │              ├── columns: loop_exit_2:181
 │    │                        │                                  │                                                                                                                            │                                            │              ├── values
 │    │                        │                                  │                                                                                                                            │                                            │              │    └── tuple
 │    │                        │                                  │                                                                                                                            │                                            │              └── projections
 │    │                        │                                  │                                                                                                                            │                                            │                   └── udf: loop_exit_2 [as=loop_exit_2:181]
 │    │                        │                                  │                                                                                                                            │                                            │                        ├── args
 │    │                        │                                  │                                                                                                                            │                                            │                        │    ├── variable: n:173
 │    │                        │                                  │                                                                                                                            │                                            │                        │    ├── variable: i:174
 │    │                        │                                  │                                                                                                                            │                                            │                        │    ├── variable: count:180
 │    │                        │                                  │                                                                                                                            │                                            │                        │    ├── variable: dist:176
 │    │                        │                                  │                                                                                                                            │                                            │                        │    ├── variable: spt_set:177
 │    │                        │                                  │                                                                                                                            │                                            │                        │    ├── variable: u:178
 │    │                        │                                  │                                                                                                                            │                                            │                        │    └── variable: src:179
 │    │                        │                                  │                                                                                                                            │                                            │                        ├── params: n:73 i:74 count:75 dist:76 spt_set:77 u:78 src:79
 │    │                        │                                  │                                                                                                                            │                                            │                        └── body
 │    │                        │                                  │                                                                                                                            │                                            │                             └── project
 │    │                        │                                  │                                                                                                                            │                                            │                                  ├── columns: stmt_return_3:80
 │    │                        │                                  │                                                                                                                            │                                            │                                  ├── values
 │    │                        │                                  │                                                                                                                            │                                            │                                  │    └── tuple
 │    │                        │                                  │                                                                                                                            │                                            │                                  └── projections
 │    │                        │                                  │                                                                                                                            │                                            │                                       └── variable: dist:76 [as=stmt_return_3:80]
 │    │                        │                                  │                                                                                                                            │                                            └── subquery
 │    │                        │                                  │                                                                                                                            │                                                 └── project
 │    │                        │                                  │                                                                                                                            │                                                      ├── columns: stmt_loop_4:182
 │    │                        │                                  │                                                                                                                            │                                                      ├── values
 │    │                        │                                  │                                                                                                                            │                                                      │    └── tuple
 │    │                        │                                  │                                                                                                                            │                                                      └── projections
 │    │                        │                                  │                                                                                                                            │                                                           └── udf: stmt_loop_4 [as=stmt_loop_4:182]
 │    │                        │                                  │                                                                                                                            │                                                                ├── args
 │    │                        │                                  │                                                                                                                            │                                                                │    ├── variable: n:173
 │    │                        │                                  │                                                                                                                            │                                                                │    ├── variable: i:174
 │    │                        │                                  │                                                                                                                            │                                                                │    ├── variable: count:180
 │    │                        │                                  │                                                                                                                            │                                                                │    ├── variable: dist:176
 │    │                        │                                  │                                                                                                                            │                                                                │    ├── variable: spt_set:177
 │    │                        │                                  │                                                                                                                            │                                                                │    ├── variable: u:178
 │    │                        │                                  │                                                                                                                            │                                                                │    └── variable: src:179
 │    │                        │                                  │                                                                                                                            │                                                                └── recursive-call
 │    │                        │                                  │                                                                                                                            └── subquery
 │    │                        │                                  │                                                                                                                                 └── project
 │    │                        │                                  │                                                                                                                                      ├── columns: stmt_loop_7:200
 │    │                        │                                  │                                                                                                                                      ├── values
 │    │                        │                                  │                                                                                                                                      │    └── tuple
 │    │                        │                                  │                                                                                                                                      └── projections
 │    │                        │                                  │                                                                                                                                           └── udf: stmt_loop_7 [as=stmt_loop_7:200]
 │    │                        │                                  │                                                                                                                                                ├── args
 │    │                        │                                  │                                                                                                                                                │    ├── variable: n:191
 │    │                        │                                  │                                                                                                                                                │    ├── variable: i:198
 │    │                        │                                  │                                                                                                                                                │    ├── variable: count:193
 │    │                        │                                  │                                                                                                                                                │    ├── variable: dist:194
 │    │                        │                                  │                                                                                                                                                │    ├── variable: spt_set:195
 │    │                        │                                  │                                                                                                                                                │    ├── variable: u:196
 │    │                        │                                  │                                                                                                                                                │    └── variable: src:197
 │    │                        │                                  │                                                                                                                                                └── recursive-call
 │    │                        │                                  └── subquery
 │    │                        │                                       └── project
 │    │                        │                                            ├── columns: stmt_loop_11:284
 │    │                        │                                            ├── values
 │    │                        │                                            │    └── tuple
 │    │                        │                                            └── projections
 │    │                        │                                                 └── udf: stmt_loop_11 [as=stmt_loop_11:284]
 │    │                        │                                                      ├── args
 │    │                        │                                                      │    ├── variable: n:272
 │    │                        │                                                      │    ├── variable: i:282
 │    │                        │                                                      │    ├── variable: count:274
 │    │                        │                                                      │    ├── variable: dist:280
 │    │                        │                                                      │    ├── variable: spt_set:281
 │    │                        │                                                      │    ├── variable: u:277
 │    │                        │                                                      │    └── variable: src:278
 │    │                        │                                                      └── recursive-call
 │    │                        └── const: 1
 │    └── filters (true)
 └── projections
      └── indirection [as="Distance From Source":288]
           ├── variable: dijkstra:287
           └── plus
                ├── variable: generate_series:10
                └── const: 1
