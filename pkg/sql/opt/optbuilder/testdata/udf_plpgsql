exec-ddl
CREATE TABLE xy (x INT, y INT);
----

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  BEGIN
    RETURN a;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:3
                     ├── project
                     │    ├── columns: stmt_return_1:3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── variable: a:1 [as=stmt_return_1:3]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  BEGIN
    RETURN a + b;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:3
                     ├── project
                     │    ├── columns: stmt_return_1:3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── plus [as=stmt_return_1:3]
                     │              ├── variable: a:1
                     │              └── variable: b:2
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:5
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:5]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:4
                     ├── project
                     │    ├── columns: stmt_return_1:4
                     │    ├── project
                     │    │    ├── columns: c:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=c:3]
                     │    │              └── null
                     │    └── projections
                     │         └── variable: c:3 [as=stmt_return_1:4]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT := 0;
  BEGIN
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:5
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:5]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:4!null
                     ├── project
                     │    ├── columns: stmt_return_1:4!null
                     │    ├── project
                     │    │    ├── columns: c:3!null
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── const: 0 [as=c:3]
                     │    └── projections
                     │         └── variable: c:3 [as=stmt_return_1:4]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    c := 0;
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:6
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:6]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_return_1:5!null
                     ├── project
                     │    ├── columns: stmt_return_1:5!null
                     │    ├── project
                     │    │    ├── columns: c:4!null
                     │    │    ├── project
                     │    │    │    ├── columns: c:3
                     │    │    │    ├── values
                     │    │    │    │    └── tuple
                     │    │    │    └── projections
                     │    │    │         └── cast: INT8 [as=c:3]
                     │    │    │              └── null
                     │    │    └── projections
                     │    │         └── const: 0 [as=c:4]
                     │    └── projections
                     │         └── variable: c:4 [as=stmt_return_1:5]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    IF a < b THEN
      c := a;
    END IF;
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:12
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:12]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_if_3:11
                     ├── project
                     │    ├── columns: stmt_if_3:11
                     │    ├── project
                     │    │    ├── columns: c:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=c:3]
                     │    │              └── null
                     │    └── projections
                     │         └── case [as=stmt_if_3:11]
                     │              ├── true
                     │              ├── when
                     │              │    ├── lt
                     │              │    │    ├── variable: a:1
                     │              │    │    └── variable: b:2
                     │              │    └── subquery
                     │              │         └── project
                     │              │              ├── columns: stmt_if_1:9
                     │              │              ├── project
                     │              │              │    ├── columns: c:8
                     │              │              │    ├── values
                     │              │              │    │    └── tuple
                     │              │              │    └── projections
                     │              │              │         └── variable: a:1 [as=c:8]
                     │              │              └── projections
                     │              │                   └── udf: stmt_if_1 [as=stmt_if_1:9]
                     │              │                        ├── args
                     │              │                        │    ├── variable: c:8
                     │              │                        │    ├── variable: a:1
                     │              │                        │    └── variable: b:2
                     │              │                        ├── params: c:4 a:5 b:6
                     │              │                        └── body
                     │              │                             └── project
                     │              │                                  ├── columns: stmt_return_2:7
                     │              │                                  ├── values
                     │              │                                  │    └── tuple
                     │              │                                  └── projections
                     │              │                                       └── variable: c:4 [as=stmt_return_2:7]
                     │              └── subquery
                     │                   └── project
                     │                        ├── columns: stmt_if_1:10
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── udf: stmt_if_1 [as=stmt_if_1:10]
                     │                                  ├── args
                     │                                  │    ├── variable: c:3
                     │                                  │    ├── variable: a:1
                     │                                  │    └── variable: b:2
                     │                                  ├── params: c:4 a:5 b:6
                     │                                  └── body
                     │                                       └── project
                     │                                            ├── columns: stmt_return_2:7
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── variable: c:4 [as=stmt_return_2:7]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    IF a < b THEN
      c := a;
    ELSE
      c := b;
    END IF;
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:13
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:13]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_if_3:12
                     ├── project
                     │    ├── columns: stmt_if_3:12
                     │    ├── project
                     │    │    ├── columns: c:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=c:3]
                     │    │              └── null
                     │    └── projections
                     │         └── case [as=stmt_if_3:12]
                     │              ├── true
                     │              ├── when
                     │              │    ├── lt
                     │              │    │    ├── variable: a:1
                     │              │    │    └── variable: b:2
                     │              │    └── subquery
                     │              │         └── project
                     │              │              ├── columns: stmt_if_1:9
                     │              │              ├── project
                     │              │              │    ├── columns: c:8
                     │              │              │    ├── values
                     │              │              │    │    └── tuple
                     │              │              │    └── projections
                     │              │              │         └── variable: a:1 [as=c:8]
                     │              │              └── projections
                     │              │                   └── udf: stmt_if_1 [as=stmt_if_1:9]
                     │              │                        ├── args
                     │              │                        │    ├── variable: c:8
                     │              │                        │    ├── variable: a:1
                     │              │                        │    └── variable: b:2
                     │              │                        ├── params: c:4 a:5 b:6
                     │              │                        └── body
                     │              │                             └── project
                     │              │                                  ├── columns: stmt_return_2:7
                     │              │                                  ├── values
                     │              │                                  │    └── tuple
                     │              │                                  └── projections
                     │              │                                       └── variable: c:4 [as=stmt_return_2:7]
                     │              └── subquery
                     │                   └── project
                     │                        ├── columns: stmt_if_1:11
                     │                        ├── project
                     │                        │    ├── columns: c:10
                     │                        │    ├── values
                     │                        │    │    └── tuple
                     │                        │    └── projections
                     │                        │         └── variable: b:2 [as=c:10]
                     │                        └── projections
                     │                             └── udf: stmt_if_1 [as=stmt_if_1:11]
                     │                                  ├── args
                     │                                  │    ├── variable: c:10
                     │                                  │    ├── variable: a:1
                     │                                  │    └── variable: b:2
                     │                                  ├── params: c:4 a:5 b:6
                     │                                  └── body
                     │                                       └── project
                     │                                            ├── columns: stmt_return_2:7
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── variable: c:4 [as=stmt_return_2:7]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    IF a < b THEN
      c := a;
    ELSE
      RETURN 100;
    END IF;
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:12
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:12]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_if_4:11
                     ├── project
                     │    ├── columns: stmt_if_4:11
                     │    ├── project
                     │    │    ├── columns: c:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=c:3]
                     │    │              └── null
                     │    └── projections
                     │         └── case [as=stmt_if_4:11]
                     │              ├── true
                     │              ├── when
                     │              │    ├── lt
                     │              │    │    ├── variable: a:1
                     │              │    │    └── variable: b:2
                     │              │    └── subquery
                     │              │         └── project
                     │              │              ├── columns: stmt_if_1:9
                     │              │              ├── project
                     │              │              │    ├── columns: c:8
                     │              │              │    ├── values
                     │              │              │    │    └── tuple
                     │              │              │    └── projections
                     │              │              │         └── variable: a:1 [as=c:8]
                     │              │              └── projections
                     │              │                   └── udf: stmt_if_1 [as=stmt_if_1:9]
                     │              │                        ├── args
                     │              │                        │    ├── variable: c:8
                     │              │                        │    ├── variable: a:1
                     │              │                        │    └── variable: b:2
                     │              │                        ├── params: c:4 a:5 b:6
                     │              │                        └── body
                     │              │                             └── project
                     │              │                                  ├── columns: stmt_return_2:7
                     │              │                                  ├── values
                     │              │                                  │    └── tuple
                     │              │                                  └── projections
                     │              │                                       └── variable: c:4 [as=stmt_return_2:7]
                     │              └── subquery
                     │                   └── project
                     │                        ├── columns: stmt_return_3:10!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 100 [as=stmt_return_3:10]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    IF a < b THEN
      RETURN 100;
    ELSE
      c := b;
    END IF;
    RETURN c;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:12
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:12]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_if_4:11
                     ├── project
                     │    ├── columns: stmt_if_4:11
                     │    ├── project
                     │    │    ├── columns: c:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=c:3]
                     │    │              └── null
                     │    └── projections
                     │         └── case [as=stmt_if_4:11]
                     │              ├── true
                     │              ├── when
                     │              │    ├── lt
                     │              │    │    ├── variable: a:1
                     │              │    │    └── variable: b:2
                     │              │    └── subquery
                     │              │         └── project
                     │              │              ├── columns: stmt_return_3:8!null
                     │              │              ├── values
                     │              │              │    └── tuple
                     │              │              └── projections
                     │              │                   └── const: 100 [as=stmt_return_3:8]
                     │              └── subquery
                     │                   └── project
                     │                        ├── columns: stmt_if_1:10
                     │                        ├── project
                     │                        │    ├── columns: c:9
                     │                        │    ├── values
                     │                        │    │    └── tuple
                     │                        │    └── projections
                     │                        │         └── variable: b:2 [as=c:9]
                     │                        └── projections
                     │                             └── udf: stmt_if_1 [as=stmt_if_1:10]
                     │                                  ├── args
                     │                                  │    ├── variable: c:9
                     │                                  │    ├── variable: a:1
                     │                                  │    └── variable: b:2
                     │                                  ├── params: c:4 a:5 b:6
                     │                                  └── body
                     │                                       └── project
                     │                                            ├── columns: stmt_return_2:7
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── variable: c:4 [as=stmt_return_2:7]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    c INT;
  BEGIN
    IF a < b THEN
      RETURN 100;
    ELSE
      RETURN 0;
    END IF;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:10
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:10]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_if_4:9
                     ├── project
                     │    ├── columns: stmt_if_4:9
                     │    ├── project
                     │    │    ├── columns: c:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=c:3]
                     │    │              └── null
                     │    └── projections
                     │         └── case [as=stmt_if_4:9]
                     │              ├── true
                     │              ├── when
                     │              │    ├── lt
                     │              │    │    ├── variable: a:1
                     │              │    │    └── variable: b:2
                     │              │    └── subquery
                     │              │         └── project
                     │              │              ├── columns: stmt_return_2:7!null
                     │              │              ├── values
                     │              │              │    └── tuple
                     │              │              └── projections
                     │              │                   └── const: 100 [as=stmt_return_2:7]
                     │              └── subquery
                     │                   └── project
                     │                        ├── columns: stmt_return_3:8!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 0 [as=stmt_return_3:8]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    i INT := a;
  BEGIN
    LOOP
      RETURN 100;
    END LOOP;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:12
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:12]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_loop_2:11
                     ├── project
                     │    ├── columns: stmt_loop_2:11
                     │    ├── project
                     │    │    ├── columns: i:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── variable: a:1 [as=i:3]
                     │    └── projections
                     │         └── udf: stmt_loop_2 [as=stmt_loop_2:11]
                     │              ├── args
                     │              │    ├── variable: i:3
                     │              │    ├── variable: a:1
                     │              │    └── variable: b:2
                     │              ├── params: i:7 a:8 b:9
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_return_3:10!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 100 [as=stmt_return_3:10]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    i INT := a;
  BEGIN
    LOOP
      IF a < b THEN
        RETURN 0;
      END IF;
      RETURN 100;
    END LOOP;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:18
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:18]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_loop_2:17
                     ├── project
                     │    ├── columns: stmt_loop_2:17
                     │    ├── project
                     │    │    ├── columns: i:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── variable: a:1 [as=i:3]
                     │    └── projections
                     │         └── udf: stmt_loop_2 [as=stmt_loop_2:17]
                     │              ├── args
                     │              │    ├── variable: i:3
                     │              │    ├── variable: a:1
                     │              │    └── variable: b:2
                     │              ├── params: i:7 a:8 b:9
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_6:16
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_6:16]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── lt
                     │                                  │    │    ├── variable: a:8
                     │                                  │    │    └── variable: b:9
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: stmt_return_5:14!null
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── const: 0 [as=stmt_return_5:14]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_3:15
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_3 [as=stmt_if_3:15]
                     │                                                      ├── args
                     │                                                      │    ├── variable: i:7
                     │                                                      │    ├── variable: a:8
                     │                                                      │    └── variable: b:9
                     │                                                      ├── params: i:10 a:11 b:12
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: stmt_return_4:13!null
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── const: 100 [as=stmt_return_4:13]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    i INT := a;
  BEGIN
    LOOP
      IF i >= b THEN EXIT; END IF;
      IF i = 8 THEN RETURN 100; END IF;
      i := i + 1;
    END LOOP;
    RETURN i;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 2);
----
project
 ├── columns: f:26
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:26]
           ├── args
           │    ├── const: 1
           │    └── const: 2
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_loop_3:25
                     ├── project
                     │    ├── columns: stmt_loop_3:25
                     │    ├── project
                     │    │    ├── columns: i:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── variable: a:1 [as=i:3]
                     │    └── projections
                     │         └── udf: stmt_loop_3 [as=stmt_loop_3:25]
                     │              ├── args
                     │              │    ├── variable: i:3
                     │              │    ├── variable: a:1
                     │              │    └── variable: b:2
                     │              ├── params: i:8 a:9 b:10
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_8:24
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_8:24]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── ge
                     │                                  │    │    ├── variable: i:8
                     │                                  │    │    └── variable: b:10
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: loop_exit_1:22
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:22]
                     │                                  │                        ├── args
                     │                                  │                        │    ├── variable: i:8
                     │                                  │                        │    ├── variable: a:9
                     │                                  │                        │    └── variable: b:10
                     │                                  │                        ├── params: i:4 a:5 b:6
                     │                                  │                        └── body
                     │                                  │                             └── project
                     │                                  │                                  ├── columns: stmt_return_2:7
                     │                                  │                                  ├── values
                     │                                  │                                  │    └── tuple
                     │                                  │                                  └── projections
                     │                                  │                                       └── variable: i:4 [as=stmt_return_2:7]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_4:23
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_4 [as=stmt_if_4:23]
                     │                                                      ├── args
                     │                                                      │    ├── variable: i:8
                     │                                                      │    ├── variable: a:9
                     │                                                      │    └── variable: b:10
                     │                                                      ├── params: i:11 a:12 b:13
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: stmt_if_7:21
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── case [as=stmt_if_7:21]
                     │                                                                          ├── true
                     │                                                                          ├── when
                     │                                                                          │    ├── eq
                     │                                                                          │    │    ├── variable: i:11
                     │                                                                          │    │    └── const: 8
                     │                                                                          │    └── subquery
                     │                                                                          │         └── project
                     │                                                                          │              ├── columns: stmt_return_6:19!null
                     │                                                                          │              ├── values
                     │                                                                          │              │    └── tuple
                     │                                                                          │              └── projections
                     │                                                                          │                   └── const: 100 [as=stmt_return_6:19]
                     │                                                                          └── subquery
                     │                                                                               └── project
                     │                                                                                    ├── columns: stmt_if_5:20
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── udf: stmt_if_5 [as=stmt_if_5:20]
                     │                                                                                              ├── args
                     │                                                                                              │    ├── variable: i:11
                     │                                                                                              │    ├── variable: a:12
                     │                                                                                              │    └── variable: b:13
                     │                                                                                              ├── params: i:14 a:15 b:16
                     │                                                                                              └── body
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: stmt_loop_3:18
                     │                                                                                                        ├── project
                     │                                                                                                        │    ├── columns: i:17
                     │                                                                                                        │    ├── values
                     │                                                                                                        │    │    └── tuple
                     │                                                                                                        │    └── projections
                     │                                                                                                        │         └── plus [as=i:17]
                     │                                                                                                        │              ├── variable: i:14
                     │                                                                                                        │              └── const: 1
                     │                                                                                                        └── projections
                     │                                                                                                             └── udf: stmt_loop_3 [as=stmt_loop_3:18]
                     │                                                                                                                  ├── args
                     │                                                                                                                  │    ├── variable: i:17
                     │                                                                                                                  │    ├── variable: a:15
                     │                                                                                                                  │    └── variable: b:16
                     │                                                                                                                  └── recursive-call
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    i INT := a;
  BEGIN
    LOOP
      IF i >= b THEN EXIT; END IF;
      i := i + 1;
    END LOOP;
    RETURN i;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 5);
----
project
 ├── columns: f:20
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:20]
           ├── args
           │    ├── const: 1
           │    └── const: 5
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_loop_3:19
                     ├── project
                     │    ├── columns: stmt_loop_3:19
                     │    ├── project
                     │    │    ├── columns: i:3
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── variable: a:1 [as=i:3]
                     │    └── projections
                     │         └── udf: stmt_loop_3 [as=stmt_loop_3:19]
                     │              ├── args
                     │              │    ├── variable: i:3
                     │              │    ├── variable: a:1
                     │              │    └── variable: b:2
                     │              ├── params: i:8 a:9 b:10
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_5:18
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_5:18]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── ge
                     │                                  │    │    ├── variable: i:8
                     │                                  │    │    └── variable: b:10
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: loop_exit_1:16
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:16]
                     │                                  │                        ├── args
                     │                                  │                        │    ├── variable: i:8
                     │                                  │                        │    ├── variable: a:9
                     │                                  │                        │    └── variable: b:10
                     │                                  │                        ├── params: i:4 a:5 b:6
                     │                                  │                        └── body
                     │                                  │                             └── project
                     │                                  │                                  ├── columns: stmt_return_2:7
                     │                                  │                                  ├── values
                     │                                  │                                  │    └── tuple
                     │                                  │                                  └── projections
                     │                                  │                                       └── variable: i:4 [as=stmt_return_2:7]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_4:17
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_4 [as=stmt_if_4:17]
                     │                                                      ├── args
                     │                                                      │    ├── variable: i:8
                     │                                                      │    ├── variable: a:9
                     │                                                      │    └── variable: b:10
                     │                                                      ├── params: i:11 a:12 b:13
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: stmt_loop_3:15
                     │                                                                ├── project
                     │                                                                │    ├── columns: i:14
                     │                                                                │    ├── values
                     │                                                                │    │    └── tuple
                     │                                                                │    └── projections
                     │                                                                │         └── plus [as=i:14]
                     │                                                                │              ├── variable: i:11
                     │                                                                │              └── const: 1
                     │                                                                └── projections
                     │                                                                     └── udf: stmt_loop_3 [as=stmt_loop_3:15]
                     │                                                                          ├── args
                     │                                                                          │    ├── variable: i:14
                     │                                                                          │    ├── variable: a:12
                     │                                                                          │    └── variable: b:13
                     │                                                                          └── recursive-call
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    sum INT := 0;
    i INT := a;
  BEGIN
    IF a IS NOT NULL AND b is NOT NULL THEN
      LOOP
        IF i >= b THEN EXIT; END IF;
        sum := sum + i;
        i := i + 1;
      END LOOP;
    END IF;
    RETURN sum;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(0, 0);
----
project
 ├── columns: f:32
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:32]
           ├── args
           │    ├── const: 0
           │    └── const: 0
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_if_7:31
                     ├── project
                     │    ├── columns: stmt_if_7:31
                     │    ├── project
                     │    │    ├── columns: i:4 sum:3!null
                     │    │    ├── project
                     │    │    │    ├── columns: sum:3!null
                     │    │    │    ├── values
                     │    │    │    │    └── tuple
                     │    │    │    └── projections
                     │    │    │         └── const: 0 [as=sum:3]
                     │    │    └── projections
                     │    │         └── variable: a:1 [as=i:4]
                     │    └── projections
                     │         └── case [as=stmt_if_7:31]
                     │              ├── true
                     │              ├── when
                     │              │    ├── and
                     │              │    │    ├── is-not
                     │              │    │    │    ├── variable: a:1
                     │              │    │    │    └── null
                     │              │    │    └── is-not
                     │              │    │         ├── variable: b:2
                     │              │    │         └── null
                     │              │    └── subquery
                     │              │         └── project
                     │              │              ├── columns: stmt_loop_4:29
                     │              │              ├── values
                     │              │              │    └── tuple
                     │              │              └── projections
                     │              │                   └── udf: stmt_loop_4 [as=stmt_loop_4:29]
                     │              │                        ├── args
                     │              │                        │    ├── variable: sum:3
                     │              │                        │    ├── variable: i:4
                     │              │                        │    ├── variable: a:1
                     │              │                        │    └── variable: b:2
                     │              │                        ├── params: sum:15 i:16 a:17 b:18
                     │              │                        └── body
                     │              │                             └── project
                     │              │                                  ├── columns: stmt_if_6:28
                     │              │                                  ├── values
                     │              │                                  │    └── tuple
                     │              │                                  └── projections
                     │              │                                       └── case [as=stmt_if_6:28]
                     │              │                                            ├── true
                     │              │                                            ├── when
                     │              │                                            │    ├── ge
                     │              │                                            │    │    ├── variable: i:16
                     │              │                                            │    │    └── variable: b:18
                     │              │                                            │    └── subquery
                     │              │                                            │         └── project
                     │              │                                            │              ├── columns: loop_exit_3:26
                     │              │                                            │              ├── values
                     │              │                                            │              │    └── tuple
                     │              │                                            │              └── projections
                     │              │                                            │                   └── udf: loop_exit_3 [as=loop_exit_3:26]
                     │              │                                            │                        ├── args
                     │              │                                            │                        │    ├── variable: sum:15
                     │              │                                            │                        │    ├── variable: i:16
                     │              │                                            │                        │    ├── variable: a:17
                     │              │                                            │                        │    └── variable: b:18
                     │              │                                            │                        ├── params: sum:10 i:11 a:12 b:13
                     │              │                                            │                        └── body
                     │              │                                            │                             └── project
                     │              │                                            │                                  ├── columns: stmt_if_1:14
                     │              │                                            │                                  ├── values
                     │              │                                            │                                  │    └── tuple
                     │              │                                            │                                  └── projections
                     │              │                                            │                                       └── udf: stmt_if_1 [as=stmt_if_1:14]
                     │              │                                            │                                            ├── args
                     │              │                                            │                                            │    ├── variable: sum:10
                     │              │                                            │                                            │    ├── variable: i:11
                     │              │                                            │                                            │    ├── variable: a:12
                     │              │                                            │                                            │    └── variable: b:13
                     │              │                                            │                                            ├── params: sum:5 i:6 a:7 b:8
                     │              │                                            │                                            └── body
                     │              │                                            │                                                 └── project
                     │              │                                            │                                                      ├── columns: stmt_return_2:9
                     │              │                                            │                                                      ├── values
                     │              │                                            │                                                      │    └── tuple
                     │              │                                            │                                                      └── projections
                     │              │                                            │                                                           └── variable: sum:5 [as=stmt_return_2:9]
                     │              │                                            └── subquery
                     │              │                                                 └── project
                     │              │                                                      ├── columns: stmt_if_5:27
                     │              │                                                      ├── values
                     │              │                                                      │    └── tuple
                     │              │                                                      └── projections
                     │              │                                                           └── udf: stmt_if_5 [as=stmt_if_5:27]
                     │              │                                                                ├── args
                     │              │                                                                │    ├── variable: sum:15
                     │              │                                                                │    ├── variable: i:16
                     │              │                                                                │    ├── variable: a:17
                     │              │                                                                │    └── variable: b:18
                     │              │                                                                ├── params: sum:19 i:20 a:21 b:22
                     │              │                                                                └── body
                     │              │                                                                     └── project
                     │              │                                                                          ├── columns: stmt_loop_4:25
                     │              │                                                                          ├── project
                     │              │                                                                          │    ├── columns: i:24 sum:23
                     │              │                                                                          │    ├── project
                     │              │                                                                          │    │    ├── columns: sum:23
                     │              │                                                                          │    │    ├── values
                     │              │                                                                          │    │    │    └── tuple
                     │              │                                                                          │    │    └── projections
                     │              │                                                                          │    │         └── plus [as=sum:23]
                     │              │                                                                          │    │              ├── variable: sum:19
                     │              │                                                                          │    │              └── variable: i:20
                     │              │                                                                          │    └── projections
                     │              │                                                                          │         └── plus [as=i:24]
                     │              │                                                                          │              ├── variable: i:20
                     │              │                                                                          │              └── const: 1
                     │              │                                                                          └── projections
                     │              │                                                                               └── udf: stmt_loop_4 [as=stmt_loop_4:25]
                     │              │                                                                                    ├── args
                     │              │                                                                                    │    ├── variable: sum:23
                     │              │                                                                                    │    ├── variable: i:24
                     │              │                                                                                    │    ├── variable: a:21
                     │              │                                                                                    │    └── variable: b:22
                     │              │                                                                                    └── recursive-call
                     │              └── subquery
                     │                   └── project
                     │                        ├── columns: stmt_if_1:30
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── udf: stmt_if_1 [as=stmt_if_1:30]
                     │                                  ├── args
                     │                                  │    ├── variable: sum:3
                     │                                  │    ├── variable: i:4
                     │                                  │    ├── variable: a:1
                     │                                  │    └── variable: b:2
                     │                                  ├── params: sum:5 i:6 a:7 b:8
                     │                                  └── body
                     │                                       └── project
                     │                                            ├── columns: stmt_return_2:9
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── variable: sum:5 [as=stmt_return_2:9]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    sum INT := 0;
    i INT := a;
  BEGIN
    LOOP
      IF i >= b THEN EXIT; END IF;
      IF i = 2 THEN 
        i := i + 1;
        CONTINUE;
      END IF;
      sum := sum + i;
      i := i + 1;
    END LOOP;
    RETURN sum;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(5, -5);
----
project
 ├── columns: f:33
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:33]
           ├── args
           │    ├── const: 5
           │    └── const: -5
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_loop_3:32
                     ├── project
                     │    ├── columns: stmt_loop_3:32
                     │    ├── project
                     │    │    ├── columns: i:4 sum:3!null
                     │    │    ├── project
                     │    │    │    ├── columns: sum:3!null
                     │    │    │    ├── values
                     │    │    │    │    └── tuple
                     │    │    │    └── projections
                     │    │    │         └── const: 0 [as=sum:3]
                     │    │    └── projections
                     │    │         └── variable: a:1 [as=i:4]
                     │    └── projections
                     │         └── udf: stmt_loop_3 [as=stmt_loop_3:32]
                     │              ├── args
                     │              │    ├── variable: sum:3
                     │              │    ├── variable: i:4
                     │              │    ├── variable: a:1
                     │              │    └── variable: b:2
                     │              ├── params: sum:10 i:11 a:12 b:13
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_7:31
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_7:31]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── ge
                     │                                  │    │    ├── variable: i:11
                     │                                  │    │    └── variable: b:13
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: loop_exit_1:29
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:29]
                     │                                  │                        ├── args
                     │                                  │                        │    ├── variable: sum:10
                     │                                  │                        │    ├── variable: i:11
                     │                                  │                        │    ├── variable: a:12
                     │                                  │                        │    └── variable: b:13
                     │                                  │                        ├── params: sum:5 i:6 a:7 b:8
                     │                                  │                        └── body
                     │                                  │                             └── project
                     │                                  │                                  ├── columns: stmt_return_2:9
                     │                                  │                                  ├── values
                     │                                  │                                  │    └── tuple
                     │                                  │                                  └── projections
                     │                                  │                                       └── variable: sum:5 [as=stmt_return_2:9]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_4:30
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_4 [as=stmt_if_4:30]
                     │                                                      ├── args
                     │                                                      │    ├── variable: sum:10
                     │                                                      │    ├── variable: i:11
                     │                                                      │    ├── variable: a:12
                     │                                                      │    └── variable: b:13
                     │                                                      ├── params: sum:14 i:15 a:16 b:17
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: stmt_if_6:28
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── case [as=stmt_if_6:28]
                     │                                                                          ├── true
                     │                                                                          ├── when
                     │                                                                          │    ├── eq
                     │                                                                          │    │    ├── variable: i:15
                     │                                                                          │    │    └── const: 2
                     │                                                                          │    └── subquery
                     │                                                                          │         └── project
                     │                                                                          │              ├── columns: stmt_loop_3:26
                     │                                                                          │              ├── project
                     │                                                                          │              │    ├── columns: i:25
                     │                                                                          │              │    ├── values
                     │                                                                          │              │    │    └── tuple
                     │                                                                          │              │    └── projections
                     │                                                                          │              │         └── plus [as=i:25]
                     │                                                                          │              │              ├── variable: i:15
                     │                                                                          │              │              └── const: 1
                     │                                                                          │              └── projections
                     │                                                                          │                   └── udf: stmt_loop_3 [as=stmt_loop_3:26]
                     │                                                                          │                        ├── args
                     │                                                                          │                        │    ├── variable: sum:14
                     │                                                                          │                        │    ├── variable: i:25
                     │                                                                          │                        │    ├── variable: a:16
                     │                                                                          │                        │    └── variable: b:17
                     │                                                                          │                        └── recursive-call
                     │                                                                          └── subquery
                     │                                                                               └── project
                     │                                                                                    ├── columns: stmt_if_5:27
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── udf: stmt_if_5 [as=stmt_if_5:27]
                     │                                                                                              ├── args
                     │                                                                                              │    ├── variable: sum:14
                     │                                                                                              │    ├── variable: i:15
                     │                                                                                              │    ├── variable: a:16
                     │                                                                                              │    └── variable: b:17
                     │                                                                                              ├── params: sum:18 i:19 a:20 b:21
                     │                                                                                              └── body
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: stmt_loop_3:24
                     │                                                                                                        ├── project
                     │                                                                                                        │    ├── columns: i:23 sum:22
                     │                                                                                                        │    ├── project
                     │                                                                                                        │    │    ├── columns: sum:22
                     │                                                                                                        │    │    ├── values
                     │                                                                                                        │    │    │    └── tuple
                     │                                                                                                        │    │    └── projections
                     │                                                                                                        │    │         └── plus [as=sum:22]
                     │                                                                                                        │    │              ├── variable: sum:18
                     │                                                                                                        │    │              └── variable: i:19
                     │                                                                                                        │    └── projections
                     │                                                                                                        │         └── plus [as=i:23]
                     │                                                                                                        │              ├── variable: i:19
                     │                                                                                                        │              └── const: 1
                     │                                                                                                        └── projections
                     │                                                                                                             └── udf: stmt_loop_3 [as=stmt_loop_3:24]
                     │                                                                                                                  ├── args
                     │                                                                                                                  │    ├── variable: sum:22
                     │                                                                                                                  │    ├── variable: i:23
                     │                                                                                                                  │    ├── variable: a:20
                     │                                                                                                                  │    └── variable: b:21
                     │                                                                                                                  └── recursive-call
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f(a INT, b INT) RETURNS INT AS $$
  DECLARE
    sum INT := 0;
    i INT := a;
    j INT;
  BEGIN
    LOOP
      IF i >= b THEN EXIT; END IF;
      j := 0;
      LOOP
        IF j >= i THEN EXIT; END IF;
        sum := sum + j;
        j := j + 1;
      END LOOP;
      i := i + 1;
    END LOOP;
    RETURN sum;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f(1, 5)
----
project
 ├── columns: f:51
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:51]
           ├── args
           │    ├── const: 1
           │    └── const: 5
           ├── params: a:1 b:2
           └── body
                └── limit
                     ├── columns: stmt_loop_3:50
                     ├── project
                     │    ├── columns: stmt_loop_3:50
                     │    ├── project
                     │    │    ├── columns: j:5 sum:3!null i:4
                     │    │    ├── project
                     │    │    │    ├── columns: i:4 sum:3!null
                     │    │    │    ├── project
                     │    │    │    │    ├── columns: sum:3!null
                     │    │    │    │    ├── values
                     │    │    │    │    │    └── tuple
                     │    │    │    │    └── projections
                     │    │    │    │         └── const: 0 [as=sum:3]
                     │    │    │    └── projections
                     │    │    │         └── variable: a:1 [as=i:4]
                     │    │    └── projections
                     │    │         └── cast: INT8 [as=j:5]
                     │    │              └── null
                     │    └── projections
                     │         └── udf: stmt_loop_3 [as=stmt_loop_3:50]
                     │              ├── args
                     │              │    ├── variable: sum:3
                     │              │    ├── variable: i:4
                     │              │    ├── variable: j:5
                     │              │    ├── variable: a:1
                     │              │    └── variable: b:2
                     │              ├── params: sum:12 i:13 j:14 a:15 b:16
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_9:49
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_9:49]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── ge
                     │                                  │    │    ├── variable: i:13
                     │                                  │    │    └── variable: b:16
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: loop_exit_1:47
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:47]
                     │                                  │                        ├── args
                     │                                  │                        │    ├── variable: sum:12
                     │                                  │                        │    ├── variable: i:13
                     │                                  │                        │    ├── variable: j:14
                     │                                  │                        │    ├── variable: a:15
                     │                                  │                        │    └── variable: b:16
                     │                                  │                        ├── params: sum:6 i:7 j:8 a:9 b:10
                     │                                  │                        └── body
                     │                                  │                             └── project
                     │                                  │                                  ├── columns: stmt_return_2:11
                     │                                  │                                  ├── values
                     │                                  │                                  │    └── tuple
                     │                                  │                                  └── projections
                     │                                  │                                       └── variable: sum:6 [as=stmt_return_2:11]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_4:48
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_4 [as=stmt_if_4:48]
                     │                                                      ├── args
                     │                                                      │    ├── variable: sum:12
                     │                                                      │    ├── variable: i:13
                     │                                                      │    ├── variable: j:14
                     │                                                      │    ├── variable: a:15
                     │                                                      │    └── variable: b:16
                     │                                                      ├── params: sum:17 i:18 j:19 a:20 b:21
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: stmt_loop_6:46
                     │                                                                ├── project
                     │                                                                │    ├── columns: j:22!null
                     │                                                                │    ├── values
                     │                                                                │    │    └── tuple
                     │                                                                │    └── projections
                     │                                                                │         └── const: 0 [as=j:22]
                     │                                                                └── projections
                     │                                                                     └── udf: stmt_loop_6 [as=stmt_loop_6:46]
                     │                                                                          ├── args
                     │                                                                          │    ├── variable: sum:17
                     │                                                                          │    ├── variable: i:18
                     │                                                                          │    ├── variable: j:22
                     │                                                                          │    ├── variable: a:20
                     │                                                                          │    └── variable: b:21
                     │                                                                          ├── params: sum:30 i:31 j:32 a:33 b:34
                     │                                                                          └── body
                     │                                                                               └── project
                     │                                                                                    ├── columns: stmt_if_8:45
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── case [as=stmt_if_8:45]
                     │                                                                                              ├── true
                     │                                                                                              ├── when
                     │                                                                                              │    ├── ge
                     │                                                                                              │    │    ├── variable: j:32
                     │                                                                                              │    │    └── variable: i:31
                     │                                                                                              │    └── subquery
                     │                                                                                              │         └── project
                     │                                                                                              │              ├── columns: loop_exit_5:43
                     │                                                                                              │              ├── values
                     │                                                                                              │              │    └── tuple
                     │                                                                                              │              └── projections
                     │                                                                                              │                   └── udf: loop_exit_5 [as=loop_exit_5:43]
                     │                                                                                              │                        ├── args
                     │                                                                                              │                        │    ├── variable: sum:30
                     │                                                                                              │                        │    ├── variable: i:31
                     │                                                                                              │                        │    ├── variable: j:32
                     │                                                                                              │                        │    ├── variable: a:33
                     │                                                                                              │                        │    └── variable: b:34
                     │                                                                                              │                        ├── params: sum:23 i:24 j:25 a:26 b:27
                     │                                                                                              │                        └── body
                     │                                                                                              │                             └── project
                     │                                                                                              │                                  ├── columns: stmt_loop_3:29
                     │                                                                                              │                                  ├── project
                     │                                                                                              │                                  │    ├── columns: i:28
                     │                                                                                              │                                  │    ├── values
                     │                                                                                              │                                  │    │    └── tuple
                     │                                                                                              │                                  │    └── projections
                     │                                                                                              │                                  │         └── plus [as=i:28]
                     │                                                                                              │                                  │              ├── variable: i:24
                     │                                                                                              │                                  │              └── const: 1
                     │                                                                                              │                                  └── projections
                     │                                                                                              │                                       └── udf: stmt_loop_3 [as=stmt_loop_3:29]
                     │                                                                                              │                                            ├── args
                     │                                                                                              │                                            │    ├── variable: sum:23
                     │                                                                                              │                                            │    ├── variable: i:28
                     │                                                                                              │                                            │    ├── variable: j:25
                     │                                                                                              │                                            │    ├── variable: a:26
                     │                                                                                              │                                            │    └── variable: b:27
                     │                                                                                              │                                            └── recursive-call
                     │                                                                                              └── subquery
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: stmt_if_7:44
                     │                                                                                                        ├── values
                     │                                                                                                        │    └── tuple
                     │                                                                                                        └── projections
                     │                                                                                                             └── udf: stmt_if_7 [as=stmt_if_7:44]
                     │                                                                                                                  ├── args
                     │                                                                                                                  │    ├── variable: sum:30
                     │                                                                                                                  │    ├── variable: i:31
                     │                                                                                                                  │    ├── variable: j:32
                     │                                                                                                                  │    ├── variable: a:33
                     │                                                                                                                  │    └── variable: b:34
                     │                                                                                                                  ├── params: sum:35 i:36 j:37 a:38 b:39
                     │                                                                                                                  └── body
                     │                                                                                                                       └── project
                     │                                                                                                                            ├── columns: stmt_loop_6:42
                     │                                                                                                                            ├── project
                     │                                                                                                                            │    ├── columns: j:41 sum:40
                     │                                                                                                                            │    ├── project
                     │                                                                                                                            │    │    ├── columns: sum:40
                     │                                                                                                                            │    │    ├── values
                     │                                                                                                                            │    │    │    └── tuple
                     │                                                                                                                            │    │    └── projections
                     │                                                                                                                            │    │         └── plus [as=sum:40]
                     │                                                                                                                            │    │              ├── variable: sum:35
                     │                                                                                                                            │    │              └── variable: j:37
                     │                                                                                                                            │    └── projections
                     │                                                                                                                            │         └── plus [as=j:41]
                     │                                                                                                                            │              ├── variable: j:37
                     │                                                                                                                            │              └── const: 1
                     │                                                                                                                            └── projections
                     │                                                                                                                                 └── udf: stmt_loop_6 [as=stmt_loop_6:42]
                     │                                                                                                                                      ├── args
                     │                                                                                                                                      │    ├── variable: sum:40
                     │                                                                                                                                      │    ├── variable: i:36
                     │                                                                                                                                      │    ├── variable: j:41
                     │                                                                                                                                      │    ├── variable: a:38
                     │                                                                                                                                      │    └── variable: b:39
                     │                                                                                                                                      └── recursive-call
                     └── const: 1

# TODO(drewk): consider adding a norm rules to fold nested UDFs.
# Testing RAISE statements.
exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE DEBUG 'foo';
    RAISE LOG 'foo';
    RAISE INFO 'foo';
    RAISE NOTICE 'foo';
    RAISE WARNING 'foo';
    return 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:12
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:12]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":11
                     ├── project
                     │    ├── columns: "_stmt_raise_1":11
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":11]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'DEBUG1'
                     │                   │              ├── const: 'foo'
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: '00000'
                     │                   └── project
                     │                        ├── columns: "_stmt_raise_3":10
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── udf: _stmt_raise_3 [as="_stmt_raise_3":10]
                     │                                  └── body
                     │                                       ├── project
                     │                                       │    ├── columns: stmt_raise_4:2
                     │                                       │    ├── values
                     │                                       │    │    └── tuple
                     │                                       │    └── projections
                     │                                       │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_4:2]
                     │                                       │              ├── const: 'LOG'
                     │                                       │              ├── const: 'foo'
                     │                                       │              ├── const: ''
                     │                                       │              ├── const: ''
                     │                                       │              └── const: '00000'
                     │                                       └── project
                     │                                            ├── columns: "_stmt_raise_5":9
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: _stmt_raise_5 [as="_stmt_raise_5":9]
                     │                                                      └── body
                     │                                                           ├── project
                     │                                                           │    ├── columns: stmt_raise_6:3
                     │                                                           │    ├── values
                     │                                                           │    │    └── tuple
                     │                                                           │    └── projections
                     │                                                           │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_6:3]
                     │                                                           │              ├── const: 'INFO'
                     │                                                           │              ├── const: 'foo'
                     │                                                           │              ├── const: ''
                     │                                                           │              ├── const: ''
                     │                                                           │              └── const: '00000'
                     │                                                           └── project
                     │                                                                ├── columns: "_stmt_raise_7":8
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── udf: _stmt_raise_7 [as="_stmt_raise_7":8]
                     │                                                                          └── body
                     │                                                                               ├── project
                     │                                                                               │    ├── columns: stmt_raise_8:4
                     │                                                                               │    ├── values
                     │                                                                               │    │    └── tuple
                     │                                                                               │    └── projections
                     │                                                                               │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_8:4]
                     │                                                                               │              ├── const: 'NOTICE'
                     │                                                                               │              ├── const: 'foo'
                     │                                                                               │              ├── const: ''
                     │                                                                               │              ├── const: ''
                     │                                                                               │              └── const: '00000'
                     │                                                                               └── project
                     │                                                                                    ├── columns: "_stmt_raise_9":7
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── udf: _stmt_raise_9 [as="_stmt_raise_9":7]
                     │                                                                                              └── body
                     │                                                                                                   ├── project
                     │                                                                                                   │    ├── columns: stmt_raise_10:5
                     │                                                                                                   │    ├── values
                     │                                                                                                   │    │    └── tuple
                     │                                                                                                   │    └── projections
                     │                                                                                                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_10:5]
                     │                                                                                                   │              ├── const: 'WARNING'
                     │                                                                                                   │              ├── const: 'foo'
                     │                                                                                                   │              ├── const: ''
                     │                                                                                                   │              ├── const: ''
                     │                                                                                                   │              └── const: '00000'
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: stmt_return_11:6!null
                     │                                                                                                        ├── values
                     │                                                                                                        │    └── tuple
                     │                                                                                                        └── projections
                     │                                                                                                             └── const: 0 [as=stmt_return_11:6]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE NOTICE '%', 1;
    RAISE NOTICE 'foo: %, %, %', 1, 2, 3;
    RAISE NOTICE '%%';
    RAISE NOTICE '%%%', 1;
    RAISE NOTICE '%%%foo%% bar%%%% %% %%%% ba%z%', 1, 2, 3;
    RETURN 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:12
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:12]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":11
                     ├── project
                     │    ├── columns: "_stmt_raise_1":11
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":11]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'NOTICE'
                     │                   │              ├── concat
                     │                   │              │    ├── concat
                     │                   │              │    │    ├── const: ''
                     │                   │              │    │    └── const: 1
                     │                   │              │    └── const: ''
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: '00000'
                     │                   └── project
                     │                        ├── columns: "_stmt_raise_3":10
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── udf: _stmt_raise_3 [as="_stmt_raise_3":10]
                     │                                  └── body
                     │                                       ├── project
                     │                                       │    ├── columns: stmt_raise_4:2
                     │                                       │    ├── values
                     │                                       │    │    └── tuple
                     │                                       │    └── projections
                     │                                       │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_4:2]
                     │                                       │              ├── const: 'NOTICE'
                     │                                       │              ├── concat
                     │                                       │              │    ├── concat
                     │                                       │              │    │    ├── concat
                     │                                       │              │    │    │    ├── concat
                     │                                       │              │    │    │    │    ├── concat
                     │                                       │              │    │    │    │    │    ├── concat
                     │                                       │              │    │    │    │    │    │    ├── const: 'foo: '
                     │                                       │              │    │    │    │    │    │    └── const: 1
                     │                                       │              │    │    │    │    │    └── const: ', '
                     │                                       │              │    │    │    │    └── const: 2
                     │                                       │              │    │    │    └── const: ', '
                     │                                       │              │    │    └── const: 3
                     │                                       │              │    └── const: ''
                     │                                       │              ├── const: ''
                     │                                       │              ├── const: ''
                     │                                       │              └── const: '00000'
                     │                                       └── project
                     │                                            ├── columns: "_stmt_raise_5":9
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: _stmt_raise_5 [as="_stmt_raise_5":9]
                     │                                                      └── body
                     │                                                           ├── project
                     │                                                           │    ├── columns: stmt_raise_6:3
                     │                                                           │    ├── values
                     │                                                           │    │    └── tuple
                     │                                                           │    └── projections
                     │                                                           │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_6:3]
                     │                                                           │              ├── const: 'NOTICE'
                     │                                                           │              ├── concat
                     │                                                           │              │    ├── concat
                     │                                                           │              │    │    ├── const: ''
                     │                                                           │              │    │    └── const: '%'
                     │                                                           │              │    └── const: ''
                     │                                                           │              ├── const: ''
                     │                                                           │              ├── const: ''
                     │                                                           │              └── const: '00000'
                     │                                                           └── project
                     │                                                                ├── columns: "_stmt_raise_7":8
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── udf: _stmt_raise_7 [as="_stmt_raise_7":8]
                     │                                                                          └── body
                     │                                                                               ├── project
                     │                                                                               │    ├── columns: stmt_raise_8:4
                     │                                                                               │    ├── values
                     │                                                                               │    │    └── tuple
                     │                                                                               │    └── projections
                     │                                                                               │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_8:4]
                     │                                                                               │              ├── const: 'NOTICE'
                     │                                                                               │              ├── concat
                     │                                                                               │              │    ├── concat
                     │                                                                               │              │    │    ├── concat
                     │                                                                               │              │    │    │    ├── concat
                     │                                                                               │              │    │    │    │    ├── const: ''
                     │                                                                               │              │    │    │    │    └── const: '%'
                     │                                                                               │              │    │    │    └── const: ''
                     │                                                                               │              │    │    └── const: 1
                     │                                                                               │              │    └── const: ''
                     │                                                                               │              ├── const: ''
                     │                                                                               │              ├── const: ''
                     │                                                                               │              └── const: '00000'
                     │                                                                               └── project
                     │                                                                                    ├── columns: "_stmt_raise_9":7
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── udf: _stmt_raise_9 [as="_stmt_raise_9":7]
                     │                                                                                              └── body
                     │                                                                                                   ├── project
                     │                                                                                                   │    ├── columns: stmt_raise_10:5
                     │                                                                                                   │    ├── values
                     │                                                                                                   │    │    └── tuple
                     │                                                                                                   │    └── projections
                     │                                                                                                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_10:5]
                     │                                                                                                   │              ├── const: 'NOTICE'
                     │                                                                                                   │              ├── concat
                     │                                                                                                   │              │    ├── concat
                     │                                                                                                   │              │    │    ├── concat
                     │                                                                                                   │              │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    ├── concat
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    ├── const: ''
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    └── const: '%'
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    └── const: ''
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    └── const: 1
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    └── const: 'foo'
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    └── const: '%'
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    └── const: ' bar'
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    │    └── const: '%'
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    │    └── const: ''
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    │    └── const: '%'
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    │    └── const: ' '
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    │    └── const: '%'
                     │                                                                                                   │              │    │    │    │    │    │    │    │    │    └── const: ' '
                     │                                                                                                   │              │    │    │    │    │    │    │    │    └── const: '%'
                     │                                                                                                   │              │    │    │    │    │    │    │    └── const: ''
                     │                                                                                                   │              │    │    │    │    │    │    └── const: '%'
                     │                                                                                                   │              │    │    │    │    │    └── const: ' ba'
                     │                                                                                                   │              │    │    │    │    └── const: 2
                     │                                                                                                   │              │    │    │    └── const: 'z'
                     │                                                                                                   │              │    │    └── const: 3
                     │                                                                                                   │              │    └── const: ''
                     │                                                                                                   │              ├── const: ''
                     │                                                                                                   │              ├── const: ''
                     │                                                                                                   │              └── const: '00000'
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: stmt_return_11:6!null
                     │                                                                                                        ├── values
                     │                                                                                                        │    └── tuple
                     │                                                                                                        └── projections
                     │                                                                                                             └── const: 0 [as=stmt_return_11:6]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE NOTICE division_by_zero;
    RAISE NOTICE null_value_not_allowed;
    RAISE NOTICE reading_sql_data_not_permitted;
    RAISE NOTICE SQLSTATE '22012';
    RAISE NOTICE SQLSTATE '22004';
    RAISE NOTICE SQLSTATE '39004';
    RAISE NOTICE SQLSTATE '2F004';
    RAISE NOTICE SQLSTATE '38004';
    return 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:18
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:18]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":17
                     ├── project
                     │    ├── columns: "_stmt_raise_1":17
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":17]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'NOTICE'
                     │                   │              ├── const: 'division_by_zero'
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: 'division_by_zero'
                     │                   └── project
                     │                        ├── columns: "_stmt_raise_3":16
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── udf: _stmt_raise_3 [as="_stmt_raise_3":16]
                     │                                  └── body
                     │                                       ├── project
                     │                                       │    ├── columns: stmt_raise_4:2
                     │                                       │    ├── values
                     │                                       │    │    └── tuple
                     │                                       │    └── projections
                     │                                       │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_4:2]
                     │                                       │              ├── const: 'NOTICE'
                     │                                       │              ├── const: 'null_value_not_allowed'
                     │                                       │              ├── const: ''
                     │                                       │              ├── const: ''
                     │                                       │              └── const: 'null_value_not_allowed'
                     │                                       └── project
                     │                                            ├── columns: "_stmt_raise_5":15
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: _stmt_raise_5 [as="_stmt_raise_5":15]
                     │                                                      └── body
                     │                                                           ├── project
                     │                                                           │    ├── columns: stmt_raise_6:3
                     │                                                           │    ├── values
                     │                                                           │    │    └── tuple
                     │                                                           │    └── projections
                     │                                                           │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_6:3]
                     │                                                           │              ├── const: 'NOTICE'
                     │                                                           │              ├── const: 'reading_sql_data_not_permitted'
                     │                                                           │              ├── const: ''
                     │                                                           │              ├── const: ''
                     │                                                           │              └── const: 'reading_sql_data_not_permitted'
                     │                                                           └── project
                     │                                                                ├── columns: "_stmt_raise_7":14
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── udf: _stmt_raise_7 [as="_stmt_raise_7":14]
                     │                                                                          └── body
                     │                                                                               ├── project
                     │                                                                               │    ├── columns: stmt_raise_8:4
                     │                                                                               │    ├── values
                     │                                                                               │    │    └── tuple
                     │                                                                               │    └── projections
                     │                                                                               │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_8:4]
                     │                                                                               │              ├── const: 'NOTICE'
                     │                                                                               │              ├── const: '22012'
                     │                                                                               │              ├── const: ''
                     │                                                                               │              ├── const: ''
                     │                                                                               │              └── const: '22012'
                     │                                                                               └── project
                     │                                                                                    ├── columns: "_stmt_raise_9":13
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── udf: _stmt_raise_9 [as="_stmt_raise_9":13]
                     │                                                                                              └── body
                     │                                                                                                   ├── project
                     │                                                                                                   │    ├── columns: stmt_raise_10:5
                     │                                                                                                   │    ├── values
                     │                                                                                                   │    │    └── tuple
                     │                                                                                                   │    └── projections
                     │                                                                                                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_10:5]
                     │                                                                                                   │              ├── const: 'NOTICE'
                     │                                                                                                   │              ├── const: '22004'
                     │                                                                                                   │              ├── const: ''
                     │                                                                                                   │              ├── const: ''
                     │                                                                                                   │              └── const: '22004'
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: "_stmt_raise_11":12
                     │                                                                                                        ├── values
                     │                                                                                                        │    └── tuple
                     │                                                                                                        └── projections
                     │                                                                                                             └── udf: _stmt_raise_11 [as="_stmt_raise_11":12]
                     │                                                                                                                  └── body
                     │                                                                                                                       ├── project
                     │                                                                                                                       │    ├── columns: stmt_raise_12:6
                     │                                                                                                                       │    ├── values
                     │                                                                                                                       │    │    └── tuple
                     │                                                                                                                       │    └── projections
                     │                                                                                                                       │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_12:6]
                     │                                                                                                                       │              ├── const: 'NOTICE'
                     │                                                                                                                       │              ├── const: '39004'
                     │                                                                                                                       │              ├── const: ''
                     │                                                                                                                       │              ├── const: ''
                     │                                                                                                                       │              └── const: '39004'
                     │                                                                                                                       └── project
                     │                                                                                                                            ├── columns: "_stmt_raise_13":11
                     │                                                                                                                            ├── values
                     │                                                                                                                            │    └── tuple
                     │                                                                                                                            └── projections
                     │                                                                                                                                 └── udf: _stmt_raise_13 [as="_stmt_raise_13":11]
                     │                                                                                                                                      └── body
                     │                                                                                                                                           ├── project
                     │                                                                                                                                           │    ├── columns: stmt_raise_14:7
                     │                                                                                                                                           │    ├── values
                     │                                                                                                                                           │    │    └── tuple
                     │                                                                                                                                           │    └── projections
                     │                                                                                                                                           │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_14:7]
                     │                                                                                                                                           │              ├── const: 'NOTICE'
                     │                                                                                                                                           │              ├── const: '2F004'
                     │                                                                                                                                           │              ├── const: ''
                     │                                                                                                                                           │              ├── const: ''
                     │                                                                                                                                           │              └── const: '2F004'
                     │                                                                                                                                           └── project
                     │                                                                                                                                                ├── columns: "_stmt_raise_15":10
                     │                                                                                                                                                ├── values
                     │                                                                                                                                                │    └── tuple
                     │                                                                                                                                                └── projections
                     │                                                                                                                                                     └── udf: _stmt_raise_15 [as="_stmt_raise_15":10]
                     │                                                                                                                                                          └── body
                     │                                                                                                                                                               ├── project
                     │                                                                                                                                                               │    ├── columns: stmt_raise_16:8
                     │                                                                                                                                                               │    ├── values
                     │                                                                                                                                                               │    │    └── tuple
                     │                                                                                                                                                               │    └── projections
                     │                                                                                                                                                               │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_16:8]
                     │                                                                                                                                                               │              ├── const: 'NOTICE'
                     │                                                                                                                                                               │              ├── const: '38004'
                     │                                                                                                                                                               │              ├── const: ''
                     │                                                                                                                                                               │              ├── const: ''
                     │                                                                                                                                                               │              └── const: '38004'
                     │                                                                                                                                                               └── project
                     │                                                                                                                                                                    ├── columns: stmt_return_17:9!null
                     │                                                                                                                                                                    ├── values
                     │                                                                                                                                                                    │    └── tuple
                     │                                                                                                                                                                    └── projections
                     │                                                                                                                                                                         └── const: 0 [as=stmt_return_17:9]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE NOTICE USING MESSAGE = 'foo';
    RAISE NOTICE USING MESSAGE = format('%s %s!','Hello','World');
    RAISE NOTICE USING MESSAGE = 'foo', DETAIL = 'bar', HINT = 'baz';
    RAISE NOTICE 'foo' USING ERRCODE = 'division_by_zero';
    RAISE NOTICE 'foo' USING ERRCODE = '22012';
    -- If no message is specified, the error code is used.
    RAISE NOTICE USING ERRCODE = 'division_by_zero';
    RETURN 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:14
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:14]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":13
                     ├── project
                     │    ├── columns: "_stmt_raise_1":13
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":13]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'NOTICE'
                     │                   │              ├── const: 'foo'
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: '00000'
                     │                   └── project
                     │                        ├── columns: "_stmt_raise_3":12
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── udf: _stmt_raise_3 [as="_stmt_raise_3":12]
                     │                                  └── body
                     │                                       ├── project
                     │                                       │    ├── columns: stmt_raise_4:2
                     │                                       │    ├── values
                     │                                       │    │    └── tuple
                     │                                       │    └── projections
                     │                                       │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_4:2]
                     │                                       │              ├── const: 'NOTICE'
                     │                                       │              ├── function: format
                     │                                       │              │    ├── const: '%s %s!'
                     │                                       │              │    ├── const: 'Hello'
                     │                                       │              │    └── const: 'World'
                     │                                       │              ├── const: ''
                     │                                       │              ├── const: ''
                     │                                       │              └── const: '00000'
                     │                                       └── project
                     │                                            ├── columns: "_stmt_raise_5":11
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: _stmt_raise_5 [as="_stmt_raise_5":11]
                     │                                                      └── body
                     │                                                           ├── project
                     │                                                           │    ├── columns: stmt_raise_6:3
                     │                                                           │    ├── values
                     │                                                           │    │    └── tuple
                     │                                                           │    └── projections
                     │                                                           │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_6:3]
                     │                                                           │              ├── const: 'NOTICE'
                     │                                                           │              ├── const: 'foo'
                     │                                                           │              ├── const: 'bar'
                     │                                                           │              ├── const: 'baz'
                     │                                                           │              └── const: '00000'
                     │                                                           └── project
                     │                                                                ├── columns: "_stmt_raise_7":10
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── udf: _stmt_raise_7 [as="_stmt_raise_7":10]
                     │                                                                          └── body
                     │                                                                               ├── project
                     │                                                                               │    ├── columns: stmt_raise_8:4
                     │                                                                               │    ├── values
                     │                                                                               │    │    └── tuple
                     │                                                                               │    └── projections
                     │                                                                               │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_8:4]
                     │                                                                               │              ├── const: 'NOTICE'
                     │                                                                               │              ├── const: 'foo'
                     │                                                                               │              ├── const: ''
                     │                                                                               │              ├── const: ''
                     │                                                                               │              └── const: 'division_by_zero'
                     │                                                                               └── project
                     │                                                                                    ├── columns: "_stmt_raise_9":9
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── udf: _stmt_raise_9 [as="_stmt_raise_9":9]
                     │                                                                                              └── body
                     │                                                                                                   ├── project
                     │                                                                                                   │    ├── columns: stmt_raise_10:5
                     │                                                                                                   │    ├── values
                     │                                                                                                   │    │    └── tuple
                     │                                                                                                   │    └── projections
                     │                                                                                                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_10:5]
                     │                                                                                                   │              ├── const: 'NOTICE'
                     │                                                                                                   │              ├── const: 'foo'
                     │                                                                                                   │              ├── const: ''
                     │                                                                                                   │              ├── const: ''
                     │                                                                                                   │              └── const: '22012'
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: "_stmt_raise_11":8
                     │                                                                                                        ├── values
                     │                                                                                                        │    └── tuple
                     │                                                                                                        └── projections
                     │                                                                                                             └── udf: _stmt_raise_11 [as="_stmt_raise_11":8]
                     │                                                                                                                  └── body
                     │                                                                                                                       ├── project
                     │                                                                                                                       │    ├── columns: stmt_raise_12:6
                     │                                                                                                                       │    ├── values
                     │                                                                                                                       │    │    └── tuple
                     │                                                                                                                       │    └── projections
                     │                                                                                                                       │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_12:6]
                     │                                                                                                                       │              ├── const: 'NOTICE'
                     │                                                                                                                       │              ├── const: 'division_by_zero'
                     │                                                                                                                       │              ├── const: ''
                     │                                                                                                                       │              ├── const: ''
                     │                                                                                                                       │              └── const: 'division_by_zero'
                     │                                                                                                                       └── project
                     │                                                                                                                            ├── columns: stmt_return_13:7!null
                     │                                                                                                                            ├── values
                     │                                                                                                                            │    └── tuple
                     │                                                                                                                            └── projections
                     │                                                                                                                                 └── const: 0 [as=stmt_return_13:7]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  DECLARE
    i INT := 0;
  BEGIN
    RAISE NOTICE '1: i = %', i;
    i := 100;
    RAISE NOTICE '2: i = %', i;
    i := (SELECT count(*) FROM xy);
    RAISE NOTICE '3: i = %', i;
    RAISE NOTICE 'max_x: %', (SELECT max(x) FROM xy);
    return i;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:29
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:29]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":28
                     ├── project
                     │    ├── columns: "_stmt_raise_1":28
                     │    ├── project
                     │    │    ├── columns: i:1!null
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── const: 0 [as=i:1]
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":28]
                     │              ├── args
                     │              │    └── variable: i:1
                     │              ├── params: i:2
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:3
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:3]
                     │                   │              ├── const: 'NOTICE'
                     │                   │              ├── concat
                     │                   │              │    ├── concat
                     │                   │              │    │    ├── const: '1: i = '
                     │                   │              │    │    └── variable: i:2
                     │                   │              │    └── const: ''
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: '00000'
                     │                   └── project
                     │                        ├── columns: "_stmt_raise_3":27
                     │                        ├── project
                     │                        │    ├── columns: i:4!null
                     │                        │    ├── values
                     │                        │    │    └── tuple
                     │                        │    └── projections
                     │                        │         └── const: 100 [as=i:4]
                     │                        └── projections
                     │                             └── udf: _stmt_raise_3 [as="_stmt_raise_3":27]
                     │                                  ├── args
                     │                                  │    └── variable: i:4
                     │                                  ├── params: i:5
                     │                                  └── body
                     │                                       ├── project
                     │                                       │    ├── columns: stmt_raise_4:6
                     │                                       │    ├── values
                     │                                       │    │    └── tuple
                     │                                       │    └── projections
                     │                                       │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_4:6]
                     │                                       │              ├── const: 'NOTICE'
                     │                                       │              ├── concat
                     │                                       │              │    ├── concat
                     │                                       │              │    │    ├── const: '2: i = '
                     │                                       │              │    │    └── variable: i:5
                     │                                       │              │    └── const: ''
                     │                                       │              ├── const: ''
                     │                                       │              ├── const: ''
                     │                                       │              └── const: '00000'
                     │                                       └── project
                     │                                            ├── columns: "_stmt_raise_5":26
                     │                                            ├── project
                     │                                            │    ├── columns: i:13
                     │                                            │    ├── values
                     │                                            │    │    └── tuple
                     │                                            │    └── projections
                     │                                            │         └── subquery [as=i:13]
                     │                                            │              └── max1-row
                     │                                            │                   ├── columns: count_rows:12!null
                     │                                            │                   └── scalar-group-by
                     │                                            │                        ├── columns: count_rows:12!null
                     │                                            │                        ├── project
                     │                                            │                        │    └── scan xy
                     │                                            │                        │         └── columns: x:7 y:8 rowid:9!null crdb_internal_mvcc_timestamp:10 tableoid:11
                     │                                            │                        └── aggregations
                     │                                            │                             └── count-rows [as=count_rows:12]
                     │                                            └── projections
                     │                                                 └── udf: _stmt_raise_5 [as="_stmt_raise_5":26]
                     │                                                      ├── args
                     │                                                      │    └── variable: i:13
                     │                                                      ├── params: i:14
                     │                                                      └── body
                     │                                                           ├── project
                     │                                                           │    ├── columns: stmt_raise_6:15
                     │                                                           │    ├── values
                     │                                                           │    │    └── tuple
                     │                                                           │    └── projections
                     │                                                           │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_6:15]
                     │                                                           │              ├── const: 'NOTICE'
                     │                                                           │              ├── concat
                     │                                                           │              │    ├── concat
                     │                                                           │              │    │    ├── const: '3: i = '
                     │                                                           │              │    │    └── variable: i:14
                     │                                                           │              │    └── const: ''
                     │                                                           │              ├── const: ''
                     │                                                           │              ├── const: ''
                     │                                                           │              └── const: '00000'
                     │                                                           └── project
                     │                                                                ├── columns: "_stmt_raise_7":25
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── udf: _stmt_raise_7 [as="_stmt_raise_7":25]
                     │                                                                          ├── args
                     │                                                                          │    └── variable: i:14
                     │                                                                          ├── params: i:16
                     │                                                                          └── body
                     │                                                                               ├── project
                     │                                                                               │    ├── columns: stmt_raise_8:23
                     │                                                                               │    ├── values
                     │                                                                               │    │    └── tuple
                     │                                                                               │    └── projections
                     │                                                                               │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_8:23]
                     │                                                                               │              ├── const: 'NOTICE'
                     │                                                                               │              ├── concat
                     │                                                                               │              │    ├── concat
                     │                                                                               │              │    │    ├── const: 'max_x: '
                     │                                                                               │              │    │    └── subquery
                     │                                                                               │              │    │         └── max1-row
                     │                                                                               │              │    │              ├── columns: max:22
                     │                                                                               │              │    │              └── scalar-group-by
                     │                                                                               │              │    │                   ├── columns: max:22
                     │                                                                               │              │    │                   ├── project
                     │                                                                               │              │    │                   │    ├── columns: x:17
                     │                                                                               │              │    │                   │    └── scan xy
                     │                                                                               │              │    │                   │         └── columns: x:17 y:18 rowid:19!null crdb_internal_mvcc_timestamp:20 tableoid:21
                     │                                                                               │              │    │                   └── aggregations
                     │                                                                               │              │    │                        └── max [as=max:22]
                     │                                                                               │              │    │                             └── variable: x:17
                     │                                                                               │              │    └── const: ''
                     │                                                                               │              ├── const: ''
                     │                                                                               │              ├── const: ''
                     │                                                                               │              └── const: '00000'
                     │                                                                               └── project
                     │                                                                                    ├── columns: stmt_return_9:24
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── variable: i:16 [as=stmt_return_9:24]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  DECLARE
    i INT := 0;
  BEGIN
    LOOP
      IF i >= 5 THEN EXIT; END IF;
      RAISE NOTICE 'i = %', i;
      i := i + 1;
    END LOOP;
    RAISE NOTICE 'finished with i = %', i;
    RETURN 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:18
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:18]
           └── body
                └── limit
                     ├── columns: stmt_loop_5:17
                     ├── project
                     │    ├── columns: stmt_loop_5:17
                     │    ├── project
                     │    │    ├── columns: i:1!null
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── const: 0 [as=i:1]
                     │    └── projections
                     │         └── udf: stmt_loop_5 [as=stmt_loop_5:17]
                     │              ├── args
                     │              │    └── variable: i:1
                     │              ├── params: i:7
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_9:16
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_9:16]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── ge
                     │                                  │    │    ├── variable: i:7
                     │                                  │    │    └── const: 5
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: loop_exit_1:14
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:14]
                     │                                  │                        ├── args
                     │                                  │                        │    └── variable: i:7
                     │                                  │                        ├── params: i:2
                     │                                  │                        └── body
                     │                                  │                             └── project
                     │                                  │                                  ├── columns: "_stmt_raise_2":6
                     │                                  │                                  ├── values
                     │                                  │                                  │    └── tuple
                     │                                  │                                  └── projections
                     │                                  │                                       └── udf: _stmt_raise_2 [as="_stmt_raise_2":6]
                     │                                  │                                            ├── args
                     │                                  │                                            │    └── variable: i:2
                     │                                  │                                            ├── params: i:3
                     │                                  │                                            └── body
                     │                                  │                                                 ├── project
                     │                                  │                                                 │    ├── columns: stmt_raise_3:4
                     │                                  │                                                 │    ├── values
                     │                                  │                                                 │    │    └── tuple
                     │                                  │                                                 │    └── projections
                     │                                  │                                                 │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_3:4]
                     │                                  │                                                 │              ├── const: 'NOTICE'
                     │                                  │                                                 │              ├── concat
                     │                                  │                                                 │              │    ├── concat
                     │                                  │                                                 │              │    │    ├── const: 'finished with i = '
                     │                                  │                                                 │              │    │    └── variable: i:3
                     │                                  │                                                 │              │    └── const: ''
                     │                                  │                                                 │              ├── const: ''
                     │                                  │                                                 │              ├── const: ''
                     │                                  │                                                 │              └── const: '00000'
                     │                                  │                                                 └── project
                     │                                  │                                                      ├── columns: stmt_return_4:5!null
                     │                                  │                                                      ├── values
                     │                                  │                                                      │    └── tuple
                     │                                  │                                                      └── projections
                     │                                  │                                                           └── const: 0 [as=stmt_return_4:5]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_6:15
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_6 [as=stmt_if_6:15]
                     │                                                      ├── args
                     │                                                      │    └── variable: i:7
                     │                                                      ├── params: i:8
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: "_stmt_raise_7":13
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── udf: _stmt_raise_7 [as="_stmt_raise_7":13]
                     │                                                                          ├── args
                     │                                                                          │    └── variable: i:8
                     │                                                                          ├── params: i:9
                     │                                                                          └── body
                     │                                                                               ├── project
                     │                                                                               │    ├── columns: stmt_raise_8:10
                     │                                                                               │    ├── values
                     │                                                                               │    │    └── tuple
                     │                                                                               │    └── projections
                     │                                                                               │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_8:10]
                     │                                                                               │              ├── const: 'NOTICE'
                     │                                                                               │              ├── concat
                     │                                                                               │              │    ├── concat
                     │                                                                               │              │    │    ├── const: 'i = '
                     │                                                                               │              │    │    └── variable: i:9
                     │                                                                               │              │    └── const: ''
                     │                                                                               │              ├── const: ''
                     │                                                                               │              ├── const: ''
                     │                                                                               │              └── const: '00000'
                     │                                                                               └── project
                     │                                                                                    ├── columns: stmt_loop_5:12
                     │                                                                                    ├── project
                     │                                                                                    │    ├── columns: i:11
                     │                                                                                    │    ├── values
                     │                                                                                    │    │    └── tuple
                     │                                                                                    │    └── projections
                     │                                                                                    │         └── plus [as=i:11]
                     │                                                                                    │              ├── variable: i:9
                     │                                                                                    │              └── const: 1
                     │                                                                                    └── projections
                     │                                                                                         └── udf: stmt_loop_5 [as=stmt_loop_5:12]
                     │                                                                                              ├── args
                     │                                                                                              │    └── variable: i:11
                     │                                                                                              └── recursive-call
                     └── const: 1

# Testing RAISE statement with EXCEPTION log level.
exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE EXCEPTION 'foo';
    return 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":3
                     ├── project
                     │    ├── columns: "_stmt_raise_1":3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":3]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'ERROR'
                     │                   │              ├── const: 'foo'
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: 'P0001'
                     │                   └── project
                     │                        ├── columns: stmt_return_3:2!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 0 [as=stmt_return_3:2]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE EXCEPTION division_by_zero;
    return 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":3
                     ├── project
                     │    ├── columns: "_stmt_raise_1":3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":3]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'ERROR'
                     │                   │              ├── const: 'division_by_zero'
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: 'division_by_zero'
                     │                   └── project
                     │                        ├── columns: stmt_return_3:2!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 0 [as=stmt_return_3:2]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE EXCEPTION SQLSTATE '22012';
    return 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":3
                     ├── project
                     │    ├── columns: "_stmt_raise_1":3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":3]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'ERROR'
                     │                   │              ├── const: '22012'
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: '22012'
                     │                   └── project
                     │                        ├── columns: stmt_return_3:2!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 0 [as=stmt_return_3:2]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  DECLARE
    i INT := 0;
  BEGIN
    LOOP
      IF i >= 5 THEN EXIT; END IF;
      IF i = 3 THEN
        RAISE EXCEPTION 'i = %', i;
      END IF;
      RAISE NOTICE 'i = %', i;
      i := i + 1;
    END LOOP;
    RAISE NOTICE 'finished with i = %', i;
    RETURN 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:25
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:25]
           └── body
                └── limit
                     ├── columns: stmt_loop_5:24
                     ├── project
                     │    ├── columns: stmt_loop_5:24
                     │    ├── project
                     │    │    ├── columns: i:1!null
                     │    │    ├── values
                     │    │    │    └── tuple
                     │    │    └── projections
                     │    │         └── const: 0 [as=i:1]
                     │    └── projections
                     │         └── udf: stmt_loop_5 [as=stmt_loop_5:24]
                     │              ├── args
                     │              │    └── variable: i:1
                     │              ├── params: i:7
                     │              └── body
                     │                   └── project
                     │                        ├── columns: stmt_if_13:23
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── case [as=stmt_if_13:23]
                     │                                  ├── true
                     │                                  ├── when
                     │                                  │    ├── ge
                     │                                  │    │    ├── variable: i:7
                     │                                  │    │    └── const: 5
                     │                                  │    └── subquery
                     │                                  │         └── project
                     │                                  │              ├── columns: loop_exit_1:21
                     │                                  │              ├── values
                     │                                  │              │    └── tuple
                     │                                  │              └── projections
                     │                                  │                   └── udf: loop_exit_1 [as=loop_exit_1:21]
                     │                                  │                        ├── args
                     │                                  │                        │    └── variable: i:7
                     │                                  │                        ├── params: i:2
                     │                                  │                        └── body
                     │                                  │                             └── project
                     │                                  │                                  ├── columns: "_stmt_raise_2":6
                     │                                  │                                  ├── values
                     │                                  │                                  │    └── tuple
                     │                                  │                                  └── projections
                     │                                  │                                       └── udf: _stmt_raise_2 [as="_stmt_raise_2":6]
                     │                                  │                                            ├── args
                     │                                  │                                            │    └── variable: i:2
                     │                                  │                                            ├── params: i:3
                     │                                  │                                            └── body
                     │                                  │                                                 ├── project
                     │                                  │                                                 │    ├── columns: stmt_raise_3:4
                     │                                  │                                                 │    ├── values
                     │                                  │                                                 │    │    └── tuple
                     │                                  │                                                 │    └── projections
                     │                                  │                                                 │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_3:4]
                     │                                  │                                                 │              ├── const: 'NOTICE'
                     │                                  │                                                 │              ├── concat
                     │                                  │                                                 │              │    ├── concat
                     │                                  │                                                 │              │    │    ├── const: 'finished with i = '
                     │                                  │                                                 │              │    │    └── variable: i:3
                     │                                  │                                                 │              │    └── const: ''
                     │                                  │                                                 │              ├── const: ''
                     │                                  │                                                 │              ├── const: ''
                     │                                  │                                                 │              └── const: '00000'
                     │                                  │                                                 └── project
                     │                                  │                                                      ├── columns: stmt_return_4:5!null
                     │                                  │                                                      ├── values
                     │                                  │                                                      │    └── tuple
                     │                                  │                                                      └── projections
                     │                                  │                                                           └── const: 0 [as=stmt_return_4:5]
                     │                                  └── subquery
                     │                                       └── project
                     │                                            ├── columns: stmt_if_6:22
                     │                                            ├── values
                     │                                            │    └── tuple
                     │                                            └── projections
                     │                                                 └── udf: stmt_if_6 [as=stmt_if_6:22]
                     │                                                      ├── args
                     │                                                      │    └── variable: i:7
                     │                                                      ├── params: i:8
                     │                                                      └── body
                     │                                                           └── project
                     │                                                                ├── columns: stmt_if_12:20
                     │                                                                ├── values
                     │                                                                │    └── tuple
                     │                                                                └── projections
                     │                                                                     └── case [as=stmt_if_12:20]
                     │                                                                          ├── true
                     │                                                                          ├── when
                     │                                                                          │    ├── eq
                     │                                                                          │    │    ├── variable: i:8
                     │                                                                          │    │    └── const: 3
                     │                                                                          │    └── subquery
                     │                                                                          │         └── project
                     │                                                                          │              ├── columns: "_stmt_raise_10":18
                     │                                                                          │              ├── values
                     │                                                                          │              │    └── tuple
                     │                                                                          │              └── projections
                     │                                                                          │                   └── udf: _stmt_raise_10 [as="_stmt_raise_10":18]
                     │                                                                          │                        ├── args
                     │                                                                          │                        │    └── variable: i:8
                     │                                                                          │                        ├── params: i:15
                     │                                                                          │                        └── body
                     │                                                                          │                             ├── project
                     │                                                                          │                             │    ├── columns: stmt_raise_11:16
                     │                                                                          │                             │    ├── values
                     │                                                                          │                             │    │    └── tuple
                     │                                                                          │                             │    └── projections
                     │                                                                          │                             │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_11:16]
                     │                                                                          │                             │              ├── const: 'ERROR'
                     │                                                                          │                             │              ├── concat
                     │                                                                          │                             │              │    ├── concat
                     │                                                                          │                             │              │    │    ├── const: 'i = '
                     │                                                                          │                             │              │    │    └── variable: i:15
                     │                                                                          │                             │              │    └── const: ''
                     │                                                                          │                             │              ├── const: ''
                     │                                                                          │                             │              ├── const: ''
                     │                                                                          │                             │              └── const: 'P0001'
                     │                                                                          │                             └── project
                     │                                                                          │                                  ├── columns: stmt_if_7:17
                     │                                                                          │                                  ├── values
                     │                                                                          │                                  │    └── tuple
                     │                                                                          │                                  └── projections
                     │                                                                          │                                       └── udf: stmt_if_7 [as=stmt_if_7:17]
                     │                                                                          │                                            ├── args
                     │                                                                          │                                            │    └── variable: i:15
                     │                                                                          │                                            ├── params: i:9
                     │                                                                          │                                            └── body
                     │                                                                          │                                                 └── project
                     │                                                                          │                                                      ├── columns: "_stmt_raise_8":14
                     │                                                                          │                                                      ├── values
                     │                                                                          │                                                      │    └── tuple
                     │                                                                          │                                                      └── projections
                     │                                                                          │                                                           └── udf: _stmt_raise_8 [as="_stmt_raise_8":14]
                     │                                                                          │                                                                ├── args
                     │                                                                          │                                                                │    └── variable: i:9
                     │                                                                          │                                                                ├── params: i:10
                     │                                                                          │                                                                └── body
                     │                                                                          │                                                                     ├── project
                     │                                                                          │                                                                     │    ├── columns: stmt_raise_9:11
                     │                                                                          │                                                                     │    ├── values
                     │                                                                          │                                                                     │    │    └── tuple
                     │                                                                          │                                                                     │    └── projections
                     │                                                                          │                                                                     │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_9:11]
                     │                                                                          │                                                                     │              ├── const: 'NOTICE'
                     │                                                                          │                                                                     │              ├── concat
                     │                                                                          │                                                                     │              │    ├── concat
                     │                                                                          │                                                                     │              │    │    ├── const: 'i = '
                     │                                                                          │                                                                     │              │    │    └── variable: i:10
                     │                                                                          │                                                                     │              │    └── const: ''
                     │                                                                          │                                                                     │              ├── const: ''
                     │                                                                          │                                                                     │              ├── const: ''
                     │                                                                          │                                                                     │              └── const: '00000'
                     │                                                                          │                                                                     └── project
                     │                                                                          │                                                                          ├── columns: stmt_loop_5:13
                     │                                                                          │                                                                          ├── project
                     │                                                                          │                                                                          │    ├── columns: i:12
                     │                                                                          │                                                                          │    ├── values
                     │                                                                          │                                                                          │    │    └── tuple
                     │                                                                          │                                                                          │    └── projections
                     │                                                                          │                                                                          │         └── plus [as=i:12]
                     │                                                                          │                                                                          │              ├── variable: i:10
                     │                                                                          │                                                                          │              └── const: 1
                     │                                                                          │                                                                          └── projections
                     │                                                                          │                                                                               └── udf: stmt_loop_5 [as=stmt_loop_5:13]
                     │                                                                          │                                                                                    ├── args
                     │                                                                          │                                                                                    │    └── variable: i:12
                     │                                                                          │                                                                                    └── recursive-call
                     │                                                                          └── subquery
                     │                                                                               └── project
                     │                                                                                    ├── columns: stmt_if_7:19
                     │                                                                                    ├── values
                     │                                                                                    │    └── tuple
                     │                                                                                    └── projections
                     │                                                                                         └── udf: stmt_if_7 [as=stmt_if_7:19]
                     │                                                                                              ├── args
                     │                                                                                              │    └── variable: i:8
                     │                                                                                              ├── params: i:9
                     │                                                                                              └── body
                     │                                                                                                   └── project
                     │                                                                                                        ├── columns: "_stmt_raise_8":14
                     │                                                                                                        ├── values
                     │                                                                                                        │    └── tuple
                     │                                                                                                        └── projections
                     │                                                                                                             └── udf: _stmt_raise_8 [as="_stmt_raise_8":14]
                     │                                                                                                                  ├── args
                     │                                                                                                                  │    └── variable: i:9
                     │                                                                                                                  ├── params: i:10
                     │                                                                                                                  └── body
                     │                                                                                                                       ├── project
                     │                                                                                                                       │    ├── columns: stmt_raise_9:11
                     │                                                                                                                       │    ├── values
                     │                                                                                                                       │    │    └── tuple
                     │                                                                                                                       │    └── projections
                     │                                                                                                                       │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_9:11]
                     │                                                                                                                       │              ├── const: 'NOTICE'
                     │                                                                                                                       │              ├── concat
                     │                                                                                                                       │              │    ├── concat
                     │                                                                                                                       │              │    │    ├── const: 'i = '
                     │                                                                                                                       │              │    │    └── variable: i:10
                     │                                                                                                                       │              │    └── const: ''
                     │                                                                                                                       │              ├── const: ''
                     │                                                                                                                       │              ├── const: ''
                     │                                                                                                                       │              └── const: '00000'
                     │                                                                                                                       └── project
                     │                                                                                                                            ├── columns: stmt_loop_5:13
                     │                                                                                                                            ├── project
                     │                                                                                                                            │    ├── columns: i:12
                     │                                                                                                                            │    ├── values
                     │                                                                                                                            │    │    └── tuple
                     │                                                                                                                            │    └── projections
                     │                                                                                                                            │         └── plus [as=i:12]
                     │                                                                                                                            │              ├── variable: i:10
                     │                                                                                                                            │              └── const: 1
                     │                                                                                                                            └── projections
                     │                                                                                                                                 └── udf: stmt_loop_5 [as=stmt_loop_5:13]
                     │                                                                                                                                      ├── args
                     │                                                                                                                                      │    └── variable: i:12
                     │                                                                                                                                      └── recursive-call
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE EXCEPTION USING ERRCODE = 'division_by_zero';
    return 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":3
                     ├── project
                     │    ├── columns: "_stmt_raise_1":3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":3]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'ERROR'
                     │                   │              ├── const: 'division_by_zero'
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: 'division_by_zero'
                     │                   └── project
                     │                        ├── columns: stmt_return_3:2!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 0 [as=stmt_return_3:2]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE EXCEPTION USING ERRCODE = '22012';
    return 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":3
                     ├── project
                     │    ├── columns: "_stmt_raise_1":3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":3]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'ERROR'
                     │                   │              ├── const: '22012'
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: '22012'
                     │                   └── project
                     │                        ├── columns: stmt_return_3:2!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 0 [as=stmt_return_3:2]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE EXCEPTION USING DETAIL = 'use default errcode for the code and message';
    return 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":3
                     ├── project
                     │    ├── columns: "_stmt_raise_1":3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":3]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'ERROR'
                     │                   │              ├── const: 'P0001'
                     │                   │              ├── const: 'use default errcode for the code and message'
                     │                   │              ├── const: ''
                     │                   │              └── const: 'P0001'
                     │                   └── project
                     │                        ├── columns: stmt_return_3:2!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 0 [as=stmt_return_3:2]
                     └── const: 1

exec-ddl
CREATE OR REPLACE FUNCTION f() RETURNS INT AS $$
  BEGIN
    RAISE 'foo';
    return 0;
  END
$$ LANGUAGE PLpgSQL;
----

build format=show-scalars
SELECT f();
----
project
 ├── columns: f:4
 ├── values
 │    └── tuple
 └── projections
      └── udf: f [as=f:4]
           └── body
                └── limit
                     ├── columns: "_stmt_raise_1":3
                     ├── project
                     │    ├── columns: "_stmt_raise_1":3
                     │    ├── values
                     │    │    └── tuple
                     │    └── projections
                     │         └── udf: _stmt_raise_1 [as="_stmt_raise_1":3]
                     │              └── body
                     │                   ├── project
                     │                   │    ├── columns: stmt_raise_2:1
                     │                   │    ├── values
                     │                   │    │    └── tuple
                     │                   │    └── projections
                     │                   │         └── function: crdb_internal.plpgsql_raise [as=stmt_raise_2:1]
                     │                   │              ├── const: 'ERROR'
                     │                   │              ├── const: 'foo'
                     │                   │              ├── const: ''
                     │                   │              ├── const: ''
                     │                   │              └── const: 'P0001'
                     │                   └── project
                     │                        ├── columns: stmt_return_3:2!null
                     │                        ├── values
                     │                        │    └── tuple
                     │                        └── projections
                     │                             └── const: 0 [as=stmt_return_3:2]
                     └── const: 1
