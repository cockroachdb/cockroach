# LogicTest: local

statement ok
CREATE TABLE uniontest (
  k INT,
  v INT
)

query T
EXPLAIN SELECT v FROM uniontest UNION SELECT k FROM uniontest
----
distribution: local
vectorized: true
·
• union
│
├── • scan
│     missing stats
│     table: uniontest@uniontest_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: uniontest@uniontest_pkey
      spans: FULL SCAN

query T
EXPLAIN SELECT v FROM uniontest UNION ALL SELECT k FROM uniontest
----
distribution: local
vectorized: true
·
• union all
│
├── • scan
│     missing stats
│     table: uniontest@uniontest_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: uniontest@uniontest_pkey
      spans: FULL SCAN

# Check that EXPLAIN properly releases memory for virtual tables.
query T
EXPLAIN SELECT node_id FROM crdb_internal.node_build_info UNION VALUES(123)
----
distribution: local
vectorized: true
·
• union
│
├── • virtual table
│     table: node_build_info@primary
│
└── • values
      size: 1 column, 1 row

statement ok
CREATE TABLE abc (a INT, b INT, c INT)

query T
EXPLAIN (VERBOSE) (SELECT a FROM abc ORDER BY b) INTERSECT (SELECT a FROM abc ORDER BY c) ORDER BY a
----
distribution: local
vectorized: true
·
• sort
│ columns: (a)
│ ordering: +a
│ estimated row count: 100 (missing stats)
│ order: +a
│
└── • intersect
    │ columns: (a)
    │ estimated row count: 100 (missing stats)
    │
    ├── • project
    │   │ columns: (a)
    │   │
    │   └── • scan
    │         columns: (a, b)
    │         estimated row count: 1,000 (missing stats)
    │         table: abc@abc_pkey
    │         spans: FULL SCAN
    │
    └── • project
        │ columns: (a)
        │
        └── • scan
              columns: (a, c)
              estimated row count: 1,000 (missing stats)
              table: abc@abc_pkey
              spans: FULL SCAN

# Regression test for #32723.
query T
EXPLAIN (VERBOSE) SELECT a FROM ((SELECT '' AS a , '') EXCEPT ALL (SELECT '', ''))
----
distribution: local
vectorized: true
·
• project
│ columns: (a)
│
└── • except all
    │ columns: (a, a)
    │ estimated row count: 1
    │
    ├── • project
    │   │ columns: (a, a)
    │   │
    │   └── • values
    │         columns: (a)
    │         size: 1 column, 1 row
    │         row 0, expr 0: ''
    │
    └── • project
        │ columns: ("?column?", "?column?")
        │
        └── • values
              columns: ("?column?")
              size: 1 column, 1 row
              row 0, expr 0: ''

query T
EXPLAIN (VERBOSE) ((SELECT '', '', 'x' WHERE false))
UNION ALL ((SELECT * FROM (VALUES ('', '', 'x'), ('', '', 'x'))) EXCEPT (VALUES ('', '', 'x')))
----
distribution: local
vectorized: true
·
• render
│ columns: ("?column?", "?column?", "?column?")
│ render ?column?: column1
│ render ?column?: column2
│ render ?column?: column3
│
└── • except
    │ columns: (column1, column2, column3)
    │ estimated row count: 1
    │
    ├── • values
    │     columns: (column1, column2, column3)
    │     size: 3 columns, 2 rows
    │     row 0, expr 0: ''
    │     row 0, expr 1: ''
    │     row 0, expr 2: 'x'
    │     row 1, expr 0: ''
    │     row 1, expr 1: ''
    │     row 1, expr 2: 'x'
    │
    └── • values
          columns: (column1, column2, column3)
          size: 3 columns, 1 row
          row 0, expr 0: ''
          row 0, expr 1: ''
          row 0, expr 2: 'x'

query T
EXPLAIN (VERBOSE)
SELECT 1 FROM (SELECT k FROM uniontest WHERE k > 3 UNION ALL SELECT k FROM uniontest)
----
distribution: local
vectorized: true
·
• render
│ columns: ("?column?")
│ render ?column?: 1
│
└── • union all
    │ columns: ()
    │ estimated row count: 1,333 (missing stats)
    │
    ├── • project
    │   │ columns: ()
    │   │
    │   └── • filter
    │       │ columns: (k)
    │       │ estimated row count: 333 (missing stats)
    │       │ filter: k > 3
    │       │
    │       └── • scan
    │             columns: (k)
    │             estimated row count: 1,000 (missing stats)
    │             table: uniontest@uniontest_pkey
    │             spans: FULL SCAN
    │
    └── • scan
          columns: ()
          estimated row count: 1,000 (missing stats)
          table: uniontest@uniontest_pkey
          spans: FULL SCAN

statement ok
CREATE TABLE ab (a INT NOT NULL, b INT, INDEX(a, b), INDEX (b, a))

statement ok
CREATE TABLE xy (x INT NOT NULL, y INT, INDEX(x, y), INDEX (y, x))

# Regression tests for #41245, #40797. Ensure we can plan ordered set ops
# without a sort.
query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a FROM ab UNION SELECT x AS a FROM xy ORDER BY a
----
distribution: local
vectorized: true
·
• union
│ columns: (a)
│ ordering: +a
│ estimated row count: 200 (missing stats)
│
├── • scan
│     columns: (a)
│     ordering: +a
│     estimated row count: 1,000 (missing stats)
│     table: ab@ab_a_b_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (x)
      ordering: +x
      estimated row count: 1,000 (missing stats)
      table: xy@xy_x_y_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyckVFvmzAQx9_3Kax72jSjYhotC09pGyYhpUkH2bRpipDBR4ZGMLMdFRTx3SeTdS1omda-cXfmdz__fQT9swQfgi93y6twRV4vwngTf1xS8jmIrtdx8IbEwTK42RBOPkTrW8JT8mkVrlcP7YZcxQ-zpiXraBFE5Por4UChkgJXfI8a_G_AYEuhVjJDraWyrWN_IBQN-C6FoqoPxra3FDKpEPwjmMKUCD5seFpihFygunCBgkDDi7LHNu28aZMmaZNCNEDhRpaHfaV9You45vbTgW1HQR7M4wZt-A7BZ0-UwgX4bkdfZsWGVjyd8zThSTq24v9j5Y2s2FmrRxmpBCoUQ405ewvb7i_qi0KbosrMhTf-4azU5UjKe05UEepaVhoH285tckebHGavgGKHpytreVAZ3imZ9WdP5boH9Q2B2pym3qkIq37E7AaFfP8n06ck9lKSOyZ5_yRdDkjukLSlkJfyPikE-MBwmnvuRDjce4fOZMKEM5ty4bzPpzNvNs28SW4DzUu-0zbs-Lu877GbtrZR5bzUSOGW_8AFGlT7orLPnv2edN2rXwEAAP__9YpJrQ==

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b FROM ab UNION SELECT x AS a, y AS b FROM xy ORDER BY a
----
distribution: local
vectorized: true
·
• union
│ columns: (a, b)
│ ordering: +a
│ estimated row count: 2,000 (missing stats)
│
├── • scan
│     columns: (a, b)
│     ordering: +a,+b
│     estimated row count: 1,000 (missing stats)
│     table: ab@ab_a_b_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (x, y)
      ordering: +x,+y
      estimated row count: 1,000 (missing stats)
      table: xy@xy_x_y_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyckV9v0zAUxd_5FNZ9As3R8m8g5anbGqRIXTuSgkCoiuz4tkSkcbBdLVGV746cDrZEFMGeovsn5_zu8RH0jwoiiD_fL66TJXk9T7J19mFByac4vVll8RuSxYv4dk0YJZy8T1d3hHHycZmslr8mLbnO7Liz38edtiOrdB6n5OYLYUChlgKXbI8aoq_gwYZCo2SBWktlW8dhIREtRC6Fsm4OxrY3FAqpEKIjmNJUCBGsGa8wRSZQXbpAQaBhZTXItt2s7fI27_JStEDhVlaHfa0j0lLSAYWsYbZyYNNTkAfzZKIN2yFE3jOqZA6R29OXgXljMMZnjOcs51Mwm-m_gPkTMO8s2BOPVAIVijHJzLugM_8CNv0fLpiX2pR1YS796U905p9lCyZs_v-ElqJuZK1xZHjOyZ04OZ69AsUOT5dreVAF3itZDLuncjUIDQ2B2pym_qlI6mHkWQeFbP872udK3kuV3KmS_1elYKTkjpU2FLaVfMhLARH4AYbh9l3oXPGAOSG_ChwWFtwJfVYEHvKr7Vv77NuK7bQNO_smHwbZddfYqLas0kjhjn3HORpU-7K2L188Tvr-1c8AAAD__3miT28=

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b FROM ab UNION ALL SELECT x AS a, y AS b FROM xy ORDER BY a
----
distribution: local
vectorized: true
·
• union all
│ columns: (a, b)
│ ordering: +a
│ estimated row count: 2,000 (missing stats)
│
├── • scan
│     columns: (a, b)
│     ordering: +a
│     estimated row count: 1,000 (missing stats)
│     table: ab@ab_a_b_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (x, y)
      ordering: +x
      estimated row count: 1,000 (missing stats)
      table: xy@xy_x_y_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyck9-Ok0AUh-99ism50jhkmbraLVftbjEh6cIK1WgMITPMaSVSBmdoFtLw7mbo6i6Na7RX5PzJdz5-yRzA_CjBA__z3WoRhOTlMkjWyYcVJZ_8-DpK_Fck8Vf-zZpwSgR5H0e3hAvyMQyikCxWq1_TliwSu9LZ78Ne25EoXvoxuf5COFColMSQ79CA9xUYpBRqrXI0RmnbOgwLgWzBcykUVb1vbDulkCuN4B2gKZoSwYM1FyXGyCXqCxcoSGx4UQ7Ytpu3XdZmXVbIFijcqHK_q4xHWko6oJDU3FYOpD0FtW8ej5iGbxE89sQqWILn9vQ8MTYW42LORcYzcSpmc_0XscmJGHtW7NFHaYka5dhkzl5D2v_BPlSOqi8mo-3nbNwTm8n_xBSjqVVl8KxLDrPuKLd4_Fej9jrHO63yYfdYRgNoaEg0zXE6ORZBNYyYvaCR736H-ZTEziW5p6TJX0lvRiR3TEopbEp1nxUSPBAbyZiLM-eKT7lziW-lI_h06syuZohi-k7IS_vINiXfGht28k3dD9h1V9uoNrw0SOGWf8clNqh3RVWYpsgfJn3_4mcAAAD__2AhTU4=

# TODO(yuzefovich): The synchronizers in the below DistSQL plans are all
# unordered. This is not a problem, but we shouldn't need an input synchronizer
# at all when there is only one incoming stream. We should look into removing
# it.
query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b FROM ab INTERSECT SELECT x AS a, y AS b FROM xy ORDER BY b, a
----
distribution: local
vectorized: true
·
• intersect
│ columns: (a, b)
│ ordering: +b,+a
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (a, b)
│     ordering: +b,+a
│     estimated row count: 1,000 (missing stats)
│     table: ab@ab_b_a_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (x, y)
      ordering: +y,+x
      estimated row count: 1,000 (missing stats)
      table: xy@xy_y_x_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJykk2Fv2jwQgL-_v8K6T61qVBxSXmppUtqSSUi0dAmaNk0IOfGFRgsxs42aqOK_TybdClFha_cJ-e547rmL_QTmRwEcwi_346vRHTkZjuJp_GlMyecwup7E4SmJw3F4MyWCkoR8jCa3RCRkdDcNo9iFn7MVuYpdSe1-n-uqmkyiYRiR668koUQAhVJJvBNLNMC_AYMZhZVWKRqjtAs9bQtGsgLepZCXq7V14RmFVGkE_gQ2twUCh6lICoxQSNTnXaAg0Yq82GKrOqjqeT2v5rmsgMKNKtbL0nBSUVIDhXgl3KkDsw0FtbYvTYwVCwTOdqxGQ-DdDX2fGNsXE0kgknkyF20xt9q_EfNaYuwtYsPc2LxM7bm3bxUwGrjQREvUKDkJPBqwgw69loP3LofePzn4LYfeQYeX1utSNfC9zjP3zz-VvDLILeoFxmgnq3N_f5RpvUK-8z6uxmOgUGBmTwLvjAbs7PSDzhcPL0c399py0izh0MwXrZn9t-w9QrNSpcH27K926rY6dZjbAMoFNhs1aq1TvNcq3dY2x8kWtA1INLbJ9prDqPyVMlajWP6-urskdpTkHSZ12yTvKMnfI7Fdktcm9d5A8nZJvTbJP0q6ODbdjEJWqMd5LoFDNpBZH5noXMo-dvzMTzuDvvd_5-JSiAET3f7g0n3krBAL4y5A_KAet1h3LQ3wTBQGKdyK7zhEi3qZl-5Jps-Zzea_nwEAAP__Nl7w7A==

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT b FROM ab INTERSECT ALL SELECT x AS b FROM xy ORDER BY b
----
distribution: local
vectorized: true
·
• intersect all
│ columns: (b)
│ ordering: +b
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (b)
│     ordering: +b
│     estimated row count: 1,000 (missing stats)
│     table: ab@ab_b_a_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (x)
      ordering: +x
      estimated row count: 1,000 (missing stats)
      table: xy@xy_x_y_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyckl1r2zAUhu_3K8S5aplM_ZGunWCQtPHAkMSdHcbGCEa2TlIzx_IkmTqE_PdhZ11j027r7nQ-9Jz3PdIe9I8CGPhf7maTYEHOpkG8jD_NKPnsRzdh7J-T2J_5t0uSko9ROCc8JcFi6Udxm5vMZo_lhkzix55mR8Jo6kfk5itJgUIpBS74FjWwb-DAikKlZIZaS9Wm9l1DIBpgNoW8rGrTplcUMqkQ2B5MbgoEBkueFhghF6gubKAg0PC86LDNbtzskibZJblogMKtLOptqRlpg7ji7dGC1YGCrM3TBG34BoE5J5KCKTD7QP9PldNXxdMxT5M04UNV6b-ocgeqnBdVPYmpS6kEKhQ9Iav25t9anrE2R7XBGE1YXbh9Z8tdhaz_FYBCgWtzNnbenn9Q-eb-eAQKYW0YGTsvGvUGRt3XrD9CXclS49Dws5PswSTLaW2j2OBxjVrWKsM7JbOu9xiGHahLCNTmWHWPQVB2JbedoJBvf7_TKcl5Bck5JdlDkvtHktcj2X3SisK6kA9JLoCB7Qgxcq89y_Hsa2t0JUZW6q1H1rs045e2-_7y2ruC9gLf6HbZ8b186LDtu2tga15opDDn33GKBtU2L3Nt8uxX5XB48zMAAP__iq1lqQ==

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT b, a FROM ab INTERSECT ALL SELECT y AS b, x AS a FROM xy ORDER BY b
----
distribution: local
vectorized: true
·
• intersect all
│ columns: (b, a)
│ ordering: +b
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (b, a)
│     ordering: +b,+a
│     estimated row count: 1,000 (missing stats)
│     table: ab@ab_b_a_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (y, x)
      ordering: +y,+x
      estimated row count: 1,000 (missing stats)
      table: xy@xy_y_x_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJycktFr2zAQxt_3V4h7aqlCbXVpQDBw23gQSOvODmNjBCNbl9TMsTxJpjYl__uQ07W1aTe6J3Onz7_7vpMewPwqgUP47XZ5sbghR_NFskq-LCn5GsaXURIekyRchlcrklEiyOc4uiYiI4ubVRgnrn2xXP5RdOQicbLWfR-1bUeieB7G5PI7yYBCpSTeiB0a4D_AhzWFWqscjVHatR56wUK2wD0KRVU31rXXFHKlEfgD2MKWCBxWIisxRiFRn3pAQaIVRdlj2y5ou7RL27SQLVC4UmWzqwwnLSUdUEhq4aoJUIgay0nAaODDek9BNfZ5orFii8D9FxYXc-Denv6fS3_oUmSByNIsFWOXgvabep9LNnLpv-ny2VxTKS1RoxwYW7s__yV5Jeo16i0maKP6lA2Trroa-fDJAIUSN_Yo8E9owE6OP-lie_dcPmX2acDezHw2yszeczMxmlpVBsfZX53kjSZNfLcBlFs8bNSoRud4q1Xeaw9l1IP6hkRjD6fsUCyq_oi5CRrF7unKXpL8d5D8lyRvTGJ_JZ0NSN6QtKawKdV9WkjgIGbe9Hy6YRPMprPJRyHziUDmTRibopz5ODuXM3A_iK1xy07u1H2PdU_AAN-I0iCFa_ET52hR74qqMLbIH0_2-w-_AwAA__9M_XMH

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT b, a FROM ab EXCEPT SELECT y AS b, x AS a FROM xy ORDER BY b
----
distribution: local
vectorized: true
·
• except
│ columns: (b, a)
│ ordering: +b
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (b, a)
│     ordering: +b,+a
│     estimated row count: 1,000 (missing stats)
│     table: ab@ab_b_a_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (y, x)
      ordering: +y,+x
      estimated row count: 1,000 (missing stats)
      table: xy@xy_y_x_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJykk29r2zwQwN8_n0Lcq5Yq1LIdnlYwcNt4EEjrLg6jY4Qg25fUzLEySaE2Jd99yO6fxDQZ6V4F3V1-9ztZ9wz6dwEcwof70dXwjpwMhvEk_jai5Hs4vo7i8JTE4Si8mZCEEkG-jqNbIhISPtyE95PXVE2uYpuv7O9LUVWTaDwIx-T6B0mAQikzvBNL1MB_AoMphZWSKWotlQ09NwXDrALuUMjL1drY8JRCKhUCfwaTmwKBw0QkBY5RZKjOHaCQoRF50WBFEohklszELM8qoHAji_Wy1JwI2jjEK2FPPaAQrQ0ngUsDBtMNBbk27x21EQsEzrYUhwPgzoZ-zpLtWlZ1UNWzelZ1LStK6qMt3Y4lO8ZykGuTl6k5d3cVA0YDG4pUhgozTtrAPgev4-B-ysH7Jwe_4-DtdXhvvS5lC9_pPLX__FvJB4PcolpgjCZanfu7o0zqFfLXnbkajYBCgXNzErAzGrhnp19Uvnh8P759-IMD9zsD-8dc-hj1SpYau4N_2MnpdOoxOz5mC2yvU8u1SvFeybSpbY9RA2oCGWrTZt32MCxfU9ooFMu37domsYMkbz-JdUnuQZK_Q2LbJLdL8o4gudskr0vyD5L6h-5pSmFeyKdZngGHCyfJ-n7f6Xnp__2en7p-T1ykl72EpcK_cFzhX9olmhdioe0DiB_lU4O1b1IDn4tCI4Vb8QsHaFAt89LuY_qS2Wz--xMAAP__6Efz2w==

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b FROM ab EXCEPT ALL SELECT x AS a, y AS b FROM xy ORDER BY b, a
----
distribution: local
vectorized: true
·
• except all
│ columns: (a, b)
│ ordering: +b,+a
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (a, b)
│     ordering: +b,+a
│     estimated row count: 1,000 (missing stats)
│     table: ab@ab_b_a_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (x, y)
      ordering: +y,+x
      estimated row count: 1,000 (missing stats)
      table: xy@xy_y_x_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJycktFr2zAQxt_3V4h7aqlMLbfJg2DgtvEgkNaZHUbHCEa2LqmZY3mSTG1C_vdhp1sS027rnszdff7u90nagvlRAIfgcT67mT6Qs8k0XsSfZ5R8CaLbMA7OSRzMgrsFEZSk5FMU3hORkuDxLpgvyM1s9mvckJu407Td90XYtCSMJkFEbr-SlBIBFEol8UFs0AD_BgyWFCqtMjRG6a617QVT2QB3KeRlVduuvaSQKY3At2BzWyBwWIi0wAiFRH3pAgWJVuRFbytSX6RJmogklw1QuFNFvSkN7yMAhbgSXeXAckdB1fawxFixRuDsiGo6Ae7u6P-BsVOwpvWbNmmTZgjWUNL-C5g3AGNvgh146lJpiRrlCcuy-_NvklfS3aNeY4w2rC6903CLtkJ-9DCAQoEre-Z7F9RnF-cfdb5-OpRAIawtJz6jvvdm4KtBYO89NxGhqVRpcBj81U3uYJPDuvgo17g_TqNqneFcq6zX7suwN-obEo3dT719MS37Ees2aBSb3w_p2Im9w8k7dmJDJ--PTlcnTu4p05LCqlDPSS6Bg3stxmzERg6Ox9fONZNjRwjmOVl6xQTiyJOrEXQ_iLXpDjt-Us-9bXf_BvhKFAYp3IvvOEGLepOXubF59jLZ7T78DAAA__-bXmt-

statement ok
CREATE TABLE abcde (a INT PRIMARY KEY, b INT, c INT, d INT, e INT, INDEX (b, c, d, e))

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT * FROM (SELECT a, b, c, d, e FROM abcde UNION SELECT a, c, b, d, e FROM abcde) WHERE c = 1 AND d = e ORDER BY a
----
distribution: local
vectorized: true
·
• union
│ columns: (a, b, c, d, e)
│ ordering: +a
│ estimated row count: 2 (missing stats)
│
├── • filter
│   │ columns: (a, b, c, d, e)
│   │ ordering: +a
│   │ estimated row count: 1 (missing stats)
│   │ filter: (c = 1) AND (d = e)
│   │
│   └── • scan
│         columns: (a, b, c, d, e)
│         ordering: +a
│         estimated row count: 1,000 (missing stats)
│         table: abcde@abcde_pkey
│         spans: FULL SCAN
│
└── • sort
    │ columns: (a, c, b, d, e)
    │ ordering: +a
    │ estimated row count: 1 (missing stats)
    │ order: +a
    │
    └── • filter
        │ columns: (a, b, c, d, e)
        │ estimated row count: 1 (missing stats)
        │ filter: d = e
        │
        └── • scan
              columns: (a, b, c, d, e)
              estimated row count: 10 (missing stats)
              table: abcde@abcde_b_c_d_e_idx
              spans: /1-/2
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyck29v4jgQxt_fp7DmFRyOwPmDqKVKaUuqi9RCL-Fud7VCyImn3aghYW2jtqr47qsEdgvZhm37JpJnRs_zs5_JM-jvOXAIPt9cnYUT0hmH8Sz-94qS_4PofBoHXRIHV8HFjPxNLqPpNensjoKShJKUEkkJblsiSSWS_ybhdEJeptJ6sDHVJZ_-CaKAdFJySliXnE3GpCPJKcEumUbjICLnX4gACkUpcSKWqIF_BQZzCitVpqh1qarScz0QykfgAwpZsVqbqjynkJYKgT-DyUyOwGEmkhwjFBJVfwAUJBqR5bVsTeTX30WySBdygYtMPgKFizJfLwvND28LFOKVqMp9ZvVtmG8olGvz4q2NuEPgbA82HAMfbOjbeS-z3KBC1WeHsNs6J75LTonvtZrbDXP2HvO4VAZV3z609lkPKEzXhhOfUd-hvk19lx6BcBoQ9nsg9hNz2hNb3ePTG6KyWiHdBqTzoZjc12Pq-E614ZzzcDIb7RZ9l123FclrILmtSC8kpZKoUP4WGfXtHvWdHvXdHvW9Hsw3r9xjnGmTFanpe02BOmXnD0EPG8Dee94wQr0qC40Hzm1Og4aTxarroLzD7XPocq1SvFFlWs9uj9NaqC5I1GbbZdtDWPxsaaNQLH_9qftK7KiS3a7Emkr2USXvQIntK7lNJeeoktvOZDeV3I8yOU0l76jS8NiLzync5uXDIpPAwUVvlEjhWI49TCzXHY6s5ORkZDExsk9cT4wcr1rU21zc6WqV4m_lQy07e1pVi3Arco0UrsU9jtGgWmZFteDprrPZ_PUjAAD__3gJMGI=

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT * FROM (SELECT a, b, c, d, e FROM abcde UNION SELECT  a, c, b, d, e FROM abcde) WHERE c = 1 AND d = e ORDER BY b, c, d, e, a
----
distribution: local
vectorized: true
·
• union
│ columns: (a, b, c, d, e)
│ ordering: +b,+c,+d,+a
│ estimated row count: 2 (missing stats)
│
├── • filter
│   │ columns: (a, b, c, d, e)
│   │ ordering: +b,+d,+a
│   │ estimated row count: 1 (missing stats)
│   │ filter: (c = 1) AND (d = e)
│   │
│   └── • scan
│         columns: (a, b, c, d, e)
│         ordering: +b,+c,+d,+e,+a
│         estimated row count: 1,000 (missing stats)
│         table: abcde@abcde_b_c_d_e_idx
│         spans: FULL SCAN
│
└── • filter
    │ columns: (a, c, b, d, e)
    │ ordering: +c,+d,+a
    │ estimated row count: 1 (missing stats)
    │ filter: d = e
    │
    └── • scan
          columns: (a, b, c, d, e)
          ordering: +c,+d,+e,+a
          estimated row count: 10 (missing stats)
          table: abcde@abcde_b_c_d_e_idx
          spans: /1-/2
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysk11v2jwUx--fT3F0ruDBETgvjFqq5LakWqQWusDeNCFk4kMXLSQsDmqniu8-JbABUWFrtRskHx9-_vnvkyc03xMU6H-6u7kIBtDoB6Px6N0Ngw9-eDkc-U0Y-Tf-1Rj-h-tweAuN7VIxmDGIGGgGtNlSs0gTvB8EwwHsuqKqsdbVhI9v_dCHRgTnwJtwMehDQ8M5UBOGYd8P4fLzHp-BQoZppmmgFmRQfEGOE4bLPIvImCwvS09VQ6AfUXQYxulyVZTlCcMoywnFExZxkRAKHKtZQiEpTXm7gww1FSpOKmxlJ6vf6WwaTfWUprF-RIZXWbJapEYc3hwZjpaqLLe51bZxsmaYrYrd2aZQ94SC78kGfRSdNft73-s4KSinvM0PZTd1AdKFc5AeMhyuCgGSM-kwaTPpMukdVbJrSvwlSvsR2v8qQuuoq1NztV8Vn_N8fA3plFMohAgG4952GLeZNo8quTUl56jSziTLNeWkDzWk3WLSaTHptpjkLSa9Fk7Wz9yjH5siTqOi7dYAvHps5w_v7dWE3ZdkGJJZZqmhg5OPndSpnWTx8jqk72kTh8lWeUR3eRZVvZvlsAJVBU2m2OzyzSJIf22ZIie1-P0F7ZP4SZJ7QOL7JKdOsk-SnONOvE5yXutk10nuSZJ3KqcJw3mSPUxjjQJ594zm5DhWx30zs1w3cq0zr9u1ep1uz5mT8ma9OZZ_UPemHIDR1-yhwo5_LMvnm6vEEMNb9Y36VFC-iNNyLKPtznr9388AAAD__w6Y-bs=

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT * FROM (SELECT * FROM abcde UNION ALL SELECT * FROM abcde) WHERE c = 1 AND d = e ORDER BY a
----
distribution: local
vectorized: true
·
• union all
│ columns: (a, b, c, d, e)
│ ordering: +a
│ estimated row count: 2 (missing stats)
│
├── • filter
│   │ columns: (a, b, c, d, e)
│   │ ordering: +a
│   │ estimated row count: 1 (missing stats)
│   │ filter: (c = 1) AND (d = e)
│   │
│   └── • scan
│         columns: (a, b, c, d, e)
│         ordering: +a
│         estimated row count: 1,000 (missing stats)
│         table: abcde@abcde_pkey
│         spans: FULL SCAN
│
└── • filter
    │ columns: (a, b, c, d, e)
    │ ordering: +a
    │ estimated row count: 1 (missing stats)
    │ filter: (c = 1) AND (d = e)
    │
    └── • scan
          columns: (a, b, c, d, e)
          ordering: +a
          estimated row count: 1,000 (missing stats)
          table: abcde@abcde_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0k1tv2jAUx9_3KY7OE2yOSm4btVSJtqRaJBq6wG6aUGXsQxc14MwO6qqK7z4ldCtEBa1oe4l0Lvn5l3-SB7Q_cuQYfbkanMYJtPrxaDz6MGDwKUrPhqOoDaNoEJ2P4TVcpMNLaG2XYioVwcckHiZwOhjAM9M2fH4fpRG0JJyA24bTpA8tBSdAbRim_SiFs68gkOFCK0rEnCzyb-jihGFhtCRrtalaD_VCrH4i7zDMFsWyrNoThlIbQv6AZVbmhBzHYppTSkKROeogQ0WlyPIaWxv16ut1cUv3yPBc58v5wnIQDKYMJAPFgJDhqBBV28HJiqFelk8H2lLcEHJ3wzDuI--s2N9LXmR5SYbMkbttuO5zaPX8Ki_OeZyMu4-x9QI4gV7Y3qnkNZTclyht5ub9x9z8hqR3UG7-v8wtaCj5O5WeTLRRZEhta_TcNzhZPeOdaEcXR8HW9i6bTsMmeElAKdlCLywddJLjVu6kbmj9rFYvjaQro2W9uy6HNahuKLLleuqui3jxe2RLQ2L-57_YJLl7ScEWyd0k-U2St5fk73ZymyT_UCevSQr2ksJ9OU0YznJ9d50p5Phu2u0eq7eeMwu90An8aegcy1A6XSm7oZgFrqAuVjeIG1t9AKPv-q7Gju-L6vXNRG6J4aW4pT6VZObZIrNlJh8nq9WrXwEAAP__xQvkWw==

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT * FROM (SELECT * FROM abcde UNION ALL SELECT * FROM abcde) WHERE c = 1 AND d = e ORDER BY b, c, d, e, a
----
distribution: local
vectorized: true
·
• union all
│ columns: (a, b, c, d, e)
│ ordering: +b,+c,+d,+a
│ estimated row count: 2 (missing stats)
│
├── • filter
│   │ columns: (a, b, c, d, e)
│   │ ordering: +b,+d,+a
│   │ estimated row count: 1 (missing stats)
│   │ filter: (c = 1) AND (d = e)
│   │
│   └── • scan
│         columns: (a, b, c, d, e)
│         ordering: +b,+c,+d,+e,+a
│         estimated row count: 1,000 (missing stats)
│         table: abcde@abcde_b_c_d_e_idx
│         spans: FULL SCAN
│
└── • filter
    │ columns: (a, b, c, d, e)
    │ ordering: +b,+d,+a
    │ estimated row count: 1 (missing stats)
    │ filter: (c = 1) AND (d = e)
    │
    └── • scan
          columns: (a, b, c, d, e)
          ordering: +b,+c,+d,+e,+a
          estimated row count: 1,000 (missing stats)
          table: abcde@abcde_b_c_d_e_idx
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0k19v2jwUh-_fT3F0ruDFUXESaGepUtqSapFo6AL7pwkhE5920QLO7KB2qvjuU0K3QlTQWm03kc459uPHvyQPaL_nKDD8dD08i2JoDaLxZPxuyOBDmJyPxmEbxuEwvJjA_3CZjK6gtVvKeaoI3sfRKIaz4RCembbh49swCaGVwinwNpzFA2gpOAVqwygZhAmcf4Y5g5SBYkAMJDJcakWxXJBF8QU5ThkWRqdkrTZV66FeEKl7FF2G2bJYlVV7yjDVhlA8YJmVOaHAiZznlJBUZI66yFBRKbO8xtZ2Qf2czWfpTM1olql7ZHih89ViaQVItmWGDMeFrNoOTtcM9ap8OteW8pZQ8C3RaICiu2Z_7nqZ5SUZMkd8V3TTF9AKvCpCIUQUT04ekwx8OIWg196r5DaU-EuUtuNz_318XsPVfVV83t-Mz28oeXuVnky0UWRI7WoEbocFXocFfocFvIPT9TN3iLWjiyN_Z-c-s27DzH9JWAnZQi8tveokh1fupG5pc2-rVyala6PTeu2mHNWguqHIlpsp3xTR8tfIlobk4vevsk3iB0n-Dolvk7wmyT1I8vY78SbJe62T2yT5B0m9QzlNGd7k-m6WKRToyp7XP3njO_05-Y4vb3xHdnsnznFP9Xnak_1j6mO1Qd7a6gMYf9V3NXbyo6he343MLTG8kt9oQCWZRbbMbJmlj5P1-r-fAQAA___9vu44

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT b, c, d, e FROM (SELECT b, c, d, e FROM abcde INTERSECT SELECT b, c, d, e FROM abcde) WHERE c = 1 AND d = e ORDER BY b
----
distribution: local
vectorized: true
·
• intersect
│ columns: (b, c, d, e)
│ ordering: +b
│ estimated row count: 1 (missing stats)
│
├── • filter
│   │ columns: (b, c, d, e)
│   │ ordering: +b,+d
│   │ estimated row count: 1 (missing stats)
│   │ filter: (c = 1) AND (d = e)
│   │
│   └── • scan
│         columns: (b, c, d, e)
│         ordering: +b,+c,+d
│         estimated row count: 1,000 (missing stats)
│         table: abcde@abcde_b_c_d_e_idx
│         spans: FULL SCAN
│
└── • filter
    │ columns: (b, c, d, e)
    │ ordering: +b,+d
    │ estimated row count: 1 (missing stats)
    │ filter: (c = 1) AND (d = e)
    │
    └── • scan
          columns: (b, c, d, e)
          ordering: +b,+c,+d
          estimated row count: 1,000 (missing stats)
          table: abcde@abcde_b_c_d_e_idx
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lW9v2joUh9_fT2GdVyCMIP_gXktIaUuqi0ShN0F3myaEQnyg0ULCbKN2qvjuk5N2DVmTjap7g5RzzHMe_wzOI8ivCTDwPt5OLyYz0hpPgkXw35SS_z3_ch54bRJ4U-9qQdaURJRwSpBc-_Mb0qqph-uII5nMFp4f6H7Tsjb58K_ne6QVkREx2uRiNiYtTkYE22Tujz2fXH4ia6CQZhxn4Q4lsM9gwJLCXmQRSpkJXXrMF0z4A7A-hTjdH5QuLylEmUBgj6BilSAwWITrBH0MOYpeHyhwVGGc5NjcyM0_V-tVtOIrXMX8AShcZclhl0pW2gRQCPahrnVheaSQHdTLUKnCLQIzSpaTMbD-kf6-6HWcKBQoesapZVFnpOWaOjPG2GS2-PspOtciI-La7Vols6JknKNUzs78w9lZFVHzTdlZ75mdXVGyzlEax1LFaaR69qmSa1DXpK5FXd2YC44COSO6bNWaOBUT-00mzjuYDComTq3Ji8AhzQr4yfyl_uavlryynRsUWwxQzfe9wemGFt_2yEoX0cV0ChQS3KiWa3Soa3Woa3aoa3faIxFv734u6xwOqsjgOZq6JIaVJAbnnImPcp-lEquJvDqpX5nUNXQuyLdY5Cyzg4jwVmRRvrZ4nOegvMBRqqJrFA-T9LkllcBw9-OuKpOMRpJTT7KqJLORZNWTjCrJaiTZ9SSzSrIbSYMTklEm2VWScwbJLJOcKmnQSBo2nd2SwibJ7lcxBwbDyMYQ18NuP7TXXduwePefITe7A3vDnc0gQsfSr9hNEm6l_lEGd9l9jtV_IAlsEyYSKdyEX3CMCsUuTvUVEj11jse_vgcAAP__AYSaAA==

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT b, c, d, e FROM (SELECT b, c, d, e FROM abcde EXCEPT SELECT b, c, d, e FROM abcde) WHERE c = 1 AND d = e ORDER BY b, c, d, e
----
distribution: local
vectorized: true
·
• except
│ columns: (b, c, d, e)
│ ordering: +b,+d
│ estimated row count: 1 (missing stats)
│
├── • filter
│   │ columns: (b, c, d, e)
│   │ ordering: +b,+d
│   │ estimated row count: 1 (missing stats)
│   │ filter: (c = 1) AND (d = e)
│   │
│   └── • scan
│         columns: (b, c, d, e)
│         ordering: +b,+c,+d
│         estimated row count: 1,000 (missing stats)
│         table: abcde@abcde_b_c_d_e_idx
│         spans: FULL SCAN
│
└── • filter
    │ columns: (b, c, d, e)
    │ ordering: +b,+d
    │ estimated row count: 1 (missing stats)
    │ filter: (c = 1) AND (d = e)
    │
    └── • scan
          columns: (b, c, d, e)
          ordering: +b,+c,+d
          estimated row count: 1,000 (missing stats)
          table: abcde@abcde_b_c_d_e_idx
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF9v2joYxu_Pp7DeKxBGkL-AJaS0JdVBotCToLNOE0JJ_EKjhYTZRu1U8d2nJO0KWcNG1d0g5bH98y9PsJ9AfkuAgXt3O7kYT0ljNPbn_n8TSv53vcuZ7zaJ707cqzkJKYko4ZQgufZmN6RRkwdhxJG4d1fu7bxubTGnST7963ouaURkSLQmuZiOSIOTIcEmmXkj1yOXnw9WAoU04zgNNiiBfQENFhS2IotQykzk0VMxYcwfgXUpxOl2p_J4QSHKBAJ7AhWrBIHBPAgT9DDgKDpdoMBRBXFSYAs1p_hdhstoyZe4jPkjULjKkt0mlezYyd8GedaGxZ5CtlOvm0oVrBGYdmA5HgHr7umfi17HiUKBoqMdW5Y5Iw1Hz8tjjI2n8_5zh45BhsQxm7VKekVJO0fpsDv9L3dnVET1d3VnfGR3ZkXJOEdpFEsVp5HqmMdKjkYdnToGdfKBmeAokDOSx0atiVUxMd9lYn2AiV0xsWpNXgV2aVbCj_Zf5Ct_N-WN17lBsUYf1WzbsY9faP59i-zlOrqYTIBCgivVcLQWdYwWdfQWdcxWcyji9f2vcV7CTpUFvPRSV0OvUoN9zgfxUG6zVGK1jjd36lZ2amt5KcjXWJYss52I8FZkUTG3fJwVoCLgKFU5qpUP4_RlSCqBwebnRXVI0k6SzHqSXiXpJ0lGPUmrkoyTJKueZFRJ5kmSfUTSDklmlWSdQdIPSVaVZJ8k9U59uwWFVZI9LGMODFa9fjiwNbvdHUS9tjmw7PYgDPttC3tht8tDnffz475KgrXM_5T-ffZQYPPTI4GtgkQihZvgK45QodjEaX5_RM8j-_0_PwIAAP__6FeZZg==

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT * FROM (SELECT * FROM abcde EXCEPT ALL SELECT * FROM abcde) WHERE c = 1 AND d = e ORDER BY a
----
distribution: local
vectorized: true
·
• except all
│ columns: (a, b, c, d, e)
│ ordering: +a
│ estimated row count: 1 (missing stats)
│
├── • filter
│   │ columns: (a, b, c, d, e)
│   │ ordering: +a
│   │ estimated row count: 1 (missing stats)
│   │ filter: (c = 1) AND (d = e)
│   │
│   └── • scan
│         columns: (a, b, c, d, e)
│         ordering: +a
│         estimated row count: 1,000 (missing stats)
│         table: abcde@abcde_pkey
│         spans: FULL SCAN
│
└── • filter
    │ columns: (a, b, c, d, e)
    │ ordering: +a
    │ estimated row count: 1 (missing stats)
    │ filter: (c = 1) AND (d = e)
    │
    └── • scan
          columns: (a, b, c, d, e)
          ordering: +a
          estimated row count: 1,000 (missing stats)
          table: abcde@abcde_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0k29v2joUh9_fT3F0XsHFqDh_7r1YQnJbUl0kCh2grdOEKic50KghyWyjrqr47lNCt0IEbJ22N5F8jvP48c_2M5rPKQoMbm-G54MRNPqD6Wz6bsjgfTC5GE-DJkyDYXA5g7_hajK-hsb-UIVRTBDcXgY3MzgfDuFAuwkf_g8mATQi6AFvwvmoD40YekBNGE_6wQQuPoJChlke00ityKD4hBznDAudR2RMrsvSczVhEH9B0WGYZMXaluU5wyjXhOIZbWJTQoEzFaY0IRWTPusgw5isStIKWxnJ6ntXPNATMrzM0_UqMwIUg5BBxCBmQMhwWqiy3Mb5hmG-tq8LGquWhILvGA76KDob9vOSV0lqSZM-4_uG27qAhnTLvIQQg9Hsv5fYpAc9kH7zqJJTU-JvUdrNzfmDubk1SeeXcnN_Z25eTck9qvRqss5yHZOmeE9kXv75oykH9nVNeklTsuPizNvf2eypILHzyJBhSgvbkLzFpNNi0m0x6bWY9FvNnk6W94dbyHC8tgIkZ9Jh0mXSY9I_mohfS8R7yyFNyBR5ZqiezMGVOrWV2rzMh-IlbfM2-VpHdKPzqJq7HY4rUFWIydhtl28Hg-xby1hNavX9be6S-EmSt0fiuySnTnJOktzjTrxOct_g5OyS3DrJO0nyT-U0Z7hI88e7JEaBTtd33VB57a7qUNvzI78d_hvydtdxu4vwHy90eHnIi1QtTXkBpvf5Y4UtL61BsVCpIYbX6oH6ZEmvkiwxNoleOpvNX18DAAD__ymJCSk=

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT * FROM (SELECT * FROM abcde INTERSECT ALL SELECT * FROM abcde) WHERE c = 1 AND d = e ORDER BY b, c, d, e, a
----
distribution: local
vectorized: true
·
• intersect all
│ columns: (a, b, c, d, e)
│ ordering: +b,+d,+a
│ estimated row count: 1 (missing stats)
│
├── • filter
│   │ columns: (a, b, c, d, e)
│   │ ordering: +b,+d,+a
│   │ estimated row count: 1 (missing stats)
│   │ filter: (c = 1) AND (d = e)
│   │
│   └── • scan
│         columns: (a, b, c, d, e)
│         ordering: +b,+c,+d,+e,+a
│         estimated row count: 1,000 (missing stats)
│         table: abcde@abcde_b_c_d_e_idx
│         spans: FULL SCAN
│
└── • filter
    │ columns: (a, b, c, d, e)
    │ ordering: +b,+d,+a
    │ estimated row count: 1 (missing stats)
    │ filter: (c = 1) AND (d = e)
    │
    └── • scan
          columns: (a, b, c, d, e)
          ordering: +b,+c,+d,+e,+a
          estimated row count: 1,000 (missing stats)
          table: abcde@abcde_b_c_d_e_idx
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0k21v2joUx9_fT3F0XsHFqOSBQi0huS2pLhKF3gTtQRNCJj6l0ULCbKN2qvjuU0K3QgRsnbY3SD7n5Oef_9jPaL6kyDH4cDe8HIyg1h9Ek-j_IYN3QXg1joI6RMEwuJ7Av3ATjm-htr-U81gRDEaTIIyK8uVwCAcm6vD-vyAMoBZDD5w6XI76UFPQA6rDOOwHIVx9hDmDmIFiQAwkMsxyRSO5JIP8Ezo4ZbjSeUzG5LooPZcDA_WEvMUwyVZrW5SnDONcE_JntIlNCTlO5DylkKQifdZChoqsTNISW9qJ8nc2n8UzNaNZop6Q4XWerpeZ4SDZjhkyjFayKDdxumGYr-3rvsbKBSF3dkQHfeStDft115sktaRJnzn7ots6h5rwigg554PRpPuSpPChB6JdP6rkVpSctyjtxuf-_fi8iqv7W_F5fzI-v6LkHVV6NVlnuVakSe2JTIsvfzZy4Fy3pBcUkR2vzvz9k02-rojvv0BkmNK9rQm3wYTfYMJpMOE1mGg36j2dLB4Ot5DheG05CIcJlwmPCZ-J9tFQ2pVQ_Lf8TyGZVZ4ZqoZzcKdWZaemU0REakHbyE2-1jHd6TwuZ7fLcQkqC4qM3Xad7WKQfW8Zq0kuf7zSXZJzkuTvkdxdklcluSdJ3nEnp0ry3uDk7JLcKsk_SWqfymnK8D7NH2eJQo4dNb_oKHKaXb970fS7zkWze-51mudz1235vprLTozFB3JhigsQPeSPJba4twb5vUwNMbyVn6lPlvQyyRJjk_ils9n88y0AAP__r04Sng==

# Regression test for #64181. Ensure that a projection on top of an ordered
# UNION ALL correctly projects away ordering columns.
query T
EXPLAIN (DISTSQL,VERBOSE) WITH q (x, y) AS (
  SELECT * FROM (VALUES ('a', 'a'), ('b', 'b'), ('c', 'c'))
  UNION ALL
  SELECT * FROM (VALUES ('d', 'd'))
)
SELECT 'e', y FROM q
ORDER BY x
----
distribution: local
vectorized: true
·
• project
│ columns: ("?column?", y)
│
└── • render
    │ columns: ("?column?", x, y)
    │ ordering: +x
    │ render ?column?: 'e'
    │ render x: column1
    │ render y: column2
    │
    └── • union all
        │ columns: (column1, column2)
        │ ordering: +column1
        │ estimated row count: 4
        │
        ├── • sort
        │   │ columns: (column1, column2)
        │   │ ordering: +column1
        │   │ estimated row count: 3
        │   │ order: +column1
        │   │
        │   └── • values
        │         columns: (column1, column2)
        │         size: 2 columns, 3 rows
        │         row 0, expr 0: 'a'
        │         row 0, expr 1: 'a'
        │         row 1, expr 0: 'b'
        │         row 1, expr 1: 'b'
        │         row 2, expr 0: 'c'
        │         row 2, expr 1: 'c'
        │
        └── • values
              columns: (column1, column2)
              size: 2 columns, 1 row
              row 0, expr 0: 'd'
              row 0, expr 1: 'd'
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyckdFO20wQhe__pxjNjeO_G8VrQ6j2itC4rSXjUDvQVhWq1t6BWjXesOsUEMq7V7bbAhZBwN145uz5jmdu0V5WKDD8chTPogRG8yhbZp9iBidherDIQhc-R8uPcAmjawY3LswyGGVhHL5bwv_wPl0cwuhkFh-HGYwc6TBwpOMyGDl5W-d9XbR14bguHCfRIoFZHMM2D9VqleO67l-JQw6Dm153CYt0HqZw8BWukWGtFSXygiyKb8jxlOHK6IKs1aZt3XaCSF2j8BiW9WrdtO1ThoU2hOIWm7KpCAVWupAV_JLVmix4Ew8ZKmpkWXX6DUO9bu5e20aeEwp-DxfNUXgb9koin_BnEf0Bkb-EmGnTkJn4D0i4z9_gNlwwwPlbcXcUbRQZUo9BHsmU6LFeTYKH6pRqRUa0hxdCZMs0Sj4w2Pe35vQGOYOXrCUlu9K1pWcdYEga8_avSJ1TvwWr16agI6OLTtt_LjqjrqHINv006D-iuhvxlmBIXvxb830n_qST_8DJu-_kDZ3812biQ6fgSaedpzKdMjyr9NX3UqFAVex6u_lePp5O5c54h78NxjKY0tgPKD_bkwUP8im2D-S5bc-W_dBXne3yZtUu_UxWlhgeyp80p4bMRVmXtimLP5PN5r_fAQAA___qSYgK

# Regression tests for #64062. Use a streaming set operation even though the
# ordering is not required.
query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b, c FROM abcde UNION SELECT b, c, d FROM abcde
----
distribution: local
vectorized: true
·
• union
│ columns: (a, b, c)
│ estimated row count: 2,000 (missing stats)
│
├── • scan
│     columns: (a, b, c)
│     ordering: +a
│     estimated row count: 1,000 (missing stats)
│     table: abcde@abcde_pkey
│     spans: FULL SCAN
│
└── • scan
      columns: (b, c, d)
      ordering: +b,+c,+d
      estimated row count: 1,000 (missing stats)
      table: abcde@abcde_b_c_d_e_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyckVFr2z4Uxd__n0Lcp_-ITC3bbMFP3hoPDGnSxdkYDGNk6SYzdSxPUmhL8Hcfcto1McvY-mLQPdI5v3t8APOjgRjSr7fz99mC_D_L8nX-aU7Jl3T1YZmnb0ieztPrNeGUVJQI8nG1vCG8EhLJ50W2XDzrTqREnuhAoVUSF3yHBuJvwKCg0Gkl0Bil3egwXMjkA8Q-hbrt9taNCwpCaYT4ALa2DUIMa141uEIuUV_5QEGi5XUz2A5ZyfAtq1KUssSylg9A4Vo1-11r4mc2oJB33A08KHoKam9fEo3lW4SYnSBmM4j9nr6Okl2m7O7w8RTvqdq_wQtGeOwi3guV0hI1ynOehE1oEkxoEk6g6H-zy6w2tm6FvQrGD2kS0CS8iBiOEIN_aXCFplOtwbPMS0n-KMljbhGUWzwWYNReC7zVSgx3j8flYDQMJBp7VIPjIWsHibkEjXz3q-FTJ_ZaJ3_sFPzRKTxz8s-dCgqbRt2XtYQYprIKqqmMPOTC96INE14V-e-86O2URVOBXIQRuAd8a1zZ-Xd1P9iuHztX1YY3Binc8DucoUW9q1v388WT0vf__QwAAP__-sRUzw==

# Use a streaming set operation even though the ordering is not required.
query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b, c FROM abcde INTERSECT SELECT b, c, d FROM abcde
----
distribution: local
vectorized: true
·
• intersect all
│ columns: (a, b, c)
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (a, b, c)
│     ordering: +a
│     estimated row count: 1,000 (missing stats)
│     table: abcde@abcde_pkey
│     spans: FULL SCAN
│
└── • scan
      columns: (b, c, d)
      ordering: +b,+c,+d
      estimated row count: 1,000 (missing stats)
      table: abcde@abcde_b_c_d_e_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyck29r2zAQxt_vU4h71VKZWk7bJIKBu8YDQ_50cRiDEYxiXVJTx_IkmbaEfPchJ1ud0Gzr3gR09-S53z2SN2B-FMAh-nY_vI3H5GwQJ7Pky5CSr9H00ySJzkkSDaO7GRGULCjJyOfpZETEIpNI4vEsmiauudc4ASWypQEKpZI4Fms0wL8DgzmFSqsMjVHalTaNIJbPwH0KeVnV1pXnFDKlEfgGbG4LBA4zsShwikKivvSBgkQr8qKxbWaFzW-6SLNUppjm8hko3KmiXpeG_2IDCkklXMGD-ZaCqu3rRGPFCoGzFmI8AO5v6f9RstOU1SO-tPH28f4LXnCEx07ivVLVpdISNcoDorn7598kb-w4Qr3CBO2kugwOV5y9VMhbD-N2OAQKBS7tWcguaBhc0LBzcf5R56uHwxJQmNSWk5DRMKBh5-T6naP1g_fczhRNpUqDxzG8Ock_muQxFwbKFe7CNarWGd5rlTXa3XHSGDUFicbuusHuEJdNK3ATNIr179trO7F3OLG2k3_sFPzRqXPg5B86zSksC_WU5hI4XCFe3yz6fa_bu868q9511xNXDD3RkazXv8mw23Xf47IQK-PCTh7UU2PrXoMBvhSFQQoj8YgDtKjXeZkbm2f7znb74WcAAAD__zAGcZw=

# Use a streaming set operation even though the ordering is not required.
query T
EXPLAIN (DISTSQL,VERBOSE) SELECT b, c, d FROM abcde INTERSECT ALL SELECT b, c, d FROM abcde
----
distribution: local
vectorized: true
·
• intersect all
│ columns: (b, c, d)
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (b, c, d)
│     ordering: +b,+c,+d
│     estimated row count: 1,000 (missing stats)
│     table: abcde@abcde_b_c_d_e_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (b, c, d)
      ordering: +b,+c,+d
      estimated row count: 1,000 (missing stats)
      table: abcde@abcde_b_c_d_e_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0kl9r2zwUxu_fT2HOVUtkasl9u1YwcNd4YMifLg5jMIJRpOPUzLE8SaYdId992NnW2DQbHezG4Occ_Z7nHGkH9msJHOJP95PbZOadjZN0mX6YEO9jvHg3T-NzL40n8d3SWxNPEk957xfzqSfWUqGXzJbxIm2Lt5PJ6T4gUGmFM7FFC_wzUFgRqI2WaK02rbTrGhL1BDwgUFR141p5RUBqg8B34ApXInBYinWJCxQKzUUABBQ6UZQdtvOKum-2zmSmMswK9QQE7nTZbCvLf2YDAmktWsGH1Z6Abtyzo3Vig8DpUcRkDDzYk79LSf9lSjZISU-mfA7XVNooNKh6wVbtyT-1vDDqFM0GU3Tz-oL1J11-q5H33wgQKDF3ZxEdkYiNSBSOzt-aYvPQl4DAvHHciyiJGInCk-OHg_HZay5pgbbWlcXhGl50CgZOPm2XgWqDh-Va3RiJ90bLrvfwO-9AnaDQukOVHX6Sqiux1sGg2P66vWMSfQWJHpOCIYn9lhT2SEGftCKQl_oxKxRwkDeXV4Jdh74Mr6h_yTD3BRPCz-mN_F9e03WQv4H2gNjYdtnpg37ssO1rsMBzUVokMBVfcIwOzbaoCusK-aOy3__3PQAA__8Jr3We

# Use a streaming set operation even though the ordering is not required.
query T
EXPLAIN (DISTSQL,VERBOSE) SELECT b, c, d FROM abcde EXCEPT SELECT a, d, e FROM abcde
----
distribution: local
vectorized: true
·
• except
│ columns: (b, c, d)
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (b, c, d)
│     ordering: +b,+c,+d
│     estimated row count: 1,000 (missing stats)
│     table: abcde@abcde_b_c_d_e_idx
│     spans: FULL SCAN
│
└── • scan
      columns: (a, d, e)
      ordering: +a
      estimated row count: 1,000 (missing stats)
      table: abcde@abcde_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyck2FL40wQx98_n2KZV4pbbDYJj1k4iGdzUKjWa8ohHKVss5MaTLO53Q0q0u9-JLWaBtuzvilkdvqb3_zZfQHzJwcO0d3t6HJ4Q04Gw3ga_xxR8iuafB_H0SmJo1F0NSULShJKJPkxGV8TsUgkkujuKrqdbhsEJZISbDUAhUJJvBErNMB_gwMzCqVWCRqjdF16aRqG8gl4n0JWlJWtyzMKidII_AVsZnMEDlOxyHGCQqI-7wMFiVZkeYNtZoXN73wxT-ZyjvNMPgGFK5VXq8LwrTxQiEtRF3owW1NQlX2faKxYInCnpTgcAO-v6dcsnf2W5QM-t_Veo_uMHuvoOcfoDTJjsyKx52zXLXRoyGjoAoWxlqhRcvJW22fidkzYl0zcz5jsdfA6Du5eh_fRVaE25J3Js_qf_2r5YJFr1EuM0Y7Lc293lelziXz7Ri5HI6CQY2pPQueMhuyMhu7Z6TedLe93S_Xmlf1E_n5nd--Y_CdoSlUY7Gbw4aR-Z1LPqZNAucRNskZVOsFbrZKmd_M5bkBNQaKxm1O2-RgW2yNjNYrV2ztrk5yDJHc_yemS2EGSt0Ny2iTWJblHkFib5HZJ3kGSfyinGYU0V4_zTAIHPw2YkP7_PffCD3oeSy96gZcGPT_wXZddiCBY1Lc4zcXS1BcgvlePDba-ngZ4KnKDFK7FAw7Qol5lRf00k9eT9fq_vwEAAP__MXD0-A==

# Use a streaming set operation even though the ordering is not required.
query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b, c FROM abcde EXCEPT ALL SELECT b, c, d FROM abcde
----
distribution: local
vectorized: true
·
• except all
│ columns: (a, b, c)
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (a, b, c)
│     ordering: +a
│     estimated row count: 1,000 (missing stats)
│     table: abcde@abcde_pkey
│     spans: FULL SCAN
│
└── • scan
      columns: (b, c, d)
      ordering: +b,+c,+d
      estimated row count: 1,000 (missing stats)
      table: abcde@abcde_b_c_d_e_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyckmFr2z4Qxt__P4W4Vy2RqWU3_1LBwF3iQSBpsjiMwghGts6pqWN5kkxbQr77sNOujmm2dW8Cunvy3O8e3w7MjwI4hHeL6c3klpyNJ9Eq-jql5Fu4_DyPwnMShdNwtCKCkoSSlHxZzmdEJKlEEt6NwsWK3Eynr6JGQYnsiIBCqSTeii0a4N-BwZpCpVWKxijdlHatYCKfgLsU8rKqbVNeU0iVRuA7sLktEDisRFLgEoVEfeECBYlW5EVr284K2t-4esBnoDBSRb0tDX8lBwpRJZqCA-s9BVXbt1HGig0CZx22yRi4u6f_hsdO4yVxGssY41w-dSlfovsbSq9HyU5SvsHVpdISNcojsHXzzz9J3ll1hnqDEdp5deEdb7p6rpB3LgMoFJjZs4ANaOANaOAPzj_pfHN_XAIK89pyEjAaeDTwT-7u93b3PvKFlmgqVRrsZ_DuJLc3yWFNEig3eEjWqFqnuNAqbbWH57w1agsSjT10vcNjUrYt1kzQKLa_DqzrxD7g5HWdWN_J-62Tf-TkHjOtKWSFeoxzCRySa1-4mHnOdZb5zqXAKye59IYOXg0F-3_IksRtbiArxMY0YUf36rG1bU7BAM9EYZDCTDzgGC3qbV7mxubpS2e__-9nAAAA__9DA3Ev

# Do not use a streaming set operation for UNION ALL.
query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b, c FROM abcde UNION ALL SELECT b, c, d FROM abcde
----
distribution: local
vectorized: true
·
• union all
│ columns: (a, b, c)
│ estimated row count: 2,000 (missing stats)
│
├── • scan
│     columns: (a, b, c)
│     estimated row count: 1,000 (missing stats)
│     table: abcde@abcde_pkey
│     spans: FULL SCAN
│
└── • scan
      columns: (b, c, d)
      estimated row count: 1,000 (missing stats)
      table: abcde@abcde_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyckF1r2zAUhu_3K8S52kCm_sjKpqt1jQcG1-nibAyGKbJ0nJk6lifJdCX4vw8p7ZqEbnS5Mejo9XMevVswPztgkH67zi-ygryeZ-Wq_JxT8jVdflyU6RtSpnl6uSKckpoSQT4tF1eE10Ii-VJki4Jc5PljxgUokXsZoNAriQXfoAH2HSKoKAxaCTRGaTfa-kAmfwELKbT9MFo3rigIpRHYFmxrOwQGK153uEQuUZ-FQEGi5W3nsX7XB_-9GW7xHihcqm7c9IY9SgGFcuBuEEA1UVCjfVplLF8jsGjPLZsDCyd6ml70cr2HXl-iFx_pRX_Ve7IyqFvekbFXWqJGeSBWTc-8o1CBGs7io-DzRuGRUfw_hS3RDKo3eNKmIHLuKNe4e69RoxZ4rZXw2d1x4UF-INHY3W28O2S9v4rcBo1886fQfVJ0Kik8JsX_JCUHpPCQVFFoOnV300pg8HaWnDdJIwLZCB7MRIzBOy7D4H0sUSY8mdX1Obgf-Nq4sssf6s5jV_eDq6rhnUEKV_wW52hRb9q-NbYVDzfT9Op3AAAA__8XIVFm

# Regression test for #69497. Ensure the merge ordering for streaming set ops
# matches the input ordering.
statement ok
DROP TABLE abc;

statement ok
CREATE TABLE abc (a INT, b INT, c INT, INDEX (a, b, c DESC));
CREATE TABLE def (d INT PRIMARY KEY, e INT, f INT);

query T
EXPLAIN (VERBOSE, DISTSQL) SELECT d, e, f FROM def EXCEPT SELECT a, b, c FROM abc ORDER by d, e
----
distribution: local
vectorized: true
·
• except all
│ columns: (d, e, f)
│ ordering: +d
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (d, e, f)
│     ordering: +d
│     estimated row count: 1,000 (missing stats)
│     table: def@def_pkey
│     spans: FULL SCAN
│
└── • scan
      columns: (a, b, c)
      ordering: +a,+b,-c
      estimated row count: 1,000 (missing stats)
      table: abc@abc_a_b_c_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyckl9r2zwUxu_fTyHOVUtlajlp300wcJt4EEjqzA6jYwQjW8epqWN5kkxbQr77sNOscWi3dZc6f57zO4_OBsyPEjgEt_Pp1eSGnIwn8SL-MqXkaxBdh3FwSuJgGowWRFKClOTkcxTOiMScBLejYL7YpwUlKSXZLi3SjITROIjI9beuEShUSuKNWKMB_h0YLCnUWmVojNJtaNMVTOQjcJdCUdWNbcNLCpnSCHwDtrAlAoeFSEuMUEjU5y5QkGhFUXayEnNfYp7U9_gEFEaqbNaV4Xt2oBDXog04sNxSUI19GWOsWCFwdsA1GQN3t_Tf0FgfTaSZL9IsEUmaZEkhHw_5ns37Gz7viI-9yfeC1VRKS9Qoe0jLtvNPJa8sOUO9whhtWJ97_R0XTzXy_V1cTadAocTcnvjsjPreGfUHzuknXazu-iGgEDaWE59R36P-4M3dB0e7e-_5mwhNrSqDxx68Osk9muSw1gmUK9w5a1SjM5xrlXW1u2fYCXUBicbust7uMam6FGsnaBTrX6d1qMTeoeQdKrFjJe-3SoOekttnWlLIS_WQFBI4MMnSVAzRubjImTMcMtcRQnx0MJODD5fDy_-lm0LbIFamNTu-Uw-dbHsKBnguSoMUZuIex2hRr4uqMLbInjPb7X8_AwAA___9YG6X

# Example where the interesting orderings do not include all columns.
statement ok
CREATE TABLE abcd (a INT, b INT, c INT, d INT, INDEX (a, b, c DESC) STORING (d));
CREATE TABLE efgh (e INT PRIMARY KEY, f INT, g INT, h INT)

query T
EXPLAIN (VERBOSE, DISTSQL) SELECT e, f, g, h FROM efgh EXCEPT SELECT a, b, c, d FROM abcd ORDER by e, f
----
distribution: local
vectorized: true
·
• except all
│ columns: (e, f, g, h)
│ ordering: +e
│ estimated row count: 1,000 (missing stats)
│
├── • scan
│     columns: (e, f, g, h)
│     ordering: +e
│     estimated row count: 1,000 (missing stats)
│     table: efgh@efgh_pkey
│     spans: FULL SCAN
│
└── • sort
    │ columns: (a, b, c, d)
    │ ordering: +a,+b,-c,+d
    │ estimated row count: 1,000 (missing stats)
    │ order: +a,+b,-c,+d
    │ already ordered: +a,+b,-c
    │
    └── • scan
          columns: (a, b, c, d)
          ordering: +a,+b,-c
          estimated row count: 1,000 (missing stats)
          table: abcd@abcd_a_b_c_idx
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyckm9P2zAQxt_vU1j3CsRV5B8MLE0K0EyqVChrqolpqio3vqQRaZzZrgChfvfJ6RhtBmzsjSXfnZ_73eN7BPOjAg7JzfXwbHDF9vqDdJJ-GSL7mozPR2myz9JkmFxMGCHLkRXIFuzzeHTJKC8WLLm5SK4nTyUC2RxZhkxuSsQ8k2w07idjdv6tFQCEWkm6EksywL-DD1OERquMjFHahR7bgoG8B-4hlHWzsi48RciUJuCPYEtbEXCYiHlFYxKS9KEHCJKsKKtW1rHF7pg1t_QACBeqWi1rw7emAIS0ES7Wg-kaQa3scy9jRUHA_S24QR-4t8b_4_N3-ZwxsTtmYjafZbNS3m9DPvv4L5BBB9J_D2SqtCV9GOzyxf4BxsEBxmEP4-gAEJbCZgtWUc1Z-CpJ2CEJXiV5BljVSkvSJHcIpu7l30peGOeSdEEp2VFzGO6ONHloiD_t69lwCAgV5XavM-r-J10Wiz_DgDBaWc5iH-MA4xDj6FUboo4N4Xs-ZEymUbWhrh0vdvI6nXq-M4VkQRuTjVrpjK61ytrazXXUCrUBScZusuHmMqjblO86aBLL3_u0reS_qRTsKHnbSl5XKXgHU7CtFHSVwjeVoreYpgh5pe5mpQQO8iTyTsOTk17uydNeND8WvdMjIXofg-BoHgZRFBy7xcorURj3belC3bWybr8M8FxUhhAuxS31yZJelnVpbJn9yqzXH34GAAD___vduA8=

# Regression test for #68702. Ensure correct behavior when a column is projected
# twice on the left side.
statement ok
CREATE TABLE t68702 (k INT8 PRIMARY KEY)

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT tableoid AS col1, tableoid AS col2, k AS col3 FROM t68702
EXCEPT ALL SELECT * FROM (VALUES (NULL, 2505326470:::OID, (-1643624263):::INT8))
----
distribution: local
vectorized: true
·
• except all
│ columns: (col1, col2, col3)
│ estimated row count: 1,000 (missing stats)
│
├── • project
│   │ columns: (tableoid, tableoid, k)
│   │ ordering: +k
│   │
│   └── • scan
│         columns: (k, tableoid)
│         ordering: +k
│         estimated row count: 1,000 (missing stats)
│         table: t68702@t68702_pkey
│         spans: FULL SCAN
│
└── • values
      columns: (column1, column2, column3)
      size: 3 columns, 1 row
      row 0, expr 0: 2505326470
      row 0, expr 1: -1643624263
      row 0, expr 2: CAST(NULL AS OID)
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyUU2Fr4zgQ_X6_Qsyn5KpQS3aTVHDgXOMDg5v04rQUllBUa5yaOJbXkrdbSv77YrvbJqHd3YLB1pvxm_ceo2cwX3MQENxeRZNwRnrTMF7G_0eU3ASLf-dx0CdxEAUXS2LlfY46U2QSk0TnjB4jnJLNy6dL_lvML4kdjkcOJ8HtRXC1JJMo-sn1d1fv3Uyi6yAmvdl1FFHCz5wzlw-9kSOEmIdTSnoDNvTcIff40O0LIcLZctzvA4VCK5zJLRoQX4DBikJZ6QSN0VUDPbcNofoOwqGQFWVtG3hFIdEVgngGm9kcQcCy8bBAqbA6dYCCQiuzvKXt1Pvd667c4BNQuNB5vS2MIJs3_0AhLmUDDoDCvLaC-Jw2D4PVjoKu7ZsAY-UaQbA9xeEUhLOjfy4614nMyTeZ12iIc8oOdXcCXOoz6vMPBfAjAexDAW9z60JXCitUBwNXzZ-_a3nHxSVWa4zRzstTfuhg-VSi2FsboJBjanu-e0J9dkJ9ftL_p8rWD4fQa_isDd_90Lt75J1_JvwFmlIXBo8zeHeSczRpwJokUK2xS9boukrwqtJJ29sd5y1RCyg0tqvy7hAWbYk1EyqU29fd2Wdin2Di-0zsmIn_ksk9YHIONa0opLl-vMsUCDiXI3mPSg6ce88ZeOOhGpyrdDxgaeIlPD0fKa-5fWku16YJO37Qjy1tswoGRCpzgxQu5QanaLHaZkVmbJa8VHa7v34EAAD__-sAfmI=

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b AS b1, b AS b2 FROM abc EXCEPT SELECT a, b, c FROM abc ORDER by a, b1
----
distribution: local
vectorized: true
·
• except
│ columns: (a, b1, b2)
│ ordering: +a,+b1
│ estimated row count: 1,000 (missing stats)
│
├── • project
│   │ columns: (a, b, b)
│   │ ordering: +a,+b
│   │
│   └── • scan
│         columns: (a, b)
│         ordering: +a,+b
│         estimated row count: 1,000 (missing stats)
│         table: abc@abc_a_b_c_idx
│         spans: FULL SCAN
│
└── • scan
      columns: (a, b, c)
      ordering: +a,+b,-c
      estimated row count: 1,000 (missing stats)
      table: abc@abc_a_b_c_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyck2Fv2jwQgL-_v8K6T63qqNgJfStLk9KWTEKipSNo6jQh5NgHjRZiZhu1U8V_nxLaEaLCRr9h3_HccxffC7ifBQhIHu4HV_07ctLrp-P0y4CSr8noepgmpyRNBsnNmEhKMnKVkoy9_eDk82h4S2SmSPJwk9yPm6mUqG14OOolI3L9rY4woFAajXdygQ7Ed2AwobC0RqFzxlZXL3VCXz-D6FDIy-XKV9cTCspYBPECPvcFgoCxzAocodRozztAQaOXeVFjZaZimampnGZTNc31M1C4McVqUTpRiwCFdCmrUwAUhisvSMxozGnMYbKmYFZ-W9h5OUcQrGHa74HorOnHZNmRspSopu8-P97yY8f49XLn81L5c74r9zqVsJqS1WhRbyYV7tUIWxr8Qxrhv2nwQyZRyyTca7IVWJVmw9-pP6n--beUd9q5RTvHFP1weR7tNjT-tUTxtjtXgwFQKHDmT2J2RmN-RuMwOP1k8_nj7lXrse7vvdvqPTrmK4zQLU3psD2Ddyt1WpUCVk0C9Rw3k3VmZRXeW6Pq3M1xWIPqC43Ob6J8c-iXbyHnLcrFn11rkthBUrifxNokfpAU7ZBYk8TbpPAIEm-SwjYpOkjqHprThMKsME_TXIMANdPdixmGQZeziyDiEQuk6nYDxRiT7PJSs_-rfZ8Vcu6qB5A-mqcaWz1PB2ImC4cUbuUP7KFHu8jLakHVa2S9_u93AAAA___6xvuL

query T
EXPLAIN (DISTSQL,VERBOSE) SELECT a, b AS b1, b AS b2 FROM abc INTERSECT SELECT a, c, b FROM abc ORDER by a, b2
----
distribution: local
vectorized: true
·
• intersect
│ columns: (a, b1, b2)
│ ordering: +a,+b1
│ estimated row count: 1,000 (missing stats)
│
├── • project
│   │ columns: (a, b, b)
│   │ ordering: +a,+b
│   │
│   └── • scan
│         columns: (a, b)
│         ordering: +a,+b
│         estimated row count: 1,000 (missing stats)
│         table: abc@abc_a_b_c_idx
│         spans: FULL SCAN
│
└── • scan
      columns: (a, c, b)
      ordering: +a,+b,-c
      estimated row count: 1,000 (missing stats)
      table: abc@abc_a_b_c_idx
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyck2Fr2zwQgL-_v0Lcp5bK1JaTvlQwcNt4EEibzg5jY4Qgy-fUzLEySaEdJf99yGmbxDTe0m_x6fLcc6fTM5hfFXCIv92ProZ35GQwTCfplxElX-PkepzGpySNR_HNhAhKMnKVkix4_cHI52R8S0QmyfBuEiepS9tmS5f3ljFOBnFCrr83HAYUapXjnVigAf4DAphSWGol0RilXei5SRjmT8B9CmW9XFkXnlKQSiPwZ7ClrRA4TERWYYIiR33uA4UcrSirBisyGYlMzsQsm8lZmT8BhRtVrRa14Y0IJRIopEvhAh5QGK8sJ1FAo5BGDKZrCmplt7WNFXMEHuzIDgfA_TX9mG9wpO8BWdYly1qywTGyg9LYspb2nO2bvlQNnYXOUWP-MraDGmFLg31II_xHja6B9Fom4UGTrcCqVhv-Xv2p--ffUt5p5xb1HFO04-V5b7-hye8l8p3ndDUaAYUKC3sSBWc0Cs9oxLzTT7qcP-yHWvtw-CL6rfZ7x1xEgmapaoPtMbxbyW9V8gI3DMznuBmuUSst8V4r2eRuPscNqAnkaOzmNNx8DOvXI2M1isXbOu-Sgk4SO0zy2yTWSertkYJdEmuTwiNIbJcUtkm9TlK_q7sphaJSj7MyBw7sf19eZEHh9VkmvZ7sh17m-8IT8hIvi-CiCDN3yUUl5sYtQPqgHhus21ADvBCVQQq34icO0KJelLV7o_LlZL3-708AAAD__-BLAgk=
