# LogicTest: 5node

statement ok
CREATE TABLE data (a INT, b INT, c FLOAT, d DECIMAL, PRIMARY KEY (a, b, c, d))

# Split into ten parts.
statement ok
ALTER TABLE data SPLIT AT SELECT i FROM generate_series(1, 9) AS g(i)

# Relocate the ten parts to the five nodes.
statement ok
ALTER TABLE data EXPERIMENTAL_RELOCATE
  SELECT ARRAY[i%5+1], i FROM generate_series(0, 9) AS g(i)

# Verify data placement.
query TTTI colnames,rowsort
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW RANGES FROM TABLE data]
----
start_key  end_key  replicas  lease_holder
NULL       /1       {1}       1
/1         /2       {2}       2
/2         /3       {3}       3
/3         /4       {4}       4
/4         /5       {5}       5
/5         /6       {1}       1
/6         /7       {2}       2
/7         /8       {3}       3
/8         /9       {4}       4
/9         NULL     {5}       5

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslNGKm0AUhu_7FMO5SmBER00261WWNoVAdrONKRQWL6aZgw0Yx86M0BLy7kUtrAm7o2V6qc4_3_9x5JxB_ywggXS1WX3ck1oV5PNu-0heVt-eNw_rJzL5tE736ZfNlPw9ouvThE-7U4IbngGFUgp84ifUkLwAAwohUIiAQgwUZpBRqJQ8oNZSNUfObWAtfkESUDiWVW2a1xmFg1QIyRnM0RQICez59wJ3yAUqPwAKAg0_Fi2mYS8rdTxx9RsopBUvdUI8nxFeCsKIND9QAYVtbRKyZJBdKMjavLK04TlCwi50fJ-HPFeYcyOVP7uuk359nCzZ9F1M-C7m9fa6lEqgQnF1dXaxF2HBvzWJrpqw8QNgYwbgM88PnUYw0KhnPncZQThePBwlHnp-5CQ-0KgnfuciHo0Xj0aJR54fO4kPNOqJL1zE4_Hi8Sjx2PNnTuIDjXri9_9r27yB2aGuZKnxZuu8fXPQbCMUOXarS8taHfBZyUOL6R63ba59IVCb7ivrHtZl96kp2A8zazi8CrPbcGgnD6Ajazq2h2OX3jNreG4nz13Id9bwwk5euJDv7bMKBn4T-092y84uH_4EAAD__x2N4J0=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum((a-1)*1000 + (b-1)*100 + (c::INT-1)*10 + (d-1)) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUVV9r4k4Uff99iuE-Je2EZJLY2jwprT8IqO2qCwslD1Pn4gqacWcS2EX87kuSLSbSTrJkX_TJ--fMuefcwD2C_rGDCJaT6eRxRXK1I_8vnmfkdfLtZTqO58R6iper5ZepTf606HxvFT9OHMJsckOY53k2uSWW9VZL2VVqHUXxfDU8F6q8KBN2xSV4xhOgkEqBc75HDdErMKDgA4UAKIRAYQAJhYOSa9RaqqLlWAJi8RMij8I2PeRZkU4orKVCiI6QbbMdQgQr_rbDBXKByvWAgsCMb3clTcE9OqjtnqtfQGF54KmOiOMywlNBGJHZd1RAYYGpQBWRQvmIOSyqdNk3hfr34NayRn6z9v6_rAVV0OioNYzCsvI0eYxn46kNyYmCzLOzLp3xDULETrS79vFmo3DDM6ncQVP68uvMGrHPafxPac6v56lUAhWKxtPJyTwI8_5ukqAxCeu-bNZl2S5zXP9q1t2ivubyXZ91-91N9juZ7DtucDUmt6ivmXzfx-Sgu8lBJ5MDxw2vxuQW9TWTh31MDrubHHYyOXTcwdWY3KK-ZvLDv7oOH9AsUB9kqvHiSnz8sldcDxQbrE6Nlrla44uS65KmCp9LXJkQqLOqyqogTqtSMWAdzIxgvwFml2DfzNxCHRjRoRkc9pl7YATfmZnv-jDfG8FDM_OwD_ODeVdey2di_sguuZPTf78DAAD__6jVaAU=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), count(a), max(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF2L2kAUhu_7K4ZzFWEkThJdN1fK1oLgx9YoXVjCMnUOVtBMOjOBLeJ_L0lKN8o6CQTvnExen5fnhHMC_fsAIUST2eRpTTJ1IN9Wyzl5nbw8z8bTBXG-TqN19H3WIf9e0dnR4R1KtjJLTPHryN8d3ilzghseA4VEClzwI2oIX4EBBQ8o-EAhAAp9iCmkSm5Ra6nyV05FYCreIexR2CdpZvLHMYWtVAjhCczeHBBCWPOfB1whF6jcHlAQaPj-UGBy9ihV-yNXf4BClPJEh6TrMsITQRiR5hcqoLDMTEhGDOIzBZmZD5Y2fIcQsjNt3me82ynccSOV27-sE23mzoh1gMLTcrNYv62WPyInP87HL8XFLb53k_-BzRKpBCoUF8z4bG_IercqRpv523Sxdkbe_4b-7Yb-RUPWfGKsycRc1nW9VjOraVQxMrjLzLzmRrxGRryu67cyUtOoYuThLkb85kb8Rkb8rhu0MlLTqGJkeBcjQXMjQSMjQdfttzJS06hi5PHum-4T_gp1KhONVxvv83_u5ZsQxQ7Ltallprb4rOS2wJTHZZErHgjUprxl5WGalFd5wWqYWcPeRZhdhz07uQbtW9OBPRy06d23hgd28qAN-cEaHtrJwzbkR_usejWfif0ju2bH5y9_AwAA__9VDgnf

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a+b), count(a+b), max(a+b) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF9r6j4Yx-9_ryI8V8oiNWl1rlfKfh4Q_LNjlTMYZWTmwSNo40lS2EF874e2Y1OZaUG9a5p--_nyeUJ2YP6sIYSoP-w_zkiq1-THdDIiL_3np2FvMCa1_wfRLPo5rJOPT0y6qQlyR97qlCxUmtjP1Ua8fzwX_5DCihgoJEriWGzQQPgCDChwoOADhQAotCCmsNVqgcYonX2yywMD-Q5hk8Iq2aY2ex1TWCiNEO7AruwaIYSZeFvjFIVE7TWBgkQrVusck7G7W73aCP0XKERbkZiQNDxGRCIJI8r-Rg0UpphI1CHpsrsuh3hPQaX2i2isWCKEbE-rt-otlxqXwirttY5LRfNRrcvqQOFxMh_PXqeTX1EtW456z_nGOT4_y__CponSEjXKI2a8dzdkzXMVo_nodTCe1br8s6F_vqF_1JBVnxurMjePNTx-hcmV9Drw0r7J5Hh1L7ySF97w_Ct4Kel14OX-Jl786l78Sl78hhdcwUtJrwMvnZt4Cap7CSp5CRpe6wpeSnodeHm4-Q34DX-KZqsSgyc34fd_bmY3JMolFtepUale4JNWixxTLCd5Ln8h0dhilxWLQVJsZQUPw8wZ5kdhdhrmbnIJ2nemA3c4uKR3yxluu8ntS8j3znDHTe5cQn5wz6pZckzch-yUHe__-xcAAP__UpEVHw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum((a-1)*1000) + sum((b-1)*100) + sum((c::INT-1)*10) + sum(d-1) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMVdFqo0AUfd-vGO6TNiM6atrUJ0ubBSFNu0kWFooP08wlG0g0O6OwS8i_L2pJNDSjbMiSt5l7PJ57zly4W1C_VhDAdDgaPs5ILlfk6-TlmbwNf7yOHqIxMZ6i6Wz6bWSSj08MQ-Vrw-DEIswkN4Q5jmOSHimr77Wqua_OgyAazwYHbA-JqlZKCp7xGCgkqcAxX6OC4A0YUHCBggcUfKDQh5jCRqZzVCqVxSfbkhCJ3xA4FJbJJs-KckxhnkqEYAvZMlshBDDj7yucIBcobQcoCMz4clXKFNrhRi7XXP4BCtMNT1RALJsRngjCSJr9RAkUJpgIlAExQmaxoLJl3hQRfFwoMUK3CdUQrzo28D0c-mX9afgYPT-MIN5RSPPsYEdlfIEQsB3tbvlhsZC44Fkq7X7T8fT7sxEyszBbnNz9yduffPNkE-7JJg7aeZJKgRJFQzje6dtkzr_0eXiZ0O8ZodczQtYLXfO0A6_hgHWfHNZlcmxm2e61z06L6dqj3F5udtzuybudknct27v25FtM15K_u1zyXvfkvU7Je5btX3vyLaZryQ8ul7zfPXm_U_K-ZfevPfkW07Xk7__PpvqkiQmqTZooPNpYn__ZKTYZigVWa0-luZzjq0znpUx1fSl5ZUGgyiqUVZcoqaCiwTqZaclug8yOya5euUXa07J9Pdk_p---lnyrV749R_lOSx7olQfnKN_r38ppGRP9kB1rx7svfwMAAP__dHSRHQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), min(b), max(c), count(d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF2L4jAUhu_3V4Rz1UKkJq0zTq8qsy4U_Ji1yg4MZcg0wRW0cZMUZhH_-9J2YVTGtIu6V_br9X14Tjg70L_WEEIyHA0f56hQa_RtNh2jl-Hz02gQT5DzNU7myfeRi_5-oouNw1yMNqvceSt_2buTuRhlssiNw906z5lhKWDIJRcTthEawhcggIECBh8wBIChBymGrZKZ0Fqq8pNdFYj5O4RdDKt8W5jycYohk0pAuAOzMmsBIczZ21rMBONCeV3AwIVhq3VVU3ZHW7XaMPUbMCRblusQdTyCWM4RQdL8FAowTAsToojgiOLIh3SPQRbmo1EbthQQkj1uTzVYLpVYMiOV1zuGShZjJyIuYBjHEyei1dXg2Yn88upxupjMX2fTH4njniWhZ0k-AIpcKi6U4Eft6d7OSrr_Apssxq_xZO5EwXlW_4iVtJ8laTNLj3Q8eoVpNnAdGLq78TRpe0O0lSHa8fwrGGrgOjB0f2NDfntDfitDfscLrmCogevAUP_GhoL2hoJWhoKO17uCoQauA0MP_3FnfkIyE3orcy1Odufn_9wtd6rgS1EvYC0LlYknJbOqpr6dVrnqARfa1G9JfRPn9asS8DBMrGF6FCanYWpvbqj2renAHg4u4e5Zw3f25rtLmu-t4b69uX9J84N9Vt2GY2I_ZKfd6f7LnwAAAP__aw4e7g==

# AVG is more tricky: we do two aggregations (for the sum and for the count)
# and calculate the average at the end.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT avg(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF2L2kAUhu_7K4ZzleBInEncdXOVZWsh4MfWKBSWUGadQyq4GTuJpUX87yXJwkZZJwHNXb5en9fnDOcA2e8t-BCNJ-OnJdnrLfm2mE_Jy_jH8-QxnBHraxgto-8Tm7x_Iv4klmUJ0iOvNumRte-Hs-WouJR2lZUiFzFQSJXEmXjDDPwXYECBAwUXKHhAYQgxhZ1Wa8wypYtPDmUglH_BH1DYpLt9XjyOKayVRvAPkG_yLYIPS_G6xQUKidoZAAWJudhsS0zBDnZ68yb0P6AQ7USa-aTvMCJSSRhR-S_UQGGBqUTtk8DrWVbAegG3e4H7_l8gPlJQ-_yjQZaLBMFnR9q-5WOSaExErrQzPC0ZraZWwGyg8DRfzZbl9SUkv4j8IO1TpSVqlCeY-GguxQaXWkWr6c-w6MXtuirmBPxiT_ekJ2s_QNZmgA7rO7yDETb0rNm6u9UIeXs1vJUa3nfcDtQ09Kypub-VGre9GreVGrfveB2oaehZUzO6lRqvvRqvlRqv7ww7UNPQs6bmoYud-AlygdlOpRme7cbPf3lQ7EyUCVYLNlN7vcZnrdYlprqdl7nygcQsr96y6iZMq1dFwXqYGcP8JMzOw9xMbkC7xrRnDnvX9B4aw3dm8t015HtjeGQmj64hP5hnNWg4JuZDds6Oj1_-BwAA__-nohS0

# VARIANCE/STDDEV have three local (sqrdiff, sum, and count) and one final stage aggregations.
# We calculate and render the variance/stddev at the end.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), round(stddev(b), 1) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF9r4kwUxu_fTzGcqwgjcSaxtblKqQoBq61JXxZKWKbOwRVsxp2ZLLuI331JUqhKTQLBvcv8efI88zuHswfzcwsBxJPZ5CEhud6S6XLxSF4n355m99GcOOMoTuLnWY98XDH5uyN6lGiVZ9IxVkr85bz1KGG9SiqFFSlQyJTEuXhHA8ErMKDAgYIHFHygMISUwk6rFRqjdHFlXwoi-RuCAYVNtsttsZ1SWCmNEOzBbuwWIYBEvG1xiUKidgdAQaIVm21pU3iHO715F_oPUIh3IjMB6buMiEwSRpT9gRooLHIbkJDRkEN6oKBy-2lnrFgjBOxA20e6X681roVV2h2eJopfHp2Q9Yowz8txNJ06IS9XxX759bB4mSfl96Uo_GKUzwR5prREjfLEPj3Uh2WDS2mn0fx-9j1OxuPJ_07IaejR0C8OlphJ1CW9jx4IOWVBEETzZHT5Dd7JG1j7CrM2FXZZ3-Vda9wQ6gjbzbVrzNvz4a348L7rdeXTEOqIz-21-Xjt-Xit-Hh91-_KpyHUEZ_Rtfn47fn4rfj4fXfYlU9DqCM-d_9yhn4RZYlmpzKDZ7P06z8PihmLco3VQDYq1yt80mpV2lTLRakrNyQaW52yahFl1VER8FjMasX8RMzOxbzeucHaq1X79WK_S-5hrfim3vmmi_NtrXhU7zzq4nxXX6tBQ5vUN9m5d3r4728AAAD__-nHIgQ=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), round(variance(b), 1) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF9r4kAUxd_3Uwz3KcJInEm0Nk8RqxCwsY12WShhmToXV9CMO0mWXcTvviQpVKVOAsG-Zf6cnDO_e7kHSH9vwYPFZDYZL0mut2QazR_J6-TH02wUhMR6CBbLxfOsQ96vpPnOEh1KtMoTaf0ReiOSFVpvHUpYpxJLkYkYKCRKYih2mIL3CgwocKDgAAUXKPQhprDXaoVpqnRx5VAKAvkXvB6FTbLPs2I7prBSGsE7QLbJtggeLMXbFiMUErXdAwoSM7HZljaFt7_Xm53Q_4DCYi-S1CNdmxGRSMKIyn6hBgrzPPOIz6jPIT5SUHn2YZdmYo3gsSNtHmm0Xmtci0xpu3-eaPHyaPmsU4R5jh6C6dTyebkq9suv8fwlXJbf16Lwq1E-EuSJ0hI1yjP7-GgOy3rX0k6DcDT7-X0UBaNwPLF8Tn2H-m5xFGEiUZf83vvA55R5nheEy-H1Vzhnr2DNa8ya1NhmXZu3rXJNqBNwg1tXmTfnwxvx4V3bacunJtQJn7tb83Ga83Ea8XG6ttuWT02oEz7DW_Nxm_NxG_Fxu3a_LZ-aUCd87r9yin4SJcJ0r5IUL6bp53_uFVMW5RqrkZyqXK_wSatVaVMt56Wu3JCYZtUpqxZBUh0VAU_FzCjmZ2J2KeZm5xprx6h2zWK3Te6-UTwwOw_aON8ZxUOz87CN8725Vr2aNjE32aV3fPz2PwAA__9--SNC

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT stddev(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF1r4kAUhu_3VwznKuJInCS2NlcpVSFgbWvSZaGEZeocXMFm3Jlx2UX870sSoSp1EpDcTT5e38fnhLMD_XsNISTj6fghJVu1JpP50yN5G_94nt7HM-KM4iRNXqYdcnhFGyHwj-M4nHTJe4d0ySIM41k6LI6iU8UFNzwDCrkUOOMfqCF8AwYUPKDgA4UAKAwgo7BRcoFaS1W8sisDsfgLYZ_CKt9sTXE7o7CQCiHcgVmZNUIIKX9f4xy5QOX2gYJAw1frsqbojjZq9cHVP6CQbHiuQ9JzGeG5IIxI8wsVUJhjLlCFJAq6jhOxbuR1upF_-C-Q7SnIrfkk0IYvEUK2p80p75dLhUtupHIHp5DJy3wUTyZOxDoF4-vj4fTw9DpLy_MlAO8iwGfvNpdKoEJxUprt7YjsTOQknt1PfybpaDT-7kSMRh6N_Mtg_gkYaz4_1mR-Luu5XgsTrOE80nPTzgS95qK8RqK8nuu3IKqG80jUbTui_Oai_Eai_J4btCCqhvNI1LAdUUFzUUEjUUHPHbQgqobzSNRd-8vzC4A56o3MNZ4t0a9_uV8sVxRLrDaxllu1wGclF2VNdflU5sobArWpnrLqIs6rRwXgcZhZw95JmJ2HPXtzTbVvTQf2cHAN98AavrE331zTfGsND-3Nw2ua7-yz6td8JvaP7Lw723_7HwAA__83FyJy

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT variance(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF1r4kAUhu_3VwznKuJInCS2NlcRqxCwsY12WShhmWYOrmAz7mRcdhH_-5JEqEqdBCR3k48375PnDLOH_PcGfFhMZpPxkuzUhkzj-RN5m_x4no3CiFiP4WK5eJl1yPGVP1yteZaiZVmcdMl7h3RJ6vthtBwWS9GpPiC45glQyKTAiH9gDv4bMKDgAAUXKHhAYQAJha2SKea5VMUr-zIQir_g9ymss-1OF7cTCqlUCP4e9FpvEHxY8vcNxsgFKrsPFARqvt6UNUV3sFXrD67-AYXFlme5T3o2IzwThBGpf6ECCjFmApVPAq9rWQHrBk6nG7jHf4HkQEHu9CdBrvkKwWcH2pxytFopXHEtlT04h1y8xI_hdGoFrFMwvj4dV-P5a7Qs19cAnKsAn727TCqBCsVZaXIwI7ILkdMwGs1-fh_F4SgaT6yA0cChgXsdzT1DY80nyJpM0GY922lhhjWcJ4Lu2pmh01yU00iU07PdFkTVcJ6Ium9HlNtclNtIlNuzvRZE1XCeiBq2I8prLsprJMrr2YMWRNVwnoh6aP_4_AIgxnwrsxwvjtGvv9wvjlcUK6zO4lzuVIrPSqZlTXU5L3PlDYG5rp6y6iLMqkcF4GmYGcPOWZhdhh1zc021a0x75rB3C_fAGL4zN9_d0nxvDA_NzcNbmh_Ms-rXbBPzJrvsTg7f_gcAAP__0qcjsA==

# Test various combinations of aggregation functions and verify that the
# aggregation processors are set up correctly.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(b), sum(c), avg(d), stddev(a), variance(b), sum(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUVt9r4kAQfr-_YpmnBEfibuKvPK1UhYC1rbHloEjZZhdPsIm3ieWO4v9-JPE0ljYJCIJvM5n59vtmv4HNB8S_1-CCP5qMbuZkq9dkPLu7Jc-jn_eTgTclxtDz5_7DxCT7lnj7ZggTiXhfGq8mZnmwz2WaJ1Kq96zlXeiVCAN16DMMQRrk1SQNEriuN5330lCaOacUiVgAQhhJNRVvKgb3GSggMECwAcEBhDYsEDY6ClQcRzpt-cgAnvwDbgthFW62Sfp5gRBEWoH7AckqWStwYS5e12qmhFTaagGCVIlYrTOalJtv9OpN6L-A4G9EGLukaVEiQkkoiZJfSgPCTIVSaZdwp2EYnDY4Mxvc3s-ChFMknCHhNhLuwGKHEG2To6I4EUsFLt1hfdWD5VKrpUgibbVPRfuPtwZnZqo3jew0url7nM73cfbVOUTtQj2L_YfZ0BuP92fsK-ykcjyHmt-Ow74d5zjFNoy0VFrJkxEWu_KBaeuLielB0__ZX7zSmQ8dnTQbe9PB5MWfD4ejJ4N3kVPkvWPhaTDzBtObkcH7yBkWb6BlFjcgs9rKnUbC2xbvIOFdJLyHhPe_vS375LZo_ZWldVbWok2LXWBpK3QXPOxcw9Ky-jawWjawpmVfwIYK3QUbutdgg13fBruWDXbTci5gQ4Xugg29a7DBqW-DU8sGp2m1L2BDhe6CDf1rsKHix2Cm4k0UxurTi_r1ya30pVVyqfJnOY62OlD3Ogoymjy9y3DZB6niJK_SPPHCvJQKLIJpKZidgOlnMCtnrqC2S9FOOdg5R3e7FNwpZ-6cw9wtBffKmXvnMPfLvWpVrEn5kn3mXux-_AsAAP__P0G5-g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), min(b), max(c), count(d), avg(a+b+c::INT+d), stddev(a+b), variance(c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUVl9r-koQfb-fYpmnDY7ETeKf5mmlKgSstsb2FoqUbXbxCpp4N7H0R_G7_9hoUy1tDPRBfHJ3Zo5nzpyB7Duk_y_Bh7A_7F9PyUYvyWAyviFP_cfbYTcYEdoLwml4N7TIviTdrKiwkKwWMX0xv-KNRhaSKNnEGZUWEvE6p5QKUiMvFqmRyPeD0bRjjiabZlKq130ayavQCxFHiu7L8qpdD1JkYgYIcSLVSKxUCv4TMEBwAMEFBA8QmjBDWOskUmmaaFPyngMC-QZ-A2ERrzeZCc8QokQr8N8hW2RLBT5MxctSTZSQStsNQJAqE4tlTmO4-VovVkL_AYRwLeLUJ3WbERFLwkiS_ac0IExULJX2CfdqlHJW445V4-5eMZI8gib7ETQxJHnQhdkWIdlknx2mmZgr8NkWq6vozudazUWWaLt5LCK8v6HcswDhJhhR3sxP3UfKW-Z0Pb4fTZ8n439Daq55MSsS-3N4N-kFgwHlTlHjHNQ4RzVuUeMe1LjWjzqdH3V-ytvEiZZKK3mkbbYtnwRrfDMKVozCKUbx0fNzYHr1CgXNo3g-sEEw6g6fw2mv13-gvI28g_zqM_HQnQTd0XWfctZAzhhyltMUK1L4bhYCCW_avIWEt5Hwzo8jco9GxKovNKuy0Dar284ZVvqEjgMjWxe90k51v5xKfjl12z2DXyd0HPjVvmi_3Op-uZX8cuu2dwa_Tug48Ktz0X551f3yKvnl1e3mGfw6oePAr6uL9uvEU2ai0nUSp-rLp_77f26YJ4CSc7V7L6TJRkfqVidRTrO7jnNcHpAqzXZZtrsE8S5lGjwEs1KwcwRmX8FOOfMJarcU7ZWDvd_03SwFt8qZW79hbpeCO-XMnd8wX5V71TixJuVL9pV7tv3nbwAAAP___t7rIQ==

# Verify that local and final aggregation is correctly shared and de-duplicated.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), stddev(a), avg(a) FILTER (WHERE a > 5), count(b), avg(b), variance(b) FILTER (WHERE b < 8), sum(b) FILTER (WHERE b < 8), stddev(b) FILTER (WHERE b > 2) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzslk1v4jAQhu_7K6w5BckocT74yMmoBG0kCm2g7UpdVBlisUiQsE5S7ariv69MWpJQSKLtgQsn8HjeeT2Tx5LfIPq9BhsmztC5maJErNHAG9-iZ-fH3bDnjpDSdyfTyf2wgd5TomSjsAZGUez7_HX_l70uFdZAA3c4dTykPH13PAcx9DPRNIMjq4HRIkyCWJm_58rfVyZWLFhwZX4snKfCBepIl2RTlZGe41wSR3ojbclnMZsBhiD0-YhteAT2MxDAoAMGAzCYgMGCGYatCBc8ikIhU972Atf_A7aGYRVsk1iGZxgWoeBgv0G8itccbJiy-Zp7nPlcqBpg8HnMVuu9jfSmW7HaMPEXMEy2LIhs1FQJYoGPCArjX1wABo8HPhc2oiQ9vGXbtjuadjCietpz5zjC9SxCZBRmOwxhEmcHjWK25GCTHa7fTG-5FHzJ4lCoVrGXycOtQs2GbOPe67uDwfvqZvwwmn7spDkfn4SS_P7n6Is3fpooB6GVK2cVjKxMrGfZhdhBV8w8UcE4UcE4WcE4O1P97EyzUSZBKHwuuF-Y42xXPnWinRg7kdMYuKPe8GUy7fedR4XqmBJMjdzU038vbja-j1XrkNUuxDtZ2cee5_ZGN45Cu5gSDVNCDiKifbYn0t_AlOx9M34liRhRQ6UmRtTCiLZU2saISk67klXt7FCNwlBJ_VtH6tw6lTRV_XL3rqKdHAGt672ree_0-ojotRDRm6pxOUQq2skh0r4iUhMRoz4iRi1EjKZqXg6RinZyiHSuiNRExKyPiFkLEbOpWpdDpKKdHCLdKyL_8cA7MVOPR9swiPjRQ-90ZU0-ALm_5OlrMQoTseB3IlzsbdLleK_bB3wexekuSRdukG7JA-bFpFSsF8TkWKyXO1dYG6Vqs1xsfuXcVqm4Ve7c-opzu1TcKXfufMW5W_6ttApMyiE79p7tvv0LAAD___LepH8=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(DISTINCT a), variance(a) FILTER (WHERE a > 0) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0k8GOmzwQgO__U1hzSiRHYCC_Kp8SpWyLlGW3QLeVthxcPKJIBFPbrFpFefcKaJVmla6okh49M5_n81izB_O1Bg5puA03Gel0TW6Su1vyGH68366jmMxeR2mWvtvOyc8S0-1mYk6JeCqHXBRvMtIHnoSuRFPgTMzJTbTNwoTMPrwNk5AI8qlzXR-JOx9vl8KKHCg0SmIsdmiAPwIDCh5Q8IFCABSWkFNotSrQGKX7kv0ARPIbcJdC1bSd7cM5hUJpBL4HW9kagUMmPteYoJCoHRcoSLSiqoc2fe9Vq6ud0N-BQtqKxnCycBgRjSSMKPsFNVBIsJGoOVmxUd7lnEdx9oqSFYP8QEF19ihgrCgRODvQP0ge3bpGaYka5YlXfjjzjHVZaiyFVdpZnr4ifX87W3lzoLB-eHP8hzH0sE6idbwJ-4pfX_GCtHcizaZPlk2ZrMMWjnf92XrTNb1Jmt7C8a-v6U_X9Cdp-gsnuL5mMF0zmKQZLJzlv12oM5oJmlY1Bp8t1vmb3X7hUJY4bqdRnS7wXqtiaDMe7wZuCEg0dsyy8RA1Q2oQ_B1mL8L_n8Duc9i7pLN_CRxcAi__Cs4P__0IAAD__9RoCg8=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(a), count(a), stddev(a), variance(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF9ro0AUxd_3Uwz3KYEJZtT0j0-GJgEhTVpNuwsllFnn4gZSJzszll1KvvuiLlRDo4KQp8z1zvEcf7ncD9C_9-BBNF_O7zYkU3uyCNf35GX-42E5DVZkMAuiTfS4HJL_V3T2NuBDSvh7UvzGMktNcdJGCHwvju9c7Xga44APy_cJbvgWKKRS4Iq_oQbvBRhQsIGCAxRcoDCBLYWDkjFqLVV-5aMQBOIPeGMKu_SQmfzxlkIsFYL3AWZn9ggebPjPPYbIBSprDBQEGr7bFza5t39Quzeu_gKF6MBT7ZGRxQhPBWFEml-ogMI6Mx7xGWyPFGRmPr204QmCx460e55pkihMuJHKmtTjRE_3A58NgcLd-mm1qZ5fw_X3aJCX0WM4CxaLonkuj302z2eMLJVKoEJRy7A9Nidm43ORo6f71yAPbdcqJ68WwWq6fI02s9n8eeC71Ge0vFY2nqdhMF3dzWutEFOBKsdOic8s36bEdyjxXUr8ydkvd2pfzrpPBusyGRYbWXav2WhJVCF9dZHZsLsTsjsRskeW04tQS6IKoeuLEHK6E3I6EXJGltuLUEuiCqGbixByuxNyOxFyR9akF6GWRBVCtxffwF_kCVEfZKrxZBN__eZxvqFRJFiucy0zFeODknFhU5brQlc8EKhN2WVlEaRlKw9YFbNGsV0Ts1Ox3ezcYu00qt1msdsn96RRfNXsfNXH-bpRfNPsfNPH-bb5vxq3jEnzkJ16b4_f_gUAAP__cGQ6MQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(b), sum(a), sum(a), avg(b) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF-L2kAUxd_7KYb7pDASZxJ33Txl2VoQ_LM1CoUllFnnkgqasTOT0iJ-95Kk7aqsk0Ds272TnJyT3x3uAcz3LYQQjyajpyXJ9ZZ8Wsyn5GX05XnyOJ6RzsdxvIw_T7rkzysm33VElxLxI-28dum__vy8-ooUViRAIVMSZ2KHBsIXYECBAwUfKARAYQAJhb1WazRG6eKVQykYy58Q9ilssn1ui-OEwlpphPAAdmO3CCEsxesWFygkaq8PFCRasdmWNoV3tNebndC_gEK8F5kJSc9jRGSSMKLsN9RAYZ7bkESMRhySIwWV2zc7Y0WKELIjbR7pMU01psIq7Q3OE8WraSdi3SJMUfGiepqvZsuyvmbOr5q_eeaZ0hI1yjPD5OiOx_r1-eLV9Ou4SOgX3QIzibrERSLuRT6tyr_t1Z_wz36CNR8qazJUj_U83nasNaFOuN3dfqy8ORHeiAjveX5bIjWhTojc356I35yI34iI3_OCtkRqQp0QGd6eSNCcSNCISNDzBm2J1IQ6IfLwf5fhO-YLNHuVGbxYiu9_uV8sS5QpVpvVqFyv8VmrdWlTtfNSVx5INLZ6yqpmnFWPioCnYuYU8zMxuxRzt3ONte9UB25x0Cb3wCm-czvftXG-d4qHbudhG-cH96z6NdfEfckuvZPjh98BAAD__4gfEsY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT avg(c), sum(c), avg(d), sum(d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF-L2kAUxd_7KYb7ZGAkThJdN08R64Lgn61RKCyhTJ1LKmhiZyalRfzuJYmwUdZJILhP8d7M8Zz87nBPoH7vwYdwMpuM1ySTe_KyWs7J2-T762w0XZDO12m4Dr_NLHI5wv_Ena1FicoOxTOvxaUWVqkWXPMIKCSpwAU_oAL_DRhQcICCCxQ8oNCHiMJRpltUKpX5kVMhmIq_4Pco7JJjpvN2RGGbSgT_BHqn9wg-rPnPPa6QC5R2DygI1Hy3L2xy7-Aodwcu_wGF8MgT5ZOuzQhPBGEk1b9QAoVlpn0SuDTwIDpTSDP9bqc0jxF8dqbNI43iWGLMdSrt_nWicDPvBMwCCuPlZrG-_C66TqXrWHeDOHeDvPtnSSoFShRX5tHZHJX17mUNN_Mf00uuS1r3qu_l1QoTgdInAbPHozA_PQpfZsvRemhREjBKAtcOvPxx9-Pcq49jzQfPmgzeZl3baTv6mlAVnoPHjt5pTsdpRMfp2m5bOjWhKnSeHkvHbU7HbUTH7dpeWzo1oSp0ho-l4zWn4zWi43Xtfls6NaEqdJ4_b6l-EGSF6pgmCm-W68f_3MuXLooYyw2t0kxu8VWm28KmLJeFrmgIVLp8y8pimpSv8oBVMTOKnSsxuxU7Zucaa9eo9sxir03uvlE8MDsP2jg_GcVDs_OwjfOzeVa9mmtivmS33tH5y_8AAAD__4dvJK0=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT max(a), min(b) FROM data HAVING min(b) > 2]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslF2L2kAUhu_7K4ZzpTCSzCS67lxFWrcN-LFVKQvbXMyagw3EjJ1MYIv434um3Y2yTgLxMpN587w8J5w95L9TELAcT8afV6TQKXlYzKfkefz0OBmFM9L5Ei5Xy--TLvl3ZStfO7JLyTbJOi_d8nYsjSTfRj_C2df_5z8L1_WQ8AgoZCrGmdxiDuIZGFDgQMEDCj5Q6ENEYafVGvNc6eOV_SkQxq8gXApJtivM8TiisFYaQezBJCZFELCSLykuUMaoHRcoxGhkkp4wx0rBTidbqf8AheVOZrkgPYcRmcWEEWV-oQYK88IIEjAacIgOFFRh3nG5kRsEwQ60eaXRZqNxI43STv-80XT01AlYFyhMw1kn4N2rQH4V-M4pMqVj1BifQaKDvRJz6zpReEhSg1qQgL8NUQgRzlbDq4W9s8Ks-dBYk6E5rOfwtmOrKVVxNLjN2HhzC7yRBd5zvLYWakpVLNzdxoLX3ILXyILXc_y2FmpKVSwMb2PBb27Bb2TB7zn9thZqSlUs3N9-kX0AXGC-U1mOFwvt4y-7x0WH8QbLrZirQq_xUav1CVM-zk-500GMuSnfsvIhzMpXx4LVMLOG-VmYXYa5nVyD9qxp3x722_TuW8MDO3nQhnxnDQ_t5GEb8r19Vm7Nb2L_yS7Z0eHT3wAAAP__Aw8AAw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT DISTINCT (a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lU1r4zwQx-_PpxBzanlkHPklbX3q0nYhkE26SQ4LxQc1Fo0htbySDFtCvvvieEmal2ocZHKUrZ_mb_2G8Qr07yUkMH0aPj3MSKWW5Ptk_IO8PP16Hn4bjMjV42A6m_4cXpN_W-r1YPQwI1f8utmbccNToFDITIz4u9CQvAADCgFQCIFCBBRiSCmUSs6F1lLVW1YbYJD9gaRHIS_KytSPUwpzqQQkKzC5WQpIYMZfl2IieCaU3wMKmTA8X27K1LXvS5W_c_UBFKYlL3RCPJ8RXmSEEWkWQgGFcWUScs8gXVOQldnV0oa_CUjYmrbP85hrkxdz48f7Ye7rjx6rTCiRnai2O-D1gyy4XhzR6XqXKPgy0e4c2dQ6POf_5qAvY7PeWbl3mcIWmariVKqTgUbSk6XP4oOdp2tHe7VZ-45hbTrGZ54fOPUMkmh7-f2L9QzrtGdYJz0TtPcWtPIWeH7o5A1JtL2Am4t5Czr1FnTiLWzvLWzlLfT8yMkbkmh7AbcX8xZ26i3sxFvU3lvUylvk-bGTNyTR9gLuLuYt6tRb1Pm_9US5idClLLRo9efs1YFF9iaaD9SyUnPxrOR8U6ZZjjfc5kEmtGnesmYxKJpXdcDPMDuE2Wc42IPZeXDfBb5zgZlTbhbb6cB636EdDu2y-nZbkZWO7XDsotoOI6rtMKLaDmOqERpR3XdRfWOFb-2ybl1k2WFElh1GZNlhTBZCI7LuXGQxZIpiY9RtjroNUrdJ6jhK3WYpcxqmDJmmESLtaJyeJc1OY9LsNCbNTqPSEByTdjRUrdLS9X9_AwAA__9Q4BZ6

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT SUM (DISTINCT A) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9r4kAUxd_3U4T71LKReCfxX54sbReEtnarCwvFh6kZrGATd2YCW4rffdEsGv_dm5DgozFn7p1zfhzyBebPAkIY3T_c346dVC-cHy_DR-f1_vfzw83gybm6G4zGo58P187_V0z6sXk2eLodO_I6ez2SVk7AhTiJ1JP8UAbCV0BwQYALPrgQgAstmLiw1MlUGZPo9StfG8Eg-gth04V5vEzt-vHEhWmiFYRfYOd2oSCEsXxbqBclI6W9JrgQKSvni82Y9ez-Us8_pP4EF0ZLGZvQaXjoyDhy0Ensu9LgwjC1odNHmKxcSFK7m2WsnCkIceUW3-dubuw8nlqvtb9Mf33poY6UVtGJabsD3j6dd2nej9ST1W4jcXaj3TlJNuvwnO_ZQWfXxmapvXc7-WVcupnNtJpJm2gPD4wa_Xq86uP12TlBgbun8anbn7x4bhPRLLdJa28TLM4pFuHUw4YnKpHKbLSNvH0xUrFWUrEWUhmX8qS2q5AqivMhCvEhGp5fiQ9mo63RnYvxIWrlQ9TCB-NSno9OFT784nz4hfjwG15QiQ9mo63R3Yvx4dfKh18LH4xLeT66VfgIivMRFOIjaHitSnwwG22N7l2Mj6BWPoJa-GBcyvPRq-tL6MScF2WWSWzUwRfR6ZOba2NUNFOZkSZJ9VQ962S6GZP9HG50mweRMjb7F7Mfgzj7a71gXoyHYsyLxZ4Yy4k7VcSIldStSuoerRak4T5tuE-KA3pyQIoFk3WLVLdpcbsKKLSYAYUWc6AwagYURs2A0iEN79KGd6uA0qM7ocmUwlGllGoFWs3VAq1me4GRc8XAyJnA8ahY9n0XjO90szCZI10tGDDDj8qlVOi0mgudVrOhM3IudEbOhU73KjLFikcdUyp0umOQKRk8aplSodNqLnRazYbOyLnQGTkXOt2wgmlYQX-0HYY-WX37FwAA__89ryzV

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT SUM (DISTINCT A), SUM (DISTINCT B) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslFFr2zAUhd_3K8R9WkDBkey0qZ9S2gwCadIlGQyKH9To4hkcy5Nk2Aj578P2SOaQyibeo650dM6nK-4BzM8UQtjMFrOnLSl0Sr6sVy_kbfb9dfE4X5LPz_PNdvN1MSB_j5hiX9Xmy6ctEQPaLLwPar0UVkRAIVMSl2KPBsI3YECBAwUfKARAYQwRhVyrHRqjdHnkUAnm8heEIwpJlhe2LEcUdkojhAewiU0RQtiK9xTXKCRqbwQUJFqRpJVN6T3NdbIX-jdQ2OQiMyEZeoyITBJGlP2BGiisChuSKaNTDtGRgirs2c5YESOE7Ei7R3pOjE2ynfXGzTxuC_6hxfnmIlNaokbZuDg6XgnxGMcaY2GV9tjFu2y-vZwbNWWD8m0aJT74MKXfSMm694Z16Y3Hhh7v252WUKfu3N3eHd6dm3fi5kPP78vdEurEfX87t9-d2-_E7Q-9oC93S6gT9-R27qA7d9CJOxh6477cLaFO3A__ZwpdsVijyVVm8GIaXb95VE4plDHWI82oQu_wVatdZVMvV5WuKkg0tt5l9WKe1VtlwH_FzCnmDTG7FHO3c4u171QHbnHQJ_fYKb5zO9_1cb53iidu50kf5wd3r0Yt38T9yS69o-OnPwEAAP__IcvrKg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT DISTINCT a, b FROM data WHERE (a + b + c::INT) = 27 ORDER BY a,b]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9r2zwUh-_fT3E4VylRcCQ7aWp4wVubskCXdElgGyUXSixaQ2pnkgIrJd992B5J0z-SO7m-lO1H-h09h4MfUf1aY4iz4dXwfA5buYbL6eQr3Ax_XF99Go2hdTGazWffrk7g7yf5ejQ-nwMnsCw_jrnm8P3LcDqEVotDG5Yn0IZVGI7G88EJ_A_sFCbTi-EUPv8ssAUSTLNYjPm9UBjeIEWCDAn6SDBAgj1cENzIbCWUymT-yWMBjOLfGHYJJulmq_PHC4KrTAoMH1Enei0wxDlfrsVU8FhIr4sEY6F5si6OyYNGG5ncc_mABGcbnqoQOh4FnsZAIdN3QiLBy2SthQyh1YootCFieT2R_7SgsFwgwclWhxBREjFc7AhmW33IpjS_FRjSHame_yJROklX2usdhy-PIDiRsZAifv3MwzbLB7jj6u61PRa7QzT2ZrTDVll54vOt2iRi7XKzN2ug3X8o4pDO_5B046yTbTx6fL9vRQiOItDqvUer9J5HOx5rtPssFezN9ZvvPlp799Eau49VV88qqWcdz29UvaWC_bWdNq-e1a6e1ajer67er6Te73hBo-otFeyvbdC8er929X6N6oPq6oNK6oOO12tUvaWC_bWdNa8-qF198EG_G68cOhVqk6VKVPqL6OaxRXwrylJVtpUrcS2zVXFMuZwUXPEgFkqXb2m5GKXlqzzgU5g-h-lTmB3B9H1w3wU-c4GpU27aM9PMeN--GfbNsvpmW4GR7pnhnotqM2xRbYYtqs2wTbWFtqjuu6g-NcIDs6yBiywzbJFlhi2yzLBNloW2yDpzkUUtU9Q2Rt3mqNsgdZukjqPUbZZSp2FKLdM0sEh7MU7fJc1M26SZaZs0M22VZsFt0l4MVaO0xe6_PwEAAP__881r5g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT DISTINCT a, b FROM data WHERE (a + b + c::INT) = 27 ORDER BY b,a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ltFr4koUxt_vX3E4TxZH4kxitYELube1rNDVrgq7S_FhNEMrWONORthS_N8Xzao16pykhjxG882c830_PvKO8a8Z-jhoP7Rvh7DUM7jv977CU_vH48N_nS5U7jqD4eDbwxX8fWX93OneDkEyGCcvh9JI-P6l3W9DpSKhCuMrqMLE9zvdYesK_gXRhF7_rt2H_3_CmIEcIcN5FKqufFUx-k_IkaFAhi4y9JBhA0cMFzqaqDiO9PqV942gE_5Gv85wOl8szfrnEcNJpBX672imZqbQx6Ecz1RfyVBpp44MQ2XkdLa5Zj1osNDTV6nfkOFgIeexDzWHg5yHwCEyL0ojw_vpzCjtQ6UScKhCINb7BO7HhfzkARn2lsaHgLNA4GjFMFqa_Wyxkc8Kfb5i2ee_m8ZmOp8Yp3E4fHIFw54OlVbh6Tv3x4zf4EXGL6fOGK32o4mzo-2PipIb00dVWSCqyWFnd-D1Tyyxn87NY9wg0kZph6d9E1UW8OrZO7xPO7A7-MQw3agWLRxxuP65ERoHI_DsfPMsfDu85ohSCSc22NFxXT7hvHDCeYGEE8ZtCU_7lotwkR0vkQkvUXPcUvEiNthF0ywfL1E4XqJAvAjjtnilfcuFl5sdLzcTXm7N8UrFi9hgF02rfLzcwvFyC8SLMG6LV9q3XHh52fHyMuHl1ZxGqXgRG-yiuSkfL69wvLwC8SKM2-KV9u3Tn38n7uireBHNY5Xpq66-tkaFzyqxM46WeqIedTTZXJM89ja6zQ-hik3yL08eOvPkr_WAH8U8LeYfxeJAzPOJm5eIOb9I3bhIfWNXC6vhrt1w1yr27Dd7VrEgsm5Y1dd28fUloNjFBCh2MQUKoSZAIdQEKE2r4S274a1LQLmxd0KdKIWjSsnVCnY1VQt2NdkLhJwqBkJOBM6PiuXQd0H4bm8WInNurxbuEZcflUuu0O1qKnS7mgydkFOhE3IqdHuvcqJY-VHH5Ard3jGcKBl-1DK5QrerqdDtajJ0Qk6FTsip0O0NK4iGFfaPtnToo9U_fwIAAP__UdBziQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, d, sum(a+c::INT) + avg(b+d) FROM data GROUP BY c, d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUll1vukgUxu_3U0zOlcYxODPgC1d0u92NicWuL8k2jWmoTKyJBXfAzTaN3_0fwNYX2jkYMdE7RH6cM-d5zhM-IPp3ATYM73p3tyOyUgvy56B_T57u_nno3XRdUvmjOxwN_-5VyeaRKSU-JdHqreKRGpnadtcdtaukRrz_ZpUXUiN-NXuF78Ue-WvQHz-Q3x9TbAIUgtCXrvcmI7CfgAEFDhQEUDCBggUTCksVTmUUhSp55CMFuv7_YDcozIPlKk5uTyhMQyXB_oB4Hi8k2DDyXhZyID1fKqMBFHwZe_NFWibpxFmq-Zun3oHCcOkFkU3qBiNe4BNGwvhVKqAwkIEvlU0cVnNEdjBKHF5zTEocQYljwmRNIVzF2zai2JtJsNmaFm_1ZjZTcubFoTKs_U4dQZ1kEDfu47PbHz27416v4ohq7paZ3BqO7ysO-7riydVtf-yO0uv9VrfVX97Jqxe9HhRm1OEwWW9PxH880fZVqyBUvlTS33tZ-hbNmVnju9qHJ2T5Q_Ovo4qvq89BPHeTY1vVPRkT9T6lMxzrR_XEMeq5YT1cGuxAuXzRmsYuZrnDzVrijYMnv69t7dVmxbeKFdkqg9UNfq69Qprd8VjzSvaKlblX7LL3ClFvs1fN8vaKF_c2L-RtXjfEubyNNLujc-tKvM3L9Da_bG8j6m283SrP26K4t0Uhb4u6YZ7L20izOzq3r8Tbokxvi8v2NqLextvt8rxtFve2WcjbZt2wzuVtpNkdnTtX4m2zTG-bl-1tRL2Ntzvn-db_puBARsswiGShL_lGMnzpz2SmVBSu1FQ-qHCalsl-9lMuveHLKM7-ZdmPbpD9lTS4C7NDmO3CfA9mx8GtU2DGTqKtk-iOnubagQv9wIUWNvWVTS3MEa0tLd3Uw81TjKKHEaPoYcwoCI0YBaERo7S0A2_rB94-xSgdfSY0kFDIRcpRqaCnsVjQ02guIDgWDAiOCM5ywbI_d47MXZ8siOZMHy3MRIrnwuUo0fU0JrqeRkVHcEx0BMdE1-cqQ4KV5TLmKNH1GcOQkGG5lDlKdD2Nia6nUdERHBMdwTHR9QnLkYTl-o-2Q9En699-BQAA__-fNQ5q

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, d, sum(a+c::INT) + avg(b+d) FROM data GROUP BY c, d ORDER BY c, d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUl1tv4kgQhd_3V7TqCeRGpi_OxU_OzmRXSIzJApF2NEKRg1skEsFs26x2FOW_r3xJgs2ky6hjKXkzDcenXFXfkXmE9J81-DC7HF9-mZOdXpM_ppNv5Mfl31fji1FIel9Hs_nsr3GfVD9ZUhJTku4eehFxyNL3R-H8rE8cEv276t0Sh8T98hZxlEXkz-nk-or8_r2Qkcn06-X0-dMCKGySWIXRg0rB_wEMKHCgIICCBAoeLChsdbJUaZro_CePhWAU_wf-kML9ZrvL8uMFhWWiFfiPkN1nawU-zKPbtZqqKFbaHQKFWGXR_bqwyesKtvr-IdI_gcJsG21SnwxcRqJNTBhJsjulgcJUbWKlfRIwJxDlY1IScCeQlASCkkDC4olCsstey0izaKXAZ0-0famzRGdKu169ykA4NJDOmxb8GIuL1UqrVZQl2mXDpg8N8mZPdKy0in3yfHARfr8JJ_Ob8Ho87gWif3Ak86PZ9bdewF6ueH71ZXIdzovrevGv9dz-JHdReteohNGAw-Lp9RnFm8_4equkrLt5K4cG3ClvZmpGs-lFCfvNqA7qT84Om8FfWiBerp4bdDPK2-H1azuVr9LzHrmB9-ac5TFzDpNBsnV5Y8SHpo5hd71Oml5VVu_3WyWc1Epg7UlnbUh32cDlXbGOFFuxfmLDOmKxv97ss7LOOmC92fSPzjoy54oo9n6s8_ag8Vag8YErugINKbYC7dQGNMRif7f4ZwWNdwBas-kfHTRkzhVo_P1AE-1BE61AEwNXdgUaUmwF2pkNaIjF_m6Jzwqa6AC0ZtM_OmjInCvQxPuBJtuDJluBJgeu1xVoSLEVaOc2oCEW-7slPytosgPQmk3_6KAhc65Ak938TfyF4VSl22STqlb__ob5NFS8UuUE02Snl-pKJ8vCpvw4KXTFQazSrPyWlR9Gm_KrvMB9MTOKuVnMm2K2LxY1MTtOfG4jZtJKbeXNEW9hbLg0N1waxZ7Z2TOP-sRsfWJUn5rFp0bxmVl8ZrNlZjEyabMY2zJEbeWNbdm5OROGSCiYIwXZM2bOFIaECjvgqy4XiPwAsGPWBVEjM0PU2MJgcjt3bGWYOVyYh_TdHC_YzpjjhSH5wswBw5CEYVYRg6ixqdmFDCa3c0d3xpwzHMkZbpUzHHl3wV5ezDnDkZzhVjmDqLE3ELucweR27tjOcHPOcCRn-HE5s3j67f8AAAD__7vNSwY=

# There should be no "by hash" routers if there is a single stream.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, d, sum(a+c::INT) + avg(b+d) FROM data WHERE a > 9 GROUP BY c, d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkm-Pk0AQxt_7KSbzioa9lD810X21VetJwtEKVL2c5LLHTkgTyuIuGE3T724AE68a0Xs5z8zz8BtmT2i_1Mgx28Sb1zn0poa36fYG7jafdvE6SsB5E2V59j5ewM-RkoFiYPujI8GFkvMoyV8swAX5tXIewAW1mCKU7CR8fLdJNyDhc-95IcFLuE63-x28uh1zCmTYaEWJPJJFfoc-MnyOBcPW6JKs1WaQT-NQpL4h9xgemrbvBrlgWGpDyE_YHbqakGOir3S7DJChok4e6nHszFD33S-T7WRFyMMzexTszwfn8qGmlKQis_Qu4nHYU7TmcJTmOzLMWtlYDkvfu0KGKTWKDAfhuyKc_hUDEbhixUCEDMQK_8bnP4VvXVWGKtlps_Qv8UTIxAoZrpPb-2Sb3yf7OHZEuPhDWg1Str9xhD82P1w7Ilhc7DCgD9zuDHZwgf2Pe6VkW91Y-q-DeeeCIamKpjdhdW9K2hldjp-Zyu3oGwVFtpu64VREzdQaAB-b_VlzMG8OZs3eb-bi_OxHAAAA___dMg9r

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), sum(b), sum(c) FROM data GROUP BY d HAVING sum(a+b) > 10]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUll1r4kAUhu_3VwznSulIcjKJbXMVt7Vdwcau2mVLV0o0gxVs4k4S2FL870uSUj-6O5MyCnqVzydz5jwvh7xC8nsOLgza3fbFkGRiTq76vRvy0P552211fFK77AyGg-_dOnl7Jcmea0GdFsfx23FSL6kwSANy3e_d3ZKv9yQk31o_Ov51iZATMq6TX5lpMk7QHAGFKA65HzzzBNwHQKBgAQUGFGyg4MCIwkLEE54kschfeS2ATvgHXJPCLFpkaX57RGESCw7uK6SzdM7BhWEwnvM-D0IuDBMohDwNZvNimbxEbyFmz4F4AQqDRRAlLmkYSIIoJEji9IkLoNDnUciFSzw88SxKPKSkODJKPBtGSwpxlq4qSNJgysHFJa1eZWs6FXwapLEwnM0ivfy65d8_-r3ho3_X7dY8p55Xe3dT86z3M_Z-Zr-fYX2ruNV64xfyFCRPW0shjJarDVj_3cDqO1kUi5ALHm58qfiKZItoflh4e49YcY9FL65m87QQ5KxC5bruZfuic9PqAoVelrq5M49RiTG22w37cSNeGOhsvfnvte2NtbF6prFKpg1sGNYeUq2oc0158zBTjbtMNR5Bqq3qybIqJctqGGwPyVLUudb208NMlrXLZFlHkCxWPVmsUrJYw7D3kCxFnWttPzvMZLFdJosdQbLs6smyKyXLbhjOHpKlqHOt7eeHmSx7l8myjyBZir_yPk8WcZTwSn9wZt4QHk552b0kzsSE34p4UixTXvYKrrgR8iQtn2J50YnKR3mB6zBuw7gOWxswfg5u6sDnOjBq1Y2OnLak_WZymMllNeW2bCntyGFHR7UcVqiWwwrVclilWkErVDd1VJ9K4TO5rDMdWXJYIUsOK2TJYZUsBa2Qda4jCxVTVDVG9eao3iDVm6Sao1RvlqLWMEXFNLUV0j6M009Jk9MqaXJaJU1OK6UpcJW0D0NVKm20_PI3AAD__zpJ4gQ=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT avg(a+b), c FROM data GROUP BY c, d HAVING c = d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll9r2zAUxd_3KcR9SqiCI8lJW0PBWdd2gdTp8meslFBUW6SB1MpkZ6yUfPdhpyxOskkuSsBvtqyf7rk6h4vfIPk5Bw-GV72ryxFaqjm6HvRv0cPVj7tepxug2pfucDT81quj9y3817TG0Ql6qmMUrjdHPOXoZtAf36HP9yjEKEJfO9-7wQ0K0QWKJoAhlpEI-ItIwHsAAhgoYGCAwQUMLZhgWCgZiiSRKtvylgPd6Dd4TQyzeLFMs-UJhlAqAd4bpLN0LsCDEX-ai4HgkVBOEzBEIuWzeV4mk-Uv1OyFq1fAMFzwOPFQwyGIxxEiSKbPQgGG69k8FcpDPkMXyM8EDUQc5SvkxKcY-Qxn65MVBrlMN1qSlE8FeGSFy-vtTKdKTHkqldPalutn19EJ7h-D_ugxGPd6NZ_VM93j25pPsqfL_jgYvT9vb6T1HXWbgk-v6Jknzzu1CExWmw7ofzvYnLOMpYqEEtHWSfkpmh5Jc6_wrnbyt0n6_vTYzdpk-2269aI51DEYww7bViAbcuGQ1s7Of9d2t2qT8iEmZULskIZDjxpjg-KCxe2KxpgcMsakMjGm5aNES0WJNhx21CgZFBeu-bSiUaKHjBKtTJRY-SixUlFiDcc9apQMigvXfFbRKLFDRolVJkpu-Si5paLkNpzWUaNkUFy45vOKRsk9ZJTcykTJ8AM9EMlCxoko9RfWzNoW0VSs7yiRSxWKOyXDvMz6tZ9z-UIkknT9laxfuvH6UyawCJNdmBRhugWTj8FtG_jcBiZWuklLT1PtfTM9zPRmtfVuuVq6pYdbNlbrYYPVethgtR42WW2gDVa3baw-1cJnerPObMzSwwaz9LDBLD1sMstAG8w6tzGLGKaoaYzazVG7QWo3SS1Hqd0sJVbDlBimqWswbW-cfsg0PW0yTU-bTNPTRtMMuMm0vaGqNW2y-vQnAAD__4ub1j4=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a+b), sum(a+b) FILTER (WHERE a < d), sum(a+b) FILTER (WHERE a = c) FROM data GROUP BY d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMltFv2joUxt_vX2GdJ1CNgu2EtpEqpfdeuiFR6ALVVnWocolFkWjMnERaVfG_T0m2EmhnpzKovJngX853zvfpKM-Q_FiAD6Nuv_vfGGVqgS7C4SW67X676p_3Bqjxf280Hn3pN9HvK0n22ODoCN03ceWMLnr9cTdEja-fu2EXcfQ9a7fZFEX6W2do2iwLRjzl6FM4vL5C_96gaAIYYhmJAX8UCfi3QAADBQwMMLiAwYMJhqWSU5EkUuVXngugF_0Ev41hHi-zNH88wTCVSoD_DOk8XQjwYczvFyIUPBLKaQOGSKR8vijK5DKCpZo_cvUEGEZLHic-ajkE8ThCBMn0QSjAEIo4EspHATkKKEYBKfsN3Px8FjCMAhcmKwwyS9dCkpTPBPhkheuLPZ_NlJjxVCrH29Qa5HM4H9zcDYbju8F1v98I3GYu-vqyEZDK6c_YA_rGM7Ylc135_gk98ORhqyiByWrdCv1rK-v3ZLFUkVAi2nhT8RZNs6T9qvB2t-se6cuJvZyKWQyz1EcBxQHDGkPYbrsYyJZcOsTbuvl2bXejNqmfXFInuQ5pOXR_2TXIrdjZOfTskl1ml3xUdmn9_NBa-aEth-0vPwa5lZEeH3p-6C7zQz8qP6x-flit_LCW4-4vPwa5lZGeHHp-2C7zwz4qP279_Li18uO2HG9_-THIrYz09NDz4-4yP-4hfHu9oTEUyVLGiaj1ZdXOuxTRTJQjSWSmpuJKyWlRpvw5LLjiQSSStPyXlD96cflXLrAKk22YVGG6AZP3wR0b-NQGJla6iaenqXbeTA8zvVkdvVuulvb0sGdjtR42WK2HDVbrYZPVBtpgdcfG6mMtfKI368TGLD1sMEsPG8zSwyazDLTBrFMbs4hhi5rWqN0etVukdpvUcpXa7VJitUyJYZu6BtNerdN3maanTabpaZNpetpomgE3mfZqqWpNm6z--RUAAP__UpvLjA==

# Same query but restricted to a single range; no local aggregation stage.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a+b), sum(a+b) FILTER (WHERE a < d), sum(a+b) FILTER (WHERE a = c) FROM data WHERE a = 1 GROUP BY d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUktGLm0AQxt_7VwzzlHB7xNU8CQd7bb1W8DQ1hva4yrHnDhIwrt1doSXkfy9qyyWlte3b7LffN_PT2SPaLw2GuI2S6E0BvWngLs_u4TH6tElu4xQWb-Ntsf2QLOGHxfaHhYQreF6ysxru4qSIclh8fB_lEUj43HteUIGad91AtZwGKukkvMgc3uXZbgOvH0CVyLDVilJ5IIvhI3Jk6GPJsDO6Imu1GeTjaIrVVww9hvu2690glwwrbQjDI7q9awhDTPW17lY-MlTk5L4ZbSeGuncvIetkTRgGJ3bWmM83LuRzQzlJRWblXbTH4ftEZ_YHab4hw20nWxvCil-PHDm1ikwIgl8Jn4Hg0-8T66G-EQEDscY_IfL_Qbyta0O1dNqs-CWhWCPD2_ThKc2Kp3SXJAuxXg6ou_uF4GfVzy0K_zdagAyz3oUgfCYCNoPtX2D_ZWU52U63lv5pZ96pZEiqpulZWN2bijZGV-OY6ZiNuVFQZN10G0yHuJ2uBsDzMJ8N-_Nhfzbs_RIuT6--BwAA__8QIBmb

# Verify the XOR execution plan
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT xor_agg(to_hex(a)::bytes) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslF1v2jAUhu_3K6xzVSSj4CRQ6quyjVVIrHTARacqQh4-SpFonNmOxIT471OSTg2odTIll_l487x5jnWOYH7vgcNqOp9-WZNM78m35eI7eZo-Pswns3ty9XW2Wq9-zHvk9ZWD0hsRx1dWbZ7xcCV6nH_-uZ6uemVQCisioJAoiffiBQ3wJ2BAwQcKAVAIgcIQIgqpVls0Run8lWMRmMkD8AGFXZJmNr8dUdgqjcCPYHd2j8BhLX7tcYlCovYGQEGiFbt9gcnZt6nevQj9ByisUpEYTvoeIyKRhBFln1EDhSUmEjUnr79wy_79A0QnCiqzb3RjRYzA2Yk2bziJY42xsEp7w_OCj4vlZnJ3lxM_RPkfot4IWaK0RI3y7PPRyV2GDf6_TXDWhjUfDWsyGo_1Pb_j4dR0rPgYtR2O31yH30iH3_eCjnXUdKzouG6rI2iuI2ikI-h7Ycc6ajpWdIzb6gib6wgb6Qj73rBjHTUdKzpuutxk76CWaFKVGLzYaO9_eZBvOpQxlmvRqExv8UGrbYEpLxdFrrgh0djyKSsvZkn5KC9YDTNn2D8Ls8uw7ybXoANnOnSHwza9h87wyE0etSFfO8NjN3nchnzjntWg5pi4D9klOzp9-hsAAP__3OgMJA==

# Verify the XOR execution plan
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT xor_agg(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslNFq2zAUhu_3FOJcJSBjy3bS1FcJW1YCWdMluSgUU7To4AVcy5Nk6Ah592F7UCe0sod2aVu_v__jiHMC_SuHBHbL9fLznlQqJ1-3m2_kafn4sF6s7snoy2q3331fj8nfI69SPfMsG_Fxe1Jww1OgUEiB9_wFNSRPwIBCCBQioBADhQmkFEolD6i1VPWRUxNYiVdIAgrHoqxM_TqlcJAKITmBOZocIYE9_5HjFrlA5QdAQaDhx7zB1Ox5qY4vXP0GCruSFzohns8ILwRhRJqfqIDCpjIJmTNIzxRkZd5Y2vAMIWFnOrzPIssUZtxI5U8u6zxuts-Lu7vRnI0_RIUfot4IVSGVQIXi4vfp2V6GBf_eJrpow4YPgg0ZhM88P3QaRU-jjv3UdRThcPlwkHzo-ZGTfE-jjvyNq3w0XD4aJB95fuwk39OoIz9zlY-Hy8eD5GPPnzjJ9zTqyN_-zw30DmqLupSFxqtN9P6fg3pDociwXWdaVuqAD0oeGkz7uGlyzQuB2rRfWfuwKtpPdcFumFnD4UWYXYdDO7kHHVnTsT0cu_SeWMNTO3nqQr6xhmd28syFfGufVdBzTeyX7Jqdnj_9CQAA__-PNOlb

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT max(t.a), min(t.b), avg(t.c)  FROM (VALUES (1, 2, 3), (4, 5, 6), (7, 8, 0)) AS t(a, b, c) WHERE b > 3]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkF1r2zAUhu_3Kw7nSoJDajv7KLqK2dzNkKRdnHWFzheKfTAGxcokuRSC__uwPbZ10LHena_nfYTO6L8bVFhk6-z9Hnpn4Gp3vYH77O5mneZbEB_yYl98Xkv4eXLUjyIstCQ4tp0Ii4Mk0A-NCItKzqy4TddfsgJETJAQLCWBeE3whuDtWL4juCSIpIS0gABCExwIKglfP2W7DA7wrY-iJcOyRMLO1rzVR_ao7jHGkvDkbMXeWzeOztNBXj-iigjb7tSHcVwSVtYxqjOGNhhGhcZW2sCDNj17iC4iJKw56NZMyVetCewUrJJfdqVUvt1fYjkQ2j78TvZBN4wqHuj_7WnTOG50sO4ifmrepHdiFUsk3ORbsUrGKr39KFZL-aw6eYl6x_5kO89PtM8lR0NJyHXD8-d627uKb5ytJs3cXk_cNKjZh3kbz03ezavxgX_C8T_h5C-4HF79CAAA__8-tMoV

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT * FROM (VALUES (1, '222'), (2, '444')) t1(a,b) JOIN (VALUES (1, 100.0), (3, 32.0)) t2(a,b) ON t1.a = t2.a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyckU9r20AQxe_9FMNcLJXB3l35JAjItC51cK00Sksh-LCVpo5gq3V3V6Vg_N2LVin5Q9PGuWlm3m-e5u0B_Q-DOVbL9fLNFfTOwLvL8gNcL79crBerDSRvV9VV9XGdwq3k9ShIPi_Wn5YVJJJgopSapASJIpjM5_NJmsKigiAh0QRfUzgvh033CCnEVAxERpCpqbgF1B-g3ECQUw1nENRUb5Gwsw1v9Hf2mF-jxC3h3tmavbduaB2iYNX8wlwQtt2-D0N7S1hbx5gfMLTBMOZobK0N_NSmZw9iJpCw4aBbE_VHQtuHO9oHvWPM5ZFe6CBn8lkO6kmHu8V9Z13DjpvHG_8v-ctvvtf-5ty2HbuZeqBGw99CUsj0zLW7m_iFhGUfcigkFYqKjIo5PnVJdkpWl-z3tvP8rIzEcAY3Ox5j8bZ3NV84W0ebsSwjFxsN-zBO1VisujiKj3kflifA6jGs_glnD2Bx3B5f_Q4AAP__go0S1Q==

statement ok
CREATE TABLE nullables (a INT, b INT, c INT, PRIMARY KEY (a))

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT array_agg(a) FROM (SELECT a FROM data WHERE b = 1 AND c = 1.0 AND d = 1.0 ORDER BY a)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlNFr2zAQxt_3V4h7spkyR7YzimBgr3E6Q5p0TmArxRQ1OryAa2WSAish__uwna7zWDaXvOTNn-4-3_e7h9uB-V4Ch0UyTS6XZKtLMsnm1-Qu-XozjdMZccbpYrn4PHXJoUVoLZ7uRVE4wm17nedKK6Wwgnz5lGQJcZwH8oEwl8SzMXFW9fe7oXuQ8iDJPBsnGfl4S4SbA4VKSZyJRzTA74ABBR8oBEAhBAojyClstFqhMUrXLbvGkMofwIcU1tVma-vnnMJKaQS-A7u2JQKHpXgoMUMhUXtDoCDRinXZjKkzRxu9fhT6CSgsNqIynAw8RkQlCSPKfkMNFCbr0qLmxHEiv47POU9ny4sDURS0SJzzyXQeLy-eUaPwV2GcXKbX8dQFCvOt5SRikO8pqK19CW6sKBA429MjcC9MSkvUKLs0EXsL-f4vG4iLQmMhrNLeqGuJsyy-vY-vrpyIuUcT-Z1ErP-6WZ91e2zg-eezcL8_nt8Lzx94wfngBf3xgl54wcALzwcv7I8X9sILB97ofPD-c-oyNBtVGeyQHfvzsD4VKAtsT4tRW73CG61WzZhWzhtf8yDR2LbKWpFWTakJ-LuZ_dP8vmMe_mn2T5kcnGIOTzGPXmXO929-BgAA__9NfD8a

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT json_agg(a) FROM (SELECT a FROM data WHERE b = 1 AND c = 1.0 AND d = 1.0 ORDER BY a)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlNGL00AQxt_9K5Z5SnBrukkqx4KQeM2dkV5zpgWVIxx73SFWctm6uwWl9H-XJNUzYjXSl77l25kv8_3mYXZgvlTAYZHMkssl2eqKXOXZDblLPtzO4nROnGm6WC7ezVxyaPlsVH0vytIRbtfqHAqik1JYQd6_SfKEOM4DeUWYS-L5lDir5vvF2D1IeZAky6dJTl5_JMItgEKtJM7FIxrgd8CAgg8UAqAQAoUJFBQ2Wq3QGKWbll1rSOVX4GMK63qztc1zQWGlNALfgV3bCoHDUjxUmKOQqL0xUJBoxbpqxzSZo41ePwr9DSgsNqI2nIw8RkQtCSPKfkINFK7WlUXNieNEfhOfc57OlxcHoijokDjnV7MsXl78QI3Cn4VpcpnexDMXKGRby0nEoNhTUFv7FNxYUSJwtqdH4J6YlJaoUfZpIvYciv0fNhCXpcZSWKW9Sd_ydpHN7-Praydi7tFAfi8QG75tNmTbHht5_vns2x-O5w_C80decD54wXC8YBBeMPLC88ELh-OFg_DCkTc5H7x_XLoczUbVBntkx_48bi4FyhK7y2LUVq_wVqtVO6aTWetrHyQa21VZJ9K6LbUBfzWzv5pf9szj383-KZODU8zhKebJf5mL_bPvAQAA__9O9z5w

# Test that orderings on GROUP BY columns are propagated through aggregations.
statement ok
CREATE TABLE sorted_data (a INT PRIMARY KEY, b INT, c FLOAT, INDEX foo(b))

# Split into ten parts.
statement ok
ALTER TABLE sorted_data SPLIT AT SELECT i FROM generate_series(1, 9) AS g(i)

# Relocate the ten parts to the five nodes.
statement ok
ALTER TABLE sorted_data EXPERIMENTAL_RELOCATE
  SELECT ARRAY[i%5+1], i FROM generate_series(0, 9) AS g(i)

# Verify data placement.
query TTTI colnames,rowsort
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW RANGES FROM TABLE sorted_data]
----
start_key  end_key  replicas  lease_holder
NULL       /1       {1}       1
/1         /2       {2}       2
/2         /3       {3}       3
/3         /4       {4}       4
/4         /5       {5}       5
/5         /6       {1}       1
/6         /7       {2}       2
/7         /8       {3}       3
/8         /9       {4}       4
/9         NULL     {5}       5

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT a, max(b) FROM sorted_data GROUP BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkVGrm0AQhd_7K5Z5UtgQNfRln7RtWgSjqRpICBI27lQCxrW7KwSC_72ohSaFeO99nJnzzTk7ewf9uwYG2Tpaf81Jp2ryPU025Ljeb6MgjIn1Lczy7Gdkk78STsmV36yzPQm1VAbFSXDDyY802W3JlwPhBVBopMCYX1EDO4ILFD5DQaFVskStpRra91EUihswh8KlaTsztAsKpVQI7A7mYmoEBrFcyHbpAQWBhl_qUdZTkJ35B2nDKwS26unDYnd-cc7PNabIBaql87QeHp7m_5ISKGQtbzQjC6CQdIYR36W-B69yuB_JEVSVwoobqZbucwx_qIP4cIqT_BTvosjyXRsobIK95Xv2S3vvyf6N-6aoW9lofNeBnb6ggKLC6Q-17FSJWyXL0WYqk5EbGwK1maarqQibaTQEfITdWdibh71Z2PkPLvpPfwIAAP__vNH0cA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT a, max(b) FROM sorted_data GROUP BY a ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlmFr4jAYx9_fpwjPK-UiNWl1W1_p3bxDcHanDjaGjMwGJzjTSyJsDL_70fbAut2SltTDd9rml-ef_B4e-gbq9xpCmA5Gg-8ztJVr9GMSXaH7we31qD8co8blcDqb_ho10d8lDKNn9tJ4bOYLlZCaxw8x0wz9nEQ31-jbHWIomlwOJtnPOWDYiJiP2TNXEN4DAQwUMPiAIQAMHZhjSKRYcKWETJe8ZcAwfoGwjWG1SbY6fTzHsBCSQ_gGeqXXHEKYscc1n3AWc-m1AUPMNVutszKFYL1Erp6ZfAUM04RtVIhaHkFsEyOChH7iEjBEWx2iHsE9CvMdBrHV-6pKsyWHkOxw-WT95VLyJdNCep3DYL30AiIZc8njtCRg6I_vHsbR7GF8Mxo1eqQJGK76t40ebb4Ls9__8RU9MfX0Yev5bh-Yfhp4v4_Ig7zf52u-keFUpF3fsfaR_dojj0VLJB45lPBZ-eCgPCnffKRC83mk5VHX9rNkK4jqnkb7kZrbjxy__Wh5_7SKf9ryfFf_lmyFmzo7Df-0Zv_0-P798v79Kv79lhe4-rdkK9zU-Wn492v27x_ff1Def1DFf9DyOq7-LdkKN3VxGv6Dmv0H__fz4x9pJlwlYqN4qS-LdnoeHi95fn4ltnLBr6VYZGXyv1HGZQ9irnT-luR_hpv8VRqwCJP3MCnC9AAm1eCuC3zhAhOn3KRjpqnxvn0z7Jtldc22AiPdMcMdF9Vm2KLaDFtUm2GbagttUd11UX1mhM_Nss5dZJlhiywzbJFlhm2yLLRF1oWLLGKZorYx6jZH3Qap2yR1HKVus5Q4DVNimaaBRdqHcVpJmpm2STPTNmlm2irNgtukfRiqRmnz3Zc_AQAA__9D8H8M

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, min(b), a FROM sorted_data GROUP BY a, c]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlt9v2jAQx9_3V1j3BJpRcH7QNk90Wzch0dABlVZVqHKJRZFozGwjrar43yeSSaTAfAHzkMcQf3J3_n504h307wXEMLrp33wdk5VakO_DwS15vPl117_uJaTxrTcaj372m-TfkSklr_Os8dykhBdntVRGpE8pN5z8GA7u78iXB8IpmU6AQiZTkfBXoSF-BAYUfKAQAIUQKEQwobBUciq0lmpz5D0HeukfiNsU5tlyZTY_TyhMpRIQv4OZm4WAGMb8eSGGgqdCeW2gkArD54u8TKmh7lLNX7l6AwqjJc90TFoeIzxLCSPSvAgFkzUFuTLbQtrwmYCYrWn1Zq5nMyVm3EjlRR976W5mHqhUKJHGJH-6Th6eksH4Kbnv9xtd1gQKt72k0fWbey-D5k5_25LPb-SF65e9apP1dgb_vzNsvyOL3na_87n4kGVQ1j7zpBQGKxOTbkC7Ps0nOZxMUGGqVXZoroMjJbIllx6Ldk4erh1-qM2qK8qOUNRjLc8_QVKknVJ2ndpKys4sKauFpH51UfxjRPFbXnCCKEg7pfu7qK0o_plF8WshSlBdlOAYUYKWF54gCtJO6f4uaytKcGZRglqIElYXJTxGlLDlRSeIgrRTur-r2ooSnlmUsBaiIP9ch0IvZaZFpX8_7c3IIp2J4oq0XKmpuFNympcpHgc5l_-QCm2Kt6x46GXFq02DZZjtwqwM-x9gdhzccYGvXGDm1DeL7LRvve_ADgf2sDr2tEIrHdnhyCVqO4xEbYeRqO0wFjVCI1F3XKK-sMKX9rAuXcKyw0hYdhgJyw5jYSE0EtaVS1gM2aLYGnXbo26L1G2TOq5St13KnJYpQ7ZpiIS2t06PCs1OY6HZaSw0O42GhuBYaHtL1RraZP3pbwAAAP__Cjuy1g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, min(b), a FROM sorted_data GROUP BY a, c ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMllFr4kwUhu-_XzGcK-UbiZOJts2V3a27CDbpqoUtRcrUDFawGXcywpbif19MFox1O8c4XuRyTJ6cc-Z5OfgO2a8lhDDuD_tfJ2Stl-TbKL4lj_2fd8PrQUQaN4PxZPxj2CR_X5lR8rpIG89NSkTxbqa0kclTIowg30fx_R358kAEJTMSj276o_w0BQqpSmQkXmUG4SMwoOADBQ4UAqDQgSmFlVYzmWVKb195z4FB8hvCNoVFulqb7c9TCjOlJYTvYBZmKSGEiXheypEUidReGygk0ojFMi9T6q230otXod-Awngl0iwkLY8RkSaEEWVepIbphoJam12hzIi5hJBt6PHNXM_nWs6FUdrr7PfS284c60RqmYQkP11HD09RPHmK7ofDRo81gcLtIGr0_ObBQ9780N-u5PMbeRHZy0G16WY3g__pDLvvqKK3j9_5v_iQZVDWPvOkFOK1CUmP055P80n-bYafPBX_ZKpItdTKY_vqPisf7JVnx6eUVUipx1qef0JOkXZK-rq1zSk7c05ZLXLqHx8Uv0pQ_JbHTwgK0k7p_i5qGxT_zEHxaxEUfnxQeJWg8JYXnBAUpJ3S_V3WNij8zEHhtQhKcHxQgipBCVpe54SgIO2U7u-qtkEJzhyUoBZBQf68jmS2Umkmj_r3096OLJO5LK4oU2s9k3dazfIyxTHOufyHRGameMqKwyAtHm0bLMPsI8zKsL8Hs2pw1wW-coGZU9-sY6d9631zO8ztsrp2W4GV7tjhjotqO4yotsOIajuMqUZoRHXXRfWFFb60y7p0kWWHEVl2GJFlhzFZCI3IunKRxZAtiq1Rtz3qtkjdNqnjKnXbpcxpmTJkmwaItIN1Wkmancak2WlMmp1GpSE4Ju1gqVqlTTf__QkAAP__XeS1rQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT b, max(c) FROM sorted_data@foo GROUP BY b]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUktFq2zAUhu_3FOK_SkAlsd3d6MrZlo0M186SFFqKCYp1ZgyO5UkydIS8-7BdtqZgr7nU0fnO_4mjE-yvEgLbZbT8vGONKdnXTXLHnpYP62ixitnky2q72_6Ipuyl5cDZUT5PsmnfaLVxpPZKOhn-1Jp92yT3a_bpkR1ScFRaUSyPZCGe4IHjI1KO2uiMrNWmLZ-6ppV6hphzFFXduLaccmTaEMQJrnAlQSDWN7qeBeBQ5GRRdm1nDt24f5B1MieI2zN_NdgbH7yTh5I2JBWZ2fxiPN48DxzbWlZWsBtwJI0TLPQwJOFdI_FdF9WLgzfsUJviKM3vv-E-D4PBfP-a_EWeG8ql02bmX-aHrU9iFBlS3Xs5FvHjPk52-_g-iiahNwXH3eJhEvrTQZngQuY_q96QrXVl6V27np9TDlI59d_J6sZktDY662L6Y9JxXUGRdf3tbX9YVf1VK_ga9kZhfxz2R-FgHA5G4fkbOD1_-BMAAP__ogc4Fg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT * FROM (SELECT a, max(c) FROM sorted_data GROUP BY a) JOIN (SELECT b, min(c) FROM sorted_data@foo GROUP BY b) ON a = b]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMl1Fv4jgQx9_vU1jzBLdGwU6gFGml9O56J1YUem1X2tUKVYa4FInGnBOkXVX97qeQnggEPHFNb_O2BP_sGfL779TPkPyzhD7cXg4vf78ja70kf96Mr8i3yy_Xw4vBiDT-GNze3f49bJLXJb_mCxqvHwUlT-J7Y9bMHydKpzK6j0QqyF8348_X5LevRDTJp3G21yszpeRpER9iwgeltty0ScYjIshHMp0AhVhFciSeZAL9b8CAAgcKPlAIgEIHJhRWWs1kkiidLXneAIPoO_TbFBbxap1mjycUZkpL6D9DukiXEvpwJ6ZLeSNFJLXXBgqRTMViuTmmWNtKL56E_gEUblciTvqk5TEi4ogwotJHqYHCeJ32Scho6MPkhYJap9tTk1TMJfTZC61e2cV8ruVcpEp7nd3CwuwHGOtIahllRwKFi9HX-9H47n70eThshKwJFK4uvjRC3twrZrv_9Ad5FMljaevJy7ZgfrTg7T4qL2R_nw_5RoauWPtnteW7tUW3q9bxoXUHO7-Sei4_qUUstcd6u_su5UPaCNmH5ke9mD_m_ywqxWno0zA4KtZZhYYsSh2pllp53N9befjs3s7ZrHrcmEXcPNbyuGvgkNoKanbrETh24sCxegTOuq0TBO78PQPHq0vPbaTnLc93lR6praDHWT2k5yeWntdDeuu23KXn7feU3q8uvW8jvd_yAlfpkdoKevTqIb1_Yun9ekhv3dYJpGfvKX1QXfrARvqg5XVcpUdqK-hxXg_pgxNLH9RDegtHWOe4JA9KFa6bWyGO2hDYVJGl5b8iulVMzU_nJh07b9SRve0vj8HI-cV13Xw8wf9W_P-6CB4o5EYmKxUnstI1r521IqO5zH-dRK31TF5rNdsck38cb7jNg0gmaf4tyz8M4vyrrMAizPZhVoT5Dszs4DMXmDEnuuNEn5tpbqR9F7jnAjPkdSF014XmSNu-UdLADAdGmAdmxTtGumuGuy75MMNIPswwlg-ERvKB0Eg-zlzyYYaRfJhhLB8IjeTDTGP56Lnk49w8AdrICCgNEKsZYKaxIWCm0SmA4NgYQHDEc2YeI8gbR2jEdITGVMdwxHUEx2RnpVliYzszzxKGjANWmiZWuptpTHczjeqO4JjuCI7pXhqkVrqbaUx3M43qjuCY7mYc1b00Tq10Lw2WXd17iO6lyWKlu5nGdDfTqO4IjumO4JjupalqpbuZxnQ306juCI7pbsYx3bn5QsqRGykvzZZdnCO4ze2MW9I9J3rvtVnjXSecY63bXdEmL7_8GwAA__-kmUNE

# Verify that the stages preserve the ordering as expected.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(x) FROM (SELECT a, b::float + c AS x FROM data) GROUP BY a ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMllFv4jgUhd_3V1j3CVSjYCdQmqewW7pCoqQbqLRVhSqXWBSJxowdpFZV__soSWcIMNjpOOrwRoK_63PvObrKG6hvK_BhMhgN_pmijVyhqyi8RveD_29G_eEYNS6Hk-nkv1ETfRxRm-fGS7M41fh4xzB69P2rUdif9tAZmqP-BL0UR2KWsib6Nwpvb9Dfd4ihMLocRPnPGWBIRMzH7Jkr8O-BAAYKGFzA4AGGDswwrKWYc6WEzI685cAwfgG_jWGZrDdp9nqGYS4kB_8N0mW64uDDlD2ueMRZzKXTBgwxT9lylV-TSQrWcvnM5CtgmKxZonzUcghiSYwoEukTlwowRDyJufRR4J4F9Ed_GAUEZu8YxCbdXq9StuDgk3dcXWJ_sZB8wVIhnc6uwiCbQihjLnnso_ypP757GIfTh_HtaNQIaDMTfnvdCEhzT8y2_uMremLqaa90Jn4rmB4VvK0jCiH7dc6KQpquSPvg7nJb5KAt8rOtvMFwk2bdY83A3d_WT4_oH4uWWDtkz5FCynEd3o4OUj2bpEo2HdJyaJ5OUqSzhnAaNJZs7J5GOEnN4SRfHE5aPRS0Uihoy3FrDoVBY2l856cRClpzKOgXh8KtHgq3UijcluPVHAqDxtL4eqcRCrfmULhfHAqveii8SqHwWvkXhm0QDLpKI7s4jSB4NQfB-4PfM7-QFnG1FoniO6qOVW5nzfF4wYthKLGRc34jxTy_pngMcy5_EXOVFv-S4mGYFH9lAssw2YdJGaY7MPkc3LWBL2xgYqWbdPQ01c7b1cOu3qyu3i1PS3f0cMfGaj1ssFoPG6zWwyarDbTB6q6N1edauKc3q2djlh42mKWHDWbpYZNZBtpg1oWNWcSwRU1r1G6P2i1Su01quUrtdimxWqbEsE09g2kH6_RTpulpk2l62mSanjaaZsBNph0sVa1ps_e_vgcAAP__2RWYxw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(x) FROM (SELECT a, b::float + c AS x FROM data) WHERE a > x GROUP BY a ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll9v4jgUxd_3U1j3CVSjYCf8yxPslu4iUdINVDNVB1UusSgSJYwTJKqq332UuB3-ZPANQ9ThDUJ-vsf3nHvFK0Tf5-DCsNvv_jMiKzUnV753Te67X2_6nd6AlC57w9Hw_36ZvL8SrZ5L67J-q_T-TFDy6LpXfa8zapILMiGdIVnrVwIRizL58l_X7xJBvq2qVVuSNfnX925vyN93RBDPv-z66ccxUFiEgRyIZxmBew8MKHCgYAMFByjUYExhqcKJjKJQJa-8pkAvWINbpTBbLFdx8nhMYRIqCe4rxLN4LsGFkXicS1-KQCqrChQCGYvZPC2TaGwv1exZqBegMFyKReSSisWIWASEkzB-kioCCr5cBFK5pG1ftPnHhSlpMxi_UQhX8aZ8FIupBJe90fwSB2ElXFq1XXFXs3mc1uQf3TOU48eU60ynSk5FHCqL7XWknXTdU4FUMkhKA4XO4O5h4I0eBrf9fqnNy0mjbq9LbVbeU7Mp8PhCnkT0tHd0on6j2D6oeHNOqIXsn3OhDzJdq5apvX0tlrkW-3mt9ILeKk5uTw0dd35bPz-gX6eA7zmipRzWUdvRwfLPAsszCxarWDydBqanoYBhQDTqNtQLGwak3HZq2HkMAyt4GOqfPAw8fwh5rhDyimUXHEJEow5ho7AQIuW23eLnEUJecAgbnxxCO38I7VwhtCuWU3AIEY06hM3CQoiU23bLPo8Q2gWHsPnJIXTyh9DJFUKnkv5NPDV4iC4dvFZhwUPKbTvknEfwnIKD1_qD_0d_Ic2X0TJcRHJH1aGTq8nlZDCVuhlRuFITeaPCSVpGf_VSLn0QyCjWvzL9pbfQPyUCt2FmhLkZ5vsw24btHZgdBzdPgRk_ia6fQvOqmbaNDXfMsGN2C_G6ZqTrZrhuhBtmuHFKUMwwEhQzjAUFoZGgmGksKM1TgtIy74QqshSQlYLtlMxSOcZuhEb8RmjMcAxHHEdwzHKWWS3HeM7Mq4U5iGvm5cJqCJ7ZLkeZbqYx0800ajqCY6abcdR082bFTM8smV3Xmohr5i3DWgie2TNHmW6mMdPNNGo6gmOmm3HMdG7esPumj9_--hEAAP__Wai24A==

# Ensure that an interesting input ordering that causes an ordered group by
# forces an ordered synchronizer. We create an index on b even though it's
# not used to help the optimizer realize that there's an ordering available
# on b for a constrained scan on the a,b primary index.

statement ok
CREATE TABLE data2 (a INT, b INT, PRIMARY KEY (a, b), INDEX(b));
ALTER TABLE data2 SPLIT AT SELECT 1,i FROM generate_series(1, 9) AS g(i);
ALTER TABLE data2 EXPERIMENTAL_RELOCATE
  SELECT ARRAY[i%5+1], i FROM generate_series(0, 9) AS g(i);

# Verify data placement.
query TTTI colnames,rowsort
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW RANGES FROM TABLE data2]
----
start_key  end_key  replicas  lease_holder
NULL       /1/1     {2}       2
/1/1       /1/2     {5}       5
/1/2       /1/3     {5}       5
/1/3       /1/4     {5}       5
/1/4       /1/5     {5}       5
/1/5       /1/6     {5}       5
/1/6       /1/7     {5}       5
/1/7       /1/8     {5}       5
/1/8       /1/9     {5}       5
/1/9       NULL     {5}       5


query T
EXPLAIN (opt,verbose) SELECT b, count(*) FROM data2 WHERE a=1 GROUP BY b
----
group-by
 ├── columns: b:2 count:5
 ├── grouping columns: b:2
 ├── internal-ordering: +2 opt(1)
 ├── stats: [rows=9.5617925, distinct(2)=9.5617925, null(2)=0]
 ├── cost: 15.1256179
 ├── key: (2)
 ├── fd: (2)-->(5)
 ├── prune: (5)
 ├── scan data2
 │    ├── columns: a:1 b:2
 │    ├── constraint: /1/2: [/1 - /1]
 │    ├── stats: [rows=10, distinct(1)=1, null(1)=0, distinct(2)=9.5617925, null(2)=0]
 │    ├── cost: 14.81
 │    ├── key: (2)
 │    ├── fd: ()-->(1)
 │    ├── ordering: +2 opt(1) [actual: +2]
 │    ├── prune: (2)
 │    └── interesting orderings: (+1,+2) (+2,+1)
 └── aggregations
      └── count-rows [as=count_rows:5]

query T
EXPLAIN (verbose) SELECT b, count(*), corr(a, b) FROM data2 WHERE a=1 GROUP BY b
----
distribution: full
vectorized: true
·
• group
│ columns: (b, count, corr)
│ estimated row count: 10 (missing stats)
│ aggregate 0: count_rows()
│ aggregate 1: corr(a, b)
│ group by: b
│ ordered: +b
│
└── • scan
      columns: (a, b)
      ordering: +b
      estimated row count: 10 (missing stats)
      table: data2@primary
      spans: /1-/2

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT b, count(*) FROM data2 WHERE a=1 GROUP BY b];
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlF-Lm0wUxu_fTzGcq-TtLGYmfwpCwXRrW8HVVA3bZZEw0cENuI6dGaHLku9e1EBMmnWTtpRejuf8znme84DPoL7lYEJou_Z1hCqZo4-Bf4Pu7a8Ld-54aPDBCaPwiztEu5Y1RomoCj34f9i2pkwzim4_24GNGHqHCPoU-MsFen-H1jFgKETKPfbIFZj3QAADBQxTiDGUUiRcKSHr0nPT6KTfwRxh2BRlpdvPeqNzDiZUhZAplzwFDCnXbJPX9XgbY0iE5GDuWz1xJUpjdtSIQVR6NzbGoDTLOJiTLe6sJp3VJwZHbJ3zgLOUS2N0MB6aM1il3Dwy-QQYwpIVykQGuTKIUdv2K20ii8JLQsglQuZZJnnGtJAGPdRhNbvaS5moec29u5XnRytv6boDiwwBw7W_9KJV4N-Gg-GRov2S9RN6YOrhp_nNzXeq6Yuq93NO5QYWeQMnw-tYm_yKtXB5s3K8aGDRY2d71eMD1fT80MmZodex04tDf0VI5zLjfyh0-mdDn_6d0Ef9tw64KkWh-Fn_kFFtiacZb0-gRCUTvpAiada0T7_hmg8pV7qtvm0fTtGWaoFdmPTCtB-mxzDpwuMDmFwGz_rhca_sUT886YWn_Z6nv-O5H37F8-wiz_H2vx8BAAD__zm6YjY=

statement ok
CREATE TABLE uv (u INT PRIMARY KEY, v INT);
INSERT INTO uv SELECT x, x*10 FROM generate_series(2, 8) AS g(x);

# Regression test for #37211 (incorrect ordering between aggregator stages).
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(v) FROM data INNER LOOKUP JOIN uv ON (a=u) GROUP BY u ORDER BY u]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlltv2koUhd_PrxjtJ9AZZGZsbpaORE5DK1JiUy5SowhFDh4RWuKhvkSNovz3ynYUDJTZdkEubxj8zayZtfYSLxD8WIEJ496g92FCIn9FPo7sa3Lb-zocXPQtUrnsjyfjL4MqeXsliB4rT9X0LdcJHdK3rN6IDGz783RIruy-RaInYluk4pD_SFQln0b2dEj-vyERsUeXvVHycQYUPOkKy3kUAZi3wIACBwo6UDCAQgNmFNa-nIsgkH78yksC9N2fYNYpLL11FMZfzyjMpS_AfIFwGa4EmDBx7ldiJBxX-FodKLgidJarZJtYcXftLx8d_xkojNeOF5ikpjHieC7hRIYPwg-Agh2FJukymL1SkFG42SwInYUAk73S_IKu5NJ709PY1hM9ZdQMpPwerck3ufSI9JLt34XQLqdd_aAcXkTOxWLhi4UTSl9jO_fTjT2wfVf4wjVJ8nRh3dxZ9uTOmg4GlS6vxtc2va509eqOms0G98_kwQkedpaOL3OjWD-oeLOOTIXsrvNvupDqWI29vbPHYnvHYu_HSg6YXjqnigAYf6yfH9BvyZpca3zHESyIjS0dLP9ksDyTobGaxpPZYOlsFB4NRFFmNJpljAYiJ5shdh6jwU48Gs2SR4PnjyTPFUle0_SjIokoykSyVUYkETlZ7_h5RJKfOJKtkiOp54-kniuSek0zjookoigTyXYZkUTkZL3TzyOS-okj2S45kkb-SBq5ImnUkv-axWKIqMjEsFNGDBE5Wb-M84ihceIYdv7i_9jfSBuJYC29QGypOrRyPT6ccBcivYxARv5cDH05T7ZJH-2ES75wRRCmv7L0oe-lP8UCszBTwlwN812YZWF9C2bF4PYxMONH0c1jaF5X07rywg01bKjdQrxuKOmmGm4q4ZYabh0TFDWMBEUNY0FBaCQoahoLSvuYoHTUnVBHSgGpFKxT9kqliN0IjfiN0JjhGI44juCY5WyvWop4ztTVwgzENXW5sAaC77VLIdPVNGa6mkZNR3DMdDWOmq5uVsz0vZLZdq2NuKZuGdZB8L2eKWS6msZMV9Oo6QiOma7GMdO5umF3TZ-9_vMrAAD__9au0MI=
