# LogicTest: 5node-dist

statement ok
CREATE TABLE data (a INT, b INT, c FLOAT, d DECIMAL, PRIMARY KEY (a, b, c, d))

# Split into ten parts.
statement ok
ALTER TABLE data SPLIT AT SELECT i FROM generate_series(1, 9) AS g(i)

# Relocate the ten parts to the five nodes.
statement ok
ALTER TABLE data EXPERIMENTAL_RELOCATE
  SELECT ARRAY[i%5+1], i FROM generate_series(0, 9) AS g(i)

# Verify data placement.
query TTTI colnames,rowsort
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW RANGES FROM TABLE data]
----
start_key  end_key  replicas  lease_holder
NULL       /1       {1}       1
/1         /2       {2}       2
/2         /3       {3}       3
/3         /4       {4}       4
/4         /5       {5}       5
/5         /6       {1}       1
/6         /7       {2}       2
/7         /8       {3}       3
/8         /9       {4}       4
/9         NULL     {5}       5

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslEFr2zAYhu_7FeI7JaDgyHbS1KeULYNA2nRJBoPig2Z9eAbH8iQZNkL--7A9qF0W2UM92tKr5334hC6gf-YQwXGz23w8kUrl5PNh_0heNt-edw_bJzL5tD2ejl92U_J3i67OEz5tdwlueAwUCinwiZ9RQ_QCDCj4QCEACiFQWEBMoVQyQa2lqrdcmsBW_IJoTiErysrUv2MKiVQI0QVMZnKECE78e44H5AKVNwcKAg3P8gZTquzM1e913QEoHEte6IjMPEZ4IQgj0vxABRT2lYnImkF8pSAr88rShqcIEbvS8X0e0lRhyo1U3qJf5_j1cbJm05sY_ybm9fSqkEqgQtE_WmCSnXkO8dXeiM3_r1LQq8TGT4KNmYTHZp7vNIuBRh3zpcss_PHi_ihxf-YFTuIDjTridy7iwXjxYJR4MPNCJ_GBRh3xlYt4OF48HCUezryFk_hAo474_Xs9O__AHFCXstDYQ9w6eV6_RihSbN8wLSuV4LOSSYNpP_dNrvkhUJt2lbUf26Jdqgt2w8wa9nth9jbs28kD6MCaDu3h0KX3whpe2slLF_KdNbyyk1cu5Hv7rOYD18R-yd6y4-uHPwEAAP__FC3jsA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum((a-1)*1000 + (b-1)*100 + (c::INT-1)*10 + (d-1)) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUVV2Lm0AUfe-vGO6T7o7oqNnN-pSwm4KQZLdJCoXFh1nnkgaMpjMKLSH_vahdokszWuxLfPJ-nDn3nDswR1A_EghgPZvPHjekkAn5vHpekNfZt5f5NFwS4ylcb9Zf5ib506KKvVF-nFiEmeSGMMdxTHJLDOOtkTLrVBwE4XIzPhfqvKgSZs0leM4joJBmApd8jwqCV2BAwQUKHlDwgcIIIgoHmcWoVCbLlmMFCMVPCBwKu_RQ5GU6ohBnEiE4Qr7LE4QANvwtwRVygdJ2gILAnO-SiuYgd3suf03KGYDC-sBTFRDLZoSngjCS5d9RAoUVpgJlQErlE2axoNZl3pTq34Nbw5i47dr7f1Xz6qDV0WiY-FXlafYYLqZzE6IThazIz7pUzrcIATvR_tqn263ELc8zaY_a0tdfF8aEXaZxL9KcTy_STAqUKNpHC4x3e55AdNJPxJx_G8lrjcT6b5312brNLNu9mr13qG-4fDdk725_k91eJruW7V2NyR3qGybfDzHZ62-y18tkz7L9qzG5Q33D5PEQk_3-Jvu9TPYte3Q1Jneob5j88L-eib_QrFAdslRhi-LSyU75eqDYYv3mqKyQMb7ILK5o6vC5wlUJgSqvq6wOwrQulQM2wUwLdltg9hHs6pk7qD0t2teD_SFzj7TgOz3z3RDmey14rGceD2F-0O_K6bgm-kv2kTs6ffodAAD__xvXaxg=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), count(a), max(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF-L4jwUxu_fTxHOlUKkpq2O0ytlXhcE_8xahYGhLNnm4BZq4yYpzCJ-96XtsKPDNi3UvRDSNo-_h98JOYP-mUIA4Xw5f9qRXKXky3azIq_zl-flbLEmvf8X4S78uuyT9y06P_Z4n5JY5pkpV0f-1uP9Kie44RFQyKTANT-ihuAVGFBwgYIHFHygMIKIwknJGLWWqthyLgML8QbBkEKSnXJTvI4oxFIhBGcwiUkRAtjx7ylukQtUzhAoCDQ8SUvMSSVHrn5Niw5AITzxTAdk4DDCM0EYkeYHKqCwyU1ApgyiCwWZmw-WNvyAELALbd9ndjgoPHAjlTO6rRPuV70p6wOFp81-vXtfr2Yv5aoO7tbCP5h5JpVAheIWKDBOjjylSWaKH0QXe182rCsc7lffFkVl909lr76yd1OZtZ8fazM_hw0ct9MEGxpdGRnff4Juex1uKx3uwPE66WhodKXj4f46vPY6vFY6vIHjd9LR0OhKx-T-Ovz2OvxWOvyBM-qko6HRlY7Hf3vd_QW-RX2SmcYbcN0_D4vbD8UBq7tTy1zF-KxkXGKqx02ZK18I1Kb6yqqHRVZ9Kgpeh5k17N6E2eewayc3oD1r2reH_S69R9bw2E4edyE_WMMTO3nShfxon9Ww4ZjYD9lndnT573cAAAD__-5HCcM=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a+b), count(a+b), max(a+b) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF9r4kwUxu_fTzGcq0pH4iTR2lwpfV0Q_NM1CoUSlmnm4AZixp2ZQBfxuy9JpNWyTgJmLwIzSZ78Hn4nzAH0rxQCCCezydOa5Col31bLOXmdvDzPxtMFuft_Gq7D77MOOb2i890dJ_fkrUNJLPPMfOx2_P20rr4huOERUMikwAXfoYbgFRhQcIGCBxR8oNCHiMJeyRi1lqp45VAGpuIdgh6FJNvnprgdUYilQggOYBKTIgSw5m8prpALVE4PKAg0PElLzF4lO65-j4oOQCHc80wHpOswwjNBGJHmJyqgsMJMoArIiN2PXIiOFGRuPona8C1CwI60eavxdqtwy41UTv-yVLiZ341YByg8LTeL9Wk9H7-Uq2tw9yr8k5lnUglUKC6BAuNkx1OaZKa4IDra-7LetcLhZv5jWlR2Pyp71yt7F5VZ8ymyJlN0WNdxW5hjTa8zL4P25-g2l-I2kuJ2Ha8FKTW9zqQ8tC_Fay7FayTF6zp-C1Jqep1JGbYvxW8uxW8kxe86_Rak1PQ6k_L4b4_Bv8BXqPcy03gBvvblXnEqothidaZqmasYn5WMS0y1XZa58oZAbaqnrNpMs-pRUfA8zKxh9yLMvoZdO7kG7VnTvj3s39K7bw0P7OTBLeQHa3hoJw9vIT_aZ9Wr-U3sP9lXdnT8708AAAD__wXXFQM=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum((a-1)*1000) + sum((b-1)*100) + sum((c::INT-1)*10) + sum(d-1) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMVVFro0wUff9-xXCftBnRUdOmPhnafCAkaTfJwkLxYepcsgGj2VFhl5D_vqgl0bIZZUOWPOXOPZ6ce85cmD1kP2LwYDmZTp5WpJAx-X_xMiNvk2-v03EwJ9pzsFwtv0x18vGJpmXFVtM4MQjTyR1hlmXpZECq7nujqx-7kecF89XohB0hUfcqScFzHgKFJBU451vMwHsDBhRsoOAABRcoDCGksJNphFmWyvKTfUUIxE_wLAqbZFfkZTukEKUSwdtDvsljBA9W_D3GBXKB0rSAgsCcb-JKZic3Wy5_-eUMQGG540nmEcNkhCeCMJLm31EChQUmAqVHNJ8ZzKtt6XdlBB8HSjTfbkMNxKnLFn6EfbfqP0-egtl4CuGBQlrkJztZztcIHjvQ_pbH67XENc9TaQ7bjpdfZ5rP9NJsWdnHyjlWrn52CPvsECftIkmlQImiLSww2mx5TM_8QnhQ-2DW3xg5XZ3vDjTfGWg-G_i2ft6i07LI-q8W67NaJjNM-9aXq8N041Lur7dcdv_k7V7J24bp3HryHaYbyT9cL3mnf_JOr-Qdw3RvPfkO043kR9dL3u2fvNsredcwh7eefIfpRvKP_-Yp-8MQC8x2aZJha4Bz_2yVLxmKNdbvYpYWMsJXmUaVTH18qXhVQ2CW1yirD0FSQ-WATTJTku0WmX0m22rlDmlHyXbVZPeSuYdK8r1a-f4S5QcleaRWHl2i_Ki-K6tjTdRL9lk7PPz3OwAA___ue50h

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), min(b), max(c), count(d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF-Lm0AUxd_7KeQ-KUwwo2Y361PCNgUhf7YxgYVFyqxzmwrGSWdG2BLy3Yta2GRpRpuQPjn_jufM7w53D-pnDiHEk-nkcWWVMre-LBcz62Xy_DQdR3PL_hzFq_jr1LH-HFHl1mYOsbZZYb9WX_Zmpw6xUlEW2uZOo-dMswQIFILjnG1RQfgCFAh4QMAHAgEQGEBCYCdFikoJWR3Z14KIv0HYJ5AVu1JXywmBVEiEcA860zlCCCv2muMSGUfp9oEAR82yvLbZyWzL5K9RlQEIxDtWqNDqudRiBbeoJfQPlJAcCIhSvzsozTYIIT2Q7inGm43EDdNCuoPTEPF6Zo-oAwRm0dweefVo_GyP_Gr0uFjPV_YocM7G8M7GeHcvCyE5SuSn1hzTbMtykhWafM8F09UIkoM5P-3_ywXi9exb1HIF_-QKtHs9aZd6urTnehdUtCXHEZG7W1bU647D64TD67n-BThachzhuL8lDr87Dr8TDr_nBhfgaMlxhGN4SxxBdxxBJxxBzx1cgKMlxxGOh__V_v4SY4lqJwqFJxHO_blf9UHkG2x6qRKlTPFJirS2aaaLWlcvcFS62aXNJCqarSrgsZgaxd6JmH4Ue2bnFmvfqA7M4uCa3AOj-M7sfHeN871RPDQ7D69xfjDXqt_yTMyP7KN3cvj0OwAA___80Q6z

# AVG is more tricky: we do two aggregations (for the sum and for the count)
# and calculate the average at the end.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT avg(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF-LozwUxu_fTxHOldIUG7WdjlcO83ZB6J_Z2sLCIEvGHFzBajemyy6l331RB8YO2yi0vVOTp8-vvxNyhPJnBh6Es_nseUMOMiNf1qsFeZ19e5k_BUti_B-Em_Dr3CTvW_ivxDAMTgbkzSQDEntesNxMq0dhNlnBFY-AQl4IXPIdluC9AgMKNlBwgIILFMYQUdjLIsayLGS15VgHAvEbvBGFNN8fVPU5ohAXEsE7gkpVhuDBhr9luEYuUFojoCBQ8TSra_Yy3XH5x68YgEK453npkaHFCM8FYaRQP1AChTXmAqVHfHdgGD4b-LY58J33_wLRiUJxUB8EpeIJgsdOtD_lU5JITLgqpDU-hwy3C8NnJlB4Xm2Xm_r5UqV9sfKj6ZAXUqBEcV4jME53PKNpriA66QnZ6BJiuF18DypI22x7Y5ZvX4R2zqBZ_2myPtO02NCy7zDPDs6Wrcmt5mn3V2P3UmMPLecOajo4W2oebqXG6a_G6aXGGVruHdR0cLbUTG-lxu2vxu2lxh1a4zuo6eBsqXm8xwX5j8o1lvsiL_Gs7tIvj6o7E0WCzW1bFgcZ44ss4rqmeV3VufqDwFI1q6x5CfJmqQJsh5k2bJ-F2eewrW_uqHa0aVcfdq_hHmvDE33z5JrmB214qm-eXtP8qJ_VqOOY6A_Z5-7o9N_fAAAA___rexk-

# VARIANCE/STDDEV have three local (sqrdiff, sum, and count) and one final stage aggregations.
# We calculate and render the variance/stddev at the end.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), round(stddev(b), 1) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF9r2zAUxd_3KcR9ckDBkey0qZ9cmgQMadIm7hgUM9TokhkcK5PksVHy3YftQpOy2AbTPVn_js-5P130CuZnBgFsZovZXUwKnZH5enVPnmffHha30ZI402gTbx4XA_J2xBR7Rwwo0arIpWOslPjLeRlQwga1VAorEqCQK4lLsUcDwTMwoMCBggcUfKAwhoTCQastGqN0eeS1EkTyNwQjCml-KGy5nFDYKo0QvIJNbYYQQCxeMlyjkKjdEVCQaEWaVTYHne6F_hOWGYDC5iByE5Chy4jIJWFE2R-ogcKqsAEJGQ05JEcKqrDvdsaKHULAjrR7pNvdTuNOWKXd8XmizdO9E7JBGeZxPY3mcyfk1axcr0Z3q6dlXI0vReEXo7wnKHKlJWqU5_YSt-leZPTjN80tJMfmStjoUinzaHm7-L6Jp9PZVyfkNPRo6Jcba8wl6grtW4OEnLIgCKJlPLlcoHdWIOt-_azL9bts6PK-DdAS6gTb1Wc3AO_Oh3fiw4eu15dPS6gTPtefzcfrzsfrxMcbun5fPi2hTvhMPpuP352P34mPP3THffm0hDrhc_M_H9h_RFmjOajc4FmMS38elW8syh3Wr7VRhd7ig1bbyqaeripdtSDR2HqX1ZMor7fKgKdi1ijmZ2L2UcybnVusvUa13yz2--QeN4qvmp2v-jhfN4onzc6TPs43zXc1ammT5ib76J0cv_wNAAD___eqLIQ=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), round(variance(b), 1) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lFFro0AUhd_3Vwz3ycAEM6NpU58MbQJCalqTLgtFlqlzyQrGyY7jskvJf1_UQpOyUUG6T3FmPDnnfh7mFYqfGXiwWawWt1tS6owso_U9eV58e1jNg5BYd8Fmu3lcjcjbK0W5t8SIEq3KXFq_hE5FnqD1MqKEjRqxFEbEQCFXEkOxxwK8Z2BAgQMFByi4QGEKMYWDVgkWhdLVK6-1IJC_wZtQSPNDaartmEKiNIL3CiY1GYIHW_GSYYRCorYnQEGiEWlW2xx0uhf6j19lAAqbg8gLj4xtRkQuCSPK_EANFNal8YjPqM8hPlJQpXm3K4zYIXjsSPtHmu92GnfCKG1PzxNtnu4tn42qMI_RXbBcWj6vV9V-_XS7fgq39fOlKPxilPcEZa60RI3y3F5iku5FRj_-prmB-Ng-CZtcGmUZhPPV96_zKJiHtwvL59R3qO9WRxHmEnUN960kPqfM87wg3M4uj-icjcj6F4D1KYDNxjYfWoGOUCfgrj67Arw_H96LDx_bzlA-HaFO-Fx_Nh-nPx-nFx9nbLtD-XSEOuEz-2w-bn8-bi8-7tieDuXTEeqEz83_vGL_ESXC4qDyAs9iXPrnSXXLotxhc18XqtQJPmiV1DbNcl3r6g2JhWlOWbMI8uaoCngqZq1ifiZmH8W83bnD2mlVu-1id0juaav4qt35aojzdat41u48G-J80_6tJh01aS_ZR-_4-OVvAAAA__-3fy3C

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT stddev(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF2L2kAUhu_7K4ZzFXEkThJ33VxlWRUCru6abCksocxmDjYQEzsZS4v430sSy6rUSUBy5eTj9X3ynGH2UPxMwYVgOp8-hWQnUzJbLZ_J-_Tby_zRXxBj4gdh8DrvkeMrhRICfxmGwUmffPRIn8Su6y_CcbkUvTouuOIRUMhygQu-wQLcd2BAwQIKNlBwgMIIIgpbmcdYFLksX9lXAV_8BndIIcm2O1XejijEuURw96ASlSK4EPKPFFfIBUpzCBQEKp6kVc1WJhsu_3glA1AItjwrXDIwGeGZIIzk6gdKoLDCTKB0ief0DcNjfc_q9T37-C0QHSjkO_VJUCi-RnDZgbanfFyvJa65yqU5OocMXlcTfzYzPNYrGd-ej6un5dsirNbXAKyrAJ-9uyyXAiWK81KBcbLhKf33m2QKooOem13YnfmLx_n3IJxMpl8Nj1HPop59ndY-o2Xth8raDNVkA9PqYKwNnCd67roZq9VelNVKlDUw7Q5ENXCeiLrvRpTdXpTdSpQ9MJ0ORDVwnogadyPKaS_KaSXKGZijDkQ1cJ6Ieuj-RP0PwAqLbZ4VeFZ-7Z-H5eGKYo318VzkOxnji8zjqqa-XFa56obAQtVPWX3hZ_WjEvA0zLRh6yzMLsOWvrmh2tamHX3YuYV7pA3f6Zvvbmm-14bH-ubxLc0P-lkNG7aJfpNddkeHL38DAAD__0QAKfc=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT variance(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF2L2kAUhu_7K4ZzFXEkThJ33VxFdhUCbtyNbiksocxmDjYQEzsZS4v430sSy6rUSUBy5eTjzfv4nGH2UPxMwYXldD59XJGdTMksXDyT9-m3l_nED4jx5C9Xy9d5jxxf-cVlwrMYDcPgpE8-eqRPYtf1g9W4XIpe_QHBFY-AQpYLDPgGC3DfgQEFCyjYQMEBCiOIKGxlHmNR5LJ8ZV8FfPEb3CGFJNvuVHk7ohDnEsHdg0pUiuDCin-kGCIXKM0hUBCoeJJWNVuZbLj845UMQGG55VnhkoHJCM8EYSRXP1AChRAzgdIlntM3DI_1PavX9-zjf4HoQCHfqU-CQvE1gssOtD3lZL2WuOYql-boHHL5Gj75s5nhsV7J-PZ8XD0u3oJVtb4GYF0F-OzdZbkUKFGclwqMkw1P6b_fJFMQHfTc7MLuzA8m8-9fJ6E_CR6nhseoZ1HPvs5rn_Gy9mNlbcZqsoFpdTDYBs4TQXfdDNZqL8pqJcoamHYHoho4T0TddyPKbi_KbiXKHphOB6IaOE9EjbsR5bQX5bQS5QzMUQeiGjhPRD10f6b-ByDEYptnBZ6VX_vysDxeUayxPqCLfCdjfJF5XNXUl4sqV90QWKj6Kasv_Kx-VAKehpk2bJ2F2WXY0jc3VNvatKMPO7dwj7ThO33z3S3N99rwWN88vqX5QT-rYcM20W-yy-7o8OVvAAAA___-RSs1

# Test various combinations of aggregation functions and verify that the
# aggregation processors are set up correctly.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(b), sum(c), avg(d), stddev(a), variance(b), sum(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUVt9r4kAQfr-_YpmnBEfiJvFXnlaqQsDaVm05KFK22T1P0MTbxHJH8X8_8qOalJoECoJPzuzst9838w3Edwj_bMCB-WgyulmQvdqQ8ezuljyPft5PBu6UaEN3vpg_THSSXQn3W43rSPjbSnvVMcm9LBdxHgkh35Irb1ytue_J4z1N46RBXnXSIJ7juNNFLw6FnnIKHvElIPiBkFO-lSE4z0ABwQQECxBsQGjDEmGnAk-GYaDiK-8JwBV_wWkhrP3dPoqPlwheoCQ47xCto40EBxb8dSNnkgupjBYgCBnx9Sah2an1lqt_LNYACPMd90OHNA1KuC8IJUH0WypAmElfSOUQZjc0jdEGM_UGs7JekDCKhJlImIWE2bA8IAT76KQojPhKgkMPWF_1YLVScsWjQBntouj5463GTD3WG0dWHN3cPU4XWZyc2seonasn8fxhNnTH4-yNrGIWKqd3qH62HfNsO6cu9n6ghFRSFFsQ0ltv-QY_ftd-hL82AY8KJ1_F2S8sD-Uzo60vhkaPbX2M78UtHdvxRifOxu50MHmZL4bD0ZPGusgost6p8DSYuYPpzUhjfWQm5ofY0vNLlGyLkS4LEtY2WAcJ6yJhPSSsf3bgVmHgtP7W0zpbb9CmYV5g7yt05zzsXMPem_VtMGvZYDYN6wI2VOjO2dC9Bhus-jZYtWywmoZ9ARsqdOds6F2DDXZ9G-xaNthNo30BGyp052zoX4MNFf8tZjLcBX4oC62ce7kVf2mlWMn0yx4Ge-XJexV4CU2a3iW45EDIMEqrNE1cPy3FAvNgWgo2C2D6GWyWM1dQW6Vouxxsf0d3uxTcKWfufIe5WwrulTP3vsPcL_eqVbEm5Uv2mXt5-PE_AAD__5qp0ps=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), min(b), max(c), count(d), avg(a+b+c::INT+d), stddev(a+b), variance(c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUVl9r6k4Qff99imWeNjgSN4l_mqeVqhCwtlVbCkXKNrs_b0AT7yaWXorf_ZJobVKuSaAP4pOTmTmeOXN2YT8g_r0CF2bD8fB6TrZ6RUbT2xvyPHy6G_e9CaEDbzaf3Y8NcmiJt2sqDCTrIKSv6a94p76BxI-2YUKlgUS8LSmlgjTIq0EaxHddbzLvpWFajRMp1duhjORN6ECEvqKHtqxrP4MUiVgAQhhJNRFrFYP7DAwQLECwAcEBhDYsEDY68lUcRzpt-cgAnnwHt4UQhJttkqYXCH6kFbgfkATJSoELc_G6UlMlpNJmCxCkSkSwymg2OlgL_YenMwDCbCPC2CVNkxERSsJIlPxSGhCmKpRKu4Q7DUo5a3DLaHD7oBhJlsG0-plMc0iypJ0WYLFDiLbJ15RxIpYKXLbD-kr6y6VWS5FE2mwXhcwebih3DEC48SaUt7Oo_0R5J42ubx8mc8q7aZx1slw2i2f304E3GlFuHXusXI9V6LGPPXauxzZOirROivzStg0jLZVWsihMKj9YixUGYYL_ryKRZFE--xlX5GCxK98oa_1jpey4Uuu40k_5L14q2zkuo13IZ4sfeZP--GU2HwyGj5R3kfeQX30VHvtTrz-5HlLOWsgZQ84ymuNxK5whJLxt8g4S3kXCeye3bRe2zepfDlbncpisaVpnuh4VWnJmdi73elj1DbNqGWY1TftMhlVoyRnWvVzD7PqG2bUMs5umcybDKrTkDOtdrmFOfcOcWoY5TbN9JsMqtOQMu7pcwyqeRVMVb6IwVgWBp_65lT4DlFyq_fMjjrbaV3c68jOa_edthssSUsXJvsr2H164L6UD5sGsFGwVwOw72CpnrqC2S9FOOdj5ydztUnCnnLnzE-ZuKbhXztz7CfNVuVetimNSfsi-cy92__0NAAD__-tyBIA=

# Verify that local and final aggregation is correctly shared and de-duplicated.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), stddev(a), avg(a) FILTER (WHERE a > 5), count(b), avg(b), variance(b) FILTER (WHERE b < 8), sum(b) FILTER (WHERE b < 8), stddev(b) FILTER (WHERE b > 2) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzsVk1v6jgU3c-vsO4qSEaJ88FHVkYlaCJR2gbaGamDKhNbDBIkPCep3lPFf39K0kLCIx9SF2xYJb4-5x7fe48lf0D0Yws2zJ2pc7dAidyiifdwj16dfx-nI3eGlLE7X8yfph30CYmSncI6GEUx5-I9-2Xva4V10MSdLhwPKf_87XgOYui_RNMMgawORn6YBLGy-sSm33cmNyzwhbI6J65yoo8GqUqya0Lk56gCCaR38pI4i9kSMAQhFzO2ExHYr0AAgw4YDMBgAgYLlhj2MvRFFIUyhXxkBJf_BFvDsAn2SZyGlxj8UAqwPyDexFsBNizYais8wbiQqgYYuIjZZpvJ7OVmx-Qvmp4BMMz3LIhs1FUJYgFHBIXx_0ICBk8EXEgbUZIf3rJt250tBhhRPa95cB4R-ilC0igsDxjCJD4dNIrZWoBNDrh9MaP1Woo1i0OpWuVa5s_3CjU7aRlP3tidTD5Xdw_Ps8XXTo75Ggklxf1LUevIskqZrRNaPyFKsWOGMvJCBuNCBuNiBqOyiXplE0-9S4JQciEFLzeOC3-zY1v89d0Ecem_uK7DFmKwPNTPjmgXhkfSFk_c2Wj6Nl-Mx86LQnVMCaZGYXb535tbnE6-6h1R_VOil5HnjmZ3jkIHmA4xJdoRNfxTjhBMSaqZKZ5cn_oXI2qo1MSIWhjRnpp9-hjR1OHDysEYpcGQ9leVtLmqKumq-vUua0M5hYH3bpe16rLq7T2ht_KE3lWN63mioZyCJ_o3T1R5wmjvCaOVJ4yual7PEw3lFDwxuHmiyhNme0-YrTxhdlXrep5oKKfgieHNE20eehea6IloHwaRKDWwKrOWvtkEX4v81RiFifTFowz9TCZfPmS8LMBFFOe7JF-4Qb6VHrBIJrVkvUQm52S9XrlB2qhlm_Vk8zvntmrJvXrl3neU-7XkQb3y4DvKw_pZaQ02qTfZufby8NfvAAAA__8gTKwF

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(DISTINCT a), variance(a) FILTER (WHERE a > 0) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0k1Fr2zAQgN_3K8Q9JaBgy3bG0FNC5m6GNO0crxt0flCjwzM4kifJZSPkvw_bG5lHWzySPeruPt2nE3cA-60CDtt4Ha8y0piKXKU31-Q-_ny7XiYbMnmbbLPth_WU_CqxzX4ippSIx6LLJZtVRtrAozClUDuciCm5StZZnJLJp_dxGhNBvjS-HyLxp_3tUjiRAwWlJW7EHi3we2BAIQAKIVCIgMIccgq10Tu0Vpu25NABifwO3KdQqrpxbTinsNMGgR_Ala5C4JCJhwpTFBKN5wMFiU6UVdemNuVemB-L1gEobGuhLCczjxGhJGFEu69ogEKKSqLhZMF6eZ9znmyyN5QsGORHCrpxJwHrRIHA2ZE-I3lya5Q2Eg3KodeD1hUtlYP8-MSDlkVhsBBOG28-5LYfryeLYAoUlnfvTj_Sh-6WabLcrOK24venvKAfDPTZ-BmzMTP22MwLLj_lYLxmMEozmHnh5TXD8ZrhKM1w5kWX14zGa0ajNKOZN_-_q_WEZoq21sriwPC5m_124VAW2O-p1Y3Z4a3Ru65Nf7zpuC4g0bo-y_pDorpUJ_gnzF6EXw9g_284OKdzeA4cnQPP_wnOj69-BgAA__9a4w12

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(a), count(a), stddev(a), variance(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF9ro0wUxu_fTzGcqwQmmFHTP14ZmgSENGljWl4oocw6h6xgnOzMWHYp-e6LGqiWjQqSi5BzPD7zPPw8zCfoXwl4EM6X84ctyVRCFpv1I3mb__-0nAYrMpgF4TZ8Xg7J-RWdHQZ8SAn_2Bf_kcxSU1TaCIEfRfnBVczTCAd8WJ4nuOE7oJBKgSt-QA3eGzCgYAMFByi4QGECOwpHJSPUWqr8lc9CEIjf4I0pxOkxM_njHYVIKgTvE0xsEgQPtvxHghvkApU1BgoCDY-Twuao4gNXf_w8A1AIjzzVHhlZjPBUEEak-YkKKKwz4xGfwe5EQWbmy0sbvkfw2Il2zzPd7xXuuZHKmtTjhC-PA58NgcLD-mW1Pdfh82YWLBZFdymAfTHAl2-WSiVQoaibCoziA09onBp6rmF3as7NxpeChy-P70Ee3c67RbCaLt_D7Ww2fx34DvUZrQ5ep5tgunqY10YbTAWqHDclPrN8m5Li51DiuxcBODUArPtGsC4bYbGRZffaiZZEFbY319kJuzsSuxMSe2Q5vZC0JKogub0OEqc7EqcTEmdkub2QtCSqILm7DhK3OxK3ExJ3ZE16IWlJVEFyf_3L9B8BNqiPMtVYM7908ji_V1HssbyZtcxUhE9KRoVN2a4LXfFAoDbllJVNkJajPGBVzBrFdk3MvovtZucWa6dR7TaL3T65J43im2bnmz7Ot43iu2bnuz7O983fatyyJs1L9t17d_rvbwAAAP__Hm8qeg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(b), sum(a), sum(a), avg(b) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF-Lm0AUxd_7KYb7lMAEM2r2j08u2xQC-bONCRQWKbOZixWMk86MpSXkuxe1241LMwqmT947ejxnfneYI-jvGQQQTefTxw0pVEY-rVcL8jz98jR_mC3J4OMs2kSf50Py5xNd7Ad8SAn_kQxehvRv31yv_yK44TFQyKXAJd-jhuAZGFBwgYIHFHygMIGYwkHJHWotVfnJsRLMxE8IxhTS_FCYcjmmsJMKITiCSU2GEMCGv2S4Ri5QOWOgINDwNKtsDirdc_UrLDMAhejAcx2QkcMIzwVhRJpvqIDCqjABCRkNXYhPFGRh3uy04QlCwE60e6SHJFGYcCOVM2kmiraLQciGZZiycsvqcbVdbqr6krl70fzNs8ilEqhQNA0F7tI9z-jrM80NxCd7ZjZuDx1tF19nZWyv7NaYC1QVQxK6TujRunxtL-7Ma-yMdZ806zJph40ct--sW0Kdcbu5_qzd7kTcTkTckeP1JdIS6ozI7fWJeN2JeJ2IeCPH70ukJdQZkbvrE_G7E_E7EfFHzqQvkZZQZ0Tu_-8N-Q_zNeqDzDU2jC_9eVxeligSrK9bLQu1wycld5VN3a4qXbUgUJv6LaubWV6_KgOei5lV7DbE7L3YtTu3WHtWtW8X-31yT6ziG7vzTR_nW6v4zu5818f53j6rccsxsR-y997x6cPvAAAA___5CRpL

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT avg(c), sum(c), avg(d), sum(d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF-Lm0wUxu_fTzGcqxUmmFGzm_XKkDcLgfzZxgQKi5Spc2oF46TjWFpCvntRA6tLo4KkV3qO8-R5zi-HOUP2IwEX_MVqMd-TXCXkZbddk7fF59fVbLkhD_8v_b3_aWWQ6xH-M3oIDUqy_Fg-i1pca2FUasE1D4BCKgVu-BEzcN-AAQULKNhAwQEKEwgonJQMMcukKo6cS8FS_AJ3TCFOT7ku2gGFUCoE9ww61gmCC3v-NcEdcoHKHAMFgZrHSWlzUvGRq99ekQEo-CeeZi4ZmYzwVBBGpP6OCihsc-0Sz6aeA8GFgsz1u12meYTgsgvtH2kWRQojrqUyJ81E_mH94DEDKMy3h83--l52rVrXMm4GsW4GeffPU6kEKhRN82-J5JrGqaYCw_jIk-Idgkv7BGx8awT_sP6yvMa9DmE3-k5R7TAVqFziMXM-84vTM_9ltZ3tpwYlHqPEs03PKR43Z7YbM7P--8D67IPJRqY1dCM6QtV4Pt53I6z-dKxedKyRaQ-l0xGqRufpvnTs_nTsXnTskekMpdMRqkZnel86Tn86Ti86zsicDKXTEapG5_nf3bV_CbLD7CTTDBshbv3yuLh0UURYXdyZzFWIr0qGpU1Vbktd2RCY6eorq4plWn0qAtbFrFVsNcTso9hqd-6wtlvVTrvYGZJ70ip-bHd-HOL81CqetjtPhzg_t_9X4441aV-yj97B5b8_AQAA__9gASzw

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT max(a), min(b) FROM data HAVING min(b) > 2]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslF1v2jAUhu_3K6xzBZJRYidQ6qugjW6R-OgATZW6XLjkiEUKMbMdqRPiv0-QbYVqOJHCZWy_eV49x_IezM8cBCzHk_HHFSl1Th4W8yl5Hj89TkbxjHQ-xcvV8uukS_4c2crXjuxSss2Kzku3Op1KK8mX0bd49vnv-vfS9wMkPAEKhUpxJrdoQDwDAwocKARAIQQKfUgo7LRaozFKH4_sT4E4fQXhU8iKXWmPywmFtdIIYg82szmCgJV8yXGBMkXt-UAhRSuz_ITZ6Wwr9a_oWA0oLHeyMIL0PEZkkRJGlP2BGijMSytIxGjEITlQUKV9wxkrNwiCHWjzSqPNRuNGWqW9_mWj6eipE7EuUJjGs07Eu1eB_CrwjVMWSqeoMb2EZIWlWWEhObi7Mb-uHIWHLLeoBYn4v2kKIeLZani1eXDRnDWfHmsyPY_1PN52fjWlzhwNbjM_3twCb2SB97ygrYWaUmcW7m5jIWhuIWhkIeh5YVsLNaXOLAxvYyFsbiFsZCHsef22FmpKnVm4v_2L9h_gAs1OFQYvYNf-7B8fOkw3WD2PRpV6jY9arU-Y6nN-yp0WUjS22mXVR1xUW8eC52HmDPOLMHsf5m5yDTpwpkN3OGzTu-8MD9zkQRvynTM8dJOHbcj37ln5NdfEfcnes5PDh98BAAD__xHBAwk=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT DISTINCT (a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslEFvmzAYhu_7FdZ3ajUjMJA05ZSpzSSkLOmSHCZVHDz8qUOimNlG2hTlv0_AlI5qNVbJ0eCX5334LB9B_ywhgf1qvbo7kEaV5PNu-4U8rr49rD-lG3J1n-4P-6_ra_J3S7tON3cHcsWv-72CG54BhUoK3PBn1JA8AgMKIVCIgEIMFGaQUaiVzFFrqdotxy6Qil-QBBSKqm5M-zijkEuFkBzBFKZESODAv5e4Qy5Q-QFQEGh4UXaYWhXPXP1eth2Awr7mlU6I5zPCK0EYkeYHKqCwbUxClgyyEwXZmBeWNvwJIWEn6t7nvtCmqHLjz4Zllq30VglUKKy08E3aC0T23xkSisoAhSX7CNnJVowF72wWDZox97kwl7n4zPPDSZMZaXT-AfOLTCZ09w-d_EPPjyb5jzQ6-99cxD9y94-c_CPPjyf5jzQ6-y8u4h-7-8dO_rHnzyb5jzQ6-99e_Gb6D22HupaVxgHrrS8H7YWF4gn7a07LRuX4oGTeYfrltst1DwRq079l_SKt-ldtwX_DzBoOB2H2OhzaySPoyJqO7eF4Su-ZNTy3k-dTyDfW8MJOXkwh39pnFYwcE_she83OTh_-BAAA__8NAu9Y

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT SUM (DISTINCT A) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslFGLoz4Uxd__nyLcp38hxUZtp-NTh5kuFDrtbO3CwuBD1lxcwRo3ibBL6Xdf1KVdyzRK3UeTnHvOzxNyBP0jgwDC5Xr5vCelysin3faVvC-_vq2fVhvy_8sq3Ief1yPy54guD_XaavO8J3zUHBfc8Ago5FLghh9QQ_AODCi4QMEDCj5QmEJEoVAyRq2lqo4ca8FK_IRgQiHNi9JUyxGFWCqE4AgmNRlCAHv-LcMdcoHKmQAFgYanWW1TqPTA1a9FlQEohAXPdUDGDiM8F4QRab6jAgrb0gRkwSA6UZCluXhpwxOEgJ1o_zwvqTZpHhtn2g5jme_enH8ZW-ZSCVQo2lPT3EB0-iDGU5IoTLiRymFXvyX88nrpacFGN3N5rVysfw-sTw8OGzvuoCY6Ep2bmN3ZhNuf2O1F7I4dbxBxR6Iz8cOdxF5_Yq8XsTd2_EHEHYnOxPM7if3-xH4vYn_sTAcRdyQ6Ez_-g_flg_k71IXMNbam35o8qZ4eFAk2j5WWpYrxTcm4tmk-t7WuXhCoTbPLmo9V3mxVAf8WM6vYbYnZtdi1O3dYe1a1bxf7Q3JPreKZ3Xk2xPnBKp7bnedDnB_tXU06ron9kl17R6f_fgcAAP__yUndDQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT SUM (DISTINCT A), SUM (DISTINCT B) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslFGL4jAUhd_3V4T7tEKkJq0zTp8cZlwQHJ1VFxaGPmTMxS1o0k1S2EX870vbRbcypsXuY29zcs6XE3IA-3MHMawms8nTmuRmR74sFy_kbfL9dfY4nZPPz9PVevV11iN_l9h8X86m86c1ET1aH7z3Kr0UTiRAQWmJc7FHC_EbMKDAgUIIFCKgMISEQmb0Bq3VplhyKAVT-QviAYVUZbkrxgmFjTYI8QFc6nYIMazF-w6XKCSaYAAUJDqR7kqbzKR7YX6PiwxAYZUJZWPSDxgRShJGtPuBBigscheTMaNjDsmRgs7d2c46sUWI2ZG2j_ScWpeqjQuG9Tx-C37V4rxzrrSRaFDWN06Vo6lykBw_SPO43RrcCqdNwC4OaPXt5dzYmPWKQ6qNeO9q3LAWl7UvibUpKWD9gHetqSHUqaa722vi7bl5K27eD8Ku3A2hTtz3t3OH7bnDVtxhP4i6cjeEOnGPbueO2nNHrbijfjDsyt0Q6sT98H-eow8slmgzrSzWDK7tPCheKZRbrN42q3OzwVejN6VN9bkodeVAonXVX1Z9TFX1qwj4r5h5xbwmZpdi7ndusA696sgvjrrkHnrFd37nuy7O917xyO886uL84O9q0HBN_Jfs0js5fvoTAAD__z2A7jA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT DISTINCT a, b FROM data WHERE (a + b + c::INT) = 27 ORDER BY a,b]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lFFr2zAUhd_3Ky73KSUKjmSnSQUDb43LDFnSOYFtFD8otugMrp1JCmyE_Pdhe6RNWWVDsjxeSUffuecK7VD_zJHjMpgFtyvYqhzuosVneAi-3c8-hHPoTcPlavlldgV_j1R1OL9dgSCwbg6nwgj4-imIAuj1BPRhfQV9SDgP56vJFbwHNoZFNA0i-Pi9lsVIsChTORdPUiN_QIoEGRJ0kaCHBEcYE9yoMpFal6o6sqsFYfoL-ZBgVmy2plqOCSalksh3aDKTS-S4EutcRlKkUjlDJJhKI7K8xmxU9iTUb78yjASXG1FoDgOHgihSoFCaH1IhwbssN1Jx6PV8Cn3wWdWP775siDcFElxsDQefEp9hvCdYbs2zN23Eo0RO96S7_2mmTVYkxhkdm28QBBcqlUqmbUz2JvMZVTZXHXOywpCsMEjQp33isz7Ge5tNOjzJp3vkk3afLe0yW4cOHHbR6bZ0cIjt-ozTZd1TY51SYwPHvWhqLR0cUhufMTW3e2pup9TcgeNdNLWWDg6pTc6Ymtc9Na9Tat7AGV00tZYODqnd_Kf_9x_MSOpNWWh5RHzr5mH1Hcv0UTafuS63KpH3qkxqTFMual29kEptml3aFGHRbFUGX4qpVcyOxPS1mNnJLWjXqvbsYu8U3yOr-NpOvj6FPLaKJ3by5BTyjX1Ww5ZnYn9kr9nx_t2fAAAA__86PDpa

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT DISTINCT a, b FROM data WHERE (a + b + c::INT) = 27 ORDER BY b,a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lVGL2kAUhd_7Ky73SclInElcdaCQds3SgNVtFNqy5GFMhm0gm9jJCC3ify8xxV2XOsmi9fHOzJnv3JPLZIvlzww5Lvypf7uEjcrgLpx_hgf_2_30QzCDziRYLBdfpl34e6Sqg9ntEgSBVX04EVrA109-6EOnI8CCVRcsiDkPZstRF94DG8I8nPghfPwOKwIiQoJ5kciZeJIl8gekSJAhQQcJukhwgBHBtSpiWZaFqo5s94Ig-YW8TzDN1xtdLUcE40JJ5FvUqc4kclyKVSZDKRKp7D4STKQWabbHrFX6JNRvrzKMBBdrkZccejYFkSdAodA_pEKCd2mmpeLQ6XgULPBY1Y_nvGyI1wUSnG80B48Sj2G0I1hs9LO3UotHiZzuSHv_k7TUaR5re3BsvkYQnKtEKpk0MdlJ5jOqqK865qS5JmmukaBHLeIxC6OdySbtn-XTeUs2i0JpqWxKXyGZRTxqnWS4Rwzafn5om_mxac9mV52ghg4On-bmghPE2qfGWqXGerZz1dQaOjikNrxgak771JxWqTk9271qag0dHFIbXTA1t31qbqvU3J49uGpqDR0cUhv_pzf-H8xQlusiL-UR8dTN_erJl8mjrH8YZbFRsbxXRbzH1OV8r9svJLLU9S6tiyCvtyqDL8XUKGZHYvpazIxix0x2zLaZWe0a1QOzeHBO0zdG8dBMHp5DHhnFYzN5fA6ZNsxY05C9bcqi3bs_AQAA__-wzW6J

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, d, sum(a+c::INT) + avg(b+d) FROM data GROUP BY c, d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUl0tv2kAUhff9FaO7AjHIzNjm4ZXTNK2QiEl5SI0iFE3wlCCBTW1TNYr475UxCRgnc414CFYxho97fc6Zo_AK4Z8JWNC9ad1c98g8mJDvnfYtebj5dde6ajqk8K3Z7XV_topk9ZEhJS4l4XxaEKREhpbVdHr1IikR8XdUeCIl4haTr3BFJMiPTrt_R77eL7EBUPB8VzpiKkOwHoABBQ4UdKBgAAUTBhRmgT-UYegH8Udel0DT_QdWhcLYm82j-PaAwtAPJFivEI2jiQQLeuJpIjtSuDLQKkDBlZEYT5ZjZsF4KoIXO94IKHRnwgstUtYYEZ5LGPGjZxkAhY70XBlYxGYlW08ejBKbl2yDElunxDZgsKDgz6P1GmEkRhIstqD5V70ajQI5EpEfaGZ6U1undizElXP_6LR7j06_1SrYejFzy4hvdfu3BZu9X_H46rrdd3rL6_Sq6-lPL-RZhM9bgxm1OQwW6yfinz7R-qvmnh-4MpBu-st-T3wRUVcOx1Mxyfwde1EySCELq3y03rYILKsLf1dDf7960-qxGStjFlNOxwa_uavZ5qcG67sY7Phlf6axLXOzQ0uKRBkH1v9jzZNNeVruz1YyUyux_OeR5TmPGitr_FgnEll2I3rVCzmR7MQnkp33iUQMXp3I6uFOJM8ff54r_rys6ceKP7Lshs-1C4k_P3H8-XnHHzF4Ff_a4eKv54-_niv-elkzjhV_ZNkNn-sXEn_9xPHXzzv-iMGr-NcPF38jf_yNXPE3ypp5rPgjy2743LiQ-Bsnjr9x3vFHDF7Fv3GcnyMfDOzIcOZ7ocz1q6ISiy_dkUzMDP15MJR3gT9cjkletpfc8oYrwyh5lyUvml7yVrzgJsy2YbYJ8xTMdoNr-8CM7UWbe9ENNc2VgutqwXUlbKgnG0qYI16bSrqqhqv7BEUNI0FRw1hQEBoJCkIjQakpBa-rBa_vE5SGuhMqSClkKmWnVlDTWC2oabQXEBwrBgRHDGeZYknrzhHd1c2CeM7U1cIMZHimXHYyXU1jpqtp1HQEx0xHcMx0da8ypFhZpmN2Ml3dMQwpGZZpmZ1MV9OY6WoaNR3BMdMRHDNd3bAcaViu_qdt2_TB4sv_AAAA__8rKlaE

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, d, sum(a+c::INT) + avg(b+d) FROM data GROUP BY c, d ORDER BY c, d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUV11v4kYUfe-vGN0nkAeZmbHz4adJd9MKiYUUiNTVCkUTPCVIBNOxqbqK8t8rYyfBpplrNEFJnmImHJ_je885Mg-Q_r2ECMaX_csvE7IxS_LbaPiN_Lj886p_0RuQ1tfeeDL-o98m5VdmlMSUpJv7liIemUVRbzA5axOPqH_mrVvikbhd3CJWmSK_j4bXV-TX71sYGY6-Xo6ePk2BwiqJ9UDd6xSiH8CAAgcKAigEQCGEKYW1SWY6TROTf-VhC-jF_0LUpbBYrTdZfjylMEuMhugBskW21BDBRN0u9UirWBu_CxRinanFckuzNot7ZX7KXB9QGK_VKo1Ix2dErWLCSJLdaQMURnoVaxMRyTwpisekRHJPBpRIQYkMYPpIIdlkLzLSTM01ROyRNpc6TkymjR9WVUrhURl4r1LwQygu5nOj5ypLjM-6dR4q82EPTayNjiPydHAx-H4zGE5uBtf9fkuK9t5RkB-Nr7-1JHu-4vnVl-H1YLK9rop_0XP7k9yp9K6mhFHJYfr48ozi1Wd8uVVS6K7e6q9lojIa69niXi33_i5WGVCQzKOSewWhbWD1xWxl7g6sPKhOh-0PjD-PSTxfPQ3xppePLGxXfJfb7clrvgxf9UJwiBcGSSdZ-7xmg31Sz-Lv8E0Xgy2jVFzdw2vSTirSWPOWYE1awmcdnx-rJxCxZU-cuPQEQrFre_ZZe4K9U0_UF_PRewLxQpk69nY9wZuHkTcKI-_44lhhRMSWYTx1CSNCsest_lnDyN8pjPXFfPQwIl4ow8jfLoyieRhFozCKjh8cK4yI2DKMZy5hRCh2vSU-axjFO4WxvpiPHkbEC2UYxduFMWgexqBRGIOOHx4rjIjYMoznLmFEKHa9FXzWMAbvFMb6Yj56GBEvlGEMjvNz9n8IRzpdJ6tUN_o12s23oeO5LracJhsz01cmmW1pio_DLW57EOs0K_7Lig-9VfGvXOAumFnB3A7mdTDbBYsKmB0GPncBs8AJ7cTNEW5hHXhgH3hgBYd25tC-6hM79YkVfWoHn1rBZ3bwmYvL7GBk03Yw5jIE7cSNuezc3gldpBTslYL4jNk7hSGlwvbyVYULBL4XsEPsgqCRnSFozDAY3I0dswyzlwsLkbnb6wXzjL1eGNIvzF4wDGkY5lQxCBrbmlvJYHA3dtQz9p7hSM9wp57hyLsL9vJi7xmO9Ax36hkEjb2BuPUMBndjxzzD7T3DkZ7hh_XM9PGX_wIAAP__qBuUKA==

# There should be no "by hash" routers if there is a single stream.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, d, sum(a+c::INT) + avg(b+d) FROM data WHERE a > 9 GROUP BY c, d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkm-Pk0AQxt_7KSbzioa9lD810X21VetJwtEKVL2c5LLHTkgTyuIuGE3T724AE68a0Xs5z8zz8BtmT2i_1Mgx28Sb1zn0poa36fYG7jafdvE6SsB5E2V59j5ewM-RkoFiYPujI8GFkvMoyV8swAX5tXIewAW1mCKU7CR8fLdJNyDhc-95IcFLuE63-x28uh1zCmTYaEWJPJJFfoc-MnyOBcPW6JKs1WaQT-NQpL4h9xgemrbvBrlgWGpDyE_YHbqakGOir3S7DJChok4e6nHszFD33S-T7WRFyMMzexTszwfn8qGmlKQis_Qu4rE1h6M038WwLzLMWtlYDkvfu0KGKTWKDAfhuyKc_hUDEbhixUCEDMQK_8bnP4VvXVWGKtlps_Qv8UTIxAoZrpPb-2Sb3yf7OHZEuPhDWg1Str9xhD82P1w7Ilhc7DCgD9zuDHZwgf2Pe6VkW91Y-q-DeeeCIamKpjdhdW9K2hldjp-Zyu3oGwVFtpu64VREzdQaAB-b_VlzMG8OZs3eb-bi_OxHAAAA___etg9r

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), sum(b), sum(c) FROM data GROUP BY d HAVING sum(a+b) > 10]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUl19v2joYxu_Pp7DeK1CNEscJbXMVTkt7kGjoATqt6lBliEeRQsycRFpV8d2nJF3509VOlSHgynaSX_zkfR6_gheIf4TgwqDdbV8MUSpDdNXv3aCH9tfbbqvjo9plZzAc_N-to9dH4nReY3Wcj-PXcVIvqIAlDF33e3e36N97FKD_Wl86_nWBoBM0rqNvqWlSjog5AgyRCLjP5jwG9wEIYLAAAwUMNmBwYIRhIcWEx7GQ2SMvOdAJfoJrYphFizTJLo8wTITk4L5AMktCDi4M2Tjkfc4CLg0TMAQ8YbMw32YhZ3Mmn71MKmAYLFgUu6hhEMSiABEkkicuAUOfRwGXLvLIiWdh5BGM8pFi5NkwWmIQabJSECdsysElS1xeZWs6lXzKEiENZ1Okl61b_v2j3xs--nfdbs1z6pnau5uaZ73N6NvMfpuR-pa41X7jZ_TE4qetrQiMlqsPsD78gNV70kjIgEsebL4p4JPZnIV4e_weCpb8XhWbKSpBzHf6tktBSpYiL9nVLExyH51V9lzXvWxfdG5aXcDQSxM3s9ajWGEs_Xt1yevx5zr4oiEWBtlMw0eS7A1JpPyJIGVOhEEahrWDM6HRuZaE5mGeCbKHM0GO4ExY5QNolQqg1TDoDgKo0blW9tPDDKC1hwBaRxBAWj6AtFQAacOwdxBAjc61sp8dZgDpHgJIjyCAdvkA2qUCaDcMZwcB1OhcK_v5YQbQ3kMA7SMIoOb_Rp_HCxHFvNSvSzMrCA-mvChyLFI54bdSTPJtimUv5_ILAY-T4i4pFp2ouJUJXIfJNkzWYWsDJp-Dm1Xg8yowqaSbOGraUtabqmGqNqupdstW0o4adqpYrYY1VqthjdVqWGe1htZY3axi9akSPlObdVbFLDWsMUsNa8xSwzqzNLTGrPMqZhFNF9W10Wp9tFojrdZJK7bSar2UVGqmRNNNbY1p79rpp0xT0zrT1LTONDWtNU2D60x711SVpo2W__wKAAD__2n_McE=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT avg(a+b), c FROM data GROUP BY c, d HAVING c = d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlm9r4koUxt_fTzGcV0pH4mSibQOFeHvbXsHGrn-WLUXKNDNrhTTjTuKypfjdl2h3jUpnUgYlrxwn82Sec34Ph7xB-iMGH4ZXvavLEVqoGF0P-rfo4erbXa_TDVHtv-5wNPzSq6P3I-zntMbQCXqqYxStD3OWMXQz6I_v0L_3KMKIo_87X7vhDYrQBeITwJBILkL2IlLwH4AABhcwUMDgAYYWTDDMlYxEmkqVH3lbCbr8F_hNDLNkvsjy7QmGSCoB_htksywW4MOIPcViIBgXymkCBi4yNotX18zV7IWp1yC3BxiGc5akPmo4BLGEI4Jk9iwUYLiexZlQPgooukBBbmggEr7aISeBi1FAcb4_WWKQi2zjJc3YVIBPlri83850qsSUZVI5rW27Qd6OTnj_GPZHj-G416sFtJ77Ht_WApKvLvvjcPS-3j7o1nfcbS58ekXPLH3euYvAZLmpwP2wgs17FolUXCjBt9_ERTR7YTH-8ztLMvw9lixbX6ApnzT3PO2WRf7W776vHrt5B-h-B7x6kZvrGJhR-4o1VYayIecO2Qb8kRVvywopH3dSJu4OaTjuQQNvcFwg3q5o4MmRAk8qE3i3fMrcUilzGw49aMoMjgttPq1oytwjpcytTMpo-ZTRUimjDcc7aMoMjgttPqtoyuiRUkYrkzKvfMq8UinzGk7roCkzOC60-byiKfOOlDKvMikzfNYPRDqXSSpKffE187IFn4p1-1K5UJG4UzJaXbP-21_pVhtcpNn6KVn_6SbrR7nBopjsiklR7G6JyefEbRvxuY2YWPkmLb3a1fab6sVUD6utp-Vp1S29uGWDWi82oNaLDaj1YhNqg9qAum2D-lQrPtPDOrOBpRcbYOnFBlh6sQmWQW2AdW4DiximqGmM2s1Ru0FqN0ktR6ndLCVWw5QYpqlngLY3Tj8FTa82QdOrTdD0aiM0g9wEbW-oaqFNlv_8DgAA__8lrQyF

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a+b), sum(a+b) FILTER (WHERE a < d), sum(a+b) FILTER (WHERE a = c) FROM data GROUP BY d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMltFv2joUxt_vX2GdJ1CNgu1A20iV0nsv3ZAodIFqqzpUubFFkSBhTiKtqvjfp5CtBNraqTwoT5gkv5zvnO_TUZ4g-TEDD4adXue_EcrUDF0Eg0t02_l21Tvv9lHt_-5wNPzSq6PfjyTZvMbREbqv49IZXXR7o06Aal8_d4IO4uh71myyEAn9U2corBcFBU85-hQMrq_QvzdIjAFDFAvZ53OZgHcLBDBQwMAAgwsYWjDGsFBxKJMkVvkjTyugK36C18QwjRZZml8eYwhjJcF7gnSaziR4MOL3MxlILqRymoBByJRPZ6syCzWdc_Xo53IAw3DBo8RDDYcgHglEUJw-SAUYAhkJqTzkkyOfYuSTol_fzc9nPsPId2G8xBBn6VpIkvKJBI8scXWx55OJkhOexsppbWr18zmc92_u-oPRXf-616v5bj0XfX1Z80np9GfsPn3lGtuSua58_4geePKwVZTAeLluhb7Zyvo9WRQrIZUUm28SMpzO-Qy_8VuU0UyDNF8o2x7Hegj0-cSeT6thDbLUQz7FPsMax9hfb_P19vpxI144ZNPot0S5G6JI9cyTKpl3SMOhu0u9QW7J5_ahp57sNfXko1JPqweMVgoYbThsdwEzyC2N9PjQA0b3GjD6UQFj1QPGKgWMNRx3dwEzyC2N9OTQA8b2GjD2UQFzqwfMrRQwt-G0dhcwg9zSSE8PPWDuXgPmHsKH4SsaA5ks4iiRlb7umnmXUkxkMbMkzlQor1QcrsoUfwcrbnVByCQt7pLiTzcqbuUCyzDZhkkZphsweR_ctoFPbWBipZu09DTVzpvpYaY3q613y9XSLT3csrFaDxus1sMGq_WwyWoDbbC6bWP1sRY-0Zt1YmOWHjaYpYcNZulhk1kG2mDWqY1ZxLBFTWvUbo_aLVK7TWq5Su12KbFapsSwTV2DaS_W6btM09Mm0_S0yTQ9bTTNgJtMe7FUtaaNl__8CgAA__8YjhC4

# Same query but restricted to a single range; no local aggregation stage.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a+b), sum(a+b) FILTER (WHERE a < d), sum(a+b) FILTER (WHERE a = c) FROM data WHERE a = 1 GROUP BY d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUktGLm0AQxt_7VwzzlHB7xNU8CQd7bb1W8DQ1hva4yrHnDhIwrt1doSXkfy9qyyWlte3b7LffN_PT2SPaLw2GuI2S6E0BvWngLs_u4TH6tElu4xQWb-Ntsf2QLOGHxfaHhYQreF6ysxru4qSIclh8fB_lEUj43HteUIGad91AtZwGKukkvMgc3uXZbgOvH0CVyLDVilJ5IIvhI3Jk6GPJsDO6Imu1GeTjaIrVVww9hvu2690glwwrbQjDI7q9awhDTPW17lY-MlTk5L4ZbSeGuncvIetkTRgGJ3bWmM83LuRzQzlJRWblXbTHzuwP0nwTw3ciw20nWxvCil-PHDm1ikwIgl8Jn4Hg0-8T66G-EQEDscY_IfL_Qbyta0O1dNqs-CWhWCPD2_ThKc2Kp3SXJAuxXg6ou_uF4GfVzy0K_zdagAyz3oUgfCYCNoPtX2D_ZWU52U63lv5pZ96pZEiqpulZWN2bijZGV-OY6ZiNuVFQZN10G0yHuJ2uBsDzMJ8N-_Nhfzbs_RIuT6--BwAA__8RpBmb

# Verify the XOR execution plan
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT xor_agg(to_hex(a)::bytes) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslF1v2jAUhu_3K6xzBZJRcBIo9VXZxiokVjrgolMVIRcfpUg0ZraRqBD_fUrSqUk1nFTJZT5eP6-fY_kE5s8OOCwns8m3FTnoHfmxmP8kj5OH-9l4ekc636fL1fLXrEvefjkqvRZx3LFq_YzHjuhy_vX3arLs5kEprIiAQqIk3okXNMAfgQEFHygEQCEECgOIKOy12qAxSqe_nLLAVB6B9ylsk_3Bpq8jChulEfgJ7NbuEDisxNMOFygkaq8PFCRasd1lmL3evgj9epN2AArLvUgMJz2PEZFIwoiyz6iBwgITiZqTty3csH97gOhMQR3sO91YESNwdqb1G47jWGMsrNLeoFzwYb5Yj29vU-JFlH8R9U44JEpL1CjLyz-9WjQQnd2dWP_zpYJSKVZ_QqzOhDzW8_yWZ1TRseBj2HRGfn0dfi0dfs8LWtZR0bGg46qpjqC-jqCWjqDnhS3rqOhY0DFqqiOsryOspSPseYOWdVR0LOi4bvNC-w9qgWavEoMlzKWV--lNhzLG_HY06qA3eK_VJsPkj_Msl72QaGz-leUP0yT_lBYshpkz7JfC7GPYd5Mr0IEzHbrDYZPeA2d46CYPm5CvnOGRmzxqQr52z6pfcUzch-wjOzp_-RsAAP__RIUOjw==

# Verify the XOR execution plan
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT xor_agg(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslEFr2zAYhu_7FeI7JaDgyHbS1KeELSuBrOmSHArFFC368Ayu5UkydIT892F7ULsssod6tKVXz_vwCZ1B_8oggsN6u_58JKXKyNf97ht5Wj8-bFebezL6sjkcD9-3Y_J3y6tUzzxJRnzc7BTc8Bgo5FLgPX9BDdETMKDgA4UAKIRAYQYxhULJE2otVbXlXAc24hWiKYU0L0pT_Y4pnKRCiM5gUpMhRHDkPzLcIxeovClQEGh4mtWYQqUvXP1eVh2AwqHguY7IxGOE54IwIs1PVEBhV5qILBnEFwqyNG8sbXiCELELHd5nlSQKE26k8mbdOo-7_fPq7m60ZOOrKP8q6o1Q5lIJVCi6x6e5gfhib8Sm_18p6FRiw6fBhkzDYxPPd5pHT6OW_dx1Hv5weX-QvD_xAif5nkYt-RtX-WC4fDBIPph4oZN8T6OW_MJVPhwuHw6SDyfezEm-p1FL_vYjn6F_oPaoC5lr7GCunTytXigUCTZvmpalOuGDkqca03zu6lz9Q6A2zSprPjZ5s1QVbIeZNex3wux92LeTe9CBNR3aw6FL75k1PLeT5y7kG2t4YScvXMi39llNe66J_ZK9Z8eXT38CAAD__6F-6uo=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT max(t.a), min(t.b), avg(t.c)  FROM (VALUES (1, 2, 3), (4, 5, 6), (7, 8, 0)) AS t(a, b, c) WHERE b > 3]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkF1r2zAUhu_3Kw7nSoJDajv7KLqK2dzNkKRdnHWFzheKfTAGxcokuRSC__uwPbZ10LHena_nfYTO6L8bVFhk6-z9Hnpn4Gp3vYH77O5mneZbEB_yYl98Xkv4eXLUjyIstCQ4tp0Ii4Mk0A-NCItKzqy4TddfsgJETJAQLCWBeE3whuDtWL4juCSIpIS0gABCExwIKglfP2W7DA7wrY-iJcOyRMLO1rzVR_ao7jHGkvDkbMXeWzeOztNBXj-iigjb7tSHcVwSVtYxqjOGNhhGhcZW2sCDNj17iC4iJKw56NZMyVetCewUrJJfdqVUvt1fYjkQ2j78TvZBN4wqHuj_7WnTOG50sO4ifmrepHdiFUsk3ORbsUrGKr39KFZL-aw6eYl6x_5kO89PtM8lR0NJyHXD8-d627uKb5ytJs3cXk_cNKjZh3kbz03ezavxgX_C8T_h5C-4HF79CAAA__8-tMoV

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT * FROM (VALUES (1, '222'), (2, '444')) t1(a,b) JOIN (VALUES (1, 100.0), (3, 32.0)) t2(a,b) ON t1.a = t2.a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyckUFr20AQhe_9FcNcLJXB3l35JAjItC51cK00Sksh6LCVpo5go3V3V6Vg9N-LpJTEpSlOb5qZ972nmT2i_24wxWK9Xb-5gc4ZeHedf4Db9Zer7Wqzg-jtprgpPm5jeJC8ngTR59X207qASBLMlFKzmCBSBLPlcjmLY1gVECREmuBrDJf54PSEkELMxUAkBImaiwdA_QbyHQQ513ABQc11iYStrXmn79ljeosSS8KDsxV7b93QOo6CTf0TU0HYtIcuDO2SsLKOMT1iaIJhTNHYShv4oU3HHsRCIGHNQTdm1PeEtguPtA96z5jKnv4zQS7kWQnq2YRH4661rmbH9YkjNm0gH1zT7rEcXM6Q11w199pg2f_l_99rf3dpm5bdQp2ihr-FKJPxhWv2d-MXEuZdSCGTlCnKEsqW-NyKyUuOeM3-YFvPZx1PDGtwvefpXt52ruIrZ6sxZirzkRsbNfswTdVUbNpxNL7yU1i-AFZ_wuqfcHICi77sX_0KAAD__9vyG7E=

statement ok
CREATE TABLE nullables (a INT, b INT, c INT, PRIMARY KEY (a))

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT array_agg(a) FROM (SELECT a FROM data WHERE b = 1 AND c = 1.0 AND d = 1.0 ORDER BY a)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlNFr2zAQxt_3V4h7spkyR7YzimBgr3E6Q5p0TmArxRQ1OjyDa2WSAish__uwna7LWDaXvOTNn-4-3_e7h9uC-V4Bh0UyTS6XZKMrMsnm1-Qu-XozjdMZccbpYrn4PHXJvkVoLZ7uRVE4wu16nedKJ6Wwgnz5lGQJcZwH8oEwl8SzMXFWzfe7obuXci_JPBsnGfl4S4SbA4VaSZyJRzTA74ABBR8oBEAhBAojyCmstVqhMUo3LdvWkMofwIcUynq9sc1zTmGlNALfgi1thcBhKR4qzFBI1N4QKEi0oqzaMWtdPgr9FDXZgcJiLWrDycBjRNSSMKLsN9RAYVJWFjUnjhP5TXzOeTpbXuyJoqBD4pxPpvN4efGMGoW_CuPkMr2Opy5QmG8sJxGDfEdBbexLcGNFgcDZjh6Be2FSWqJGeUhT1hYoROwt5Lu_7CEuCo2FsEp7o0NjnGXx7X18deVEzD2ayz_IxfovnfVZuscGnn8-a_f74_m98PyBF5wPXtAfL-iFFwy88Hzwwv54YS-8cOCNzgfvPwcvQ7NWtcEDsmN_HjanAmWB3YExaqNXeKPVqh3TyXnrax8kGttVWSfSui21AX83s3-a3x-Yh3-a_VMmB6eYw1PMo1eZ892bnwEAAP__ShNA1Q==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT json_agg(a) FROM (SELECT a FROM data WHERE b = 1 AND c = 1.0 AND d = 1.0 ORDER BY a)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlNGL00AQxt_9K5Z5SnBrukkqx4KQeM2dkV5zpgWVIxx73SFGctm6uwWl9H-XJNWzYjXSl77l25kv8_3mYbZgvtTAYZHMkssl2eiaXOXZDblLPtzO4nROnGm6WC7ezVyyb_lsVHMvytIRbt_q7Auil1JYQd6_SfKEOM4DeUWYS-L5lDir9vvF2N1LuZcky6dJTl5_JMItgEKjJM7FIxrgd8CAgg8UAqAQAoUJFBTWWq3QGKXblm1nSOVX4GMKVbPe2Pa5oLBSGoFvwVa2RuCwFA815igkam8MFCRaUdXdmLWuHoX-FrXZgcJiLRrDychjRDSSMKLsJ9RA4aqqLWpOHCfy2_ic83S-vNgTRUGPxDm_mmXx8uIHahT-LEyTy_QmnrlAIdtYTiIGxY6C2tin4MaKEoGzHT0C98SktESN8pCmaixQiNhzKHZ_2ENclhpLYZX2JofGt4tsfh9fXzsRc4_G8g9iseE7Z0N27rGR55_P1v3heP4gPH_kBeeDFwzHCwbhBSMvPB-8cDheOAgvHHmT88H7x73L0axVY_CA7Nifx-2lQFlif1-M2ugV3mq16sb0Mut83YNEY_sq60XadKUu4K9m9lfzywPz-Hezf8rk4BRzeIp58l_mYvfsewAAAP__R3VAKw==

# Test that orderings on GROUP BY columns are propagated through aggregations.
statement ok
CREATE TABLE sorted_data (a INT PRIMARY KEY, b INT, c FLOAT, INDEX foo(b))

# Split into ten parts.
statement ok
ALTER TABLE sorted_data SPLIT AT SELECT i FROM generate_series(1, 9) AS g(i)

# Relocate the ten parts to the five nodes.
statement ok
ALTER TABLE sorted_data EXPERIMENTAL_RELOCATE
  SELECT ARRAY[i%5+1], i FROM generate_series(0, 9) AS g(i)

# Verify data placement.
query TTTI colnames,rowsort
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW RANGES FROM TABLE sorted_data]
----
start_key  end_key  replicas  lease_holder
NULL       /1       {1}       1
/1         /2       {2}       2
/2         /3       {3}       3
/3         /4       {4}       4
/4         /5       {5}       5
/5         /6       {1}       1
/6         /7       {2}       2
/7         /8       {3}       3
/8         /9       {4}       4
/9         NULL     {5}       5

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT a, max(b) FROM sorted_data GROUP BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkVGrm0AQhd_7K5Z5UtgQNfRln7RtWgSjqRpICBI27lQCxrW7KwSC_72ohSaFeO99nJnzzTk7ewf9uwYG2Tpaf81Jp2ryPU025Ljeb6MgjIn1Lczy7Gdkk78STsmV36yzPQm1VAbFSXDDyY802W3JlwPhBVBopMCYX1EDO4ILFD5DQaFVskStpRra91EUihswh8KlaTsztAsKpVQI7A7mYmoEBrFcyHbpAQWBhl_qUdZTkJ35B2nDKwS26unDYnd-cc7PNabIBaql87QefknpPzwPKGQtbzQjC6CQdIYR36W-B69yuB_JEVSVwoobqZbucwx_qIP4cIqT_BTvosjyXRsobIK95Xv2S3vvyf6N-6aoW9lofNeBnb6ggKLC6Q-17FSJWyXL0WYqk5EbGwK1maarqQibaTQEfITdWdibh71Z2PkPLvpPfwIAAP__u9n0cA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT a, max(b) FROM sorted_data GROUP BY a ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlmFr4j4cx5__X0X4PVL-kZq0uq2P6t28Q3B2pw42hozMBie4xksibAzf-9H2wLrdkpZcD59p20_ybT5ffvQN1M8NhDAbjodf52gnN-jbNL5C98Pb6_FgNEGty9FsPvsxbqPfjzCMntlL67FdPKiE1Dx5SJhm6Ps0vrlGX-4QQ_H0cjjNfy4AQyoSPmHPXEF4DwQwUMDgA4YAMPRggWErxZIrJWT2yFsOjJIXCLsY1ul2p7PLCwxLITmEb6DXesMhhDl73PApZwmXXhcwJFyz9SbfZivXz0y-RqWAgGG2ZakKUccjiKUJIkjoJy4BQ7zTIYoIjigs9hjETh92VZqtOIRkj6snG6xWkq-YFtLrHQeLsgOIZcIlT7ItAcNgcvcwiecPk5vxuBWRNmC4Gty2Itp-F-aw_uMremLq6cPSi_0hMP008GEdUQQ5XmedarxONWCIyP_Fkob3I92_94KH8H6D4SeiI7YeORbzWZDgKAipXkhSo5Ae6XjUtZKWbCVl_dOoJGmskqT5StLqTaB1mkA7nu_aBEu20kmdnUYTaGNNoM03wa_eBL9OE_yOF7g2wZKtdFLnp9EEv7Em-M03IajehKBOE4KO13NtgiVb6aQuTqMJQWNNCP7tB8sf0ky52opU8UpfIN3sfXiy4sVJKLGTS34txTLfpvgb51x-IeFKF3dJ8WeUFreygGWYvIdJGaZHMKkH913gCxeYOOUmPTNNjeftm2HfLKtvthUY6Z4Z7rmoNsMW1WbYotoM21RbaIvqvovqMyN8bpZ17iLLDFtkmWGLLDNsk2WhLbIuXGQRyxS1jVG3Oeo2SN0mqeModZulxGmYEss0DSzSPozTWtLMtE2ambZJM9NWaRbcJu3DUDVKW-z_-xUAAP__t8WSOA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, min(b), a FROM sorted_data GROUP BY a, c]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlkFv2jAUx-_7FNY7gWYUnATa5pRu6yYkGjqg0qoKVS7xKBKNmWOkVRXffSKpRCjUL8FDyoFDiH_2e_799ZRXSP8sIIDRVf_q65is1IJ8Hw6uyf3Vr5v-ZS8ijW-90Xj0s98kb0umlDzPk8ZjkxKer02l0iJ-iLnm5MdwcHtDvtwRTsl0AhQSGYuIP4sUgntgQMEFCh5Q8IFCByYUlkpORZpKtVnymgG9-C8EbQrzZLnSm78nFKZSCQheQc_1QkAAY_64EEPBY6GcNlCIhebzRXbMUs2fuXoJC4UBhdGSJ2lAWg4jPIkJI1I_CQWTNQW50tuDUs1nAgK2puWLuZzNlJhxLZXT2a0l3PQ8ULFQIg5I9nQZ3T1Eg_FDdNvvN0LWBArXvagRus29l17zXX3bIx9fyBNPn_ZOm6y3Pbgf9rDdR-a17e4zTzTd_H4vJNdAIWSf840NjbP2f-6cwmClAxJ6NHRp1tlhU16JLlfJwT6z_uhbt4c7jGRLLh22q_WjUvydUlj5BLMKCXZYy3GPyDBSTkFlt7YZZifOMKtFht3ywXGrBMdtOd4RwUHKKdzfWW2D4544OG4tguOVD45XJThey_GPCA5STuH-zmsbHO_EwfFqERy_fHD8KsHxW07niOAg5RTu76K2wfFPHBy_FsFBPoyHIl3KJBWlvp7am5ZFPBP5laVypabiRslpdkz-OMi47I9YpDp_y_KHXpK_2hRYhNl7mBVhdwdm1eCuDXxhAzOrulnHTLvG-_bMsGeW1TXb8o10xwx3bFSbYUS1GUZUm2FMNUIjqrs2qs-M8LlZ1rmNLDOMyDLDiCwzjMlCaETWhY0shkxRbIzazVG7QWo3SS1Hqd0sZVbDlCHT1Eek7Y3TStLMNCbNTGPSzDQqDcExaXtD1Shtsv70LwAA__-pG9Ni

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, min(b), a FROM sorted_data GROUP BY a, c ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlkFv2jAUx-_7FNY7gWYUHAfa5pRuZRMSTTqg0qoKVS7xKBKNmW2kVRXffUpSiVBWG_CQcuBgkp_9nn9_PeUV1O8FhDDqDXpfx2glF-jbMLlG972fN4PLfowaV_3RePRj0ERvr0wxep5njccmRqx8VwmpefqQMs3Q92Fye4O-3CGG0RQlw6vesFhNAEMmUh6zZ64gvAcCGHzAQAFDABg6MMGwlGLKlRIyf-W1APrpHwjbGObZcqXzvycYpkJyCF9Bz_WCQwhj9rjgQ85SLr02YEi5ZvNFccxSzp-ZfIkqNQKG0ZJlKkQtjyCWpYggoZ-4hMkag1jpzUFKsxmHkKzx_sVczmaSz5gW0uts1xLlPScy5ZKnISpWl_HdQ5yMH-LbwaARkSZguO7Hjchv7jykzXf1bY58fEFPTD3tnDZZb3rwP-xhs48oa9veZ55pnP9-LQTTgCEin8uNDY2T9n_uHEOy0iGKKI58XHT2b1P02C6L7vBbr3mX9IMuY9ESS49sq_2onGCrHLJ_iskBKfZIy_OPyLGlnIrObm1zTE6cY1KLHPv7B8c_JDh-y6NHBMdSTuX-zmobHP_EwfFrERy6f3DoIcGhLS84IjiWcir3d17b4NATB4fWIjjB_sEJDglO0PI6RwTHUk7l_i5qG5zgxMEJahEcy8fxkKulyBTf6-upnbfM0xkvr0yJlZzyGymmxTHlMim44o-UK10-JeWin5WP8gKrMHkPkyrsb8HkMLjrAl-4wMSpbtIx077xvqkZpmZZXbOtwEh3zHDHRbUZtqg2wxbVZtim2kJbVHddVJ8Z4XOzrHMXWWbYIssMW2SZYZssC22RdeEii1imqG2Mus1Rt0HqNkkdR6nbLCVOw5RYpmlgkbYzTg-SZqZt0sy0TZqZtkqz4DZpO0PVKG2y_vQ3AAD__z2x1mU=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT b, max(c) FROM sorted_data@foo GROUP BY b]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUklFr2zAQx9_3KcT_KQGVxHb34idnWzYyXDtLUmgpJijW1RgcnyfJ0BHy3UfswpJCvPZRp_vd_ydOB9jfFUKs5_H860a0phLfV-mdeJo_LOPZIhGjb4v1Zv0rHovXlp0Ue_Uyysd9o2XjSG-1cip6ZhY_Vun9Unx5FLsMEjVrStSeLMIneJD4jEyiMZyTtWxO5UPXtNAvCKcSZd207lTOJHI2hPAAV7qKECLhG24mASQ0OVVWXdtRglv3D7JOFYTw9ijPBnvDgzdqV9GKlCYzmV6MxzNzdPZESKwbVdtQ3EAibV0oIg_XJLyPSPzksn518C4dGlPulfnzxqMP92UUXM33P5I_KwpDhXJsJv5lfnTySY0mQ7p7r8Qsedwm6Wab3MfxKPLGkLibPYwif3xVJriQ-c-qV2Qbri29a9fTYyZBuqD-O1luTU5Lw3kX0x_TjusKmqzrb2_7w6Lur06C57A3CPvDsD8IB8NwMAhP38DZ8dPfAAAA__-h7zgW

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT * FROM (SELECT a, max(c) FROM sorted_data GROUP BY a) JOIN (SELECT b, min(c) FROM sorted_data@foo GROUP BY b) ON a = b]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMl1Fv4jgQx9_vU1jzBLdGwU6gFGml9O56J1YUem1X2tUKVYa4FInGnBOkXVX97idITySkeOIabvO2CfnZM8nvv1M_Q_LPEvpwezm8_P2OrPWS_HkzviLfLr9cDy8GI9L4Y3B7d_v3sEleH_k1e6DxeikoeRLfG7NmdjtROpXRfSRSQf66GX--Jr99JaJJPo03a70yU0qeFvFbTPig1I6bNsl4RAT5SKYToBCrSI7Ek0yg_w0YUOBAwQcKAVDowITCSquZTBKlN488b4FB9B36bQqLeLVON7cnFGZKS-g_Q7pIlxL6cCemS3kjRSS11wYKkUzFYrndZqUXT0L_CHM1AoXblYiTPml5jIg4Ioyo9FFqoDBep30SMhr6MHmhoNbpbtckFXMJffZCq1d2MZ9rORep0l6nWFi4eQFjHUkto82WQOFi9PV-NL67H30eDhshawKFq4svjZA394rZrT_9QR5F8lhaevKyK5gfLHi3jsoKKa6ziFP6sFQiBQoh-5AtauiQtX9Wi_7xWqQ7Yh0jzJsv5ErqufykFrHUHusV0aV8SBsh-9D8qBfzx-yfees4DX0aBgfdO6vQJ1Y1ReofqZZaedwv4IcK6hUKYtVjyixi6rGWx12DitSW07hbj6CyEwaV1SOoTi0eN6jnpwwqr54LbpML3vJ811wgteWsOatHLvgJc8HrkQunFo-aC94-ZS786rnwbXLht7zANRdIbTlrevXIhX_CXPj1yIVTi8fNBTtlLoLquQhschG0vI5rLpDactac1yMXwQlzEdQjFxa-sL1j6INSB87GOzkOmhHYVLFJzn9FdKtYm-3OTWp23qkme9_fMoOR84frHs_N4_6Hxv-vk-obhdzIZKXiRFY6crY3rchoLrOXlqi1nslrrWbbbbLL8Zbb3ohkkma_suxiEGc_bQrMw2wfZnmYF2BmB5-5wIw50R0n-txMcyPtu8A9F5ghnwuhuy40R9r2jZIGZjgwwjwwK94x0l0z3HXJhxlG8mGGsXwgNJIPhEbyceaSDzOM5MMMY_lAaCQfZhrLR88lH-fmCdBGRkBpgFjNADONDQEzjU4BBMfGAIIjnjPzGEG-OEIjpiM0pjqGI64jOCY7K80SG9uZeZYwZByw0jSx0t1MY7qbaVR3BMd0R3BM99IgtdLdTGO6m2lUdwTHdDfjqO6lcWqle2mwFHXvIbqXJouV7mYa091Mo7ojOKY7gmO6l6aqle5mGtPdTKO6IzimuxnHdOfmAylHTqS8NFuKOEdwm9MZt6R7TvTeZ7PGu044x1q3O6JNXn75NwAA___fpYXF

# Verify that the stages preserve the ordering as expected.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(x) FROM (SELECT a, b::float + c AS x FROM data) GROUP BY a ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMllFv2jAUhd_3K6z7BKpRsBMozVPYSickSrpApVUVqlziUSQaM8dIrar-9ylJN0JZ7XQujDdi_Nnn3nN05SdIfy7Ah1Fv0PsyRiu5QGdReI6ue98vBt3-ENVO-6Px6Nugjl62pKv72kO92FV7WWMY3fr-2SDsjjvoCE1Rd4Qeii0xU6yOvkbh5QX6fIUYCqPTXpT_nACGRMR8yO55Cv41EMBAAYMLGDzA0IIJhqUUU56mQmZbnnKgHz-A38QwT5YrlS1PMEyF5OA_gZqrBQcfxux2wSPOYi6dJmCIuWLzRX7NUs7vmXwMMmmAYbRkSeqjhkMQS2JEkVB3XKaAIeJJzKWPAvcooL_rwyggMHnGIFZqfX2q2IyDT55xdYnd2UzyGVNCOq1NhUHWhVDGXPLYR_lXd3h1MwzHN8PLwaAW0Hom_PK8FpD6KzHr828f0R1L714dnYlfC6ZvCl6fIwohm-fME4V_LARTgCEgR8WhmgpJc0tHuUSyVSL5U2JebLhSWSewpvnuv9aS14HnSV4LfaOWoWiIpUM2nXpLirchhVSPKqkSVYc0HJqHlRRh_YCsGjSWnGwfRlbJDrNK9pxVWj0gtFJAaMNxPzggBo2l9h0fRkDoDgNC9xwQt3pA3EoBcRuO98EBMWgsta9zGAFxdxgQd88B8aoHxKsUEK-RP0psQ2HQVWrZyWGEwtthKLz_-AT6i7SIp0uRpLzSi6aZFcfjGS8ak4qVnPILKab5NcVnmHP5QsxTVfxLio9-UvyVCSzD5DVMyjDdgMn74LYNfGIDEyvdpKWnqbbfrh529Wa19W55Wrqlh1s2Vuthg9V62GC1HjZZbaANVrdtrD7Wwh29WR0bs_SwwSw9bDBLD5vMMtAGs05szCKGKWoao3Zz1G6Q2k1Sy1FqN0uJ1TAlhmnqGUzbGqfvMk1Pm0zT0ybT9LTRNANuMm1rqGpNmzx_-hUAAP__ggaubg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(x) FROM (SELECT a, b::float + c AS x FROM data) WHERE a > x GROUP BY a ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll9v6kYQxd_7KVbzBMois2vzz0-mDWmRCE4NURulKNrgLUEiNl0biSjKd6_sTS7_bnbMBXJ5A9s_z5k9Z0Z-heS_Gbgw6PQ6vw3JQs3IVeBfk_vO3ze9drdPSpfdwXDwZ69M3h9JFs-lZVk_VXq_Jih5dN2rnt8eNskFGZP2gCz1I6FIRZn89Ucn6BBB_llUq7YkS_J74N_ekF_viCB-cNkJ8p8joBDFoeyLZ5mAew8MKHCgYAMFByjUYERhruKxTJJYZY-85kA3XIJbpTCN5os0uzyiMI6VBPcV0mk6k-DCUDzOZCBFKJVVBQqhTMV0lpeZq-mzUC9ephUoDOYiSlxSsRgRUUg4idMnqRKgEMgolMolnn3h8Y-GKfEYjN4oxIt0VT5JxUSCy95ocYn9uBLPrdqmuKvpLM1r8o_TM5Tj-5RrTyZKTkQaK4ttnYiXnbqvQqlkmJUGCu3-3UPfHz70b3u9ksfL2UHdXpc8Vt5Ssyrw-EKeRPK09epM_Uqx_ani1XtiLWTzPdMopf_OYpECBY9d6JeaWqzt6Fhvke20yL61mDfrL9LsJKjh9J0f7SXvg06jvBf-SS86HXzTqc-k1DaksOKjwYqMhsUqFs-Hg-nhOMJsIBp19_WjzQZSbj047Dxmg51wNupfPBu8eCB5oUDyimUfOZCIRh3IxtECiZRbd4ufRyD5CQPZ-OJA2sUDaRcKpF2xnCMHEtGoA9k8WiCRcutu2ecRSPuEgWx-cSCd4oF0CgXSqeRfloeGENGlQ9g6WgiRcusOOecRQueEIWz9xE_Y70gLZDKPo0QW-iKtZs3JcCL1wSTxQo3ljYrHeRn918-5_EIok1TfZfpPN9K3MoHrMDPC3AzzbZitw_YGzPaDm4fAjB9E1w-hedVM28YDd8ywY3YL8bpmpOtmuG6EG2a4cUhQzDASFDOMBQWhkaCYaSwozUOC0jLvhCqyFJCVgu2UnaWyj90IjfiN0JjhGI44juCY5WxntezjOTOvFuYgrpmXC6sh-M522ct0M42ZbqZR0xEcM92Mo6abNytm-s6S2XStibhm3jKsheA7e2Yv0800ZrqZRk1HcMx0M46Zzs0bdtv00dsv_wcAAP__2g3Mhw==

# Ensure that an interesting input ordering that causes an ordered group by
# forces an ordered synchronizer. We create an index on b even though it's
# not used to help the optimizer realize that there's an ordering available
# on b for a constrained scan on the a,b primary index.

statement ok
CREATE TABLE data2 (a INT, b INT, PRIMARY KEY (a, b), INDEX(b));
ALTER TABLE data2 SPLIT AT SELECT 1,i FROM generate_series(1, 9) AS g(i);
ALTER TABLE data2 EXPERIMENTAL_RELOCATE
  SELECT ARRAY[i%5+1], i FROM generate_series(0, 9) AS g(i);

# Verify data placement.
query TTTI colnames,rowsort
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW RANGES FROM TABLE data2]
----
start_key  end_key  replicas  lease_holder
NULL       /1/1     {2}       2
/1/1       /1/2     {5}       5
/1/2       /1/3     {5}       5
/1/3       /1/4     {5}       5
/1/4       /1/5     {5}       5
/1/5       /1/6     {5}       5
/1/6       /1/7     {5}       5
/1/7       /1/8     {5}       5
/1/8       /1/9     {5}       5
/1/9       NULL     {5}       5


query T
EXPLAIN (opt,verbose) SELECT b, count(*) FROM data2 WHERE a=1 GROUP BY b
----
group-by
 ├── columns: b:2 count:3
 ├── grouping columns: b:2
 ├── internal-ordering: +2 opt(1)
 ├── stats: [rows=9.5617925, distinct(2)=9.5617925, null(2)=0]
 ├── cost: 11.1156179
 ├── key: (2)
 ├── fd: (2)-->(3)
 ├── prune: (3)
 ├── scan data2
 │    ├── columns: a:1 b:2
 │    ├── constraint: /1/2: [/1 - /1]
 │    ├── stats: [rows=10, distinct(1)=1, null(1)=0, distinct(2)=9.5617925, null(2)=0]
 │    ├── cost: 10.81
 │    ├── key: (2)
 │    ├── fd: ()-->(1)
 │    ├── ordering: +2 opt(1) [actual: +2]
 │    ├── prune: (2)
 │    └── interesting orderings: (+1,+2) (+2,+1)
 └── aggregations
      └── count-rows

query TTTTT
EXPLAIN (verbose) SELECT b, count(*) FROM data2 WHERE a=1 GROUP BY b
----
·               distributed  true           ·           ·
·               vectorized   false          ·           ·
group           ·            ·              (b, count)  ·
 │              aggregate 0  b              ·           ·
 │              aggregate 1  count_rows()   ·           ·
 │              group by     b              ·           ·
 │              ordered      +b             ·           ·
 └── render     ·            ·              (b)         +b
      │         render 0     b              ·           ·
      └── scan  ·            ·              (a, b)      +b
·               table        data2@primary  ·           ·
·               spans        /1-/2          ·           ·

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT b, count(*) FROM data2 WHERE a=1 GROUP BY b];
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlF1r2zAUhu_3K8S5SjYVR8rHwDBw1mVbILUz26ErxQQlFq7BtTxJhpWS_z5sB2JnrZpsbPRSH8_R855j_AjqRwY2BLPF7DJEpczQZ9-7Qrez78vFdO6i3qd5EAbfFn20v7LBaCvKXPfe9purMdOMouuvM3-GGPqACPrie6sl-niDNhFgyEXMXXbPFdi3QAADBQxjiDAUUmy5UkJWR4_1xXn8E-wBhjQvSt1s61RnHGwocyFjLnkMGGKuWZrVFdNc4zTXEO0iDFshOdgHxhUXorAmHSLaYRCl3tePMCjNEg72aIdbDqTl8EThkG0y7nMWc2kNukKFTO-ZfHDqvgCGoGC5spFFLixiVfm9UtvIofCcCDlHZJokkidMC2nRrodTv9W0zEb1aurerF0vXLurxaLnkD5guPRWbrj2veug1z8yOjyyeUB3TN39Vr_u-d6aPmt9qGMcIAaHvHt6jK2Qoz8JGayu1nM37Dn0OOPBf9jxp6ePn5w4_uoDoGeP_wWRVmeGr2j89F-Nf_x_xj8wd93nqhC54if9VwZVJB4nvGmGEqXc8qUU2_qZZunVXL0Rc6Wb0_fNYp43R5VgGyZGmJphegyTNjzswOQ8eGKGh0btgRkeGeGxOfP4bzKb4RcyT87KHO3e_AoAAP__UflroA==

statement ok
CREATE TABLE uv (u INT PRIMARY KEY, v INT);
INSERT INTO uv SELECT x, x*10 FROM generate_series(2, 8) AS g(x);

# Regression test for #37211 (incorrect ordering between aggregator stages).
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(v) FROM data INNER LOOKUP JOIN uv ON (a=u) GROUP BY u ORDER BY u]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll1v-jYUxu_3KaxzBZpRsBPeIk1Ktz-b6GjCeJFWVahKiUWzQczyUq2q-t2nJFUJUHySIfhzR0h-9nP8POfIbxD9swITJv1h_5cpScIV-XXs3JGH_p-j4c3AJrVvg8l08sewTj4-iZJ17aWef-W5sUsGtt0fk6Hj_D4bkVtnYJPkhTg2qbnkJ5LUyW9jZzYiP9-ThDjjb_1x9nMOFALpCdtdiwjMB2BAgQMFHSgYQKEFcwqbUC5EFMkw_eQtAwbev2A2KfjBJonTv-cUFjIUYL5B7McrASZM3aeVGAvXE6HWBAqeiF1_lW2zCf21G75aqXKgMNm4QWSShsaIG3iEExk_izACCk4Sm8RiMH-nIJN4u1kUu0sBJnun5QXdSj_40NP6Wk_yAhSGUv6dbMhf0g-IDLLtP4VQi1NLPyqHV5Fzs1yGYunGMtTY3vlYqQdO6IlQeCbJnm7s-0fbmT7as-GwZvF6emyzu5ql1_fUbDd4eiXPbvS8t3R6mFvF-lHF23VkLmR3HT-IqScW_tpdAQWL_ZgvqyqydaCkWCQ7KJJ9FpmVm1vAqSIOxv-t5qMS6gdxWg0_Uo0tG3Kj8V23jolp7Yhh5ZuFlWkWjTU0nrULy9ulcrcgigrd0r5EtyByikFi19Et7Kzd0r5wt_DyAeWlAsobmn5SQBFFhYB2LhFQRE7RO34dAeVnDWjnwgHVywdULxVQvaEZJwUUUVQIaPcSAUXkFL3TryOg-lkD2r1wQI3yATVKBdRoZBfVaqFEVBRC2btEKBE5Rb-M6wilcdZQ9r7jJfgLaWMRbWQQiVI32mZanPCWIj-aSCbhQoxCuci2yR-djMv-8EQU529Z_jAI8lepwCLMlDBXw3wfZkVY34FZNbh7Csz4SXT7FJo31bSuPHBDDRtqtxCvW0q6rYbbSrijhjunBEUNI0FRw1hQEBoJiprGgtI9JSg99UxoIkMBGSnYTDkYKlXsRmjEb4TGDMdwxHEExyxnB6OliudMPVqYgbimHi6sheAH06WS6WoaM11No6YjOGa6GkdNV09WzPSDIbPrWhdxTT1lWA_BD-ZMJdPVNGa6mkZNR3DMdDWOmc7VE3bf9Pn7D_8FAAD__z-u6r8=
