# LogicTest: 5node-dist-opt

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

# Prevent the merge queue from immediately discarding our splits.
statement ok
SET CLUSTER SETTING kv.range_merge.queue_enabled = false;

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW EXPERIMENTAL_RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lc1vnDAQxe_9K6q51tXuGNgPTnvNJanS3ioOFI8ipA1GtpGSRvu_V4BQuqtkzIc58vF7b_zmSX6DSiu6z5_JQvobEARIEBCBgBgEJJAJqI0uyFpt2l964E69QLoVUFZ149rXmYBCG4L0DVzpzgQp_Mr_nOmRckVmswUBilxenjub2pTPuXk9vbz-BQEPjUu_nhCyiwDduHdF6_InghQvYp5rssRVTnH9qY0js8Gbc57w26f60Rz9JIT-u6w2igypj0Q_GOJef9f1Rl6f8TP7-Moexy8Nw1VlgusuXFU8rsMqce4qR-rv5urL8anJcLua4LoPtyuP65ClXCnLQX8_Vz8an1oUblcTXA_hduVxHbKMVspy0D_M1Y_HpxaH29UE12O4XXlchyzjlbIc9I8rXcePZGtdWRp1E27bu5TUE_V3r9WNKeiH0UVn0z8-dFz3QpF1_VfZP9xV_ad2wP9hZOGIhyULx1cw3sLREjjmz4z83AlL73l4x8IHHt4vOfRhCXxkYfQkhnzJ0Ncyvmae0XFRz5AvGiae0fmq4c6D813zzc6XzUfzbcOjZ3S-b3LrwfnGeWaXfOFu6ezy5V8AAAD__wH6wcY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslU1r20AQhu_9FWWuXbBnV7JjnXLoJZempL0VHVRpCAJHa3ZXkDT4vxdb4ETGnv3yUZLfeffxPLDvMOiOfjQvZKH6AwgCJAhQIKAAASXUAnZGt2StNoefTIGH7hWqpYB-2I3u8LoW0GpDUL2D692WoILfzd8tPVHTkVksQUBHrum3x5qd6V8a83b_-vYPBDyOrvp6j1DvBejRfUy0rnkmqHAvwlu_99b1Q-sW5bySmS9j5n-mwiwslYSF4VzF1YKPueOgTUeGutnUes8dQS6Dj1DGMP7SxpFZSDwf_-3q_NVsPkas7nZCelpPf9sqUcgYqiwslYSF4VxzIWU4l7zdtjytJ6x14rYiqDALSyVhYTjXfFsqnEvdblue1hPWXeK2IqgwC0slYWE413xbRThXcbtteVpPWJvEbUVQYRaWSsLCcK7rV_OFgieyOz1YOruiL09eHq5u6p5puuetHk1LP41ujzXT4-Mxd3zRkXXTV5weHobp0-GAn8PIhotZGM_Dkg0rvlnlNBdsuOSbSzYsJZ9esek1H17nQN-x4Q3fvMlpRo9jPsmyLENeM_R4hlmiIW8aelRD3jVfOe8aemTDLNuQ1w09vmGWcJIXTnqEk3HC1fsv_wMAAP__BkP9WA==

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk9r4zAQxe_7KcpcVxCPbOePYaGHZSGXdun2tuuD1x6KIbWCJEO7Jd99cQxpHZqRZEGOlvLmzS_vHfQGnWrornomA8VvQBAgQUAKAjIQkEMpYK9VTcYoPfxkFGybFygSAW237-1wXAqolSYo3sC2dkdQwGP1d0cPVDWkFwkIaMhW7e5os9ftc6Vfb19e_4GAH-3Oki5ubvHmT58kaX2TFkWxvXtcg4D73g43UB4EqN6-2xlbPREUeBD-K31vjW272i7y6T7MfBky_yMyBjHTtxDodBY0-lNnFw3e5_ad0g1paiZTywO3gky8V8hDGH8pbUkvJJ6P_3px_nIyHwOCvVKXHSud_tPlzC6HIAcxx3TZFxr9qaddlv7U8kpBO1Y6Ma9mBh2AjEHMMUH7QqM_9TTo1J86vVLQjpVOzOuZQQcgYxBzTNC-0OhPPQ0686fOrhS0Y6UT82Zm0AHIGMQcE7QvNPpTX36GfGLwQGavOkNnz5HPJyfDM4WaJxrfNEb1uqafWtVHm_Hz_qg7HjRk7HiL48e2G6-GBT-KkRVnEzGeiyUrTnnnNMY5Y8U575yzYil59ZJVr3jxKgZ6zYo3vPMmxhkdHXOVLKplyNcMHT3DqKIh3zR0VA35rrnM-a6ho2wY1Tbk64aOvmFU4SRfOOkonAwrXHn48j8AAP__pmhLWg==

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk9r4zAQxe_7KcJcV1CPbOePYaGHZSGXdun2tuuD1x6KIbWCJEO7Jd99cQxpHZqRZEGOlvLmzS_vHfQGnWrornomA8VvQBAgQUAKAjIQkEMpYK9VTcYoPfxkFGybFygSAW237-1wXAqolSYo3sC2dkdQwGP1d0cPVDWkbxIQ0JCt2t3RZq_b50q_3r68_gMBP9qdJV0sbnHxp0-StP62yIqi2N49rkHAfW-HKygPAlRv3_2MrZ4ICjwI_52-t8a2XW1v8ulCzHwZMv8jMwZB0wL9mdNZzOgPnV00eJ_bd0o3pKmZTC0P3Aoy8V4hD2H8pbQlfSPxfPzXi_OXk_kYkOu1uuzY6fSnLmd2OYQ5CDqiy77M6A897bL0h5bXCtqx0wl6NTPoAGYMgo4I2pcZ_aGnQaf-0Om1gnbsdIJezww6gBmDoCOC9mVGf-hp0Jk_dHatoB07naA3M4MOYMYg6IigfZnRH_ryM-QTgwcye9UZOnuOfD45GZ4p1DzR-KYxqtc1_dSqPtqMn_dH3fGgIWPHWxw_tt14NSz4UYysOJuI8VwsWXHKO6cxzhkrznnnnBVLyauXrHrFi1cx0GtWvOGdNzHO6OiYq2RRLUO-ZujoGUYVDfmmoaNqyHfNZc53DR1lw6i2IV83dPQNowon-cJJR-FkWOHKw5f_AQAA__8XqktV

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lLtugzAYhfc-RXVmV8GG3JhYsyRV1K1ioPhXhJRgZBspacS7V4EhTURaqN3Rl4-P88s6Z5RK0jo7kEH8Dg4GAYYQDBEYpkgZKq1yMkbpy5UOWMkj4oChKKvaXrZThlxpQnyGLeyeEOMt-9jTljJJehKAQZLNin2rqXRxyPQpOZ4-wbCpbfyccJYIpA2Dqu31o8ZmO0LMG_Y38fR3sWAJfygWD8VXX10qLUmTvHGlTc-vrdWLqiY8uLvZ7w5v3Hx4aO512iPEM6_TFsPFwmviEeK518ThcHHoNfEI8cJr4mi4OPKaeIR4-W8d0iPekqlUaWhQQwSXjiG5o66QjKp1Tq9a5a2mW25art2QZGx3KrrFqmyP2sl8h7kLLH6EOb-hg3s6dFFHLvDUBZ65wHMXeOECL51eybg3ljZPXwEAAP__0V3EcQ==

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lc1vnDAQxe_9K6q51tXuGNgPTnvNJanS3ioOFI8ipA1GtpGSRvu_V4BQuqtkzIc58vF7b_zmSX6DSiu6z5_JQvobEARIEBCBgBgEJJAJqI0uyFpt2l964E69QLoVUFZ149rXmYBCG4L0DVzpzgQp_Mr_nOmRckVmswUBilxenjub2pTPuXk9vbz-BQEPjUu_nhCyiwDduHdF6_InghQvYp5rssRVTnH9qY0js8Gbc57w26f60Rz9JIT-u6w2igypj0Q_GOJef9f1Rl6f8TP7-Moexy8Nw1VlgusuXFU8rsMqce4qR-rv5urL8anJcLua4LoPtyuP65ClXCnLQX8_Vz8an1oUblcTXA_hduVxHbKMVspy0D_M1Y_HpxaH29UE12O4XXlchyzjlbIc9I8rXcePZGtdWRp1E27bu5TUE_V3r9WNKeiH0UVn0z8-dFz3QpF1_VfZP9xV_ad2wP9hZOGIhyULx1cw3sLREjjmz4z83AlL73l4x8IHHt4vOfRhCXxkYfQkhnzJ0Ncyvmae0XFRz5AvGiae0fmq4c6D813zzc6XzUfzbcOjZ3S-b3LrwfnGeWaXfOFu6ezy5V8AAAD__wH6wcY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslU1r20AQhu_9FWWuXbBnV7JjnXLoJZempL0VHVRpCAJHa3ZXkDT4vxdb4ETGnv3yUZLfeffxPLDvMOiOfjQvZKH6AwgCJAhQIKAAASXUAnZGt2StNoefTIGH7hWqpYB-2I3u8LoW0GpDUL2D692WoILfzd8tPVHTkVksQUBHrum3x5qd6V8a83b_-vYPBDyOrvp6j1DvBejRfUy0rnkmqHAvwlu_99b1Q-sW5bySmS9j5n-mwiwslYSF4VzF1YKPueOgTUeGutnUes8dQS6Dj1DGMP7SxpFZSDwf_-3q_NVsPkas7nZCelpPf9sqUcgYqiwslYSF4VxzIWU4l7zdtjytJ6x14rYiqDALSyVhYTjXfFsqnEvdblue1hPWXeK2IqgwC0slYWE413xbRThXcbtteVpPWJvEbUVQYRaWSsLCcK7rV_OFgieyOz1YOruiL09eHq5u6p5puuetHk1LP41ujzXT4-Mxd3zRkXXTV5weHobp0-GAn8PIhotZGM_Dkg0rvlnlNBdsuOSbSzYsJZ9esek1H17nQN-x4Q3fvMlpRo9jPsmyLENeM_R4hlmiIW8aelRD3jVfOe8aemTDLNuQ1w09vmGWcJIXTnqEk3HC1fsv_wMAAP__BkP9WA==

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lc1vnDAQxe_9K6q51tXuGNgPTnvNJanS3ioOFI8ipA1GtpGSRvu_V4BQuqtkzIc58vF7b_zmSX6DSiu6z5_JQvobEARIEBCBgBgEJJAJqI0uyFpt2l964E69QLoVUFZ149rXmYBCG4L0DVzpzgQp_Mr_nOmRckVmswUBilxenjub2pTPuXk9vbz-BQEPjUu_nhCyiwDduHdF6_InghQvYp5rssRVTnH9qY0js8Gbc57w26f60Rz9JIT-u6w2igypj0Q_GOJef9f1Rl6f8TP7-Moexy8Nw1VlgusuXFU8rsMqce4qR-rv5urL8anJcLua4LoPtyuP65ClXCnLQX8_Vz8an1oUblcTXA_hduVxHbKMVspy0D_M1Y_HpxaH29UE12O4XXlchyzjlbIc9I8rXcePZGtdWRp1E27bu5TUE_V3r9WNKeiH0UVn0z8-dFz3QpF1_VfZP9xV_ad2wP9hZOGIhyULx1cw3sLREjjmz4z83AlL73l4x8IHHt4vOfRhCXxkYfQkhnzJ0Ncyvmae0XFRz5AvGiae0fmq4c6D813zzc6XzUfzbcOjZ3S-b3LrwfnGeWaXfOFu6ezy5V8AAAD__wH6wcY=

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkTFLBDEQhXt_xTF1YJO9LpWFzTUqtrJFSIYjEDNLZiLCsf9dNinOE09Wr8zM--a9R06QKeCje0MG-woGJgVzIY_MVNZRFxzCB1itIOa5yjqeFHgqCPYEEiUhWEjkXdq9u1SRd3rQoCCguJiaflFAVc40izsiWLOofzqYwWxyGK86nA_XTCVgwfDt4g8ZHiJLzF6G8UIL9wauJdj_peML8kyZcVM3vSbEcMReh6kWj8-FfLPpz6fGtUFAlr4d--OQ26p9wlfY3AKPv8L7C1gv03L3GQAA___qN9W_

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9r2zAQx9_3V4R72phGLNnOD8MgYxRWKO1o8zb84MZaE0hjIzvQrOR_H0madbbT-1rxpre69ud0On0up2daZam-Th51QdEPkiRIkSCfBAUkKKRYUG6ymS6KzOw-OQCX6RNFnqDFKl-Xu3_HgmaZ0RQ9U7kol5oimib3S32rk1SbvkeCUl0mi-V-mdwsHhOzmTxtfpGgm3UZ9SaK4q2gbF2-RHwNdL_pzZNiXg0xkRRvY0FFmTxoiuRWnJdZ-L8zU29m9hpnvcpMqo1OK5HiHYk-ObG9b0kxv9PlTd6XtbpPN7mOepfX04vbu4uv096XqysStNQ_y_cT-eGzWTzM93_92bqsbf11W75Nwe8yU2rTl2G9Uh_fjB-0KNupirwEPZHEdfYpy_vKq9f45PJhZXnZ3ifp1nSLzAZuTZduTZeOTAcFP5o-ONd01f5AlVvVLDIbulVNuVVNOVINFPyo2vBc1fz2B-q7Vc0is5Fb1Xy3qvmOVAMFP6o2Ole1oP2BBm5Vs8hs7Fa1wK1qgSPVQMGPqo3_xVXxRPxbXeTZqtCtboHermY6fdCHMyiytZnp7yab7Zc5PN7suf3FINVFeXirDg-Xq8OrXYLt4WEXWMpOdNiJHvO0tKiZsoOHXeBazWzpsBM95mlVp72_ab8Ce3XYZ-GAP62AhZXklw679AcPg_7gYdQfgAb9AWjQH4Mu_cHDoD94GPUHoEF_ABr0x5C1dMRLOurSH-MuhvMwMJyHkeGABoYDGk0Am7HZ_CW1mZu2NBwCVpPTGgeay8YUqagqFS-65McIMF025oiN6oAGrgMayY5wYDvCke6NGWqlO08j3Xka6g5wpDvAke6NQVrVfQB0b8wUK90bM8VKd55GuvM01B3gSHeAI90b89RKd55GuvM01B3gSHeAI90bU7V61_Z43VVjtrC6x9t3vwMAAP__ibc6hw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE9v4kgQxe_7KVCfdrVeQXc1f6WVWO1EmkhRMkq4jTg4uCcgEYxsI4WJ8t1HwADBjeu53YZb_vC66lXX-8nmXSziyNyHryYVg-9CikAoEQgSgdAiEG0xDsQyiScmTeNk85Gd4DZ6E4NWIGaL5Srb_HkciEmcGDF4F9ksmxsxEKPweW4eTRiZpNkSgYhMFs7m2zLLZPYaJuvh2_qnCMTDKhs0hkqMPwIRr7LjiWkWvhgxkB9B-apfZmk2W0yyZvu05FDmzj9KnteNaZhOz3z-2INy6eGzc-llnSpZl_V614VNHM9ZLeIkMomJTk7anlLYpmqBNo8ttC_VAprUsYWORwtBpS6_hun0yWQPyyblJjVaL82gcXs_unl8uvl_1Pjv7k4EYm5-ZH8O5V__JrOX6fanw4YV2-q6bNhTnGQmaZI1tb8Lz--VGNu5ifw-9EwT9_E_8bKpW_kZny3fPykvHXJbH7FA1cMydi5ILBfnXtapknVZr3dd2IQnLmRFYtXYAppUEbHcWvAmlrwSscCG7YllTa0ssVT54Kj6kAGqHrahe0FkODiXXtapknVZr3dd2IRnXlVFZNTYAppUETLcWvBGhroSMsCG7ZFhTa0sMqh8cKg-ZICqh23oXRAZDs6ll3WqZF3W610XNuGZV6qIjBpbQJMqQoZbC97IoCshA2zYHhnW1MoiQ5cPjq4PGaDqYRv6F0SGg3PpZZ0qWZf1eteFTXjmVVdERo0toEkVIcOtBW9k6CshA2zYHhnW1Kp8lXLm_EeTLuNFakp9S9LazMxEL2Z3B2m8SibmWxJPtmV2vz5sdds_RCbNdv-Vu19uF7t_bRr8LJZ5sfws1idi6SaW5KNW0kvd91FTl1crduLET5zY0m2-Mi-W4L54tVI-amp5qXu8WrMT7_DitoNY5cUdVtzl77rLioHnHivWINh9ngotgAULKk5c4NUQDLwckgHIERp4OWKDtNByOngFBm-xxQUPQI34AOQIEECOCIHkIC7SIszp4NHoeMTk5BYmJA8Z2QHXzmMGWec5I3uguEUap7Dzahh2Xg7DDuQo7Lwchp2nrAKUVTxqwMYCNQo7kKOwAzkKO5KDjVc8ZRVYOsU_weXkVtgVjxqlwbXzqEHWedIoQBplkcYl7ECNwg7kKOxIDsIO5PCpn6esApRVPGpQ2AFl0b0BTKKwA0yisAM52niesgS2hvgX5JzcCjvxqCHwQEc8aoB14klDgDRkkcYl7ECNwg7kKOxIDsIO5CjsxFOWAGWJRw16yweURfcGMIne8wEm0Ys-kKON5ylL6Nr5t-ac3A47jxoNHug0j5q89fHHH78CAAD__555ymg=

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpiyziS6a6BgKQsVFi2udyUXWXOqguuEmRHWLr570ZRao52T6aHTO2Pyzfxz8kH-V9joEsfFM1rIvoIEAQoEJCAgBQE9yAVURs_RWm0Oj9TAqHyBrCtgtam27vB3LmCuDUL2Cm7l1ggZzIqnNU6xKNHcdEFAia5YrY_bVGb1XJjd8GX3HQRMti7rDBXkewF6636ueFroaddZFnZ5vsRQQr7PBVhXLBAyuRd_l6z3r5OpPyY7rbPdaFOiwfJspfxAUo9cOd7nwi4f0U2qG9mY-2xXYdYZjWf308f7T7POx4cHELDGb-7tUL77YFaL5fHXr6PLxtFPx0oYx7qSeazf6-pG9poDuLp3era3bP-yZVwNA5L142oo42ooI2mo2g9cxVUhINltXBVUXBVUJBWS9gNP4qoQkOwurgpJXBWSSCqk7QeexlUhINkgrgppXBXS_9BTriSaoq30xmKrFtI9nAnLBdYzsnpr5vjF6Plxm_pycuSO39sSravvqvpitKlvHQK2h_sceMCBJSu37PlpGTAyFQb3OfCAA0tW7sbILmjVpLu_04l_3okXlucz6zbplCO4HyYE98OE4H6YEpygCcF7HMH9MCG4HyYE98OU4ARNCN7nCH7LUdQPE4r6YUJRP0wpStCEonccRf0woagfJhT1w5SiBE0oOuAoKlk9gaAJSQmasJSgKU0pnOoKvLLAawu8usDsC7zCIFmNQV5UhiBb_TRlq5-mbPXTpK0ETtkaUpYu31lIWwqlKVuD-lIwTtl6UR68tub7Nz8CAAD__yjkNeg=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl99r4koUx9_vXyHn6V7IRc9M_AkXvOwWtlDapfVt8SE1s1WwJiQR6pb-74sKWpPmfJ3M2H1r1U_mnJP5fDN5pVUSm9vo2eQ0-kFMASkKSFNAIQXUpWlAaZbMTJ4n2fYne-A6fqFRJ6DFKl0X24-nAc2SzNDolYpFsTQ0okn0uDT3JopN1u5QQLEposVyt0yaLZ6jbDN-2fyigO7Wxag1VjR9CyhZF8cr5kX0ZGjEb8H5q35d5MViNSva3dMlx1y6_hF53LTmUT7_4PfHGpRNDe87Z6fWdaPW2W_vYW0Rx-usV0kWm8zEJ1faXaW2TNUBZR5L6F6qBDSpYwk9hxKCRlV-i_L5gynu0rYuTWqySc2odX07ubp_uPoyaf1_c0MBLc3P4u8x__Nftnia7_467LD6tvp-J3ub_Jukbd0tD-DDtQcna7OFVP7iBKx62Cm9C8aJTedOretGrbPf3sPaIhxd5oZx4rEENKm6OLErwTlO-JPiRJ2_sZU_pcGqh7vVv6DSFp2zU-u6Uevst_ewtghHn1RDpT2WgCZVp7RdCc5Kq09SWp-_sbU_pcGqh7s1uKDSFp2zU-u6Uevst_ewtghHn3RDpT2WgCZVp7RdCc5K609SOjx_Y4f-lAarHu7W8IJKW3TOTq3rRq2z397D2iIcfQobKu2xBDSpOqXtSnBWOvwD7_EfVHRv8jRZ5east_TOticTP5n9jPJknc3M9yyZ7ZbZ_3u343YfxCYv9t_y_p_r1f6rbYHvYS7D_B4OT2C2g1k50UMXWvVcaK1lWokT1_LEtbh0V15ZhhnULdOq40T3XWgNdlooThzc7K4FrMpwT4RB0315o_TknTIQ6aEMD13ElmEkNqCB2DKNxJZpJDaDLEVhKscKcBvQSG6AI7sRDnY6wJHfLEcqI7ySLhJecZzleEGty_nCwHKuJIzVI1im4TMY4OghLOPwKSzj0FY5XnkABl_JVytbZRraKuPQVoCjLSvj0NZKyp4MXjE4PskpW8IrtqpK1NjYquSkUeD0puRzDBgcoJGtCAe2AhzZCnB4aJZDVnXB4Cspa2MroJGtAEe2IhxtWRlHtir5CKsGAJdTtoRXbZVPsah1OWl0B7xrVZLGxlZAI1sRDmwFOLIV4MhWLYesVmDwlZS1esuVafiaK-PwPRfg6EVXxpGtWj7KajQ6OWVLeMVWLZ9ly61P3_76HQAA___tOsc7

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlk1r20AQhu_9FWZOLd1i7UryhyCQUlJqCE5JfGt9UKxtbHAssZIhbsh_L7ZjUkn2vForCN2iSM_uaOd5PXqmVRzpcfioUwp-kSRBigS5JMgjQT5NBSUmnuk0jc32kT0wip4ocAQtVsk62_57KmgWG03BM2WLbKkpoEl4v9S3Ooy06TokKNJZuFjutknM4jE0m8unzV8S9H2xzLQJOpey83vtOO6so4IgGI0nAxJ0s862d2j6IiheZ6_bve1yv-nMw3SeX3_3_FRQmoUPmgL5Is4r27cpW1-8d93qZN1v66xXsYm00VFupemWRI8cefkfYTq_09lN0pWFlk02iQ46o_Hk6vbu6tuk8_X6mgQt9Z_s46X8dGEWD_PdXydf_e21XJt23MUm06Yr_eJJfT65vlfh2I6dyOuiR4oYx1_ipKuc4hkf3d7PbS-r2yZbFBKLsnttColsNiSyoZCAdhxC0js3JKp6u1WLLLUou98mS1WzlqqGLAXtOFjaP9dSt3q73RZZalH2oE2Wus1a6jZkKWjHwdLBuZZ61dvttchSi7KHbbLUa9ZSryFLQTsOlg7f47P4yPq3Ok3iVaorffE62zPT0YPe9yCN12amf5p4tttmf3mz43ZfMpFOs_1dtb8Yrfa3tgVWh_t1YClr0X4tesjT0uLMlB3crwMXzsyW9mvRQ55WRdr5n3ZzsFOEXRb2-G55LKwkv7VfJx88DPLBwygfgAb5ADTIR69OPngY5IOHUT4ADfIBaJCPPmvpgJd0UCcfwzqG8zAwnIeR4YAGhgMaTQCbsVn-JbWZm7Y0HAJWk9MaB5rL0hTJqSoVL7rkxwgwXZbmiI3qgAauAxrJjnBgO8KR7qUZaqU7TyPdeRrqDnCkO8CR7qVBmte9B3QvzRQr3UszxUp3nka68zTUHeBId4Aj3Uvz1Ep3nka68zTUHeBId4Aj3UtTNf-t7fC6q9JsYXWfvnz4FwAA__8Mxohm

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K9BctaorPB98WYqUqk1VpIisEu52uXDwbLBEMLKNFDbKf18BCwQPfo-HMb5LMGfm-Mx7Htm8s0US6VH4qjMWfGWceUwwj0nmMcU81mETjy3TZKqzLEk3X9kJhtEbC3yPxYvlKt98PPHYNEk1C95ZHudzzQI2Dp_n-lGHkU7bPvNYpPMwnm-3Wabxa5iub9_WP5jH_ovnuU6D1i1vfVv5vpy2RBAEw9G4zzz2sMo3V9jkw2PJKj9ul-Xhi2YB__CqW_o3zvJ4Mc3bnVM_xvpHyfO6NQuz2ZnvHz0IGw-fY-FWuegbm2DkRcHwepNRpSaO66wWSRrpVEcnK21XKbUpfGDzaKFzLQsoqaOFroMF7yKX_4fZ7EnnD8u2LCQ1Xi910BqOxnePT3f_jFt_398zj8319_z3W_7HTRq_zLZ_VZiwns2EPSVprtO2NFL7s3T9foXYziXya9EzJkbJX8myrfxixme3H5xszy1a3RDsgKXDpHavCDubWKxycYFd1WB4vcmoUhOOpOEXwq5GCyipMtjZWXCGHW8IdmDC9rAzUqsKO1G9VqIh2gBLh1HpXZE2FrFwq1xcaFM1GF5vMqrUhGPVxYW0qdECSqqMNnYWnGkjGqINmLA9bYzUqtJGVq-VbIg2wNJhVPpXpI1FLNwqFxfaVA2G15uMKjXhWHV5IW1qtICSKqONnQVn2siGaAMmbE8bI7WqtFHVa6Uaog2wdBiVwRVpYxELt8rFhTZVg-H1JqNKTThWXV1ImxotoKTKaGNnwZk2qiHagAnb08ZI7ZKfjc6s_6izZbLIdKVfhPxNZjp60bszyJJVOtVf0mS63Wb378NWt_0g0lm-u8p3_wwXu0sbg5_FvCjmn8XqRMztxFy6qAV3Ug9c1LJHqwWZuKQTl-TWHXpnWszBedFqIVzU0ndS92m1IhPv0uKOhVgUxV1S3KPPukeKwT33SbECxR7QVPABFgyoWHGBVkMw0HJIBiBHaKDliA3cQMtp8AIEb7DFBg9AjfgA5AgQQI4IgeSgLtwgzGnwKDoaMQW5gQlOQ4Z3wbHTmEG3TnOG98HmBmmsyk6rYdlpOSw7kKOy03JYdpqyAlBW0KgBEwvUqOxAjsoO5KjsSA4mXtCUFWDoBP0EV5AbZRc0aoQCx06jBt06TRoBSCMM0tiUHahR2YEclR3JQdmBHD7105QVgLKCRg0qO6AsOjeASVR2gElUdiBHE09TVoKpkfQLckFulF3SqJHggU7SqAG3LmnSSEAaaZDGpuxAjcoO5KjsSA7KDuSo7JKmrASUlTRq0Fs-oCw6N4BJ9J4PMIle9IEcTTxNWYmOnX5rLsjNstOoUeCBTtGoKd765OO3nwEAAP__u3YYVg==

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll9v2jwUxu_fTxGdq3eaJ2In4U-kSkxTpyFVdGq523KREq8gURI5QSqr-O4TpIwloX5iUkW5KyU_-8Tn93D8Qus4ktPwSabk_yBOjAQxcoiRS4w8ChglKp7LNI3V_pEcmETP5NuMlutkk-3_HTCax0qS_0LZMltJ8mkWPqzknQwjqXo2MYpkFi5Xh20StXwK1Xb8vP1NjL4uV5lUvjXm1s-NbTtzy_F9fzKdDYnR7SbzrbGgYMco3mSv2512edhaizBdFNcfcwp2AaM0Cx8l-XzHLivbMylbXln8fesWb9Z9WmezjlUklYwKKwV7Ej1y5uW_heniXma3SY-XWjbbJtK3JtPZ9d399ZeZ9fnmhhit5K_s_zH_cKWWj4vDX39fnZde_fRajkk77mOVSdXjXvmkPr65vlvj2M6dyOuiZ4qYxp_ipCfs8hmf3d4rbM_r28Y7FBKDsvtdCglvNyS8pZCAdhxD0r80JKJ-u0WHLDUoe9AlS0W7loqWLAXtOFo6uNRSp367nQ5ZalD2sEuWOu1a6rRkKWjH0dLhpZa69dvtdshSg7JHXbLUbddStyVLQTuOlo7e41p8Zv07mSbxOpW1brz2_sxk9CjzHqTxRs3ldxXPD9vkH28P3OEmE8k0y78V-YfJOv9qX2B9eNAE5rwR7TWiR3qaG5yZMIMHTeDSmZnSXiN6pKdFmbb_pZ0CbJdhRwu7-m65Wlhw_dZek3zoYZAPPYzyAWiQD0CDfPSb5EMPg3zoYZQPQIN8ABrkY6C1dKiXdNgkH6MmhuthYLgeRoYDGhgOaDQBTMZm9ZfUZG6a0nAIGE1OYxxozitTpKAqF3rRuX6MANN5ZY6YqA5o4DqgkewIB7YjHOlemaFGuutppLuehroDHOkOcKR7ZZAWde8D3SszxUj3ykwx0l1PI931NNQd4Eh3gCPdK_PUSHc9jXTX01B3gCPdAY50r0zV4l3b1usuKrNFq3uw--9PAAAA___wfIhw

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mEtv6kYcxff9FNasWtUVngcvS1eiam9VpCtSJexaFg6eBksEI9tIoVG-ewVcIHjw_3gY4x2vM3N85n9-snlnqzTWk-hV5yz8m3HmM8F8JpnPFPNZl818ts7Suc7zNNv95CAYx28sDHyWrNabYvfxzGfzNNMsfGdFUiw1C9k0el7qRx3FOusEzGexLqJkud9mnSWvUbYdvW3_Yz77I1kWOgu9Eff-2QSBnHsyDMPxZDpgPnvYFKE3Emz24bN0U5y3y4voRbOQf_j1Lf2e5EWymhed7qWfES-tf5Y8b71FlC-u_P7sQdh4-BwLt8pFf_F4_WDkTcHwZpNRlSbO62xWaRbrTMcXK-1XqbQpAmDzbKF7LwsoqbOFnoMF_yaXf0b54kkXD-uOLCU13a516I0n06-PT19_m3q_fvvGfLbU_xY_jvhPX7LkZbF_dZqw6svq20zYU5oVOutII7WfK9cf1IjtWiLfF71iYpL-kq47KihnfHX74cX23KLVLcEOWDpNau-OsLOJxSoXF9jVDYY3m4yqNOFIGn4j7Bq0gJKqgp2dBWfY8ZZgBybsCDsjtbqwE_VrJVqiDbB0GpX-HWljEQu3ysWFNnWD4c0moypNOFZd3EibBi2gpKpoY2fBmTaiJdqACTvSxkitLm1k_VrJlmgDLJ1GZXBH2ljEwq1ycaFN3WB4s8moShOOVZc30qZBCyipKtrYWXCmjWyJNmDCjrQxUqtLG1W_Vqol2gBLp1EZ3pE2FrFwq1xcaFM3GN5sMqrShGPV1Y20adACSqqKNnYWnGmjWqINmLAjbYzUbvnb6Mr6jzpfp6tc1_pHKNhlpuMXfTiDPN1kc_1Xls732xzePux1-w9inReHb_nhzXh1-Gpn8LOYl8X8s1hdiLmdmEsXteBO6qGLWvZptSATl3Tikty6S-9Mizk4L1othItaBk7qAa1WZOI9Wty1EIuyuEeK-_RZ90kxuOYBKVag2EOaCgHAggEVKy7QaggGWg7JAOQIDbQcsYEbaLkMXoDgDbbY4AGoER-AHAECyBEhkBzUhRuEuQweRUcjpiQ3MMFpyPAeOHYaM-jSac7wAdjcII1V2Wk1LDsth2UHclR2Wg7LTlNWAMoKGjVgYoEalR3IUdmBHJUdycHEC5qyAgydoO_gSnKj7IJGjVDg2GnUoEunSSMAaYRBGpuyAzUqO5CjsiM5KDuQw7t-mrICUFbQqEFlB5RF5wYwicoOMInKDuRo4mnKSjA1kn5ALsmNsksaNRLc0EkaNeDSJU0aCUgjDdLYlB2oUdmBHJUdyUHZgRyVXdKUlYCykkYNesoHlEXnBjCJnvMBJtGDPpCjiacpK9Gx00_NJblZdho1CtzQKRo15UufffzwfwAAAP__BrAYYA==

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllGL2kwUhu-_XyHn6itM0ZlEdw0ULGWhwqLF9a7kImtOVXCdMImwdvG_F00Xa7TnZHoguYzJM_POmQd832BrU5wkL5hD9B00KDCgIAAFISjoQ6wgc3aBeW7d8ZMSGKevEPUUrLfZrjj-HCtYWIcQvUGxLjYIEcyT5w3OMEnRdXugIMUiWW9O22Ru_ZK4_eh1_xMUTHdF1BlpNTIQHxTYXfF70fNaz_vOKslXl6u8I7GCvEiWCJE-qH_L1-fzGTXS0nzmr_nOS-221qXoML1YLD6S3Cc3Dvk1yVdPWEyzrq7cwXyfYdQZT-YPs6eHL_PO58dHULDBH8X_p-AfPrn1cvX-QF3T-XyB4Hw3wk_sR5t1db86iZt7hxd76_p3r9tw0yPfoA03dbNu6qbdNPXnb9rwwyPfXRt-mGb9ME37EdSff9CGHx757tvwI2jWj6BpP8L68w_b8MMj37ANP8Jm_Qjb7D43os0wz-w2x1rNpnc8HKZLLIeV251b4DdnF6dtysfpiTv9b6eYF-VbUz6Mt-WrY8D68EACDyWwFuXWfZrWHiMzfvBAAg8lsBblrozsijZVuvcnHdDzDkhYX86sV6VDieA0zAhOw4zgNMwJztCM4H2J4DTMCE7DjOA0zAnO0IzgA4ngdxJFaZhRlIYZRWmYU5ShGUXvJYrSMKMoDTOK0jCnKEMzig4limpRT2BoRlKGZixlaE5TDue6gqwsyNqCrC4I-4KsMGhRY9BXlcHLVprmbKVpzlaaZm1lcM5Wn7J0fWc-bcmX5mz16kveOGfrVXkgbY0P__0KAAD__x91S3g=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4koYxu_Pp5C5OgfmoO9M_AsLLruFLZR2ab1bvEjNbBWsCUmEuqXffVFZrYl5nxkn6V7a9ue8eTK_J5O-ilUcmdvw2WRi9EOQkEIJKbSQIhBSdMVUiiSNZybL4nT7J3vgOnoRo44Ui1Wyzrc_nkoxi1MjRq8iX-RLI0ZiEj4uzb0JI5O2O0KKyOThYrlbJkkXz2G6Gb9sfgkp7tb5qDUmOVZi-iZFvM6PX5rl4ZMRI3qT9gt_XWT5YjXL293TVc8tcaQeN615mM3PI8dJlMsk7yMgiwyUHFNlBvqiDKiJEILKUY5ftV7FaWRSE5182e5bKodVHTzscYpuU1NYRHacoucxhbxo0G9hNn8w-V3S1oW8JpvEjFrXt5Or-4erL5PW55sbIcXS_Mz_3V3Ef5_SxdP8zwc79fr1pnwb_x8nbd0tJnF27cHJ2uQgW619AxY-bJxe433jEoFFBg59Y5sBNRFCUDmKp-l0ed_UOIVFZFV94zaFd9_QR_eNst_wqlbnwcKHm9dv3HmHCMgiAwfnbTOgJkIIKkfxtE1d7nyNU1hEVuW82xTezquPdl7bb3hdq_Ng4cPNGzTuvEMEZJGBg_O2GVATIQSVo3japi93vsYpLCKrct5tCm_n9Uc7H9hv-KBW58HCh5s3bNx5hwjIIgMH520zoCZCCCpH8bQtuNz5GqewiKzKebcpvJ0P_ub_Es6Mdm-yJF5lxuo_BZ3txZnoyezDyuJ1OjPf03i2W2b_8W7H7X4QmSzf_5b2H65X-19tB3wPUxGm93BwApMbTMqLHvrQqudDa83Tik1c84lrdukuvzIPE5ibp1XHi-770BrstIBNHNzsrgOsinCPhcFF9_mN0uN3yoClhzw89BGbh5HYgAZi8zQSm6eR2AS6FJUpXyvAbUAjuQGO7EY42OkAR34TX6mE8FK7cHjJceLrBV063y8ELKdSwzg9gnkaPoMBjh7CPA6fwjwObeXrlQYg-FK_OtnK09BWHoe2AhxtWR6HtpZa9iR4ReD4xLdsAS_ZqkpV42Kr4ptGgdOb4s8xIDhAI1sRDmwFOLIV4PDQzJes6oLgSy3rYiugka0AR7YiHG1ZHke2Kv4IqwYA51u2gJdt5U-x6NL5ptEd8K5VahoXWwGNbEU4sBXgyFaAI1s1X7JageBLLev0lsvT8DWXx-F7LsDRiy6PI1s1f5TVKDq-ZQt4yVbNn2WLlz59--d3AAAA__8EA-kj

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9r2zwUxu_fTxHO1TumEUu288cw6BiFFUo72tyNXLix1gTSyMgONCv97iNJQ2c7OY8Vb7prGv-k46PfyaMXWplM36RPuqDkB0kSpEhQSIIiEhTTVFBuzUwXhbHbR_bAVfZMSSBoscrX5fbfU0EzYzUlL1QuyqWmhCbpw1Lf6TTTth-QoEyX6WK52ya3i6fUbi6eN79I0O26THoXkqavgsy6fFvxfaGHTW-eFvPqErvnp4KKMn3UlMhXcV5l8b-uTJ2s7H2d9crYTFudVVaabkn0yJHX-5YW83td3uZ9Wev7ZJPrpHd1M7m8u7_8Oul9ub4mQUv9s_z_Qn74bBeP891fJ1_9_bVCl4bfG1tq25dxvVMfT64ftWjbsY68LXqkiBvzyeR9FdR7fHT7uLK9bO-T9Gu6Q2UDv6ZLv6ZLT6aDhh9MH5xrump_oMqvag6VDf2qpvyqpjypBhp-UG14rmph-wMN_armUNnIr2qhX9VCT6qBhh9UG52rWtT-QCO_qjlUNvarWuRXtciTaqDhB9XGf-OqeGT9O13kZlXoVrfAYNsznT3q_RkUZm1n-rs1s902-4-3O253Mch0Ue6_VfsPV6v9V9sC28PDLrCUnei4Ez3maenQM-UGD7vAtZ650nEneszTqk4Hf9JhBQ7qcMjCEX9aEQsryW8dd5kPHgbzwcNoPgAN5gPQYD4GXeaDh8F88DCaD0CD-QA0mI8ha-mIl3TUZT7GXQznYWA4DyPDAQ0MBzRKAJfYbP6SuuSmKw1DwCk5nXGguWykSEVVqXjRJR8jwHTZyBEX1QENXAc0kh3hwHaEI90bGeqkO08j3Xka6g5wpDvAke6NIK3qPgC6NzLFSfdGpjjpztNId56GugMc6Q5wpHsjT51052mkO09D3QGOdAc40r2RqtW7dsDrrhrZwuo-ff3vdwAAAP__rrw6fQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v2koQxd_vp0D7dK-uK9id5a9UKVUbqZGipEp4q3hw8DYgEYxsI4VG-e4VUCB48Ryv1_CWP5ydObNzfrJ5E_M4Mnfhi0nF4KeQIhBKBIJEILQIRFuMArFI4rFJ0zhZf2QruIlexaAViOl8sczWfx4FYhwnRgzeRDbNZkYMxDB8mpkHE0YmabZEICKThdPZpswimb6EyerqdfVbBOJ-mQ0aV1KM3gMRL7PDiWkWPhsxkO9B-arfpmk2nY-zZvu4pHX-QfK0akzCdHLi84celEsPH51LL-tUybqs17subOJwznIeJ5FJTHR00uaUwjZVC7R5aKF9rhbQpA4tdDxaCCp1-T1MJ48mu180KTep4WphBo2bu-H1w-P112Hjy-2tCMTM_Mr-vZL_fU6mz5PNTyU2rOuyYY9xkpmkSdbU_i88v1dibKcm8vfQE03cxZ_iRVO38jM-Wb5_VF465LY-YoGq-2XsnJFYLs69rFMl67Je77qwCU9cyIrEqrEFNKkiYrm14E0seSFigQ3bEcuaWlliqfLBUfUhA1Tdb0P3jMhwcC69rFMl67Je77qwCc-8qorIqLEFNKkiZLi14I0MdSFkgA3bIcOaWllkUPngUH3IAFX329A7IzIcnEsv61TJuqzXuy5swjOvVBEZNbaAJlWEDLcWvJFBF0IG2LAdMqyplUWGLh8cXR8yQNX9NvTPiAwH59LLOlWyLuv1rgub8MyrroiMGltAkypChlsL3sjQF0IG2LAdMqypVfkq5cT5DyZdxPPUlPqWpLWemYmezfYO0niZjM2PJB5vymx_vd_oNn-ITJpt_yu3v9zMt_9aN_hRLPNi-VGsj8TSTSzJR62kl7rvo6Yur1bsxImfOLGl23xlXizBffFqpXzU1PJS93i1Zife4cVtB7HKizusuMvfdZcVA889VqxBsPs8FVoACxZUnLjAqyEYeDkkA5AjNPByxAZpoeV48AoM3mKLCx6AGvEByBEggBwRAslBXKRFmOPBo9HxiMnJLUxIHjKyA66dxwyyznNG9kBxizROYefVMOy8HIYdyFHYeTkMO09ZBSireNSAjQVqFHYgR2EHchR2JAcbr3jKKrB0in-Cy8mtsCseNUqDa-dRg6zzpFGANMoijUvYgRqFHchR2JEchB3I4VM_T1kFKKt41KCwA8qiewOYRGEHmERhB3K08TxlCWwN8S_IObkVduJRQ-CBjnjUAOvEk4YAacgijUvYgRqFHchR2JEchB3IUdiJpywByhKPGvSWDyiL7g1gEr3nA0yiF30gRxvPU5bQtfNvzTm5HXYeNRo80GkeNXnro_d__gQAAP__Xf3KXg==

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9r2zwUxu_fTxHO1TumEUu288cw6BiFFUo72tyNXLix1gTSyMgONCv97iNJQ2c7OY8Vb7prGv-k46PfyaMXWplM36RPuqDkB0kSpEhQSIIiEhTTVFBuzUwXhbHbR_bAVfZMSSBoscrX5fbfU0EzYzUlL1QuyqWmhCbpw1Lf6TTTth-QoEyX6WK52ya3i6fUbi6eN79I0O26THoXkqavgsy6fFvxfaGHTW-eFvPqErvnp4KKMn3UlMhXcV5l8b-uTJ2s7H2d9crYTFudVVaabkn0yJHX-5YW83td3uZ9Wev7ZJPrpHd1M7m8u7_8Oul9ub4mQUv9s_z_Qn74bBeP891fJ1_9_bVCl4bfG1tq25dxvVMfT64ftWjbsY68LXqkiBvzyeR9FdR7fHT7uLK9bO-T9Gu6Q2UDv6ZLv6ZLT6aDhh9MH5xrump_oMqvag6VDf2qpvyqpjypBhp-UG14rmph-wMN_armUNnIr2qhX9VCT6qBhh9UG52rWtT-QCO_qjlUNvarWuRXtciTaqDhB9XGf-OqeGT9O13kZlXoVrfAYNsznT3q_RkUZm1n-rs1s902-4-3O253Mch0Ue6_VfsPV6v9V9sC28PDLrCUnei4Ez3maenQM-UGD7vAtZ650nEneszTqk4Hf9JhBQ7qcMjCEX9aEQsryW8dd5kPHgbzwcNoPgAN5gPQYD4GXeaDh8F88DCaD0CD-QA0mI8ha-mIl3TUZT7GXQznYWA4DyPDAQ0MBzRKAJfYbP6SuuSmKw1DwCk5nXGguWykSEVVqXjRJR8jwHTZyBEX1QENXAc0kh3hwHaEI90bGeqkO08j3Xka6g5wpDvAke6NIK3qPgC6NzLFSfdGpjjpztNId56GugMc6Q5wpHsjT51052mkO09D3QGOdAc40r2RqtW7dsDrrhrZwuo-ff3vdwAAAP__rrw6fQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v2koQxd_vp0D7dK-uK9id5a9UKVUbqZGipEp4q3hw8DYgEYxsI4VG-e4VUCB48Ryv1_CWP5ydObNzfrJ5E_M4Mnfhi0nF4KeQIhBKBIJEILQIRFuMArFI4rFJ0zhZf2QruIlexaAViOl8sczWfx4FYhwnRgzeRDbNZkYMxDB8mpkHE0YmabZEICKThdPZpswimb6EyerqdfVbBOJ-mQ0aV1KM3gMRL7PDiWkWPhsxkO9B-arfpmk2nY-zZvu4pHX-QfK0akzCdHLi84celEsPH51LL-tUybqs17subOJwznIeJ5FJTHR00uaUwjZVC7R5aKF9rhbQpA4tdDxaCCp1-T1MJ48mu180KTep4WphBo2bu-H1w-P112Hjy-2tCMTM_Mr-vZL_fU6mz5PNTyU2rOuyYY9xkpmkSdbU_i88v1dibKcm8vfQE03cxZ_iRVO38jM-Wb5_VF465LY-YoGq-2XsnJFYLs69rFMl67Je77qwCU9cyIrEqrEFNKkiYrm14E0seSFigQ3bEcuaWlliqfLBUfUhA1Tdb0P3jMhwcC69rFMl67Je77qwCc-8qorIqLEFNKkiZLi14I0MdSFkgA3bIcOaWllkUPngUH3IAFX329A7IzIcnEsv61TJuqzXuy5swjOvVBEZNbaAJlWEDLcWvJFBF0IG2LAdMqyplUWGLh8cXR8yQNX9NvTPiAwH59LLOlWyLuv1rgub8MyrroiMGltAkypChlsL3sjQF0IG2LAdMqypVfkq5cT5DyZdxPPUlPqWpLWemYmezfYO0niZjM2PJB5vymx_vd_oNn-ITJpt_yu3v9zMt_9aN_hRLPNi-VGsj8TSTSzJR62kl7rvo6Yur1bsxImfOLGl23xlXizBffFqpXzU1PJS93i1Zife4cVtB7HKizusuMvfdZcVA889VqxBsPs8FVoACxZUnLjAqyEYeDkkA5AjNPByxAZpoeV48AoM3mKLCx6AGvEByBEggBwRAslBXKRFmOPBo9HxiMnJLUxIHjKyA66dxwyyznNG9kBxizROYefVMOy8HIYdyFHYeTkMO09ZBSireNSAjQVqFHYgR2EHchR2JAcbr3jKKrB0in-Cy8mtsCseNUqDa-dRg6zzpFGANMoijUvYgRqFHchR2JEchB3I4VM_T1kFKKt41KCwA8qiewOYRGEHmERhB3K08TxlCWwN8S_IObkVduJRQ-CBjnjUAOvEk4YAacgijUvYgRqFHchR2JEchB3IUdiJpywByhKPGvSWDyiL7g1gEr3nA0yiF30gRxvPU5bQtfNvzTm5HXYeNRo80GkeNXnro_d__gQAAP__Xf3KXg==

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpiyziS6a6BgKQsVFi2udyUXWXOqguuEmRHWLr570ZRao52T6aHTO2Pyzfxz8kH-V9joEsfFM1rIvoIEAQoEJCAgBQE9yAVURs_RWm0Oj9TAqHyBrCtgtam27vB3LmCuDUL2Cm7l1ggZzIqnNU6xKNHcdEFAia5YrY_bVGb1XJjd8GX3HQRMti7rDBXkewF6636ueFroaddZFnZ5vsRQQr7PBVhXLBAyuRd_l6z3r5OpPyY7rbPdaFOiwfJspfxAUo9cOd7nwi4f0U2qG9mY-2xXYdYZjWf308f7T7POx4cHELDGb-7tUL77YFaL5fHXr6PLxtFPx0oYx7qSeazf6-pG9poDuLp3era3bP-yZVwNA5L142oo42ooI2mo2g9cxVUhINltXBVUXBVUJBWS9gNP4qoQkOwurgpJXBWSSCqk7QeexlUhINkgrgppXBXS_9BTriSaoq30xmKrFtI9nAnLBdYzsnpr5vjF6Plxm_pycuSO39sSravvqvpitKlvHQK2h_sceMCBJSu37PlpGTAyFQb3OfCAA0tW7sbILmjVpLu_04l_3okXlucz6zbplCO4HyYE98OE4H6YEpygCcF7HMH9MCG4HyYE98OU4ARNCN7nCH7LUdQPE4r6YUJRP0wpStCEonccRf0woagfJhT1w5SiBE0oOuAoKlk9gaAJSQmasJSgKU0pnOoKvLLAawu8usDsC7zCIFmNQV5UhiBb_TRlq5-mbPXTpK0ETtkaUpYu31lIWwqlKVuD-lIwTtl6UR68tub7Nz8CAAD__yjkNeg=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpiyziS6a6BgKQsVFi2udyUXWXOqguuEmRHWLr570ZRao52T6aHTO2Pyzfxz8kH-V9joEsfFM1rIvoIEAQoEJCAgBQE9yAVURs_RWm0Oj9TAqHyBrCtgtam27vB3LmCuDUL2Cm7l1ggZzIqnNU6xKNHcdEFAia5YrY_bVGb1XJjd8GX3HQRMti7rDBXkewF6636ueFroaddZFnZ5vsRQQr7PBVhXLBAyuRd_l6z3r5OpPyY7rbPdaFOiwfJspfxAUo9cOd7nwi4f0U2qG9mY-2xXYdYZjWf308f7T7POx4cHELDGb-7tUL77YFaL5fHXr6PLxtFPx0oYx7qSeazf6-pG9poDuLp3era3bP-yZVwNA5L142oo42ooI2mo2g9cxVUhINltXBVUXBVUJBWS9gNP4qoQkOwurgpJXBWSSCqk7QeexlUhINkgrgppXBXS_9BTriSaoq30xmKrFtI9nAnLBdYzsnpr5vjF6Plxm_pycuSO39sSravvqvpitKlvHQK2h_sceMCBJSu37PlpGTAyFQb3OfCAA0tW7sbILmjVpLu_04l_3okXlucz6zbplCO4HyYE98OE4H6YEpygCcF7HMH9MCG4HyYE98OU4ARNCN7nCH7LUdQPE4r6YUJRP0wpStCEonccRf0woagfJhT1w5SiBE0oOuAoKlk9gaAJSQmasJSgKU0pnOoKvLLAawu8usDsC7zCIFmNQV5UhiBb_TRlq5-mbPXTpK0ETtkaUpYu31lIWwqlKVuD-lIwTtl6UR68tub7Nz8CAAD__yjkNeg=

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllGL2kwUhu-_XyHn6itM0ZlEdw0ULGWhwqLF9a7kImtOVXCdMDPC2sX_XjRdrNHOyfRAchmTZ-adMw_4vsFW5zjJXtBC8h0kCFAgIAIBMQjoQyqgMHqB1mpz_KQExvkrJD0B622xc8efUwELbRCSN3Brt0FIYJ49b3CGWY6m2wMBObpsvTltU5j1S2b2o9f9TxAw3bmkM5JipCA9CNA793vR81rP-84qs6vLVd6RVIB12RIhkQfxb_n6zeRTf813Xmq31SZHg_nFYumRpD65ccivmV09oZsWXVm5g_m-wKQznswfZk8PX-adz4-PIGCDP9z_p-AfPpn1cvX-cB5DZQbnw0WMw91IPtEfddGV_eoYbu4dX-wt61-8bEPMgHyDNsSUzYopGxVT1R--akOOgHx3bcihmpVDNSpHVH_4URtyBOS7b0OOqFk5okbliOsPP25DjoB8wzbkiJuVI26t79zINUNb6K3FWm2mdzwZ5kssJ2X1zizwm9GL0zbl4_TEnf6rc7SufKvKh_G2fHUMWB8ecOAhB5as3LLvp2XAyFQYPODAQw4sWbkrI7uiVZXu_UlH_nlHXlhezqxXpWOO4H6YENwPE4L7YUpwgiYE73ME98OE4H6YENwPU4ITNCH4gCP4HUdRP0wo6ocJRf0wpShBE4recxT1w4SifphQ1A9TihI0oeiQo6hk9QSCJiQlaMJSgqY0pXCqK_DKAq8t8OoCsy_wCoNkNQZ5VRmCbPXTlK1-mrLVT5O2Ejhla0hZur6zkLYUSlO2BvWlYJyy9ao8eG1ND__9CgAA___b20hi

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmM1q20AUhfd9CnNXLajYd0b-hUJKG2ggJCXxrnihWNPY4FhGkiFuyLsX29SOJesejUZKl07yea6O5jsa5YWWUWhugieT0OgXMXmkyCNNHvnkUZcmHq3iaGqSJIq3f7IHrsJnGnU8mi9X63T744lH0yg2NHqhdJ4uDI1oHDwszJ0JQhO3O-RRaNJgvtgts4rnT0G8uXje_CGPbtfpqHXB3oWiyatH0To9fmmSBo-GRvzqlV_4-zxJ58tp2u6ernpuiSP1sGnNgmR2HjlOomwmeRsBu2agK2XATYTgF45y_Kr1MopDE5vw5Mt231I4rOrgYY9TdJuaokRkxyl6DlN4lQb9ESSze5Perto6k9d4szKj1tXN-PLu_vLbuPX1-po8Wpjf6cfdRXz6Es8fZ_8-HLdd4cX16434Jvocrdq6m43h7NqDk7XZwrRaywYsfNg1vcbLxiYC1wx0pQy4iRD8wlEcNefqZVPjFCUiKyobuymcy4bftWxU-d2uahUeLHy4c_3GhbeIgF0z0JUy4CZC8AtHcVRNVRe-xilKRFYkvN0UzsKrdxVel9_tulbhwcKHOzdoXHiLCNg1A10pA24iBL9wFEfVdHXha5yiRGRFwttN4Sy8flfh_fK73a9VeLDw4c4NGxfeIgJ2zUBXyoCbCMEvHMVRNb-68DVOUSKyIuHtpnAW3v9v_z84M9edSVbRMjGl_jvQ2V6ZCR_NPqkkWsdT8zOOprtl9h9vd9zuB6FJ0v1vef_harn_1XbAtzBnYX4L-ycw28GsnOihC616LrTWMq3ExLWcuBaX7soryzCDuWVadZzovgutwU7zxcTBze5awCoL90QYXHRf3ig9eacMRHoow0MXsWUYiQ1oILZMI7FlGonNoEtRmcq1AtwGNJIb4MhuhIOdDnDkN8uVygjPtYuE5xxnuV7Qpcv9wsByzjWM1SNYpuEzGODoISzj8Cks49BWuV55AILP9auVrTINbZVxaCvA0ZaVcWhrrmVPglcMjk9yy2bwnK0qVzU2tiq5aRQ4vSn5HAOCAzSyFeHAVoAjWwEOD81yyaouCD7Xsja2AhrZCnBkK8LRlpVxZKuSj7BqAHC5ZTN43lb5FIsuXW4a3QHvWrmmsbEV0MhWhANbAY5sBTiyVcslqxUIPteyVm-5Mg1fc2UcvucCHL3oyjiyVctHWY2ik1s2g-ds1fJZNnvpk9cPfwMAAP__buTmDQ==

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8K52phGLNnOh2GQMQorlLa0vRgMX7ix1gTS2MgONCv57yNJQ2c7Oa8VD901jR_p-Og5efVKyyzV18mzLij6RZIEKRLkk6CABIUUC8pNNtVFkZntI3vgMn2hyBM0X-arcvvvWNA0M5qiVyrn5UJTRA_J40Lf6STVpu-RoFSXyXyx2yY38-fErCcv6z8k6GZVRr2JongjKFuVbyu-L_S47s2SYlZdYiIp3sSCijJ50hTJjTivshBXJjtVpk5W9r7OapmZVBudVlaKtyR65Mjr_UiK2b0ub_K-rPX9YZ3rqHfx8_vF7UPv29UVCVro3-XHifz01cyfZru_Tr73-zv5Nt2-z0ypTV-G9TZ9Prl-0KJnx9rxtuiRIq6zL1neV169wUe3Dyvby_YySbeaW1Q2cKu5dKu5dKE56PZB88G5mqv2p6ncemZR2dCtZ8qtZ8qFZ6DbB8-G53rmtz9N361nFpWN3Hrmu_XMd-EZ6PbBs9G5ngXtTzNw65lFZWO3ngVuPQtceAa6ffBs_D-uh0fWv9NFni0L3erm520bptMnvT-AIluZqb412XS3zf7jzY7b3QdSXZT7b9X-w-Vy_9W2wPbwsAssZSc67ESPeVpa9EzZwcMucK1ntnTYiR7ztKrT3r-0X4G9OuyzcMCfVsDCSvJbh13mg4fBfPAwmg9Ag_kANJiPQZf54GEwHzyM5gPQYD4ADeZjyFo64iUddZmPcRfDeRgYzsPIcEADwwGNEsAmNpu_pDa5aUvDELBKTmscaC4bKVJRVSpedMnHCDBdNnLERnVAA9cBjWRHOLAd4Uj3RoZa6c7TSHeehroDHOkOcKR7I0irug-A7o1MsdK9kSlWuvM00p2noe4AR7oDHOneyFMr3Xka6c7TUHeAI90BjnRvpGr1ru3xuqtGtrC6x5sPfwMAAP__S381-g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mN1rGkEUxd_7V8h9aukWnQ8_oWBpAw2EJCR5KBQfNu40CsaV3RViQ_73olaNO-49M-7qWz48c--5c8-PXV9pGkfmOnw2KfV-k6CAJAWkKCBNATVpENAsiYcmTeNk-ZG14DJ6oV4joPF0Ns-Wfx4ENIwTQ71XysbZxFCPHsLHibkzYWSSeoMCikwWjierMrNk_Bwmi_7L4i8FdDPPerW-pMFbQPE8252YZuGToZ54C9yr_hin2Xg6zOrN_ZJ9kTt_J3lc1EZhOjrw-V0P0qeH986Fg_V8a7uy6ijrolrvurCJ3TnzaZxEJjHR3kmrUwrblA3Q5q6F5qlaQJPatdAq0UJwVJc_w3R0b7KbWV3lJvWwmJle7eLX94vbh9q3qysKaGL-ZB_74tPXZPw0Wv3ksF5tn_W6j5PMJHVljexz4fkdh5kdGsf_Qw80cR1_iWd13cgP-GD57l554RHa6nAFqm43sXVCXPk4d7DuiitX66Ja77qwiZKsEEfiqsIW0KSKcOXXQmlciXPgCqzXBlfWyFxxJd1TI6vjBai6XYX2CXnh4Vw4WHflhat1Ua13XdhEybDKI3lRYQtoUkW88GuhNC_kOXgB1mvDC2tkrrxQ7qlR1fECVN2uQueEvPBwLhysu_LC1bqo1rsubKJkWNWRvKiwBTSpIl74tVCaF-ocvADrteGFNTJXXmj31OjqeAGqblehe0JeeDgXDtZdeeFqXVTrXRc2UTKs-kheVNgCmlQRL_xaKM0LfQ5egPXa8MIa2TFfnxw4_86ks3iaGqdvRhrLgZnoyawvII3nydDcJvFwVWb9681Kt_pDZNJs_V-x_uVyuv7XssH3YpEXi_divScWfmKhyqilKKXullGrNq-W7MQVP3HFlm7ylXmxAPfFq6Uso1aNUuoOr9bsxFu8uOkhlnlxixW3-btus2LgucOKNQh2l6dCA2DBgooXF3g1BAMvh2QAcoQGXo7YICy07A9egsFbbPHBA1AjPgA5AgSQI0IgOYiLsAizP3g0Oh4xObmFCcFDRrTAtfOYQdZ5zogOKG6RxivsvBqGnZfDsAM5Cjsvh2HnKSsBZSWPGrCxQI3CDuQo7ECOwo7kYOMlT1kJlk7yT3A5uRV2yaNGanDtPGqQdZ40EpBGWqTxCTtQo7ADOQo7koOwAzl86ucpKwFlJY8aFHZAWXRvAJMo7ACTKOxAjjaep6wCW6P4F-Sc3Aq74lGjwAOd4lEDrCueNAqQRlmk8Qk7UKOwAzkKO5KDsAM5CrviKasAZRWPGvSWDyiL7g1gEr3nA0yiF30gRxvPU1aha-ffmnNyO-w8ajR4oNM8avLWB28f_gUAAP__TrDF2w==

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8llFrGkEQx9_7KWSeWtiiu3eaeFCwlEADIYbUh0K5h4s3VcG4x-4KscHvXrwrtZ5257ZD9y3G--3-Z-4H_l9ho0u8L57RQvYNJAhQICABASkIGEIuoDJ6jtZqc3ikAW7LF8gGAlabausO_84FzLVByF7BrdwaIYNZ8bTGRyxKNP0BCCjRFat1fU1lVs-F2U1edj9AwHTrst5EQb4XoLfu14nHg552vWVhl6dHTCTk-1yAdcUCIZN78W_Jhv87mfprsuM52402JRosT07KDyT1yIXxPhd2-QXdtOrL1t5nuwqz3s3XTzcPs97HuzsQsMbv7u1EvvtgVotl_dfvuWVr7uNMCWOmC4Hv9Xtd9eWwPf3Fu9OTu2X3Ny3jOhiQbBTXQRnXQRnDQdV92yquBwHJruJ6oOJ6oGJ4kHTfdhLXg4Bk13E9SOJ6kMTwIO2-7TSuBwHJxnE9SON6kMbuJhfiPKKt9MZip-YxOAyE5QKbBVm9NXN8MHpeX9N8nNZc_RtbonXNt6r5cLtpvjoE7A6POPCYA0tWbjn00zJgZSoMHnHgMQeWrNytlZ3Rqk0P_qQT_74TLyxPdzZo0ylHcD9MCO6HCcH9MCU4QROCDzmC-2FCcD9MCO6HKcEJmhB8xBH8iqOoHyYU9cOEon6YUpSgCUWvOYr6YUJRP0wo6ocpRQmaUHTMUVSyegJBE5ISNGEpQVOaUjjVFXhlgdcWeHWB2Rd4hUGyGoM8qwxBtvppylY_Tdnqp0lbCZyyNaQsnb-zkLYUSlO2BvWlYJyy9aw8eG3N929-BgAA___QQDFg

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l99r4koUx9_vXyHn6V7IRc9M_AkXvOwWtlDa0u3DwuJDamarYE1IItQt_d8XFbQmzfk6mdG3Vv1kzjmZzzeTN1omsbmNXkxOo5_EFJCigDQFFFJAXZoElGbJ1OR5km1-sgOu41cadQKaL9NVsfl4EtA0yQyN3qiYFwtDI3qMnhbmwUSxydodCig2RTRfbJdJs_lLlK3Hr-vfFNDdqhi1xoom7wElq-JwxbyIng2N-D04fdWv87yYL6dFu3u85JhL1z8gT-vWLMpnn_z-UIOyqeFj5-zUum7UOvvtPawt4nCd1TLJYpOZ-OhK26vUlqk6oMxDCd1zlYAmdSih51BC0KjKb1E--26Ku7StS5N6XKdm1Lr68eXq_rH1_80NBbQwv4q_x_zPf9n8ebb9a7-96nvq-x3rbfJvkrZ1t9z9p2sPjtZmC6P8ZQlYdb9NemfMEpvOnVrXjVpnv72HtUU4iswNs8RjCWhSdVliV4JzlvAlskSdvquVP5_Bqvtb1T-jzxads1PrulHr7Lf3sLYIR5lUQ589loAmVeezXQnOPqtL-KxP39Xan89g1f2tGpzRZ4vO2al13ah19tt7WFuEo0y6oc8eS0CTqvPZrgRnn_UlfA5P39WhP5_BqvtbNTyjzxads1PrulHr7Lf3sLYIR5nChj57LAFNqs5nuxKcfQ4v_e7-STkPJk-TZW5OejPvbBoy8bPZDShPVtnU3GfJdLvM7t-7Lbf9IDZ5sfuWd_9cL3dfbQr8CHMZ5o9weASzHczKiR660KrnQmst00qcuJYnrsWlu_LKMsygbplWHSe670JrsNNCceLgZnctYFWGeyIMmu7LG6Un75SBSA9leOgitgwjsQENxJZpJLZMI7EZZCkKUzlWgNuARnIDHNmNcLDTAY78ZjlSGeGVdJHwiuMsxwtqXc4XBpZzJWGsHsEyDZ_BAEcPYRmHT2EZh7bK8coDMPhKvlrZKtPQVhmHtgIcbVkZh7ZWUvZo8IrB8UlO2RJesVVVosbGViUnjQKnNyWfY8DgAI1sRTiwFeDIVoDDQ7McsqoLBl9JWRtbAY1sBTiyFeFoy8o4slXJR1g1ALicsiW8aqt8ikWty0mjO-Bdq5I0NrYCGtmKcGArwJGtAEe2ajlktQKDr6Ss1VuuTMPXXBmH77kARy-6Mo5s1fJRVqPRySlbwiu2avksW2598v7XnwAAAP__kVbCsw==

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll1r2zAUhu_3K8K52phGLNnOh6HQMTpWKG1pczHYcuHGWhNIYyMr0Kz0v48kDZ3j9LxWXIzv6tqPdKzzvDl-okWa6Mv4QecU_SJJghQJ8klQQIJCGgvKTDrReZ6a9SNb4Dx5pMgTNFtkS7v-91jQJDWaoieyMzvXFNEovpvrGx0n2nQ9EpRoG8_mm20yM3uIzer0cfWXBH2fza02UedUdn4vPc-fdFQUReeXowEJulra9R0aPwtKl_Zlu9dd7ladaZxPi-tvnh8Lym18rymSz-K4skOXsvXJe9et3qz7dZ3lIjWJNjoprDRek-iRAy__I86nt9peZV2517LRKtNR5-znt7PrUefrxQUJmus_9uOp_HRiZvfTzV9vvvfrO_kuvbhNjdWmK8P9Y_r85vpBhTM7dBwvix4o4jL9kmZd5e0f8MHtw8L2srpqskUJcSi716aEyGYTIptICOjFLiG9YxOiqvdatUhRh7L7bVJUNauoakJR0Iudov1jFfWr99pvkaIOZQ_apKjfrKJ-E4qCXuwUHRyraFC910GLFHUoe9gmRYNmFQ2aUBT0Yqfo8D0-hQ-sf6PzLF3kutJXrrc-MJ3c620D8nRpJvrapJPNNtvLqw23-YBJdG63d9X24nyxvbUusDrcrwNLWYsOa9FDnpYOZ6bc4H4deO_MXOmwFj3kabVPe__TfgH29mGfhQO-WwELK8lvHdbJBw-DfPAwygegQT4ADfLRq5MPHgb54GGUD0CDfAAa5KPPWjrgJR3UycewjuE8DAznYWQ4oIHhgEYTwGVsln9JXeamKw2HgNPkdMaB5rI0RQqqSsWLLvkxAkyXpTniojqggeuARrIjHNiOcKR7aYY66c7TSHeehroDHOkOcKR7aZAWde8B3UszxUn30kxx0p2nke48DXUHONId4Ej30jx10p2nke48DXUHONId4Ej30lQtfmt7vO6qNFtY3cfPH_4FAAD__2aEg94=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v2kgYhe_3V6C52tV6heeDL0uRsmpTNVKURAkXlVouHDwNlghGtpFCo_z3CigQPPg9Hsb4LsGcmeMz73lk88ZmSaRvwxedseA748xjgnlMMo8p5rEOG3lsniZjnWVJuvrKRnAdvbLA91g8my_y1ccjj42TVLPgjeVxPtUsYMPwaaofdBjptO0zj0U6D-Ppept5Gr-E6fLydfmLeexLPM11GrQueevHwvfluCWCILi-HfaZx-4W-eoKG717LFnk--2yPHzWLODvXnVLn-Msj2fjvN059GOsv5c8LVuTMJsc-f7eg7Dx8DEWbpWLvrAJRp4UDK83GVVqYr_OYpakkU51dLDSepVSm8IHNvcWOueygJLaW-g6WPBOcvk1zCaPOr-bt2UhqeFyroPW1bdPV_fD1v83N8xjU_0z__uS_3ORxs-T9V8VxqtnM16PSZrrtC2NyP4tXb9fIbNjcfxZ9IiJ2-S_ZN5WfjHgo9sPDrbnFpVuiHTA0m5Mu2cknU0sVrm4kK5qMLzeZFSpCUfM8BNJV6MFlFQZ6ewsOJOON0E6MF5b0hmRVSWdqN4p0RBqgKXdnPTOiBqLWLhVLi6oqRoMrzcZVWrCsefiRNTUaAElVYYaOwvOqBFNoAaM1xY1RmRVUSOrd0o2hBpgaTcn_TOixiIWbpWLC2qqBsPrTUaVmnDsuTwRNTVaQEmVocbOgjNqZBOoAeO1RY0RWVXUqOqdUg2hBljazcngjKixiIVb5eKCmqrB8HqTUaUmHHuuTkRNjRZQUmWosbPgjBrVBGrAeG1RY0R2yk9FR9Z_0Nk8mWW60q9A_iowHT3rzQFkySId6_s0Ga-32fx7t9atP4h0lm-u8s0_17PNpZXBj2JeFPOPYnUg5nZiLl3UgjupBy5q2aPVgkxc0olLcusOvTMt5uC8aLUQLmrpO6n7tFqRiXdpccdCLIriLinu0WfdI8XgnvukWIFiD2gq-AALBlSsuECrIRhoOSQDkCM00HLEBm6g5TB4AYI32GKDB6BGfAByBAggR4RAclAXbhDmMHgUHY2YgtzABKchw7vg2GnMoFunOcP7YHODNFZlp9Ww7LQclh3IUdlpOSw7TVkBKCto1ICJBWpUdiBHZQdyVHYkBxMvaMoKMHSCfoIryI2yCxo1QoFjp1GDbp0mjQCkEQZpbMoO1KjsQI7KjuSg7EAOn_ppygpAWUGjBpUdUBadG8AkKjvAJCo7kKOJpykrwdRI-gW5IDfKLmnUSPBAJ2nUgFuXNGkkII00SGNTdqBGZQdyVHYkB2UHclR2SVNWAspKGjXoLR9QFp0bwCR6zweYRC_6QI4mnqasRMdOvzUX5GbZadQo8ECnaNQUb330_tfvAAAA__81gBPO

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll9r2zwUxu_fT2HO1TumEUu288dQyBgdK5S2tLkYbL5wY60JpLGRFWhW8t1Hkmad7VSPFRfju6bxTzrW-T05eqZlmsir-FHmFP4gTowEMfKIkU-MAooYZSqdyjxP1faRPXCRPFHoMpovs5Xe_jtiNE2VpPCZ9FwvJIU0ie8X8lbGiVQ9lxglUsfzxW6bTM0fY7UeP61_E6Ov84WWKnTG3Pm5cl1Pnjk8DMOLq8mQGF2vdOiMBUUbRulKv-z3us392pnF-ay4wZhTtIkY5Tp-kBTyDTut7sCm7qnjvW_Z4s2yX9dZLVOVSCWTwkrRlkSPHHn3b3E-u5P6OuvxUssm60yGzvn3L-c3E-fz5SUxWshf-v8x_3Cm5g-z3V9_35uX3vv1nTybVtylSkvV40H5mD6-ub5f48yOHcfLokeKuEo_pVlPuOUDPrp9UNie1zeNdykhFnX3O5QQ3m5CeBsJAa04JKR_akJE_VaLLilqUfegQ4qKdhUVbSgKWnFQdHCqol79VntdUtSi7mGHFPXaVdRrQ1HQioOiw1MV9eu32u-SohZ1jzqkqN-uon4bioJWHBQdvcdV-Mj6tzLP0mUua91y3e2ByeRB7huQpys1lTcqne622X-83nG7C0wic73_Vuw_XCz3X20LrA8PmsCcN6KDRvTITHOLMxN28KAJXDozWzpoRI_MtCjT7r-0V4DdMuwZYd_cLd8IC27eOmiSDzMM8mGGUT4ADfIBaJCPfpN8mGGQDzOM8gFokA9Ag3wMjJYOzZIOm-Rj1MRwMwwMN8PIcEADwwGNJoDN2Kz-ktrMTVsaDgGryWmNA815ZYoUVOXCLDo3jxFgOq_MERvVAQ1cBzSSHeHAdoQj3Ssz1Ep3M410N9NQd4Aj3QGOdK8M0qLufaB7ZaZY6V6ZKVa6m2mku5mGugMc6Q5wpHtlnlrpbqaR7mYa6g5wpDvAke6VqVq8a7tm3UVlthh1jzb__QkAAP__A0qD6A==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mEtv8kYYhff9FdasWtUVngs3S59E1aZqpCiJEhaVWhYOngZLBCPbSKFR_nsFfEDw4Pd4GOMdtzNzfOY9j2w-2CKN9X30pnMW_s0485lgPpPMZ4r5rMsmPltm6VTneZptfrIT3MbvLAx8liyWq2Lz8cRn0zTTLPxgRVLMNQvZOHqZ6ycdxTrrBMxnsS6iZL7dZpklb1G2Hr2v_2M--yOZFzoLvRH3_lkFgdTfPB6G4e39eMB89rAqQm8k2OTTZ-mqOO6XF9GrZiH_9Ot7-j3Ji2QxLTrdU0MjXlr_KHlZe7Mon535_dGDsPHwNRduFczUk_VzkRflwpsNRlWaOK6zWqRZrDMdn6y0XaXSpgiAzaOF7rUsoKSOFnoOFvyLXP4Z5bNnXTwsO7KU1Hi91KF389dvN49j79e7O-azuf63-HHEf_qWJa-z7avDeFVfU99mvJ7TrNBZRxqR_Vy5_qBGZufi-L7oGRP36S_psqOCcsBntx-ebM8tGt0W6YCnw5z2rkg6m1ysgnEgXd1ceLPBqEoTjpjhF5KuQQsoqSrS2VlwJh1vg3RgvPakMyKrSzpRv1KiLdQAT4dB6V8RNRa5cKtgHFBTNxfebDCq0oRjz8WFqGnQAkqqCjV2FpxRI9pADRivPWqMyOqiRtavlGwLNcDTYVAGV0SNRS7cKhgH1NTNhTcbjKo04dhzeSFqGrSAkqpCjZ0FZ9TINlADxmuPGiOyuqhR9Sul2kIN8HQYlOEVUWORC7cKxgE1dXPhzQajKk049lxdiJoGLaCkqlBjZ8EZNaoN1IDx2qPGiOySv4rOrP-k82W6yHWtf4GCTWA6ftW7A8jTVTbVj1k63W6ze_uw1W0_iHVe7L7luze3i91XG4Nfxbws5l_F6kTM7cRcuqgFd1IPXdSyT6sFmbikE5fk1l16Z1rMwXnRaiFc1DJwUg9otSIT79HiroVYlMU9Utynz7pPisE1D0ixAsUe0lQIABYMqFhxgVZDMNBySAYgR2ig5YgN3EDLafACBG-wxQYPQI34AOQIEECOCIHkoC7cIMxp8Cg6GjEluYEJTkOG98Cx05hBl05zhg_A5gZprMpOq2HZaTksO5CjstNyWHaasgJQVtCoARML1KjsQI7KDuSo7EgOJl7QlBVg6AR9B1eSG2UXNGqEAsdOowZdOk0aAUgjDNLYlB2oUdmBHJUdyUHZgRze9dOUFYCygkYNKjugLDo3gElUdoBJVHYgRxNPU1aCqZH0A3JJbpRd0qiR4IZO0qgBly5p0khAGmmQxqbsQI3KDuSo7EgOyg7kqOySpqwElJU0atBTPqAsOjeASfScDzCJHvSBHE08TVmJjp1-ai7JzbLTqFHghk7RqClf-uTzh_8DAAD__xG7E9g=

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll2L2kAUhu_7K-RctTBFZxLdNVCwlIUuLOuy9aJQcpE1pyq4TpiMsHbxvxdNF-tHz8n0QHIZk2fmnTMP-L7CyuZ4nz1jCckP0KDAgIIIFMSgoA-pgsLZKZaldbtPKuA2f4Gkp2CxKtZ-93OqYGodQvIKfuGXCAlMsqclPmKWo-v2QEGOPlss99sUbvGcuc3oZfMLFIzXPumMtBoZSLcK7Nr_WfSw1tOmM8_K-fEqb0iqoPTZDCHRW_V_-fp8PqNGWprP_DPfYan1yrocHeZHi6U7kvvkwiG_ZuX8G_px0dUndzDZFJh0br5_uXmYdD7f3YGCJf707_epP3xyi9n87YG6o8PhIsHhLiS_tx9t0dX90zFc3Ds-2lvXv3jdhpgB-QZtiKmbFVM3KqapP3zThhwB-a7akMM0K4dpVI6o_vCjNuQIyHfdhhxRs3JEjcoR1x9-3IYcAfmGbcgRNytH3FrfuZDrEcvCrkqs1WZ6u5NhPsNqUqVduyk-ODvdb1M9jvfc_r86x9JXb031cLuqXu0C1ocHEngogbUot-7TtA4YmQmDBxJ4KIG1KPfJyM5oc0r3_qYjet4RCevjmfVO6VgiOA0zgtMwIzgNc4IzNCN4XyI4DTOC0zAjOA1zgjM0I_hAIviVRFEaZhSlYUZRGuYUZWhG0WuJojTMKErDjKI0zCnK0IyiQ4miWtQTGJqRlKEZSxma05TDua4gKwuytiCrC8K-ICsMWtQY9FllCLKVpjlbaZqzlaZZWxmcszWkLJ3fWUhbCqU5W4P6UjDO2XpWHkhb0-273wEAAP__OWBG8A==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r2zwUxu_fTxF09Q40kiM5f2GQsRVWKG3pejEYuXBjrQmksbEdaFb63UcSljR2fB4psrvLtP1Fx4_1eyz3RSzjyFyHTyYTo5-ChBRKSKGFFIGQoismUiRpPDVZFqebP9kBl9GzGHWkmC-TVb758USKaZwaMXoR-TxfGDES9-HDwtyZMDJpuyOkiEwezhfbZZJ0_hSm6_Hz-reQ4maVj1pjkmMlJq9SxKv88KVZHj4aMaJXab_w13mWz5fTvN09XvXUEgfqYd2ahdnsNHKYRLlM8jYCsshAyTFVZqDPyoCaCCGoHOXwVatlnEYmNdHRl22_pXJY1cHDHqboNjWFRWSHKXoeU8izBv0WZrPvJr9J2rqQ1_06MaPWxY8vF7f3rc9XV0KKhfmV_7-9gg-f0vnj7O8HO-_69UZ8HX-Mk7buFmM4ufbgaG1yMK3WsgEL73dNr_GycYnAIgOHsrHNgJoIIagcxVNzOr9sapzCIrKqsnGbwrts6F3LRtnvdlWr8GDh_Z3rNy68QwRkkYGD8LYZUBMhBJWjeKqmzhe-xiksIqsS3m0Kb-HVuwqv7Xe7rlV4sPD-zg0aF94hArLIwEF42wyoiRCCylE8VdPnC1_jFBaRVQnvNoW38PpdhQ_sd3tQq_Bg4f2dGzYuvEMEZJGBg_C2GVATIQSVo3iqFpwvfI1TWERWJbzbFN7CB__s_wcn5rozWRIvM2P134HO5spM9Gh2SWXxKp2a2zSebpfZfbzZctsfRCbLd7-l3YfL5e5XmwHfwlSE6S0cHMHkBpPyooc-tOr50FrztGIT13ziml26y6_MwwTm5mnV8aL7PrQGOy1gEwc3u-sAqyLcY2Fw0X1-o_T4nTJg6SEPD33E5mEkNqCB2DyNxOZpJDaBLkVlytcKcBvQSG6AI7sRDnY6wJHfxFcqIbzULhxecpz4ekGXzvcLAcup1DBOj2Cehs9ggKOHMI_DpzCPQ1v5eqUBCL7Ur0628jS0lcehrQBHW5bHoa2llj0KXhE4PvEtW8BLtqpS1bjYqvimUeD0pvhzDAgO0MhWhANbAY5sBTg8NPMlq7og-FLLutgKaGQrwJGtCEdblseRrYo_wqoBwPmWLeBlW_lTLLp0vml0B7xrlZrGxVZAI1sRDmwFOLIV4MhWzZesViD4Uss6veXyNHzN5XH4ngtw9KLL48hWzR9lNYqOb9kCXrJV82fZ4qVPXv_7EwAA__8-uOSb

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8K52phGLNnOh2HQMQorlLa0vRiMXLix1gTSyMgONCv97yNJQ2c7Oa8VD901jR_p-Og5efVCS5Ppq_RJF5T8IkmCFAkKSVBEgmKaCMqtmeqiMHbzyA64yJ4pCQTNl_mq3Px7ImhqrKbkhcp5udCU0H36sNC3Os207QckKNNlOl9st8nt_Cm167Pn9R8SdL0qk96ZpMmrILMq31Z8X-hh3Zulxay6xPb5iaCiTB81JfJVnFZZjCtTnSpTRyt7X2e1NDbTVmeVlSYbEj1y4PV-pMXsTpfXeV_W-n6_znXSO__5_fzmvvft8pIELfTv8uOZ_PTVzh9n27-Onsj7O4Uu3b4zttS2L-N6mz4fXT9q0bND7Xhb9EARV-aLyfsqqDf44PZxZXvZXibpV3OHygZ-NZd-NZc-NAfd3ms-OFVz1f40lV_PHCob-vVM-fVM-fAMdHvv2fBUz8L2pxn69cyhspFfz0K_noU-PAPd3ns2OtWzqP1pRn49c6hs7NezyK9nkQ_PQLf3no3_x_XwwPq3usjNstCtbn7BpmE6e9S7AyjMyk71jTXT7Ta7j9dbbnsfyHRR7r5Vuw8Xy91XmwLbw8MusJSd6LgTPeZp6dAz5QYPu8C1nrnScSd6zNOqTgf_0mEFDupwyMIRf1oRCyvJbx13mQ8eBvPBw2g-AA3mA9BgPgZd5oOHwXzwMJoPQIP5ADSYjyFr6YiXdNRlPsZdDOdhYDgPI8MBDQwHNEoAl9hs_pK65KYrDUPAKTmdcaC5bKRIRVWpeNElHyPAdNnIERfVAQ1cBzSSHeHAdoQj3RsZ6qQ7TyPdeRrqDnCkO8CR7o0greo-ALo3MsVJ90amOOnO00h3noa6AxzpDnCkeyNPnXTnaaQ7T0PdAY50BzjSvZGq1bt2wOuuGtnC6j55_fA3AAD__0h9Nfo=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mN1r4loUxd_vXyH76V5uBj0ffsJAh5nCFEpb2j4MDD6k5kwVrJEkQp3S_31QR605Zq9zkuhbP1xn77XPXj8S32gWR-YmfDEpDX6SoIAkBaQoIE0BtWkY0DyJRyZN42T1kY3gKnqlQSugyWy-yFZ_HgY0ihNDgzfKJtnU0IAew6epuTdhZJJmiwKKTBZOpusy82TyEibLi9flbwrodpENGheChu8BxYtsf2Kahc-GBuI9cK_6bZJmk9koa7YPS1rn7yVPy8Y4TMdHPr_vQfr08NG5cLAuC62rUtZFvd51YRP7cxazOIlMYqKDk9anFLYpW6DNfQvtU7WAJrVvoVOhhaBUl9_DdPxgstt5U-Um9bicm0Hj8sfXy7vHxpfrawpoan5l_16I_z4nk-fx-ieHZHV91ushTjKTNJU1sv8Lz-85zOzYOP4eeqSJm_hTPG_qVn7AR8v3D8oLj9DWhytQdbeJnRPiyse5g3VXXLlaF_V614VNVGSFKImrGltAkyrClV8LlXElzoErsF5bXFkjc8WVdE-NrI8XoOpuFbon5IWHc-Fg3ZUXrtZFvd51YRMVwypL8qLGFtCkinjh10JlXshz8AKs15YX1shceaHcU6Pq4wWouluF3gl54eFcOFh35YWrdVGvd13YRMWwqpK8qLEFNKkiXvi1UJkX6hy8AOu15YU1MldeaPfU6Pp4AaruVqF_Ql54OBcO1l154Wpd1OtdFzZRMay6JC9qbAFNqogXfi1U5oU-By_Aem15YY2szNcnR86_N-k8nqXG6ZuR1mpgJno2mwtI40UyMndJPFqX2fx6u9at_xCZNNv8V2x-uZpt_rVq8KNY5MXio1gfiIWfWKgqaikqqftV1KrLqyU7ccVPXLGl23xlXizAffFqKauoVauSuserNTvxDi9ue4hlXtxhxV3-rrusGHjusWINgt3nqdACWLCg4sUFXg3BwMshGYAcoYGXIzYICy2Hg5dg8BZbfPAA1IgPQI4AAeSIEEgO4iIswhwOHo2OR0xObmFC8JARHXDtPGaQdZ4zogeKW6TxCjuvhmHn5TDsQI7Czsth2HnKSkBZyaMGbCxQo7ADOQo7kKOwIznYeMlTVoKlk_wTXE5uhV3yqJEaXDuPGmSdJ40EpJEWaXzCDtQo7ECOwo7kIOxADp_6ecpKQFnJowaFHVAW3RvAJAo7wCQKO5Cjjecpq8DWKP4FOSe3wq541CjwQKd41ADriieNAqRRFml8wg7UKOxAjsKO5CDsQI7CrnjKKkBZxaMGveUDyqJ7A5hE7_kAk-hFH8jRxvOUVeja-bfmnNwOO48aDR7oNI-avPXh-z9_AgAA__9JycXb

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9r2zwUxu_fTxHO1TumEUu288cw6BiFFUpb2l4MRi7cWGsCaWRkB5qVfveRpKGznZzHijfdNY1_0vHR7-TRCy1Npq_SJ11Q8oMkCVIkKCRBEQmKaSIot2aqi8LYzSM74CJ7piQQNF_mq3Lz74mgqbGakhcq5-VCU0L36cNC3-o007YfkKBMl-l8sd0mt_On1K7Pnte_SND1qkx6Z5Imr4LMqnxb8X2hh3Vvlhaz6hLb5yeCijJ91JTIV3FaZfG_rkwdrex9ndXS2ExbnVVWmmxI9MiB1_uWFrM7XV7nfVnr-_0610nv_PvX85v73pfLSxK00D_L_8_kh892_jjb_nX0vd_fKXTp9p2xpbZ9Gdfb9PHo-lGLnh1qx9uiB4q4Mp9M3ldBvcEHt48r28v2Mkm_mjtUNvCrufSrufShOej2XvPBqZqr9qep_HrmUNnQr2fKr2fKh2eg23vPhqd6FrY_zdCvZw6Vjfx6Fvr1LPThGej23rPRqZ5F7U8z8uuZQ2Vjv55Ffj2LfHgGur33bPw3rocH1r_VRW6WhW518ws2DdPZo94dQGFWdqpvrJlut9l9vN5y2_tApoty963afbhY7r7aFNgeHnaBpexEx53oMU9Lh54pN3jYBa71zJWOO9FjnlZ1OviTDitwUIdDFo7404pYWEl-67jLfPAwmA8eRvMBaDAfgAbzMegyHzwM5oOH0XwAGswHoMF8DFlLR7ykoy7zMe5iOA8Dw3kYGQ5oYDigUQK4xGbzl9QlN11pGAJOyemMA81lI0UqqkrFiy75GAGmy0aOuKgOaOA6oJHsCAe2Ixzp3shQJ915GunO01B3gCPdAY50bwRpVfcB0L2RKU66NzLFSXeeRrrzNNQd4Eh3gCPdG3nqpDtPI915GuoOcKQ7wJHujVSt3rUDXnfVyBZW98nrf78DAAD__9ymNfU=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v2koQxd_vp0D7dK-uK9id5a9UKVUbqZGiJEryUKniwcHbgEQwso0UGuW7V0CB4MVzvF7DW_5wdubMzvnJ5k3M4sjchC8mFYOfQopAKBEIEoHQIhBtMQzEPIlHJk3jZPWRjeAqehWDViAms_kiW_15GIhRnBgxeBPZJJsaMRCP4dPU3JswMkmzJQIRmSycTNdl5snkJUyWF6_L3yIQt4ts0LiQYvgeiHiR7U9Ms_DZiIF8D8pX_TZJs8lslDXbhyWt8_eSp2VjHKbjI5_f96BcevjoXHpZp0rWZb3edWET-3MWsziJTGKig5PWpxS2qVqgzX0L7VO1gCa1b6Hj0UJQqcvvYTp-MNntvEm5ST0u52bQuPzx9fLusfHl-loEYmp-Zf9eyP8-J5Pn8fqnEuvVdVmvhzjJTNIka2T_F57fKzGzY-P4e-iRJm7iT_G8qVv5AR8t3z8oLx1CWx-uQNXdJnZOiCsX517WqZJ1Wa93XdiEJytkRVzV2AKaVBGu3FrwxpU8B67Aem1xZY2sLK5U-dSo-ngBqu5WoXtCXjg4l17WqZJ1Wa93XdiEZ1hVRV7U2AKaVBEv3Frw5oU6By_Aem15YY2sLC-ofGqoPl6AqrtV6J2QFw7OpZd1qmRd1utdFzbhGVaqyIsaW0CTKuKFWwvevKBz8AKs15YX1sjK8kKXT42ujxeg6m4V-ifkhYNz6WWdKlmX9XrXhU14hlVX5EWNLaBJFfHCrQVvXuhz8AKs15YX1siqfH1y5Px7k87jWWpKfTPSWg3MRM9mcwFpvEhG5i6JR-sym19v17r1HyKTZpv_ys0vV7PNv1YNfhTLvFh-FOsDsXQTS_JRK-ml7vuoqcurFTtx4idObOk2X5kXS3BfvFopHzW1vNQ9Xq3ZiXd4cdtBrPLiDivu8nfdZcXAc48VaxDsPk-FFsCCBRUnLvBqCAZeDskA5AgNvByxQVpoORy8AoO32OKCB6BGfAByBAggR4RAchAXaRHmcPBodDxicnILE5KHjOyAa-cxg6zznJE9UNwijVPYeTUMOy-HYQdyFHZeDsPOU1YByioeNWBjgRqFHchR2IEchR3JwcYrnrIKLJ3in-BycivsikeN0uDaedQg6zxpFCCNskjjEnagRmEHchR2JAdhB3L41M9TVgHKKh41KOyAsujeACZR2AEmUdiBHG08T1kCW0P8C3JOboWdeNQQeKAjHjXAOvGkIUAaskjjEnagRmEHchR2JAdhB3IUduIpS4CyxKMGveUDyqJ7A5hE7_kAk-hFH8jRxvOUJXTt_FtzTm6HnUeNBg90mkdN3vrw_Z8_AQAA__-sJMXW

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8llFrGkEQx9_7KWSeWtiiu3eaeFCwlEADIYbUh0K5h4s3VcG4x-4KscHvXrwrtZ5257ZD9y3G--3-Z-4H_l9ho0u8L57RQvYNJAhQICABASkIGEIuoDJ6jtZqc3ikAW7LF8gGAlabausO_84FzLVByF7BrdwaIYNZ8bTGRyxKNP0BCCjRFat1fU1lVs-F2U1edj9AwHTrst5EQb4XoLfu14nHg552vWVhl6dHTCTk-1yAdcUCIZN78W_Jhv87mfprsuM52402JRosT07KDyT1yIXxPhd2-QXdtOrL1t5nuwqz3s3XTzcPs97HuzsQsMbv7u1EvvtgVotl_dfvuWVr7uNMCWOmC4Hv9Xtd9eWwPf3Fu9OTu2X3Ny3jOhiQbBTXQRnXQRnDQdV92yquBwHJruJ6oOJ6oGJ4kHTfdhLXg4Bk13E9SOJ6kMTwIO2-7TSuBwHJxnE9SON6kMbuJhfiPKKt9MZip-YxOAyE5QKbBVm9NXN8MHpeX9N8nNZc_RtbonXNt6r5cLtpvjoE7A6POPCYA0tWbjn00zJgZSoMHnHgMQeWrNytlZ3Rqk0P_qQT_74TLyxPdzZo0ylHcD9MCO6HCcH9MCU4QROCDzmC-2FCcD9MCO6HKcEJmhB8xBH8iqOoHyYU9cOEon6YUpSgCUWvOYr6YUJRP0wo6ocpRQmaUHTMUVSyegJBE5ISNGEpQVOaUjjVFXhlgdcWeHWB2Rd4hUGyGoM8qwxBtvppylY_Tdnqp0lbCZyyNaQsnb-zkLYUSlO2BvWlYJyy9aw8eG3N929-BgAA___QQDFg

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l99r4koUx9_vXyHn6V7IRc9M_AkXvOwWtlDa0u3DwuJDamarYE1IItQt_d8XFbQmzfk6mdG3Vv1kzjmZzzeTN1omsbmNXkxOo5_EFJCigDQFFFJAXZoElGbJ1OR5km1-sgOu41cadQKaL9NVsfl4EtA0yQyN3qiYFwtDI3qMnhbmwUSxydodCig2RTRfbJdJs_lLlK3Hr-vfFNDdqhi1xoom7wElq-JwxbyIng2N-D04fdWv87yYL6dFu3u85JhL1z8gT-vWLMpnn_z-UIOyqeFj5-zUum7UOvvtPawt4nCd1TLJYpOZ-OhK26vUlqk6oMxDCd1zlYAmdSih51BC0KjKb1E--26Ku7StS5N6XKdm1Lr68eXq_rH1_80NBbQwv4q_x_zPf9n8ebb9a7-96nvq-x3rbfJvkrZ1t9z9p2sPjtZmC6P8ZQlYdb9NemfMEpvOnVrXjVpnv72HtUU4iswNs8RjCWhSdVliV4JzlvAlskSdvquVP5_Bqvtb1T-jzxads1PrulHr7Lf3sLYIR5lUQ589loAmVeezXQnOPqtL-KxP39Xan89g1f2tGpzRZ4vO2al13ah19tt7WFuEo0y6oc8eS0CTqvPZrgRnn_UlfA5P39WhP5_BqvtbNTyjzxads1PrulHr7Lf3sLYIR5nChj57LAFNqs5nuxKcfQ4v_e7-STkPJk-TZW5OejPvbBoy8bPZDShPVtnU3GfJdLvM7t-7Lbf9IDZ5sfuWd_9cL3dfbQr8CHMZ5o9weASzHczKiR660KrnQmst00qcuJYnrsWlu_LKMsygbplWHSe670JrsNNCceLgZnctYFWGeyIMmu7LG6Un75SBSA9leOgitgwjsQENxJZpJLZMI7EZZCkKUzlWgNuARnIDHNmNcLDTAY78ZjlSGeGVdJHwiuMsxwtqXc4XBpZzJWGsHsEyDZ_BAEcPYRmHT2EZh7bK8coDMPhKvlrZKtPQVhmHtgIcbVkZh7ZWUvZo8IrB8UlO2RJesVVVosbGViUnjQKnNyWfY8DgAI1sRTiwFeDIVoDDQ7McsqoLBl9JWRtbAY1sBTiyFeFoy8o4slXJR1g1ALicsiW8aqt8ikWty0mjO-Bdq5I0NrYCGtmKcGArwJGtAEe2ajlktQKDr6Ss1VuuTMPXXBmH77kARy-6Mo5s1fJRVqPRySlbwiu2avksW2598v7XnwAAAP__kVbCsw==

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltFq2zAUhu_3FOFcbaCRSHbSxjDIGIUVSlO6XAyGL9z4LAmkkZEUaFby7iP2ShYn07F2wL507E_6dfRB_lfY6Bzvs2e0kPwACQIUCIhAQAwChpAKKIyeo7XaHD6pgNv8BZKBgNWm2LrDz6mAuTYIySu4lVsjJDDLntb4iFmOpj8AATm6bLUutynM6jkzu8nL7hcImG5d0ptIMVGQ7gXorfuz6HGtp11vmdnl6SpvSCrAumyBkMi9-L98w3byqX_mOy613WiTo8H8ZLH0QFKfXDjk18wuv6GbFn1Zu4PZrsCkd_P9y83DrPf57g4ErPGne1-m_vDJrBbLt4fjDGoDOJ4sYpzsQux7_VEXfTmsz-Di3vHJ3rL5rcsurAzIN-rCStmulbI9K1XzyasuzAjId9WFGapdM1R7ZkTNJx91YUZAvusuzIjaNSNqz4y4-eTjLswIyDfuwoy4XTPibjrOhVCPaAu9sdiowQwOx8J8gdWYrN6aOT4YPS-3qR6nJVf-P-doXfVWVQ-3m-rVIWBzeMSBxxxYsnLLoZ-WASNTYfCIA485sGTlro3sjFZ1evA3HfnnHXlheTqzQZ2OOYL7YUJwP0wI7ocpwQmaEHzIEdwPE4L7YUJwP0wJTtCE4COO4FccRf0woagfJhT1w5SiBE0oes1R1A8TivphQlE_TClK0ISiY46iktUTCJqQlKAJSwma0pTCqa7AKwu8tsCrC8y-wCsMktUY5FllCLLVT1O2-mnKVj9N2krglK0hZen8zkLaUihN2RrUl4Jxytaz8uC1Nd2_-x0AAP__MSFD2g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r20gUxd_3U5j7tAta7Dsj_4WFLG2ggZCENA-F4gfFmsYGxzKSDHFDvnuxTa1Ysu7RaKT00Ul-nquj-R2N8kqrKDQ3wbNJaPKdmDxS5JEmj3zyqE9Tj9ZxNDNJEsW7PzkAV-ELTXoeLVbrTbr78dSjWRQbmrxSukiXhib0EDwuzb0JQhN3e-RRaNJgsdwvs44Xz0G8vXjZ_iSPbjfppHPB3oWi6ZtH0SbNvjRJgydDE37zqi_8eZGki9Us7fZPVz23REY9bjvzIJmfR7JJlM0k7yNg1wx0rQy4jRD80lGyr9qsojg0sQlPvmz_LaXDqh4eNpui39YUFSLLphg4TOHVGvRLkMy_mvR23dW5vB62azPpXH77dHn30Pn_-po8Wpof6d_7K_jnv3jxNP_9IdtzpVc2bDbfm-jfaN3V_XwGZ9cenazNFpo12jRg4eOWGbTeNDYRuGaga2XAbYTgl47i6DjXb5oGp6gQWVnT2E3h3DT8cU2jqm911ajtYOHjbRu2brtFBOyaga6VAbcRgl86iqNnqr7tDU5RIbIy2-2mcLZdfZztuvpW143aDhY-3rZR67ZbRMCuGehaGXAbIfilozh6puvb3uAUFSIrs91uCmfb9cfZ7lff6n6jtoOFj7dt3LrtFhGwawa6VgbcRgh-6SiOnvn1bW9wigqRldluN4Wz7f6f-Z_BmaHuTbKOVomp9B-B3u6yTPhkDjEl0Saembs4mu2XOXy83XP7H4QmSQ-_5cOHq9XhV7sB38Och_k97J_AbAezcqLHLrQauNBay7QSE9dy4lpcui-vLMMM5pZp1XOihy60BjvNFxMHN7tvAas8PBBhcNFDeaMM5J0yEumxDI9dxJZhJDaggdgyjcSWaSQ2gy5FZSrXCnAb0EhugCO7EQ52OsCR3yxXKiO80C4SXnCc5XpBly73CwPLudAwVo9gmYbPYICjh7CMw6ewjENb5XrlEQi-0K9Wtso0tFXGoa0AR1tWxqGthZY9CV4xOD7JLZvDC7aqQtXY2KrkplHg9KbkcwwIDtDIVoQDWwGObAU4PDTLJav6IPhCy9rYCmhkK8CRrQhHW1bGka1KPsKqEcDlls3hRVvlUyy6dLlpdA-8axWaxsZWQCNbEQ5sBTiyFeDIVi2XrFYg-ELLWr3lyjR8zZVx-J4LcPSiK-PIVi0fZTWKTm7ZHF6wVctn2fylT9_--hUAAP__5OXhhQ==
