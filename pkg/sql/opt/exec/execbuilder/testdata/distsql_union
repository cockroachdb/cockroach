# LogicTest: 5node

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysVluL2kwYvv9-xfBefaUT4kziKVduuxYEq1u10LLkIjXDIrhOOhMhrvjfi0llq5h3JofLJPPMc0Q8gv69hQCW4-n484rs1ZZ8Wcy_kufxj6fpw2RG_n-cLFfLb9MP5O-RrDiQHd7I99lkPiMP0-mdb_PF43hBPv0kWQgUdjIWs-hVaAiegQEFDhQ8oOADhS6EFBIl10Jrqc5HjjlgEmcQdChsdsk-Pb8OKaylEhAcId2kWwEBrKJfW7EQUSyU2wEKsUijzTanyQ5vo0RtXiN1AArLJNrpgDjumXm-TwMyYhCeKMh9-n69TqMXAQE70XoSuq1J4KUS3pmlioUS8TUnhKc7ImfSkYnLriMq4-5Usb-UKhXKZTfWR-xjqTevrrfi0lJ73M6ef0XP7NtlFu263HG9yhOrIKLXogheKqLJyFiNkRkCuIysV3dk3D5gbhOw57h-5ZYriOi3KIKXimjSMq_RsiGAS8v9ui179gF7NgH7Tv6LXq3lCiIGLYrgpSKatOzVaNkQwKXlQd2WffuAfZuAu07ljitIGLYmgZdKaNKwX6Nhg_1Lw8M2_hLcuX8hdCJ3WlgqDymI-EUUQWm5V2vxpOQ6pyke5zkufxELnRZfefEw2eWf8v7_BbMmYI6CvStw5xbsoWAfZ_Zx2Qyn7qLoPk7dawLuo-ABLnvQJLEhCmbMMBN8ZEY4PjPGceMMH5rBOcOXxroGOL41IxwfG-sZrONzM1nH98aGBji-OCMc3xzv4NY5vrlb6-Hpvz8BAAD__-vKM3c=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt-L2k4Uxd-_f0W4T9_SkTiTxB952rZaEKxu1ULLkofUDEvATezMBHTF_72YFFKte2cmyaMx557PnHsIcwL5awchrKfz6aeNU4id83m1_OI8Tb8_zj_MFs7_k9l6s_46f-f8eeVQvXA4vjrfFrPl4s7z5WoyXTkffziHCAhkecIX8QuXED4BBQIMCHhAwAcCAUQE9iLfcilzcXnlVApmyQHCPoE02xfq8jgisM0Fh_AEKlU7DiFs4p87vuJxwoXbBwIJV3G6K20Ox9eHvUhfYnEEAut9nMnQ6bkX52WhQueBQnQmkBeqHi9V_MwhpGfSDCHoDIHZIExSqdJsq1x6kwFi4DUzCIwN_DcN6rlFlouEC55cTY3OGAIzP2Ngc8Z1LhQXLqO349-_OX9wNZ-a94Qa9MRlPdezLqsFxKBDCGYDUbfpn6wN62psMGhYV2YeIzOJ0eu5vvUuLSCGHUIwG4g6atZwl8YGw4a79Mxj9Exi9Hvld95ulxYQow4hmA1EHbXXcJfGBqOGu_TNY_RNYgx61pu0QBh3hsBsEOqY_YZ7NDYYd3AduGOw4nKfZ5LfXAvuT-5frgs8eebV3ULmhdjyR5FvS5vq57LUlQ8SLlX1r1f9mGXVXxfAv8UUFTNczFCxfyWmt2KvjdhHxQGOHeBn1hx6gKrHuHiIike4eNQmsXEbMcU7RnUlw1tGNYnTVj2jrYpG8abRoQYd7xodaOR42XTseNt0arxujGrQ8cKxvubTgjdOw87wwt2qo_N_vwMAAP__-ZQ87A==

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt9umzAUh-_3FNa52jRHxDbkD9KkbmuqReqSLsm0TR0XDKwKiUJmjERb5d0nYBJL1toG5xLw75zPx58SP0HxOwUftovrxccdKkWKrjbrz-h28f3m-v1yhV5fLre77ZfrN-jvkqpdUD08om-fFpsFqtDPcjxmEWLo62q5XukW8neIofXmcrFBH36gKgAMWR7zVXjPC_BvgQAGChgYYHABgwcBhr3II14UuaiXPDWBZVyBP8aQZPtS1q8DDFEuOPhPIBOZcvBhF_5K-YaHMRfOGDDEXIZJ2rSpHh4v9iK5D8UDYNjuw6zw0cipO18lqeTCRxekI_Z9f7nazQDDupT1JwgOGPJSds0LGd5x8MkBDwP0BgNGffhoH77LpJBJFkmHnIxP0YANa-AZN3BfbNDVLbNcxFzw-KhqcFAhUPM9en32uM2F5MKh5LT82xfrT47qE3OJiIFEDh057Mye90CcWCBamK4h7ET875gMTTduMBloOjWfMTWZMRs57pk16IE4tUC00EBD2J0SHaiBcYPpQA2Y-YyZyYzdUfPXc04NeiDOLBAtNNAQdqfEBmpg3GA2UAPXfMauyYy90Zkl6AE4HwxooYCGrzshd6ACxg3mZ7j6PNNgw4t9nhX85Ar0fOVxfTXi8R1v71FFXoqI34g8atq0j-sm17yIeSHbr6x9WGbtpxrw3zBRhqk6TJVh9yhMTsPMJuwqw54a21PvWbPpiTI9V4enyvBMHZ7ZTGxuEyZqx4hOMrVlRDNxYuUZsRKNqE0jUw262jUy0cTVsunY1bbp0mrdKNGgq4WjY81Pi9o4DTtVC3eaDg6v_gQAAP__WimT-A==

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysll9vmzwUh-_fT2Gdq3eaI2ID-YM0qduaakhd0pFM29RxwcCqkChkxki0Vb77BExjyVrb4FwC_p3z-PhR4icof2bgwXZ1vXq_QxXP0FWw-YhuV19vrt_6a_T_pb_dbT9dv0K_l9TdgvrhEX35sApWqEbfq-nUjt8gB31e-5u1aiVDBG2Cy1WA3n1DdQgY8iJh6-ieleDdAgEMFDDYgMEBDC6EGPa8iFlZFrxZ8tQG_KQGb4ohzfeVaF6HGOKCM_CeQKQiY-DBLvqRsYBFCePWFDAkTERp1rapHx4v9jy9j_gDYNjuo7z00MRqOl-lmWDcQxfkD7Dnef56twAMm0o0XyA8YCgq0fcuRXTHwCMHPI7PHc3XjF4fkA4BvExLkeaxsMjJ-CQN7HENXO0GzosN-rpVXvCEcZYcVQ0PMgSqv0d3yB63BReMW5Scln_9Yv3ZUX2ibxHRsMiiE8s-r-cDCGcGhCamKxB7Ef85Jk3TtRvMRppO9YdMdYZsTyznvBoMIJwbEJpooEDsT4mO1EC7wXykBrb-kG2dITuT9r_njBoMIFwYEJpooEDsT8keqYF2g8VIDRz9ITs6Q3Yn55VgAN9yNJ-JAgrA_oSckQpoN1ie4erzTIOAlfsiL9nJFej5ytPmasSSO9bdo8qi4jG74UXctukeN22ufZGwUnRf7e7Bz7tPDeDfYSINU3mYSsPOUZichm2TsCMNu3JsV75nxaZn0vRSHp5Lwwt5eGEysaVJmMgdIyrJ5JYRxcSJkWfESDQiN43MFehy18hMEZfLpmKX26ZKy3WjRIEuF45OFT8tcuMU7FQu3Gk6PPz3KwAA__9EQ5Py

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysldGKm0wcxe-_pxj-V19hxMyMZjdeZWlTCFizTVIoLF7YOCwB17EzCroh716ibbdZknFGc6njz3M855AcQP3MIIDNIlx83KJKZujzevUFPS2-P4YPywj9_2m52W6-hh_Q70dqjJrumbp5Rd-i5SpCD2H457jBqP57HAOGXKQ8Sl64guAJCGCggIEBBg8w-BBjKKTYcaWEPD1yaIFlWkMwwbDPi6o83Y4x7ITkEByg3JcZhwC2yY-Mr3mSculOAEPKy2SftTJ18zov5P4lkQ1g2BRJrgLkuCflVVUGaE7xnEB8xCCq8k1Blckzh4Ac8TAXvqULguf0qgt61cWbuJAplzw9l4X4eMFnJBxRuOQ8qGvaEwPtKr-krtP2jbTZmTYxT58YpO9Sx2VDVmDhY2rtw2IH5EY7IAN2QM0zoCYZMMf1hnRh4ePO2odFF_RGXdABXTDzDJhJBp7T_npZd2Hh497ah0UX7EZdsAFdeOYZeCYZ-M6QJixczCxdWPTg3agHb-T_1IU3r7kqRK644ZtjDDx95t2HKFHJHX-UYtfKdJerlmtvpFyV3SntLpZ5e9RW9C9MxsBUCzM9zLQwmZ7Rk_e0p6Wneml_DDwd89F3Wnimh-_HwLMxtol-Y6RvZPqV9eKjdkZ6hub34Pql9eL6rb33Hh__-xUAAP__Ixk2GA==

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysVk2L2kAYvvdXDO9ppRPiTOJXTm67FgSrW7XQsuSQmmERXCedRIiK_72YVFxl887k47ZJ5pnnk8UjxH834MFiNBl9XZKd2pBv89l38jL69Tx5HE_Jw9N4sVz8mLTIw_8zaX4i3R_IbP40mpMvv8m-RX5Ox7MpeZxM0IOH1vXv1AcKWxmKafAmYvBegAEFDhQcoOAChQ74FCIlVyKOpTofOWaAcZiC16aw3ka75Pzap7CSSoB3hGSdbAR4sAz-bMRcBKFQdhsohCIJ1puMJt0fhpFavwVqDxQWUbCNPWLZZ-bZLvHIkIF_oiB3yfX6OAleBXjsRKtJ6DQmgRdKuDJLFQolwltO8E8fiJxKS0Y2u42oiLtdxv5CqkQom91ZH7LPhd6cqt7ySwvtcTN77g09M2-XGbRrc8t2Sk-shIhugyJ4oYg6I2MVRqYJ4DKybtWRcfOAuUnAjmW7pVsuIaLXoAheKKJOy7xCy5oALi33qrbsmAfsmATsWtl_9HItlxDRb1AELxRRp2WnQsuaAC4t96u27JoH7JoE3LFKd1xCwqAxCbxQQp2G3QoNa-xfGh408ZPgg_vnIo7kNhaGyn0KInwVeVCx3KmVeFZyldHkj7MMl70IRZzkX3n-MN5mn7L-34NZHTBHwc4NuH0PdlCwizO7uGyGU3dQdA-n7tYB91BwH5fdr5PYAAUzppkJPjItHJ8Z47hxhg9N45zhS2MdDRzfmhaOj411Ndbxuems43tjAw0cX5wWjm-Ot3HrHN_cvXX_9OlfAAAA___q9jn6

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk2P2jwUhffvr7DuatBrFOwkfGQ1baESEoUpUKnVKIuUWKNITEJtR-JD_PeKpFIKnbmxQ3aQ-Pg8Pvco8gnUry0EsJrMJp_WJJdb8nm5-EKeJ9-fZh-mc_Iwnq7Wq6-zDnn4s2ZfrtgfjmSxHE-W5OMPcuiQb_PpYo4uOnaq3_sQKKRZLObRq1AQPAMDChwouEDBAwo-hBR2MtsIpTJ5WXIqBNN4D0GPQpLucn15HFLYZFJAcAKd6K2AANbRz61YiigW0ukBhVjoKNkWNvvD8XEnk9dIHoDCahelKiBd5-K8yHVAHhmEZwpZrqvtlY5eBATsTJsh-K0hcBuEcaJ0km60w24yQAzcZga-sYH3rkG1b55mMhZSxFe7hmcMgZuf0bc54yqTWkiHs9vt_393__7V_sy8J8ygJw7vOq51WS0g-i1CcBuIqk3_ZG1YV2ODfsO6cvMYuUmMbtfxrGdpATFoEYLbQFRR84azNDYYNJylax6jaxKj1y2-83aztIAYtgjBbSCqqN2GszQ2GDacpWceo2cSo9-1nqQFwqg1BG6DUMXsNZyjscGohevAGwZLoXZZqsTNteDtnXuX64KIX0R5t1BZLjfiSWabwqb8uyh0xYNYKF2-dcs_07R8dQH8W8xQMcfFHBV7V2J2K3bvEXuo2MexffzMNYfuo-oRLh6g4iEuHt6T2OgeMcM7xupKhreM1STO7uoZu6toDG8aG9Sg411j_Ro5XrY6drxtdWq8bpzVoOOF472aTwveuBp2jhfuVh2e__sdAAD__5v9Q28=

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysVk2L2kAYvvdXDO9ppRPiTOJXTm67FgSrW7XQsuSQmmERXCedRIiK_72YVFxl887k45hknnk-EY8Q_92AB4vRZPR1SXZqQ77NZ9_Jy-jX8-RxPCUPT-PFcvFj0iIP_8-k-Yl0fyCz-dNoTr78JvsW-Tkdz6bkcTLBD1JyaF0fUx8obGUopsGbiMF7AQYUOFBwgIILFDrgU4iUXIk4lup85JgBxmEKXpvCehvtkvNrn8JKKgHeEZJ1shHgwTL4sxFzEYRC2W2gEIokWG8ymnR_GEZq_RaoPVBYRME29ohln5lnu8QjQwb-iYLcJdfr4yR4FeCxE60modOYBF4o4cosVSiUCG85wT99IHIqLRnZ7DaiIu52GfsLqRKhbHZnfcg-F3pzqnrLLy20x83suTf0zLxdZtCuzS3bKT2xEiK6DYrghSLqjIxVGJkmgMvIulVHxs0D5iYBO5btlm65hIhegyJ4oYg6LfMKLWsCuLTcq9qyYx6wYxKwa2W_6OVaLiGi36AIXiiiTstOhZY1AVxa7ldt2TUP2DUJuGOV7riEhEFjEnihhDoNuxUa1ti_NDxo4i_BB_fPRRzJbSwMlfsURPgq8qBiuVMr8azkKqPJH2cZLnsRijjJv_L8YbzNPmX9vwezOmCOgp0bcPse7KBgF2d2cdkMp-6g6B5O3a0D7qHgPi67XyexAQpmTDMTfGRaOD4zxnHjDB-axjnDl8Y6Gji-NS0cHxvraqzjc9NZx_fGBho4vjgtHN8cb-PWOb65e-v-6dO_AAAA__9enTq_

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkc9q8zAQxO_fU4g9xSCI5dx0-kLjgsF10jgpheCDkZZgUKVUf0oh-N2LZWia0pS0PWp2fzsz6AjuWQGHOi_zmw0JVpHb9fKO7PLHVTkvKjJZFPWmvi8T8jAvt3lNJiyhZJIlZFsVy-pdzQZ1ljRAQRuJVfuEDvgOGDQUDtYIdM7YQTrGhUK-Ak8pdPoQ_CA3FISxCPwIvvMKgYMyolXkpVUBHUmnKVCQ6NtOxf2eggn-RDvf7hE46-kvHdiUXeWQXXQ4HQ7aWIkW5aeLX2RYdM53WvhpdrYL_xlcSjD7Scc1uoPRDq_qlg4JUe5xrONMsAJX1ohoMz6XkYuCROfHaTY-Ch1H8RM-wuwvcPYtPDuD077p_70FAAD__6Ke6m8=

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ls1u2kAQgO99CmtOibrI3rXNj6VKpA1VkSikmEOryAcHbwMSwe7aSHEi3r3ChKa2YceLE98C7Dc7nvkm42eI_6zAAXcwGnyZaRux0r5OJ9-128HPm9HVcKxdXA_dmftjdKldvJxJ9yce06dLbTieDabu7tur0ejoicn0ejDVPv_SUg8IrMOAj_0HHoNzCxQIMCBgAgELCNjgEYhEOOdxHIrdkecMGAaP4BgElutok-y-9gjMQ8HBeYZkmaw4ODDz71Z8yv2AC90AAgFP_OUqu-YxfepHYvngixQIuJG_jh2tpe9unmwSR-sz8LYEwk3yEv416l2qLfx4kY_Xp-BtPQJx4t9zcOiWnJem3Wia7GSar3E261AEXPAgF8nbkdiRI8_6zY8XLk8mkU4LHZmlEXfy7gCBFf-dXPTp5SexvF9kf_17dFp49NfHMlWq74Yi4UKndrFSH0_GtyqU7VhFXoIeSWIctsJIZ0axxkevt3PX0-py0Qpy6aylm-8yBQqJthtOlJ1MtIE5oA3NAVL_wxy0z50DVr2_rEp_zZZuvYuICol2Gk6UnUy0ARFZQyIi9T-I2DlXRLN6f80q_bVa2Vp-exEVEu02nCg7mWgDIpoNiYjU_yBi91wRrer9tar01269i4YKafYaTZOdTLMBCa2GJESqf5Cw9xavp0fiT3kcheuYV3rzNHY148E93_cgDjdizm9EOM-u2X-cZFz2uhHwONn_yvYfhuvsp6yv1eFOHZjSWrRdi-7JaapQM6oGd-rAhZqp0nYtuienWZE2_qfNHGwUYVMKW_KbLSnMqPxqu858yGFkPuQwNh8IjcwHQiPz0a4zH3IYmQ85jM0HQiPzgdDIfHSklnblknbrzEevjuFyGDFcDmOGIzRiOEJjG0BlbZb_k6rsTVUaXQJKm1MZRzSnpS2SU5UyuehUvkYQ02lpj6iojtCI6wiNyY7hiO0Yjule2qFKustpTHc5jeqO4JjuCI7pXlqked3biO6lnaKke2mnKOkupzHd5TSqO4JjuiM4pntpnyrpLqcx3eU0qjuCY7ojOKZ7aavm37UNue6stFukunvbD38DAAD__4DQfNY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMzPmy1KlbBuqItGwBS5arbjwwjRBYjG1jRQ2yn-vMMk68eD3zMQ2dwnweI5f5jwa88SS_zYsYLPhePjb3NnHG-f36eRP58vw78_jT6M75-p2NJvP_hpfO1cvnzmcPvF4-H7tjO7mw-ns-Oq5dyfT2-HU-fUf57BgLttGK3UXflMJC74wzlwmmMskc5nPXNZhC5ft4mipkiSKjx95yoDR6pEFbZett7t9enx54bJlFCsWPLF0nW4UC9g8_LpRUxWuVOy1mctWKg3Xm2yZx8P3m128_hbGB-ay2S7cJoHT8o4rT_Zp4NwItnh2WbRP88snaXivWMCf3Y9F6NQWQdhEuF0n6Xq7TD1emMENLyyQM18PzkOYPJz5fB5CfixEp9YQfmmI_Dr7bRSvVKxW766UXaU0pkCzyiN0moqAJpVH6FaI4H4o5R9h8jBT6WTnycKk5oedCt70_9N4zFy2Uf-mVzf8-pd4ff-Q_fVjm5ffVs9mh82iOFWxJ7Wp_Vx6_b7B2M5N5OWiZ0LcRa1o5_nt4ozPLj94tzw3Fwk3EIknWp60tplFiG6NIYRNiFwlvEGfGYfoNugzXp9M0KzKfFZjBDSpMp_ZRajsM34hn4Ed9uozbWqmPhPmXRYmXZYtz7cWikWIXo0hhE2IvMuiQaEYh-g1KBRRX5vRrMqEUmMENKkyodhFqCwUcSGhgB32KhRtaqZCkeZdliZd9lvZI5GdUCxC9GsMIWxC5F2WDQrFOES_QaHI-tqMZlUmlBojoEmVCcUuQmWhyAsJBeywV6FoUzMVim_eZd-ky52WtU4sIgxqiyBsIuQ99huUiXGIQYMy8etrMppVmUxqjIAmVSYTuwiVZeJfSCZgh73KRJvaR36-OXP9qUp20TZRRr_MtI8zU6t7dfoOkmgfL9XnOFpmy5z-nWRc9sJKJenpXXn6Z7Q9vXUM-BbmJCxoWBRh_hb238HcDuayCi14JXpQhZY9mpYk3akCczBymhaiCi3bleg-TfvkNu3ScMcCFkW4S8I9uiA9Egb33Cdhn9NLD0iag2ZzWiocLM41rdiYAdBIDQBHbkA4kAPAkR04LRegB0AjPwAcCQLgyBAIB3XhmmHeb1k0OloxBVzTBKclw7ugMLRm0K3TnhFtsDhtGj4AuKYaq7LTNCw7jcOyAxyVncZR2YVmWZuyAxqVHeCo7ABHZUc42PECnFvR6VFTDYVrZRe0aoQPjs20atCt06YRfbA4bRoBTjRCU43VmZ-m4aGfxuGpH-Do2E_jsOyaZa3KTtOw7DQOy07jsOwARzuePstK8LVL8IDM6bJLWjUSnKQlrRpw65I2jQTHCkmbRnYArqnGpuyARmUHOCo7wkHZAQ4f8jXLWj3l0zR8zKdx-JxP4_BBH-Box9NnWYm-N_osW8D1stOq8cFJ2qdVU7z1xfNP_wcAAP__HUwL5g==

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryBRktlBalrx3ydCtY4A_uJ59W6l8WO__vJIeZ9B_VxCCJPeoPdxStZyST6NR1_Ibe_bzeCqPyRn1_3JdPJ1cE7OXtYUuxWPxRMZja97Y_LhOynOSX847Y0n2wVXgwGyOAIKqzQRw_hBKAhvgQEFDhR8oBAAhRZEFDKZzoRSqdwueS6BfvIIYZPCYpWt8-2_IwqzVAoInyFf5EsBIUzju6UYizgR0msChUTk8WJZHvNYPHUzuXiIZQEUJlm8UiFpeNuTR-s8JF0O0YZCus5ftn_d9a4g81jN9_frMog2EQWVx_cCQrahfxez5TQmPxnzdZ_1KpWJkCLZ2ynaktiSI3f9HKv5ROSjzGOVNzItMhHuuwMUluJHftZl5-_l4n5e_vX76qxy9ddr-RbXOpJ5mDbSzGOt6gCOnh3snc3qv3lW4817vOH5b6KoQdC246D8ZFAHkjJHkvL68-d15u83vOBNRDEIeuE4KD8Z1IEo3JEofv35-3XmHzTKb86_F8Ug6KXjoPxkUAei-I5ECerPP6gz_1bjTTQxiNlxGpOfjOlAkuA_dKMjicZCZelKiVrNp7m9k0juxW5GKl3LmbiR6aw8ZvdzVHLlVzwRKt895bsf_VX5qJx7fbhtA3dsYGaVm7X0NDMYGTOD2zZwxwZmVrkrIzugeZVu_kn7etjXwmx_Zs0qHdgIrocRwfUwIrgexgRHaETwlo3gehgRXA8jguthTHCERgRv2wh-YaOoHkYU1cOIonoYUxShEUUvbRTVw4iiehhRVA9jiiI0omjHRlFm1RMQGpEUoRFLERrTFMOxrmBXFuzagl1dsOwLdoWBWTUGdlAZjGzV05itehqzVU-jtiI4ZqtJWTqcuklbMqUxW436kjGO2XpQHrS2Rpt3vwIAAP__qX57Jw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmNFu4kYUhu_7FNa5SiQjmBkbiKVK2TZURaJhC1y0WnHhxdMEicWubaSwUd69wlR1sOPze2I7vQvgz_P7ZL7DGZ4p-XtHHi0ns8nPK-sQ76xfFvPfrC-TPz7PPk3vrau76XK1_H12bV39e83xfMXT8bs1X9xNFtZPf1rHa2t6v5oslqcL-AvXZNM-DPS9_00n5H0hQTZJskmRTQ7Z5NLapigONzpJwvh0yXMGTIMn8gY2bffRIT29vbZpE8aavGdKt-lOk0cr_-tOL7Qf6Lg_IJsCnfrbXbbM0_H7bRRvv_nxkWxaRv4-8axe_7Ty_JB61q2k9YtN4SHNb5-k_oMmT7zY74vgthZBmkS42ybpdr9J-6JQg1tRWCBnvh6tRz95fOP6PIR6Xwi31RBOZYj8Pod9GAc61sHFnbK7VMaUqFZ5BLerCKhSeYRhgwj2u1L-6iePS53Oo74qVGp1jLT3yv9PsxnZtNN_pVe34vrHePvwmP313zavfqxRu5W9D3th1FdusQBvrj2-WFvUt1zUsLwve31l3GoMQgxbDCFNQuSeiw6bTe0Qww6bjWjPdFSrqmbTYgRUqapmYxahcbMRH9RsZH3XZB3XVK_vGAtvEGLUYghpEiJ3TXYofO0Qow6Fl-3ZhmpVJXyLEVClqoQ3i9BYePlBwqv6rqk6rjm9bN43E94gxLjFENIkRO6a6lD42iHGHQqv2rMN1apK-BYjoEpVCW8WobHw6oOEd-q75tRxze0Z624Q4aa1CNIkQu6Z06HstUPcdCi7055pqFZVsrcYAVWqSnazCI1ld_6H3w7eSLTQSRTuE13rl4HB6Zl08KDPNUrCQ7zRn-Nwky1zfjnPuOyNQCfp-VN1fjHdnz86BXwNCxaWPCyLsHgNOxewMIOFbETfNKHlsAmtFE8rlnabwKLR0nLQiB41oRXYLA67TcH_yzWAZREesjB46BGv5pDXa8zSQvD0DU8PQF8odRUTtwGN5EY4sBvgSG-AI79FqaWaCA5oZDjAkeIIB9sd4EhyUWqsl1sW4aUWw-El0QXfY9Cj801GjIFufJsRI4CXGo2RrTwNbQU4spXHoa08Dm0tNVkjW3ka2srj0FaAoy3L49BW_gtGCjBE8WNrAS_ZKvnBFTy65DuNdMHcy3ca6QC81GmM5maehoMzwNHkzONwdOZxZKssdVkTWwGNbAU4shXhaMvyOLJV8l8wcgxwfpIt4GVb-VEWPTrfaRQ4pSpwQAZztOKHGlB3QCNbEQ5sBTiyFeDwpMsflNFRFxzxmy0OD7sAR6dd8BsB2jX8F4xCpeNH2QJeslXxs2zx0dcvP_wTAAD__1qkDGw=

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElt1u4joQgO_PU1hz1eoYJXYSfiJVas8pVZFY6ALS7qrLRUq8BYmSrBMkaNV3XyUUsSHUE5OS3jWNP0_G8w3jF4h-z8GFYbvb_n9ElnJObgb9L-S-_f2ue9XpkbPrznA0_No9J2dva1abFav1M_l22x60yYr8XJqmNSH8nHR6o_ZgmCy76nZRRFwkTH9w3R6Q_36Q1RgoLAJf9LwnEYF7DwwocKBgAQUbKDgwphDKYCKiKJDJkpcU6PgrcE0Ks0W4jJN_jylMAinAfYF4Fs8FuDDyHuZiIDxfSMMECr6Ivdk8DbNaP1-GcvbkyTVQGIbeInJJzUgi38zmsZAuuWS7T3Zdt9MbNYFCfxknr2D8SiFYxm_BdzEf1mTqRdNstHT9mEIUe48CXPZKj0vCOTqJyUfnwN_NYbfPchFIX0jhZ3YaJyS25MBB3HrRdCjifmiwvWKO1qFwsyIChbn4FZ9dsvMLOXucpn-9m_ouLUunNMNAxkIazNk_qX_f3d8ucGyHTuRt0wMf0QtqQWhwc_-MD4Z3MuFZcfNYAfMMXjOsT2ggjTTqJdI4cQuxaluIVdRCSHG2LVQ_toV48eLzIsW3aob9CQ5rpNEokcaJHebVOswrchgpztbhxrEOW8WLbxUpvl1LbwpVO6yRRrNEGid22KrWYasih5HibB1uHuuwXbz4dpHiO7VPMFgjidbRSZzYX7taf-2K_EVKs_W39RFX8QP7D0QUBotIFLplm8mZCf9RbGoQBUs5EXcymKRhNo_9lEvvR76I4s1bvnnoLNJXaV2Lw40yMGOlaKcU3VLTTOPMmB7cKAPvnZku7ZSiW2qa79Pm37SVgc192FLCtjqyrYQ5U4d2yvSHGkb6Qw1j_YHQSH8gNNIf9TL9oYaR_lDDWH8gNNIfCI30R0NpaVMtabNMf7TKGK6GEcPVMGY4QiOGIzQ2AXTGZv6XVGdu6tLoENCanNo4ojnLTZGMqoyrRWfqMYKYznJzREd1hEZcR2hMdgxHbMdwTPfcDNXSXU1juqtpVHcEx3RHcEz33CDN6l5HdM_NFC3dczNFS3c1jemuplHdERzTHcEx3XPzVEt3NY3prqZR3REc0x3BMd1zUzV71zbVuvPcbFHqPn79508AAAD__yu608k=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v4jgbxe_fTxH5qtUbBLbDv0gjdXbLaJBYmAWk3dUsFxnwtkgMYZMgwVT97itgqrSYPMfGSe_akl988uDzk9Mnlv67YiGb9Aa9X6feNll5n8aj37yvvT-_DD72h97NfX8ynfw-uPVufl6zO12x2__w_vjcG_e8nff3ttGQc0_cev3htDeeHC5Dl6sPh-tH4_ve2PvlL283Yz5bxws1jL6rlIVfGWc-E8xnkvksYD5rspnPNkk8V2kaJ4dLno5Af7FjYcNny_Vmmx3-PPPZPE4UC59YtsxWioVsGn1bqbGKFiqpN5jPFiqLlqvjMrv9j7tNsvweJXvms8kmWqehV6sfVv60XGUqCb07nkcOw7A_nHaYz0bb7PARmz37LN5m-eJpFj0oFvJn_7qAzasDzm3yCZt898s0W67nWZ2fjU9bIGe-7b3HKH28cH0eQl4XollqiKAwRH6f7TpOFipRizd3Ot6lMKZAs8ojNKuKgCaVR2g5RPCvSvk5Sh8nKhtt6vJsUtP9RoWvZPJxMGA-W6l_sps7fvshWT48Hn8y2OZtmx02iZNMJXWpTe3_hffvGIzt0kR-3vRCiGFcizf1oHE-44vLd98sz80tww0sUxe1uixZhBYRWw4RHVQIEuYW4hWq0DhEq0IV8vI8hGZVpMISI6BJFanQLoKzCvk7qRDssBcValMzVaEwL7owKbqs1YOSXWQRse0Q0cFFIGGuAVGhi4xDtCt0kShPBGhWRS4qMQKaVJGL7CI4u0i8k4vADntxkTY1UxdJ86JLk6IHteNbWpkusojYcYjo4CKQMNeArNBFxiE6FbpIlicCNKsiF5UYAU2qyEV2EZxdJN_JRWCHvbhIm5qpiwLzogcmRW_WSjaRRcDu1QEdPATy5QoIKvSQcYhuhR4KypMAmlWRh0qMgCZV5CG7CM4eCt7JQ2CHvXhIm9o1_6q6cP-xSjfxOlVG_4VqHGamFg_q9B2k8TaZqy9JPD8uc_p1dOSOf1ioNDt9Kk-_9Nenjw4BX8OchAUNi3OYv4aDNzC3g7l0oQV3orsutGzTtCTppgvMwchpWggXWjac6A5NB-Q2bdFw0wIW53CLhNt0QdokDJ65Q8IBp5fukjQHzea0VDhYnGtasTEDoJEaAI7cgHAgB4AjO3BaLkAPgEZ-ADgSBMCRIRAO6sI1w7zdsmh0tGLOcE0TnJYMb4HC0JpBj057RjTA4rRpeBfgmmqsyk7TsOw0DssOcFR2GkdlF5plbcoOaFR2gKOyAxyVHeFgxwtwbkWnR001FK6VXdCqEQE4NtOqQY9Om0Z0wOK0aQQ40QhNNVZnfpqGh34ah6d-gKNjP43DsmuWtSo7TcOy0zgsO43DsgMc7Xj6LCvB1y7BCzKnyy5p1Uhwkpa0asCjS9o0EhwrJG0a2QS4phqbsgMalR3gqOwIB2UHOHzJ1yxr9ZZP0_A1n8bhez6Nwxd9gKMdT59lJfre6LPsGa6XnVZNAE7SAa2a80efPf_vvwAAAP__A-ti2Q==

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jwUgO_fX2Gdq6LXKHE--IhUiW6lKhKDDpC2qctFSryCREnmBAla8d8nQhkLoT4xKeld0_jxyfF5DscvEP2egQPDdrf9eUQWYkZuBv0v5L79_a571emRi-vOcDT82q2Qi9c1q-2K5eqZfLttD9pkSX4udN0cE7NCOr1RezDcLLvqdlGEXxJWIf3BdXtAPv0gKxcozAOf97wnHoFzDwwoGEDBBAoWULDBpRCKYMyjKBCbJS8J0PGX4OgUpvNwEW_-7VIYB4KD8wLxNJ5xcGDkPcz4gHs-F5oOFHwee9NZEma5em6FYvrkiRVQGIbePHJIVdtEvpnOYi4c0mL7T3Ycp9MbNYBCfxE7pGWAu6YQLOLX4PuYDysy8aJJOlqLgbt2KUSx98jBYWt6WhL2yUmMifm-ORhv5rDfZzEPhM8F91M7uRsSW3LkIG69aDLkcT_U2EExR6uQO2kRgcKM_4ovWqxyKaaPk-Svv6mzg9T3aZkqpRkGIuZCY_bhSf3_5v5WjmM7diKvmx75iF5QDULN0A_P-Gh4OxWe5TeP5TBPM6qa-QENpJBGrUAaZ24hVm4LsZJaCCnOroVqp7aQkb_4Rp7im1XN-gCHFdKoF0jjzA4b5TpslOQwUpydw_VTHTbzF9_MU3yrmtwUynZYIY1GgTTO7LBZrsNmSQ4jxdk53DjVYSt_8a08xberH2CwQhLNk5M4s79Wuf5aJfmLlGbnb_M9ruJH9h_wKAzmEc91y9Y3Z8b9R76tQRQsxJjfiWCchNk-9hMuuR_5PIq3b43tQ2eevErqmh-uF4EZK0TbheimnGYKZ8bU4HoR-ODMVGm7EN2U08Yhrf9LmylYP4RNKWzJI1tS2GDy0HaR_pDDSH_IYaw_EBrpD4RG-qNWpD_kMNIfchjrD4RG-gOhkf6oSy1tyCVtFOmPZhHD5TBiuBzGDEdoxHCExiaAytjM_pKqzE1VGh0CSpNTGUc0Z5kpklKVGXLRmXyMIKazzBxRUR2hEdcRGpMdwxHbMRzTPTNDlXSX05juchrVHcEx3REc0z0zSNO61xDdMzNFSffMTFHSXU5justpVHcEx3RHcEz3zDxV0l1OY7rLaVR3BMd0R3BM98xUTd-1dbnuRma2SHV31__9CQAA__9kSdPW

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K0ZztVGNYGbMl6WV2DasFonCFpDaassFC9MEicXUNlLYKP-9AjZ1YuP3zDB27vLhx3P8MufRmEce_7vhAZ_2h_1fZ2wfbdjHyfg39qX_5-fhh8GIvbsdTGfT34c37N2Paw7nKx4O39kfn_qTPntgf-8bDbVk6oYNRrP-ZHq8DF2u3zNxw8aT2_6E_fIXO8y5x7fhSo8W33TMgy9ccI9L7nHFPe5zjzf53OO7KFzqOA6j4yWPJ2CweuBBw-Pr7W6fHP889_gyjDQPHnmyTjaaB3y2-LrRE71Y6aje4B5f6WSx3pyWeTh87-2i9bdFdOAen-4W2zhgtfpx5Y_rTaKjgPVEGjkIgsFo1uEeH--TgPUknz95PNwn6eJxsrjTPBBP3nUBm1cHXDJlnk_a5Ltdx8l6u0zqIjO-nsgskDJfD-x-Ed9fuD4Noa4L0Sw1hF8YIr3PfhtGKx3p1as7ne5SGFOiWaURmlVFQJNKI7QcInhXpfy0iO-nOhnv6iozqdlhp4MXMvkwHHKPb_Q_ybueuHkfre_uTz_9v82LH6tts8OmYZToqK5yU_u58P4dg7FdmsiPm14IMQpr4a7uN7Izvrh899XywtwywsAydVmrq5JFaBGx5RDRQYUgYWohUaEKjUO0KlShKM9DaFZFKiwxAppUkQrtIjirULyRCsEOe1ZhbmqmKpTmRZcmRVe1ul-yiywith0iOrgIJEw1ICt0kXGIdoUukuWJAM2qyEUlRkCTKnKRXQRnF8k3chHYYc8uyk3N1EXKvOjKpOh-7fSWVqaLLCJ2HCI6uAgkTDWgKnSRcYhOhS5S5YkAzarIRSVGQJMqcpFdBGcXqTdyEdhhzy7KTc3URb550X2TojdrJZvIImD36oAOHgL5UgX4FXrIOES3Qg_55UkAzarIQyVGQJMq8pBdBGcP-W_kIbDDnj2Um9o1X1VduP9Ex7twG2ujb6Eax5np1Z0-fwZxuI-W-nMULk_LnH8dn7jTH1Y6Ts7_VedfBtvzv44BX8KChCUNyywsXsL-K1jYwUK50FI40V0XWrVpWpF00wUWYOQ0LaULrRpOdIemfXKbtmi4aQHLLNwi4TZdkDYJg2fukLAv6KW7JC1AswUtFQEWFzmt2JgB0EgNAEduQDiQA8CRHQQtF6AHQCM_ABwJAuDIEAgHdRE5w7zesmh0tGIyeE4TgpaMaIHC0JpBj057RjbA4rRpRBfgOdVYlZ2mYdlpHJYd4KjsNI7KLnOWtSk7oFHZAY7KDnBUdoSDHS_BuRWdHnOqofBc2SWtGumDYzOtGvTotGlkByxOm0aCE43MqcbqzE_T8NBP4_DUD3B07KdxWPacZa3KTtOw7DQOy07jsOwARzuePssq8LEr8IIs6LIrWjUKnKQVrRrw6Io2jQLHCkWbRjUBnlONTdkBjcoOcFR2hIOyAxy-5Ocsa_WWT9PwNZ_G4Xs-jcMXfYCjHU-fZRX63OizbAbPl51WjQ9O0j6tmuyjz59--i8AAP__zvVi5g==

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jwYhs_fXxE9R61kFJwPWiK9EtXGNCQGHeFgUpWDlHgFKU0yO5FIK_77lNCO8TE_8QzZYYiv-LafS-J-BfEjBg_84Xj4YW4UPDY-zaZfjIfht_vx3WhiXH0c-XP_6_jaeFuyJka5XbMuX4zRZD6c-dXvd-Px-5KSGOtfSwIgkKQRm4TPTID3ABQIWEDABgIOEHAhIJDxdMGESHm15LUGRtEavC6BVZIVefVzQGCRcgbeK-SrPGbgwTx8jNmMhRHjZhcIRCwPV3G9zbp8GWR89RzyEgj4WZgIz-iY1c7TIveMgUUGFIINgbTI33bYffixNJahWO5_ckDJwIJgExAQefjEwKMb8ndhXcWwbztrhbX-GHb3qSJJecQ4i_Y-FlQktuTEiT-HYumzfJqZ9GA68zJj3r49QCBm3_OrOvj1_3z1tHx_kF3D7ny2xvlOhJ-knTQzqXt4Eyf3dvb2ps1FoA1EMK2OaV_QW4W4PeW45zeXtmsubdtcq_k4rCbjsDumc0F7FOLeKMc9vz1Wu_ZYbdtjNx-H3WQcTqf-s7qUPQpxb5Xjnt8eu1177LbtcZqPw2kyDrdzQXcUwvYVw57fHKddc5x_2bdORJsxkaWJYI3aVLc6HIue2PayRFrwBbvn6aLeZvs4rbm6DURM5Nu31vZhlNSv6gE0h3s6cF8Hplq5qSunqcKVUTW4pwP3dWCqlfvgyo5o65Du_k7bctiWwnT_zrqHtKMjuBxGBJfDiOByGBMcoRHBXR3B5TAiuBxGBJfDmOAIjQje0xH8RkdROYwoKocRReUwpihCI4re6igqhxFF5TCiqBzGFEVoRNG-jqJUqycgNCIpQiOWIjSmKYZjXUGvLOi1Bb26oNkX9AoD1WoM9KgyKNkqpzFb5TRmq5xGbUVwzFaVsnR86yptSZXGbFXqS8o4ZutReZDaGmz--xkAAP__MRCLvQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7tCsNgpmxgViqlFU3VZFosg08VFrx4IVpgsRiahsJNsp_r4C0Tmx8zwy208dgPub4xudjhidK_15RSJOb8c0vU2-brLxf7-9-977e_Pll_Gl06334PJpMJ3-MP3ovb9kJb396z27_wxvdTm_uJ4fXXy7vhbf77_KMBK3jhbmNvpuUwq8kSZAiQZoE-SQooJmgTRLPTZrGyeEtT0dgtNhR2BO0XG-22eHlmaB5nBgKnyhbZitDIU2jbytzb6KFSbo9ErQwWbRcHZfZ7X9cb5Ll9yjZk6DJJlqnodfpHla-22ahd63EtaTZs6B4m-UrpFn0YCiUz-KyFIFjCimuVWUK5ZLi8zLNlut51pWFSZxbI8e-7b3HKH08j-RR9GVRghai-JVR8o_aruNkYRKzePNhx0-pDKss5panCNpKYTGyPEW_RgpxUdDfovRxYrK7TVcX5jXdb0z4ygafxmMStDJ_ZR-ON_Hx52T58PjvH3YNGDQ75du4E2-6OihO4uzawzdrS3sHSAsHdFWnqy9xkUOOvnMOBxuBHLkCZOs2so7Sb91GsjkPWMytykYNprAYWZWN3FLUtpF8bxsp-yYqmybqTte_xAgOOQbOORyMAHLkNVStG8E6yqB1I6jmumgxtyojNJjCYmRVRnBLUdsI6r2NoO2bqG2a6HeO5wlnIzjkGDrncDACyJHXULduBOsow9aNoJvrosXcqozQYAqLkVUZwS1FbSPo9zaCb99E36aJQecSHzikuHJM4WADkCKvoN-6DayjXLVuA7-5HlrMrcoGDaawGFmVDdxS1LaB_3_-fnEm2r1JN_E6NVa_TvQON2cWD-Y0rDTeJnPzJYnnx2VOf94dueMLC5Nmp6v69Mdofbp0CPgaliyseFgVYfka9t_A0g2WqhZ9VYdW_Tq01jytWTqoA8taS6teLXpQh9bgYfHZxxT8vwIHWBXhPguDmx7w1ezz9RqytJQ8fcXTPeCFklVcug1oVG6Eg3YDHNUb4KjfsqRUl4IDGjUc4KjiCAePO8BRyWVJrG8fWYSXFMPhpaJL3jHo1nnJyCGoG68ZOQB4STRObeVp2FaAo7byOGwrj8O2liTr1Faehm3lcdhWgKNHlsdhW_kvGCXBJorfthbwUlsVv3EFt65406gA7Ht50ygf4CXTOO2beRpunAGOds48DrfOPI7aqkqWdWkroFFbAY7ainD0yPI4aqviv2DUEOD8TraAl9vKb2XRrfOm0eCUqsEBGeyjNb-pAXMHNGorwkFbAY7aCnB40uUPyuioC4749RaHh12Ao9Mu-I0APTX8F4xGo-O3sgW81FbN72WLtz57_umfAAAA___n7Cla

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1v2kwQgO_vr7DmFPQuMru2-bBUKWlDVSQKKebQKvLBwduARLC7NhIkyn-vMEHUGO94cbI3CPvMjmeeyfgFkj9LcMHrD_tfpsZaLI2vk_F3477_8254MxgZV7cDb-r9GDaMq7czm_2JzfbZGE9u-xPj8y9j2zAGo2l_4u0O3AyH0sPPjePnjQ8EVlHIR8ETT8C9BwoEGBCwgIANBBzwCcQimvEkicTuyEsGDMINuC0Ci1W8Tnd_9gnMIsHBfYF0kS45uDANHpZ8woOQC7MFBEKeBotlds1m-3wdi8VTILZAwIuDVeIaTXN383idusY1Bf-VQLRO38Ifoz5sjXmQzPPxsvM-gSQNHjm49JVclqajNU1WmuYxznoViZALHuYi-TsSO3LmWb8Fydzj6Tg26UlHptuYu3mNgMCS_06vrmnjk1g8zrNPpY9-fCxLpfpeJFIuTOqcVur_0vh2hbKdq8hb0DNJjKJmFJusdVrjs9c7uetpdbloBblM1jStD5kChUTbmhNlpYlqmAOqaQ6Q-h_moH3pHLDq_WVV-ms1TftDRFRItKM5UVaaqAYRmSYRkfofROxcKqJVvb9Wlf7azWwtv7-ICol2NSfKShPVIKKlSUSk_gcRu5eKaFfvr12lv07zQzRUSLOnNU1WmqYGCW1NEiLVP0jYe4_X0zPxJzyJo1XCK715tnY14-Ej3_cgidZixu9ENMuu2X8dZ1z2uhHyJN3_yvZfBqvsp6yv1eFOHZjSWrRTi-7JaapQM6oGd-rAJzVTpZ1adE9Os1O69S9t5eDWKWxJYVt-sy2FGZVf7dSZDzmMzIccxuYDoZH5QGhkPtp15kMOI_Mhh7H5QGhkPhAamY-O1NKuXNJunfno1TFcDiOGy2HMcIRGDEdobAOorM3if1KVvalKo0tAaXMq44jmtLBFcqpSJhedytcIYjot7BEV1REacR2hMdkxHLEdwzHdCztUSXc5jekup1HdERzTHcEx3QuLNK97G9G9sFOUdC_sFCXd5TSmu5xGdUdwTHcEx3Qv7FMl3eU0prucRnVHcEx3BMd0L2zV_Lt2S647K-wWqe7-639_AwAA___juoKq

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mEtv6kYYhvf9FdasEtXIzIWbpUo5baiKRMMpsGh1xMIHpgkSB1PbSJAo_70CEjlh8PfOxHZ2ufjxvP6Y99GYJ5b-t2Ihm_SH_d-m3jZZeb-PR3963_p_fx1-Gdx5V7eDyXTy1_Dau3q5Zne6Yrd_9Ebj2_7Y-_Ufb3_tDe6m_fHkcAF14eN1_vNuxny2jhf6LvqhUxZ-Y5z5TDCfSeYzxXzWYjOfbZJ4rtM0Tg6XPB2BwWLHwqbPluvNNjv8eeazeZxoFj6xbJmtNAvZNPq-0mMdLXQSNJnPFjqLlqvjMrv9480mWf6Ikj3z2WQTrdPQawSHlUfbLPRuOJs9-yzeZvnt0yy61yzkz_7HIrQqiyBcItwu02y5nmcBP5uBsUDOfN97D1H6cOH6PIT8WIhWpSFUYYj8Ptt1nCx0ohfv7nS8S2FMgWaVR2jVFQFNKo_QLhHB_1DKP6L0YaKz0SaQZ5Oa7jc6fKOCL8Mh89lK_5td3fDrX5Ll_cPxJ4tt3nHZYZM4yXQSSGNqPxfev2sxtksTebnphRB3cSPeBKp5PuOLy_feLc_tRcItRBKIRiCdbeYQol1hCOESIlcJr9Fn1iHaNfqMVycTNKsin1UYAU2qyGduEUr7jH-Sz8AOe_WZMTVbnwn7LgubLstGoJyF4hCiU2EI4RIi77KoUSjWITo1CkVU12Y0qyKhVBgBTapIKG4RSgtFfJJQwA57FYoxNVuhSPsuS5suq8bxlchNKA4huhWGEC4h8i7LGoViHaJbo1BkdW1GsyoSSoUR0KSKhOIWobRQ5CcJBeywV6EYU7MVirLvsrLpcqvhrBOHCL3KIgiXCHmPVY0ysQ7Rq1Emqromo1kVyaTCCGhSRTJxi1BaJuqTZAJ22KtMjKl95OubC_cf63QTr1Nt9c1M8zAzvbjXp88gjbfJXH9N4vlxmdOvoyN3_MNCp9npv_L0y2B9-tch4FuYk7CgYXEO87ewegdzN5jLMrTgpeheGVp2aFqSdKsMzMHIaVqIMrRslqK7NK3Ibdqm4ZYDLM7hNgl36IJ0SBg8c5eEFaeX7pE0B83mtFQ4WJwbWnExA6CRGgCO3IBwIAeAIztwWi5AD4BGfgA4EgTAkSEQDurCDcO837JodLRiznBDE5yWDG-DwtCaQY9Oe0Y0weK0aXgP4IZqnMpO07DsNA7LDnBUdhpHZReGZV3KDmhUdoCjsgMclR3hYMcLcG5Fp0dDNRRulF3QqhEKHJtp1aBHp00jumBx2jQCnGiEoRqnMz9Nw0M_jcNTP8DRsZ_GYdkNyzqVnaZh2Wkclp3GYdkBjnY8fZaV4GOX4AWZ02WXtGokOElLWjXg0SVtGgmOFZI2jWwB3FCNS9kBjcoOcFR2hIOyAxy-5BuWdXrLp2n4mk_j8D2fxuGLPsDRjqfPshJ9bvRZ9gw3y06rRoGTtKJVc_7os-ef_g8AAP__l74Rug==

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9v2j4QwN-_f0V0T0Vfo2An4UekSe1WpiEx6AgPm6o8pMQrSJRkTpCgVf_3iVDEQogvJq3fmsYf-3L3Oc4vkPxZggtef9j_MjXWYml8nYy_G_f9n3fDm8HIuLodeFPvx7BhXL2t2exXbLbPxnhy258Yn38Z24YxGE37E2-34GY4lC8mxnPj-LjxgcAqCvkoeOIJuPdAgQADAhYQsIGAAz6BWEQzniSR2C15yYBBuAG3RWCxitfp7t8-gVkkOLgvkC7SJQcXpsHDkk94EHJhtoBAyNNgscyO2Wyfr2OxeArEFgh4cbBKXKNp7k4er1PXuKbgvxKI1unb9sddH7bGPEjm-f2y9T6BJA0eObj0lVwWpqM1TFYa5nGf9SoSIRc8zO3k70hsyZlv_RYkc4-n49ikJxWZbmPu5k0CAkv-O726po1PYvE4z_4q_fTjZ1kq2fcikXJhUuc0U_-X7m9XSNu5jLxteiaIUdSMYpO1TnN89ngndzytLhetIJfJmqb1IV2gEGhbc6CsNFANfUA19QGS_0MftC_tA1a9vqxKfa2maX-IiAqBdjQHykoD1SAi0yQikv-DiJ1LRbSq19eqUl-7mY3l9xdRIdCu5kBZaaAaRLQ0iYjk_yBi91IR7er1tavU12l-iIYKYfa0hslKw9Qgoa1JQiT7Bwl773E9PbP_hCdxtEp4pZtna5czHj7yfQ2SaC1m_E5Es-yY_eM447LrRsiTdP-W7R8Gq-xVVtfqcKcOTGkt2qlF9-Q0VcgZVYM7deCTnKnSTi26J6fZKd36l7ZycOsUtqSwLT_ZlsKMyo926vSHHEb6Qw5j_YHQSH8gNNIf7Tr9IYeR_pDDWH8gNNIfCI30R0dqaVcuabdOf_TqGC6HEcPlMGY4QiOGIzQ2AVTGZvGXVGVuqtLoEFCanMo4ojktTJGcqpTJRafyMYKYTgtzREV1hEZcR2hMdgxHbMdwTPfCDFXSXU5justpVHcEx3RHcEz3wiDN695GdC_MFCXdCzNFSXc5jekup1HdERzTHcEx3QvzVEl3OY3pLqdR3REc0x3BMd0LUzV_127JdWeF2SLV3X_9728AAAD__0Yeg28=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FdasEtXIzAdflirltqEqEg23wKLVFQtfmCZIXExtI0Gi_PcKSOSEwe-Zie3sQuLHc_wy59E4Tyz9b8VCNukP-79NvW2y8n4fj_70vvX__jr8Mrjzrm4Hk-nkr-G1d_Vyze50xW7_6I3Gt_2x9-s_3v7aG9xN--PJ4QLyQt97vM4_7mbMZ-t4oe-iHzpl4TfGmc8E85lkPlPMZy0289kmiec6TePkcMnTERgsdixs-my53myzw69nPpvHiWbhE8uW2UqzkE2j7ys91tFCJ0GT-Wyhs2i5Oi6z2z_ebJLljyjZM59NNtE6Db1GcFh5tM1C74az2bPP4m2W3z7NonvNQv7sfyxCq7IIwiXC7TLNlut5FvCzGRgL5Mz3vfcQpQ8Xrs9DyI-FaFUaQhWGyO-zXcfJQid68e5Ox7sUxhRoVnmEVl0R0KTyCO0SEfwPpfwjSh8mOhttAnk2qel-o8M3NvgyHDKfrfS_2dUNv_4lWd4_HH-y2OYdlx02iZNMJ4E0pvZz4f27FmO7NJGXm14IcRc34k2gmuczvrh8793y3F4k3EIkgWgE0tlmDiHaFYYQLiFylfAafWYdol2jz3h1MkGzKvJZhRHQpIp85hahtM_4J_kM7LBXnxlTs_WZsO-ysOmybATKWSgOIToVhhAuIfIuixqFYh2iU6NQRHVtRrMqEkqFEdCkioTiFqG0UMQnCQXssFehGFOzFYq077K06bJqHF-J3ITiEKJbYQjhEiLvsqxRKNYhujUKRVbXZjSrIqFUGAFNqkgobhFKC0V-klDADnsVijE1W6Eo-y4rmy63Gs46cYjQqyyCcImQ91jVKBPrEL0aZaKqazKaVZFMKoyAJlUkE7cIpWWiPkkmYIe9ysSY2kf-fXPh_mOdbuJ1qq3-M9M8zEwv7vXpO0jjbTLXX5N4flzm9HF05I6_WOg0O_1Vnj4M1qc_HQK-hTkJCxoW5zB_C6t3MHeDuSxDC16K7pWhZYemJUm3ysAcjJymhShDy2YpukvTitymbRpuOcDiHG6TcIcuSIeEwTN3SVhxeukeSXPQbE5LhYPFuaEVFzMAGqkB4MgNCAdyADiyA6flAvQAaOQHgCNBABwZAuGgLtwwzPsti0ZHK-YMNzTBacnwNigMrRn06LRnRBMsTpuG9wBuqMap7DQNy07jsOwAR2WncVR2YVjWpeyARmUHOCo7wFHZEQ52vADnVnR6NFRD4UbZBa0aocCxmVYNenTaNKILFqdNI8CJRhiqcTrz0zQ89NM4PPUDHB37aRyW3bCsU9lpGpadxmHZaRyWHeBox9NnWQm-dglekDlddkmrRoKTtKRVAx5d0qaR4FghadPIFsAN1biUHdCo7ABHZUc4KDvA4Uu-YVmnt3yahq_5NA7f82kcvugDHO14-iwr0fdGn2XPcLPstGoUOEkrWjXnjz57_un_AAAA__-qkBJ_

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryBRktlBKq3471NCtY4A_uJ59W6l8WO__vJIeZ9B_VxCCJPeoPdxStZyST6NR1_Ibe_bzeCqPyRn1_3JdPJ1cE7OXtZsdiseN09kNL7ujcmH7-TpnPSH0954Uiy4GgyQxRFQWKWJGMYPQkF4CwwocKDgA4UAKLQgopDJdCaUSmWx5LkE-skjhE0Ki1W2zot_RxRmqRQQPkO-yJcCQpjGd0sxFnEipNcEConI48WyPOZx89TN5OIhlhugMMnilQpJwytOHq3zkHQ5RFsK6Tp_2f5117sNmcdqvr9fl0G0jSioPL4XELIt_buYLacx-cmYr_usV6lMhBTJ3k5RQWJLjtz1c6zmE5GPMo9V3sh0k4lw3x2gsBQ_8rMuO38vF_fz8q_fV2eVq79ey7e41pHMw7SRZh5rVQdw9Oxg72xW_82zGm_e4w3PfxNFDYK2HQflJ4M6kJQ5kpTXnz-vM3-_4QVvIopB0AvHQfnJoA5E4Y5E8evP368z_6BRfnP-vSgGQS8dB-UngzoQxXckSlB__kGd-bcab6KJQcyO05j8ZEwHkgT_oRsdSTQWKktXStRqPs3iTiK5F7sZqXQtZ-JGprPymN3PUcmVX_FEqHz3lO9-9Fflo3Lu9eG2DdyxgZlVbtbS08xgZMwMbtvAHRuYWeWujOyA5lW6-Sft62FfC7P9mTWrdGAjuB5GBNfDiOB6GBMcoRHBWzaC62FEcD2MCK6HMcERGhG8bSP4hY2iehhRVA8jiuphTFGERhS9tFFUDyOK6mFEUT2MKYrQiKIdG0WZVU9AaERShEYsRWhMUwzHuoJdWbBrC3Z1wbIv2BUGZtUY2EFlMLJVT2O26mnMVj2N2orgmK0mZelw6iZtyZTGbDXqS8Y4ZutBedDaGm3f_QoAAP__3Gl7KQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryBRktlBKq3471NCtY4A_uJ59W6l8WO__vJIeZ9B_VxCCJPeoPdxStZyST6NR1_Ibe_bzeCqPyRn1_3JdPJ1cE7OXtZsdiseN09kNL7ujcmH7-TpnPSH0954Uiy4GgyQxRFQWKWJGMYPQkF4CwwocKDgA4UAKLQgopDJdCaUSmWx5LkE-skjhE0Ki1W2zot_RxRmqRQQPkO-yJcCQpjGd0sxFnEipNcEConI48WyPOZx89TN5OIhlhugMMnilQpJwytOHq3zkHQ5RFsK6Tp_2f5117sNmcdqvr9fl0G0jSioPL4XELIt_buYLacx-cmYr_usV6lMhBTJ3k5RQWJLjtz1c6zmE5GPMo9V3sh0k4lw3x2gsBQ_8rMuO38vF_fz8q_fV2eVq79ey7e41pHMw7SRZh5rVQdw9Oxg72xW_82zGm_e4w3PfxNFDYK2HQflJ4M6kJQ5kpTXnz-vM3-_4QVvIopB0AvHQfnJoA5E4Y5E8evP368z_6BRfnP-vSgGQS8dB-UngzoQxXckSlB__kGd-bcab6KJQcyO05j8ZEwHkgT_oRsdSTQWKktXStRqPs3iTiK5F7sZqXQtZ-JGprPymN3PUcmVX_FEqHz3lO9-9Fflo3Lu9eG2DdyxgZlVbtbS08xgZMwMbtvAHRuYWeWujOyA5lW6-Sft62FfC7P9mTWrdGAjuB5GBNfDiOB6GBMcoRHBWzaC62FEcD2MCK6HMcERGhG8bSP4hY2iehhRVA8jiuphTFGERhS9tFFUDyOK6mFEUT2MKYrQiKIdG0WZVU9AaERShEYsRWhMUwzHuoJdWbBrC3Z1wbIv2BUGZtUY2EFlMLJVT2O26mnMVj2N2orgmK0mZelw6iZtyZTGbDXqS8Y4ZutBedDaGm3f_QoAAP__3Gl7KQ==

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdF3Asko2Am0RJrUamMaEoMOOEyqckiJV5AoyewgQav-9ylJESOAv3gWyTHET_z68yPxvoH8swIPpv1h_8vM2oiV9W0y_mE99n89DO8HI6vxdTCdTX8Om9bHkm2-oNHYPxNrl_-03b02rcFo1p9M0xf3w6F1flHTBwLrKOSj4IVL8B6BAgEGBBwg4AKBDvgEYhHNuZSRSJe8ZcAg3ILXJrBcx5sk_dknMI8EB-8NkmWy4uDBLHha8QkPQi7sNhAIeRIsV9k2293rXSyWL4HYAYFpHKylZ7XsdOfxJvGsO0ruGPjvBKJN8rHD4cNPO2sRyMXxJ_eIT0AmwTMHj76T_wvbqSEsuxj28KnNOhIhFzw8-pifktiSMyf-HsjFlCfj2KaF25ntYu4dCwQEVvx30siCNz-L5fNi_3AYQ2EGh8M5Boc7k3wUtaLYpp3iGM7u7R7tTctbQEtYYLOW7VxRWo243VrisotxK9CWVqotK38XrMxdOC3bvaI6GnFvaonLLsatQB1WqTpO-btwytyF28r-o66ljkbc21risotxK1DHqVQdt_xduGXuotO6ojgaYXs1hGUXw1agjVtbxzqTa8JlHK0lL9Wg2unJePjM80nJaCPm_EFE82yb_HGccVkDCLlM8rcsfxiss1fZ9MvDXRO4ZwJTo9y0o6apxsioHtw1gXsmMDXKXRjZCc2KdPtf2lHDjhKmxzNrF2nXRHA1jAiuhhHB1TAmOEIjgndMBFfDiOBqGBFcDWOCIzQieNdE8BsTRdUwoqgaRhRVw5iiCI0oemuiqBpGFFXDiKJqGFMUoRFFeyaKUqOegNCIpAiNWIrQmKYYjnUFs7Jg1hbM6oJhXzArDNSoMdCTyqBlq5rGbFXTmK1qGrUVwTFbdcrS6dR12pIujdmq1Ze0cczWk_KgtNV___Q3AAD__6sBjWY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7lEiDYGZsIJYqZdVNVSSabAMPlVY8eGGaILGY2kYKG-W_V0AjJza-Zwbb2Ufj-TxnLnOO7_iZ0n9XFNLkZnzz29TbJivv9_u7P72vN39_GX8a3XoXn0eT6eSv8aX3_5Cn44CLi9dr4e2OPz3tflx6o9vpzf1kf-P0gMsZCVrHC3MbfTcphV9JkiBFgjQJ8klQQDNBmySemzSNk_2Q5wMwWjxR2BO0XG-22f7nmaB5nBgKnylbZitDIU2jbytzb6KFSbo9ErQwWbRcHaZ52v243iTL71GyI0GTTbROQ6_T3c98t81C71qKa0WzF0HxNstnSLPowVAoX8R5KoImVSgXFZ-XabZcz7OuLFTi1Bw59m3nPUbp42kkl6LPkxK0IMWvlJI_aruOk4VJzOLdww5PqRSrLOqWqwjaUmFRslxFv4YKcZbQP6L0cWKyu01XF-o13W1M-CYQPo3HJGhl_skuDou4_DVZPjy-XuQOqFzcoNkS38adeNPVQbEMJ-cevptb2geAtAiArup09TlB5KCj36wO5aIj979sPYqspfRbjyLZXAhY1K0qihpUYVGyqihyU1E7iuSHRpGyt6GysaHudP1z4sBBx6BZHcpFR-5B1XocWEsZtB4HqjkjWtStKg4aVGFRsqo4cFNROw7Uh8aBtrehtrGh3zkcI5zjwEHHsFkdykVH7kHdehxYSxm2Hge6OSNa1K0qDhpUYVGyqjhwU1E7DvSHxoFvb0PfxoZB55wwcFBx1aQK5aIi95_fehRYS7lqPQr85kxoUbeqKGhQhUXJqqLATUXtKPB_2jeLE7ruTbqJ16mx-iLR26_MLB7MsVJpvE3m5ksSzw_THC_vDtzhh4VJs-NdfbwYrY-39gLfwpKFFQ-rIizfwv47WLrBUtWir-rQql-H1pqnNUsHdWBZa2rVq0UP6tAabBaf3abg_wocYFWE-ywMFj3grdnn7TVkaSl5-oqneyAXSqni4m1AI3MjHLgb4MjeAEf-lqVIdTE4oJHDAY4sjnCw3QGOTC5Lwfp-yyK8FDEcXjK65DMGLZ0PGTkEduNjRg4AXgoaJ7fyNHQrwJFbeRy6lcehW0sh6-RWnoZu5XHoVoCjLcvj0K38C0ZJ0ETxbWsBL7lV8Y0rWLrik0YFoO_lk0b5AC8ljVPfzNOwcQY46px5HLbOPI7cqkop6-JWQCO3Ahy5FeFoy_I4cqviXzBqCHC-ky3gZbfyrSxaOp80GpxSNTgggz5a800NqDugkVsRDtwKcORWgMOTLn9QRkddcMSvNzk87AIcnXbBNwK0a_gXjEal41vZAl5yq-Z72eLSZy-__BcAAP__VU4rAw==

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9vok4QwN-_fwWZpzbfNbAL-IPkEnutlzPxak986KXhgcpeNbHCLZhIG__3i1ivRewOK8pbKfvZHWY-4-wrxH_m4IDbG_Sux9pSzLVvo-EP7aF3fze46t9qFzd9d-z-HFxqF29r0u2KVfpyqfXur3t3Y-1qMPj3eqVdubk1w9FNb6R9_aWlHhBYhAG_9Z95DM4DUCDAgIAJBCwgYINHIBLhhMdxKDZLXjOgH6zAMQjMFtEy2fzbIzAJBQfnFZJZMufgwNh_nPMR9wMudAMIBDzxZ_PsmFX60o3E7NkXKRBwI38RO1pD35w8XCaO1mXgrQmEy-Rt-_ddH1Nt6sfT_H5dCt7aIxAn_hMHh67JcWHaimHSSmGyT8N832e5CEXABQ9yO3kbElty4Fu_-_HU5ckw0uleRcZpxJ0P9gCBOf-dXHTp5Rcxe5pmf3363e_fZKqk3g1FwoVO7f00_f_p_laJnB1Kx9umB4K4DRthpDNjP8EHj7dzx9PyZtESZumsoZtnaQGFQJvKgZ6yCWi9TUDraAIk-bsmaB7bBKx8cVmZ4poN3TqLhQqBtpQDPaWFrF4LWR0WIsnfWdg61kKzfHHNMsW1Gtk0Pr2FCoG2lQM9pYVmvRaadViIJH9nYftYC63yxbXKFNdunMVBhTA7imGe0kCrXgOtOgxEUr8zsHOKK-mB_Uc8jsJFzEvdNo1NwnjwxLcFiMOlmPA7EU6yY7aPw4zLbhkBj5PtW7Z96C-2rzYBlodbVWBKK9F2Jbojp6lCzpga3KoC7-VMlbYr0R05zfZp4yNt5mBjHzalsCWvliWFGZUfbVfpDzmM9IccxvoDoZH-QGikP5pV-kMOI_0hh7H-QGikPxAa6Y-W1NK2XNJ2lf7oVDFcDiOGy2HMcIRGDEdobAKojM3iL6nK3FSl0SGgNDmVcURzWpgiOVUpk4tO5WMEMZ0W5oiK6giNuI7QmOwYjtiO4ZjuhRmqpLucxnSX06juCI7pjuCY7oVBmte9iehemClKuhdmipLuchrTXU6juiM4pjuCY7oX5qmS7nIa011Oo7ojOKY7gmO6F6Zq_q5tyHVnhdki1d1b__c3AAD__2zTeK0=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMzPmy1KlpBuqRqIhBS62WnHhhWmCxGJqGylslP9eAcs6ePB7ZmKbuyT48Ry_zHk0zitL_luygI37g_6nibOJl84fo-Ffzpf-58fB7f2Dc3V3P56M_x5cO1c_rtkernjZfr92-p8_9R8nPz96cW7HJ58PR3f9kfP7P852yly2iubqIfymEhZ8YZy5TDCXSeYyn7msxaYuW8fRTCVJFO8ued0D9_MXFjRdtlitN-nuz1OXzaJYseCVpYt0qVjAJuHXpRqpcK5ir8lcNldpuFjul3nZfr9Zx4tvYbxlLhuvw1USOA1vt_JwkwbOjWDTN5dFmzS7fZKGT4oF_M39WISWZQReGEHYRLhbJOliNUs9npuBtkDGfN06z2HyfOb6LIT8WIhWpSH8whDZfTarKJ6rWM1P7rS_S2FMgWaVRWjVFQFNKovQLhHB_VDKP8PkeazS4dqTuUlNtmsVHA1wOxgwly3Vv-nVDb_-LV48Pe9_MtjjHZvtNY7iVMWe1Eb2a-H9uwYzOzeOHzc9E-IhakRrz2_mB3x2-d7J8tzcItzAIp5oeNJaZRYh2tYhTGUGQmQe4TXKzDhEu0aZ8epMgmZVJLMKI6BJFcnMLkJpmfFLyAxsr6PMtJGZykyYF1mYFFk2PN_aJhYhOtYhTG0CQmRFFjXaxDhEp0abiOqqjGZVZJMKI6BJFdnELkJpm4hL2ARsr6NNtJGZ2kSaF1maFNlv7N-E7GxiEaJrHcLUJiBEVmRZo02MQ3RrtImsrspoVkU2qTACmlSRTewilLaJvIRNwPY62kQbmalNfPMi-yZFbjWsXWIRoWcZwdQkIEJWYr9GkxiH6NVoEr-6GqNZFZmkwghoUkUmsYtQ2iT-JUwCttfRJNrIPvIvmzP3H6lkHa0SZfTfmOZuYGr-pA5fQBJt4pl6jKPZfpnDr8M9t__DXCXp4VNx-OV-dfhoF_A9zElY0rDIw_w97J_A3A7msgwteCm6V4aWHZqWJN0qA3MwcpoWogwtm6XoLk375DZt03DLAhZ5uE3CHbogHRIGz9wlYZ_TS_dImgOa01LhyCqaVmzMAGikBoAjNyAcyAHgyA6clgvQA6CRHwCOBAFwZAiEg7pwzTCnWxaNjlZMDtc0wWnJ8DYoDK0Z9Oi0Z3gPLE6bRjQBrqnGquw0DctO47DsAEdlp3FUdqFZ1qbsgEZlBzgqO8BR2REOdrygz60CnR411VC4VnZBq0b44NhMqwY9Om0aAY4kgjaN6AJcU43VmZ-m4aGfxuGpH-Do2E_jsOyaZa3KTtOw7DQOy07jsOwARzuePstK8LVL-iybw7WyS_CKDI7CklYNeHRJm0a2wOK0aSQ4lUhNNTZlBzQqO8BR2REOyg5w-JKvWdbqLZ-m4Ws-jcP3fBqHL_oARzuePstK9L3RZ9kcrpedVo0PjsI-rZr8o0_ffvk_AAD__5BZB70=

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lkFv2jAYhu_7FdZ3aiWjYCfQEmkSXcs0JFY64NCpyiElXkGiJLOD1LTiv0-Eai0B_MXz6lspfuzXnx-J9wXU7wWEMO4NepcTspIL8nU0_E7uerc3g4v-NTm56o8n4x-DU3LyuqbYrngqnslwdNUbkS8_SXFKereXvZsJuRgMkJURUFimibiOH4WC8A4YUOBAwQcKAVBoQUQhk-lUKJXKzZKXEugnTxA2KcyX2Srf_DuiME2lgPAF8nm-EBDCJL5fiJGIEyG9JlBIRB7PF-UxT8VzN5Pzx1gWQGGcxUsVkoa3OXm4ykPS5RCtKaSr_HX7t13vCzKL1Wx3vy6DaB1RUHn8ICBka_pvMVtOY_KjMd_2WS1TmQgpkp2dog2JLTlw12-xmo1FPsw8VnmRSZGJ8J04QGEhfuUnXXb6Wc4fZuVff-_NKvd-u5NvcacDga_TRpp5rFW9_cGzg52zWf1nZzWe3eMNz_8QPw2Cth0H5UeDOjCUuTCU1x8-rzN8v-EFH2KJQdAzx0H50aAOLOEuLPHrD9-vM_ygUf7U_H9LDIKeOw7KjwZ1YInvwpKg_vCDOsNvNT7EEYOYHacx-dGYDgwJXPehA3FGQmXpUolabae5uZBIHsR2QCpdyam4kem0PGb7cVhy5S93IlS-_ZZvP_SX2682AevDbRu4YwMzq9yspaeZwci4Gdy2gTs2MLPKXRnZHs2rdPM97evn7WthtjuzZpUObATXw4jgehgRXA9jgiM0InjLRnA9jAiuhxHB9TAmOEIjgrdtBD-zUVQPI4rqYURRPYwpitCIouc2iuphRFE9jCiqhzFFERpRtGOjKLPqCQiNSIrQiKUIjWmK4VhXsCsLdm3Bri5Y9gW7wsCsGgPbqwxGtuppzFY9jdmqp1FbERyz1aQs7b-ZSVsypTFbjfqSMY7ZulcetLZG609_AgAA__-lH3W3

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mNFu4kYUhu_7FNa5SiQjmBkbiKVK2W6oGomGFLjYasWFF08TJBa7tpHCRnn3CtPWiR2f3xPb3AXw5_nnZL7DMc-U_L0ljxaT6eTz0trHW-vX-ex36-vky_300-2ddXFzu1gu_pheWhf_XnM4XfF0-GHN5jeTufXLn9bh0pp8-Ty5X4KrVmTTLgz0nf9dJ-R9JUE2SbJJkU0O2eTSyqYoDtc6ScL4eMlzBtwGT-QNbNrson16fHtl0zqMNXnPlG7SrSaPlv63rZ5rP9Bxf0A2BTr1N9tsmafDj-so3nz34wPZtIj8XeJZvf5x5dk-9axrSasXm8J9mt8-Sf0HTZ54sT8WwW0tgjSJcLNJ0s1unfZFoQbXorBAznw7WI9-8vjO9XkI9bEQbqshnMoQ-X32uzAOdKyDN3fK7lIZU6Ja5RHcriKgSuURhg0i2B9K-ZufPC50Oov6qlCp5SHS3n_yf5pOyaat_iu9uBaXP8ebh8fsr__PePWeRu2W9S7shVFfucXdv7v2-M3aor7ioobifdnrK-M-YxBi2GIIaRIil1x02Glqhxh22GlEe5qjWlV1mhYjoEpVdRqzCI07jThHp5H1RZN1RFO9vmNsu0GIUYshpEmIXDTZoe21Q4w6tF22pxqqVZXtLUZAlaqy3SxCY9vlOWxX9UVTdURzetmYb2a7QYhxiyGkSYhcNNWh7bVDjDu0XbWnGqpVle0tRkCVqrLdLEJj29U5bHfqi-bUEc3tGbtuEOGqtQjSJEIumdOh6bVDXHVoutOeZqhWVaa3GAFVqsp0swiNTXfO_XvBO3HmOonCXaJr_RowOG5IBw_6VKAk3MdrfR-H62yZ08tZxmVvBDpJT5_K04vb3emjY8DXsGBhxcOyCIvXsPMGFmawkI3oqya0HDahleJpxdJuE1g0WloOGtGjJrQCh8Vhjyn4f7kGsCzCQxYGmx7xdg15vcYsLQY8fcXTAvSFUlcxcRvQSG6EA7sBjvQGOPJblFqqieCARoYDHCmOcHDcAY4kF6XG-vbIIrzUYji8JLrgewzaOt9kxAjoxrcZMQZ4qdEY2crT0FaAI1t5HNrK49DWUpM1spWnoa08Dm0FODqyPA5t5b9gpABDFBhbBW-r5AdXsHXJdxrpgLmX7zTSBXip0xjNzTwNB2eAo8mZx-HozOPIVlnqsia2AhrZCnBkK8LRkeVxZKvkv2DkGOD8JFvAy7byoyzaOt9pFBhlFd9pFHhCVvxQA-oOaGQrwoGtAEe2Ahw-6fIPyuhRFzziN1scPuwCHD3tgt8I0Knhv2AUKh0_yhbwkq2Kn2WLW1-9_PRPAAAA___Flwb8

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lm9P4kwQwN8_n2IzrzTPkna3LX-amOijNZLwgAck58XjRaV7QoK0ty0JaPzulxY5heJOl0rfid1fh5n5DbMvEP-egQsDr-NdDslCzsh1v_c_uffubjsX7S45uWoPhoNvnVNy8nZmuT6xXD2T7zde3yNL8nNhmtaY8FPi3V16t0Ny0emg58VZCvT6V16f_PeDLEdAYR4Gous_iRjce2BAgQMFCyjYQMGBEYVIhmMRx6FMj7xkQDtYgmtSmM6jRZL-e0RhHEoB7gsk02QmwIWh_zATfeEHQhomUAhE4k9nWZjl6vk8ktMnX66AwiDy57FLakYa-Xo6S4R0yTn7m6Lruu3usAkUeoskfQKjVwrhInmL_R7yYUUmfjzZDpadH1GIE_9RgMte6WE5OAfnkJb9a5Pgnybx_p7FPJSBkCLYetMoJbEjeypx48eTgUh6kcF2mjlcRcL9YCFQmIlfyck5Oz2T08dJ9teneb_nZOk0ZhDKREiDObtl-vfT99sFaravHG8v3fMlumEtjAxu7hZ4b3hnKzwr7h0r4J3Ba4ZV_fRoZFEvkcWx54dVOz-sivlBWrOZn_qh88OLt54Xab1VM-zqBdbIolEii2MLzKsVmFchMNKajcCNQwW2irfeKtJ6u5bdECoWWCOLZoksji2wVa3AVhUCI63ZCNw8VGC7eOvtIq13atXrq5FD6-Acji2vXa28dhXyIo3ZyNv6iuv3nvf3RRyF81gUulmbacFE8CjWDYjDhRyLWxmOszDrj72My65FgYiT9VO-_tCerx-lX7A43CgDM1aKdkrRLTXNNGrG9eBGGXinZrq0U4puqWm-S5sfaWsLNndhSwnb6m7ZSpgzdWinzHyoYWQ-1DA2HwiNzAdCI_NRLzMfahiZDzWMzQdCI_OB0Mh8NJSWNtWSNsvMR6uM4WoYMVwNY4YjNGI4QmMbQGdt5n9JdfamLo0uAa3NqY0jmrPcFtlSlXG16Ey9RhDTWW6P6KiO0IjrCI3JjuGI7RiO6Z7boVq6q2lMdzWN6o7gmO4IjumeW6TbutcR3XM7RUv33E7R0l1NY7qraVR3BMd0R3BM99w-1dJdTWO6q2lUdwTHdEdwTPfcVt2-a5tq3Xlutyh1H73-8ycAAP__vwHOWQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjmBnzZWmlbDesNhINKSB1qy0XLEwTJBZT20iwUf57BSz1xoPfM8PYuUuCH8_xy5xH4zyz5N8lC9mo1-99GHubeOl9HA5-9770Pj_039_de1e3d6Px6I_-tXf145rt8Yrt7rv356fesOdtvb83jYaceeLa633-0HsYw2vVu_3Fg-Ftb-j99pe3nTCfraK5up9-UwkLvzDOfCaYzyTzWcB81mQTn63jaKaSJIr3lzwfgLv5loUNny1W6026__PEZ7MoVix8ZukiXSoWsvH061IN1XSu4nqD-Wyu0ulieVhmu_t-s44X36bxjvlstJ6uktCr1fcrf1wsUxWH3g3___HCMLy7H3eYzwabdP8Jm7z4LNqk2dpJOn1ULOQv_mX5mhfn24_UPKCwCXi7SNLFapbWeW582gIZ83XnPU2TpzPXZyHkZSGapYYICkNk99msoniuYjV_dafDXQpjCjSrLEKzqghoUlmElkME_6KUn6bJ00ilg3Vd5iY13q1VeDLJ-36f-Wyp_kmvbvj1u3jx-HT4yWCPt2221yiKUxXXpTayXwvv3zGY2blx_LjpmRD3US1a14NGfsBnl---Wp6bO4YbOKYuanVZrgUtErYcErp4EETMFMQr9KBxiFaFHuTlSQjNqsiDJUZAkyryoF0EZw_yt_Ag2F4nD2ojM_WgMK-5MKm5rNWDckVkkbDtkNBFRCBi5gBRoYiMQ7QrFJEozwJoVkUiKjECmlSRiOwiOItIvIWIwPY6iUgbmamIpHnNpUnNg9rh7axEEVkk7DgkdBERiJg5QFYoIuMQnQpFJMuzAJpVkYhKjIAmVSQiuwjOIpJvISKwvU4i0kZmKqLAvOaBSc2btXI1ZJGve3E-FwmBgFn_gwolZByiW6GEgvIMgGZVJKESI6BJFUnILoKzhIK3kBDYXicJaSO75N9TZ-4_VMk6WiXK6D9Pjf3A1PxRHb-AJNrEM_UQR7PDMsdfBwfu8Ie5StLjp-L4y93q-NE-4M8wJ2FJwyIP85_h4BXM7WAuXWjBneiuCy3bNC1JuukCczBymhbChZYNJ7pD0wG5TVs03LSARR5ukXCbLkibhMEzd0g44PTSXZLmgOa0VDiyiqYVGzMAGqkB4MgNCAdyADiyA6flAvQAaOQHgCNBABwZAuGgLlwzzOsti0ZHKyaHa5rgtGR4CxSG1gx6dNozvAsWp00jGgDXVGNVdpqGZadxWHaAo7LTOCq70CxrU3ZAo7IDHJUd4KjsCAc7XtDnVoFOj5pqKFwru6BVIwJwbKZVgx6dNo0ARxJBm0Z0AK6pxurMT9Pw0E_j8NQPcHTsp3FYds2yVmWnaVh2Godlp3FYdoCjHU-fZSX42iV9ls3hWtkleEUGR2FJqwY8uqRNI5tgcdo0EpxKpKYam7IDGpUd4KjsCAdlBzh8ydcsa_WWT9PwNZ_G4Xs-jcMXfYCjHU-fZSX63uizbA7Xy06rJgBH4YBWTf7RJy-__BcAAP__QeFdaQ==

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElt9u2jAUh-_3FNa5KlpQYifhT6RKdG2qIjHoAGmdulykxCtIlGROkKAV7z4BZRRCfWJS0rtS8tk5Pt-P4xeI_47BgZ7bci_7ZCrG5Lrb-U7u3bvb1kWzTc6umr1-70erRM5en5mvn5jNn8nPG7frkhn5PTUMk58TWiLu3aV72ycXrRYKDIhZIp3uldsl336RuQcaTMKAt_0nHoNzDxQ0YKCBCRpYoIENngaRCAc8jkOxfORlBTSDGTiGBqNJNE2W__Y0GISCg_MCySgZc3Cg7z-MeZf7ARe6ARoEPPFH49U2s_lzIxKjJ1_MQYNe5E9ih5T15c7Xo3HChUMadFui4zjNdr8GGnSmiUMaDLyFBuE0ed18u-fDnAz9eLi7W4OCt_A0iBP_kYNDF9pxRdhHFzEg5sfWwN6tYbvOdBKKgAse7KzkLUnskQMHcePHwx5POpFO95rZn0fceSMhaDDmf5KzBi2di9HjcPXX_7rpXt3bmkyVvvRCkXChU3v_mL6-u76V4cwOHcfrogdeoh2Ww0hnxv4BH9ze3tmeZteOZtBOZ2Xd_IT0KJRRyVHGifNDi80PLSI_SGc2-akcmx-WvfMsS-fNsm59gsAKZVRzlHFigVmxArMiBEY6sxG4eqzAZvbOm1k6b5VXF4SiBVYoo5ajjBMLbBYrsFmEwEhnNgLXjhXYyt55K0vn7fIn6KtQRP3oIk4sr1WsvFYR8iJ92chb_4jr94H1uzyOwknMM92sjeWB8eCRrxsQh1Mx4LciHKy2WX_srLjVtSjgcbL-lq0_NCfrr5YvmB2u5oEpzUXbuei6nKYKZ8bU4GoeeO_MVGk7F12X02yfNt7S5g5s7MOmFLbk3bKkMKPyre08-ZDDSD7kMJYPhEbygdBIPip58iGHkXzIYSwfCI3kA6GRfFSlltbkktby5KOex3A5jBguhzHDERoxHKGxCaAyNtO_pCpzU5VGh4DS5FTGEc1paorsqEqZXHQqHyOI6TQ1R1RUR2jEdYTGZMdwxHYMx3RPzVAl3eU0prucRnVHcEx3BMd0Tw3SXd0riO6pmaKke2qmKOkupzHd5TSqO4JjuiM4pntqnirpLqcx3eU0qjuCY7ojOKZ7aqru3rUNue4sNVukunuLL_8CAAD__7V_zmY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K0ZzlahGMDPmy9JK2W5YLRINKSB1qy0XLEwTJBZT20hho_z3CljqjY3fM8PYucuHH8_xy5xHY555_O-KB3zcG_Q-TNg2WrGPo-Hv7Evv8_3gff-OXd32x5PxH4NrdvXjmt3xiqfdd_bnp96ox57Y39tGQ-l3TFyz3ucPvfsJvHjO1DUbjm57I_bbX2w35R5fhwt9N_umYx584YJ7XHKPK-5xn3u8yace30ThXMdxGO0veT4A_cUTDxoeX64322T_56nH52GkefDMk2Wy0jzgk9nXlR7p2UJH9Qb3-EIns-XqsMzT7vvNJlp-m0U77vHxZraOA1ar71f-uFwlOgrYjUgfLwiC_t2kwz0-3CYBu5F8-uLxcJuki8fJ7EHzQLx4lwVsXhxwzpR5PmmT73YZJ8v1PKmLzPhuRGaBlPm6Y4-z-PHM9WkIdVmIZqkh_MIQ6X226zBa6EgvXt3pcJfCmBLNKo3QrCoCmlQaoeUQwbso5adZ_DjWyXBTV5lJTXYbHZxE8n4w4B5f6X-Sqxtx_S5aPjwefvp_jxc_U9tme43DKNFRXeVG9mvh_TsGMzs3jh83PRPiLqyFm7rfyA747PLdV8sLc8UIA8XUZa2uSragRcSWQ0QHD4KEqYJEhR40DtGq0IOiPAmhWRV5sMQIaFJFHrSL4OxB8RYeBNvr5MHcyEw9KM1bLk1armp1v2QRWURsO0R0EBFImDpAVigi4xDtCkUky7MAmlWRiEqMgCZVJCK7CM4ikm8hIrC9TiLKjcxURMq85cqk5X7t8HJWpogsInYcIjqICCRMHaAqFJFxiE6FIlLlWQDNqkhEJUZAkyoSkV0EZxGptxAR2F4nEeVGZioi37zlvknLm7WSNWQRsHtxQAcJgXxp__0KJWQcoluhhPzyDIBmVSShEiOgSRVJyC6Cs4T8t5AQ2F4nCeVGdsnXU2fuP9LxJlzH2uibp8Z-YHrxoI8fQBxuo7m-j8L5YZnjr8MDd_jDQsfJ8b_y-Et_ffzXPuDPsCBhRcMyC4ufYf8VLOxgoVxoKZzorgut2jStSLrpAgswcpqW0oVWDSe6Q9M-uU1bNNy0gGUWbpFwmy5Im4TBM3dI2Bf00l2SFoAWtFQEskpOKzZmADRSA8CRGxAO5ABwZAdBywXoAdDIDwBHggA4MgTCQV1EzjCvtywaHa2YDJ7ThKAlI1qgMLRm0KPTnhFdsDhtGtkAeE41VmWnaVh2GodlBzgqO42jssucZW3KDmhUdoCjsgMclR3hYMdL-twq0ekxpxoKz5Vd0qqRPjg206pBj06bRoIjiaRNIzsAz6nG6sxP0_DQT-Pw1A9wdOyncVj2nGWtyk7TsOw0DstO47DsAEc7nj7LKvCxK_osm8FzZVfgFRkchRWtGvDoijaNaoLFadMocCpROdXYlB3QqOwAR2VHOCg7wOFLfs6yVm_5NA1f82kcvufTOHzRBzja8fRZVqHPjT7LZvB82WnV-OAo7NOqyT769OWX_wIAAP__1-tddg==

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6xz1UpGwU6gJdIkqo5pSKx0hYtKVS5S4hUkSjI7kUir_vcpSbuWj_nEM2SXIXns1z6PxPsM6tcSfJgMRoPLKcnkkny9GX8nd4Pb69HF8IqcfBlOppMfo1Py-smakrz6Zp0_kcHt5eB6Si5Go7f3OSXrP-8DoLCKI3EVPgoF_h0woMCBggsUPKDQgYBCIuOZUCqWxSfPJTCM1uC3KSxWSZYWPwcUZrEU4D9DukiXAnyYhvdLcSPCSEinDRQikYaLZbnNOn_qJ3LxGMocKEyScKV80nKKncdZ6pM-o30OwQuFOEtfd3hf-D4n81DNN5d8QwIKKg0fBPjshf5b2I5hWE77zDYs_2vY96WyVSwjIUW0sVhQkNgne078LVTziUjHicO2pjPNE-F_UAcoLMXP9KRMffpZLh7mbw-6gb0fzrU43J7kV3ErThzW2b6GvXt7G3uz-hawGhY4vOW4R5TWIG7XOO7htWXNassa1ZbXnwWvMwu35XhHVMcg7plx3MOrw5tVhzeqjlt_Fm6dWXit8j_qWOoYxD03jnt4ddxm1XEbVcerPwuvziw6rSOKYxC2Zxj28Np4zWrj_beOtSfXjVBJvFKiVoNqFycT0YOobkrFmZyJaxnPym2qx3HJlQ0gEiqt3vLqYbiqXhUB68NdG7hnAzOr3Kyjp5nBlXEzuGsD92xgZpV768p2aL5Ntz_Srv6-XS3MNu-svU17NoLrYURwPYwIrocxwREaEbxjI7geRgTXw4jgehgTHKERwbs2gp_ZKKqHEUX1MKKoHsYURWhE0XMbRfUwoqgeRhTVw5iiCI0o2rNRlFn1BIRGJEVoxFKExjTFcKwr2JUFu7ZgVxcs-4JdYWBWjYHtVAYjW_U0ZquexmzV06itCI7ZalKWdmdm0pZMacxWo75kjGO27pQHra3By6ffAQAA__-bNoZN

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7tCsNgpmxgViqlNUuVSPRJA08rLTiwQvTBInF1DYSbJT_XgFNndjxPTPYTh-J-fCZG5-PGR4p_XtFIU1G49HnqbdNVt5vdzd_eN9GX2_Hn66uvQ9fribTyZ_jj96_b9kJb396z27_0xt9_Ty6nT5f2wtv99-1GQlaxwtzHf0wKYXfSJIgRYI0CfJJUEAzQZsknps0jZPDWx6PwNViR2FP0HK92WaHP88EzePEUPhI2TJbGQppGn1fmTsTLUzS7ZGghcmi5ep4m93-5-UmWf6Ikj0JmmyidRp6ne7hzjfbLPQupbhUNHsSFG-z_A5pFt0bCuWTOC9F4JhCiUtZmUK5pPiyTLPlep51ZWESb600x77vvYcofXgbyaPo86IELUTxK6PkH7Vdx8nCJGbx6sOOn1IZVlnMLU8RtJXCYmR5in6NFOKsoL9H6cPEZDebri7Ma7rfmPBZBZ_GYxK0Mn9lH44r-Phrsrx_eH5hV8JBsyO-jjvxpquD4hjevPfw1b2lvQCkhQC6qtPV54jIIUffOYeDikCOvP-ydRVZR-m3riLZnAQs5lalogZTWIysSkVuKWqrSL6ripR9DZVNDXWn65-jA4ccA-ccDjoAOfIOqtZ1YB1l0LoOVHNFtJhblQ4aTGExsioduKWorQP1rjrQ9jXUNjX0O8djhLMOHHIMnXM46ADkyDuoW9eBdZRh6zrQzRXRYm5VOmgwhcXIqnTglqK2DvS76sC3r6FvU8Ogc44MHFJcOKZwUAFIkffPb10F1lEuWleB31wJLeZWpYIGU1iMrEoFbilqq8D_336zeCPXnUk38To1Vr9I9A4rM4t7c5pUGm-TublN4vnxNqeXN0fu-IeFSbPTVXV6cbU-XToEfAlLFtY8rIqwfAn7r2DpBktVi76oQ6t-HVprntYsHdSBZa1bq14telCH1uBh8dnHFPy_AgdYFeE-C4NFD_h29fl6DVla9nj6gqcl8ELJKi7dBjQqN8JBuwGO6g1w1G9ZUqpLwQGNGg5wVHGEg8cd4KjksiTW148swkuK4fBS0SXvGLR0XjJyAOrGa0YOAV4SjVNbeRq2FeCorTwO28rjsK0lyTq1ladhW3kcthXg6JHlcdhW_gtGSbCJAttWybdV8RtXsHTFm0b5YN_Lm0YFAC-ZxmnfzNNw4wxwtHPmcbh15nHUVlWyrEtbAY3aCnDUVoSjR5bHUVsV_wWjhgDnd7IFvNxWfiuLls6bRoOtrOZNo8EJWfObGjB3QKO2Ihy0FeCorQCHJ13-oIyOuuCIX-_m8LALcHTaBb8RoKeG_4LRaHT8VraAl9qq-b1scemzp1_-CQAA__-vLCPq

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v4jgQwN_vU1jzVHRGwU7Cn0gntddyOiS2dAkPXVV5SIm3IFGSdYJEWvW7rwhlaQj1xITmDYp_48nMbzp5hfjXAhxw-8P-9YSs5IL8Nx59Iw_9-7vh1eCWXNwM3In7fdggF-9n1tsT6_SFjMY3_TH59wdJG6R_f92_m5Cr4fDPyZRcuUePvzT2n9ceUFiGgbj1n0UMzgMwoMCBggkULKBgg0chkuFUxHEoN0deM2AQrMFpUZgvo1Wy-bNHYRpKAc4rJPNkIcCBif-4EGPhB0IaLaAQiMSfL7Jr1unLZSTnz75MgYIb-cvYIU1jc_NolTjkkoH3RiFcJe_h91EfUzLz41k-XnbeoxAn_pMAh73R09K0NdPkldLkn6a5j7NahjIQUgS5SN6GxI4cedb__XjmimQUGeygI5M0Es4HkYDCQvxMLi5Z4x85f5plnz5tz_6ZTJ3Su6FMhDSYfVimvz-Nb5Wo2bFyvAc9ksRt2Awjg7cOC3z0ejt3PStvFithlsGbhvklI6CRaFs70XMOAat3CFgdQ4AUfzcE7VOHgJdvLi_TXLNpWF9ioUaiHe1Ez2khr9dCXoeFSPF3FnZOtdAs31yzTHOtZraNz2-hRqJd7UTPaaFZr4VmHRYixd9Z2D3VQqt8c60yzbWbX-KgRpo9zTTPaaBVr4FWHQYipd8Z2DvHK-mR-GMRR-EyFqXeNlubgongSWwbEIcrORV3Mpxm12y_jjIue8sIRJxsf-XbL4Pl9qdNguXhThWYsUq0XYnuqWmmUTOuB3eqwAc106XtSnRPTfNDuvWRNnNw6xA2lbCl7palhDlTX21XmQ81jMyHGsbmA6GR-UBoZD7aVeZDDSPzoYax-UBoZD4QGpmPjtLSrlrSbpX56FUxXA0jhqthzHCERgxHaGwD6KzN4n9Snb2pS6NLQGtzauOI5qywRXKqMq4WnanXCGI6K-wRHdURGnEdoTHZMRyxHcMx3Qs7VEt3NY3prqZR3REc0x3BMd0LizSvexvRvbBTtHQv7BQt3dU0pruaRnVHcEx3BMd0L-xTLd3VNKa7mkZ1R3BMdwTHdC9s1fy7dkutOy_sFqXu3ttfvwMAAP__eLR-jA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMzPmy1KlpBuqRqIhBS62WnHhhWmCxGJqGwkS5b9XwLLeePB7ZmKbu3z48Ry_zHk05pUl_y1ZwMb9Qf_TxNnES-eP0fAv50v_8-Pg9v7Bubq7H0_Gfw-unavv12yPV2x3L85wdNcfOb__4-yunf7nT_3HyY-rds7t-OylL9fZz9spc9kqmquH8JtKWPCFceYywVwmmct85rIWm7psHUczlSRRvL_k9QDcz7csaLpssVpv0v2fpy6bRbFiwStLF-lSsYBNwq9LNVLhXMVek7lsrtJwsTwss9293Kzjxbcw3jGXjdfhKgmchrdfebhJA-eGs-mby6JNmt0-ScMnxQL-5n4sQssygiiMIGwi3C2SdLGapR7PzUB7xoz5unOew-T5zPVZCPmxEK1KQ_iFIbL7bFZRPFexmr-70-EuhTEFmlUWoVVXBDSpLEK7RAT3Qyn_DJPnsUqHa0_mJjXZrVVwksHtYMBctlT_plc3_Pq3ePH0fPjJoGYdm-01juJUxZ7URvZr4f27BjM7N47vNz0T4iFqRGvPb-YHfHb53rvlublFuIFFPNHwpLXKLEK0rUOYygyEyDzCa5SZcYh2jTLj1ZkEzapIZhVGQJMqkpldhNIy45eQGdheJ5lpIzOVmTAvsjApsmx4vrVNLEJ0rEOY2gSEyIosarSJcYhOjTYR1VUZzarIJhVGQJMqsoldhNI2EZewCdheJ5toIzO1iTQvsjQpst84vAnZ2cQiRNc6hKlNQIisyLJGmxiH6NZoE1ldldGsimxSYQQ0qSKb2EUobRN5CZuA7XWyiTYyU5v45kX2TYrcali7xCJCzzKCqUlAhKzEfo0mMQ7Rq9EkfnU1RrMqMkmFEdCkikxiF6G0SfxLmARsr5NJtJF95CubM_cfqWQdrRJl9G1Mcz8wNX9Sxw8giTbxTD3G0eywzPHX4YE7_GGukvT4X3H85X51_Nc-4M8wJ2FJwyIP859h_x3M7WAuy9CCl6J7ZWjZoWlJ0q0yMAcjp2khytCyWYru0rRPbtM2DbcsYJGH2yTcoQvSIWHwzF0S9jm9dI-kOaA5LRWOrKJpxcYMgEZqADhyA8KBHACO7MBpuQA9ABr5AeBIEABHhkA4qAvXDPN-y6LR0YrJ4ZomOC0Z3gaFoTWDHp32DO-BxWnTiCbANdVYlZ2mYdlpHJYd4KjsNI7KLjTL2pQd0KjsAEdlBzgqO8LBjhf0uVWg06OmGgrXyi5o1QgfHJtp1aBHp00jwJFE0KYRXYBrqrE689M0PPTTODz1Axwd-2kcll2zrFXZaRqWncZh2Wkclh3gaMfTZ1kJPnZJn2VzuFZ2CV6RwVFY0qoBjy5p08gWWJw2jQSnEqmpxqbsgEZlBzgqO8JB2QEOX_I1y1q95dM0fM2ncfieT-PwRR_gaMfTZ1mJPjf6LJvD9bLTqvHBUdinVZN_9OnbL_8HAAD__yqGDZw=

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk9v4joQwO_vU1hzKnpGiZ2EP5Ge1L6W1SKxpQscuqpySIm3IFGSdYIErfrdV4QiGkI8MWlzaxr_7MnMbxi_QvxnAS6Me4Pe9YSs5IJ8Gw1_kIfe_d3gqn9LLm7648n456BBLt7XrHcr1psXMhzd9Ebk_19k0yC9--ve3YRcDQbqlZS8NA6Paw8oLMNA3PrPIgb3ARhQ4EDBAgo2UHDAoxDJcCriOJTbJa8p0A_W4JoU5stolWz_7VGYhlKA-wrJPFkIcGHiPy7ESPiBkIYJFAKR-PNFesx683IZyfmzLzdAYRz5y9glTWN78nCVuOSSgfdGIVwl79sfdn3ckJkfz7L7pes9CnHiPwlw2Rs9L0yn1jB5YZiHfVbLUAZCiiCzk7clsSUnvvW7H8_GIhlGBjuqyGQTCfeDRkBhIX4nF5es8Z-cP83Svwq_-_BNlk7qx6FMhDSYc5ymfwv3t0vk7FQ63jc9EcRt2Awjg5vHCT55vJM5npU3i5Uwy-BNw_qSFtAItFVzoLww0BqagNXRBEjy903QOrcJePni8jLFtZqG_SUWagTarjlQXhhoDRbyOixEkr-3sH2uhVb54lplims302n8-RZqBNqpOVBeGGgNFlp1WIgkf29h51wL7fLFtcsU12l-iYMaYXZrDZMXhlmDgXYdBiKp3xvY_Ywr6Yn9RyKOwmUsSt02zW3CRPAkdgWIw5WcijsZTtNjdo_DlEtvGYGIk91bvnvoL3evtgGWh9tVYMYq0U4luqummUbOuB7crgIf5UyXdirRXTXNj2nzI21lYPMYtpSwra6WrYQ5Ux_tVOkPNYz0hxrG-gOhkf5AaKQ_WlX6Qw0j_aGGsf5AaKQ_EBrpj7bS0o5a0k6V_uhWMVwNI4arYcxwhEYMR2hsAuiMzfwvqc7c1KXRIaA1ObVxRHOWmyIZVRlXi87UYwQxneXmiI7qCI24jtCY7BiO2I7hmO65Gaqlu5rGdFfTqO4IjumO4JjuuUGa1b2F6J6bKVq652aKlu5qGtNdTaO6IzimO4JjuufmqZbuahrTXU2juiM4pjuCY7rnpmr2rm2qdee52aLU3Xv7528AAAD__6Wvff8=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMzPmy1KlbDdUjURDClxsteLCC9MEicXUNhIkyn-vMIu88eD3zMR27kLix3P8MufROC8s-W_NAjYdjoafZ84uXjt_TMZ_OV-HXx5Gn-7unavbu-ls-vfo2rn6cc3-dMX-8OyMJ7fDifP7P87h2hl--Tx8mNFXuc7zdf5xP2cu20RLdR9-VwkLvjLOXCaYyyRzmc9c1mFzl23jaKGSJIqPl7xkwN1yz4K2y1ab7S49_nruskUUKxa8sHSVrhUL2Cz8tlYTFS5V7LWZy5YqDVfrbJn94flmG6--h_GBuWy6DTdJ4LS848rjXRo4N5zNX10W7dL89kkaPioW8Ff3fRE6tUUQNhFuV0m62ixSjxdmoC2QM98OzlOYPF24Pg8h3xeiU2sIvzREfp_dJoqXKlbLN3fK7lIaU6BZ5RE6TUVAk8ojdCtEcN-V8s8weZqqdLz1ZGFSs8NWBWcVfBqNmMvW6t_06oZf_xavHp-ynwz2eM9me02jOFWxJ7WR_Vp6_77BzC6N48dNL4S4j1rR1vPbxQFfXH7wZnlubhFuYBFPtDxprTKLEN0aQwibELlHeIMyMw7RbVBmvD6ToFmVyazGCGhSZTKzi1BZZvwjZAa211lm2shMZSbMiyxMiixbnm9tE4sQvRpDCJsQeZFFgzYxDtFr0CaiviqjWZXZpMYIaFJlNrGLUNkm4iNsArbX2SbayExtIs2LLE2K7LeyNyE7m1iE6NcYQtiEyIssG7SJcYh-gzaR9VUZzarMJjVGQJMqs4ldhMo2kR9hE7C9zjbRRmZqE9-8yL5JkTsta5dYRBjUFkHYRMhL7DdoEuMQgwZN4tdXYzSrMpPUGAFNqswkdhEqm8T_CJOA7XU2iTay9_zL5sL9JyrZRptEGf03pn0cmFo-qtMXkES7eKEe4miRLXP6OM647BdLlaSnv4rTh7vN6U_HgD_DnIQlDYsizH-G_Tcwt4O5rEILXokeVKFlj6YlSXeqwByMnKaFqELLdiW6T9M-uU27NNyxgEUR7pJwjy5Ij4TBM_dJ2Of00gOS5oDmtFQ4soqmFRszABqpAeDIDQgHcgA4sgOn5QL0AGjkB4AjQQAcGQLhoC5cM8zbLYtGRyumgGua4LRkeBcUhtYMenTaM3wAFqdNI9oA11RjVXaahmWncVh2gKOy0zgqu9Asa1N2QKOyAxyVHeCo7AgHO17Q51aBTo-aaihcK7ugVSN8cGymVYMenTaNAEcSQZtG9AGuqcbqzE_T8NBP4_DUD3B07KdxWHbNslZlp2lYdhqHZadxWHaAox1Pn2Ul-NolfZYt4FrZJXhFBkdhSasGPLqkTSM7YHHaNBKcSqSmGpuyAxqVHeCo7AgHZQc4fMnXLGv1lk_T8DWfxuF7Po3DF32Aox1Pn2Ul-t7os2wB18tOq8YHR2GfVk3x0eevv_wfAAD__8HcDQ8=

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lkFv2jAYhu_7FdZ3aiWjYCfQEmkSXcs0JFY64NCpyiElXkGiJLODVFrx3yeSai0B_MXz6lspfuzXnx-J9wXU7wWEMO4NepcTspIL8nU0_E7uerc3g4v-NTm56o8n4x-DU3LyumZdrnhaP5Ph6Ko3Il9-kudT0ru97N1MyMVggKyMgMIyTcR1_CgUhHfAgAIHCj5QCIBCCyIKmUynQqlUbpe8FEA_eYKwSWG-zFb59t8RhWkqBYQvkM_zhYAQJvH9QoxEnAjpNYFCIvJ4viiOeVo_dzM5f4zlGiiMs3ipQtLwticPV3lIuhyiDYV0lb9u_7br_ZrMYjXb3a_LINpEFFQePwgI2Yb-W8yW05j8aMy3fVbLVCZCimRnp2hLYksO3PVbrGZjkQ8zj1VeZLLORPhOHKCwEL_yky47_SznD7Pir7_3ZpV7v93Jt7jTgcDXaSPNPNaq3v7g2cHO2az-s7Maz-7xhud_iJ8GQduOg_KjQR0YylwYyusPn9cZvt_wgg-xxCDomeOg_GhQB5ZwF5b49Yfv1xl-0Ch-av6_JQZBzx0H5UeDOrDEd2FJUH_4QZ3htxof4ohBzI7TmPxoTAeGBK770IE4I6GydKlErbbT3F5IJA-iHJBKV3IqbmQ6LY4pPw4LrvjlToTKy295-aG_LL_aBqwPt23gjg3MrHKzlp5mBiPjZnDbBu7YwMwqd2VkezSv0s33tK-ft6-F2e7MmlU6sBFcDyOC62FEcD2MCY7QiOAtG8H1MCK4HkYE18OY4AiNCN62EfzMRlE9jCiqhxFF9TCmKEIjip7bKKqHEUX1MKKoHsYURWhE0Y6NosyqJyA0IilCI5YiNKYphmNdwa4s2LUFu7pg2RfsCgOzagxsrzIY2aqnMVv1NGarnkZtRXDMVpOytP9mJm3JlMZsNepLxjhm61550NoabT79CQAA___X6XW5

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mNFu4kYUhu_7FNa5SiQjmBkbiKVK2W6oGomGFLjYasWFF08TJBa7tpFCorx7hWnrjR2f3xPb3AXw5_nnZL7DMS-U_L0ljxaT6eTz0trHW-vX-ex36-vky_300-2ddXFzu1gu_pheWhf_XnM4XfF0eLZm85vJ3PrlT-v50pp8-Ty5X4KrVmTTLgz0nf9dJ-R9JUE2SbJJkU0O2eTSyqYoDtc6ScL4eMlLBtwGT-QNbNrson16fHtl0zqMNXkvlG7SrSaPlv63rZ5rP9Bxf0A2BTr1N9tsmafD83UUb7778YFsWkT-LvGsXv-48myfeta1pNWrTeE-zW-fpP6DJk-82h-L4LYWQZpEuNkk6Wa3TvuiUINrUVggZ74drEc_eXzn-jyE-lgIt9UQTmWI_D77XRgHOtbBmztld6mMKVGt8ghuVxFQpfIIwwYR7A-l_M1PHhc6nUV9VajU8hBp7z_5P02nZNNW_5VeXIvLn-PNw2P21_9nvHpPo3bLehf2wqiv3OLu3117_GZtUV9xUUPxvuz1lXGfMQgxbDGENAmRSy467DS1Qww77DSiPc1Rrao6TYsRUKWqOo1ZhMadRpyj08j6osk6oqle3zG23SDEqMUQ0iRELprs0PbaIUYd2i7bUw3Vqsr2FiOgSlXZbhahse3yHLar-qKpOqI5vWzMN7PdIMS4xRDSJEQumurQ9tohxh3artpTDdWqyvYWI6BKVdluFqGx7eoctjv1RXPqiOb2jF03iHDVWgRpEiGXzOnQ9Nohrjo03WlPM1SrKtNbjIAqVWW6WYTGpjvn_r3gnThznUThLtG1fg0YHDekgwd9KlAS7uO1vo_DdbbM6eUs47I3Ap2kp0_l6cXt7vTRMeCPsGBhxcOyCIsfYecNLMxgIRvRV01oOWxCK8XTiqXdJrBotLQcNKJHTWgFDovDHlPw_3INYFmEhywMNj3i7Rryeo1ZWgx4-oqnBegLpa5i4jagkdwIB3YDHOkNcOS3KLVUE8EBjQwHOFIc4eC4AxxJLkqN9e2RRXipxXB4SXTB9xi0db7JiBHQjW8zYgzwUqMxspWnoa0AR7byOLSVx6GtpSZrZCtPQ1t5HNoKcHRkeRzayn_BSAGGKDC2Ct5WyQ-uYOuS7zTSAXMv32mkC_BSpzGam3kaDs4AR5Mzj8PRmceRrbLUZU1sBTSyFeDIVoSjI8vjyFbJf8HIMcD5SbaAl23lR1m0db7TKDDKKr7TKPCErPihBtQd0MhWhANbAY5sBTh80uUflNGjLnjEb7Y4fNgFOHraBb8RoFPDf8EoVDp-lC3gJVsVP8sWt756_emfAAAA__8UVAb-

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllFr4kwUhu-_XzGcK4WROJNoa-CDlq7LCm7tVi8KJRepma2CNdmZCNrS_76YtFijzsnsYHI5Os_MO-c8kPMG6s8CfBj3h_2bCVnJBfl-P_pJHvsPd8PrwS1pfBuMJ-Nfwyb52LLONzQan2tKNvlP681rk_Qfbvp3E3I9HJLjO5oBUFjGkbgNX4QC_xEYUOBAwQUKHlDoQEAhkfFUKBXL7Za3DBhEa_DbFObLZJVufw4oTGMpwH-DdJ4uBPgwCZ8W4l6EkZBOGyhEIg3ni-ya9eb1KpHzl1BugMI4CZfKJy1ne_NolfrkitErDsE7hXiVftywO_hpQ2ahmu0f-YkEFFQaPgvw2Tv9t7CdGsLyk2F3R62WsYyEFNHeYcGWxLYcefGPUM3GIh0lDit0Z7JJhP_FHqCwEL_TRpa6-b-cP88-F7saFAqwe5lr8bIjsW_jVpw4rFOswdG7vb27WXkFWAkFHN5y3DMaaxC3W0tcfjJuBc6y6pzl5RvByzTCbTneGb0xiHtRS1x-Mm4F3vDqvHHLN8It0wivlX2azuWNQdzLWuLyk3Er8MatzhuvfCO8Mo3otM5ojUHYXg1h-cmwFTjj1TNXHQl1L1QSL5UoNTW1t88S0bPIy6TilZyKOxlPs2vy5Sjjsq9-JFSa_8vzxWCZ_7UNWB7u2sA9G5hZ5WYdPc0MSsbN4K4N3LOBmVXuQskOaF6k219pV19vVwuz_Zq1i7RnI7geRgTXw4jgehgTHKERwTs2guthRHA9jAiuhzHBERoRvGsj-IWNonoYUVQPI4rqYUxRhEYUvbRRVA8jiuphRFE9jCmK0IiiPRtFmdWcgNCIpAiNWIrQmKYYjs0KdsOC3bRgNy5Yzgt2AwOzmhjYwchgZKuexmzV05itehq1FcExW02GpcOemUxLpjRmq9G8ZIxjth4MD1pbg_f__gYAAP__B2KH9g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4jgUhd_3V0T3qZWMwHYCNNJKHc2w2kps2y08jDTiIQPeFokhbBKkMlX_-wrYKoWQe2ySdB5N8sXHF5-T67xQ-u-CQhoNhoPPY2-dLLw_Hu7-8r4Nvt4PP93cehdfbkbj0d_DS-__W573N1xcvI2Ft9n_9Lz5eekNvn4e3I-901cvJyRoGc_MbfTDpBR-I0mCFAnSJMgnQQFNBK2SeGrSNE62t7zsgJvZM4UdQfPlap1tf54ImsaJofCFsnm2MBTSOPq-MA8mmpmk3SFBM5NF88VumufNz-tVMv8RJRsSNFpFyzT0Wu3tzHfrLPSupbhWNHkVFK-zfIY0ix4NhfJVnKciqFOFclHxZZ5m8-U0a8ujSpyaI8e-b7ynKH06jeRS9HlSggak-KVS8ketl3EyM4mZHTxs95RSscqibrmKoCkVFiXLVXQrqBBnCf0zSp9GJrtbtfVRvcablQnf0uDTcEiCFuaf7GK3gsvfk_nj09sg3_6lK-vVW9_buBWv2jo4rsHJufsHc0t790sL97dVq63PSSEHHd16dSgXHbn5ZeM5ZC2l23gOyfoSwKJuZTlUowqLkpXlkJuKyjkkPy6HlL0HlY0Hdavtn5MFDjp69epQLjpyA6rGs8BaSq_xLFD1udCibmVZUKMKi5KVZYGbispZoD4uC7S9B7WNB_3W7vTgnAUOOvr16lAuOnID6sazwFpKv_Es0PW50KJuZVlQowqLkpVlgZuKylmgPy4LfHsP-jYeDFrnJIGDiqs6VSgXFbn5_MZzwFrKVeM54NfnQIu6leVAjSosSlaWA24qKueA_2u-U5wQ9WDSVbxMjdVXiM52WWb2aPZlSuN1MjX3STzdTbMf3u243Q8zk2b7q2o_uFnuL20FvoclC2seVsewfA_7B7B0g6WqRF9VoVW3Cq01T2uWDqrAstLUqlOJ7lWhNdgsPrtNwf8VOMDqGO6yMFh0j3dXl7dXn6Vlh6eveFqCXCikiou3AY3MjXDgboAjewMc-VsWItXF4IBGDgc4sjjCwXYHODK5LATr4ZZFeCFiOLxgdMlnDFo6HzKyB-zGx4zsA7wQNE5u5WnoVoAjt_I4dCuPQ7cWQtbJrTwN3crj0K0AR1uWx6Fb-ReMkqCJAm2r5N2q-MYVLF3xSaN80PfySaMCgBeSxqlv5mnYOAMcdc48DltnHkduVYWUdXEroJFbAY7cinC0ZXkcuVXxLxjVBzjfyR7hRbfyrSxaOp80GrSymk8aDU7Imm9qQN0BjdyKcOBWgCO3AhyedPmDMjrqgiN-tcnhYRfg6LQLvhGgXcO_YDQqHd_KHuEFt2q-lz1e-uT1t_8CAAD__w66JZM=
