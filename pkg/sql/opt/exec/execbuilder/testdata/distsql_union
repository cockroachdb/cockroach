# LogicTest: 5node

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x
----
distribution: full
vectorized: true
·
• union all
│
├── • sort
│   │ order: +x
│   │
│   └── • scan
│         missing stats
│         table: xyz@xyz_pkey
│         spans: FULL SCAN
│
└── • sort
    │ order: +x
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0ls-O2jwUxfffU0R39VV1FK7tzJ-sZjpDJSQKU5hKrSoWKbFGSIBTJ0gwiHevCEgzVOQ6duiOxJx77jn-LbKF4vccEuh-f-rf9wbB_4-98fP4a_9DMO72uw_PwTr4PBp-Cdab1-DboDccBPf9_pmz4eixOwo-_QjWwGCpMzVIF6qA5CcgMODAQAADCQximDDIjZ6qotBm_5dtJehla0g6DGbLfFXuX08YTLVRkGyhnJVzBQk8p7_maqTSTJmoAwwyVaazeWWz3rze5Wa2SM0GGDzo-WqxLJJqnXGe7n-GEYfJjoFelW8ORZm-KEhwx5pvMdamVCaKTxe4w4-147nL-Pch8aIphUdKdIgpa-e_jdUmU0Zl54aeWWKgQ51H_LSFOvvOv7KPG9nHJ_bocMmudxzxMBINWbbscbzlK1-WXWJeOKfwyIkOQWXt_JY4oQfNvHnP3LlmEUayIU6WPY41X_vi5BATL5xTeOREh6Cydn5LnLgHTqJ5z8K5ZhlGcUOcLHsca77xxckhJl44p_DIiQ5BZe38ljgJD5xk856lc81x2BAmyxbHkm99YXIIiRdNKTxSokNMWTu_JUqy5WfbmckjVeR6WaiGkycMVPaiDlkKvTJT9WT0tLI5PA4rXfUiU0V5OMXDQ295ONov-F6MpFieiPFvMSfFgnYWbZwlKY5pcUyK-RW99xWpvqbF1_RddejFb0j1LW1928oaacosjSONGXILpDRoaHOnUUNpcadhs7rTuNnUNG5o4Q1p4Ljt1mni0IIc0szZ3Hkr5jjNHLcwx2nmuM2dZo5bmOM0c1Z3N-Ymu__-BAAA__9leEQf

query T
EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • union
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk-P2jAQxe_9FNGcWtUo2En4k9O2C5WQKGyBSq0qDimxVpEgpraRYBHfvSIcUiiM7SS3TbJv3s9vnpCPoP6sIYbhj5fxp9HEez8YzRfzb-MP3nw4Hj4vvL33ZTb96u0Pb973yWg6ufN-OhsMZ97nn94eCOQi5ZNkwxXEv4ACAQYEAiAQAoEIlgS2Uqy4UkKe_-VYCEbpHuI2gSzf7vT59ZLASkgO8RF0ptccYlgkv9d8xpOUS78NBFKuk2xd2OwPb09bmW0SeQACz2K92-QqLnDm2-T8Z8tnsDwREDtdOiidvHKI6YlUo4iapGAuFINM6SxfaZ_eJPFEHxoE1Qwia4PwoUE5d5cLmXLJ06upyxOGwOzPGLmccS6k5tJn9Hb8x4fzO1fzqX1VqGtVfNbyA8vKOnB0muVgLhxlp_5L3LK01gadiqVl9kky5ySDlh9abtSBo9ssB3PhKANnFTdqbdCtuNHAPsnAOcmw5UeWG3Xg6DXLwVw4ysCDihu1NuhV3Ghon2TonGTUstynA0W_SQrmQlGGHVbcprVBv4Frwh2DGVdbkSt-c124P7l9vkbw9JVf7hxK7OSKv0ixKmwuj9NCV7xIudKXr8HlYZRfPp0B_xVTVMxwMUPF4ZWY3oqDOuIQFUc4doSf2XDoDqru4-IuKu7h4l6dxPp1xBTvGDWVDG8ZNSROa_WM1ioaxZtGuwZ0vGu0Y5DjZTOx420zqfG6MWpAxwvH2oafFrxxBnaGF-5WvTy9-xsAAP__0xpIbQ==

# UNION with no overlap.
query T
EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • union
    │
    ├── • filter
    │   │ filter: x < 3
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 3
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysl09v2kAQxe_9FKs5taqRmV2bP5YqpU2IipRCClRt1XKgeBVZIjZdG4kk4rtXgIQDDTO7jm_B8PbNvPnNBp4g_7uACHo_bm8-9gfi7VV_PBl_vXknxr2b3uVErMX1aPhFrB8exffPvVFPrMXvVbOp5kKJb4P-cMB9UH8QSgxHV72R-PRTrMGDNIv1YHavc4h-AYIHEjxQ4EEAHoQw9WBpsrnO88xsP_K0E_TjNURND5J0uSq2j6cezDOjIXqCIikWGiKYzP4s9EjPYm38JngQ62KWLHY264fHi6VJ7mfmATy4zBar-zSPduWMl7Ptnw1fwnTjQbYqSoe8mN1piHDj2VdxnSwKbbTxw-MS9s8jcYFlMFEU9QeTzllj6WL8vH2stX9VqX9kApjz_QcuxldJXiTpvPDlSfMXeNYgrGYQWhu0zhqU567SzMTa6Pjo1OmGKkHZ99h26XGcmUIbX-Hp8e_Pnt85Oh8dIHVl1JcNX1luKVPHgdJW3VvqEkDNCahKCSATgfOeMsblGv0HmeWeWhu0Ku6ptJ-hdB6haviBJcRMHYcRtuuG2CEArDkBVSkBZCJwhpgxLhmTFSG2NmhXhFjZz1A5jzBo-KElxEwdhxF26obYIQCsOQFVKQFkInCGmDEuGVMVIbY26FSEOLCfYeA8wrBhiTBTxWGA3boRdmgfa-1fVeofmQCcAWaMS76CigBbG3Rr-Mr_gsFI58sszfXJV_-XT25ufxLo-E7vfz_k2crM9a3J5jub_cvhTrd7EOu82L-L-xf9dP_WtsDnYiTFIS2WpFjRYkWKA1ockOLWkRhPxeFrxC1S3KbLbtOBSVrdIdVdWtylKWGGhQxkHGU0Zsg0jjRozMSQJo1T06ghsyJIw4bM1JDGDRnekAYOO4ycJo5LjkaOUUuaOMkQJ2niJHez0cRJZl0kjZxkbjf5qutNvup-kzRxkiFOMlccNzaaOMmsi6SRU03mXxLNHJOcopE7VU83b_4FAAD__4nHoMI=

# UNION with partial overlap.
query T
EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • union
    │
    ├── • filter
    │   │ filter: x <= 4
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x > 1
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysl09v2kAQxe_9FKs5taqRmV2bP5YqpU2IipRCClRt1XJw8SqyRGy6NhJJxHevAAkCDTO7jm_B8PbNm_nNBp6g-DuHCHo_bm8-9gfi7VV_PBl_vXknxr2b3uVErMT1aPhFrB4exffPvVFPrMTvZbOpZh9EIL4N-sMB90ktUAxHV72R-PRTrMCDLE_0IL7XBUS_AMEDCR4o8CAAD0KYerAw-UwXRW42H3naCvrJCqKmB2m2WJabx1MPZrnRED1BmZZzDRFM4j9zPdJxoo3fBA8SXcbpfGuzeni8WJj0PjYP4MFlPl_eZ0W0LWe8iDd_NnwJ07UH-bI8OBRlfKchwrVnX8V1Oi-10cYPj0vYPY_EBe77EkVRfzDpnPWVLr7P02Ot8VWl-Mjk3xDENSBwcb5KizLNZqUvT9Jf4FmDsJpBaG3QOmtwOHeZ5SbRRidHp07XVAnKPmPbJeM4N6U2vsLT49-fPb9zdD46UOoKqS8bvrLcUqaOPaatmrfUJX_NDVCVGoBMB9z3lHE-rNF_kFnuqbVBq-KeSvshSucZqoYfWELM1LGfYbtmiB3yY80NUJUagEwH3CFmnA-MyYoQWxu0K0Ks7IeonGcYNPzQEmKmjv0MOzVD7JAfa26AqtQAZDrgDjHjfGBMVYTY2qBTEeLAfoiB8wzDhiXCTBX7CXZrRtghPdYaX1WKj0x-d4AZ5wNfQUWArQ26NXzlf8FgpItFnhX65Kv_yyc3Nz8JdHKnd78finxpZvrW5LOtze7lcKvbPkh0Ue7exd2LfrZ7a1PgczGS4pAWS1KsaLEixQEtDkhx60iMp-LwNeIWKW7TZbfphkla3SHVXVrcpSlhhoUMZBxlNGbIBEcaNGZiSJPGqWnUkFkRpGFDZmpI44YMb0gDhx1GThPHdY5GjlFLmjjJECdp4iR3s9HESWZdJI2cZG43-arrTb7qfpM0cZIhTjJXHDc2mjjJrIukkVNN5l8SzRzTOUUjd6qert_8CwAA__-Eh6C8

# UNION ALL with swapped column orders.
query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• union all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyslUGLm0AYhu_9FcN3amHEzIxmdz1l2aYQsGabpFAoHmwcFsE4dkZBN-S_lxjabUJ2HMccdXz8Hr_3JdmD-p1DAPMfz-HjIkIfPy_Wm_W38BNaz8P50wY1GLXoy2r5FTXtK_oeLZYRegzDv8ctRs2_Y8BQiJRHyY4rCH4CAQwUMDDA4AEGH2IMpRRbrpSQx0f2HbBIGwgmGLKirKvj7RjDVkgOwR6qrMo5BLBJfuV8xZOUS3cCGFJeJVnejWna11kps10iW8DwJPJ6V6igMwcM6zI5Xjnu0WRZVwGaUTwjEB8wiLp6m6iq5IVDQA7Yzsq3tHpPhL4r8jZfcZklOaoLIVMueXqmEB-uGEfCEaVLJhdPXleYGCgMn-0bzWZns4l5DsQiB5c6LrPpxwCvqbWXWUPIbRtCLBpCzbdBbbbBHNezSWmA1521l1lK9LYpUYuUmPk2mM02PKf7LRyc0gCve2svs5TYbVNiFil55tvwbLbhOzYZDbB6sLQyS8i7bULeyP_DK29ecVWKQnHDN8cYePrCT9-jRC23_FmKbTfmdLnsuO5GylV1OqWni0XRHXVh_Q-TMTDVwkwPMy1Mpmf05JL2tPRUP9ofA0_HfPSdFn7Qw_dj4Icx2kTfMdJXMn3LevFRPSM9RfN7cH3TenF91y7d48OHPwEAAP__S0dirw==

# UNION ALL and UNION with different ORDER BY types.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• union all
│
├── • sort
│   │ order: +x
│   │
│   └── • scan
│         missing stats
│         table: xyz@xyz_pkey
│         spans: FULL SCAN
│
└── • sort
    │ order: +x
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0ll1v2jAUhu_3K6xz1WpG4dhOP3LVrmUSEoMOOmnTxEVGrAqJYpYEKaHiv098SC1bc-zY2h35ePOe5_i54AWK3wtIoPf9YXDbH7Kz-_7kcfJ1cM7OJr1B7-6RVezzePSFVfWGjcb3vTH79IPV5-zbsD8astvBgHxxc_76uwIOS5PpYfqsC0h-AgIHARwkcFDAIYYph1VuZrooTL575WUf6GcVJF0O8-VqXe5uTznMTK4heYFyXi40JPCY_lrosU4znUdd4JDpMp0v9jVVvblZ5fPnNK-Bw51ZrJ-XRcIqzjbAYbJKd1edSMB0y8Gsy9eSokyfNCS45e6DTExe6jyKT2e4wY_AYbQuE3aDjUWiTdFbYnRGrt2QpQcyejGrxqbXApNnOtfZv5-fbt8ZZ2g6ZhWJ05U01Xf_V33sVB-f1GOLE_dwPBKdSDpabhnleOQX4Za3YXaGrl2hpQc0elGrxqZA0dDDc-G-dOEjmuxEylE0yyjHnV-Gi9aCGZ2ha1do6QGNXtSqsSlQNOEhmnRfuvQRTXWi2FE0yyjHnV-Fi9aCGZ2ha1do6QGNXtSqsSlQNOkhmnJfuvIRLe44amYZ5Ljx63DNWhCjM3Lthiw9kNGLWTU2BUqmAv8evvPlsS5WZlloxy9POejsSR9YCrPOZ_ohN7N9zeFytM_tb2S6KA9P8XDRXx4e7QZ8G0YyrE7C-HdYkGFJN8uQZkWGYzock2FxQc99QaYv6fAlfVZdevArMn1NV18HVSNtmWXjSGuGwiIpLRra2mnVUFnaadms7bRutjStG1p8Q1o4YTt12ji0KIe0c7Z2EeScoJ0TFucE7ZywtdPOCYtzgnbO2t7Ouen2w58AAAD__-lCatc=

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • union
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysls-O2jwUxfffU1h3NaPPKNhJ-JPVtAOVkChMgUqtKhYpsUaRIKG2IwUQ714lLFLozI1tuhsnOT4_33M0-ATq1xYiGH97mX6YzMjDaLJcLb9MH8nDcjwdP69IST4t5p9JeTiS-WI0XpCP38nhkXydTeYz9KPjY_N3CRSyPBGzeCcURD-AAQUOFHygEACFENYU9jLfCKVyWX1yqgWTpISoSyHN9oWuHq8pbHIpIDqBTvVWQASr-OdWLEScCOl1gUIidJxua5vycHzay3QXywNQeM63xS5TESkpOQKF5T6uVh2vIpkXOiJPDNZnCnmhGzul41cBETtTN6TQFOlgi8RtkEap0mm20R67mRFi4LsZhMYGwbsGzb5FlstESJFc7bo-Ywjc_IyhzRmXudRCepzdbv__u_v3rvZn5r1hDlX2eMfzrctsAdVzKLMpFLeBatr2VxaGdTY26DnWmZuPlbtk7Xe8wDprC6i-S9aGUNwGqomCO2ZtbNB3zNo3H6vvknXQqX9H7LK2gBq4ZG0IxW2gmih8x6yNDQaOWQfmYw1csg471klbIA1dkjZC4jZITQyBY87GBsN_cB15w2Ah1D7PlLi5lry9c7e6rojkVVzuNiov5Ea8yHxT21yW81pXP0iE0pe3_mUxyS6vKsA_xQwVc1zMUXFwJWa3Yv8ecYCKQxw7xM_ccugeqh7i4j4qHuDiwT0TG94jZnjHWFvJ8Jaxlomzu3rG7ioaw5vG-i3oeNdYr0WOl62NHW9bmxqvG2ct6HjheLflXwveuBZ2jhfuVr0-__c7AAD__4vwbyU=

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• union all
│
├── • sort
│   │ order: +x
│   │
│   └── • scan
│         missing stats
│         table: xyz@xyz_pkey
│         spans: FULL SCAN
│
└── • sort
    │ order: +x
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy0ll1v2jAUhu_3K6xz1WpG4dhOP3LVrmUSEoMOOmnTxEVGrAqJYuYECVrx3yc-JMrWHDu2dpmQ1-95jp8LXqH8PYMMOt8ferfdPju7744eR1975-xs1Ol17h7Zin0eDr6w1fqFDYb3nSH79IOtz9m3fnfQZ7e9Hv0hZy_nx8cVcJibQvfzZ11C9hMQOAjgIIGDAg4pjDksrJnosjR2-8nrLtAtVpC1OUzni2W1fT3mMDFWQ_YK1bSaacjgMf8100OdF9ombeBQ6CqfznY1q_XLzcJOn3O7Bg53ZrZ8npcZW_HdgMBhtMi3L1qJgPGGg1lWx56yyp80ZLjh_rOMjK20TdLTMW7wI3AYLKuM3WBtkWhS9BYa_an9kGUAMgYxq9qmY4Gxhba6-Pf48eadcfqmZRaJOF1JXX37f9WnXvXpST02uPEwzRPRSqSn6I5pDrd-ES96E2x_bl9oGQCNQdSqtinSNQxQXfgvXQS6JluJ8nTNMc1h7ZfxrjXARn9uX2gZAI1B1Kq2KdI1EeCa9F-6DHRNtZLU0zXHNIe1X8W71gAb_bl9oWUANAZRq9qmSNdkgGvKf-kq0LW05WmaY5bD0q_jTWsAjf7UfsgyABmDmFVtU6RnKvKv4jsnD3W5MPNSe5485qCLJ71nKc3STvSDNZNdzf5xsMvtXhS6rPa_4v6hO9__tB3wbRjJsDoJ499hQYYl3SxjmhUZTulwSobFBT33BZm-pMOX9F216cGvyPQ1XX0dVY20ZY6NI60ZCoektGjoaqdVQ-Vop2VzttO6udK0bujwDWnhhOvWaePQoRzSzrnaRZRzgnZOOJwTtHPC1U47JxzOCdo5Z3sz58abD38CAAD__zZCb3U=

# Only one distinct processor should be used in the single node UNION case.
query T
EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)
----
distribution: local
vectorized: true
·
• union
│ estimated row count: 4
│
├── • values
│     size: 1 column, 2 rows
│
└── • values
      size: 1 column, 2 rows
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysj0FLAzEQhe_-ijCnXQh0N_WUk5X2sFC21doiSA5LMtTFNamZBISy_12aBWvFCkWP82bevO_tgd46kDB7XM4nVc2yabV6WN3Nc7aZzNezFcvKnLNM5GxdV4v6UxUHdZwDB-sM1s0rEsgnKEFx2Hmnkcj5g7RPB5V5B1lwaO0uhoOsOGjnEeQeQhs6BAmbpotIowI4GAxN26WP1-yWZYLp52hfKAfVc3AxHL9QaLYIsuj5xUnlPycdA6J13qBHc5Kg-h9Ypi2F1uowEqc0N-VZgvKSrvdIO2cJv5Gc66Y4oNniUIdc9BqX3ukUM4yL5EuCQQrDVgxDZdMqAX41l38xi1_N4xNz0av-6iMAAP__nsboJg==

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • intersect all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9vokoUx9_vX0HOU5s7BmYAf5DcpL2tmzVxtSs-7GbDA5XZamKFHTCpbfzfN2BNi-gcRsy8qfCZ-TLnczy8QfpnCR70fzwMbwcj4-p-4E_978Nr48rvD_t3U2NjfJmMvxkvm9drYzCa9id-_uvtcHj0jvHkvj8x_v9pbIDAKo74KHzmKXi_gAIBBgRsIOAAARcCAomIZzxNY5Hf8lYAg-gFPIvAYpWss_zngMAsFhy8N8gW2ZKDB9PwccknPIy4MC0gEPEsXCyLbV42rzeJWDyHIk9wFy_Xz6vUK-L4SZh_bJkMgi2BeJ297_Cx8OPGmIfpvLzkDYVgGxBIs_CJg0e35Lykru6k7GTSj3XWq1hEXPCotFKQk9gtRx73a5jOfZ6NE5Me1GW6SbhXFggILPnv7OqGXv8nFk_z4hMQGK8zzyge5fOjfzyWrVIAPxYZFyZ1D0_q35PrOzWO7diJvC96JMQobsWJyazDMz66vVvantb3i6r6ZbKWaV-wFxSytvVnZSezaugGqqkbkBLsu6F9bjew-iVmyiW2W6ZzQR0Vsnb0Z2Uns2rQkWnSESnBXsfOuTra9UtsK5fYaZnuBXVUyNrVn5WdzKpBR1uTjkgJ9jp2z9XRqV9iR7nEbuuCMiok7elOyk4m1aCio0lFpAB7FXuXeG09sv6Ep0m8SnmtN1IrPzMePfFdDdJ4LWb8QcSzYpvd13HBFS8gEU-z3VW2-zJYFZeKutaHO01gShvRbiO6J6epwplRNbjTBD44M1XabUT35DQ7pK3PtF2CrUPYlsKOfGdHCjMq39pt0h9yGOkPOYz1B0Ij_YHQSH-0m_SHHEb6Qw5j_YHQSH8gNNIfHamlXbmk3Sb90WtiuBxGDJfDmOEIjRiO0NgEUBmb1X9SlbmpSqNDQGlyKuOI5rQyRUqqUiYXncrHCGI6rcwRFdURGnEdoTHZMRyxHcMx3SszVEl3OY3pLqdR3REc0x3BMd0rg7SsexvRvTJTlHSvzBQl3eU0prucRnVHcEx3BMd0r8xTJd3lNKa7nEZ1R3BMdwTHdK9M1fK7tiXXnVVmi1T3YPvP3wAAAP__SkGIVw==

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • intersect
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v6jYYxu_3KSJftVpQsJ3wJ9Kknp0yDYmVM-Bi09SLHPBaJEpYEqTSqt99IpwqbUzex26S3rXAL37y4ucnh2eW_rdhIRv99W3yZXzjXFyP54v5n5NL52I-moy-LpyD89ts-ofzeHi6dMY3i9Fsfnz13LvT2fVo5vz6t3NgLtvGK3UTPaiUhf8wzlwmmMskc5nPXBawW5ftknip0jROjh95zoHx6pGFXZett7t9dnz51mXLOFEsfGbZOtsoFrJF9H2jZipaqcTrMpetVBatN_kyj4enq12yfoiSY4Kv8Wb_sE3DPM58Fx3_7HiC3b64LN5nxQppFt0pFvIX92MpgiZTCJsU1-s0W2-XmcdLk7jipQUK5vvBuY_S-zOfL0LIj4UIGg3hV4YorrPfxslKJWr17kr5VSpjCjSrIkLQVgQ0qSJCr0YE90Mpf4_S-7nKpjtPlia1OOxU-EYCXyYT5rKN-je7uOKXvyTru_v8L-ay6T4LHeK2-jY7bB4nmUo8qU3t58rrDwzGdm4iPy56JsRN3Il3nt8tz_js8sN3y3Nzl3Bbl3ii40lDp1nk6DWbQ9jkKITCW7SacYhei1bjzSkFzarKag1GQJOqsppdhNpW459kNbDDXq2mTc3UasK8zsK6zrLj-YZascjRbzaHsMlRNFq0qBXjEP0WtSKa6zSaVZVWGoyAJlWlFbsItbUiPkkrYIe9akWbmqlWpHmdpXWd_Y4XGGrFIseg2RzCJkfRaNmiVoxDDFrUimyu02hWVVppMAKaVJVW7CLU1or8JK2AHfaqFW1qplrxzevsW9c56BhKxSLFsMkUwiZF0Wa_RaUYhxi2qBS_uT6jWVUppcEIaFJVSrGLUFsp_icpBeywV6VoU_vIzzpnrj9T6S7epsroF5vucWZqdadO30Ea75Ol-pbEy3yZ07_TnMtfWKk0O70rT_-Mt6e3jgHfwpyEBQ2LMszfwv47mNvBXNahBa9FD-vQsk_TkqSDOjAHI6dpIerQsluLHtC0T27THg0HFrAowz0S7tMF6ZMwuOcBCfucXnpI0hw0m9NS4WBxrmnFxgyARmoAOHIDwoEcAI7swGm5AD0AGvkB4EgQAEeGQDioC9cM837LotHRiinhmiY4LRneA4WhNYNunfaM6ILFadPwIcA11ViVnaZh2Wkclh3gqOw0jsouNMvalB3QqOwAR2UHOCo7wsGOF-Dcik6PmmooXCu7oFUjfHBsplWDbp02jRiAxWnTCHCiEZpqrM78NA0P_TQOT_0AR8d-Godl1yxrVXaahmWncVh2GodlBzja8fRZVoKvXYIHZE6XXdKqkeAkLWnVgFuXtGkkOFZI2jQyALimGpuyAxqVHeCo7AgHZQc4fMjXLGv1lE_T8DGfxuFzPo3DB32Aox1Pn2Ul-t7os2wJ18tOq8YHJ2mfVk351m9ffvo_AAD__wBAF2c=

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6xz1UpGwU5CS6RJ7VqmITHogItNUy5S4hUkirM4SE0r_vuUMIny5YNn5N2RJo_92ueR-r6B-j2HCDrfH3q33T65uO-OxqNvvUtyMer0OndjUpLPw8FX8lK-ksHwvjMkn36Q8pJ0--POcFR9cNvrIR8DhYVMRT95Fgqin8CAAgcKPlAIgEIIMYUslxOhlMyrT95qoJu-QNSkMFtky6L6c0xhInMB0RsUs2IuIIJx8jgXQ5GkIveaQCEVRTKb19u8lK83WT57TvISKNzJ-fJ5oSJSPYyypPrZ8DjEKwpyWfzdYbPwY0mmiZpuL3nDIF7FFFSRPAmI2Ir-W9LQdVJ-NOlmneVC5qnIRbq1UlyR2CcHjvslUdORKAaZx3bmMi4zEW0LBBTm4ldxccMuP-azp2n9CygMlkVE6qO8P_rmWL7FsQ5k7suGzDwW7l7Awb2Drb3Z6cNnpsP3eMPzzyiqQdaW-6z8aFYHqjJHqvLTR8CNR-A3vOCMuhhkvXKflR_N6kAX7kgX__QR-MYjCBpeeEZdDLJeu8_Kj2Z1oIvvSJfg9BEExiMIG2eUxSBp23VSfjSpA1WC_9CZDiQaCpXJhRInNaJmdSaRPon1HSm5zCfiIZeTepv146Dm6v_rqVDF-i1fP3QX9av63k-HWzZw2wZmVrlZqKeZwZUxM7hlA7dtYGaVe-fK9mi-Szff074e9rUw276z5i4d2AiuhxHB9TAiuB7GBEdoRPDQRnA9jAiuhxHB9TAmOEIjgrdsBL-yUVQPI4rqYURRPYwpitCIotc2iuphRFE9jCiqhzFFERpRtG2jKLPqCQiNSIrQiKUIjWmK4VhXsCsLdm3Bri5Y9gW7wsCsGgPbqwxGtuppzFY9jdmqp1FbERyz1aQs7d-6SVsypTFbjfqSMY7ZulcetLbGqw9_AgAA___Seoao

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)
----
distribution: full
vectorized: true
·
• intersect
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmMFu6kYUhvd9CuusEsnIzIwNxFKl3N5QFYmGW2DRqsrCF08DEsGubaRwo7x7BSwc7Pj8nthOdyHxx_xzMt_hDC-U_rsln8Z_fpt-mdxbV3eTxXLxx_TaulqMp-OvS-tg_Tqf_W49H35Ys_ndeG798pd1uLYm98vxfHF8gH-QbNpFob4PnnRK_t8kyCZJNimyySWbPHqwKU6ilU7TKDk-8nICJuEz-X2bNrt4nx1__WDTKko0-S-UbbKtJp-Wwfetnusg1InTJ5tCnQWb7WmZ58OP2zjZPAXJgWz6Gm33T7vUt44vFnFw_LHnSHp4tSnaZ_kKaRY8avLFq_2xFF6bKaRJirtNmm12q8wRhUrcisICOfP9YK2DdP3O83kI9bEQXqsh3MoQ-fvsd1ES6kSHF-90epfKmBLVKo_gdRUBVSqPMGgQwf5Qyt-CdL3Q2Sx2VKFSy0Os_TdN4Mt0SjZt9T_Z1a24_jnZPK5PP5FNs33mW8y2hu1W9j7qRbGjvGIB3l17dLG2qC-6MBXdkT1H1Ww4BjkG7eaQJjly20WHLad2iEGHLUe05zuqVVXLaTECqlRVyzGL0LjliE9qObK-btJYN9Vz3JraG-QYtptDmuTIjZMdal87xLBD7WV7zqFaVWnfYgRUqSrtzSI01l5-kvaqvm7KWDe353g1tTfIMWo3hzTJkRunOtS-dohRh9qr9pxDtarSvsUIqFJV2ptFaKy9-iTt3fq6uca6eb2a0hukuGkzhTRJkdvmdqh87RA3HSrvtucbqlWV8i1GQJWqUt4sQmPl3f_hO4V3Es11Gke7VNf6xqB_3JMOH_W5Rmm0T1b6WxKtTsucX85O3OkXoU6z81_V-cVkd_7TMeBbWLCw5GFZhMVb2L2AhRksZCP6pgktB01opXhasbTXBBaNlpb9RvSwCa3AYXHZYwr-X54BLIvwgIXBpoe8mgNerxFLC8HTNzzdB32h1FVM3AY0khvhwG6AI70BjvwWpZZqIjigkeEAR4ojHBx3gCPJRamxXh5ZhJdaDIeXRBd8j0Fb55uMGAHd-DYjhgAvNRojW3ka2gpwZCuPQ1t5HNpaarJGtvI0tJXHoa0AR0eWx6Gt_AeMFGCI4sfWAl6yVfKDK9i65DuN9MDcy3ca6QK81GmM5maehoMzwNHkzONwdOZxZKssdVkTWwGNbAU4shXh6MjyOLJV8h8wcgRwfpIt4GVb-VEWbZ3vNArcUhW4IIM5WvFDDag7oJGtCAe2AhzZCnB40-UvyuiqC674zRaHl12Ao9su-I4AnRr-A0ah0vGjbAEv2ar4Wba49YfXn_4LAAD__zFXF-0=

# INTERSECT ALL and INTERSECT with no overlap.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect all
    │
    ├── • filter
    │   │ filter: x < 2
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 2
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1v4kYUhu_7K6xzlahGZmbMl6WVst1ltUgUtoDUVi0XXpgmSART20iwUf57ZWhCbJN5fQxx7vh6PJOX87xj8kDRv0vyqPvHt_7H3sC6-twbT8a_9a-tq3G33_00sbbWl9HwV2u7-2H9_rU76lpb6-9Nva5mlry2eoNJdzROPvax34eI_pAww9Hn7sj65U9rSzatgrke-Pc6Iu8vEmSTJJsU2eSSTQ2a2rQOg5mOoiBMPvKwB3rzLXl1mxar9SZOXp7aNAtCTd4DxYt4qcmjif99qUfan-vQqZNNcx37i-V-me3ux806XNz74Y5s-hQsN_eryNtvZ7z2k4c1R9L00aZgEx9XiGL_VpMnHu3iu_iyWMY61KHTSG_h8Lpn3YhjMp7n9QaTdmbh47W-76w7P7pLX-hG0PTxuDnJ2dzLiMRFM1KlMhIgpNllMnJf3dzxOptVEM51qOepK00TEn3kxF_41Y_uxjoerh2ZiXmyW2svbRHZtNT_xFc34vpDuLi92z8im4abOIni1cwbnMzHQRjr0JGNbFI_v3r9ZoHYTiXy_0VPbGIQ1IK1o-rZjE8u30otLxiTzR1sR9YcVVB_sI_n0W6-h_6ckC6ckiqVkgAxvUkBiGoLQFRUACDzpwJoli0AWXy4JHu2VM1xCxoI9vE8W633MJARkrhwSqpUSgLE9CYGymoNlBUZCDJ_MrBV1kBVfLgUe7bcmtMoaCDYx_Nstd_DQEZI4sIpqVIpCRDTmxioqjVQVWQgyPzJwHZZA93iw-WyZ6tRK-gf2MXzZHXewz9GROKiGalSGQkQ0pvY51Zrn1uRfSDzJ_s6l_gJeuL6Ix2tg1WkC_26rCeZ6fmtPnwHUbAJZ_pbGMz2yxyeDvfc_oW5juLDu-LwpLc6vJVs8CUssrB4CbspWPJgIc6iW-fQUp1Fd8y0NCauzIkrRuKCB2cS59Ktc-hM4ly6Y6ZdY-INc-INI9w0r9w0f9dAr5aRbpvh9jlummHkJqCBm2YauQlo4GbH3IZ1UIe5MuXYCWikJ8KBnwBHgiIcGCpylZoOXoLgzZ0KJBW5dkkv7oLFc_XCOgXNNDwGAY7OQTMOD0KAA9uEuVtFEwSfa1eWbmYa6gZwpJsZh7oBHOlmPlkEOFpErmRZuplLVoKSlZySzd98sUqWjQPdAI50Qzi68TSXrAQlK3Mly9EN0Eg3hAPdAI50QzjQTZoPGAkOGGm-fwW6SXPJSlCyklOy-ZFjlSwbR7qxSpaNI93MJStByUrODXz-W2fdwbNxpBvrHp6NI93MB4wCB4wy_0skq9v08af_AgAA____MuPK

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect
    │
    ├── • filter
    │   │ filter: x < 2
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 2
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Ftv4kYcBfD3fgprnhLVyMzFXCytlO2G1SJR2AJSW7V5YGGaIBFMbSNBonz3CmjicPH_eJghbwF8PP85O_zE-pml_85YxFp_fO98bne9q9v2YDj4rXPtXQ1andaXobfyvvZ7v3qr9ZP3-7dWv-WtvL-X1aoce-Laa3eHrf5gcxm6XH_aXN_r37b63i9_eivms3k80d3Ro05Z9BfjzGeC-Uwynynms5Dd-WyRxGOdpnGyueR5G2hPViyq-mw6Xyyzzdt3PhvHiWbRM8um2UyziA1HP2a6r0cTnQRV5rOJzkbT2XaZ1frpZpFMH0fJmvnsSzxbPs7TaDvOYDHa_FkJBLt78Vm8zPIV0mx0r1nEX_zyU3ydzjKd6CQI90fYvR95NzxvJoqidnfYKFxYmCz8fvvc6f7lWfvnoIAx3r8yWfh2mmbT-TgLxMHmb_jBAnnmx9p7GKUPJ67PhwjPGyJ0OkStcIj8Pst5nEx0oid7d9repXBMibrKR6hfagTUVD5Cw2IE_6wpv43Sh4HOeotAHTQ1XC909E7Cz50O89lM_5Nd3fDrT8n0_mH7F_NZb5ltjn3htpomJ2wQJ5lOAnXU2s_FflVL9Haqkv_vemKKblyJF0FYPSz59Pr7gHIDx0wZC0QlkCUhB3O8QVZzDblJAY4bkGc1wEEFxpSDhXNF-QUpLz1E7YKUc3eOoq6KKHc4AmqqiHKzEawp5x9EOThhr5QftVaaclFeEmEMiawEqiSlYI43SOquKTUogDtuQJ7VAAcVGFMKFs4VExektPQQ9QtSKtw5hroqotThCKipIkrNRrCmVHwQpeCEvVJ61FppSmV5SaQxJKoShCUpBXO8QdJwTalBAdxxA_KsBjiowJhSsHCumLwgpaWHaFyQUunOMdRVEaUOR0BNFVFqNoI1pfKDKAUn7JXSo9ZKU6rKS6KMIQkrJSEFU7wx0nQNqcH2udP9y7P2z0EBxoyChXPB1AUZLT1E84KMKneGoa6KGHU4AmqqiFGzEawZVR_EKDhhr4wetXbWc9oTC_R1uojnqS71CLa6KU1P7vXuHyGNl8lYf0_i8XaZ3cveNrd9Y6LTbPcp371oz3cfbQZ8H-ZkOKTDggxLOizJsKLD6jDM34dre2FuFuZ1m7SwSkurtALpkExbhXnDJi2s0tIqrUC6Rh5TEK4bhMVhuEGGm_QXpEmjUKXn5rQpIUKFVoULEKdd4TUQp2XhgBZ-9CXbjwMTOX3cAE0gjWwCcYQTiCOdQBzxxI--aiY-gTQCCsSRUCCOiAJxZBSnneFNEKelOYgfOcVpa0QV_IgAv18AVYK2RgBrBG2NANYI2hoBrBG0NQL9_rKyBqSRNSCOrAFxZA2II2uElTUgjawBcWQNiCNrQBxZI2hrBLBG0NYIYI2grZHAGmlnjaStkcAaCf6_BKyRtDUSWCNpaySwRlpZA9LIGhBH1oA4sgbEkTXSyhqQRtaAOLIGxJE1II6skbQ1ElgjaWsksEbS1ihgjbKzRtHWKGCNoq1RwBoFns6gxzO0NQpYo6ysAWn4fMfOGhCHT3jsrFFW1oA0sgbEkTUgjqwBcWSNoq1RwBpFW6OANYq2JgTWhIbW3L389F8AAAD__xNVcmU=

# INTERSECT ALL and INTERSECT with some overlap.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • intersect all
    │
    ├── • filter
    │   │ filter: x < 3
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 1
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1v4kYYhe_7K0bvVaIamZkxX5ZWYrvLapEobAGprVouvDBNkAh2bSPBRvnvlaGB2CZzPIY4d-Hj8bwc5jlj8kjRvytyqffHt8HH_pDdfO5PppPfBrfsZtIb9D5N2Y59GY9-ZdvdD_b71964x7bs7029LudM3rL-cNobT5K3fRwMIKI-MH7LRuPPvTH75U-2I4vW_kINvQcVkfsXcbJIkEWSLHLIogbNLApCf66iyA-Ttzzugf5iS27douU62MTJ0zOL5n6oyH2keBmvFLk09b6v1Fh5CxXadbJooWJvudovs9396Abh8sELkwk--avNwzpy2dbaTzQJvORRzRY0e7LI38SnRaLYu1Pk8ier-CBflqtYhSq0G-kpDs-7rMtP4biu2x9O22TRaBO7rJsd4XTV7zt270X36Ut2Oc2eTmMKkzFf5sWvHZgsFRgHic2ZvG5gzqtjnq6zWfvhQoVqkbrSLCHRW8581q9edD9R8SiwRSbz6S5Qbtovsmil_olvuvz2Q7i8u9__dfzo_NX0GybpT_wwVqEtGtmkfn71-s0CsZ1L5P-Lnhli6Nf8wJb1bMZnl2-llucG27zELrdFzZYFiwGMctznzfctBpPErh-ZLBUZB5m9cTXwaquBV1QNIP3namiWrQZRfKeJMhtN1mynoJtglONGa72vmwaJ8etHJktFxkFmb-ymqNZNUZGbIP1nN1tl3ZTFd5oss9Gcmt0o6CYY5bjR2u_rpkFi_PqRyVKRcZDZG7spq3VTVuQmSP_ZzXZZN53iO80ps9EatYJmgkGO26zzvmYa5MWvHZgsFRgHib2xl061XjoVeQnSf_ayc42fumeuP1ZR4K8jVehXbD3JTC3u1OE7iPxNOFffQn--X-bwcLTn9k8sVBQfXuWHB_314aVkwJcwz8L8JeykYGEGc34R3bqEFvIiuqOnhTZxqU9cGiTOzeBM4qZ06xI6k7gp3dHTjjbxhj7xhhZu6ldu6r9roFdLS7f1cPsSN_UwchPQwE09jdwENHCzo2_DOqjDXJma2AlopCfCgZ8AR4IiHBjKc5WaDl6A4PWdCiTluXZJL-6AxXP1YnQK6ml4DAIcnYN6HB6EAAe2cX238iYIPteuRrrpaagbwJFuehzqBnCkm_5k4eBo4bmSNdJNX7IClKwwKdn8zZdRyRrjQDeAI90Qjm489SUrQMmKXMma6AZopBvCgW4AR7ohHOgm9AeMAAeM0N-_At2EvmQFKFlhUrL5LWdUssY40s2oZI1xpJu-ZAUoWWFyA5__1o3u4I1xpJvRPbwxjnTTHzASHDBS_y-RrG6zp5_-CwAA__91qAQW

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • intersect
    │
    ├── • filter
    │   │ filter: x < 3
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 1
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy82FuP2kYcBfD3forRPGVVIzMXs2ApEmmWKEgUUkBqq3YfCEx3kVhMbSNBVvvdK6CLl4v_x_bY-xYuB5-cDD8RP_Po3wX3eeePb71P3T77cNcdjUe_9W7Yh1Gn1_k8Zlv2ZTj4lW22P9jvXzvDDtuwv9f1upoydcO6_XFnONq9Db3dfGTihg2Gd50h--VPtuUOXwYz0588mYj7f3HBHS65wxV3uOYO9_i9w1dhMDVRFIS7tzzvA93Zhvt1h8-Xq3W8e_re4dMgNNx_5vE8Xhju8_Hk-8IMzWRmQrfOHT4z8WS-2F9ms_3RXoXzp0m4a_A5WKyflpHPNs6-0Wg12T2quZLfvzg8WMfJRaJ48mC4L16c7EW-zBexCU3oeqctDs_7rC2ScXzf7_bHTe7wwTr2WTu9gsxT4e0WouwxVKExBFhjylT2MXSeCnfzKJ4vp7Erz5Zoi7MLJJnvW_Y4iR6vvD8p4RUr4ZVaopFaIvmc9TIIZyY0s5NP2n9Kak2Ftkoq3FZVAS2VVGhaVHAKtfw6iR5HJh6sXH221Hi7Mv4bIz_1etzhC_NP_KEtbj6G84fH_Z-Oxzz9r9XKc8JGQRib0NUXq_2czlo9w27XJvn_U6-06Ae1YOV69fORr1__1FWRA7UCprmy5qqMxIMqR9Ua1RGfZ43y51CF5hBgDwvkQYXEV1Eh8plLNCpEXpQnLNoqDfkSK6Cl0pDPV8EaefFOyIMT9or8xWqZkZfZWZFFVFE1V2dEFlQ5qnJbHbI51hDlz6EKzSHAHhbIggqJb7JCZDOXuK0QWVmecGirNGRLrICWSkM2XwVrZOU7IQtO2CuyF6tlRlZlZ0UVUUXXXC8jsqDKUZVmdcjmWEOUP4cqNIcAe1ggCyokvqkKkc1colkhsqo84dBWaciWWAEtlYZsvgrWyKp3QhacsFdkL1bLjKzOzoouoopXy0gsKHI0pVUdsTm2EGWPoQqNIcAaFsCCColtukJgM5doVQisLk83tFUasCVWQEulAZuvgjWw-p2ABSfsFdiL1QrdD75ygaGJVsEyMplu9dZ3o5nZgzn8I0TBOpyab2Ew3V_m8HCwz-2fmJkoPrwqDg-6y8NLu4Jvw4IMe3RYkmFFhxUZ1nRYn4fF23DjJCzyhcWtTVpapZVVWoO0R6atwqJpk5ZWaWWV1iDdII8pCN_mCMvzcJMMt-gvSItGoU73FrQpHkKFVkVIEKddEQ0Qp2URgBZx8SU7jQMTBX3cAE0gjWwCcYQTiCOdQBzxJC6-anl8AmkEFIgjoUAcEQXiyChBOyNaIE5Lcxa_cErQ1sg6-BEBfr8AqiRtjQTWSNoaCayRtDUSWCNpayT6_WVlDUgja0AcWQPiyBoQR9ZIK2tAGlkD4sgaEEfWgDiyRtLWSGCNpK2RwBpJW6OANcrOGkVbo4A1Cvx_CVijaGsUsEbR1ihgjbKyBqSRNSCOrAFxZA2II2uUlTUgjawBcWQNiCNrQBxZo2hrFLBG0dYoYI2irdHAGm1njaat0cAaTVujgTUa3J1Bt2doazSwRltZA9Lw_o6dNSAO7_DYWaOtrAFpZA2II2tAHFkD4sgaTVujgTWatkYDazRtjQes8XJac__y038BAAD__5nQkqI=

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6Jz1UpGwUmgJdIkqo5pSAw64GLSlIuUeAUpjbM4kUgr_vuU0C8-5hPHkF0a_ODXPo_E-wziTwguDH7ejW6GY-Piy3A2n_0YXRqzwWhwOzfWxMiNr9PJd2OdPxnD8XwwnRWf34xGr1tyYqzftgCBiAds7D8yAe4voEDAAgI2EHCAQAc8AnHCF0wInhRbnktgGKzBbRNYRXGWFh97BBY8YeA-Q7pKQwYuzP37kE2ZH7DEbAOBgKX-KiyPWedP_ThZPfpJDgRueZg9RsIt0wOBWewXq5ZZJJlkqWv0LdKn4G0I8Cx9OfH9oPvcWPpiuXtEn5K-Bd7GIyBS_4GBSzekXvhOzfCaea1_5n3_qSziScASFuz8mFeQ2JYjl_7mi-WMpZPYpHsDm-cxc3d9AgIh-51elMEvPyerh-Xr4m1sL3f6-Azv97M17nck_Ji3eGzSzv5LHD3b2TmbVneB1nDBtFqmfUaVFeJ3a8c_qcy0WZlp0zJb1Sdi1ZmI3TKdMwqlEP-qdvyTCmU1K5TVtFB29YnYdSbitMp_uXMJpRD_unb8kwplNyuU3bRQTvWJOHUm0mmdUSeF8L2a4U8qk9OsTM7_7G5Hok2ZiHkkWKVm1i4ux4IHtn0swbNkwe4SviiP2S4nJVfWiICJdPuttV0Mo_KrcgDV4a4O3NOBqVZu2pHTVOHJqBrc1YF7OjDVyr33ZAe0tU-3P9K2HLalMN19s_Y-7egILocRweUwIrgcxgRHaETwjo7gchgRXA4jgsthTHCERgTv6gh-paOoHEYUlcOIonIYUxShEUWvdRSVw4iichhRVA5jiiI0omhPR1Gq1RMQGpEUoRFLERrTFMOxrqBXFvTagl5d0OwLeoWBajUGelAZlGyV05itchqzVU6jtiI4ZqtKWTp8dZW2pEpjtir1JWUcs_WgPEht9Taf_gYAAP__zcKoGQ==

query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• intersect
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1v4kYUhu_7K6xztSsNIjNjPmKpEqvdVEWiyTZwUanKhRemCRLB1DYSbJT_XmHadWLH553xR3oJzoPfOfH7MMMTJX9vKKCrP77OPk2vvQ9fpvPF_PfZR29-Nbv6vPAOwjt6v9ze_OYdjt-96fXi6nZ-ev_fy0fhHX5cJkHbaGWuw0eTUPAnSRKkSJAmQT4JGtCdoF0cLU2SRPHpT54yYLo6UHAhaL3d7dPT23eCllFsKHiidJ1uDAW0CL9tzK0JVybuX5CglUnD9Sa7zeH4fbKL149hfCRBn6PN_nGbBFlyEjTfhadXvf4pyc0-DbyJEhNJd8-Con2a3zFJw3tDgXwW9VINaqaqCqJcgnxZJ-l6u0z7sjCciRST4j1y7NvRewiTh7eRPIquF2XQQRS_Mkr-UfttFK9MbFavPiz7lMqwymJueYpBVyksRpanGDZIIWoF_TVMHuYmvdn1dWFei-POBC_88Gk2I0Eb81f6IVvEx5_j9f3Dfy9-VJFd36jdKV9HvWjX14PiJN689_jVvaW9BmQNDfRVr6_r6Mkh17B2LjtBgSi5FWTngrKOMuxcULI9NVjMrUpQLaawGFmVoNxSNBaUfG9BKfsyqjpl1L2-X0cSDrlGtXPZSQJEyZupOpeEdZRR55JQ7dXTYm5VkmgxhcXIqiThlqKxJNR7S0Lbl1HXKaPfyw4izpJwyDWunctOEiBK3kzduSSso4w7l4Rur54Wc6uSRIspLEZWJQm3FI0lod9bEr59Gf06ZRz06ijCIdVlzVR2ggBB8lb6nQvCOspl54Lw26umxdyqBNFiCouRVQnCLUVjQfj_528hb0S7Ncku2ibG6peOi9PizOrenIeVRPt4ab7G0TK7zfnlTcZlb6xMkp6v6vOL6fZ86RTwJSxZWPGwKsLyJey_gqUbLFUj-rIJrYZNaK15WrP0oAksG91aXTSiR01oDR4Wn31Mwf9r4ACrIjxkYbDoEV_NIV-vMUtLydOXPH0BvFCyiku3AY3KjXDQboCjegMc9VuWlOpScECjhgMcVRzh4HEHOCq5LIn19SOL8JJiOLxUdMk7Bi2dl4wcg7rxmpEjgJdE49RWnoZtBThqK4_DtvI4bGtJsk5t5WnYVh6HbQU4emR5HLaV_4JREmyi-G1rAS-1VfEbV7B0xZtGDcC-lzeN8gFeMo3Tvpmn4cYZ4GjnzONw68zjqK2qZFmXtgIatRXgqK0IR48sj6O2Kv4LRo0Bzu9kC3i5rfxWFi2dN40Gp1QNDshgH635TQ2YO6BRWxEO2gpw1FaAw5Muf1BGR11wxG92c3jYBTg67YLfCNBTw3_BaDQ6fitbwEtt1fxetrj0u-ef_gkAAP__-GNFtg==

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9vokoUx9_vX0HOU80dAzOAP0hu0t7Wm2viald82M3GByqz1cQKC5iITf_3DVjjIjKHAeVN63xmDnM-3x7eIfy1BgsG355HD8Oxcvc0tGf211FLubMHo8HjTNkp_00nX5RdvFcm06fBVPn3uxK3lOF4NpjayYKH0Ui4eN86fd4BgY3n8rHzxkOwfgAFAgwI6EDAAAImzAn4gbfgYegFyZL3FBi6O7A0AquNv42SP88JLLyAg_UO0Spac7Bg5rys-ZQ7Lg9UDQi4PHJW6_SYXby_94PVmxPEQODRW2_fNqGl7IiyBwK27yTf2mpSyWQbWco9hfkHAW8bfR53OuUlVpZOuMzun66fEwgj55WDRT9ItbLNsmXHtyibFZZ92me78QKXB9zN7DRPSGzJhWf_3wmXNo8mvkrPOjaLfW5lLQMCa_4zurunrX-C1esy_VT46KfH0mW6YXtBxAOVmuc39Xfh_kaJa7t0I5-bXihi7LU9X2Xa-R1fPN7MHE_Ly0YrZERlbVW_SUokCu9USMk1C2eFhTeQE9pQTpB-HHPSqZoTVr7frIqoels1biKqROHdKqJesXBWWHgDorKGREX6cRS1W1VUvXy_9SqiGu107F9fVInCe1VEvWLhrLDwBkTVGxIV6cdR1F5VUY3y_TaqiGq2b6KpRNn9KpperWxWWHYDkhoNSYp04yhp_xqvxxf2n_LQ9zYhL_XmqyV3xt1XfuhB6G2DBX8OvEV6zOHrJOXS1xmXh9HhV3b4MtykP6V9LQ9368CU1qLNWnRfTFOJO6NycLcOfHZnsrRZi-6LaXZOa3_SegbWzmFdCBvikw0hzKj4aLNOPsQwkg8xjOUDoZF8IDSSj06dfIhhJB9iGMsHQiP5QGgkH12hpT2xpL06-ejXMVwMI4aLYcxwhEYMR2hsAsiMzfx_Upm5KUujQ0BqckrjiOY0N0UyqlImFp2KxwhiOs3NERnVERpxHaEx2TEcsR3DMd1zM1RKdzGN6S6mUd0RHNMdwTHdc4M0q3sH0T03U6R0z80UKd3FNKa7mEZ1R3BMdwTHdM_NUyndxTSmu5hGdUdwTHcEx3TPTdXsu7Ym1p3lZotQ9_nHX78DAAD__1D8rmA=

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYUhvf9FdZZJaoRzIz5lCrl9oaqSDTcAotWVRZcmCZIBFPbSJAo_70CbuSEweed8Ud2IfHjeX2Y99E4LxT_t6Ie9f_6NvwyuPOubgeT6eTP4bV3NekP-1-n3s77bTz6w9vtn73R-LY_9n7929tfe4O7aX88OVzAXfh8nf68I5_W4ULfzZ50TL1_SJBPknxS5FNAPjXp3qdNFM51HIfR4ZKXIzBY7KjX8Gm53myTw6_vfZqHkabeCyXLZKWpR9PZ95Ue69lCR_UG-bTQyWy5Oi6z2z_fbKLl0yzak09fw9X2aR33vJ3vPZNPk83s8KlWPyQZbZOedyPo_tWncJuky8XJ7EFTT7z6-SI1bSPtXSNJl0i3yzhZrudJXZzNyFggZb7vvcdZ_Hjh-jSEyheiWWqIIDNEep_tOowWOtKLD3c63iUzpkSzSiM0q4qAJpVGaBWI4OdK-fssfpzoZLSpq7NJTfcb3Xtnii_DIfm00v8mVzfi-pdo-fB4_Mlim7dddtgkjBId1ZUxtZ8z79-xGNulify46YUQd2Et3NSDxvmMLy7f_bC8sBeLyOG6uqzVlbPtHEK1ctjONpR0CZWqRlToO-sQrQp9J8qTDZpVlu9KjIAmleU7twiFfSc-yXdgh735zpiare-kfbdlHuGoWj1wFo5DqHYe4ViGki6h0q7LCoVjHaJdoXBkeW1Hs8oSTokR0KSyhOMWobBw5CcJB-ywN-EYU7MVjrLvtsojnKB2fOVyE45DqE4e4ViGki6h0q6rCoVjHaJToXBUeW1Hs8oSTokR0KSyhOMWobBw1CcJB-ywN-EYU7MVTmDf7SCPcJo1Z904ROrm0Y1VJOkSKe15UKFsrEN0K5RNUF7T0ayyZFNiBDSpLNm4RSgsm-CTZAN22JtsjKnl-ffRhfuPdbwJ17G2-s9Q4zAzvXjQp-8gDrfRXH-LwvlxmdPH0ZE7_mKh4-T0V3X6MFif_nQI-B4WLCx5WJ7D4j0cfICFGyxUEVqKQnS3CK3aPK1YulkEFmDkPC1lEVo1CtEdng7Ybdri4aYDLM_hFgu3-YK0WRg8c4eFA8Ev3WVpAZoteKkIsLgwtOJiBkAjNQAcuQHhQA4AR3YQvFyAHgCN_ABwJAiAI0MgHNRFGIb5uGXR6HjFnOGGJgQvGdECheE1gx6d94xsgMV504guwA3VOJWdp2HZeRyWHeCo7DyOyi4Ny7qUHdCo7ABHZQc4KjvCwY6X4NyKTo-GajjcKLvkVSMDcGzmVYMenTeN7IDFedNIcKKRhmqczvw8DQ_9PA5P_QBHx34eh2U3LOtUdp6GZedxWHYeh2UHONrx_FlWga9dgRdkwZdd8apR4CSteNWAR1e8aRQ4VijeNKoJcEM1LmUHNCo7wFHZEQ7KDnD4km9Y1uktn6fhaz6Pw_d8Hocv-gBHO54_yyr0vfFn2TPcLDuvmgCcpANeNeePfv_60_8BAAD__8gSPXA=

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9vokwUh-_fT0HOVc07BmcA_5Bs0m7rZk1c7YoXu9l4QWW2mlhhB0y0Tb_7BqxxEZnDgHJXdZ6ZH3Oe08MbhH9WYEP_x-PwbjDSbh4GztT5PmxoN05_2L-falvty2T8TdvuXrXx5KE_0T7_1HYNbTCa9idOvOBuOJQvJtpr4_hxCwTWvsdH7gsPwf4FFAgwIGAAARMIWDAjEAh_zsPQF_GStwQYeFuwWwSW62ATxV_PCMx9wcF-g2gZrTjYMHWfVnzCXY8LvQUEPB65y1VyzHb3ehuI5YsrdkDg3l9tXtahrW1JEhAIOIEbf9HU4zDjTWRrtxRm7wT8TfRx4vGgp522cMNF-ohk_YxAGLnPHGz6Tsoltwonv0Zslhv7uM9m7QuPC-6ldprFJLbkzLN_dcOFw6NxoNOTok13AbfTrgGBFf8d3dzSxiexfF4kf-U--vGxDJVqOL6IuNCpdXpT_-fubxa4tnM38rHpmRAjv-kHOmud3vHZ463U8bS4bLRcm-isqRtXaRSF7O0SjXLJ4Cw3eA2tQmtqFaQeh1Zpl20VVrzerKSrRlM3r-KqQvZOGVcvGJzlBq_BVVaTq0g9Dq52yrpqFK-3UdJVs5nM_8u7qpC9W8bVCwZnucFrcNWoyVWkHgdXu2VdNYvX2yzpqtW8iqkKyXtlTL1YbJYbuwZPzZo8Rapx8LR3iVflM_tPeBj465AXegtuxXfGvWe-r0Hob8ScPwp_nhyz_zhOuOS9xuNhtP-V7T8M1slPSV2Lw50qMKWVaKsS3ZPTVOHOqBrcqQKf3JkqbVWie3KandKtf2kjBbdOYUMKm_KTTSnMqPxoq0p_yGGkP-Qw1h8IjfQHQiP90a7SH3IY6Q85jPUHQiP9gdBIf3Sklnblknar9EeviuFyGDFcDmOGIzRiOEJjE0BlbGb_k6rMTVUaHQJKk1MZRzSnmSmSUpUyuehUPkYQ02lmjqiojtCI6wiNyY7hiO0YjumemaFKustpTHc5jeqO4JjuCI7pnhmkad3biO6ZmaKke2amKOkupzHd5TSqO4JjuiM4pntmnirpLqcx3eU0qjuCY7ojOKZ7Zqqm37Vbct1ZZrZIdZ-9__c3AAD__xTvsv4=

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FdasEtXIzIz5slQptzdURaLhFli0qrLwhWmCRDC1jQSJ8t8rzI2cMPg9M_7ILhAez_HLnEdjXljy35oFbPjXt_GX0Z1zdTuazWd_jq-dq9lwPPw6d_bOb9PJH87-8OxMprfDqfPr387h2hndzYfT2fED5Add5_k6f7lnLttES3UXPqmEBf8wzlwmmMskc5nPXNZh9y7bxtFCJUkUHz_ykgGj5Z4FbZetNttdenz73mWLKFYseGHpKl0rFrB5-H2tpipcqthrM5ctVRqu1tky-8PzzTZePYXxgbnsa7TePW2SwNm7WUDmstk2PL7R8o5hJrs0cG44u391WbRL8xWTNHxQLOCvbrlUHeNUtpGETaTbVZKuNovU42dj0hbIme8H5zFMHi98Pg8hy4Xo1BrCLwyRX2e3ieKlitXyw5WyqxTGFGhWeYROUxHQpPII3QoR3FIpfw-Tx5lKJ1tPnk1qftiq4J0vvozHzGVr9W96dcOvf4lXD4_ZXwbbvGezw2ZRnKrYk9rUfi68ft9gbJcm8uOiF0LcRa1o6_nt8xlfXH7wYXluLhZeTneeaHnSWngWubolhGcaStiEym3DG1SecYhug8rj9fkGzapIeTVGQJMqUp5dhMrK45-kPLDD3pSnTc1UecK826Kkc2TL862dY5GrV8Y5hqGETai87qJB5xiH6DXoHFFf4dGsipxTYwQ0qSLn2EWo7BzxSc4BO-zNOdrUTJ0jzbstSzrHb2XPXnbOscjVL-Mcw1DCJlRed9mgc4xD9Bt0jqyv8GhWRc6pMQKaVJFz7CJUdo78JOeAHfbmHG1qps7xzbvtl3ROp2VtHItUgzLGMYokbCLlVfcb9I1xiEGDvvHrKzuaVZFvaoyAJlXkG7sIlX3jf5JvwA578402tTI_JV24_lQl22iTKKNfidrHmanlgzp9B0m0ixfqWxwtsmVOLycZl72xVEl6-q88vRhtTv86BnwPcxIWNCzOYf4e9j_A3A7msgoteCV6UIWWPZqWJN2pAnMwcpoWogot25XoPk375Dbt0nDHAhbncJeEe3RBeiQM7rlPwj6nlx6QNAfN5rRUOFica1qxMQOgkRoAjtyAcCAHgCM7cFouQA-ARn4AOBIEwJEhEA7qwjXDfNyyaHS0Ys5wTROclgzvgsLQmkG3TntGtMHitGn4AOCaaqzKTtOw7DQOyw5wVHYaR2UXmmVtyg5oVHaAo7IDHJUd4WDHC3BuRadHTTUUrpVd0KoRPjg206pBt06bRvTB4rRpBDjRCE01Vmd-moaHfhqHp36Ao2M_jcOya5a1KjtNw7LTOCw7jcOyAxztePosK8HXLsEDMqfLLmnVSHCSlrRqwK1L2jQSHCskbRrZAbimGpuyAxqVHeCo7AgHZQc4fMjXLGv1lE_T8DGfxuFzPo3DB32Aox1Pn2Ul-t7os-wZrpedVo0PTtI-rZrzW79__en_AAAA__9c1UIO

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6xz1UpGwU6gJdKkdi3TkBh0wMWmiYuUeAWJ4iwOUkPV_z4lTOr4iE-MR3LXNH7i1z6PxPsK6vcSfOh-f-jf9gbk4r43noy_9S_Jxbjb795NSEo-j4ZfyUu6IcPRfXdEPv0gm0vSG0y6o3G24LbfRxYDhZUMxSB4Fgr8n8CAAgcKLlDwgEILphSiWM6EUjLOlrzmQC98Ab9JYbGK1kn27ymFmYwF-K-QLJKlAB8mweNSjEQQithpAoVQJMFimW_zkm5uonjxHMQpULiTy_XzSvkkpWQDFMZRkD01nCzJcJ345IbB9I2CXCd_t3vf5TEl80DNd7-fr59SUEnwJMBnb_S02K1aY_PC2O_fWa9kHIpYhDtfmmYktuTI2b8Eaj4WyTBy2N7EJmkk_F21gMJS_Eoubtjlx3jxNM__Kjz6-7Fci2MdyTyQDRk5rLV_AUf39nb2ZuVNYCeY4PCG455FYYPg7ZqD88LgFUjMKpKYl58HP2UebsPxziKSQfCrmoPzwuAViMQrEsktPw_3lHl4jfw37f-LZBD8uubgvDB4BSK5FYnklZ-Hd8o8Wo2zaGQQu1NrbF4YuwKJvBq62ZFEI6EiuVKiVPNqZmcS4ZPY3pGS63gmHmI5y7fZPg5zLm8JoVDJ9i3fPvRW-av83svDbRu4YwMzq9yspaeZwZUxM7htA3dsYGaVe-_KDmi-Tzf_pV097GphtntnzX3asxFcDyOC62FEcD2MCY7QiOAtG8H1MCK4HkYE18OY4AiNCN62EfzKRlE9jCiqhxFF9TCmKEIjil7bKKqHEUX1MKKoHsYURWhE0Y6NosyqJyA0IilCI5YiNKYphmNdwa4s2LUFu7pg2RfsCgOzagzsoDIY2aqnMVv1NGarnkZtRXDMVpOydHjrJm3JlMZsNepLxjhm60F50No6ffvwJwAA___gfqbk

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6xz1UpGwU6gJdKkdi3TkBh0wMWmiYuUeAWJ4iwOUkPV_z4lTOr4iE-MR3LXNH7i1z6PxPsK6vcSfOh-f-jf9gbk4r43noy_9S_Jxbjb795NSEo-j4ZfyUu6IcPRfXdEPv0gm0vSG0y6o3G24LbfRxYDhZUMxSB4Fgr8n8CAAgcKLlDwgEILphSiWM6EUjLOlrzmQC98Ab9JYbGK1kn27ymFmYwF-K-QLJKlAB8mweNSjEQQithpAoVQJMFimW_zkm5uonjxHMQpULiTy_XzSvkkpWQDFMZRkD01nCzJcJ345IbB9I2CXCd_t3vf5TEl80DNd7-fr59SUEnwJMBnb_S02K1aY_PC2O_fWa9kHIpYhDtfmmYktuTI2b8Eaj4WyTBy2N7EJmkk_F21gMJS_Eoubtjlx3jxNM__Kjz6-7Fci2MdyTyQDRk5rLV_AUf39nb2ZuVNYCeY4PCG455FYYPg7ZqD88LgFUjMKpKYl58HP2UebsPxziKSQfCrmoPzwuAViMQrEsktPw_3lHl4jfw37f-LZBD8uubgvDB4BSK5FYnklZ-Hd8o8Wo2zaGQQu1NrbF4YuwKJvBq62ZFEI6EiuVKiVPNqZmcS4ZPY3pGS63gmHmI5y7fZPg5zLm8JoVDJ9i3fPvRW-av83svDbRu4YwMzq9yspaeZwZUxM7htA3dsYGaVe-_KDmi-Tzf_pV097GphtntnzX3asxFcDyOC62FEcD2MCY7QiOAtG8H1MCK4HkYE18OY4AiNCN62EfzKRlE9jCiqhxFF9TCmKEIjil7bKKqHEUX1MKKoHsYURWhE0Y6NosyqJyA0IilCI5YiNKYphmNdwa4s2LUFu7pg2RfsCgOzagzsoDIY2aqnMVv1NGarnkZtRXDMVpOydHjrJm3JlMZsNepLxjhm60F50No6ffvwJwAA___gfqbk

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdF3Asko2EloiTSJqmMaEoMOOEyaOKTEK0gUZ3GQSKv-9ylhVUcAfzFGydFJnvj15-fwvoL8swYf-j8fhneDkdX4MpjOpj-GTWvaH_bvZ9bO-joZf7cajfc1sdL9o1360rQGo1l_Ms1e3A2H1umPmkBgI0I-Cp65BP8XUCDAgIADBFwg4MGcQBSLBZdSxNknrzkwCHfgtwmsNtE2yR7PCSxEzMF_hWSVrDn4MAse13zCg5DHdhsIhDwJVut8m1360ovi1XMQp0DgXqy3zxvp5-GAwDQKslXLZjB_IyC2yb9NPv79mFrLQC4P_9qjpJchcwIyCZ44-PSNXJbXqycvO5v341fbjYhDHvPw4GfzjMQ-OXHob4FcTnkyjmxauKNZGnH_0CIgsOa_k0YevPk5Xj0t3xdAYLxNfKtHCzP4OJxjcLgTyUeiJSKbesUxnNzbPdiblheBXiCCzVq2c111NRJ36krMziauQF5aqbys_HWwS67DadnudQXSSHxTV2J2NnEFArFKBXLKX4dzyXW4Ldu7rkAaiW_rSszOJq5AIKdSgdzy1-Fech1e67r6aOTt1pOXnc1bgTxubd3rRK4Jl5HYSF6qWbWzk_Hwie8nJcU2XvCHWCzybfbLcc7lnSDkMtm_ZfvFYJO_yqdfHu6YwF0TmBrlpp6aphojo3pwxwTumsDUKHdhZEc0K9Lt_2lHDTtKmB7OrF2kXRPB1TAiuBpGBFfDmOAIjQjumQiuhhHB1TAiuBrGBEdoRPCOieA3JoqqYURRNYwoqoYxRREaUfTWRFE1jCiqhhFF1TCmKEIjinZNFKVGPQGhEUkRGrEUoTFNMRzrCmZlwawtmNUFw75gVhioUWOgR5VBy1Y1jdmqpjFb1TRqK4JjtuqUpeOp67QlXRqzVasvaeOYrUflQWnr_O3T3wAAAP__p0aabQ==

query T
EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))
----
distribution: full
vectorized: true
·
• intersect
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7lEiDzMzYQCxVymo3VZFosg08VKry4IVpgkQwtY0UNsp_rwBFTuz4nhlsp49j83nOXOYc3_EzZf-uKKKrv75PvoyvvbNv4-ls-ufk3JteTa6-zrwn77fbmz-8s7PXsfB2x0tPu5_n3vh6dnU73d_4-AfnJGidLMx1_Ggyiv4mSYIUCdIkKCBBId0J2qTJ3GRZku5_8nwAxosnivqCluvNNt9fvhM0T1JD0TPly3xlKKJZ_GNlbk28MKnfJ0ELk8fL1WGap93Py026fIzTHQn6mqy2j-ssOogjQdNNvB_1fEV3L4KSbV5MkuXxvaFIvojThIQtC1EuQr4ts3y5nue-LNXjUorL8hwF9mPnPcTZw8dIIUWfJiXsQEpQK6V41HadpAuTmsW7hx2eUitWWdStUBF2pcKiZIWKQQMV4iShv8fZw9TkNxtfl-o1221M9CYVvkwmJGhl_snPDos4_zVd3j-8DkjQzTaPvEtZu7hhuyW-TnrJxtdhuQwfzj16N7e0zwB5Qgb4qudryzhykDJoXYpykVKkgOw8kKylDDoPJNleFFjUrS6QWlRhUbK6QHJT0TiQ5KcGkrJ3ojrFibrnB5ah4CBl2LoU5SKlcKLqPBSspQw7DwXVnh0t6lYXCi2qsChZXSi4qWgcCupTQ0HbO1Gf4sSg54eWoeAgZdS6FOUipXCi7jwUrKWMOg8F3Z4dLepWFwotqrAoWV0ouKloHAr6U0MhsHdicIoTw55lJDgIuWhZiHIRUrgw6DwQrKVcdB4IQXtWtKhbXSC0qMKiZHWB4KaicSAE_9u3jA903Zpsk6wzY_Wlor9fmVncm2OlsmSbzs33NJkfpjkObw7c4cLCZPnxrj4Oxuvjrb3At7BkYcXDqgzLt3DwDpZusFSN6IsmtBo0obXmac3SYRNYNppa9RvRwya0BpslYLcp-L9CB1iV4QELg0UPeWsOeHuNWFpKnr7g6T7IhUqquHgb0MjcCAfuBjiyN8CRv2UlUl0MDmjkcIAjiyMcbHeAI5PLSrC-37IIr0QMh1eMLvmMQUvnQ0aOgN34mJFDgFeCxsmtPA3dCnDkVh6HbuVx6NZKyDq5laehW3kcuhXgaMvyOHQr_4JREjRRfNtawituVXzjCpau-KRRIeh7-aRRAcArSePUN_M0bJwBjjpnHoetM48jt6pKyrq4FdDIrQBHbkU42rI8jtyq-BeMGgGc72RLeNWtfCuLls4njQanVA0OyKCP1nxTA-oOaORWhAO3Ahy5FeDwpMsflNFRFxzxm00OD7sAR6dd8I0A7Rr-BaNR6fhWtoRX3Kr5Xra89LuXX_4LAAD__-qYOAo=

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • except all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9vmlAUx9_3V5Dz1GbX4L2AP0iWtGtdZuJqJz50WXigcldNrDDARNv4vy9gXYvoPRwxvEnhc--Xcz-nh1eI_87Bht7D_eC6f6dd3PadsfNzcKldOL1B72asrbVvo-EPbbV-udR6Dze9-7F2PRj8v73Srp3cM8PRbW-kff2lrYHBIvDlnfcsY7B_AwcGAhgYwMAEBha4DMIomMg4DqL0kdcM6PsrsJsMZotwmaR_dhlMgkiC_QrJLJlLsGHsPc7lSHq-jPQmMPBl4s3m2Tar9ctVGM2evShNcBPMl8-L2M7iOKGX_mzoAtwNg2CZvO3wvvDjWpt68TS_5BUHd-MyiBPvSYLNN-y0pFappKvzJRVHk76vs1wEkS8j6edWclMSe-TA63734qkjk2Go871zGa9DaX9QCBjM5Z_k4opffolmT9PsFzAYLhNby97j43u_v5NBqb4TRImMdG7tl-nz0fXNEjU7VI63RQ-EuAsaQaiL5n6BD25v5bbn5eXi1DbQRUM3ztgIhKwtaiNUzyqOZq2hFXgdrYDUf9cKrVNbQZQ_X0F20Wjo5hldJGRtk12snFUczVqDi6IOF5H671xsn-qiUf58DbKLZkO3zugiIWuH7GLlrOJo1hpcNOpwEan_zsXOqS6a5c_XJLtoNc5oIiFpl2xixaTiaNIaPDTr8BCp_s7D7jk-VQ-sP5JxGCxiWeortJkWTPpPcnsAcbCMJvI-CibZNtvLYcZl3x2-jJPtXbG96C-2t9KA5eF2FZjzSrRVie6qaU6omaDB7SrwXs2otFWJ7qppsU83P9JGDm7uw4YSNtWnZSphwdVbW1X6Qw0j_aGGsf5AaKQ_EBrpj1aV_lDDSH-oYaw_EBrpD4RG-qOttLSjlrRTpT-6VQxXw4jhahgzHKERwxEamwCUsVn8T0qZm1QaHQKkyUnGEc15YYrkVOVCLTpXjxHEdF6YIxTVERpxHaEx2TEcsR3DMd0LM5Sku5rGdFfTqO4IjumO4JjuhUGa172F6F6YKSTdCzOFpLuaxnRX06juCI7pjuCY7oV5StJdTWO6q2lUdwTHdEdwTPfCVM1_azfVuovCbFHq7m4-_QsAAP__uVOELg==

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • except
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v6jYYxu_3KSJftVpQsJ3wJ9Kkdi3TKnWlAy7ONPUiB7wWiRKWBAlO1e8-AePkEJP3sZukd23TX_zkxc9PDm8s_XfBQjb48nh_fffgXNzejSfjP-8vnYvx4H5wM3G2zm-j4R_OZvvt0hl8uRk8Tr5f2jjX45Prw9HtYOT8-pezZS5bxjP1EL2qlIV_M85cJpjLJHOZz1wWsCeXrZJ4qtI0Tnb_8rYH7mYbFrZdNl-u1tnuz08um8aJYuEby-bZQrGQTaKvCzVS0UwlXpu5bKayaL7YL7PZfrtaJfPXKNkluIkX69dlGu7jjFfR7seWJ9jTu8vidZavkGbRs2Ihf3c_liIwSrExSyFsUtzO02y-nGYeL0ziihcWyJmvW-clSl_O_H8eQn4sRFBrCL80RH6f9TJOZipRs5M77e9SGlOgWeURgqYioEnlEToVIrgfSvl7lL6MVTZcebIwqcl2pcKjBq7v75nLFuqf7OKKX_6SzJ9f9j8xlw3XWegQz9S12V7jOMlU4kltZD-X3r9nMLNz4_j_pmdCPMSteOX57eKAzy7fP1mem4uE2-rMEy1PGgrNIkfHVmh0DmGTI7cJb1BpxiE6DSqN1-cTNKsypdUYAU2qTGl2ESorjX-G0sD2OipNG5mp0oR5l4W1U2TL8w2dYpGja-0UMoewyZHXWTToFOMQ3QadIuorNJpVmVNqjIAmVeYUuwiVnSI-wylgex2doo3M1CnSvMvS2il-ywsMnWKRo2ftFDKHsMmR11k26BTjEL0GnSLrKzSaVZlTaoyAJlXmFLsIlZ0iP8MpYHsdnaKNzNQpvnmXfWunBC1Do1ik6FsbhUghbFLkVfYb9IlxiH6DPvHrKzOaVZlPaoyAJlXmE7sIlX3if4ZPwPY6-kQb2Ue-yjlz_5FKV_EyVUbf0rR3A1OzZ3X4ANJ4nUzVYxJP98scfh3uuf0fZirNDlfF4Ze75eHSLuCPMCdhScOiCPMfYf8E5nYwl1VowSvR_Sq07NK0JOmgCszByGlaiCq0bFeiezTtk9u0Q8OBBSyKcIeEu3RBuiQMnrlHwj6nl-6TNAc0p6XCkVU0rdiYAdBIDQBHbkA4kAPAkR04LRegB0AjPwAcCQLgyBAIB3XhmmFOtywaHa2YAq5pgtOS4R1QGFoz6NFpz_A-WJw2jWgDXFONVdlpGpadxmHZAY7KTuOo7EKzrE3ZAY3KDnBUdoCjsiMc7HhBn1sFOj1qqqFwreyCVo3wwbGZVg16dNo0AhxJBG0a0QO4phqrMz9Nw0M_jcNTP8DRsZ_GYdk1y1qVnaZh2Wkclp3GYdkBjnY8fZaV4GOX9Fm2gGtll-AVGRyFJa0a8OiSNo0MwOK0aSQ4lUhNNTZlBzQqO8BR2REOyg5w-JKvWdbqLZ-m4Ws-jcP3fBqHL_oARzuePstK9LnRZ9kCrpedVo0PjsI-rZrioz-9__RfAAAA___2XBM-

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)
----
distribution: full
vectorized: true
·
• except all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8S5akHBkWynjWHQrs1YIGu6JBcdwxdurDWBNPIsB-qW_PdhZ9DmS8eagu7i2o_06uiBvm-g_iwggt7D_eC6f0fObvvjyfjH4JycjXuD3s2ElOTraPidvJSvZDi67Y3Il5-kPCe9h5ve_YRcDwbIl0BhKVNxlzwLBdEvYECBAwUfKARAIYSYQpbLqVBK5tUnbzXQT18galOYL7NVUf05pjCVuYDoDYp5sRAQwSR5XIiRSFKRe22gkIoimS_qbV7K16ssnz8neQkUbuRi9bxUEakexllS_Wx5HOI1Bbkq_u3wvvBjSWaJmm0vecUgXscUVJE8CYjYmv5f0tB1Un406fs6q6XMU5GLdGuluCKxTw4c91uiZmNRDDOP7dzLpMxE9MEeoLAQv4uzK3b-OZ8_zepfQGG4KiJSn-Pjud_P5Fuc6UDgO9mSmcfC3dMf3DvY2ps1v3lmevMeb3n-CS01yNpxn5UfzerAU-bCU958_tx4_n7LC07oikHWC_dZ-dGsDlzhLlzxm8_fN55_0PLCE7pikPXSfVZ-NKsDV3wXrgTN5x8Yzz9sndAUg6Rd10n50aQOPAlc96QDcUZCZXKpRKMW1K4OJNInsRmQkqt8Ku5zOa232TwOa67-X54KVWze8s1Df7l5VQVsDnds4K4NzKxys1BPM4ORcTO4YwN3bWBmlXtnZHs036XbH2lfP29fC7PtmbV36cBGcD2MCK6HEcH1MCY4QiOChzaC62FEcD2MCK6HMcERGhG8YyP4hY2iehhRVA8jiuphTFGERhS9tFFUDyOK6mFEUT2MKYrQiKJdG0WZVU9AaERShEYsRWhMUwzHuoJdWbBrC3Z1wbIv2BUGZtUY2F5lMLJVT2O26mnMVj2N2orgmK0mZWn_zkzakimN2WrUl4xxzNa98qC1NV5_-hsAAP__RSqBOA==

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)
----
distribution: full
vectorized: true
·
• except
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYUhu_7K6xzlUhGZmZsIJYqZZtQNRINKXCxVZULL54mSAS7tpHCRvnvFaCVFzs-rye2uQsfD_POyTyHM7xR-t-afBp_fZh8ubu3Lm7v5ov5X5NL62I-noxvFtbO-n02_dN63X23prPb8cz67W9rd2mNv96MHxbgXWTTJgr1ffCiU_L_IUE2SbJJkU0u2eTRo01xEi11mkbJ_i1vB-AufCW_b9NqE2-z_dOPNi2jRJP_RtkqW2vyaRF8W-uZDkKdOH2yKdRZsFoflnndfb-Ok9VLkOzIpptovX3ZpL61fzCPg_2fPUfS47tN0TbLV0iz4EmTL97tz6Xw2kwhTVLcrtJstVlmjihU4loUFsiZbzvrOUifP3h_HkJ9LoTXagi3MkT-OdtNlIQ60eHJJx0-pTKmRLXKI3hdRUCVyiMMGkSwP5XyjyB9nutsGjuqUKnFLtb-jw7wZTIhm9b63-ziWlz-mqyeng9_kU3TbeZbzJ6G7Zb1PupFsaO84u4_XHt0sraob7kwtdyRPUfV7DYGOQbt5pAmOXLVRYf9pnaIQYf9RrQnO6pVVb9pMQKqVFW_MYvQuN-Ic_QbWd81aeya6jluTecNcgzbzSFNcuS6yQ6drx1i2KHzsj3hUK2qnG8xAqpUlfNmERo7L8_hvKrvmjJ2ze05Xk3nDXKM2s0hTXLkuqkOna8dYtSh86o94VCtqpxvMQKqVJXzZhEaO6_O4bxb3zXX2DWvV9N4gxRXbaaQJily1dwOfa8d4qpD3932ZEO1qvK9xQioUlW-m0Vo7Lt77t8RPogz02kcbVJd61eC_n5DOnzSxwKl0TZZ6ockWh6WOT6cHrjDE6FOs-Or8vjgbnN8aR_wZ1iwsOJhWYTFz7B7AgszWMhG9FUTWg6a0ErxtGJprwksGi0t-43oYRNagcPisscU_L88A1gW4QELg00PebsGvF4jlhZ9nr7iaQH6QqmrmLgNaCQ3woHdAEd6Axz5LUot1URwQCPDAY4URzg47gBHkotSYz09sggvtRgOL4ku-B6Dts43GTEEuvFtRowAXmo0RrbyNLQV4MhWHoe28ji0tdRkjWzlaWgrj0NbAY6OLI9DW_kvGCnAEAXGVsHbKvnBFWxd8p1GumDu5TuN9ABe6jRGczNPw8EZ4Ghy5nE4OvM4slWWuqyJrYBGtgIc2YpwdGR5HNkq-S8YOQI4P8kW8LKt_CiLts53GgVGWcV3GgVuyIofakDdAY1sRTiwFeDIVoDDmy5_UUZXXXDFb7Y4vOwCHN12wW8E6NTwXzAKlY4fZQt4yVbFz7LFrT--__J_AAAA__8TWRJ9

# EXCEPT ALL and EXCEPT with no overlap.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except all
    │
    ├── • filter
    │   │ filter: x < 2
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 2
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1v4kYUhu_7K6xzlahGZmbMl6WVss2yWiQaUkDqVi0XXpgmSART20iQKP-9MmxIsMm8PoaYO76emZOX85wZ8kTRfzPyqP39tvu5c2NdfOkMhoM_upfWxaDdbV8PrZX1td_73VqtH60_v7X7bWtl_bOsVtXYkpdW-_t1-3Zofe524ef1pwTo9b-0-9Zvf1krsmkeTPSN_6Aj8v4mQTZJskmRTS7ZVKORTYswGOsoCsLkI08boDNZkVe1aTpfLOPk5ZFN4yDU5D1RPI1nmjwa-j9muq_9iQ6dKtk00bE_nW22Wa0frxbh9MEP12TTdTBbPswjb1POYOEnDyuOpNGzTcEyft0hiv07TZ54tvNX8XU6i3WoQ6e2X8L2dc-6ErskPc_r3AybqX1fl_qxtu796H5_nStBo-fX2iSntrcJiZNGpApFJEBGSfecIiT33epe11nOg3CiQz3ZW2mUkOgjB_7Eb350P9Bxb-HIVM7D9UJ7bxQim2b63_jiSlx-Cqd395tHZFNvGSdBvJt4jZP4IAhjHTqylo7p13fXr-fI7FAcPxc9UMRNUAkWjqqmAz64fWNve8Hoa25bO7LiqJzugzp2jV0_g_ucjE4ckioUkgApfYz9olz7RRn2g8Rf7K8XtV_mby3J7ixVcdyc-oE6dp3VOIN-jIzEiUNShUISIKWP0U-Wq58sQz-Q-It-jaL6qfytpdid5VacWk79QB27zmqeQT9GRuLEIalCIQmQ0sfop8rVT5WhH0j8Rb9mUf3c_K3lsjurVskpH6hi11etM8jHSEicNCJVKCIBMvoY9dxy1XPLUA8k_qJe6xQ_Ow-s39fRIphHOtcvymoSmJ7c6e0XEAXLcKxvw2C82Wb7tLfhNi9MdBRv3xXbJ5359q2kwLewSMPiLezuwYIHC3EU3TiGluooumWmpTFxZU5cMRKXPDiVOJduHEOnEufSLTPtGhOvmROvGeG6-buum79roFfDSDfNcPMYN80wchPQwE0zjdwENHCzZZ6GVTAOM8OUYyegkZ4IB34CHAmKcGCoyIzU_eAlCN48U4GkIjNd9jd3weaZ8cI6Bc00PAYBjs5BMw4PQoAD24R5too6CD4zXVm6mWmoG8CRbmYc6gZwpJv5ZBHgaBGZIcvSzTxkJRiykjNks5cv1pBl40A3gCPdEI4unuYhK8GQlZkhy9EN0Eg3hAPdAI50QzjQTZoPGAkOGGm-vwLdpHnISjBkJWfIZjdnDVk2jnRjDVk2jnQzD1kJhqzkXOCzLce6wbNxpBvrDs_GkW7mA0aBA0aZ_yWS1m30_Mv_AQAA__8No95a

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except
    │
    ├── • filter
    │   │ filter: x < 2
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 2
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Ftv4kYcBfD3fgprnhLVyMzFXCytlG3CapFoSAGpW7V5YGGaIBFMbSPBRvnuFbDgcPH_eBg7bwF8PGf-O_zE-pXF_01ZwFrfHjqf2_fO1V27P-j_0bl2rvqtTut24CydL73u785y9cP582ur13KWzj-LalWOHHHttL7dth4G8Fr9aX1xt3fX6jm__eUsmctm4VjfD190zIK_GWcuE8xlkrlMMZf57NFl8ygc6TgOo_Ulr5tAe7xkQdVlk9l8kazffnTZKIw0C15ZMkmmmgVsMPw-1T09HOvIqzKXjXUynEw3yyxXP27m0eRlGK2Yy27D6eJlFgebOv35cP1nxRPs8c1l4SJJV4iT4ZNmAX9z87f4MpkmOtKR5x9W2L4fODd8P8UgCNr3g0bmusJk3fe754VuX160fQ72vz4ZaADKZOW7SZxMZqPEE0e7v-FHC6SZ7yvneRg_n7k-LeFfVsIvtEQts0R6n8UsjMY60uODO23ukllTolmlFeplVUCTSis0LCq4F7X8Ooyf-zrpzj11NKnBaq6DHYOfOx3msqn-N7m64defosnT8-Yv5rLuIlkf-sw9NU2OVz-MEh156mRkv2bjVc0xtHPz-HnXMy3uw0o49_zq8YTPr3-oJzdQzBQxT1Q8mVNx0GPPWK1gxU32X_AA5EUD4GAC5o6DlVNCeYmO5y5RK9FxXhyiaFZZjhdYAU0qy3GzCtaO849wHByvneMnI8vtuMjviDBmRFY8ldNR0GPPSL1gRw32zwsegLxoABxMwNxRsHJKmCjR0dwl6iU6KopDDM0qy9ECK6BJZTlqVsHaUfERjoLjtXP0ZGS5HZX5HZHGjKiK5-d0FPTYM9Io2FGD_fOCByAvGgAHEzB3FKycEiZLdDR3iUaJjsriEEOzynK0wApoUlmOmlWwdlR-hKPgeO0cPRlZbkdVfkeUMSN-JaeioMUekWbBihrsnhe6fXnR9jnYv7mhYOWUL1WioblLNEs0VBUHGJpVlqEFVkCTyjLUrIK1oeojDAXHa2foycguejZ7ZoGejufhLNa5HrtW1xPT4ye9_ReIw0U00g9RONoss33Z3eQ2b4x1nGw_5dsX7dn2o3XB92FOhhUdFmRY0mFJhn06rI7D_H24dhDmZmFet0kLq7S0SiuQ9sm0VZg3bNLCKi2t0gqka-QxBeG6QVgchxtkuEl_QZo0ClW6N6dN8REqtCpcgDjtCgc2cFoWDlDjJ1-yw3gNxOnjBmgCaWQTiCOcQBzpBOKIJ37yVTPxCaQRUCCOhAJxRBSII6M47QxvgjgtzVH8xClOWyOq4EcE-P0CqBK0NQJYI2hrBLBG0NYI9AOKtkYAa4SVNSCNrAFxZA2II2tAHFkjrKwBaWQNiCNrQBxZA-LIGkFbI4A1grZGAGsEbY0E1kg7ayRtjQTWSPD_JWCNpK2RwBpJWyOBNdLKGpBG1oA4sgbEkTUgjqyRVtaANLIGxJE1II6sAXFkjaStkcAaSVsjgTWStkYBa5SdNQo8mQHWKNoahZ6v0NYoYI2irVHAGmVlDUjD5zt21oA4fMJjZ42ysgakkTUgjqwBcWQNiCNrFG2NAtYo2hoFrFG0NT6wxje05vHtl_8DAAD___lvbPU=

# EXCEPT ALL and EXCEPT with some overlap.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • except all
    │
    ├── • filter
    │   │ filter: x >= 1
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x < 3
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1v4kYYhe_7K0bvVaIamZkxX5ZWYptltUg0pIDUrVouvHiaIBHs2kaCRPnvFbCBYJM5HkPMXfh4PC-Hec6YPFP834xc6ny_633u3rKrL93haPhH75pdDTu9zs2IrdjXQf93tlw9sT-_dQYdtmT_LKpVqT4xfs063286dyP2udeDwITJa9YffOkM2G9_sRVZNA98des9qpjcv4mTRYIskmSRQxbVaGxRGAUTFcdBtH7L8wbo-ktyqxZN5-EiWT89tmgSRIrcZ0qmyUyRSyPvx0wNlOeryK6SRb5KvOlss8xy9dQOo-mjF60nuAlmi8d57LKltZloGHrrRxVb0PjFomCR7BeJE-9ekctfrPyDfJ3OEhWpyK4dTrF93mVtvg_Tdd3u7ahJFvUXicva6RH2V_2xYg9e_HB4yTan8ct-TGEy5tu8-LkDk4UC4yCxCZPnDcx5d8z9dRbzIPJVpPyDK43XJHrLkc_6zYsfhirph7ZIZT5ahcp94xZZNFP_Jldtfv0pmt4_bP7afW7-bvQ1k-iHQZSoyBa1dEy_vnv9eo7MjsXx86JHhrgNKkFoy2o64KPLNw6W5wZ7vMAWt0XFljlbAYyy2-T1y7aCSWLnj0wWioyDzD64F3i5vcDL6AUQ_Wsv1Iv2gsi_zUSRXSYrtpNTTDDKbpc1LiumQWL8_JHJQpFxkNkHiynKFVOUISaI_lXMRlExZf5tJovsMqdi13KKCUbZ7bLmZcU0SIyfPzJZKDIOMvtgMWW5YsoyxATRv4rZLCqmk3-bOUV2Wa2SU0swyG6PtS6rpUFe_NyByUKBcZDYB0vplCulU4aUIPpXKVvn-Hl75PoDFYfBPFa5frlW14Ep_15tv4A4WEQTdRcFk80y24f9Dbd5wldxsn2Vbx9059uX1gO-hXka5m9h5wDmZjDnJ9GNU2ghT6JbelpoE5f6xKVB4sIMTiVuSjdOoVOJm9ItPe1oE6_pE69p4br-u67rv2ugV0NLN_Vw8xQ39TByE9DATT2N3AQ0cLOlb8MqqMNMmZrYCWikJ8KBnwBHgiIcGMozlXoYvADB6zsVSMoz7XK4uAMWz9SL0Smop-ExCHB0DupxeBACHNjG9d3K6yD4TLsa6aanoW4AR7rpcagbwJFu-pOFg6OFZ0rWSDd9yQpQssKkZLM3X0Yla4wD3QCOdEM4uvHUl6wAJSsyJWuiG6CRbggHugEc6YZwoJvQHzACHDBCf_8KdBP6khWgZIVJyWYXNypZYxzpZlSyxjjSTV-yApSsMLmBz245ozt4YxzpZnQPb4wj3fQHjAQHjNT_SySt2_jll_8DAAD__5RZ_pc=

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • except
    │
    ├── • filter
    │   │ filter: x >= 1
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x < 3
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Ftv4kYcBfD3forRPCWqkZmLCVhaKduE1UaiIQWkbtXmgYVpgkQwtY0EG-W7V8CCw8X_Y3vsvC2Xg8-eHX5i_cqj_6bc5-1vD53Pd_fs4vauP-j_0blkF_12p30zYCv2pdf9nS1XP9ifX9u9Nluyfxb1ujKfmLhk7W837YcBfPOIqUvW7d22e-y3v9iKO3wWjM398MVE3P-bC-5wyR2uuMM1d7jHHx0-D4ORiaIgXL_ldRO4Gy-5X3f4ZDZfxOunHx0-CkLD_VceT-Kp4T4fDL9PTc8MxyZ069zhYxMPJ9PNZZarH9fzcPIyDNcNboLp4mUW-WzpbBr158P1o5or-eObw4NFnFwkiodPhvvizcle5MtkGpvQhK532GL7vM-uRTKk7_t394Mmd3h3EfvsOr2CzFPh_Rai7DFUoTEEWGPEVPYxdJ4Kt5MonsxGsSuPlrgWRxdIMt9X7HkYPZ95f1LCK1bCK7VEI7VE8jmLWRCOTWjGB5-0-ZTUmgptlVS4qqoCWiqp0LSo4BRq-XUYPfdN3J27-mipwWpu_J2Pnzsd7vCp-Te-uBaXn8LJ0_PmT_sznv53auU5Xv0gjE3o6pPJfk03rZ5htHN7_PzUMy3ug1owd7368cLnr3-IqsghWgHQXFlzVUbfQZU9aY3qfM-zRvlzqEJzCLCHhfCgQoKrqFD4zCUaFQovyuMVbZUmfIkV0FJpwuerYC28-AjhwfHaCX8yWWbhZXZTZBFSVM3VGYUFVfakXFUnbI41RPlzqEJzCLCHhbCgQoKbrFDYzCWuKhRWlscb2ipN2BIroKXShM1XwVpY-RHCguO1E_ZksszCquymqCKk6JrrZRQWVNmT0qxO2BxriPLnUIXmEGAPC2FBhQQ3VaGwmUs0KxRWlccb2ipN2BIroKXShM1XwVpY9RHCguO1E_ZksszC6uym6CKkeLWMvoIie1Ba1fmaYwtR9hiq0BgCrGGhK6iQwKYr1DVziVaFuuryaENbpelaYgW0VJqu-SpY66o_QldwvHa6nkxW6B7wmQv0TDQPZpHJdHu3vl7MjJ_M9l8gChbhyDyEwWhzme3D7ia3eWJsonj7qtg-uJttX1oXfB8WZFjTYUmGFR1WZNijw_o4LN6HGwdhkS8srmzS0iqtrNIapD0ybRUWTZu0tEorq7QG6QZ5TEH4KkdYHoebZLhFf0FaNAp1uregTfEQKrQqQoI47YoANghaFgFQEydfssN4A8Tp4wZoAmlkE4gjnEAc6QTiiCdx8lXL4xNII6BAHAkF4ogoEEdGCdoZ0QJxWpqj-IlTgrZG1sGPCPD7BVAlaWsksEbS1khgjaStkegHFG2NBNZIK2tAGlkD4sgaEEfWgDiyRlpZA9LIGhBH1oA4sgbEkTWStkYCayRtjQTWSNoaBaxRdtYo2hoFrFHg_0vAGkVbo4A1irZGAWuUlTUgjawBcWQNiCNrQBxZo6ysAWlkDYgja0AcWQPiyBpFW6OANYq2RgFrFG2NBtZoO2s0uDMDrNG0NRrdX6Gt0cAaTVujgTXayhqQhvd37KwBcXiHx84abWUNSCNrQBxZA-LIGhBH1mjaGg2s0bQ1GlijaWs8YI2X05rHt1_-DwAA__-dWY0y

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• except all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEls1u2kwUhvffVVhnlUiDzIxtEix9ElFKVSQa0sAiUsXCwdOARDyux5Zwotx7ZZMf_jrH4wF3aczjeeecZ_G-gPy9BB_697fDq8GNdfZlMJ6MfwzPrXF_2L-eWCti5dbXu9F3a5U_W_376_7txLoaDt_f58RafbwHApEI-U3wxCX4P4ECAQYEHCDgAgEPpgTiRMy4lCIp_vJSAoNwBX6bwCKKs7T4eUpgJhIO_guki3TJwYdJ8LDkdzwIeWK3gUDI02CxLI9Z5c-9OFk8BUkOBK7FMnuKpF9GBwLjOCieWjaD6SsBkaVvh3x--yG35oGcb3-1R0mvQKYEZBo8cvDpK6mX16uZl8AoS32rx0iPmoZnfw3_-aksEknIEx5ufWxakNhfDkzgWyDnY56OYpvuLGySx9zfkAkILPmv9KxMff5_snicvz98zODtQpsz-LycY3C5A8lvREvENvV2x3DwbHfrbFrdClrDCpu1bOe4Hmsk7tROfDqTabMm00ZNZtV3w-rsxmnZ7nFt0kh8UTvx6WxizdrEGrXJqb4bp85u3JbtHdcmjcSXtROfzianWZucRm1yq-_GrbMbr3VclzTydmvmPZ1JbrMmuf-srx3IdcdlLCLJK7WxdnEzHj7y9aSkyJIZv03ErDxm_TgqubI6hFym67ds_TCI1q-KgNXhjgncNYGpUW7qqWmqMTKmB3dM4K4JTI1y74xsj2a7dHuTdtTzdpQw3Z5Ze5d2TQRXw4jgahgRXA1jgiM0IrhnIrgaRgRXw4jgahgTHKERwTsmgl-YKKqGEUXVMKKoGsYURWhE0UsTRdUwoqgaRhRVw5iiCI0o2jVRlBr1BIRGJEVoxFKExjTFcKwrmJUFs7ZgVhcM-4JZYaBGjYHuVQYtW9U0ZquaxmxV06itCI7ZqlOW9nem05Z0acxWrb6kjWO27pUHpa3T1__-BAAA__8xhaKp

query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• except
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9v2kgXxu_fT2Gdq1YaZGbGBmLplahSVhuJTbKBi0qrXLgwmyARzNpGgkb57itAqRs7Ps_4X_bScX_4mdN5fox5puSfNQU0-XY7_XJ17Xz6ejWbz_6cfnZmk-nkcu7shXNwfru7-cPZH344k2-Xk9v5672DcPY_75GgTbQ01-GTSSj4iyQJUiRIkyCPBPl0L2gbRwuTJFF8_CfPJ-BquaegL2i12e7S45_vBS2i2FDwTOkqXRsKaB5-X5s7Ey5N7PZJ0NKk4Wp9esz-8GO8jVdPYXwgQZfReve0SYJTbBI024bHq56r6P5FULRLs4ckafhgKJAvol4Qv2YQQTe7NHDGSoxlaSpVJdXXVZKuNovUlbnhjKUY51eeYd8PzmOYPL6PZFF0vSh-B1G80ijZR-02Ubw0sVm--bDTp5SGVRZzy1L4XaWwGFmWYtAghagV9PcweZyZ9Gbr6ty85oetCV7l8GU6JUFr83f66bSCz_-PVw-Prxc_tz-7uGG7I76OetHW1X5-DO8-e_Tm2dJeCLKGEFzVc7WlmypEGdSOUsNOIFemBNm5nayjDDq3k2zPCxZzK7NTiyksRlZmp2opGttJfqidlH0tVZ1a6p7rWRqiQpRh7Sg1DAFyZbVUnRvCOsqwc0Oo9rppMbcyQ7SYwmJkZYaolqKxIdSHGkLb11LXqaXXc31LQ1SIMqodpYYhQK6slrpzQ1hHGXVuCN1eNy3mVmaIFlNYjKzMENVSNDaE_lBDePa19OrU0u9Z-qFCkIuaQWrYAaTKKul1bgfrKBed28Frr5cWcyuzQ4spLEZWZodqKRrbwfvPfv94J9edSbbRJjFWv270jyszywdznlQS7eKFuY2jxekx58ubE3f6w9Ik6fmuOl9cbc63jgF_hSULax5WeVj-CntvYFkNlqoRfdGEVoMmtNY8rVnabwLLRo9W_Ub0sAmtwWbx2G0K_r_8CrDKwwMWBose8u0a8PUasbTs8_QFT0vghYJVqnQb0KjcCAftBjiqN8BRv2VBqVUKDmjUcICjiiMcbHeAo5LLgljfblmEFxTD4YWiS94xaOm8ZOQQ1I3XjBwBvCCaSm3ladhWgKO28jhsK4_DthYkW6mtPA3byuOwrQBHW5bHYVv5LxglwSEKHFsl31bFH1zB0hVvGuWBcy9vGuUDvGCaSudmnoYHZ4CjkzOPw6Mzj6O2qoJlq7QV0KitAEdtRTjasjyO2qr4Lxg1Ajh_ks3hxbbyR1m0dN40GhxlNW8aDd6QNX-oAXMHNGorwkFbAY7aCnD4psu_KKNXXfCK3-zh8GUX4OhtF_xGgHYN_wWj0ej4o2wOL7RV82fZ_NLvX_73bwAAAP___X9ARg==

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9u2jAUh-_3FNa5KppRsJPwJ9Kkdi3TkFjpgItOExcp8QoSJVkSJELVd58SyiiE-MQJ5I4Uf_YPn-_05BWCvwuwoPv40L_p3ZOru95oPPrZr5GrUbffvR2TNfk2HPwg62hDBsO77pB8_UWiGuk-3nYfxuSm3_-_MiI3o5PLN7X95zVQWLqOuLdfRADWb2BAgQMFHSgYQMGECQXPd6ciCFw_XvKaAD1nDVaDwnzprcL4zxMKU9cXYL1COA8XAiwY208LMRS2I3ytARQcEdrzRXLMOtpce_78xfYjoHDrLlYvy8Aia0ri55Fnx091LU4yWIUWuWYweaPgrsL34_anPEVkZgezw_2T9RMKQWg_C7DYGy0W28wVO6Jkc4nYPDP2fp_V0vUd4QvnYKdJTGJLTvz273YwG4lw4GnsqGLjyBPWB8-AwkL8Ca-uWe2LP3-eJZ8yf_f-N-kqpRi5fih8jZnH1_Q5c38jx52duo73TU-EuHfrrqfxxvEFnzzePDie5TeNFWgQjdc1_SItohC8WaBFzhmcZwavoElYFU2CFGPXJM2iTcLzF5sXsVSva8ZFLFUI3ipi6RmD88zgFVjKq7AUKcbO0lZRS_X8xdaLWGrUk2l_fksVgreLWHrG4DwzeAWW6lVYihRjZ2m7qKVG_mIbRSw16xdxVCF2p4ijZ4vNM2NXYKhRhaFIKXaGds7xSnxi_6EIPHcZiFxvu434woTzLLYFCNyVPxUPvjtNjtk-DhIueYtxRBBuv-Xbh95y-1UcMD_cKgMzVoo2S9EdOc0U7oyrwa0y8NGdqdJmKbojp_kx3fhI6wdw4xjWpbAhr5YhhTmTH22W6Q85jPSHHMb6A6GR_kBopD-aZfpDDiP9IYex_kBopD8QGumPltTStlzSdpn-6JQxXA4jhsthzHCERgxHaGwCqIzN9H9SlbmpSqNDQGlyKuOI5iw1RQ5UZVwuOpOPEcR0lpojKqojNOI6QmOyYzhiO4ZjuqdmqJLuchrTXU6juiM4pjuCY7qnBumh7k1E99RMUdI9NVOUdJfTmO5yGtUdwTHdERzTPTVPlXSX05juchrVHcEx3REc0z01VQ_ftRty3Xlqtkh1n7x9-hcAAP__jYOqQg==

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v8jYYhs_3KyIftVoQ2A5fkSa1a5lWiZUOOHinqQd5wWuRKGFJkKBV__sEjDdtTJ7bzkfPSpsrvvPg-5LTNxb_u2Q-G3x7GF7f3TsXt3eT6eTP4aVzMRkMBzdTZ-v8Nh794Wx3r85ofDsYO7_-5ewuncG3m8HD9MdVO-d6cvbS18v05y1z2Sqcq_vgRcXM_5tx5jLBXCaZyzzmsjZ7dNk6CmcqjsNof8nbAbibb5nfctlitd4k-18_umwWRor5byxZJEvFfDYNvi_VWAVzFTVbzGVzlQSL5WGZ7e71ah0tXoJox1x2Ey43L6vYd7aus_88WQf7T43mPslok_jOFWeP7y4LN0m6XJwET4r5_N0tFqltFGnnOq-2kYRNpNtFnCxWs6TJMzPSFkiZ7zvnOYifz1yfhpDFQrQrDeHlhkjvs1mF0VxFav7pToe75MYUaFZphHZdEdCk0gidEhHcQil_D-LniUpG66bMTGq6Wyv_5Irr4ZC5bKn-SS6u-OUv0eLp-fCTwR7v2myvSRglKmpKbWQ_596_ZzCzc-P4_6ZnQtyHjXDd9FrZAZ9dvv9peW5uFV5AdE3RaEpr1VmE6hRQnWkoYRMq9QyvUXbGITo1yo5XZxo0qzzZVRgBTSpPdnYRSsuOf4XswPY6yU4bmanshHmxRRHbyEbTs7aNRahuEdsYhhI2odKiixptYxyiW6NtRHVVR7PKs02FEdCk8mxjF6G0bcRX2AZsr5NttJGZ2kaaF1sWsY3XOLxp2dnGIlSviG0MQwmbUGnRZY22MQ7Rq9E2srqqo1nl2abCCGhSebaxi1DaNvIrbAO218k22shMbeOZF9srYpt2w9o1FpH6RVxjFEnYREpL7tVoGuMQ_RpN41VXczSrPNNUGAFNKs80dhFKm8b7CtOA7XUyjTayIv8yOnP_sYrX4SpWRv8Nau0HpuZP6vgFxOEmmqmHKJwdljl-HB24wy_mKk6OfxXHD3er45_2AT_CnIQlDYsszD_C3ieY28FclqEFL0X3y9CyS9OSpNtlYA5GTtNClKFlqxTdo2mP3KYdGm5bwCILd0i4SxekS8LgmXsk7HF66T5Jc0BzWiocWUXTio0ZAI3UAHDkBoQDOQAc2YHTcgF6ADTyA8CRIACODIFwUBeuGebzlkWjoxWTwTVNcFoyvAMKQ2sGPTrtGd4Hi9OmES2Aa6qxKjtNw7LTOCw7wFHZaRyVXWiWtSk7oFHZAY7KDnBUdoSDHS_oc6tAp0dNNRSulV3QqhEeODbTqkGPTptGgCOJoE0jegDXVGN15qdpeOincXjqBzg69tM4LLtmWauy0zQsO43DstM4LDvA0Y6nz7ISfO2SPstmcK3sErwig6OwpFUDHl3SppFtsDhtGglOJVJTjU3ZAY3KDnBUdoSDsgMcvuRrlrV6y6dp-JpP4_A9n8bhiz7A0Y6nz7ISfW_0WTaD62WnVeOBo7BHqyb76I_vP_0XAAD__wMqOVI=

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9vokoUx9_vXzE5TzV3DMwA_iC5SXtbb66JW7vqQzcbH6jMVhMrLGCiNv3fN2CNRWQOA8rbzspn5sucz-nhHcLfS7Ch9_w0uOs_kpuH_ngy_j5okJtxb9C7n5AN-W80_EY22x0Zjh56I_LvD7JtkN7zfe9pQu4GA_mTlOwax-UGKKw8Vzw6byIE-ycwoMCBggEUTKBgwZSCH3gzEYZeED_yngB9dwO2TmGx8tdR_N9TCjMvEGC_Q7SIlgJsmDgvSzESjisCTQcKroicxTI5ZrPd3frB4s0JtkDh3luu31ahTTaUxOux78SrphYnGa4jm9wymH5Q8NbR53HHU162ZO6E8_T-yfNTCmHkvAqw2QctF9sqHJuS3TWS89zkx33WKy9wRSDc1E7TmMQeOfP6_zvhfCyioa-xk6JNtr6wv4gGFJbiV3Rzyxr_BIvXefKv3Pc-vpOhUo2xF0Qi0Jh1ek1_5-5vFrizc9fxuemZEI9e0_M1rp9e8NnjrdTxrLhsrESPaLypGVfpEoXgrXJdcsnsPDd7DX3C6ugTpB6HPmmV7RNevN68jKhGUzOvIqpC8HZJUS-Ynedmr0FUXoeoSD0OorbLimoUr7dRRlSzmYz9y4uqELxTUtQLZue52WsQ1ahDVKQeB1E7ZUU1i9fbLCOq1byKpgqxuyU1vVhynpu8BknNOiRFqnGQtHuJz-Mz-49E6HurUBT68tXjCxPuq9gXIPTWwUw8Bd4sOWa_HCZc8jnjijDa_8r3i_5q_1McsDjcrgIzVom2KtFdOc0U7oyrwe0q8MmdqdJWJborp_kprX-ljRSsn8KGFDbl1TKlMGfyo60q_SGHkf6Qw1h_IDTSHwiN9EerSn_IYaQ_5DDWHwiN9AdCI_3RllrakUvaqdIf3SqGy2HEcDmMGY7QiOEIjU0AlbGZ_UuqMjdVaXQIKE1OZRzRnGWmSEpVxuWiM_kYQUxnmTmiojpCI64jNCY7hiO2Yzime2aGKukupzHd5TSqO4JjuiM4pntmkKZ1byG6Z2aKku6ZmaKku5zGdJfTqO4IjumO4JjumXmqpLucxnSX06juCI7pjuCY7pmpmv7W1uW688xskeo-_fjrTwAAAP__ws-tjg==

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FdasblQjMzPmy1Kl3CZUjURDCixuVWXhC9MEiWBqGwkS5b9XQJFvPPg9M_7ILk54PMcvcx6N88aSf1csYMNvD6Ovd_fOl9u76Wz65-jK-TIdjoY3M2fn_DYZ_-Hs9q_OeHI7nDi__uXsr5zht5vhw4z-lOu8XmWXO-aydbRQ9-GLSljwN-PMZYK5TDKX-cxlHfbosk0czVWSRPHhI29H4G6xY0HbZcv1Zpsefv3osnkUKxa8sXSZrhQL2Cz8vlITFS5U7LWZyxYqDZer4zK7_ev1Jl6-hPGeuewmWm1f1kng7FzncD3dhIerlndIMt6mgXPN2eO7y6Jtmi2XpOGTYgF_d8tF6hhHcp1X21TCJtXtMkmX63nq8dyYtAUy5vveeQ6T5wufz0LIciE6tYbwC0Nk99muo3ihYrX4cKfjXQpjCjSrLEKnqQhoUlmEboUIbqmUv4fJ81Sl440nc5Oa7TcqOMvi62jEXLZS_6RfrvnVL_Hy6fn4k8Ee79lsr2kUpyr2pDaynwvv3zeY2aVx_H_TCyHuo1a08fx2fsAXlx98WJ6bi4WXcJ0nWp60tp1FqG4525nmEja5MtXwBn1nHKLboO94fbJBsyryXY0R0KSKfGcXobLv-Gf4Dmyvs--0kZn6Tph3W5QRjmx5vrVwLEL1SgrHMJewyZV1XTQoHOMQvQaFI-prO5pVkXBqjIAmVSQcuwiVhSM-Qzhge52Fo43MVDjSvNuyjHD81vGVy044FqH6JYVjmEvY5Mq6LhsUjnGIfoPCkfW1Hc2qSDg1RkCTKhKOXYTKwpGfIRywvc7C0UZmKhzfvNt-GeF0Wta6sYg0KKkbo1TCJlXWc79B2RiHGDQoG7--pqNZFcmmxghoUkWysYtQWTb-Z8gGbK-zbLSRlfn30YX7T1SyidaJMvrPUPswMLV4UqcvIIm28Vw9xNH8uMzpcnzkjr9YqCQ9_VWcLu7Wpz8dAv4IcxKWNCzyMP8R9j_A3A7msgoteCV6UIWWPZqWJN2pAnMwcpoWogot25XoPk375Dbt0nDHAhZ5uEvCPbogPRIGz9wnYZ_TSw9ImgOa01LhyCqaVmzMAGikBoAjNyAcyAHgyA6clgvQA6CRHwCOBAFwZAiEg7pwzTAftywaHa2YHK5pgtOS4V1QGFoz6NFpz_ABWJw2jWgDXFONVdlpGpadxmHZAY7KTuOo7EKzrE3ZAY3KDnBUdoCjsiMc7HhBn1sFOj1qqqFwreyCVo3wwbGZVg16dNo0AhxJBG0a0Qe4phqrMz9Nw0M_jcNTP8DRsZ_GYdk1y1qVnaZh2Wkclp3GYdkBjnY8fZaV4GuX9Fk2h2tll-AVGRyFJa0a8OiSNo3sgMVp00hwKpGaamzKDmhUdoCjsiMclB3g8CVfs6zVWz5Nw9d8Gofv-TQOX_QBjnY8fZaV6Hujz7I5XC87rRofHIV9WjX5R398_-m_AAAA__-hoDye

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)
----
distribution: full
vectorized: true
·
• except all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6xz1UpGwU6gJdKkdi3TkFjpgItOExcp8QoSxVmcSA1V__uUMKnlIz4xHuGuafzEr30eifcV1J8F-NB9uO9f9-7I2W1vNB796J-Ts1G3370Zk4x8HQ6-k5dsRQbD2-6QfPlJVuek-3DTvR-T634fWQkUljIUd8GzUOD_AgYUOFBwgYIHFFowoRDFciqUknG-5LUAeuEL-E0K82WUJvm_JxSmMhbgv0IyTxYCfBgHjwsxFEEoYqcJFEKRBPNFsc1LtrqK4vlzEGdA4UYu0uel8klGyQoojKIgf2o4eZJBmvjkisHkjYJMk3_bve_ymJFZoGab3y_WTyioJHgS4LM3eljs1klj89LY799JlzIORSzCjS9NchJbsufs3wI1G4lkEDlsa2LjLBL-B6-AwkL8Ts6u2PnneP40K_4qPff7mVyLM-0JfCcbMnJYa_v0e_f2NvZm1TVgB2jg8IbjHsVfg-DtEwfnpcFrMJjVYTCvPgx-yDDchuMdxSKD4BcnDs5Lg9dgEa_DIrf6MNxDhuE1ip-y_2-RQfDLEwfnpcFrsMitwyKv-jC8Q4bRahzFIYPYnZPG5qWxazDIq7uP7YkzFCqSSyUqta1mfiARPon1BSmZxlNxH8tpsc36cVBwRTMIhUrWb_n6obdcv8oDVofbNnDHBmZWuVlLTzODK-NmcNsG7tjAzCr31pXt0Hybbn6kXf19u1qYbd5Zc5v2bATXw4jgehgRXA9jgiM0InjLRnA9jAiuhxHB9TAmOEIjgrdtBL-wUVQPI4rqYURRPYwpitCIopc2iuphRFE9jCiqhzFFERpRtGOjKLPqCQiNSIrQiKUIjWmK4VhXsCsLdm3Bri5Y9gW7wsCsGgPbqQxGtuppzFY9jdmqp1FbERyz1aQs7c7MpC2Z0pitRn3JGMds3SkPWlsnb5_-BgAA___PZqF0

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)
----
distribution: full
vectorized: true
·
• except
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE9v6kYUxff9FNZdJdIgmBkbiKVKeU2oGomGFFi8qsrCD6YJEsHUNlJIlO9eYfTkxI7v8WA7O_zn5zlzmXN8x68U_7cmn0bf78bfbm6ds-ub2Xz21_jcOZuNxqOrubN3fp9O_nSe9y_OZHo9mjq__e28nDuj71ejuzm4iwRtwqW5DZ5MTP4_JEmQIkGaBLkkyKN7QdsoXJg4DqPDLa8pcLN8Jr8naLXZ7pLD6XtBizAy5L9SskrWhnyaBz_WZmqCpYm6PRK0NEmwWqfDPO9fLrfR6imI9iToKlzvnjax7-yF80KCZtvgcNTpHpRMdonvXEq6fxMU7pJsuDgJHgz58k2cJslrTZKykXS9ipPVZpF0Za5GhQEy5sfeeQzix0_uz0To00R4jYpwS0Vkz9ltwmhpIrP88KT0KaUyFapVJsFrSwKqVCahX0OCOEnlH0H8ODPJZNvVuUrN91vj_8yGb-MxCVqbf5OzS3n-a7R6eEx_VVjjg2bLeht2wm1Xe_nZfzr28MPYsrrl5QmW76pOV1vnkIWofouilI2oLARki0lUWUS_xSSSzcUAqlVZEjUoAVWqLInsJNROIvkVSaSqG0-dYjzd6brWaWAhatCiKGUjKjOiajENKosYtJgGqjkrolqVpUGDElClytLATkLtNFBfkQa6uvH0KcZzO-k2wi4NLEQNWxSlbERlRtQtpkFlEcMW00A3Z0VUq7I0aFACqlRZGthJqJ0G-ivSwK1uPPcU43kd6yywkHTRmiRlIykzodtiElQWcdFiErjN2RDVqiwJGpSAKlWWBHYSaieB-9XfKz6RMzXxNtzEptLXiN5hQmb5YI4FisNdtDB3UbhIhzkeTlIuPbE0cXK8qo4HN5vjpYPA97BkYc3DKg_L97D7AZZ2sFS16Is6tOrXobXmac3SXh1Y1hpa9WrRgzq0BovFZZcp-L88C1jl4T4Lg0kPeHf1eXsNWVr2ePqCpyXIhUKq2Hgb0MjcCAfuBjiyN8CRv2UhUm0MDmjkcIAjiyMcLHeAI5PLQrB-XLIIL0QMhxeMLvmMQVPnQ0YOgN34mJFDgBeCxsqtPA3dCnDkVh6HbuVx6NZCyFq5laehW3kcuhXgaMnyOHQr_4JREjRRoG2VvFsV37iCqSs-aZQL-l4-aZQH8ELSWPXNPA0bZ4CjzpnHYevM48itqpCyNm4FNHIrwJFbEY6WLI8jtyr-BaOGAOc72RxedCvfyqKp80mjQSur-aTRYIes-aYG1B3QyK0IB24FOHIrwOFOl98oo60u2OLXGxxudgGOdrvgGwFaNfwLRqPS8a1sDi-4VfO9bH7q92-__B8AAP__NHYyuQ==

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))
----
distribution: full
vectorized: true
·
• except all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdF3Asko2EloiTSJqmMaEitd4VBp4pASryBRnMVBglb971OSVZQA_mKMkqMhj_3a33N430D-XYIP_cf74c3gzmp8G4wn41_DpjXuD_u3E2tjfX8Y_bQajY81sbb5T5vta9PqP9727yfWzXBoHf-iCQRWIuR3wQuX4P8GCgQYEHCAgAsEPJgSiGIx41KKOP3kLQMG4Qb8NoHFKlon6c9TAjMRc_DfIFkkSw4-TIKnJX_gQchjuw0EQp4Ei2V2zGb72ovixUsQb4HArViuX1bSz8IBgXEUpKuWzWD6TkCsk_-H7PZ-2lrzQM73d-1R0kuRKQGZBM8cfPpOzsvr1ZOXncy722q9EnHIYx7ubTZNSeyTI5f-Ecj5mCejyKaFGU22Efc_KQQElvxP0shSN7_Gi-f5xwIIjNaJb_Vo4QF2N3MMbnYk9p1oicimXvENjp7t7p1Ny1tAz7DAZi3buay3Gok7dSVmJxNXYC6tzlxWfhbsnFk4Ldu9rD0aia_qSsxOJq7AHladPU75WTjnzMJt2d5l7dFIfF1XYnYycQX2ONXZ45afhXvOLLzWZd3RyNutJy87mbcCc9x6-taRUA9cRmIleak21U6vxcNnnj-TFOt4xu9jMcuOyZejjMt6QMhlkv_L8sVglf-VBiwPd0zgrglMjXJTT01TjSdjenDHBO6awNQod-HJDmhWpNufaUf93o4Spvtv1i7SrongahgRXA0jgqthTHCERgT3TARXw4jgahgRXA1jgiM0InjHRPArE0XVMKKoGkYUVcOYogiNKHptoqgaRhRVw4iiahhTFKERRbsmilKjnoDQiKQIjViK0JimGI51BbOyYNYWzOqCYV8wKwzUqDHQg8qgZauaxmxV05itahq1FcExW3XK0uHMdNqSLo3ZqtWXtHHM1oPyoLR1-v7lXwAAAP__bPGU_Q==

query T
EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))
----
distribution: full
vectorized: true
·
• except
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFr4zgUhd_3V5j71IKCK8lOUsNCh06WLWTbbpOHgaUPnkTbBtI4azvQTOl_X5JQPLXre6TY7jzKzmcd3egcX_mFsv-WFNHo2-34y9W1d_L1ajKd_D0-9Saj8ehy6j17f9zd_OWdnLyNhbc9XHre_jj1Rt8uR7dT7-O7pyRolczNdfxkMor-IUmCFAnSJCggQSHdC1qnycxkWZLufvKyB67mzxSdCVqs1pt8d_le0CxJDUUvlC_ypaGIpvH3pbkz8dyk_hkJmps8Xiz30zxvf1ys08VTnG5J0GWy3DytsmgvjgRN1vFu1PMV3b8KSjZ5MUmWxw-GIvkqjhMStixEuQj5usjyxWqW-7JUjwspLspzFNj3rfcYZ48fI4UUfZyUsAMpQa2U4lGbVZLOTWrm7x62f0qtWGVRt0JF2JUKi5IVKvoNVIijhP4ZZ48Tk9-sfV2q13S7NtFbJHwZj0nQ0vybn-xXcPp7unh4fBuQoJtNHnkXsnZlg3bre530krWvw3INPpx7-G5uaR8A8ogA8FXP15ZZ5CCl37oU5SKliADZeRpZS-l3nkayvRywqFtdGrWowqJkdWnkpqJxGsnPSyNlb0N1jA11zw8sE8FByqB1KcpFSmFD1XkiWEsZdJ4Iqj0vWtStLhFaVGFRsrpEcFPROBHU5yWCtrehPsaGQc8PLRPBQcqwdSnKRUphQ915IlhLGXaeCLo9L1rUrS4RWlRhUbK6RHBT0TgR9OclQmBvw-AYG4Y9yzxwEHLeshDlIqSwYNB5GlhLOe88DYL2fGhRt7o0aFGFRcnq0sBNReM0CH7N94sPRN2ZbJ2sMmP1deJstywzfzCHMmXJJp2Z2zSZ7ac5DG_23P7C3GT54a46DK5Wh1s7gT_DkoU1D6syLH-Gg3ewdIOlakSfN6FVvwmtNU9rlg6bwLLR1OqsET1oQmuwWQJ2m4L_K3SAVRnuszBY9IB3V5-315Cl5RlPn_O0BLlQSRUXbwMamRvhwN0AR_YGOPK3rESqi8EBjRwOcGRxhIPtDnBkclkJ1vdbFuGViOHwitElnzFo6XzIyAGwGx8zcgjwStA4uZWnoVsBjtzK49CtPA7dWglZJ7fyNHQrj0O3AhxtWR6HbuVfMEqCJgq0rZJ3q-IbV7B0xSeNCkDfyyeNCgFeSRqnvpmnYeMMcNQ58zhsnXkcuVVVUtbFrYBGbgU4civC0ZblceRWxb9g1BDgfCdbwqtu5VtZtHQ-aTRoZTWfNBqckDXf1IC6Axq5FeHArQBHbgU4POnyB2V01AVH_GaTw8MuwNFpF3wjQLuGf8FoVDq-lS3hFbdqvpctL_3-9bf_AwAA__8NXTKa
