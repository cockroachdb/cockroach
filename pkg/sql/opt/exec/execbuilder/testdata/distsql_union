# LogicTest: 5node

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW RANGES FROM TABLE xyz WITH DETAILS]
ORDER BY 1
----
start_key           end_key       replicas  lease_holder
<before:/Table/62>  …/1/2         {1}       1
…/1/2               …/1/3         {2}       2
…/1/3               …/1/4         {3}       3
…/1/4               …/1/5         {4}       4
…/1/5               <after:/Max>  {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x
----
distribution: full
vectorized: true
·
• union all
│
├── • sort
│   │ order: +x
│   │
│   └── • scan
│         missing stats
│         table: xyz@xyz_pkey
│         spans: FULL SCAN
│
└── • sort
    │ order: +x
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysl0Fv2kwQhu_fr7Dm9FW1ZWa9xuBT0kAlJAIpUKlVFUWuvaQoBlPbKJCI_15haAPeeORduAVM3nn9zLPCvEL2OwYfut_u-te9gfF_pzeejL_0Pxjjbr97MzHWxufR8NZYb16Mr4PecGBc9_vvXBuOOt2R8em7sQYTFkkkBsFcZOD_AAQTGJjggAkcTHDh3oRlmoQiy5J095HX4h960Rr8hgmzxXKV796-NyFMUgH-K-SzPBbgwyT4GYuRCCKR2g0wIRJ5MIuLMevNy9V68_KwfBIbMOEmiVfzReYXfcbLYPenZTO435qQrPK3EVkePArw8ahTrwN-Y2vWrzVO0lyktnva6Ao_Vo5jpXGuyrhjCnhZDE6pF-pwQAUQvDywmsTbnCSNRCqi96a802qQWMnSZqegqvo0Sn1YNYAz-7i1-rjlPqd8UMEUZVFsZtlO7RODKsUOpjT1T0xTm8OlQUhnRocEKqCQzkw1izMdRb0zcwqA1d8NU1-NY9m8tqNMpdhhM56-o54uB7w0CMlRHRKogEJytJrFmY4yPUdPATj1d-Oor4ZbtlvbUUel2GEzLX1HW7oc8NIgJEd1SKACCsnRahZnOuroOXoKgNffDVdfjWvVNpSr1Drspa1vaFuXAl4Wg-SnDgdUACH5WU3iTD-5np9c5cfBSGTLZJEJrVEW7tqL6FHs7zZLVmko7tIkLD67fzksgoo3IpHl-6u4f9Fb_L2U5akI5v9-4x0nIZnET5LwOGn_yHccxcgop7qUW05ytEtJ98fJKLc6iklRLhnFmgrUm2SUV50kQfdoExoEK6ec1SKz2tWtmuWktn4rJhlKy06tUKKFtO7Iqu9R7kX7jkQxlIxHWnnk1cU8KYt2nizGpTDaeoq-TIzWHgnvJVeRFp9RisnEaPORUL8lZdHuk8Wkc8T03ZeIMdp9RrgvWcFo9xmlWFsKo91nhPtyFu0-WUxaJdN3n---u6dx8vwwi8CH0AumLuNNK2KcWZy7aLWZ51lhEPA2b0RuWDy-TOPgMds9QIx_Jc9F7mSz3H39T4M4EybcBk-iI3KRzmeLWZbPwsOV7fa_PwEAAP__E7Jn3w==

query T
EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • union
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysltFu2jAYhe_3FNF_tWmJEjtOQnLVrTAJqYUOmLRpQpVL3A4VEhYHFVrx7lPCthS7sWKLu5LAd85_fFz7BfjvFSQw-H5z9Wk4st73h9PZ9OvVB2s6uBpczqyd9WUyvrZ2-2fr22g4Hr3xfDzpDybW5x_WDmzI8pSN6JpxSH4CAhsw2OCDDQRsCGBuw6bIF4zzvKi-8lL_YJjuIPFsWGabbVk9ntuwyAsGyQuUy3LFIIEZvVuxCaMpK1wPbEhZSZerWma3f77Y7Z9vN49sDzZc5qvtOuNJ7We6odWfjothfrAh35aNBC_pA4MEvfI07EPiHWwzW8FZbWHBVqBjq7_k5TJblC4SsrpArYK-IIi0gmgUg86KRFRsn7ER2mZ5kbKCpScy84PKE-6eQiB4wlopTPOiZIWLkaj3sVUwFAXRiSDq3j-k3T8XO67feWMYGwvPbEzcGqGOsaao0iJ13xpaUTSKofnWOJ0Rdw8f64fvOy7p3Apsaiw6szGxFZGOsWaNsHkrtKJoFCPzVpzO6HcP39cPnzhu0LkVvqmx3pmNia3o6Rhr1sg3b4VWFI1iz7wVpzOS7uET_fADp3MniKmt-Ky2xEbEOraa9SHmjdAKolGMzRsR61xiJoxv8owz4YL1tpQnSDmouomx9IEdr2083xYLdlPki_q7x4_jGlQ_SBkvj2_944dh9u8VLwtG1__vvq9JSEnC7SRPJGEliZyQ0GsSklC-MUqajyhRQft8WHIVqKPSySpUouJ2UiiSIiWp105CIqlnHLqEio1R0nxIXXWk6HoksdRlR4oVxBLLvO4yy7zv8ozqwqOofcaexFI3HoXtLF9iqSuvmlFmqUuvYskzqmuPUfuMscRS9x577Swi_TdV9141o8xS917Fiqsz6H6VP90uU0iAxMEdCu9CJ6KR55A4JE6MPerQNOiFYXDPAkSh-gF94NVBOP2VP9Xc2X5THWP3dMWZDdf0kfVZyYr1MqsO5cXfN4fDuz8BAAD__yAdRUc=

# UNION with no overlap.
query T
EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • union
    │
    ├── • filter
    │   │ filter: x < 3
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 3
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysmNGPolYUxt_7V5Dz1KYQOPeCIEmTaVc3NZl1tmrTNu1kw8CdqVkVC5jVmfi_N2grwl0P3BveRsHvnPPl953cO2-Q_7OCEMa_f7z_cTI1vh1N5ov5L_ffGfPx_fjdwtgb72cPH4z94dX47efxbGzsjb92jsNjgxu_TicP07YXxQ8GNx5mo_HM-OkPYw8mbNJETKO1yCH8ExBMYGACBxNcMMGDRxO2WRqLPE-z8pW30w8myR5Cx4TlZrsryq8fTYjTTED4BsWyWAkIYRE9rcRMRInIbAdMSEQRLVenMvvD693-8Ppp-1kcwIR36Wq33uThqZ_5Nir_tGwGj0cT0l1RlciL6EVAiFc9TUYQOkeze1vvl6tCZCKzvXpP5-9D4w4rp8IwnEwXwc1GWKMRT6WRa3-wX4N4oy_UcwhbLIrbHXKbnShZNFrmxXITFzZr-HOHNyt6jYpMafaqote54qBZ8faMVaHdJs0SkYmkVubxSPXEu7vgN3riSi7M06wQmc2xWe_7mwWDZkGsFUSFLChHwWaWzTtvC6XGLlkY9L8tBtoO9W2RtC_0PMIWk3T2hZJJVXolcrvvC6XZq4oD_X1Rn5F1B4Gpc8At2-0cFabS2AUDv_-o-LoOYd8WSVHR8whbTNKJipJJFbhMPypKs1cVff2o1Gfk3UHg6hy4lu11jgpXaeyCQdB_VAJdh7Bvi6So6HmELSbpREXJpApcrh8VpdmrioF-VOozut1BcNU58KzOQXFV2rpAMOw_KENdf7Bfg6SY6DmELRbpxETJogpaVz8mSrNXFYf6MRmqXIxmIt-mm1w0Lm1fL-U0SllY3u5E8iLOV8E83WWx-Jil8end88eHk9Dpi0Tkxfkpnj9MNv8_yotMROvL_z6ulZBU8m4rna_m11KMlOK3pSQlTiq5RFPSfC4pNahJ4bUUk6Q8bSlpwAEp5d8ekEtd-bTrTIGFgJQaErY3lYY0nwQL5xtcjdAW2AnaZS0adyTcQmlIpIGngJC1aOQpLXlImnkkQs0kLRp6pKDwJTEaeyS4l7Vo7jEgGpOnpMmn3Je1aPYpLWlIRqPPCPS5pEWjz6hVH0hiNPqMCLisRaPPqHUvT6m_72Ut_YUvD0mjzwj0XUmrZeUTVJyPaDUxGn1GBFzWotHnDtGYNCWn2afcl7Vo9imtYXkIe16lXz4tEwhBxA66LPIt3wueLPc5ebKefActZG6MMWIsuA_lD6KXvDwJzv9Ov5x0F4dteY57jla5MOFD9FmMRCGy9XJTnkrj_54cj9_8GwAA__8ml_6U

# UNION with partial overlap.
query T
EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • union
    │
    ├── • filter
    │   │ filter: x <= 4
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x > 1
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysmG-Pm0YQxt_3U6B51aog2F3-S5WujR3V0sWX2q7aqj1FnFlfrXDgAlbsO_m7V5jWGDYe2BXvYiDPzDz6PaPde4PinwRCmP7-8f7H2Vz7djJbrpa_3H-nLaf303cr7aC9Xzx80A7HV-23n6eLqXbQ_tpbFlv_oNnar_PZw7zvS64R7WExmS60n_7QDqBDmsV8Hr3wAsI_gYAOFHRgoIMNOjjwqMMuz9a8KLK8-uTt_B9m8QFCS4dtutuX1eNHHdZZziF8g3JbJhxCWEVPCV_wKOa5aYEOMS-jbXIuczi-3h2Or592n_kRdHiXJfuXtAjP_Sx3UfVPw6TweNIh25dNiaKMnjmE5Kqn2QRC66QPb-v9Nil5znPTafdUPw-1O3IxKgzD2Xzl3-yDdvpwZPq4toeM6w_r9EXUDCI9DlXQ9Vlkd1uR8miyLcptui5N2jHojtys6HQqUqnhm4rO4Iput-LtGZtC-zTLY57zuFXm8YT1xIa74HV6YlIuLLO85LnJSLfe9zcL-t2CpFWQSIRBOgsmNUw2eFtINXYJgzv6tnCVDRrbIWFfqFlEejxS2hdSLjXpFcgdvi-khm8quur7oj0jHU4ClQeBGaY9OCpUprELB97oUfFUDSJjOyRERc0i0uORUlSkXGrApepRkRq-qeipR6U9IxtOApMHwTZMZ3BUmExjFw780aPiqxpExnZIiIqaRaTHI6WoSLnUgMvUoyI1fFPRV49Ke0Z7OAm2PAiOMTgotkxbFwqC0YMSqNpDxvVHiImaQaTHIaWYSHnUQGurx0Rq-KZioB6TQOZitODFLksL3rm0fb2U1SllkOp2x-NnXl8Fi2yfr_nHPFufv61_PpyFzg9iXpT1W1L_mKX_vyrKnEcvl799XCsRVMm5rVRfza-lKCrFbksJSgxVspGmhPlsVMptSZFrKSpIOcpSwoAuKuXdHpAJXXm461SCBR-VChDbu0oBzifCQn2DaxHaAztCu6iF404Qt4gwJMGBx4AQtXDkMS1xSJx5goSaClo49ASDwhPEcOwJwr2ohXNPfKQxcUqcfMx9UQtnH9MShqQ4-hRBnwlaOPoUW_W-IIajT5GAi1o4-hRb9-KU6vte1FJf-OKQOPoUQd8WtHpWPkJFfURrieHoUyTgohaOPrOQxoQpGc4-5r6ohbOPaQXVIWyTZF8-bWMIwbeegji2NoYb2a5hRxY3njzHM9xNHHj-E49ZXJ32Nkn0XFQnweXf2Zez7uq4q85xmygpuA4fos98wkuev2zT6lS6_u_N6fTNvwEAAP__ThD_RQ==

# UNION ALL with swapped column orders.
query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• union all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysllFPo0oUx9_vpyDn6d5kSBkGaMuTRr1Jk9q6tptssmkMloNLpAzL0Fg0_e4b6K5akFk86SMd_M1v_v-TkRdQPxPw4erbzfR8MjP-vZwslosv0_-MxdX06mJp7JhRGv_fzq-NXflsfJ1N5jPjfDr9s1wyY_e6DAxSGeIs2KAC_ztwYGADAwEMHGDgwopBlss1KiXz6pWX-g8m4Q58i0GcZtui-nnFYC1zBP8FirhIEHxYBvcJ3mIQYj6wgEGIRRAn9Ta78vlsVz7fZY9YAoMLmWw3qfJrdWCwyILqyRxUKvNt4RtnNjvjsNozkNvibUtVBA8IPn_nOLkE39ozmqZL1ewysxtmbqfZm5DCPA4SY5vKPMQcwyOn1f6DI8ykKbMBtxpvfqxkNZR4d1pvO3xexu0lI5oyxwHx_tVxSnUD2xwI2oxxqqhHF-07ZV6n2wmmjNOm7Dgvu39eNikvYQ4cWrE2VXRIF-1b7LDT7QTF2rRij_MS_fMSpLwcs76lCcUKquiILtq32FGn2wmKFbRij_Ny-uflkPJyTVqtDlVzTNXsW-q40-wEpTq0Up3PfBrdospkqpC0lckrewwf8HBiJbf5Gm9yua7fPTzOa1D9Q4iqOKzah4dJWi_xaoccg83rf933JE4lWU2SrSUJjVMLJbQo7h2xLK2Vo0V53VaiSXKpJLtJ8shJteobalHjbpTbJI2oJKdJGpOP10qK6weda-Zz2GLpR13H8los-rC35or_Zdrdbti4xdKPu441arH0A687o1PdXFEin-7iEHwQQRS5oSfMkUDLdHB4b448zzJtF4ej6N6OwqD6RIiS4EFV1-fih3yqucsyqy6_KEgUMrgOHvESC8w3cRqrIl7_Xtnv__kVAAD__yNYJmI=

# UNION ALL and UNION with different ORDER BY types.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• union all
│
├── • sort
│   │ order: +x
│   │
│   └── • scan
│         missing stats
│         table: xyz@xyz_pkey
│         spans: FULL SCAN
│
└── • sort
    │ order: +x
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysl19vqkgYxu_3U5D3qs0OwRkG-XPVbnUTE6tddZPdbExDZdo1RfEApmLjdz9BPafKHN4Mo3dF6PM-_OY3AT4h-xZDAN1_nvr3vYFx0-mNJ-O_-rfGzbjb7z5MjI3x52j4aGyKrTEcdboj449_jeLW-HvQGw6M-34fvXB7-_X3Bggsk0gMwoXIIPgPKBBgQMAGAhwIODAlsEqTmciyJC0v-dz_Qy_aQNAiMF-u1nn585TALEkFBJ-Qz_NYQACT8CUWIxFGIrVaQCASeTiP92M2xfZuU2yfV--iAAIPSbxeLLPA2BBjCwTGq7A8Mi0G0x2BZJ1_Tcny8E1AQE9q9ToQtHZEvdk4SXORWs55qTv6OxAYrvPAuKO1g1llsNNk8CkSqs6kUGNiV6pRHShUiwqvjq7H8jUxSSORikieN939ot8gMZOVxc6p1fVpVfqwehQX9nGU-jjVPud8aANtdHaSxUzLVt5LtEm3ozbta-yltjYUdSqFKhVpN-lgoVpcpN1UD-ZCe6nebjpHwdQXimnZa5sWV7aXNel2XCb3Gva6ulCoOpVClYpkrw4WqsVFsrcezIX2Mj17z1HY6gtla9nLTctRttdu0u24TN417PV0oVB1KoUqFcleHSxUi4tkbz2YC-219ew9R8HVF4pr2euYyu7yJs2Oi-Rfw11fFwlVZ1KoMZHM1YFCtahI5tZjudBcrmcub_I5MhLZKllmQmuUScv2InoTh7vNknU6E09pMttfezgc7oP2P0Qiyw9n6eGgt_xxKstTES5-fmKeJlE0iZ8l0dOkw6vkaRRDo-z6Uk41ydYuJd0fR6Oc-igmRTloFGs3oN5Go9z6JAm6i5vQQljZ1SwPzfLrW7WrSb5-KyYZisuOLaFEi-K6U1Z_j3Iv3HeKFKOS8RRXnvL6Yq6UhTuPFuNSGG49Rl8mhmtPEe8lVykuPsMUk4nh5lNEfU_Kwt1Hi0n7iOm7LxFjuPsMcV-yguHuM0wxXwrD3WeI-3IW7j5aTFpKpu8-L5_dr3Hy8TyPIIC2_eL7EY_MF891TO7NqOm5nJuu7zPmhRFjs_Iz9TUO37LyBWL8f_Kxz50Uq_Lx_xrGmSDwGL6LjshFupgv51k-nx3P7Ha_fQ8AAP__omqOJQ==

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • union
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJycl19v4jgUxd_3U0T3qdU6InackOSpu4WVkFroAiPNaISqQEwHNSRMHFSg4ruPEmYmxZ5Ysd_IH845996fsXkH_j2FCIafnx7-GY2tm8FoNp_9_3Br3cyGD8P7uXWw_ptOHq3D8WRNpoPh1Pr3i3W8tT6NR5Ox8qXTbfP5AAiyPGHjeMs4RF8BAwICCFxAQAGBBwsEuyJfMc7zonrlvf7CKDlA5CDYZLt9Wd1eIFjlBYPoHcpNmTKIYB4vUzZlccKKngMIElbGm7S2ORxPd4fj6Xn3yo6A4D5P99uMR9YBWSdAMNvF1ZXdq6JM9mVk3WFYnBHk-7Lx42X8wiDCHwKOBhA5Z2SW0euc8aibkQgZPZ2Mgw0vN9mq7GGhiwpDVzDEWl1pHL3OjlR0bK-xMdpneZGwgiVXNouzKhPp3gVPyES0ujDLi5IVPYJFv79bDX3REF8Z4u4wYpMF0yN2zzVYMsYpfZMl0zWluGh8nZQNwtL4ui8arb40jr75ormukXSfBDHixbV71IAXYpqyb8RLx5QiL32dlM30iDkvWn1pHPvmvFzX6HafhGvEC7XrXVKXF9c0ZWDES8eUIi-BTspmeq45L1p9aRwDc16ua6TdJ0GNePFsA1qoacbQiJZOGUVWQp2MzeSoOStaXWkcQ3NWQp3D0pTxXZ5xJhzk_mzlCFY2rk58LHlhl-Mhz_fFij0V-ap-93I5qYXqGwnj5eWpe7kYZb8e8bJg8fb3GfujElYqkXYlR1QiSiV6pYQ_KmFJyjWWkuqjSimvvT4ipfLUrdLpla-UCtuVfFGpr1QK2pWwqBQYN12SCo2lpPqwGnWsYL0vaalhx4oJEknLHHdZy5x3uUY18LjfXmMgaamJx367litpqZFX1ShrqaFXack1qrEnuL3GUNJSc0-cdi0q_ZqquVfVKGupuVdphdUetE7zt-dNAhGENAidhBCbxA6xKWaeHTOf2R5dL1dJsKRLp_pnuU7jF15thLNv-VutOz_uqm1sHaecIXiMX9mAlazYbrJqU179fHI-__UjAAD__7uxbHk=

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• union all
│
├── • sort
│   │ order: +x
│   │
│   └── • scan
│         missing stats
│         table: xyz@xyz_pkey
│         spans: FULL SCAN
│
└── • sort
    │ order: +x
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJysl11v-jYUxu_3KaJz1WqOwnEcXnLVrjAJiUIHTNo0oSolpkMNmCVBBSq--xRgK8T_HCWGy7zwnCc__yySL0j-icCHzh8vvcdu37prd0fj0W-9e-tu1Ol1nsbWxvp1OHi2NtudNRi2O0Prlz-t7b31e7876FuPvR59I7N299-HG2CwVKHsBwuZgP8XIDDgwMAFBgIYeDBhsIrVVCaJirNbvg4_6IYb8GsM5svVOs1OTxhMVSzB_4J0nkYSfBgHb5EcyiCUsVMDBqFMg3l0GLPZ7h42293r6kNugcGTitaLZeJbG3ZoCAxGqyA7YTscJnsGap1-D0rS4F2Cj2fNum3wa3tWvtxIxamMHe-y1wP-DAwG69S3HrBwMM8N9qoMPqeCFbCUY-LmqqEJFDSiIvKji7F8T1RxKGMZ6vMm-x_06ytbrRx-Sa2oTy3XhxejuLKPV6qPl-9zyQcraGO4mRxuO27p7YRV6p3Mqd9iO9WNuVQAU5aKtqFMsKARF21DFYO5UmA021CXKHj5heKmAru2I0oLzKvUO61U4xYCN0y5YAUwZaloAptgQSMumsDFYK4UmJsJfInCLb9QrqnAwna80gK7VeqdVqp5C4GbplywApiyVDSBTbCgERdN4GIwVwrsmgl8iUKUXyhhKrBnl9ZXVCl3WqfWLfRtmVLBCljKMdHkNYGCRlQ0eYuxXCmvMJNXVPk0GcpkpZaJNBplY9Zehu_y-LSJWsdT-RKr6eHe4-HgEHQ4EcokPV7F40F3-d-lJI1lsPj_c_M8CckkcZGE50nHd8rzKE5GucWlvHySa1xKez5BRnnFUVyL8sgoXq9AvU5GNYqTNOgN2oQawcrNZzXJrFZxq3o-qWXeimuG0rJTS6jRQlp35MXPqPeifUeiGGrGI608iuJiDS2Ldp4sJrQw2nqKvk6M1h4J7zVXkRafU4rpxGjzkVC_qWXR7pPFtH3Ezd3XiHHafU64r1nBafc5pVhLC6Pd54T7ehbtPllMW0pu7r7I_rtnkfp8nYfgQ33qyll9KuzGLPRs4fI3uxkETTvEWtB6mzUDMcteEmZR8J5kLxCjv9XnIXe8XWV__7MgSiSD5-BDtmUq48V8OU_S-fR0Zb__6d8AAAD__78hlCs=

# Only one distinct processor should be used in the single node UNION case.
query T
EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)
----
distribution: local
vectorized: true
·
• union
│ estimated row count: 4
│
├── • values
│     size: 1 column, 2 rows
│
└── • values
      size: 1 column, 2 rows
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyskVFr2zAUhd_3K8R9ikGmkhtnnZ_WkT4YsrRb2jIYZqjSdWrqSJ4k043g_z4kj3QO61jHHnXu5TvnHu3BfW2hgItPV6vzck1my3JzvfmwSsjt-ermYkNmPKFkliXkZl1erg9qFtTTBChoo3Atduig-AwcKgqdNRKdMzZI-7hQqm9QMAqN7nof5IqCNBah2INvfItQwK1oe3QnDCgo9KJpI3FO3pFZRuR9rx9cAtVAwfT-ieK82GJkH2zLJRRsoC925v_FmT_r_GTYa2MVWlQTx2r4TbZl43yjpT_Jpune8mcT8aNE2Uu6-IiuM9rhUbK_uz3l4QRUWxzvdaa3Eq-skXF3fF5GUBQUOj9Os_FR6jjiwcGi2B0K_ZXE_5XEjknZH0mnExKbkioKdWsevzQKClBzdlbfsTzlC7xL5yyX6Zsc8_R1fbZgC6xlzkKhdSu2LpS9uTePEXv9vQtV1aJ1SOG9eMAlerS7Rodvlz8nw_DqRwAAAP__-BssLw==

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • intersect all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl11vo0YUhu_7K9C5SlSQmWEGG6RK2W5c1ZI33tq-aFVZK2LGsbWOoYC1cSL_9wqSNIExpxwSkTt_wDMvM--jGR4g_WcLPgz__Dr-NLoyzi5Hs_nsj_G5cTYbjoef58bB-G06-WLcHe7PjdHVfDid5b9-Go9PXjGZXg6nxq9_GQcwYReF6iq4VSn4fwMDEziY4IAJAkyQsDAhTqKlStMoyS95KG4YhXfg2yZsdvE-y39emLCMEgX-A2SbbKvAh3lwvVVTFYQq6dlgQqiyYLMthrk73F_cHe6_xd9VHuFztN3f7lK_yDOLg_yj1eOwOJoQ7bOnIV7I1wdjHaTrMvOCweK4MCHNghsFPnuVe3QJvn0020WXnUfnleiyNvoLd7-LklAlKiyRF_md_3fJief_PUjXM5VN4h6rrNz8ECu_XDEwYatW2dkFO_8l2dysi09gwmSf-UbxaK-n4uUxncpjMtISzaIkU0mPyepU_lw7oKgO2GRiT83Z0ygnUl1FVhT3uF1dhZN5ZCUPL08Aa95RRu5oj1s9510FY23Dux8QvqqYWxu-A8VYd4qRFulZMfcNipUnljdvBae3wrF64l0rzduG739A-Gql-7XhO6g0767SpEV6rnT_DZUuT6zTvBUOvRXC6sl3rbTTNvzgA8JXKz2oDd9BpZ3uKk1apOdKD95Q6fLEiuatEPRWSOtdCy3aRvc6j16ts1cbvYM6i-7qTFqi5zp7b6izR3mRmKo0jnapanRktytDWSyfZhXeqMdlS6N9slRfk2hZXPv4dVKAiuqGKs0e_-WPX0a74i-ej5Co4Pa_973mpH49iRFRjNWzOJUl61kOleXVs4TGYoSJZ69RNo3UrycxIqoy8SUWp7JkPcuhsrx6ltBYvMqyX7OcEsouNV5DOShK1KeSWh0EiuKsPpaWSrZV2qWRMKWJKFRpKgtTmsrClNZYblulGY2EKU1EoUpTWZjSVBamtMbqo_IMEKU11KC10lodvLYe9mkkzEMiCvWQysI8pLIwDzUWoxxqypUnojATqSxURTIMc5EMw2TUYdpmXVKIcURHHYbv1piPei207bqpkAMiCjOSykKVJMMwJ8kwTEodpp1wmkrpEFGYlFQWKiUZhklJhmFS6jDtnFOW0kWk1GHa3t1YSr0W2t7dVEqPiMKkpLJQKckwTEoyDJNSh2nHnaZSCiIKk5LKQqUkwzApyTBMSh2mHXrKL302IqUG49oe3lhK77gwYbWNfnzbhOCDHMhAKtG3VsqWlhDO0vJcJSxPBCt5vVrZ0nUhvyG4ScF_gNk6-lFw54dYpeCvgm2qTPgSfFeXKlPJ7Wa3SbPN8umf4_GnfwMAAP__9SQixQ==

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • intersect
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mV9v4kYbxe_fT4HmKtFrBDPjP9hSpWw3qYqUTbbARasqWjkwSdASTG2jDYny3SvIpg7zxMd-MOQuYDjzm-Pxz4zzJLJ_ZiISZ39-Pf_Uv2gdnfaHo-Ef58eto-HZ-dnnUWvV-m1w-aX1sHo8bvUvRmeD4frd945eDk7PBq1f_2qthCPmycRcxPcmE9HfQgpHKOEILRzhCkd44soRizQZmyxL0vVHnjZf6E8eRNR1xHS-WObrt68cMU5SI6InkU_zmRGRGMXXMzMw8cSkna5wxMTk8XS2GeZh9XjysHr8tvhu1gifk9nyfp5FG57hIl7_2e4ocfXsiGSZF0NkeXxrRCTfMPVPRdR9dnbD8vaKpSwsj4N1Os3y6Xycd6TV1Ym0Biy-c71q3cXZ3TufL6C0BSVZZRVU3l6pXJuqvKsieDlP0olJzWQrehNbyq2q2iyYPItJlTfVkKmqy4LJt5ma9OTshP17nN0NTX656Giry9FqYaI3qvl0fi4cMTM3-dGJPP4lnd7ebf4Sjrhc5lELzDOw5qlZq3SYpLlJO5r0-v_SAXv2gHWKfa-zn6O8Q3WRtJNFx-3aZ-FdntDicbcLkPWdJtlO66h2R9eWrdwVzN8zmK1bnwNWiE0eVresugoq_7C6Le-qodqq2gS6LW-qIVNVl0C3TXpqrFv5cbplrdJX3ZJeGbrdLlbVt4jiW0S3O25tvaldwYI9g9l6CzhghUjUYfXGqqugCg6rt_KuGqqkqk2gt_KmGjJVdQn01qSnxnpTH6c31ip91RvplaG37WJ1fYtovkXcdserrTe9K1hvz2C23nocsEIk-rB6Y9VVUPUOq7fyrhqqpKpNoLfyphoyVXUJ9Nakp8Z60x-nN9YqfdUb6ZWht-1i3foWcfkW8dq15ebuihXuFctWW8jBKiTiHlZtrLIKqvCwaivvqqFGqtoEaitvqiFTVZdAbU16aqw29-PUxlqlr2ojvTLUFnIePA5Mtkjmman1iK9rDdWW65rN5Na8nLYsWaZj8zVNxpvPvry83ARt3piYLH85ql9e9Oevh7I8NfH9f_9zeJskYZIqT-raScpOkm-T3K0k-TZJMqOkBllkgjhLyfIsxeRSIchicumgPEsTLg2zPBBFsHCUBKfRZWIpBbKYXLpbnuUxuXQPZBEuF14_fnmUT7A8RpTaipJ2lA-jgvKrOiBUAYwCXQWkqx6MciVDNiGMksBbPjEglqkEWKR3SXRaW4LcLGhBOkkcBjXIJYMe5JJBEVIybFVkQgpWcRdCKuSCQRdyyaAMuWTQhpSMqHX7WgInwFckDLvVCts2oiZh2K7SB06knWG_IinSyrBgVReAkSxsWBmWZ9H2iWJrq4ybBVVGJ4nDoMq4ZFBlXDKoMkKmyG2ptsoIWEUWVBkXDKqMSwZVxiWDKqNkFTsjsGZ9l4QRyaKwbZXRnQOWrHKBMWhnWLJIZbQy7FjVKwfrkSysWAV-wxL3K6LY2irjZkGV0UniMKgyLhlUGZcMqoySkdtSbZVRMJwFVcYFgyrjkkGVccmgyigZ3i1psMx88ntFVzx7kkBlxBgaS1aDfVxAOtNYskhlpDKNHavBz8WQZGHFaq88i9xINFFsbZVxs6DK6CRxGFQZlwyqjEsGVUbJyG2ptsooGM6CKuOCQZVxyaDKuGRQZZQM75Y0WBk-vcjxdskK21YZJcOSddE-jnTmYskilYXPV464mSU_vk0nIhLjm7jbGxu3HYxV0Ha9MGzHpue3lT-ZjLs3sdLXSqy_EN9mInoSw7vkxyZ3tFqYTEQ38SwzjvgSfzenJjfp_XQ-zfLp-OeR5-f__RsAAP__0ZZzxA==

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1vo0YUhu_7K9C5SqRBZviyQaqU7cZVLXnjre2LVpW1mphxbC0xlMHakMj_vYKsmsAsZzkoInfGwMM7c95HmidQ_8YQwvSvz_MPsxvj4nq2Wq_-nF8aF6vpfPpxbRTG78vFJ-OheDQWy-vp0vjtb6O4NGY36-lyVT7wYT7_ycPA4JhE8kbcSwXhP8CBgQ0MHGDgAgMPNgzSLNlKpZKsfOSpemEWPUBoMTgc01Ne_r1hsE0yCeET5Ic8lhDCWtzGcilFJLORBQwimYtDXH3moXi8eigev6RfZQEMPibx6f6oQqO8WKWi_GmObNicGSSn_PsnXsi3hbEXal9nXnHYnDcMVC7uJIT8Ve7ZNYTWmfWL7g0e3W5E91qjv3BPxySLZCajGnlTvvmzR36w_j-E2q9kvkhHvDG5dZHKsF4xYBDLXX5xxS9_zQ53--oXMFic8tColvZ6K16W6TSWydtH1GsRN4mZpCPuNXfkh2HcZpj6pvPufeHkvoxsc-S8adl53_D-O4Rv1t1vDT9A3flwda8Pye4-JJs-JMccuW_aMLtv-PE7hG82bNwafoCG2cM1rD4kp_uQHPqQXHPkvWnDnL7hJ-8QvtmwSWv4ARrmDNew-pDc7kNy6UPyzDftl9s3ejB49Ga7gtboA7TLHa5dLuXMvpQqTY5KdjruWY1PmbxctYzu5PMuquSUbeXnLNlWzz5fLipQ1aRIqvz5rv18MTtWt-zyC5kU9_-f27uT_HYSJ6KCdpRNRHFkgQ6V5bWzXI3FCfvOX6MsGslvJ3EiKmhH2UQURxboUFleO8vVWHaTZb1mOe0oT0M5KIrXd95CZ-j2tdCnkTALiSjMQiIKtZDKwizUWF5fCzmNhFlIRGEWElGohVQWZqHG8ntbqKHGfdUZ00iYOkQUpg4RhapDZWHqaKxJX3VsGglTh4jC1CGiUHWoLEwdjRX0VkdD8d6HvwkRhclDZWH2UFmoPmQY5o8O630CdIgozCAqC1OIykIdIsMwiXRY_2OgztLOgV0tCogozCIqC7OIykItIsMwi3QY5eRcLwURhVlEZWEWUVmoRWQYZpEO046EnS1yzxsGuzj59uUQQQgTKRzPF7emGFu-6QYiMANv65rCcqLdTvr22PegfEHcKQifYLVPvlXcdZFKBeFOxEoy-CS-ymuZy-z-cDyo_LD9fud8_uW_AAAA__-RT_DL

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)
----
distribution: full
vectorized: true
·
• intersect
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFFv4kYUhd_7K6x52pWMYGZsA5Yq7XaTqkjZZAs8tKqilYOHBC3B1DbakCj_vYK0dTx3feyLIW8BzPE3J9zPHj-J7O-lCMX5H18uPo4unXdno8l08vvFe-fd5Pzi_NPU2Tq_jq8-Ow_bR-dqfHY-dn7509m-d0aX0_PxZHcAPlC4YpXE5jK6N5kI_xJSuEIJV2jhCk-4whfXrlinycxkWZLuDnnaf2EUP4iw54rFar3Jd29fu2KWpEaETyJf5EsjQjGNbpZmbKLYpN2ecEVs8mix3J_mYfv44WH7-HX9zWyFKz4ly839Kgud3YvJOtr92ekqcf3simSTF6fI8ujWiFC-YhqdibD37B6G5R8VS1lYPgfrbJHli9Us70qrqw_SOmHxnZutcxdldz84voDSFpRklVVQ-Uel8myq6q6K4M0qSWOTmrgUvY-t5FZ1bRZMvsWkqptqyVTXZcEU2ExtenIPwv4tyu4mJr9ad7XV5XS7NuEr1Xy8uBCuWJp5_u6DfP9zuri92_8lXHG1yUMHrLNvrVMfufvLpJOsu9q3G_khzMCGKZcum_tFsv3SVZ2ubiw-eShYcGQwW30BB6yQjDyt-lh1FVTBadVX3VVLzdS1CdRX3VRLprougfra9NRaffLt1FfuXjUfasUfat3peo1tow4F6x8ZzLZNnwNWzLU6rW1YdRVU_dPaprqrlpNd1yawTXVTLZnqugS2adNTa9uot7NNuXvdfKg1f6i9TtdvbBt9KNjgyGC2bQYcsGKu9Wltw6qroBqc1jbVXbWc7Lo2gW2qm2rJVNclsE2bnlrbRr-dbcrde82H2uMPtd9p7BrvUKzhUbFs0ww5WMVMe6c1Dausgmp4WtNUd9VyquvaBKapbqolU12XwDRtemptGu_tTONxHnOOTbZOVplp9HioZ52qI3erNvGteWkxSzbpzHxJk9n-2JeXV_ug_RuxyfKXT_XLi9Hqv4-yPDXR_f_Pjl8nSZikqpN6dpKyk-TrJK-UJF8nSWaUVCCLLLAma1idpZhcKgBZTC6tq7M04dIwywdRBAtHSYDlMbFUD2QxuVS_OstncmnwU_UJlwfnB_wiAoLlM6JUKUraUQGMAmX1CVUfqyZgGGIAo6SsjgrsqCGO6lVHka4kkWljcXGzoLnIGuvCkLq4ZNBdXDIoL0pGLkGN7UXBcBbUFxcM-otLBgXGJYMGo2TkSlSeJRAWKBJG3IrCyhbTJAzLFWmMVobtKgfVxuiTLKxX2a_OooURvza2DzcL2ocusiYM2YdLBu3DJYP2oWTkotTYPhQMZ0H7cMGgfbhk0D5cMmgfSoav5EoC-3jknhrvi6ywsn3oDTreGiH7kMoUdqzyq40xIFlYscqrziKGVcSwje3DzYL2oYusCUP24ZJB-3DJoH0oGbkqNbYPBcNZ0D5cMGgfLhm0D5cM2oeS4Su5GgD7kBsphbdKVljZPsSLCm-WkH1oZdixGjzlGZK9c82jJ7CJI7rW-DYW2YebBe1DF1kThuzDJYP24ZJB-1Ay_AwK2YeC1TxnQ_bhgkH7cMmgfbhk0D6UDF_JNfgHBERlGm-WrLCyfSgZ3i0h-3jP166YL5PvXxexCMVwrsxQ66jjzWKv483jm86wP4w787nnq4FURqmZ2H0hus1E-CQmd8n3fe50uzaZCOfRMjOu-Bx9M2cmN-n9YrXI8sXs30-en3_6JwAA___V3kOx

# INTERSECT ALL and INTERSECT with no overlap.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect all
    │
    ├── • filter
    │   │ filter: x < 2
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 2
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9v2lgTxu_fT2HNVaLXFpxz_AdbqpRuQ1WkNOkC0u5qF1UOHBJUB7O2USER330FNAn2xIPHIeQuYPvn4Zl5non9AOm_EQTQ_vPbxcfOpXFy3un1e79fnBonvfZF-1PfWBifu1dfjcXy3vjjS7vbNhbGP_NmUw0NeWp0Lvvtbm992seLi72X6A_ra6665-2u8dtfxgJMmMYjfRne6RSCv0GACRJMUGCCDSY4MDBhlsRDnaZxsj7lYXNBZ7SAoGnCZDqbZ-uvByYM40RD8ADZJIs0BNAPryPd1eFIJ40mmDDSWTiJNrdZLO_PFsv777MfegkmfIqj-d00DTb19Gbh-k-rIWGwMiGeZ8-3SLPwRkMgdmrqnEPQXJnVy_o8iTKd6KTh5Gvafh8YZ-JZqiAIOpf9VqGQZ9b10rgN09s86EzAYPVcrCwU63CK3dVQHFZEVahL1FNR7JFxeBgV7WK15TI-g-fTOBnpRI9y6MH6yn2nvPCTv4TpbU9nV7OGLHSiv5zpIO9EMCHS4-zkTJx-SCY3t5u_wISrebbWprQrTuF3SlZXenGS6aQhnaKW_y-9oVu8YRVhX9Ls111eqOoytuJZQzWLXXixHq9Qj8oLIBh-YdulIa2Gqpw6glPYk1_c90kdt7aKh5YR5U49HcUeId8qd8qFPELuiOPlDqsrj7njviJ38sLK6hMq-QOqrIZd2eeSU9jTfHrv43Ovrori0DIin9fTUewR8q18Xi7kEXwuj-dzVlcefe69wud5YVX1CVX8AbWthlPZ54pT2NN8tt7H5626KopDy4h8Xk9HsUfIt_J5uZBH8Lk6ns9ZXXn0eesVPs8La1efUJs_oI5V2eU2p6yn6fTfx-V-XQ3FYUVEHq-notgj41t5vFzGI3jcPp7HWV159Lj_Co_7nJcTXZ3O4mmqK70GaBZuZYm1zHp0o7dtS-N5MtTfkni4OXf78WoD2nwx0mm2PSq2HzrTx0Nplujw7um94S5JFElil2TnSHKXtH0dVR0lRDlLclleOUsxWVKVs2wuyy9nOYglySaq8iYikmI0UeSaiOaBRhWamGNJLssrZykmq9DEHMvmsvxyloNYNtlEp7yJLkI5JMotr8pFA-HSo8UJCI9EtcpJokhq1Y4al4cio4bLoqKGySKjhsuiogaxfHpfNIkxRQmIdk_lsEETsYdFpg0bRsUNF0bmDRtGBQ6GoRWU76Ukeolh9A6iMgcPBorVfGF2eWESsVCsVs4Kj8kiw4INo9KCCyPjgg2j8gLD6F0k3PJeYhZaRpUDA88FzSIDgw2jAoMLIwODDaMCA8PoDS6IFe5iGNpKlQMDDwa9lSSxlRT6X5qzlfKB0WKyyMBgw6jA4MLIwGDDqMDAMHorSWIrYRZaSpUDA88FzSIDgw2jAoMLIwODDaMCA8PoRS6JRe5iGP2ARAUGHgx6K0liK9mIxdlK-cDwmSwyMNgwKjC4MDIw2DAqMDCM3kqS2EqYxXmyzAcGngvWo2U-MNgwKjC4MDIw2DAqMDCMXuSKerxEMEW_26QCw18NTBhH8c_vkxEE4Nu-P7z2PGuswpFl-05oXWsprPFYjr2x7YnW5k3wOApvUggeoHcb_9xw-8uZTiEYh1GqTfga_tDnOtPJ3WQ6SbPJ8NeR1ep__wUAAP__NgvfHg==

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect
    │
    ├── • filter
    │   │ filter: x < 2
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 2
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy82V9v2kgbBfD791NYc9XqNYL5Y8CWKqXbUBUpTbqAtLvajSoCkwSVYNY2KiTKd19Bmhj8xMc8NuSuTcjhzCn5TRoeRPzvVASi8-e3s4_dc-fdabc_6P9-9t551--cdT4NnKXzuXfx1Vmu7p0_vnR6HWfp_LNoNPTIUe-d7vmg0-uvH1b0cPth_fiL3mmn5_z2l7MUrpiFY3s-vLOxCP4WUrhCCVdo4QojXOGJS1fMo3Bk4ziM1g952HxBd7wUQcMVk9l8kaw_fOmKURhZETyIZJJMrQjEYHg1tT07HNuo3hCuGNtkOJlunma5uj9Zru6_z3_YlXDFp3C6uJvFwaZPfz5c_7FWV-Ly0RXhIkmfIk6GN1YEcqtT91QEjUd3_1qfJ9PERjaqe7udnj4eOCcynSoIgu75oJ1bRGWKeJwi2_vIww6kM71kuYVkwUSj4oVMtglrotNJnExmo6SuMvucyMwzpl9ztXJuh_HtK49PW3mZVoq1T9rKO2irZrZV_lZp8GIWRmMb2fFO9CY2t7cuWjPt1Mp00vlLVexUtGXaqZ3tVGUnt1TtL8P4tm-Ti3ndZLYcrOY22BL549mZcMXUXifvTuT7D9Hk5nbzJ-GKi0Wy_l7KPaefOadhvUr7YZTYqG7Irv_Pd7WRfcZ9ln1ttF9P80qt87AWzuteI_vP8HqhrPTe7gSSISwb2Lqq1fXed5DkFHsRtnn4O6hZeqFDT0RuoXIbyYKRytxCrJFS7-VxbyHWPmmr5nFvofytKopftCa4hfKXqtipaEtwC1XZqfItJN_uFmK9Sp9vIbIr5xbaXVbtT5rii6ZrdbM3-opT7AW01uHRb5VdSB56IoJ-uY1kwUhl0GeNlPKqjos-a5-0Veu46OdvVRHYojUB-vlLVexUtCVAv8pOldFXb4c-61X6jD7ZlYP-7rJ6f9I0XzRTq3t7o685xV5Aax8e_XbZheShJyLol9tIFoxUBn3WSCmv-rjos_ZJW7WPi37-VhWBLVoToJ-_VMVORVsC9KvsVBl9_Xbos16lz-iTXTno7y5r9ifN8EXzanuTbzi1XjjzD0--X3YfediBCPjlFpIFE5UBnzVRSqs5LvisfdJW_nHBz9-qIq5FawLw85eq2KloSwB-lZ0qg2_eDnzWq_QZfLIrB3yf85ZGz8bzcBbbvd47yD5VTa53tuMb-_TvFoeLaGS_ReFo89inv15sgjYfGNs4efqsfPpLd_b8qTiJ7PDu5Z3n7SQJk7z8pKc3RrejFIzS-VEkScMkA0qR85lslNyOau5Eye0oxYySLZBFToizFMjSzF4aZTF7GZBlSC8PZqEoUgtHyXZ-lsespVAWs5cGWU1mL4OySK8m_AYCUS1Sq8WIUjtRMhvVhlF-_rd1m7TyMYCN_BO2yVgSa-qxOMWeSgXsIlkYVNkEWU0Shk2VAFWaRZTYzUK3Bj0lft0joblZkGh6ygIokKvcZhBpbjOoNG1GrNibaVoMZ0GnucUg1NxmUGpuM0g1bYaBlT7AWpEwTGwmbJdrTcIwsqoBwCabqYIfWZHYZDOFlVVAWTKZwsoqpGyLhGFlFVCWZmFlFVKWnrK8stwsqCw9ZQVluc2gstxmUFnarLyytFgFZbnFoLLcZlBZbjOoLG2GlVVIWUPCsLIKKUv_14yV1UhZspmuoCzZTGNlNVCW3CW64JcDSNk2CcPKaqAszcLKaqQsPWV5ZblZUFl6ygrKcptBZbnNoLK0WXllabEKynKLQWW5zaCy3GZQWdoMK6uRsuSHPI2V1UhZahlW1iBlyWamgrJkM4OVNUBZcjEZrKxByvokrOC3sEBZmoWVNUhZesryynKzoLL0lBWU5TaDynKbQWVps_LK0mIVlOUWg8pym0Fluc2gsrQZVtYgZSk_WFmDlKXNsLIeUpZs5lVQ1n-8dMX1NPz5fTIWgbC-p_2xtjU9ujY1o5Ws-UPt166M8cae326MroxYf8HwJhbBg-jfhj83uYPV3MYiuB5OY-uKr8Mf9tQmNrqbzCZxMhn9-szj4__-CwAA__9t5i7y

# INTERSECT ALL and INTERSECT with some overlap.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • intersect all
    │
    ├── • filter
    │   │ filter: x < 3
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 1
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9v2lgTh-_fT2HNVaLXFpxzbIMtVUq3oSpSmnQBaXe1iyrHPiSoBLO2USER330FNCT2xIPHCeSu_Hs8-c2cZ2o_QPrvBHzo_Pnt4mP30jg57_YH_d8vTo2Tfuei82lgLI3PvauvxmJ5b_zxpdPrGAvjn3mzqUJDnRrdy0Gn119_7ePFxd6f6A-GODWueuednvHbX8YSTJjGkb4M7nQK_t8gwAQJJigwwQYTHBiaMEviUKdpnKy_8rD5QTdagN80YTydzbP120MTwjjR4D9ANs4mGnwYBNcT3dNBpJNGE0yIdBaMJ5vLLJb3Z4vl_ffZD70u4VM8md9NU99YmJuS-rNg_cpqSBiuTIjn2dNV0iy40eCLZ2V1z8FvrszqlX0eTzKd6KTh5Mvavu8bZ-IpLd_3u5eDNphwNc9846xY0hP1emncBultHnkmYLh6KlsWynY4ZT8PVLx5oqpQmqgXqdiTaWiot43ULtZdnukTeD6Nk0gnOsqhh-tf7vvKC3_8lyC97evsataQhbYMljPt588omDDRo-zkTJx-SMY3t5t_7bIQpf1xCn-nZPWnHyeZThrSKWb5_9ILusULVgn2pcx-XeWFqi5jK541VLPYhRfraRXqUfkABOPw1Dk7DWk1VGUfCU5tu8PjvreP3NqRHiBTZKR6oYo9qR7eSOWpHsFI4nhGYvXn0UjuK4yUD1ZWH1dZa1qV1bArG0ByatsNa-u9DdCqG6k4QKbIAPVCFXtSPbwBylM9ggHk8QzA6s-jAVqvMEA-WFV9XFWtabWthlPZAIpT225Y2-9tgHbdSMUBMkUGqBeq2JPq4Q1QnuoRDKCOZwBWfx4N0H6FAfLB2tXH1a41rY5V-fzbnMp2o-q99_n36gYq3jxRdPrrRSr2ZHr401-e6RFOv32808_qz-Pp915x-j3OQ5CeTmfxNNWVHjc0C5eyxDpmHd3obdvSeJ6E-lsSh5vvbl9ebUCbNyKdZttPxfZFd_r4UZolOrjbPbZ8ThJFknhOsnMk-Zy0fexVHSVEOUtyWa1ylmKypCpn2VyWV85yEEuSTVTlTUQkxWiiyDURzQONKjQxx5JcVqucpZisQhNzLJvL8spZDmLZZBOd8ia6COWQKLe8KhcNhEuPFkcQLRLVLieJIqldWzUuD0WqhsuiVMNkkarhsijVIJZH74smMabIgGj3VJYNmog9LNI2bBilGy6M9A0bRgkHw9AKyvdSEr3EMHoHUc7Bg4G0mi_MLi9MIhbSamVXtJgsUhZsGGULLozUBRtG-QLD6F0k3PJeYhZaRpWFgeeCZpHCYMMoYXBhpDDYMEoYGEZvcEGscBfD0FaqLAw8GPRWksRWUuj_0pytlBdGm8kihcGGUcLgwkhhsGGUMDCM3kqS2EqYhZZSZWHguaBZpDDYMEoYXBgpDDaMEgaG0YtcEovcxTD6BokSBh4MeitJYivZiMXZSnlheEwWKQw2jBIGF0YKgw2jhIFh9FaSxFbCLM6dZV4YeC5Yt5Z5YbBhlDC4MFIYbBglDAyjF7mibi8RTNHPNilheKuhCaNJ_PP7OAIfotF16LVtZXnNpmPZIyeyAue6ZakouHbDULZHTgTrHwQ3KfgP0L-Nf264g-VMp-CPgkmqTfga_NDnOtPJ3Xg6TrNx-OuT1ep__wUAAP___yz_1A==

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • intersect
    │
    ├── • filter
    │   │ filter: x < 3
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 1
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mW1P20gbhb8_v8KaT0WPo2RenBdLlegWqiJR6JJIu6tdVLnJAFFDnLUdlRTx31cJBSe-8XFuT823QpLjMxfOdSi5F-m_MxGK4z8_n747OfPeHJ0MR8PfTw-8N8Pj0-P3I2_lfbg4_-TdrX54f3w8vjj27rx_lp2OHnv6wDs5Gx1fDNdPq3q6fevJA-_84uj4wvvtL28lfDGPJ_YsurWpCP8WUvhCCV9o4QsjfBGIS18sknhs0zRO1k-537zgZHInwo4vpvPFMlt_-9IX4zixIrwX2TSbWRGKUfR1Zi9sNLFJuyN8MbFZNJ1tLnO3-nF4t_rxZfHNriu8j2fL23kaenf-ptJwEa2_arWVuHzwRbzM8qukWXRtRSi3ap0cibDz4O_f7MN0ltnEJu1gt9bj90PvUOa0wjA8ORv1hS_Ol1noHZZXUoVKAafSNiz5y2npQjVZD5es4DX29P64TLETi9fRNM2m83HWVgVYh7Jwxfw1X1feTZTevPD8vFVQaKVYpPJWwS9t1S22KmeVBy_ncTKxiZ3sRG9iS3vrKpp5p16hky4n5dipimXeqV_s5MLJr1X7Y5TeDG12vmibAsvRamHDLVe_Oz0VvpjZq-zNoTx4m0yvbzb_en7vlJ9zUDinYd2lwzjJbNI2hOv_y3XbKV5xH7IvQft5mRdqncWteNEOOsUfw8uFigMQ7CKQDN3WsW1btdp673WSnG7Puu02uU7d2rga4EX2qR4wWUHMbZ9YxPIlkM3uE4tU3qrb7D6Vs3LcgiqaYJ_KSTl2qmIJ9smFk_M-ydfbJ9Zd-rRPhCtnn3bJqv39pmrpTbfaZu85UJxuz3brNTkHvbq4ZAO8yBzUAyYriLnNAYtYLl7V7BywSOWtes3OQTkrR_VW0QRzUE7KsVMVSzAHLpyc50C93hyw7tKnOSBcOXOwS1bv7zddS2-m1Q72ngPN6fZst36Tc9Cvi0s2wIvMQT1gsoKY2xywiOXi1c3OAYtU3qrf7ByUs3JUbxVNMAflpBw7VbEEc-DCyXkO9OvNAesufZoDwpUzB7tkzf5-M7X0FrT2HgPDafbstkGTYzCoC0v-clpkCurhkhW83KaAxSuXrml2Clik8laDZqegnJWjdqtogikoJ-XYqYolmAIXTs5TYF5vClh36dMUEK6cKRhwPjq5sOkinqd2r88oipdqyTVnO7m2jz-3NF4mY_s5iceb5z5-eb4J2nxjYtPs8VH5-MXJ_OmhNEtsdPv8wfd2koRJQXnS4wew21EKRunyKJKkYZIBpcj5TDFKbkd1d6LkdpRiRskeyCInxFkKZGlmL42ymL0MyDKkVwCzUBSphaNkvzwrYNZSKIvZS4OsLrOXQVmkVxe-gUBUj9TqMaLUTpQsRvVh1KD8bd0nrQZYgJ3yE_YJLIltGrB0in0qFXAXycJClV2Q1SVh2KkSSJVmEUvsZqHVoKfE9z0yNDcLKpqeskIUyKvcZlDS3GbQ0rQZccXemqbFcBb0NLcYFDW3GTQ1txlUNW2GBSsHQNaKhGHFFsJ2da1JGJas6gBhE2aq4ldWZGzCTGHLKmBZgkxhyypk2R4Jw5ZVwLI0C1tWIcvSU9a3LDcLWpae0sGy3GbQstxm0LK0WX3L0mIOluUWg5blNoOW5TaDlqXNsGUVsqwhYdiyClmW_q8ZW1YjyxJm2sGyhJnGltXAsmRLdMUfB5Bl-yQMW1YDy9IsbFmNLEtPWd-y3CxoWXpKB8tym0HLcptBy9Jm9S1LizlYllsMWpbbDFqW2wxaljbDltXIsuSXPI0tq5FlqcuwZQ2yLGFmHCxLmBlsWQMsS4bJYMsaZNkBCav4KyywLM3CljXIsvSU9S3LzYKWpad0sCy3GbQstxm0LG1W37K0mINlucWgZbnNoGW5zaBlaTNsWYMsS_WDLWuQZWkzbNkAWZYwCxwsO3i49MXVLP7-ZToRoQgmvU63J6OWVSpoGTsZt6KrwaD1dWJloLsTOe73xPoF0XUqwnsxvIm_b3JHq4VNRXgVzVLri0_RN3tkM5vcTufTNJuOfz7y8PC__wIAAP__mBtPuQ==

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl11v4jgUhu_3V0TnakZyBHY-gEgrMZp2tUhMO1u4WGmFRoa4BU1KsnHQkFb891XSTtvg5myOpx-XJs5jvz7nEc4t6H8TiOD076_TT5Mz58PJZDaf_TX96MxOp6ef586eOaXzx8X5F2df3jiTs_npxaz6_dN0-nNKyZz9wxRgsE1jdSavlYboH-DAQAADDxj4wCCABYMsT1dK6zSvptzWL0ziPUR9BptttiuqnxcMVmmuILqFYlMkCiKYy2WiLpSMVd7rA4NYFXKT1Mvsy5vxvrz5ln1XJTD4nCa7662O6u0Dg1kmq5Hbq7ZyvisiZyzYmMPiwCDdFfdLPq60LJ211OvmGmPOxgIWhwUDXcgrBRF_EmVyAlH_wOzSBLZpfjGAOAoQtAZ4RO-2aR6rXMUN-KJ68_-mPHMKf0q9nqniPOvxo5LOy0xFzY4DBom6LD7UQT7-nm-u1j8HD3W9z_j0WB7zekd5eXvFrNKcpW6a9XhwfDTPbsY_3kzz9Hn39uE27dMTbs97VR24bZ7QPs8LCxG2RngDIfg7CNGsmeheM2FVM8_t-a_ag8I2z8A-zwv34KA1whv0oHiHHmzWzOteM8-qZr5b__--Xg96tnmG9nleuAeHrRHeoAe9d-jBZs387jXzrWoWuK_agb5tmpFtmhfuv1FrgDfoP_8d-s-nfEpcKJ2lW606XTv7R0u5vIqv4it1d5w63eUr9TVPV_Xcu-F5DaobK1a6uHsq7gaTbf1IVCvkSl4_fEh0J4XtJE5EjdpRgojiSECPygraWb7B4oRz509RfRopbCdxImrUjhJEFEcCelRW0M7yDZY4ZvWfsrx2VGCgPBTFmyffR2vo21oY0kiYhUQUZiERhVpIZWEWGqzA1kJOI2EWElGYhUQUaiGVhVlosEJrCw3UwFadAY2EqUNEYeoQUag6VBamjsEa2qojaCRMHSIKU4eIQtWhsjB1DNbIWh0Dxa0vf0MiCpOHysLsobJQfcgwzB8TZn0D9IgozCAqC1OIykIdIsMwiUyY_TXQZBn3wK4WjYgozCIqC7OIykItIsMwi0wY5ebcbAoiCrOIysIsorJQi8gwzCITZlwJO1vkHxYMLpP0x7dNDBGMvDiQy1C5QTgYuL4MAncZyNAVy-Uw5NyT_nIF1QvySkN0C7N1-qPmzstMaYguZaIVgy_yuzpRhcqvN9uNLjar-yeHw2__BQAA___ArBI7

query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• intersect
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9v2kgbxe_fT4Geq1YygpnxH7D0SqmarBYpTbqBi5VWUeXANEElmLWNCony3VeQNo79dA4z9i65NI6Pf3Oc-dkzj5T_vaCYzv78fP5hdNF5dzoaT8Z_nL_vjM_Ozz5OOhuvs-38dnX5qbPZPnRGF5Ozq_Hu9x-nt15n83KaPFqmM32R3Ouc4r9IkEeSPFLkkU8eBXTt0SpLpzrP02z3J4_7C0azDcV9j-bL1brY_Xzt0TTNNMWPVMyLhaaYJsnNQl_pZKazXp88mukimS_2t9lsH04224cvq296Sx59TBfr-2Ue79HJo_Eq2R11ezuUy3URd06kdyLo-smjdF2Ut8yL5FZTLF4xjk4p7j95zTCDppgmMlkjC1zITud5MV9Oi56o1XcivJP6PcvLbraduyS_-_UlJZqqoQmn1kq24D9g8-ts5t7K7PUyzWY607NK-j7WSC8tmi2xghqWNFfWEsui1BIrrGO1actrRP57kt-NdXG56qlao5PtSsevLPTh_Jw8Wuivxbv9qN7_P5vf3v08eJnvcMBRbcDqX34OF2k3XfVUUK_mlzCDOky1fWFvH9HEPj3Z7almmhRNQcPmoLaiDF3YShmJY4jSqbeSLTyGKM29tTSSRbNAlObKWmJZlApE2aat1qIUbyDK6nOQ9lNeNpryqtvzm7lJNgWNmoPauilyYSvnvzyGm5x6K9miY7jJ3FtLCVg0C9xkrqwllkWpwE1t2mrtJvkGbqo-B2U_5VWjKe9398u9Bm5STUEHzUFt3TRwYSvnvzqGm5x6K9kGx3CTubeWErBoFrjJXFlLLItSgZvatNXaTeoN3FR9Dr79lPcbTfmg28xMflPMYVNMWy8NXcjKue8fw0tOrZVsw2N4ydxbSwFYNAu8ZK6sJZZFqcBLbdpq7SX_Dbzku-zZXul8lS5zbbWt1a_dqit2w9ezW_1cZ56us6n-nKXT_d8-H17ug_Y_zHRePJ9Vzwej5c9TeZHp5P5lO_x1koBJ0pzUryfJepJ4neRXksTrJOEYJSTIYgM8kDU0Z0lHLhmCLEcupcxZinEpmBWAKIaFowTA8h2xZB9kOXLJyJwVOHIp8K8aMC4fzh_wHxEyrMAhSlaiRD0qhFGgrIhRRVg1oYMhBjBKCHNUWI8a4qi-OYp1JZhMrcXlmgXNxcZ4KAypy5UMusuVDMqLk7FXkLW9OBjOgvpyBYP-ciWDAnMlgwbjZOxNVJ1LICyULIy5FYVVLaZYGJYr0hivDNtVDMzGiFgW1quIzFm8MOZXa_u4ZkH78EEeCEP2cSWD9nElg_bhZOylZG0fDoazoH1cwaB9XMmgfVzJoH04GX6TSwHs47NvarwuqoVV7cM_0PHSCNmHVSaxY2VgNsaAZWHFSt-cxQwrmWGt7eOaBe3DB3kgDNnHlQzax5UM2oeTsbeStX04GM6C9nEFg_ZxJYP2cSWD9uFk-E0uB8A-7ENK4qVSLaxqH-ZFiRdLyD68MuxYBXZ5hmztfGDrCSzimK4V_oxF9nHNgvbhgzwQhuzjSgbt40oG7cPJ8B4Usg8HO7DPhuzjCgbt40oG7eNKBu3DyfCbXIEHEDKVKbxYqoVV7cPJ8GoJ2cd_uvbo6yL9_mU-o5hmoa8ieaO7fhhEXT8S_e6N7ofdRCe-nKqwfxMMaHdBcptT_Ejju_T7PneyXemc4q_JItcefUq-6VNd6Ox-vpznxXz648zT0__-CQAA__-Lb3DS

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l1Fv6jYUx9_3KaLz1GqOiJ0ESKRJvbtlGhK33AEPmyZ0lRJT0KUkS4IuoeK7T0nbtYmbsxy38FYa52ef4_9Pdh4g_WcDPgz-_Dr6NLwxLq6H09n0j9GlcTEdjAafZ8be-G0y_mLs84MxnlwPJsavfxn5pTG8mQ0m02LAp9EIHXy4fPl7Dwy2UShvgnuZgv83cGAggIENDBxg4MKcQZxEC5mmUVIMeShfGIZ78C0G6228y4p_zxksokSC_wDZOttI8GEW3G7kRAahTDoWMAhlFqw35TT7_HC1zw_f4u8yBwafo83ufpv6xp4ZB2AwjYPil9kpljLeZb5xxWF-ZBDtsqf5Xqa5zY1VkK6qE5Tj5wzSLLiT4PNXRQyvwbeOTK8Ot3Ud-SnqELU63MY6Xri7bZSEMpFhhTwv3vy_IW804_cgXU1lNo47vLanszyWfjWHwGAjl9nFFb_8JVnfrcq_GlvxUqZdK5OT9msaJZlMOtytt_Lnxgmd-oRtGvtWz55meWNVN5EZxR1h1XfhzfW4tfWIagN4-8ByHfE6wuzYJ1KP61bS1VHvIyupy9dtrOQM8vHzyUfasWf5uu-Qr9pY0T4iQivsttlxThR2oVtJTyvsH1hJPey9xkrOEHZxvrCTduw57L13hL3aWLt9RGytsDtmeYc5Rdht3Ur6WmH_wErqYe83VnKGsNvnCztpx57D3n9H2KuNddpHxNEKu2ueKOqObh2eVtQ_rI560L3GOs4QdOd8QSft13PQvXcE3aN8sExkGkfbVLb6NLBqU5m8aLMM7-TjtqXRLlnIr0m0KMc-_hyXoDLHoUyzx6fi8cdwWz4SxQyJDO7_-65sT-o1kzgRxXkzS1BZbjPLprK8ZpajsDih8fw1yqKRes0kTkTVGl9hCSrLbWbZVJbXzHIUlqizrNcsu4KyKolXUDaKcppX5SpxcFCU4M3LUlbl6irdpZEwpYkoVGkqC1OaysKUVlhdXaU5jYQpTUShSlNZmNJUFqa0wuqh8vQRpRVUX1tpJQ6eroc9GgnzkIhCPaSyMA-pLMxDhcUpl5pq5IkozEQqC1WRDMNcJMMwGVWYclhXFOIC0VGF4ac15qMaC-W4bitkn4jCjKSyUCXJMMxJMgyTUoUpN5y2UtpEFCYllYVKSYZhUpJhmJQqTLnnVKXsIlKqMOXsbi2lGgvl7G4rpUdEYVJSWaiUZBgmJRmGSanClOtOWykdIgqTkspCpSTDMCnJMExKFaZceqoffRYipQITyhneWkrvOGew3EQ_vq1D8CH0xDIUvG_atuWZjlxKM-jdOqa3sLs9L5R90XWheCG4S8F_gOkq-lFyZ3ksU_CXwSaVDL4E3-W1zGRyv96u02y9eHpyPP70bwAAAP__wUhI0A==

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mV1v4kYYhe_7K6y52qhGMDP-wJYqZbtJVaRssgUuWlXRysAkQUswtY0WEuW_V5BNHfzGx37tkrsA5swzx-PHjPMo0n8WIhTnf365-Di4tD6cDUbj0R8XJ9aH0fnF-aextbF-G159tjbbB-tqeHY-tH79y9qeWIPL8flwtDsAHfhwkv-9EbZYxjNzGd2bVIR_CylsoYQttLCFI2zhimtbrJJ4atI0TnaHPO6_MJhtRNizxXy5Wme7t69tMY0TI8JHkc2zhRGhGEeThRmaaGaSbk_YYmayaL7YD7PZPpxutg9fV9_MVtjiU7xY3y_T0NrY1oOwxWgV7V51ujuUq3UWWqdSXD_ZIl5n-XhpFt0aEcpXgIMzEfae7GaMbm3GLZdRFRhdDuPZPM3my2nWlYUWyYD5dyZb6y5K7944PofSBSjJai6ncv9XKqdIVd5VHrxexsnMJGZ2EL2PLeVWVW3mTG6BSZU31ZKpqsucySsytenJboT9e5TejUx2terqQpfj7cqEr3z08eJC2GJhbrIPp_Lkl2R-e7f_q8al4xfmqVmrdBQnmUm6mvT6c-mA_eKAdYp9q7Mfo7xBdRl34lXX6RXPwps8QYHHOSxA1hecbCLhrup0dQMNy6aUXhMN16UsitjjUObKk8cVMau7nMo7rojLu2opvao2gYjLm2rJVNUlEHGbnlqLWL6fiFmr9EXEpFeGiA-LVfWVohqJT3e6TgPxqaaUfiPx1aQsis_nUOaKUccVH6u7nMo_rvjKu2opmao2gfjKm2rJVNUlEF-bnlqLT72f-Fir9EV8pFeG-A6L1fWVohuJz-ns98Jc8emmlP1G4qtJWRRfn0OZK0YfV3ys7nKq_nHFV95VS8lUtQnEV95US6aqLoH42vTUWnz6_cTHWqUv4iO9MsR3WKxTXylOI_G5nQbac5oyBo20V4uxKL2Aw5jrxTmu9FjN5VTBcaVX3lVLwVS1CaRX3lRLpqougfTa9NRaes77SY-1Sl-kR3plSC_gPOAcmnQVL1NT61FirzBUR-5qNrNb83za0nidTM2XJJ7uj31-ebUP2r8xM2n2_Kl-fjFYvnyUZomJ7v_738brJAmTVHlSr5ikiknydZJzkCRfJ0lmlNQgi0wQZylZnqWYXCoAWUwu7ZdnacKlYZYLoggWjpLgNDpMLKVAFpNL98qzXCaX7oMswuXA68crj_IIlsuIUgdRshjlwSi__Kr2CZUPo0BXPumqD6McyZBNAKMk8JZHDIhlKgEW6V0SndaWIDcLWpBOEodBDXLJoAe5ZFCElAxbFZmQglXchZAKuWDQhVwyKEMuGbQhJSNqPbyWwAnwFAnDbi2EHRpRkzBsV-kBJ9LOsF-RFGllWLCqB8BIFjasDMqzaPtEsbVVxs2CKqOTxGFQZVwyqDIuGVQZIVPktlRbZQSsIguqjAsGVcYlgyrjkkGVUbKKnRFYs55DwohkUdihyujOAUtWOcAYtDMsWaQyWhl2rOqXg_VJFlasAr9hifsVUWxtlXGzoMroJHEYVBmXDKqMSwZVRsnIbam2yigYzoIq44JBlXHJoMq4ZFBllAzvljRYZh75vaIrnj1JoDJiDI0lq8E-ziedaSxZpDJSmcaO1eDnYkCysGK1W55FbiSaKLa2yrhZUGV0kjgMqoxLBlXGJYMqo2TktlRbZRQMZ0GVccGgyrhkUGVcMqgySoZ3SxqsDI9e5Hi7VAg7VBklw5J10D6OdOZgySKVBU_XtrhZxN-_zmciFNqR2lX-rDOZBX7HmQamM1HOpDO9cWS_506l507E7gvRbSrCRzG6i7_vc8fblUlFeBMtUmOLz9E3c2Yyk9zPl_M0m09_fPL09NO_AQAA__9-rJk4

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l99uo0YUh-_7FOhcJeogM8MfG6RK2W5S1ZI33tq-aFVZKwLj2FrHUMBaO5HfvYIkTWDCKWcS-y4Owzdzzvw-zfAA-T9rCODqz6-jT8Nr4-xyOJ1N_xidG2fTq9HV55mxM36bjL8Yu_29MZ5cXk2MX_8y9ufG8Hp2NZmWAz6NRvhgZtyfv_zcAYNNEsvr8E7mEPwNHBgIYGADAwcYuDBnkGZJJPM8ycohD9ULw3gHgcVgtUm3RfnvOYMoySQED1CsirWEAGbhzVpOZBjLrGcBg1gW4WpdTbPb31_s9vff0u9yDww-J-vt3SYPjB2rVggMpmlY_sPslasZb4vAuOAwPzBItsXTlC8z3eyNZZgv63NU4-cM8iK8lRDwV3UMLyGwDkyvFLd7KceoQzTqcFvreOFuN0kWy0zGNfK8fPP_hrzRjN_DfDmVxTjt8ca2zvapDOppBAZruSjOLvj5L9nqdln91dqKlzLtRpmctF_TJCtk1uNus5U_t07oNCfs0ti3evY0yxuruk7MJO0Jq7kLb67HbaxH1BvAuweWa7rXE2bPPpJ9XLcYT8e-j6yk6Z_XWskJ_OOn84-0Y8_-ee_wr95Y0T0iQjfvttlzjpR3oVtMXyvvH1hJM-_91kpOkHdxuryTduw57_135L3eWLt7RGzdvDtmdZk5Rt5t3WIGWnn_wEqaeR-0VnKCvNunyztpx57zPnhH3uuNdbpHxNHNu2seKe2Obim-Vto_rI5m1v3WOk6Qded0WSft13PW_Xdk3ad8vExkniabXHb6TLAaU5m8bLOMb-XjtuXJNovk1yyJqrGPP8cVqMpxLPPi8al4_DHcVI9EOUMmw7v_vjG7k_rtJE5Ecd7OElSW286yqSy_neUoLE5oPH-NsmikfjuJE1GNxtdYgspy21k2leW3sxyFJZos6zXLrqGsWuIVlI2inPZVuUocHBQlePuylFW5ukp7NBKmNBGFKk1lYUpTWZjSCsvTVZrTSJjSRBSqNJWFKU1lYUorrD4qzwBRWkENtJVW4uDretinkTAPiSjUQyoL85DKwjxUWJxyqalHnojCTKSyUBXJMMxFMgyTUYUph3VNIS4QHVUYflpjPqqxUI7rrkIOiCjMSCoLVZIMw5wkwzApVZhyw-kqpU1EYVJSWaiUZBgmJRmGSanClHtOXUoPkVKFKWd3ZynVWChnd1cpfSIKk5LKQqUkwzApyTBMShWmXHe6SukQUZiUVBYqJRmGSUmGYVKqMOXSU__osxApFZhQzvDOUvqHOYPFOvnxbRVDAK4IF17fiUwvjGLTcaRr3iz8yJRxNIgl9yIe-1C-EN7mEDzAdJn8qLizfSpzCBbhOpcMvoTf5aUsZHa32qzyYhU9PTkcfvo3AAD__2a_ToE=

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • intersect
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mdFuo0YYhe_7FGiuNirInhnABqnSbjepaimbbG1ftKqiFWtPEmsd4wLW2ony7pWdTQn84cAPde5iG5_55jB8eMiDSP9ZilCc_fn5_MPownp3OppMJ3-cn1jvJmfnZx-n1tb6bXz5ydru7q3L8enZ2Pr1L2t3Yo0upmfjyf4AeKBt3Z_kL7fCFqt4bi6iO5OK8G8hhS2UsIUWtnCFLTxxZYt1Es9MmsbJ_pCHwxdG860I-7ZYrNabbP_2lS1mcWJE-CCyRbY0IhTT6OvSjE00N0mvL2wxN1m0WB6G2e7u329391_W38xO2OJjvNzcrdLQ2toHQmGLyTrav-H09jSXmyy03ktx9WiLeJPlQ6ZZdGNEKF8wjk5F2H-022F6zTG5jKrE6HEYTxdptljNsp4sFUkGzL_zdWfdRuntK8fnULoEJVnN5VTe_0rllqmqu8qDN6s4mZvEzAvRh9hKblXXZs7klZhUdVMdmeq6zJn8MlOXnuxW2L9H6e3EZJfrni51Od2tTfjCSh_Oz4UtluY6e_denvySLG5uD381uHQGpXlq1iqdxElmkp4mvf5cOeCwPGCTYl_r7Mcor1BdxE687rn98ll4lSco8bjFAmRzwcmWHu4pp6dbmFi2BfXbmLgpZdnFPocyt548rotZ3eVU_nFdXN1VR-_VtQlcXN1UR6a6LoGLu_TU2cXy7VzMWqXPLia9MlxcLFY1V4pq6z7t9NwW7lNtQQet3NeQsuy-AYcyt4w6rvtY3eVUg-O6r7qrjp6paxO4r7qpjkx1XQL3demps_vU27mPtUqf3Ud6ZbivWKxurhTd1n2uc9gUc92n24IOW7mvIWXZfUMOZW4ZfVz3sbrLqYbHdV91Vx09U9cmcF91Ux2Z6roE7uvSU2f36bdzH2uVPruP9MpwX7FYt7lS3Lbu85wW5nPbYgatzNeIsey9gMOYG8Y9rvdYzeVUwXG9V91VR8fUtQm8V91UR6a6LoH3uvTU2Xvu23mPtUqfvUd6ZXgv4DzsHJt0Ha9S0-ixYr80lCP3NZv5jXk6bWm8SWbmcxLPDsc-vbw8BB3emJs0e_pUP70YrZ4_SrPERHf__Z_jZZKESao6qV9OUuUk-TLJLSTJl0mSGSU1yCITxFlKVmcpJpcKQBaTSw-qszTh0jDLA1EEC0dJcBpdJpZSIIvJpfvVWR6TSw9BFuFy4fXjV0f5BMtjRKlClCxH-TBqUH1VDwjVAEaBrgakqyGMciVDNgGMksBbPjEglqkEWKR3SXTaWILcLGhBOkkcBjXIJYMe5JJBEVIybFVkQgpWcxdCKuSCQRdyyaAMuWTQhpSMqLV4LYET4CsSht1aCisaUZMwbFfpAyfSzrBfkRRpZViwqg_ASBY2rAyqs2j7RLGNVcbNgiqjk8RhUGVcMqgyLhlUGSFT5LbUWGUErCYLqowLBlXGJYMq45JBlVGymp0RWLO-S8KIZFFYUWV054Alq1xgDNoZlixSGa0MO1YNq8GGJAsrVoHfsMT9iii2scq4WVBldJI4DKqMSwZVxiWDKqNk5LbUWGUUDGdBlXHBoMq4ZFBlXDKoMkqGd0saLDOf_F7RNc-eJFAZMYbGktVgHzcgnWksWaQyUpnGjtXg52JAsrBitVedRW4kmii2scq4WVBldJI4DKqMSwZVxiWDKqNk5LbUWGUUDGdBlXHBoMq4ZFBlXDKoMkqGd0sarAyfXuR4u1QKK6qMkmHJumgfRzpzsWSRyoLHK1tcL-PvXxZzEQrpeTPteYEjtZ45bmSkExlfO37_azT0dH9-7Umx_0J0k4rwQUxu4--H3OlubVIRXkfL1NjiU_TNnJrMJHeL1SLNFrMfnzw-_vRvAAAA__9Gz52Z

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl99v4kYQx9_7V1jzlEhr4V2v-WGpUq4XqiJx4Qo8tKrQycGbgI5g12t0MRH_e2Xn1MTe8xyzEvAWx-vP-rszHzF-Af3vBkIY_vV5_GF051zdjmbz2Z_ja-dqNhwPP86dwvl9OvnkPBd7ZzK9HU6d3_529tfO6G4-nM7KBR_G458sBgbbJFZ30ZPSEP4DHBgIYOADAwkMAlgwSLNkqbROsnLJS_XAKH6G0GOw3qa7vPz3gsEyyRSEL5Cv842CEObR_UZNVRSrrOMBg1jl0XpTbfNc7G-ei_2X9KsqgMHHZLN72urQKZizBwazNCqv3E75KpNdHjo3HBYHBsku_77f2zb3hbOK9Kq-QbV-wUDn0aOCkL8LMbqF0DswuxzBZXOIRo6gNccbd7dNslhlKq6RF-WTP1vyg8P4I9KrmconaYc3ajovUhXWmw8YbNRDfnXDr3_N1o-r6q_Wo3iL6Tdi8vZ6WYW4S9wk7fCgeSI_fBnZfJn6ofPjm4fbNE9HuB3_RBpw2yTdSydpitBtTXIGEfj5RKhXTBxfMWFVMd_tyBP1nrBN0rt0kmbv9VqTnKH3xPl6r14x__iK-VYVk271a3uK3vNtk_QvnaTZe_3WJGfoPf98vVevmDy-YtKqYoF7os6TtjkGl83R7LtBa44z9J08X99JyofCVOk02Wp11FjpNbZyeZlaxY_q9RR1ssuW6nOWLKu1r5eTClS1Vax0_npXvF6MttUtUe6Qqejp_--D40nddhInogbtKEFEcSSgT2UF7SxpsDjh3Pl7lEcjddtJnIgatKMEEcWRgD6VFbSzpMESTZb3nuW3owID5aMoXj95D62htLWwSyNhFhJRmIVEFGohlYVZaLACWws5jYRZSERhFhJRqIVUFmahwepaW2igerbq9GgkTB0iClOHiELVobIwdQxW31YdQSNh6hBRmDpEFKoOlYWpY7AG1uoYKG49_PWJKEweKguzh8pC9SHDMH9MmPUE6BNRmEFUFqYQlYU6RIZhEpkw-zHQZBlz4LEWDYgozCIqC7OIykItIsMwi0wYZXKuNwURhVlEZWEWUVmoRWQYZpEJM0bCoy2ShwWDh03y7cs6hhCWvrgXIuau1-1KVyoVuVHPC9ye7Mci4tIL7ntQPhA9aghfYLZKvlXceZEqDeFDtNGKwafoq7pVucqe1tu1ztfL73cOh1_-CwAA__9VuBCW

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl99v4kYQx9_7V1jzlEhrwfoXsaVKuV6oisSFK_DQqkKnBS8BHcGu1-hiIv73ys6pib3nOWalmLc4Xn_W3535iPEzqH93EMHwr8_jD6N76-puNJvP_hxfW1ez4Xj4cW4V1u_TySfrqThak-ndcGr99rd1vLZG9_PhdFYu-DAe_2QxMNgnsbwXj1JB9A9wYOAAAxcYeMDAhwWDNEtWUqkkK5c8Vw-M4ieI-gy2-_SQl_9eMFglmYToGfJtvpMQwVwsd3IqRSyzXh8YxDIX2121zVNxvH0qjl_Sr7IABh-T3eFxryKrYNYRGMxSUV7ZvfJVJoc8sm45LE4MkkP-fb_XbZaFtRFqU9-gWr9goHLxICHib0KM7iDqn5hZDv-yOZxGDr81xyv3sE-yWGYyrpEX5ZM_W_KDw_hDqM1M5pO0xxs1nRepjOrNBwx2cp1f3fLrX7Ptw6b6q_UoXmO6jZi8vV5GIe4TO0l73G-eyA9fxmu-TP3Q-fnNw02ap-fYPfedNOCmSYJLJ2mKELQm6UAE3p0I9Yo551fMMaqYa_e8d-o9xzTJ4NJJmr03aE3SQe853fVevWLu-RVzjSrm2dWv7Xv0nmua5ObSSZq9d9OapIPec7vrvXrFvPMr5hlVzLffqfM80xzhZXM0-y5szdFB33nd9Z1H-VCYSpUmeyXPGiv7ja1sXqaW8YN8OUWVHLKV_Jwlq2rty-WkAlVtFUuVv9x1Xi5G--qWU-6QSfH4__fB-aSgncSJqLAd5RBRHAnoUll-O8vTWJxw7vwtqk8jBe0kTkSF7SiHiOJIQJfK8ttZnsZymqz-W5bbjvI1lIuieP3k-2gNPVMLAxoJs5CIwiwkolALqSzMQo3lm1rIaSTMQiIKs5CIQi2ksjALNVZgbKGGGpiqM6CRMHWIKEwdIgpVh8rC1NFYN6bqODQSpg4RhalDRKHqUFmYOhorNFZHQ3Hj4e-GiMLkobIwe6gsVB8yDPNHhxlPgC4RhRlEZWEKUVmoQ2QYJpEOMx8DdZY2B55rUUhEYRZRWZhFVBZqERmGWaTDKJNzvSmIKMwiKguziMpCLSLDMIt0mDYSnm2Rd1owWO-Sb1-2MUTgBIEnBiG3l7EnbC8IlvYydNY2l0KK0F_HPOxD-YB4UBA9w2yTfKu48yKVCqK12CnJ4JP4Ku9kLrPH7X6r8u3q-53T6Zf_AgAA__-CjhE9

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))
----
distribution: full
vectorized: true
·
• intersect all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl-9ro0gYx9_fXyHPqxZG4uiYH8JBl22PC2TbvSYvDo6wmDhpwqbRcwwbW_K_H5rttTr1WZ-hmJcT9aPfeb4fmDyD-ncLAdz8_XXyaXxrXVyPp7PpX5NLa3ozufk8sw7WH_d3X6yLi5c1s_LTT4f86dIa385u7qfFhU-TifX-TZfAYBdH8jZ8lAqCf4ADAxcYeMBAAAMf5gySNF5KpeK0uOW5fGAcHSBwGGx2yT4rfp4zWMaphOAZsk22lRDALFxs5b0MI5n2HGAQySzcbMvXHPKnq0P-9C35LnNg8Dne7h93Kii_DhhMk7BY2T0X5kcG8T77-ZZX-CK31qFaV7FXnF0Vj8wZqCx8kBDwN18_vobAOTKzAP6ZAri1AH5jgFf0fhenkUxlVIHPiyd_dcs7u_BnqNZTmd0lPV6b4ixPZFDtGTDYylV2UQa5_D3dPKxfFsDgbp8F1hWv7clrWK8WljePyyjKbWzHSY_79X1592NE_WOqW8_bd4ebdKfn2j3vo-vPTSP0zxahLkC_MUIHAvCuBagOzG0_MNdoYJ7dEx_dOdc0wuBsEeqdGzRG6KBzbtedqw7Maz8wz2hgwu75H905zzTC8GwR6p0bNkbooHNe152rDky0H5gwGphvf3TjhGmA0ZkC1Ps2agzQQd9E130TlP8B91Il8U7JVsdGp_YqmxfZZfQgT3up4n26lF_TeFnee1relaCyVZFU2emqe1qMd-Ult3hDKsPH__8FtCf1m0mciBo1o1wiiiMBPSrLb2YJjcUJ-87fohwaqd9M4kTUqBnlElEcCehRWX4zS2gst85y3rK8ZpSvoTwUxas776AzFKYW9mkkzEIiCrOQiEItpLIwCzWWb2ohp5EwC4kozEIiCrWQysIs1Fh9Yws11MBUnQGNhKlDRGHqEFGoOlQWpo7GGpqq49JImDpEFKYOEYWqQ2Vh6miskbE6GoobH_6GRBQmD5WF2UNlofqQYZg_Osz4BOgRUZhBVBamEJWFOkSGYRLpMPNjoM7SzoFtLRoRUZhFVBZmEZWFWkSGYRbpMMrJuVoKIgqziMrCLKKyUIvIMMwiHaYdCVtbJI5zBqtt_OPbJoIAhDNYeIPFyg6lGNhi0fft4XIk7cViGErHD1crfwTFA-GDguAZpuv4R8md5YlUEKzCrZIMvoTf5bXMZPq42W1Utln-vHI8_vZfAAAA__883wUv

query T
EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))
----
distribution: full
vectorized: true
·
• intersect
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mNFu4kYYhe_7FOi_SiQjmBnbgKVKWW1SFSmbbAMXlapo5cCQoCWY2kYbNsq7V5CmjuePDzOY-tKAj785Zj575pmyvxcU0cWfXy8_Da9aJ-fD0Xj0x-Vpa3RxefF53Hpq_XZz_aV1cvJ27LU2rx89bX6etoZX44ub0faLj39wSh4tk6m-ih91RtFfJMgjSR4p8sgnjwK69WiVJhOdZUm6_cnz7oTh9Imirkfz5Wqdbz--9WiSpJqiZ8rn-UJTROP4bqFvdDzVaadLHk11Hs8Xu8s8bX6ePW1-flt91xvy6HOyWD8us2hHRx6NVvH2qN2RdPviUbLOi6tkeXyvKRLvsIbnFHVfvMPIgmOTSYMscCE7n2f5fDnJO8Jo7Ex4Z-Y1i9PuNq2HOHv4-JQCTRlowqm1gi34H9h8k626tyJ7vUzSqU71tJS-i62klxbNFliBgSWrK6uJZVFqgRWaWHXa8g4i_z3OHkY6v151lNHoeLPS0Tv3fLq8JI8Wepaf7EZ1-ms6v394OyCPrtd51DoTlaPtGaNVR74JV0k7WXVUYPbyIUzfhClXL-zVIw5RT0e2O8pai-JQtvD4bKYYQxe2Qj6iCTE69VawhU2Isbq3mgayaBaIsbqymlgWpQIx1mmrthhF02Is3wRpP9_lQfNdtTu-tYvkoWy947OZLuq5sBXzXTbhIqfeCrZeEy6q7q3mpLdoFriourKaWBalAhfVaau2i2TTLirfBGU_39VB891vdwJrF6lD2frHZzNd1HdhK-a7asJFTr0VbP0mXFTdW81Jb9EscFF1ZTWxLEoFLqrTVm0XqaZdVL4Jvv189w-a70Hb2kT-oWSDY5OZHhq4kBVz3W_CQ06tFWyDJjxU3VvNCW_RLPBQdWU1sSxKBR6q01ZtD_lNe8h32XC90dkqWWbaaluqa1yqLbZj19N7_dpllqzTif6aJpPdb18Pr3dBuw-mOstfv1WvB8Pl21dZnur48b-97PdJAibJ6qSumSTNJPE-yS8lifdJwjFKSJDFBrgna1CdJR25ZAiyHLmUqs5SjEvBrABEMSwcJQCW74gluyDLkUv2qrMCRy4F_qoB4_Lh_AH_iJBhBQ5RshQlzKgQRoGyeoyqh1UTOhiiD6OEqI4KzagBjupWR7GuBJOptbhcs6C52Bj3hSF1uZJBd7mSQXlxMvYIsrYXB8NZUF-uYNBfrmRQYK5k0GCcjD2JynMJhIWShTG3orCyxRQLw3JFGuOVYbuKfrUxeiwL61X0qrN4Ycyv1vZxzYL24YPcE4bs40oG7eNKBu3DydhDydo-HAxnQfu4gkH7uJJB-7iSQftwMvwklwLYx2fv1HhdZISV7cNf0PHSCNmHVSaxY2VQbYw-y8KKlX51FjOsZIa1to9rFrQPH-SeMGQfVzJoH1cyaB9Oxp5K1vbhYDgL2scVDNrHlQzax5UM2oeT4Se57AP7sBcpiZdKRljZPsyLEi-WkH14ZdixCuzyDNjaec_WE1jEMV0r_BqL7OOaBe3DB7knDNnHlQzax5UM2oeT4T0oZB8OtmefDdnHFQzax5UM2seVDNqHk-EnuQI3IGQqU3ixZISV7cPJ8GoJ2cd_ufVotkh-fJtPKaI7dTcLtZ62_SCWbX_qB-3YF357NhFBfxLOfB32aXtCfJ9R9Eyjh-THLne8WemMolm8yLRHX-Lv-lznOn2cL-dZPp_8-83Lyy__BAAA__-1j2Pz

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • except all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l11vqlgUhu_nV5B11WYgsDcgH8kk7bROxsRTO-rFmUzMCZXdao4Vho052sb_PpHWU2GXNSw03tWCDy9rvU_AV5D_LiCE7tf7_nXvTru47Y3Go7_6l9rFqNvv3oy1jfbHcPBFW29eLrXu15vu_Vi77vd_Hl5r16PSOYPhbXeo_f63tgEdlkks7qJnISH8BxjowEEHG3RwQAcXJjqkWTIVUibZ7pTX4gu9eA2hpcN8ma7y3b8nOkyTTED4Cvk8XwgIYRw9LMRQRLHITAt0iEUezRfFZdabl6v15uVb-l3sItwki9XzUoZFnlEa7f40TA6TrQ7JKn-_xAf5YaPNIjkrM68YTLYTHWQePQkI2UHu3i2E1lZvF91tFn19uui8Et2tjf7BXS2TLBaZiEvkye6b_3fKJ_f_ZyRnI5EPUpNVNjfepCI8KBnosBCP-cUVu_wtmz_Nir9Ah8EqD7Xivg7n8HGPduUeGWk_oyTLRWYytzrHX2sv6FQv2GSqnw3s_SqfpLpLjCQ1uVVdwad53EoeXh4Aa15QRnbL5IZpn9Qu1jZ8h2zX8eGrfnVqw5_BL3Ymv0gb2vvVOcKv8lR580pwep9tw3RO2mfeNrxH7_PR4at99mrDn6HP_Ex9Jm1o32fviD6Xp2o3r4RN77NjmO5J-2y3De_T-3x0-Gqf_drwZ-izfaY-kza077N_RJ_LU3WaV8Kh99k1Ttpmp230gN7mI6NXuxzURj9Dl50zdZm0n32XgyO6HFB-PAyFTJOlFI1e063KpQy2m7GIn8TbzmSyyqbiPkumxblvHwcFqOhtLGT-dpS_fegt94dknono-edv0-Ykr57EiCjG6lmcynLrWTaVFdSzHIXFCIPnhyiXRvLqSYyIqgy-xOJUllvPsqmsoJ7lKCxeZVmHLLuEskqDV3Zooyinvg6ukspBUZzVx1JSuW2VZjQSpjQRhSpNZWFKU1mY0gqr01bpDo2EKU1EoUpTWZjSVBamtMLyUHl8RGllh35rpZVUQVsPOY2EeUhEoR5SWZiHVBbmocJilJeaUrU8IgozkcpCVSTDMBfJMExGFaY8rEsKMY7oqK4Sf1pjPqrBlMd1UyFtIgozkspClSTDMCfJMExKFaa84TSV0ieiMCmpLFRKMgyTkgzDpFRhyntOWcoOIqW6SuXZ3VhKNZjy7G4qpUNEYVJSWaiUZBgmJRmGSanClNedplIGRBQmJZWFSkmGYVKSYZiUKkx56Sn_6LMQKZVVcuUZ3ljKYDvR4XGR_Pg2jyEEP5g-eJ4_NXzmMsOxppHh-75nuJ2YBVYntoPgAXZfiJ4khK8wmiU_Cu54kwoJ4WO0kEKHL9F3cStykT3Pl3OZz6fvR7bbX_4LAAD__6NfHhU=

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • except
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mV1v4kYYhe_7K9BcbVQjmBl_YEuVkiZUjZRN0sDFVlW0cmBI0BJMbaOFRPnvFWRZx37jY7-45C5gfObx8fixx3kWyb8zEYj-l-uLk_PL1qez88Fw8NfFUevToH_RPx221q0_bq4-t1brp6NW_8tp_3r4c9OqdTLIbb-6OevftH7_u7UWlphHY3MZPppEBP8IKSyhhCW0sIQtLOGIW0ss4mhkkiSKNz953u5wPl6JoGuJ6XyxTDdf31piFMVGBM8inaYzIwIxDO9m5saEYxN3usISY5OG09l2mNX66Xi1fvq6-GY2CKfRbPk4T4Itz2ARbv5sd5S4fbFEtEyzIZI0vDcikG-Yzs9E0H2x9sNy6mGt6mGpApbDwTqbJul0Pko7stDVsSwMmO1zt249hMnDO7_PoHQBSrLKyqic_5XKLlKVd5UFL-dRPDaxGeeit7Gl3KqqzYzJKTCp8qYaMlV1mTG5RaYmPVl7Yf8ZJg8Dk14tOrrQ5XC9MMFONicXF8ISMzNJPx3Lo9_i6f3D9i9hiatlGrTAQXqFg9SsKTqI4tTEHU1K_bV0wF5xwDqtvlfYj1HeobqM2tGiY3eLp-BdHr_AY-cLkPWFJtme7ah2R9c2rdwXzGWbFoMVXetywDKrycO6llVXRuUe1rXlXTX0WlWbwLXlTTVkquoSuLZJT41dKz_ItawpunMtKZXh2nyrqr5CFN9tut2xa7tN7Qvm8d0GwYpu8zhgmUXUYd3Gqiuj8g7rtvKuGnqkqk3gtvKmGjJVdQnc1qSnxm5TH-Q21hTduY2UynBbvlVdXyGa7za73XFqu03vC9bjuw2CFd3W44BlFtGHdRurroyqd1i3lXfV0CNVbQK3lTfVkKmqS-C2Jj01dpv-ILexpujObaRUhtvyrdr1FWLz3ea0a5vN3hfL55sNYBW95nOwMoPYh_Uaq6yMyj-s18q7auiQqjaB18qbashU1SXwWpOeGnvN_iCvsabozmukVIbXfM7LxhuTLKJ5Ymq91usWhmrLTcdmfG9ez1kSLeORuY6j0fa3rx-vtkHbL8YmSV-3qtcP5_PdpiSNTfj4838fb5MkTNLlSU4xSRWT5NskO5ck3yZJAoWjpAZZTCwly7MUk0v5IIvJpb3yLE24NMxyQBTBwlESnEabiaUUyGJy6W55lsPk0j2QRbhseP245VEuwXIYUSoXJYtRLozyyq9qj1B5MAp05ZGuejDKlgxt-TBKgijSlcQylcCmLskiOq0tQcqFs6AFuWBQg1wy6EEuGRQhJcNWRSakYBV3IaRCLhh0IZcMypBLBm1IyYha89cSOAGuImHYrYWwvBE1CcN2lS5wIu0M-xVJkVaGBSv9cjDaGDas6oKDJFlEsbVVRrlwFlQZFwyqjEsGVcYlgyojZIrclmqrjIBVZEGVccGgyrhkUGVcMqgySoZXRgrMWdcmYUSyKCyvMrpywJJVNrjKaWdYskhltDLsWAWeO4mvFVas6pVn9UgWUWxtlVEunAVVxgWDKuOSQZVxyaDKKBm5LdVWGQXDWVBlXDCoMi4ZVBmXDKqMkuHVkgbTzCXPKxovlwpheZURY-iK109g7eWRzjSWLFIZqUxjx2qnHIzIX2PFavDo6ZMsotjaKqNcOAuqjAsGVcYlgyrjkkGVUTJyW6qtMgqGs6DKuGBQZVwyqDIuGVQZJcOrJQ1mhksvcrxcKoTlVUbJsGRttPYindlYskhl_sutJSaz6PvX6VgEQttj5RvPaztaTtq22520fdv12qqrPTkyoZzc9cRmh_A-EcGzGDxE37e5w_XCJCKYhLPEWOJz-M2cmdTEj9P5NEmnox9bXl5--S8AAP__RGpusQ==

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)
----
distribution: full
vectorized: true
·
• except all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl9Fuo0YUhu_7FOhcJdIgMzDYGKlStomrWvLGqe2LrSprhc0ktpYYymBtSOR3r0y2jWGWEw6yyJ0J8PHPnP-TJi-g_onAh9GXu8mn8a1xcTOeL-Z_Ti6Ni_loMrpeGLnx-2z62XjKn43p7GY0M377y8gvjdGX69Hdwvg0mbzzJDDYxaG8DR6lAv9v4MDABgYOMBDAwIUlgySN11KpOD0-8lK8MA6fwLcYbHfJPjv-eclgHacS_BfItlkkwYdFsIrkTAahTHsWMAhlFmyj4jNP-fPVU_78Nfkmc2BwHUf7x53yjePFPAmOP82eDcsDg3if_fjEG3mVG5tAbcrMKw7Lw5KByoIHCT4_yT2-Ad86sHbR3c6j25Xobm30N-5-F6ehTGVYIi-Pb773yE_W_0egNnOZTZMer0xukSfSP-kXMIjkfXZxxS9_TbcPm-IXMJjuM98o1nW6D29rdCpr5PXzabWC29iMkx53q9vx0zCiGqa847x5WTi5LD3b7DlnbTpvG77_AeGrXe_Xhu-g67yjrpcnZDefkE2fkGP2xFnrZbcNP_iA8NV6DWrDd1Avu6N6lSfkNJ-QQ5-QMHvuWevltA3vfUD4ar282vAd1MvpqF7lCYnmExL0CbnmWcsl2kYfdh69Wq1hbfQOqiU6qpagHNJnUiXxTslGRzyr8imTH5cswwf5uoUq3qdreZfG6-LZ18tpASpqFEqVvd61Xy_Gu_9uqSyVweP__2M0J_XrSZyIGtajbCKKIwt0qCy3niU0Fifsu32Kcmmkfj2JE1HDepRNRHFkgQ6V5dazhMayqyzrlOXUj9DVRuigKF7eeQt1R7S1kNNImIVEFGYhEYVaSGVhFmost62FfRoJs5CIwiwkolALqSzMQo3Vb22hNsJBW3VsGglTh4jC1CGiUHWoLEwdjeW1VWdAI2HqEFGYOkQUqg6VhamjsYat1dFGyFsf_hwiCpOHysLsobJQfcgwzB8d1voE6BFRmEFUFqYQlYU6RIZhEumw9sdAfZDaObCpRYKIwiyisjCLqCzUIjIMs0iHUU7OpVIMiSjMIioLs4jKQi0iwzCLdJh2JGxskTgsGdxH8fev2xB8kJZ3b3O3b3Kv75litQ7NledZZijWlggHcjWwAji-EDwo8F9gvom_F9xFnkgF_n0QKcngc_BN3shMpo_b3VZl2_WPO4fDL_8GAAD__xSB608=

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)
----
distribution: full
vectorized: true
·
• except
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFFv4kYUhd_7K6z7tCsZwczYBixVyjahaqRskgYetqqilYMnCVqCKTbakCj_vYJ06-C7PvbFkLcA5vjzCfcbj58p_WdKIQ2-XJ59Oj13PpycDkfDP88-Oh-Gg7PB8chZOb9fXXx2HldPzsXVyeDK-e0vZ_XRGXw5HlyOKo4il2ZJbM-jB5tS-DcpckmTS4Zc8sgln65dmi-SsU3TZLE-5HnzhdP4kcKOS5PZfJmt3752aZwsLIXPlE2yqaWQRtHN1F7ZKLaLdodcim0WTaab0zyuno4eV09f59_silw6TqbLh1kaOusXw3m0_rPV1nT94lKyzPJTpFl0ZylUb5hOTyjsvLi7Yfl7xdIFLF-CdTJJs8lsnLVVoasjVThh_p2blXMfpfc_OT6HMgUoJSorp_L3SuUVqcq7yoOXs2QR24WNt6I3saXcuqrNnMkvMOnyphoyVXWZMwVFpiY9uTth_xGl90ObXczbptDlaDW34Q_PfDo7I5em9jb7cKQ-_rqY3N1v_iKXLpZZ6ICL7BYu0uy5-POklczbxi_W8VOYXhFmu3FVXy5KLJe2brVNbeupXcGCPYMVvRdIwHLDqMN6T1RXThUc1nvlXTV0TFWbwHvlTTVkquoSeK9JT429p97Je9vF6_oTreUTbVptr7Zq9K5g3T2DFVXTlYDlQ60PqxpRXTlV97CqKe-q4VhXtQlUU95UQ6aqLoFqmvTUWDX6nVSzXbypP9FGPtFeq-3XVo3ZFay3Z7CianoSsHyozWFVI6orp-odVjXlXTUc66o2gWrKm2rIVNUlUE2TnhqrxryTaraL9-pPtCefaL9VWzTerlj9vWIVNdOXYOUD7R1WM6Kycqr-YTVT3lXDka5qE2imvKmGTFVdAs006amxZrx30ownea55ZdN5MkttrUdCncKpWmp9yTa-s68VpslyMbaXi2S8Ofb15cUmaPNGbNPs9VP9-uJ09uOjNFvY6OH_Z9hvkxRMMuVJfjFJF5PU2yRvK0m9TVIMCkcpDbKEWKpfnqWFXDoAWUIuY8qzDOMyMMsHUQwLRymA5QmxdAdkCbl0tzzLF3IZ8FP1GZcH5wf8IgKG5Qui9FaUKkYFMAqU1WVUXSyIQOCaHoxSnfIodoF9HKXKowJmQCbT2uJiWBVZ0FxSMKguKRl0l5QMyouTsSWotr04GM6C-pKCQX9JyaDApGTQYJyMrUTbswTCAs3CmFtR2LbFDAvDckUa45Vhu6puuTH4RWK9ql55VpdlMb_Wtg_nwlnQPlIwaB8pGbSPlAzah5OxRam2fTgYzoL2kYJB-0jJoH2kZNA-nAyv5FoB-3jsnrpiX6SAffgNOt4aIfuwyjR2rPbKjcGsqLFitV-e1WNZzLC17cO5cBa0jxQM2kdKBu0jJYP24WRsVaptHw6Gs6B9pGDQPlIyaB8pGbQPJ8Mrue4B-7AbKY23SoWwbfswL2q8WUL24ZVhxxqwW2KKNVixBjx76rMsfBuL7MO5Ku78kX2kYNA-UjJoHykZtA8nw8-gkH04WMVzNmQfKRi0j5QM2kdKBu3DyfBKbsA_IGAqM3izVAjbtg8nw7slZB_v5dql22ny_eskppC6vaAXdINe68Z2dMuL4nHrxtP9VuzFvo6U8YLOLa2_EN2lFD7T8D75vskdreY2pfA2mqbWpc_RN3tiM7t4mMwmaTYZ__fJy8sv_wYAAP__6k89pw==

# EXCEPT ALL and EXCEPT with no overlap.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except all
    │
    ├── • filter
    │   │ filter: x < 2
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 2
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmG9v4kYQxt_3U1jzKlFtmd31H2zppFwTTofEhRSQelWLTgaWgI5gahsdJOK7V0Ag2BsPHoeQdwHs3w7PzPNMzBPE_03Ah9r3u8bn-q12cVNvd9p_Ni61i3atUbvuaAvtS6v5TVssH7W_vtZaNW2h_TuvVERf45da7ft17a6jfW40jl4vP61vaLZuai3tj7-1BegwDQfyNniQMfj_AAMdOOggQAcLdLChq8MsCvsyjsNofcnT5ob6YAF-RYfxdDZP1m93deiHkQT_CZJxMpHgQyfoTWRLBgMZmRXQYSCTYDzZHLNYPl4tlo8_Zj_lEnS4Difzh2nsb-ppz4L1n4bJobvSIZwnL0fESXAvwWcHNdVvwK-s9OJlfRlPEhnJyLTTNW3f97UrtpfW9_36baeaqeMF1VtqoyAepTlXDLqrl1p5plabUuuhhOy0GopMXayciOyIiuuBO4WMVrbcfB1fwPNpGA1kJAcpdHd957FLXvnOX4N41JZJc2byTCs6y5n0D2wIOkzkMLm4YpefovH9aPMX6NCcJ2tlcntiZ74kJ_WkHUaJjExuZ4X8PfdAJ3tgEVVfE-z5lFequg2NcGaKSrYFr9bjZuoRaQEYwS1ks5jcMEXhyGGUwvZucT4kcpzSIp5aRSV0ysnIjuj4bqGTr-QZQoedKXRIPdmFjvOG0EmryovPJ6ePpzBMq7DJOaWw_XS6H2Jyt6yI7NQqKiYvJyM7ouO7mTxfyTOYnJ_J5KSe7EzuvsHkaVVF8fkU9PG0DNMubHJBKWw_ndUPMXm1rIjs1CoqJi8nIzui47uZPF_JM5hcnMnkpJ7sTF59g8nTqlrF59Oij6dtFLa4RSlrP5veh1jcKyshO62GisHLiciOqPhuBs_X8QwGt85kcFJPdgb33mBwj_KDREvGs3Aay0KP_pXMUQZbaywH93LbszicR315F4X9zbXbl80NaPPGQMbJ9lO2fVGf7j6Kk0gGD_sfCg9JLEtihyQrRWKHJEZEMZbP4lSWm88SRBYX-SyLyvLyWbbC4mgTRX4T7SxJEJrIU00kojJNTLE4leXmswSRlWliimVRWV4-y1ZYFtpEO7-JjjIPNopy8kfLUapy8NGiBISLoqr5JJYlVUtHDRGFRg2VhUUNkYVGDZWFRY3C8vB9UUHGVElAZfcUDhsqC00bMgyLGyoMzRsyDAscFaasoHQvOdJLZS4YvoOwzFELU2I1XZiVXxhXWEqsFs4KKgsNCzIMSwsqDI0LMgzLCxWG7yLm5PfSVVjKMiocGFQWGhhkGBYYVBgaGGQYFhgqDN_gDFnhjjoYylYqHBhqYfhW4shWEsr_0pStlA4MKgsNDDIMCwwqDA0MMgwLDBWGbyWObKWqwlKWUuHAoLLQwCDDsMCgwtDAIMOwwFBh-CLnyCJ31MHAH5CwwFALw7cSR7aSpbAoWykdGFQWGhhkGBYYVBgaGGQYFhgqDN9KHNlKnsKiPFmmA4PKQgODDMMCgwpDA4MMwwJDheGLXGCPl8pgCPy3TSwwvFVXh-Ek_PVjPAAfqvaQu47jGL3AEYZlS9cIAqdneK7j2EMxtITVg_UNwX0M_hO0R-GvDbeznMkY_GEwiaUO34Kf8kYmMnoYT8dxMu4_f7Ja_fZ_AAAA__8WUNlH

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except
    │
    ├── • filter
    │   │ filter: x < 2
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x >= 2
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mV1P20gYRu_3V1hz1WodJfPhxLFUiW5JVSQKXUDarnZRZZIBooY4axs1KeK_rxIKJn7x47yehDs-wpPjgzkTkTuR_TcRkRh8_XL4_uDIe7N_cHp2-ufhW-_N6eBw8OHMm3sfT44_e_PFT--vT4OTgTf3_r3tdPTQU2-9wdcPgy9ntY-175YPPj7ZH5x4f_ztzYUvpsnIHsU3NhPRP0IKXyjhCy18YYQvAnHui1maDG2WJenyIXerHzgYzUXU8cV4OrvNl18-98UwSa2I7kQ-zidWROIsvpjYExuPbNruCF-MbB6PJ6unmS9-7s0XP7_NvtuF8MWHZHJ7M82iFc_pLF5-2GorcX7vi-Q2L54iy-MrKyL5jOlgX0Sde39zrI_jSW5Tm7aDdaaHr0fennzSGkXRwdFZWMmhShwBh-O5HrldP7rEJZsJkjWGljdTnSJTRmE52h9n-Xg6zNuqJGhPlp6x-JmLhXcdZ9cvPL6gCkpUiiWooAq2StUtU1W7KoZvp0k6sqkdrU2vZiu5dZ3NgqlXYtLVphyZ6lwWTGGZycWT3wj7U5xdn9r8eNY2JZdni5mNHnP8_vBQ-GJiL_M3e_Ltu3R8db36SPji-DZf_iVVXmS_dJGGdYueJmlu07YhUn-vjmqn_IybaH3J2K-neQHrKGkls3bQKf8OXgYqZz5YVyAZfWXnta1abb3xASQ5YE997W79AOo2FrRtQ-QIaqZI1jhqdASxLBWxl7s9gliCCqrubo-galeOua-zCY6galOOTHUuwRHk4sn5CJKvdASxbtHHI4hI5RxB61rV5kFT_J7pVttsXHzFAXvKWW_rxe81FSS3bYgUv5kiWeOoUfFZloq2qt0WnyWooOrttvjVrhzrWmcTFL_alCNTnUtQfBdPzsVXr1R81i36WHwilVP8da1686Bpfs9Mqx1sXHzNAXvKWbj14odNBcltGyLFb6ZI1jhqVHyWpaKterfFZwkqqMLdFr_alWNd62yC4lebcmSqcwmK7-LJufj6lYrPukUfi0-kcoq_rtVsHjTD71nQ2rj3hoP1FLP-1nvfb6pHbtcPqX0zQbLGUKPasxwVXTW7rT1LUEHV323tq105lrXOJqh9tSlHpjqXoPYunpxrb16p9qxb9LH2RCqn9n3O2xgnNpsl08xu9H5B-alacinZjq7swy8tS27Tof2SJsPVYx8-PV4Nrb4wsln-8F358MnB9PFbWZ7a-ObprebnSxIumeolSaYUnNLVU0F5ScOlAECRKVOeks-numtT8vmUIteHp2QPbDGxFNjSTC6NtphcBmwZwhXALTRFsPCUDKu3AiaWQltMLg22ukwug7YIVxf-AYGpHsHqMabU2pQsT4Vwql_9Zx0Sqj4OYKf6CkMiS-KaBqyc4p5KBdpFtnBQJeogHcNNlaD0XbJFKrG-1QVgdAzf96jQ9CJrOoESzQWDjeaSwUhzyWClKRlpxcaZpmB4C3aaCwZDzSWDpeaSwVRTMhxY2QexVmQMJ7Y0tp5rTcZwZFUHBJs4UzUvWVGxiTOFK6tAZYkyhSurUGXpGK6sApXtkS1cWYUqS8eaV5ZepENluWCwslwyWFkuGawsJWteWQrmUFkuGKwslwxWlksGK0vJcGUVqqwhY7iyClWWvPpUuLIaVZY40w6VJc40rqwGlSVnia755wCqLB3DldWgsiHZwpXVqLJ0rHll6UU6VJYLBivLJYOV5ZLBylKy5pWlYA6V5YLBynLJYGW5ZLCylAxXVqPKkhd5GldWo8rSluHKGlRZ4sw4VJY4MzX_gQWVJQeTwZU1qLJ0DFfWgMr2yRaurEGVpWPNK0sv0qGyXDBYWS4ZrCyXDFaWkjWvLAVzqCwXDFaWSwYryyWDlaVkuLIGVZbmB1fWoMpSMlzZAFWWOAscKtu_P_fF5ST58W08EpG4DMJeR8YXLRV2w5bpX4StMO5dtC7CYRDIoQnM6l3ry0l8lYnoTpxeJz9Wu2eLmc1EdBlPMuuLz_F3u29zm96Mp-MsHw9_fef-_rf_AwAA__-p8ilX

# EXCEPT ALL and EXCEPT with some overlap.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • except all
    │
    ├── • filter
    │   │ filter: x >= 1
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x < 3
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmG9v2kgQxt_fp1jNq0Rny-yu_0uV0kuoipQmOUC6nu5Q5eJNgkowZxsVEvHdT5CGYG88eJxA3oU__u3wzDzPxH6A7L8xhND-enX-sXPBjs46vX7vz_NjdtRrn7dP-2zBPnUvv7D54p799bndbbM5-3fWakn1gfFj1v562r7qs4_n5zsvGDJ5zC67Z-0u--NvtgADJkmsLqI7lUH4D3AwQIABEgywwQAHBgZM02SosixJV195WF_QiecQtgwYTaazfPX2wIBhkioIHyAf5WMFIfSj72PVVVGsUqsFBsQqj0bj9THzxf3JfHH_bfpDrUo4Tcazu0kWsrmxLqk3jVavTEvAYGlAMsufT8ny6EZByLfK6pxB2Foa9Sv7NBrnKlWp5RTLenw_ZCf8Wd0wDDsXfR8MuJzlITspl_RM_b5gt1F2W0SecBgsn8sWpbIdStnbgvI3V1SWSuPNJOU7NB0y-baS2uW6qzV9Bs8mSRqrVMUF9GB15a6vvPDjP0fZbU_ll1NLlNrSX0xVuOVPMGCsrvOjE378IR3d3K7_2gjBK5vjlH6kIDWnl6S5Si3hlIX8vfJAt3xgHVVfEuzXKS9UdZGYydSSrXILXqzHK9UjiwJwgnOaGMcSpiVrhxGn1LZxjvveYeQ2lnQPmmpx1ExUvkPV_cdRtaoHiCN-oDgiNecpjtxXxFFRVVF_VkWjUZWmZde2v6DUtplU773t7zWVlO9BU83-zUTlO1Tdv_2rVT2A_cWB7E9qzpP9vVfYv6iqrD-rstGo2qbl1La_pNS2mVT_ve3vN5WU70FTzf7NROU7VN2__atVPYD95YHsT2rOk_39V9i_qKpdf1btRqPqmLXNb1Mq28xp8N7mD5oKyt9cUc36zSTlOzTdv_WrNT2A9e0DWZ_UnCfrB6-wfkB58NFV2TSZZKrWI4ZW6SiTrzRW8Y167FmWzNKhukqT4fq7jy8v16D1G7HK8sdP-eOLzuTpoyxPVXS3eU65TeJlEt8m2QUS3yZxIorzapagsrxqliSyhKxm2VRWUM1yNJZAmyirm-iUSZLQRFFoIhFVamKBJagsr5oliaxSEwssm8oKqlmOxrLRJjrVTXS1eXBQlFs9Wq5WlYuPFiUgPBTlV5N4meQ3jhoiCo0aKguLGiILjRoqC4sajRXg-6KFjKmWgNruqR02VBaaNmQYFjdUGJo3ZBgWODpMW0HFXgqkl9pccHwHYZmjF6bFarEwu7owobG0WK2dFVQWGhZkGJYWVBgaF2QYlhc6DN9F3K3upaextGVUOzCoLDQwyDAsMKgwNDDIMCwwdBi-wTmywl19MLStVDsw9MLwrSSQrSS1_6UpW6kYGFQWGhhkGBYYVBgaGGQYFhg6DN9KAtlKvsbSllLtwKCy0MAgw7DAoMLQwCDDsMDQYfgiF8gid_XBwG-QsMDQC8O3kkC2kq2xKFupGBhUFhoYZBgWGFQYGhhkGBYYOgzfSgLZSoHGotxZFgODykIDgwzDAoMKQwODDMMCQ4fhi1xit5faYEj82SYWGMFyYMD1OPn5bRRDCMG1VL5jO6YbRZ5pO55jRo4_NF0ppRvJ62gY-7C6ILrJIHyA3m3yc83tL6Yqg_A6GmfKgC_RD3WmcpXejSajLB8Nf32yXP72fwAAAP__y8L5rw==

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y
----
distribution: full
vectorized: true
·
• sort
│ order: +y
│
└── • except
    │
    ├── • filter
    │   │ filter: x >= 1
    │   │
    │   └── • scan
    │         missing stats
    │         table: xyz@xyz_pkey
    │         spans: FULL SCAN
    │
    └── • filter
        │ filter: x < 3
        │
        └── • scan
              missing stats
              table: xyz@xyz_pkey
              spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mdtO21gYhe_nKax9VTSOkn1wDpYq0SmpikShQyJNRzOoMskGooY4YzsqKeLdR4SCiX-8nN-75o6clj8vnG9Fya1I_5uLUAy_fD56d3jsvTk4HI1Hfx7teW9Gw6Ph-7G39j6cnnzybtY_vL8-Dk-H3o3376rT0fatJ_e84Zf3w8_jyidPPL3nnZweDE-9P_721sIXi3hqj6Nrm4rwHyGFL5TwhRa-MMIXgTjzxTKJJzZN4-T-KbebFxxOb0TY8cVssVxl93ef-WISJ1aEtyKbZXMrQjGOzuf21EZTm7Q7whdTm0Wz-eYwN-sf-zfrH1-X3-w9wvt4vrpepKF342-QRsvo_larrcTZnS_iVZYfJc2iSytC-Qzr8ECEnTt_d7IPs3lmE5u0g22sh_tDb1_mzYZheHg87gtfnKyy0NsvR1IFpICD9Lws-cvb0gU0Wa8uWdHXxNO712WKTKy-DmZpNltMsrYqlLUvC0fMX3O-9q6i9OqF5-dUQYFKsZrKqYJfStUtUpV3lQevFnEytYmdbkVvYku5dVWbOVOvwKTLm3JkquoyZ-oXmVx68mthf4zSq5HNTpZtU-hyvF7a8NHT746OhC_m9iJ7sy_33iazy6vNX09vnPKTHBRO0rAu0VGcZDZpG1Lq7-Wu7RSPuEutLzX28zAvYB3HrXjZDjrF_8HLQEX7B9sVSIZr66i2rVptvfM0SQ7bk2u7TU5Tt3ZdDfRFxqleYbKiMbdxYjWWz4BsdpxYTeVU3WbHqbwrxyGoahOMU3lTjkxVXYJxcunJeZzkK40T6xJ9HCdSKmectmtVu8tN1XKbbrXNzlugOGxPaus1uQW9unXJBvoiW1CvMFnRmNsWsBrLraua3QJWUzlVr9ktKO_K0btVbYItKG_KkamqS7AFLj05b4F6pS1gXaKPW0BK5WzBdq16d7npWm4zrXaw8xZoDtuT2vpNbkG_bl2ygb7IFtQrTFY05rYFrMZy6-pmt4DVVE7Vb3YLyrty9G5Vm2ALyptyZKrqEmyBS0_OW6BfaQtYl-jjFpBSOVuwXavZXW6mltuC1s5LYDhkT2IbNLkEg7plyV_eFtmBenXJir7cdoDVV25c0-wOsJrKqQbN7kB5V47OrWoT7EB5U45MVV2CHXDpyXkHzCvtAOsSfdwBUipnBwacn0tObbqMF6nd6XeJ4qFa8r5kO720D_-0NF4lE_s5iSeb5z7cPNkEbe6Y2jR7eFQ-3DhcPD6UZomNrp9-6X6eJGGSKU-SJErBKF0eFRSTNEwKABSJMsUo-TyquxUln0cpcn44SvZAFhNLgSzN5NIoi8llQJYhXAHMQlEEC0fJfnlWwMRSKIvJpUFWl8llUBbh6sI3EIjqEaweI0ptRcliVB9GDcrf1n1CNcAC7JSfYZ-UJbFNA5ZOsU-lAu4iWVioEnmQhmGnSmD6LskiltjO6gIwGoave2RoepIVnkCK5oJBR3PJoKS5ZNDSlIy4YmdNUzCcBT3NBYOi5pJBU3PJoKopGRasHABZKxKGFVsI29a1JmFYsqoDhE06UxUfWZGxSWcKW1YBy5LKFLasQpalYdiyCli2R7KwZRWyLA2rb1l6kg6W5YJBy3LJoGW5ZNCylKy-ZSmYg2W5YNCyXDJoWS4ZtCwlw5ZVyLKGhGHLKmRZ8ulTYctqZFnSmXawLOlMY8tqYFmyJbriywFkWRqGLauBZfskC1tWI8vSsPqWpSfpYFkuGLQslwxalksGLUvJ6luWgjlYlgsGLcslg5blkkHLUjJsWY0sSz7kaWxZjSxLXYYta5BlSWfGwbKkM1PxDSywLBkmgy1rkGVpGLasAZYdkCxsWYMsS8PqW5aepINluWDQslwyaFkuGbQsJatvWQrmYFkuGLQslwxalksGLUvJsGUNsizVD7asQZalZNiyAbIs6SxwsOzg7swXF_P4-9fZVIRi0p0q0-mdt7q9adQy_V7UOr-YDlo9NVCd6Fx3u52BuH9BdJmK8FaMruLvm9zxemlTEV5E89T64lP0zR7YzCbXs8UszWaTn4_c3f32fwAAAP__2X5J6A==

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• except all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l11v4jgUhu_3V0TnakZyBHYcPiKtxKhltUhM2y1cjLRCo0BMQUNJNg4a0or_viL9InhyNsfb5jI4eZLX530k8wj6nw0EMPx2M_4yunI-XY4m08lf48_OZDgeXkydPXNy54_b66_OPn9wht8uhjdT58t4_LKeM2f_ug4MtnGkrsJ7pSH4GzgwEMDAAwYSGPgwY5Ck8UJpHafHWx6LB0bRHoI2g_U22WXHn2cMFnGqIHiEbJ1tFAQwDecbdavCSKWtNjCIVBauN8Vr9vnDYJ8_fE9-qBwYXMSb3f1WB8W3A4NJEh6v3JaA2YFBvMue3_IGn-fOKtSrMnbA2eD4yIyBzsI7BQE_-frRJQTtA7ML4NsGYHC9ywJnINiA_9804iyNX5nmDb3bxmmkUhWV4LPjk_91yy-25M9QryYqu05a_Gyk0zxRwUndgMFGLbNPRYrPv6fru9XLxeuePAc83ZO3sN5ZWF49O6soV7EbJy3un-_LLz9Gnn9Meet5_SJxmyK1hNvy3tsFbhuhYx_hI23oVOZpwAbetA3l6Yn60xNW0_PclnzvAgrbCF37CB9ZwG5lngYKKJouYHl6Xv3peVbTk27Lf-8CerYRevYRPrKAvco8DRTQa7qA5enJ-tOTVtPz3feun7QN0LcN8JHl61emaaB8sunyScofiVulk3irVa2jZvvsVS4_ZlfRnXraSx3v0oW6SeNFce_T5XUBKioWKZ09rYqni9H2ZUlnqQrvX_8H1Sd1qkmciOpXowQRxZGAHpXlV7OkweKEfRenKJ9G6lSTOBHVr0YJIoojAT0qy69mSYMlzlntU5ZXPULfGKGHonh559uoO9LWQk4jYRYSUZiFRBRqIZWFWWiwfFsLOzQSZiERhVlIRKEWUlmYhQarY22hMcKurTqCRsLUIaIwdYgoVB0qC1PHYPVs1enSSJg6RBSmDhGFqkNlYeoYrL61OsYIufXhzyOiMHmoLMweKgvVhwzD_DFh1ifAHhGFGURlYQpRWahDZBgmkQmzPwaagzTOgXUtkkQUZhGVhVlEZaEWkWGYRSaMcnIulaJPRGEWUVmYRVQWahEZhllkwowjYW2L5GHGYLmJf35fRxCAt1x0On1PuNF82XVlj8_debTsu0L2uqorReTPF3B8ILzTEDzCZBX_LLjTPFEagmW40YrB1_CHulSZSu_X27XO1ovnlcPht38DAAD__8mEDRE=

query T
EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz
----
distribution: full
vectorized: true
·
• except
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9P20gXxu_fTxGdq1aaKJkZO38svRJVYbVItLAkF5VWqDLJBKKGOGs7agLiu68IC8Y-nYcZe9eXjuMnPz_O-dnjB8r-WlFEJ98uzj6dfu18OD6dTCd_nH3sTE7OTj5POzvR2Xd-uzz_0tnt7zsn3z6fXExf9u1FZ_e6jwStk7n5Gt-ZjKI_SZIgRYI0CQpIUEhXgjZpMjNZlqRPX3k4HHA631HUF7Rcb7b508dXgmZJaih6oHyZrwxFNI2vV-bSxHOT9vokaG7yeLk6_Mxuf3-0299_3_wwexL0OVlt79ZZdOAmQZNN_LTV7Sm6ehSUbPPiV7I8vjEUyTdYp8cU9R9FPbKwLpmg820edY6UOJJWTFXBDH0wj5dZvlzP8p6s1HckxVG1muKw633nNs5uf31IgaYraNKrwoIt_A_Ygiqbvbcie7tO0rlJzbyUfoi10iuHZgussIKl7JU1xHIotcAaVLGatCVqkf8eZ7cTk59verrS6HS_MdGLgj6dnZGglVnkHw6n9PH_6fLm9mXjdaTg2Q4rZ6v_5YvwNekmm54Oq738EmZUhSlXL909JOt4qKe6Pe3sSFmXbVCfrZYlBz6ghYlkG5b0KrFgG7RhSXtvDXXk0CywpL2yhlgOpQJLNmmrsSVl25YsXwTlPvyq1vDrbi9wFpOqyzasz1ZLTEMf0GL4VRti8iqxYBu2ISZ7bw0N4NAsEJO9soZYDqUCMTVpq7GYVNtiKl8E7T78utbwB91e6CwmXZdtVJ-tlphGPqDF8Os2xORVYsE2akNM9t4aGsChWSAme2UNsRxKBWJq0lZjMem2xVS-CIH78Ae1hj_sOmspqEs2rktWS0pjH8xi8IM2pORVYcE2bkNK9t4aTr9Ds0BK9soaYjmUCqTUpK3GUgrallLg85L20mSbZJ0Zp1dZ_cpPdeXTuZv5jXnuMku26cxcpMns8N3nzfND0OGDucny573qeeN0_bIry1MT372-pn-bJGGStieF1SRVTZJvk4JSknybJBkUjpIKZHliybE9S3lyqQHI8uTS2p6lGZeGWSGIYlg4SgKswBNL9UGWJ5ca2rNCTy4N_qoh4wrg_IB_xIBhhR5RqhQlq1EDGAXKGjKqIRbEwMM1Ixgl-_YodoJjHCXtUQNmQCZTZ3ExrHeyoLl8waC6fMmgu3zJoLw4GbsFOduLg-EsqC9fMOgvXzIoMF8yaDBOxu5E5VkCYQPFwphbUVjZYpqFYbkijfHKsF3l0G4MfpJYr3JkzxqyLOZXZ_twLpwF7eMLBu3jSwbt40sG7cPJ2E3J2T4cDGdB-_iCQfv4kkH7-JJB-3AyfCdXEtgnYM_U76yLJLAPf0DHSyNkH1aZwo5Vgd0YzIoKK1aF9qwRy2KGdbYP58JZ0D6-YNA-vmTQPr5k0D6cjN2VnO3DwXAWtI8vGLSPLxm0jy8ZtA8nw3dyNQL2YQ9SCi-VKmFl-zAvKrxYQvbhlWHHarBaYorVWLEavHsasyz8GIvsw7neefJH9vEFg_bxJYP28SWD9uFk-B0Usg8He-c9G7KPLxi0jy8ZtI8vGbQPJ8N3cg0uwICpTOPFUiWsbB9OhldLyD7B45WgxSr5-X05p4jkWMvrvrruxovxrBvMzbg71qOwO-8vFnLYV7PxQtPTAfFNRtEDTW6Tn4fc6X5jMooW8Sozgr7EP8yxyU16t1wvs3w5-2fP4-P__g4AAP__jt5rzw==

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l99vqkgUx9_3ryDnqc0OkRlAfiSbtNu6WRNv7aoPd7MxN1wdq7lWWMBcsfF_30hrWxg5y6HVt1LhM3PO-X7C8ATJv0vwofP1vnfdvdMubrvD0fCv3qV2Mez0OjcjbaP9Meh_0TbZVusPbjsD7fe_texS63y96dyPtOte7_XOTLseHr19e_n29wYYrMKpvAseZQL-P8CBgQAGJjCwgIENYwZRHE5kkoTx_pan_IHudAO-wWCxitbp_t9jBpMwluA_QbpIlxJ8GAXfl3Igg6mMWwYwmMo0WCzzZTbZ9mqTbb9FP2QGDG7C5fpxlfjahmn762EU7K_01n4r_XXqa1ccxjsG4Tp9We9tme-ZNg-SeXGB_P4xgyQNHiT4_F0R3VvwjR1rVoddr46MadtT1CFKddiVdbxx16swnspYTgvk8f7J_7vlSDP-DJL5UKb9qMVLMx1lkfTfJREYLOUsvbjil7_Fi4d5_ldlH95qNEs1ctKwhmGcyrjF7XIff61c0CovWKerxxr2ssqRXd2Fehi1hFEewdH92KX9iGIDeP208ibWtYTeMk_kHW9aSbuJd59ZSdm8dmUlZzCPn8k80rgO5rU_YF6xq6J-PkSjpJt6yzpR0kXTSpxGSf_ESspJdyorOUPSxZmSThrXIenOB5Je7KpZPx9mo6Rben50OUXSzaaVuI2S_omVlJPuVlZyhqSbZ0o6aVyHpLsfSHqxq1b9fFiNkm7rJ8q51bQOr1HOP62Ocsq9yjrOkHLrTCknDeuQcu8DKfcoHykDmUThKpG1PgeM0lI63_dYTh_k88yScB1P5H0cTvJ7ny_7OSgP8VQm6fOv4vmiuzr8lKSxDB5fP4jrk5xqEieiOK9mCSrLrmaZVJZXzbIUFic0XrxH2TSSU03iRFSp8QWWoLLsapZJZXnVLEthiTLLeM8yCyij0HhlhiaKsqrjYCu7slCU4NXbUnZlN1Wa00iY0kQUqjSVhSlNZWFKK6x2U6XbNBKmNBGFKk1lYUpTWZjSCstB5XERpZUZuo2VVnblNfVQ0EiYh0QU6iGVhXlIZWEeKixOOdQUouUQUZiJVBaqIhmGuUiGYTKqMOVlXVCIC0RHdZT42xrzUd2Y8rquK6RJRGFGUlmokmQY5iQZhkmpwpQTTl0pXSIKk5LKQqUkwzApyTBMShWmnHOKUrYRKdVRKu_u2lKqG1Pe3XWltIgoTEoqC5WSDMOkJMMwKVWYctypK6VHRGFSUlmolGQYJiUZhkmpwpRDT_Gjz0CkVEYplHd4bSm93ZjBbBn-_LaYgg-2sGdmIAzdsbmrW0IauuvaM70tHMfyZjPhtl3YPxA8JOA_wXAe_sy5oyySCfizYJlIBl-CH_JWpjJ-XKwWSbqYvPyy2_3yXwAAAP__R6lDxA==

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mV1vm0gYhe_3V6C5arRYZmb4sJFWarfJaiOlTTfORVerqCJmmlh1jBewaifKf1_ZqUvgDQdeWOcu2PjM48PMg4c8iOzfuQjFyedPZ-9OP1pvjk8nl5O_zo6sN5OTs5P3l9ba-uPi_IO13txb5xfHJxfW739bmyPr5PP7k0-XP8_aWO8mL556f1T8vRa2WCSx-RjdmUyE_wgpbKGELbSwhSts4YkrWyzTZGqyLEm3pzzsPnAar0Xo2GK2WK7y7ctXtpgmqRHhg8hn-dyIUFxG13NzYaLYpENH2CI2eTSb74ZZb-7frjf3X5bfzEbY4n0yX90tstBa29b2eLKMtkeD4RblfJWH1lsprh5tkazyYrwsj26MCOUzwNNjETqPdjdGrx3jxrbuuYyqwuhxGI9nWT5bTPOhrLRIBiw-c72xbqPs9oXzCyhdgZKs5goq73-lcqtU9V0VwatFksYmNXEpehdby62a2iyYvAqTqm-qJ1NTlwWTX2Xq05PdCfvPKLudmPx8OdSVLi83SxPujfTu7EzYYm6-5m_eyqPf0tnN7e6vFusmqHxJzZqikyTNTTrUpNRfawccVQds0-pLhf0Y5QWqj8kgWQ5dp3oJXuQZV3jccgGyvd1kFwMP1WCoOzhYdqX0uzi4LWXVwj6HsvCdPKyFWd0VVP5hLVzfVU_jNbUJLFzfVE-mpi6Bhfv01NvC8pUszJqiewuTUhkWLreq2vtEdbKeHgzdDtZTXSmDTtZrSVm1XsChLPyiDms9VncFVXBY69V31dMwTW0C69U31ZOpqUtgvT499baeeiXrsabo3nqkVIb1yq3q9j7RnaznDnZbYK71dFfKUSfrtaSsWm_EoSz8og9rPVZ3BdXosNar76qnYZraBNarb6onU1OXwHp9euptPf1K1mNN0b31SKkM65Vbddv7xO1kPW_QwXluV8ZxJ-e1Yqwab8xhLNziHtZ4rOYKqvFhjVffVU-7NLUJjFffVE-mpi6B8fr01Nt47isZjzVF98YjpTKMN-Y81Lww2TJZZKbV40OnMtRAbjs28Y15umZZskqn5lOaTHfnPh2e74J2L8Qmy5_eVU8Hp4v9W1memuju5z9cnidJmKTrk7xqkqomyedJbilJPk-SBApHSQ2ymFhK1mcpJpcagywmlw7qszTh0jDLA1EEC0dJcBldJpZSIIvJpZ36LI_JpUcgi3C5cP349VE-wfIYUaoUJatRPowK6ld1QKgCGAW6CkhXIxjlSoa2xjBKgijSlcQylcCmPskiOm0tQcqFs6AFuWBQg1wy6EEuGRQhJcNWRSakYA13IaRCLhh0IZcMypBLBm1IyYhay2sJXABfkTDs1kpY2YiahGG7Sh84kXaG_YqkSCvDgpXjejDaGDascsCXJFlEsa1VRrlwFlQZFwyqjEsGVcYlgyojZIrcllqrjIA1ZEGVccGgyrhkUGVcMqgySoZ3RgrMWd8lYUSyKKysMrpzwJJVLljltDMsWaQyWhl2rAK_O4mvFVasGtVnjUgWUWxrlVEunAVVxgWDKuOSQZVxyaDKKBm5LbVWGQXDWVBlXDCoMi4ZVBmXDKqMkuHdkgbTzCe_VzTeLlXCyiojxtANj5_A3isgnWksWaQyUpnGjtVePRiRv8aK1eCn55hkEcW2VhnlwllQZVwwqDIuGVQZlwyqjJKR21JrlVEwnAVVxgWDKuOSQZVxyaDKKBneLWkwM3y6yPF2qRJWVhklw5J10d6LdOZiySKVjR-vbPF1nnz_MotFKBwvcpRx9MCoqRy4jpKDaxNEAx07kb6OAzf2ArH9QHSTifBBTG6T77vcy83SZCL8Gs0zY4sP0TdzbHKT3s0WsyyfTX-88_j4y38BAAD__9KLlSk=

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except all
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l1FvqkgUx9_3U5Dz1GaHyAygQrJJ77Zu1sRbu-rD3WzMDYVpNdcKC5iqjd99I63bwpRzOdPqW6nwmznn_H9heILs3wX40Pt2M_jSvzbOrvrjyfivwblxNu4NepcTY238MRp-NdabrTEcXfVGxu9_G5tzo_ftsnczMb4MBvidzNiev16ugcEyjuR18CAz8P8BDgwEMLCBgQMMXJgySNI4lFkWp_tbnooH-tEafIvBfJms8v2_pwzCOJXgP0E-zxcSfJgEtws5kkEk05YFDCKZB_NFscx6s71Yb7bfkx9yAwwu48XqYZn5xpoZ--txEuyvzNZ-K8NV7hsXHKY7BvEqf1nvdZnbjTELsll5geL-KYMsD-4l-PxNEf0r8K0d06vDbV4HM7bHKEVUSnFrS3nlrpZxGslURiXydP_kz255px9_BtlsLPNh0uKVsU42ifTfRBEYLORdfnbBz39L5_ez4q_aPrzWaFdq5KR5jeM0l2mLu9U-_lq7oFNdsElX32vYyyrv7Oo6NuOkJazqCN7dj1vZjyg3gDcPLNcRryXMln0k9bhuJW1N9T6zmKp87dpiTiAfP5F8pIkd5Gt_QL5yV0XziAitsNtmyzlS2IVuJR3dsH9iMdWwd2qLOUHYxYnCTprYIeydD4S93FW7eURsrbA7ZnGGOUbYbd1Kurph_8RiqmHv1hZzgrDbJwo7aWKHsHc_EPZyV53mEXG0wu6aR4q6o1uHpxv1TyulGnSvtpQTBN05UdBJ8zoE3ftA0D3KB8tIZkm8zGSjTwOrspTJ9z2W0b18nlkWr9JQ3qRxWNz7fDksQEWOI5nlz7-K54v-8vBTlqcyePj_-7g5qVNP4kQU5_UsQWW59SybyvLqWY7C4oTGi7col0bq1JM4EVVpfIklqCy3nmVTWV49y1FYosqy3rLsEsoqNV6ZoY2inPo4uMquHBQleP22lF25ukpzGglTmohClaayMKWpLExphdXWVbpNI2FKE1Go0lQWpjSVhSmtsDqoPF1EaWWGXW2llV15uh4KGgnzkIhCPaSyMA-pLMxDhcUph5pStDpEFGYilYWqSIZhLpJhmIwqTHlZlxTiAtFRHSX-tsZ8VDemvK6bCmkTUZiRVBaqJBmGOUmGYVKqMOWE01TKLhGFSUlloVKSYZiUZBgmpQpTzjllKduIlOoolXd3YynVjSnv7qZSOkQUJiWVhUpJhmFSkmGYlCpMOe40ldIjojApqSxUSjIMk5IMw6RUYcqhp_zRZyFSKqMUyju8sZTebsrgbhE_fp9H4EMYitC6vZOm5d1y0-kKYXZ5R5hR5HoBDyPX6TqwfyC4z8B_gvEsfiy4k00iM_DvgkUmGXwNfsgrmcv0Yb6cZ_k8fPllt_vlvwAAAP__qaxIEA==

query T
EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x
----
distribution: full
vectorized: true
·
• sort
│ order: +x
│
└── • except
    │
    ├── • scan
    │     missing stats
    │     table: xyz@xyz_pkey
    │     spans: FULL SCAN
    │
    └── • scan
          missing stats
          table: xyz@xyz_pkey
          spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mVFv4kYbhe-_X2HN1UafEcyMbbClStkmVI2UTdLAxVZVtHJgkqAlmNpGC4ny3yvIUsd-42O_dsldDObMw_HMY8Z5FsnfcxGI4der889nF9an07PRePTH-ZH1aTQ8H56MrbX12_XlF2u9ebIur0-H19avf1qbI2v49WR4NcZn2dbTUXa4FrZYRFNzET6aRAR_CSlsoYQttLCFI2zhihtbLONoYpIkirenPO8-cDZdi6Bni9liuUq3L9_YYhLFRgTPIp2lcyMCMQ5v5-bahFMTd3vCFlOThrP5bpj15ul4vXn6tvxuNsIWJ9F89bhIAmttW9vj0TLcHnW6W5TLVRpYx1LcvNgiWqXZeEka3hsRyDeAZ6ci6L3YzRjd-oy29cTFVAVMl4N5OkvS2WKSdmWhSDJg9pnbjfUQJg_vnJ9B6QKUZJWXUbn_KZVTpCrvKgteLaJ4amIzzUXvYku5VVWbGZNbYFLlTbVkquoyY_KKTG16shth_x4mDyOTXi67utDleLM0wV5Jn8_PhS3m5i79dCyPfoln9w-7v2qsm37hS2rWFB1FcWririal_r90wEFxwDqtvlfYz1HeobqIOtGy6_SKl-BdHr_A4-QLkPUFJ5tIuKs6Xd1Aw7IppddQw3VBiyL2OKCZ8uRhRcyqL6PyDivi8q5aSq-qTSDi8qZaMlV1CUTcpqfWIpYfJGLWFN2LmJTKEHG-VVVfKaqR-HSn6zQQn2pK2W8qvpqgRfH1OaCZYtRhxceqL6PqH1Z85V21lExVm0B85U21ZKrqEoivTU-txac-SHysKboXHymVIb58q7q-UnQj8Tmd3V6YKz7dlHLQVHw1QYviG3BAM8Xow4qPVV9GNTis-Mq7aimZqjaB-MqbaslU1SUQX5ueWotPf5D4WFN0Lz5SKkN8-Vad-kpxGonP7TTQntOU0W-qvVqYRen5HMxML85hpccqL6PyDyu98q5aCqaqTSC98qZaMlV1CaTXpqfW0nM-SHqsKbqXHimVIT2f84Dz2iTLaJGYWo8Se4WhOnLbsZnem9drlkSreGKu4miyO_f18HIXtHthapL09V31enC22L-VpLEJH__9_8vbJAmTdHmSW0xSxST5NsnJJcm3SZJA4SipQRYTS8nyLMXkUj7IYnLpfnmWJlwaZrkgimDhKAkuo8PEUgpkMbl0rzzLZXLpAcgiXA5cP155lEewXEaUykXJYpQHo_rlq7pPqPowCnTVJ10NYJQjGdryYZQEUaQriWUqgU09kkV0WluClAtnQQtywaAGuWTQg1wyKEJKhq2KTEjBKu5CSIVcMOhCLhmUIZcM2pCSEbXm1xK4AJ4iYdithbC8ETUJw3aVHnAi7Qz7FUmRVoYFK_1yMNoYNqzqgS9Jsohia6uMcuEsqDIuGFQZlwyqjEsGVUbIFLkt1VYZAavIgirjgkGVccmgyrhkUGWUDO-MFJiznkPCiGRRWF5ldOeAJascsMppZ1iySGW0MuxYBX53El8rrFg1KM8akCyi2Noqo1w4C6qMCwZVxiWDKuOSQZVRMnJbqq0yCoazoMq4YFBlXDKoMi4ZVBklw7slDaaZR36vaLxdKoTlVUaMoSseP4G9V590prFkkcpIZRo7VrvlYET-GitWg5-ePskiiq2tMsqFs6DKuGBQZVwyqDIuGVQZJSO3pdoqo2A4C6qMCwZVxiWDKuOSQZVRMrxb0mBmeHSR4-1SISyvMkqGJeugvRfpzMGSRSrzX25scTePfnybTUUgQi_Ut6Hsd0J34ncc5Uw6t6HrdZzpnXH9iXZvQ09sPxDeJyJ4FqOH6Mcud7xZmkQEd-E8Mbb4En43pyY18eNsMUvS2eTnOy8v__snAAD__wXemSA=

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)
----
distribution: full
vectorized: true
·
• except all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl11v4kYUhu_7K6xzlUhjwYzHfFiqlG1CVSQ2pMDFVhVaefEQ0BLseow2JuK_VzjbJnjWZ31Gwtyt1_Yzfue8jzK8gP5nAwEMPj2MPgzvnau74XQ2_XN07VxNB6PB7czJnd8n44_Oc753xpO7wcT57S9nf-0MPt0OHmbOh9HoJ08Cg20cqfvwSWkI_gYODAQw8ICBBAY-zBkkabxQWsfp8ZGX4oVh9AxBm8F6m-yy43_PGSziVEHwAtk62ygIYBZ-2aiJCiOVttrAIFJZuN4Uyzzn-5vnfP85-apyYHAbb3ZPWx04OXP2wGCahMcrt3X8lPEuC5wbDvMDg3iXfV_vbZkvubMK9ep0geL5OQOdhY8KAv4uxPAOgvaB2eXwL5tDlHL4lTneuLttnEYqVdEJeX5882eP_GAz_gj1aqqycdLipZnO8kQF75oHDDZqmV3d8Otf0_XjqvhX5T68ZfRKGXn1sKwS3MdunLS4X96OH36MLH_M6Y7z-s3hNs1pCbflnckBbpukc-kkZQs6lUkasIA3ZMHpuET9cQmrcXluS56peMI2SffSScrF61YmaaB4oqHinY7Lqz8uz2pc0i3-yJ6jeJ5tkt6lk5SL16tM0kDxvIaKdzouWX9c0mpcvnum2knbHP3L5iiXrl-Zo4HSyYZKJym_DCZKJ_FWq1pHyXZpKZcfI6voUb1uoY536UI9pPGiePb1clyAik5FSmevd8XrxXD73y2dpSp8-v-HTX1Sp5rEiah-NUoQURwJ6FFZfjVLGixO2HfxHuXTSJ1qEiei-tUoQURxJKBHZfnVLGmwRJnVfs_yqkfoGyP0UBQ_3fk26o60tZDTSJiFRBRmIRGFWkhlYRYaLN_Wwg6NhFlIRGEWElGohVQWZqHB6lhbaIywa6uOoJEwdYgoTB0iClWHysLUMVg9W3W6NBKmDhGFqUNEoepQWZg6BqtvrY4xQm59-POIKEweKguzh8pC9SHDMH9MmPUJsEdEYQZRWZhCVBbqEBmGSWTC7I-B5iCNc2BdiyQRhVlEZWEWUVmoRWQYZpEJo5ycT0rRJ6Iwi6gszCIqC7WIDMMsMmHGkbC2RfIwZ7DcxN8-ryMIwF9GnaXvL11f9Huu7PqRG3Yj7oqIi06P9xfSW8DxhfBRQ_AC01X8reDO8kRpCJbhRisGH8Ov6k5lKn1ab9c6Wy--3zkcfvk3AAD__26jC0w=

query T
EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)
----
distribution: full
vectorized: true
·
• except
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFFv4kYUhd_7K6z7tCsZwczYBixV2m1C1UjZJA08bFVFKwcmCVqCKTbakCj_vYJ06-C7Pva113kLYI4_n3C_8fiJkn8WFNLo88Xpx5Mz593xyXgy_vP0vfNuPDodHU2crfP75fkn52H76JxfHo8und_-ch7fO6PPR6OLSclR5NIyntmz6N4mFP5NilzS5JIhlzxyyacrl1breGqTJF7vDnnaf-Fk9kBhz6X5crVJd29fuTSN15bCJ0rn6cJSSJPoemEvbTSz626PXJrZNJov9qd52D5-eNg-fll9tVty6ShebO6XSehsXeeRXBqvot2rTneHcr5JQ-eDoqtnl-JNmp0vSaNbS6F6BXhyTGHv2a3H6LfHqHOMvoTxeJ6k8-U07apci-yE2Xeut85dlNz94PgMyuSglKi5jMr_qVRenqq4qyx4s4zXM7u2s4PofWwhty5rM2Pyc0y6uKmGTGVdZkxBnqlJT24t7D-i5G5s0_NV1-S6nGxXNvxuoI-np-TSwt6k7z6o97-u57d3-78qzE0_d5HmJxd_FnfiVdf4-Tp-CDPIwxw2rqqbRtUxTVd3uqaGD1VdyqBNyrwRAwll5h7VrhFF3WVUQbtGLO6qoX3K2gRGLG6qIVNZl8CITXpqbET1RkY8LF5XH29da7xNp-vVkJCuS9lvkzIvob6EMht33a6ERN1lVP12JVTcVcOBL2sTSKi4qYZMZV0CCTXpqbGE9BtJ6LB4U328Ta3x9jr7zZpUQqYu5aBNyryEBhLKbNxNuxISdZdRDdqVUHFXDQe-rE0goeKmGjKVdQkk1KSnxhIybyShw-K96uPt1Rpvv1NDQV5dxmF7jHkBDSWM2ah77QpI1FxGNWxXQMVdNRz2sjaBgIqbashU1iUQUJOeGgvIeyMBeZLnp5c2WcXLxFZ69NTLnaqjdpdsZ7f2pcIk3qyn9mIdT_fHvrw83wft35jZJH35VL-8OFl-_yhJ1za6___B-eskBZNMcZKfT9L5JPU6yTtIUq-TFIPCUUqDLCGWGhZnaSGXDkCWkMuY4izDuAzM8kEUw8JRCmB5QizdA1lCLt0vzvKFXAb8VH3G5cH5Ab-IgGH5gih9EKXyUQGMAmX1GVUfCyIQuGYAo1SvOIpd4BBHqeKogBmQybSyuBhWSRY0lxQMqktKBt0lJYPy4mRsCapsLw6Gs6C-pGDQX1IyKDApGTQYJ2Mr0eEsgbBAszDmVhR2aDHDwrBckcZ4Zdiuql9sDH6RWK9qUJzVZ1nMr5Xtw7lwFrSPFAzaR0oG7SMlg_bhZGxRqmwfDoazoH2kYNA-UjJoHykZtA8nwyu5VsA-HrunLtkXKWAffoOOt0bIPqwyjR2rvWJjMCtqrFjtF2cNWBYzbGX7cC6cBe0jBYP2kZJB-0jJoH04GVuVKtuHg-EsaB8pGLSPlAzaR0oG7cPJ8EquB8A-7EZK461SLuzQPsyLGm-WkH14ZdixBuyWmGINVqwBz56GLAvfxiL7cK6SO39kHykYtI-UDNpHSgbtw8nwMyhkHw5W8pwN2UcKBu0jJYP2kZJB-3AyvJIb8A8ImMoM3izlwg7tw8nwbgnZx3u-culmEX_7Mp9RSNNhNNADazvXgbnueEFv2ImsrzuDnvX6wyjyIm9Kuy9EtwmFTzS-i7_tcyfblU0ovIkWiXXpU_TVHtvUru_ny3mSzqf_ffL8_Mu_AQAA__9csl5y

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))
----
distribution: full
vectorized: true
·
• except all
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl11r4zgUhu_3V5hz1YJMIlnOh2GhQ5tlA5m22-RiYAmDGqtNmDT2Wg6TtOS_L0mm29qqz_qI4lwqth_71XkfUF7A_LOECAbfbkdfhtfe2dVwPBn_NTr3xoPR4HLibbw_7m6-emdnr2vmbY8_bbbP597g2-XgduJ9GY28j-84BwarJNbX6kkbiP4GDgwEMAiAgQQGIUwZpFky08Yk2f6Wl8MDw3gDUZvBYpWu8_3PUwazJNMQvUC-yJcaIpio-6W-0yrWWasNDGKdq8Xy8JrN9vlis33-nv7QW2BwmSzXTysTHb4OGIxTtV_5LQHTHYNknf96yxv8fuvNlZkXsRecXewfmTIwuXrUEPF3Xz-8gqi9Y24BwhMFEKUAYWWAN_R6lWSxznRcgE_3T_7fLR_swp_KzMc6v0lbvDTFyTbV0buSAYOlfsjPDinOf88Wj_PXBTC4WeeRd8FLG_KWNCgl5dWzcspxnfhJ2uJheVM-_BhZ_pjivvP6xeEuxWkJvxV8dve5a4TOySKU29-pjNBA-3mj7S9OS9SflnCaVuC35GcXTrhG6J4sQrlw3coIDRRONFq44rSC-tMKnKYl_Vb42YULXCP0ThahXLheZYQGChc0WrjitGT9aUmnaYX-Z9dNugbonyhAuWz9ygANlE02WjZJOfjfaZMmK6NrHRXbpVf5fB9cx4_6uJEmWWczfZsls8O9x-XNAXSoVKxNfrwqjovh6vWSyTOtnv7731Kf1KkmcSKqX40SRBRHAgZUVljNkhaLE_ZdvEeFNFKnmsSJqH41ShBRHAkYUFlhNUtaLFFmtd-zguoRhtYIAxTFizvfRt2RrhZyGgmzkIjCLCSiUAupLMxCixW6WtihkTALiSjMQiIKtZDKwiy0WB1nC60Rdl3VETQSpg4RhalDRKHqUFmYOhar56pOl0bC1CGiMHWIKFQdKgtTx2L1ndWxRsidD38BEYXJQ2Vh9lBZqD5kGOaPDXM-AfaIKMwgKgtTiMpCHSLDMIlsmPsx0B6kdQ6sa5EkojCLqCzMIioLtYgMwyyyYZSTc6EUfSIKs4jKwiyislCLyDDMIhtmHQlrWyR3UwYPy-Tn90UMEcx4e6b68cyPu0r4shPc-6oTKF_FUsQP7a7gvRD2D6hHA9ELjOfJzwN3sk21gehBLY1m8FX90Fc619nTYrUw-WL268pu99u_AQAA__8S4_9g

query T
EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))
----
distribution: full
vectorized: true
·
• except
│
├── • scan
│     missing stats
│     table: xyz@xyz_pkey
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1P40gXhffvr4juCiRHSVX5I7H0SrQaRoNEA0OyaGmEWiapQNQhztiOmoD47yPCMMa-1KEqznjpGB8_PuY-dvmJ8r8WFNPJ98uzL6fnnYPj09F49MfZYWd0cnbyddx56Px2dfGtc3Dwtu11Nq8_PWweDzsn37-eXI47H-89JI-W6VSfJ_c6p_hPEuSRJI8UeeSTRwFde7TK0onO8zR7-ZOn7QGn0weK-x7Nl6t18fLztUeTNNMUP1ExLxaaYhonNwt9pZOpznp98miqi2S-2J7mYfN49LB5_LH6qTfk0dd0sb5f5vGWjjwarZKXrW5P0vWzR-m6KM-SF8mtpli8wzo9prj_7O1GFuybTNbIAhey43lezJeToidqjR0J76h-zvKwm03nLsnvPj6kRFM1NOHUWskW_Adsfp3N3FuZvV6m2VRnelpJ38Ya6aVFsyVWUMOS5soaYlmUWmKFdawmbXk7kf-e5HcjXVyseqrW6Hiz0vGbeL6cnZFHCz0rDraXdPj_bH5797ZBHl2si7hzJIyXGtUuVe35Dpyn3XTVU0G9lA9hBnWYau_C3jtiF-_0ZLenrJ0odmUL989Wt2LowlaaR7RhRafeSrawDSuae2uoH4tmgRXNlTXEsigVWLFJW42tKFq1YvUOSPthlzsNu-r2fGsRyV3Zov2z1UUUubCVwy7bEJFTbyVb1IaIzL01nHiLZoGIzJU1xLIoFYioSVuNRSRbFVH1Dij7YVc7Dbvf7QXWIlK7sg32z1YX0cCFrRx21YaInHor2QZtiMjcW8OJt2gWiMhcWUMsi1KBiJq01VhEqlURVe-Abz_s_k7DHnStNeTvSjbcN1ldQkMXsnLQ_TYk5NRayTZsQ0Lm3hpOu0WzQELmyhpiWZQKJNSkrcYS8luVkO_yhfVK56t0mWurT1H92qm64uXC9fRWvxaZp-tsoi-zdLL929fNi23Q9oepzovXvfJ143T5tisvMp3c__tZ_X2SgEnKnBTUk2Q9SbxP8itJ4n2SYFA4SkiQ5YglhuYs6cglQ5DlyKWUOUsxLgWzAhDFsHCUAFi-I5bsgyxHLhmZswJHLgX-VQPG5cP5Af8RIcMKHKJkJUrUo0IYBcqKGFWEBRE6uGYAo0TfHMUucIijhDkqZAZkMrUWF8P6JAuayxUMqsuVDLrLlQzKi5OxR5C1vTgYzoL6cgWD_nIlgwJzJYMG42TsSVSdJRAWShbG3IrCqhZTLAzLFWmMV4btKiKzMfhFYr2KgTkrYlnMr9b24Vw4C9rHFQzax5UM2seVDNqHk7GHkrV9OBjOgvZxBYP2cSWD9nElg_bhZPhJLgWwj8_eqT9ZFwlgH_6CjpdGyD6sMokdK32zMZgVJVasDMxZA5bFDGttH86Fs6B9XMGgfVzJoH1cyaB9OBl7Klnbh4PhLGgfVzBoH1cyaB9XMmgfToaf5HIA7MNepCReKtXCqvZhXpR4sYTswyvDjlVgtcQUq7BiFfj2NGRZ-DUW2YdzffLmj-zjCgbt40oG7eNKBu3DyfA3KGQfDvbJdzZkH1cwaB9XMmgfVzJoH06Gn-QK3ICQqUzhxVItrGofToZXS8g-_vO1R7NF-uvHfEoxibDf96UfdEO_r7p-MAu6g-FNv-vrKLiZRUkUTWb0ckBym1P8RKO79Nc2d7xZ6ZziWbLItUffkp_6WBc6u58v53kxn_yz5_n5f38HAAD__9C2XWQ=
