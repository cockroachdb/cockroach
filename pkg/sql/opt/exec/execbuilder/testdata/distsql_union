# LogicTest: 5node-dist-opt

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

# Prevent the merge queue from immediately discarding our splits.
statement ok
SET CLUSTER SETTING kv.range_merge.queue_enabled = false;

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW EXPERIMENTAL_RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lT9v2zAQxfd-iuLWUpCPpPxHk9csSZF2Kzyo5iEw4JgCSQNJA3_3QhKExEZyFCV7lOT3fsd3D-YbHKyh--qZPJR_AEGABAEKBGgQUMBGQO3slry3rvlJJ7gzL1DOBOwO9TE0rzcCttYRlG8QdmFPUMLv6u-eHqky5PIZCDAUqt2-xdRu91y51_XL6z8QkOUN8uEYyu9rhM1JgD2Gd18fqieCEk9iHLuYzpYp7F_WBXI5Xpx5jT--9Fdj_Itr-L_bWmfIkfnM9JMh7m1m61yen_ErvD7D4_DVIbe6XGa5Si5OAn1-DbpMoferxbGrHeg_H-svh6cn2fRUluvk3SXQF9egyxR6n628Uba9_2KsvxqenmLT01n7n5q2uwT68hp0mULvs1U3yrb3X47118PT02x6RZa8uQT2ajpbprD7XPWNcu39Vze6yh_J1_bgadAtOmvuYTJP1N3b3h7dln46u20x3eNDq2tfGPKh-yq7h7tD96kZ8KMYWbHixZIV6zMxXorVFLHmz4z83AWrXvDiOSte8uLFlEMvp4hXrBgjiSFfMoy1jK9ZZHSc1DPki4ZFZHS-ajiPyPmuxWbnyxZT823DVWR0vm9yFpHzjYvMLvnCXao3p2__AwAA__8Gyc4Q

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslsFum0AQhu99imquXYRnF-yYUw695NJUaW8VBwqjCMlhrWWRkkZ-9wqQnGDZs7vAEfA_P5_nk9fv0OiKfhQv1EL2BxAESBCgQEACAlLIBRyNLqlttek_MgYeqlfINgLq5tjZ_nYuoNSGIHsHW9sDQQa_i78HeqKiIhNvQEBFtqgPQ83R1C-Febt_ffsHAqK4r3zsbPb1HiE_CdCd_Zjb2uKZIMOT8O_-Xre2bkobp9NiZr4Mmf-ZDVeAU7Pg0J8uuVnwMbdrtKnIUDWZmp-4V5Ab71dIQxh_aWPJxBIvx3-7OX87mY8BC-T2F8soVsF6OtrPX992pp4hdKvgqVl46M83FVT680kWT0VxErw9R_sZbzdzewF0uAqemoWH_nzT7Sl_PsXiJdHwAx62PUf7Ge9u5vYC6HAVPDULD_35pttL_PkSFi-Ngnfn6D7D7WfuLoANV4BTs-DQn-72sX6l4Inao25aujjer0_e9Mc-Vc80_kdodWdK-ml0OdSMl49DbrhRUWvHpzhePDTjo_4FP4eRDSeTMF6GJRtWfLNa0pyw4ZRvTtmwlHx6y6Z3fHi3BPqODe_55v2SZnQ45pJskWXIa4YOz3CRaMibhg7VkHfNVc67hg7ZcJFtyOuGDt9wkXCSF046hJNhwuWnL_8DAAD__3evCbE=

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk9r20AQxe_9FGGuXSPNSvIfQSGHUvAlKWlurQ-qNASBozWrFSQN_u5FEjiRiWdXuz5K6zdvfn4PtG_QqIruimdqIf8NCAIkCEhAQAoCMtgJOGhVUtsq3f9kFGyrF8hjAXVz6Ez_eiegVJogfwNTmz1BDo_F3z09UFGRjmIQUJEp6v1gc9D1c6Ffb19e_4GARdRb_qj3hnR-c4s3f7o4TsqbJM_z7d3jGgTcd6Y_gd1RgOrMu2lriieCHI_CfbHvdWvqpjRRNt2KmS_nzP8Ijh7k9G0OeuKFju7s6UWD97ldo3RFmqrJ1N2RW0HGzitkcxh_KW1IRxLPx3-9OH85mY8z4uXSjeQiSq7bbMtqp_926dnsOehe7CHddoVHd_ppt6U7vWThk0WUXjd4y2on9pVn8DPQ0Ys9JHhXeHSnnwafuNMnLHy6GD4qVwzestqJfe0Z_Ax09GIPCd4VHt3pp8Gn7vQpC58trhu7ZbET-cYz9hng6EEeErorOrqzX77CfGLwQO1BNS2dXWU-nxz3Vxyqnmi8D7Wq0yX91KocbMbH-0E3vKioNeMpjg_bZjzqF_woRlacTsR4LpasOOGdkxDnlBVnvHPGiqXk1UtWveLFqxDoNSve8M6bEGe0dMxWsqCWIV8ztPQMg4qGfNPQUjXku2Yz57uGlrJhUNuQrxta-oZBhZN84aSlcHJe4XbHL_8DAAD__7pfV6Q=

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslkFr20AQhe_9FWauXSPNSoptQSGHUvAlKWlurQ-qNASBozWrFSQN_u9FEjiRiWdXuz5K6zdvPr8H2jdoVEV3xTO1kP8GBAESBCQgIAUBGewEHLQqqW2V7n8yCrbVC-SxgLo5dKZ_vRNQKk2Qv4GpzZ4gh8fi754eqKhIRzEIqMgU9X6wOej6udCvty-v_0DAMuotf9R7Qzpf3OLiTxfHSfltkeZ5vr17XIOA-870R7A7ClCdeXdtTfFEkONRuG_2vW5N3ZQmyqZrMfPlnPkfydEDnRboTp54kaM7enrR4H1u1yhdkaZqMnV35FaQsfMK2RzGX0ob0pHE8_FfL86_mczHGely4UZyGSVXbrZlt9Ofe-PZ7DnsXvAB3XZlR3f4abelO7xk2ZNllF45eMtuJ_iVZ_Az2NELPiB4V3Z0h58Gn7jDJyx7uhy-KdcM3rLbCX7tGfwMdvSCDwjelR3d4afBp-7wKcueLa8cu2WzE_rGM_YZ5OiBHhC6Kzm6o1--wnxi8EDtQTUtnV1lPp8c91ccqp5ovA-1qtMl_dSqHGzGx_tBN7yoqDXjKY4P22Y86hf8KEZWnE7EeC6WrDjhnZMQ55QVZ7xzxoql5NU3rHrFi1ch0GtWvOGdNyHOaOmYrWRBLUO-ZmjpGQYVDfmmoaVqyHfNZs53DS1lw6C2IV83tPQNgwon-cJJS-HkvMLtjl_-BwAA__8tpFef

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyklE2vojAUhvfzKyZnXQJtwQ9WbN3oxMxuwoKhJ4ZEKWlLotfw328oC69GSUuXtH19nr6p5w6tFLivLqgh_wcUCDAgwIFACgQyKAl0StaotVTjkSmwE1fIEwJN2_VmXC4J1FIh5HcwjTkj5PC3-n_GI1YCVZwAAYGmas4W06nmUqlbcb19AYEoHpGH3uS_C0oKBuVAQPbm8dPaVCeEnA5kGT5zxTNS0I949hH_oPatVAIViidiObwR3MtIdjFNXk6-Z_MnNnW_Op27esyimC_p3kNg5S7g0T5zF2CzAjyK0yUNeAis3QU8GuDuAnxWII3s_8O7AQ-BjbuARwOpu0A6K5BFS-7vgd-64hfOnzf4I-pOthqdpksyzicUJ5yGmZa9qvGPkrXFTJ8Hm7MLArWZdtn0sWvtlu3nZ5iGhNlsmNKndPKa5iHoNCSchYRXIeF1SHgTEt4GvRK_N1YOv74DAAD__2Uv0Ls=

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lT9v2zAQxfd-iuLWUpCPpPxHk9csSZF2Kzyo5iEw4JgCSQNJA3_3QhKExEZyFCV7lOT3fsd3D-YbHKyh--qZPJR_AEGABAEKBGgQUMBGQO3slry3rvlJJ7gzL1DOBOwO9TE0rzcCttYRlG8QdmFPUMLv6u-eHqky5PIZCDAUqt2-xdRu91y51_XL6z8QkOUN8uEYyu9rhM1JgD2Gd18fqieCEk9iHLuYzpYp7F_WBXI5Xpx5jT--9Fdj_Itr-L_bWmfIkfnM9JMh7m1m61yen_ErvD7D4_DVIbe6XGa5Si5OAn1-DbpMoferxbGrHeg_H-svh6cn2fRUluvk3SXQF9egyxR6n628Uba9_2KsvxqenmLT01n7n5q2uwT68hp0mULvs1U3yrb3X47118PT02x6RZa8uQT2ajpbprD7XPWNcu39Vze6yh_J1_bgadAtOmvuYTJP1N3b3h7dln46u20x3eNDq2tfGPKh-yq7h7tD96kZ8KMYWbHixZIV6zMxXorVFLHmz4z83AWrXvDiOSte8uLFlEMvp4hXrBgjiSFfMoy1jK9ZZHSc1DPki4ZFZHS-ajiPyPmuxWbnyxZT823DVWR0vm9yFpHzjYvMLvnCXao3p2__AwAA__8Gyc4Q

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslsFum0AQhu99imquXYRnF-yYUw695NJUaW8VBwqjCMlhrWWRkkZ-9wqQnGDZs7vAEfA_P5_nk9fv0OiKfhQv1EL2BxAESBCgQEACAlLIBRyNLqlttek_MgYeqlfINgLq5tjZ_nYuoNSGIHsHW9sDQQa_i78HeqKiIhNvQEBFtqgPQ83R1C-Febt_ffsHAqK4r3zsbPb1HiE_CdCd_Zjb2uKZIMOT8O_-Xre2bkobp9NiZr4Mmf-ZDVeAU7Pg0J8uuVnwMbdrtKnIUDWZmp-4V5Ab71dIQxh_aWPJxBIvx3-7OX87mY8BC-T2F8soVsF6OtrPX992pp4hdKvgqVl46M83FVT680kWT0VxErw9R_sZbzdzewF0uAqemoWH_nzT7Sl_PsXiJdHwAx62PUf7Ge9u5vYC6HAVPDULD_35pttL_PkSFi-Ngnfn6D7D7WfuLoANV4BTs-DQn-72sX6l4Inao25aujjer0_e9Mc-Vc80_kdodWdK-ml0OdSMl49DbrhRUWvHpzhePDTjo_4FP4eRDSeTMF6GJRtWfLNa0pyw4ZRvTtmwlHx6y6Z3fHi3BPqODe_55v2SZnQ45pJskWXIa4YOz3CRaMibhg7VkHfNVc67hg7ZcJFtyOuGDt9wkXCSF046hJNhwuWnL_8DAAD__3evCbE=

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lT9v2zAQxfd-iuLWUpCPpPxHk9csSZF2Kzyo5iEw4JgCSQNJA3_3QhKExEZyFCV7lOT3fsd3D-YbHKyh--qZPJR_AEGABAEKBGgQUMBGQO3slry3rvlJJ7gzL1DOBOwO9TE0rzcCttYRlG8QdmFPUMLv6u-eHqky5PIZCDAUqt2-xdRu91y51_XL6z8QkOUN8uEYyu9rhM1JgD2Gd18fqieCEk9iHLuYzpYp7F_WBXI5Xpx5jT--9Fdj_Itr-L_bWmfIkfnM9JMh7m1m61yen_ErvD7D4_DVIbe6XGa5Si5OAn1-DbpMoferxbGrHeg_H-svh6cn2fRUluvk3SXQF9egyxR6n628Uba9_2KsvxqenmLT01n7n5q2uwT68hp0mULvs1U3yrb3X47118PT02x6RZa8uQT2ajpbprD7XPWNcu39Vze6yh_J1_bgadAtOmvuYTJP1N3b3h7dln46u20x3eNDq2tfGPKh-yq7h7tD96kZ8KMYWbHixZIV6zMxXorVFLHmz4z83AWrXvDiOSte8uLFlEMvp4hXrBgjiSFfMoy1jK9ZZHSc1DPki4ZFZHS-ajiPyPmuxWbnyxZT823DVWR0vm9yFpHzjYvMLvnCXao3p2__AwAA__8Gyc4Q

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkTFLBDEQhXt_xTF1YJO9LpWFzTUqtrJFSIYjEDNLZiLCsf9dNinOE09Wr8zM--a9R06QKeCje0MG-woGJgVzIY_MVNZRFxzCB1itIOa5yjqeFHgqCPYEEiUhWEjkXdq9u1SRd3rQoCCguJiaflFAVc40izsiWLOofzqYwWxyGK86nA_XTCVgwfDt4g8ZHiJLzF6G8UIL9wauJdj_peML8kyZcVM3vSbEcMReh6kWj8-FfLPpz6fGtUFAlr4d--OQ26p9wlfY3AKPv8L7C1gv03L3GQAA___qN9W_

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1v2kgUhu_3V6Bztas1smds82FpJVZVpEaKkirhrvKFg6cBiWBrbKTQiP9eAaGpbTivBydzVwrPzOtznpPjV1plqbpNnlVB0XcS5JAkh3xyKCCHQoodynU2U0WR6d1PDsB1-kKR59Bila_L3X_HDs0yrSh6pXJRLhVFNE0el-peJanSrkcOpapMFsv9NblePCd6M3nZ_CSH-u7uyrt1GfUmkuKtQ9m6fDv3_bjHTW-eFPPqQRNB8TZ2qCiTJ0WR2DqX5Qvt5JNn872fs15lOlVapZWT4h2JfnLiIb8mxfxBlXe5K2o9mG5yFfWub6dX9w9XX6a9_29uyKGl-lH-PRH__KcXT_P9v34_uqg9-vtj-SZlf8h0qbQrwnql_j17ftCibKcq8nboiRC3WT_LXenVa3zy-rByvWhvleCscmXf9T_Fe4OEA1sJ5dmEFswXlswHhT-aP7jUfNm-sZJtrN93g09RzyDh0FZCeTahBfWkJfVA4Y_qDS9Vz2_fWJ9tbNDfL9uPV88g4chWQnk2oQX1fEvqgcIf1Rtdql7QvrEB29iw_yniGeQb28knz-azoF1gSTtQ9qN24494zTxx_r0q8mxVqFZvkN6uZip9UoceFNlaz9Q3nc321xw-3u25_UtEqory8K08fLheHb7aBWwPD7vAQnSiw070mKeFQc2kGTzsAtdqZkqHnegxT8s67f1J-xXYq8M-Cwd8twIWloK_OuwyHzwM5oOH0XwAGswHoMF8DLrMBw-D-eBhNB-ABvMBaDAfQ9bSES_pqMt8jLsYzsPAcB5GhgMaGA5otAFM1mbzL6nJ3jSl4RIw2pzGONBcNLZIRVUhedEFv0aA6aKxR0xUBzRwHdBIdoQD2xGOdG_sUCPdeRrpztNQd4Aj3QGOdG8s0qruA6B7Y6cY6d7YKUa68zTSnaeh7gBHugMc6d7Yp0a68zTSnaeh7gBHugMc6d7YqtV3bY_XXTZ2C6t7vP3rVwAAAP__s7hG0Q==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v4jgUxd_3UyA_7WqDgn3NX2klVjOVplLVjlreRjykxFOQKEFJkMpU_e4jYIASk3viJPDGv-N7fXzPTzHvYhGF5j54NYkY_BBSeEIJT5DwhBaeaIuxJ5ZxNDFJEsWbn-wEt-GbGLQ8MVssV-nm47EnJlFsxOBdpLN0bsRAjILnuXk0QWhivyU8EZo0mM23ZZbx7DWI18O39S_hiaa_KfmwSgeNoRLjD09Eq_S4bpIGL0YM5IdXvPbXWZLOFpPUb58WHsrM-kfJ87oxDZLpmd8fe1AuPXzev6zBACplgKzXAZ3bxHGd1SKKQxOb8GSl7Sq5baoWaPPYQvtSLSCnji10KrTgleryW5BMn0z6sPQp49RovTSDxu396Obx6ebLqPH_3Z3wxNz8TP8eyn_-i2cv0-2rw4Tlb6vrMmFPUZya2CfLtX9z1-8VsO2cI38WPdPEfdSMlr5uZT0-W75_Ul46pJcLr6-aPjnzC1Q_DGXngvxycaAWC6iUBbJeD3RuExXxIUsSrMYWkFN5BHNroTLB5JUIBiZsTzDLtaIEU8UDpNj8UNPXzggB1Q9T0b0gQhwckLVYQKUskPV6oHObqJhfVRIhNbaAnMpDiFsLlRGiroQQMGF7hFiuFUUIFQ8QsfnRze1dxw0hoPphKnoXRIiDA7IWC6iUBbJeD3RuExXzSyURUmMLyKk8hLi1UBkhdCWEgAnbI8RyrShCdPEAaTY_7aYzQEDtw0z0LwgQh_3LGgygUgbIeh3QuU1UzK4uiY8aW0BO5eHDrYXK-NBXwgeYsD0-LNfK_A1zZv1HkyyjRWIK_cPS2nhmwhezO4MkWsUT8z2OJtsyu7cPW932g9Ak6e5buXtzu9h9tWnws1hmxfKzWJ-IpZtYUhW1kpXU_Spq6vJqxTpOvOPElm7zlXmxBOfFq5WqoqZWJXWPV2vW8Q4vbjuIVVbcYcVd_qy7rBjsuceKNQh2n6dCC2DBgooTF3g1BAMvh2QAcoQGXo7YIC20nBqvgPEWW1zwANSID0COAAHkiBBIDuIiLcKcGo-s4xGTkVuYkDxkZAccO48ZtHWeM7IHilukcQo7r4Zh5-Uw7ECOws7LYdh5yipAWcWjBkwsUKOwAzkKO5CjsCM5mHjFU1aBoVP8E1xGboVd8ahRGhw7jxq0dZ40CpBGWaRxCTtQo7ADOQo7koOwAzl86ucpqwBlFY8aFHZAWXRuAJMo7ACTKOxAjiaepyyBqSH-gpyRW2EnHjUEHuiIRw3YOvGkIUAaskjjEnagRmEHchR2JAdhB3IUduIpS4CyxKMG3fIBZdG5AUyiez7AJLroAzmaeJ6yhI6dvzVn5HbYedRo8ECnedRktz7--Ot3AAAA__9B5tay

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpgQZ5K4a6BgKQsVFi2udyUXWTNVwXXCJMLaxXcvSUqtUc_JdOr0bt3km_nnzAf532CrMjlJX2QB8TfgwEAAgwAYhMAggoRBrtVCFoXS1SsNMM5eIe4zWG_zXVn9O2GwUFpC_AblutxIiGGePm_kTKaZ1H4fGGSyTNebeptcr19SvR-97n8AA8-vtpzuyrg3EpAcGKhd-Wvd43LP-94qLVanC404JIeEQVGmSwkxP7C_yxe5ySeu5juus9sqnUkts5OVkoqkXrlwyC9psXqS5TT3eesO5vtcxr3xZP4we3r4PO99enwEBhv5vXw_4h8-6vVyVf_1--i8dfTjsQKLY13IPFGeyn0etQdwce_wZG_e_co5duW-8PzgJlIaJBy4SiiuJnSgJXekpeg-eIEOPvD88CZqGCS8c5VQXE3oQA3hSI2g--ADdPChV39J_r0aBgnvXSUUVxM6UCNwpEbYffAhOvjIu4kYBvmGbvKJq_kcaBH-h45zIdFMFrnaFrJTg-lXZ5LZUjYzKtROL-RXrRb1Ns3Pac3V3-ZMFmXzVDQ_xtvmURWwOzywgYc2MLfKzSOc5gYjE2bwwAYe2sDcKndrZGe0aNP9P-kAn3eAwvx0Zv02HdoIjsOE4DhMCI7DlOAETQge2QiOw4TgOEwIjsOU4ARNCD6wEfzORlEcJhTFYUJRHKYUJWhC0XsbRXGYUBSHCUVxmFKUoAlFhzaKcqueQNCEpARNWErQlKYUTnUFu7Jg1xbs6oJlX7ArDNyqMfCzymBkK05TtuI0ZStOk7YSOGWrSVk6vzOTtmRKU7Ya9SVjnLL1rDygtiaHdz8DAAD__6FyQjI=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmN9r4koUx9_vXyHn6V6IxDOT-AsuuOwWtlDapfVt8SE1s1WwRpIIdUv_90UFrUlzvk4ydt-26idz5pvzOZnsKy2T2NxGzyaj4U9i8kiRR5o8CsijkCYerdJkarIsSbc_2QPX8QsNOx7Nl6t1vv144tE0SQ0NXymf5wtDQxpHjwtzb6LYpH6HPIpNHs0Xu2VW6fw5Sjejl81v8qjtb5e8W-fD1kjR5M2jZJ0fr5vl0ZOhIb9556_9bZ7l8-U098PThUdcuP4Redy0ZlE2--D3xxqUTQ3v988OAtC1AmC3CQSVRRyvs14maWxSE59caXeVyjJVB5R5LCG8VAkoqWMJ3QYleLWq_B5lsweT3618XUhqvFmZYev6dnx1_3D1ddz6cnNDHi3Mr_zfEf_3fzp_mu3-deiw6m313CZ7m7STla_DYgAfrt0_WZst1JLM8lXb19bDBax-6JjuBYeLTQJOItC1ImC3GQSVRTR0m2uOF4cloKSqxotdCY3HC3_SeFHnN7gS-1u3_cBacbD64a71Lqi4RQLsJAJdKwJ2m0FQWURDv1RNxR2WgJKqUtyuhMaKq09SXJ_f4Frs76C9O8jbKQ5WP9y1_gUVt0iAnUSga0XAbjMIKoto6JeuqbjDElBSVYrbldBYcf1JigfnN3gg9nfYthYcrH24Z4MLCm6xf3YQgK4VALtNIKgsoqFbQU29HZaAkqrS266ExnoHf-H_AD6o6N5kq2SZmbPe8DvbPZn4yewzypJ1OjU_0mS6W2b_592O230Qmyzff8v7P66X-6-2Bb6HuQjzezg4gdkOZtWIHjShVbcJrbVMKzFxLSeuxaVDeWUZZlC3TKtOI7rXhNag0wIxcXCzQwtYFeGuCINN9-RG6cqd0hfpgQwPmogtw0hsQAOxZRqJLdNIbAazFA1TeawAtwGN5AY4shvhoNMBjvxmeaQywkvTRcJLjrM8XtDW5fnCwHIuTRirR7BMw2cwwNFDWMbhU1jGoa3yeOU-CL40X61slWloq4xDWwGOWlbGoa2lKXsSvGJwfJKnbAEv2apKo8bGViVPGgVOb0o-x4DgAI1sRTiwFeDIVoDDQ7M8ZFUIgi9NWRtbAY1sBTiyFeGoZWUc2arkI6zqA1yesgW8bKt8ikVblyeN7oB3rdKksbEV0MhWhANbAY5sBTiyVctDVisQfGnKWr3lyjR8zZVx-J4LcPSiK-PIVi0fZTWKTp6yBbxkq5bPssWtT97--RMAAP__PjPThQ==

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v2jwUxu_fT4HO1TvNKLGT8CdSpU5TpyFVdGq527hIiVeQKEFOkMqqfveJUNSF0PPEScldafKzDz6_h-NnWiWxHkePOqXwJ0kSpEiQR4J8EhTQVNDaJDOdponZvbIHRvETha6gxWq9yXb_ngqaJUZT-EzZIltqCmkS3S_1rY5ibRyXBMU6ixbLfJu1WTxGZnv5tP1DgrrObstvi2WmTdi5lJ1fG9f1Zh0VhuFoPBmQoJtNtntC0xdBySZ73fRtr_ttZx6l8-Iu-ftTQWkWPWgK5YuoV3xgX7y--Ojq1bvVv62zWSUm1kbHhZWmOxK9cuIIvkfp_E5nN2tHHrVvsl3rsDMaT65u766-Tjpfrq9J0FL_zv6_lJ8uzOJhnv_17ld_-1qeTVPuEpNp48jg-KQ-v7u-X-HYTp3I66Inihgn3WTtKPf4jE9uHxS2l9Wdk5xzjuo6XvuRsSi_V6f8c4dGthsa2VJoQFsOoenVDY2q3nbFtt3rOn771lqU369T_rmtVe1aq1qyFrTlYG2_rrVe9bZ7bNv9bn4BaNlai_IHdco_t7Veu9Z6LVkL2nKwdlDXWr9623227UG3fWctih_aF39uY_12jfVbMhY05WDs8COu1CfWv9XpOlmlutJt2d2dmY4f9L4HabIxM_3DJLN8m_3Hm5zLbz2xTrP9U7X_MFrtH-0KrA73m8BSNqKDRvSQp6XFmSk7uN8EPjozWzpoRA95Wh3T7r-0V4DdY9hjYZ_vls_CSvJbB03ywcMgHzyM8gFokA9Ag3z0muSDh0E-eBjlA9AgH4AG-eizlg54SQdN8jFsYjgPA8N5GBkOaGA4oNEEsBmb5V9Sm7lpS8MhYDU5rXGguSxNkYKqUvGiS36MANNlaY7YqA5o4DqgkewIB7YjHOlemqFWuvM00p2noe4AR7oDHOleGqRF3XtA99JMsdK9NFOsdOdppDtPQ90BjnQHONK9NE-tdOdppDtPQ90BjnQHONK9NFWLd22X112VZgur-_Tlv78BAAD__9a7lLA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FWhWrWpkzwdflq6Uqr1Vka5IlbBrWfjiabBEMLKNFBrlv1dAgeDB7_F4DLsEc2aOz7znkc07W6WxnkSvOmfhX4wzjwnmMck8ppjHemzmsXWWznWep9nuKwfBOH5jYeCxZLXeFLuPZx6bp5lm4TsrkmKpWcim0felftJRrDM_YB6LdREly_026yx5jbLtw9v2X-axrr_b8vdkWegs7Dzwzt-bIJDzjgjDcDyZDpnHHjfF7gqbfXgs3RTnTfMietEs5B9efWO_JXmRrOaF37t0Zax_lnzfdhZRvrjy_bMHYePhczi8QTr6i008slE8vN18VKWJ8zqbVZrFOtPxxUr7VSptigDYPFvo3coCSupsoe9gwWvk8o8oXzzr4nHty1JS0-1ah53xZPr16fnrr9POL9--MY8t9T_Fjw_8py9Z8rLY_1VjwgY2E_acZoXOfGmk9nPl-sMasV1L5P9Fr5iYpN107augnPHV7UcX23OLblPV9kXXl-2iD1g7TWz_huiziadRPi7wqxsQbzchVWnCkTy8IfxatICSqoKfnQVn-PE7wQ9M2BF-Rmp14Sfq10uQ7ZJdX7VLH2DtNDKDG9LHIh7eKB8X-tQNiLebkKo04Vh90ZA-LVpASVXRx86CM33EnegDJuxIHyO1uvSR9eslyXap7v79q0X6AGunkRnekD4W8fBG-bjQp25AvN2EVKUJx-rLhvRp0QJKqoo-dhac6SPvRB8wYUf6GKnVpY-qXy9FtqvXbZc9wNhpYEY3ZI9FOLxBOi7kqRsPbzcfVWnCsfaqIXlatICSqiKPnQVn8qg7kQdM2JE8RmpNfnK6sv6TztfpKte1fk0Kdpnp-EUfziBPN9lc_5ml8_02h38f97r9B7HOi8NVfvhnvDpc2hn8LOZlMf8sVhdibifm0kUtuJN65KKWA1otyMQlnbgkt-7RO9NiDs6LVgvhopaBk3pIqxWZeJ8W9yzEoizuk-IBfdYDUgzueUiKFSj2iKZCALBgQMWKC7QagoGWQzIAOUIDLUds4AZaLoMXIHiDLTZ4AGrEByBHgAByRAgkB3XhBmEug0fR0YgpyQ1McBoyvA-OncYMunWaM3wINjdIY1V2Wg3LTsth2YEclZ2Ww7LTlBWAsoJGDZhYoEZlB3JUdiBHZUdyMPGCpqwAQyfoJ7iS3Ci7oFEjFDh2GjXo1mnSCEAaYZDGpuxAjcoO5KjsSA7KDuTwqZ-mrACUFTRqUNkBZdG5AUyisgNMorIDOZp4mrISTI2kX5BLcqPskkaNBA90kkYNuHVJk0YC0kiDNDZlB2pUdiBHZUdyUHYgR2WXNGUloKykUYPe8gFl0bkBTKL3fIBJ9KIP5GjiacpKdOz0W3NJbpadRo0CD3SKRk351mcfP_wXAAD___7XJKA=

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1v2koUhvf3V1hnda_uIHvGNh-WIlFVqYoUkSph17Jw8DQgEYzGRgqN-O8VEJqCyXk9dvAuBD8zx3OelzMvtEgTPYyfdEbRd5IkSJEgnwQFJCiksaClSSc6y1KzfWQPDJJnijxBs8VylW__PRY0SY2m6IXyWT7XFNEofpjrOx0n2rgeCUp0Hs_mu22WZvYUm3X_ef2LBLXc7ZZfZvNcm8jpS-fHyvP8ieNHUTQYjrok6HaVR05f0XgjKF3lr5u-7fWwdqZxNj3epS9pvBkLyvL4UVMkN6Ja8aF98frKkR9bvXq3-rd1VovUJNro5Gil8ZZEj5w5gq9xNr3X-e3SlSftG62XOnIGw9H13f3155Hz6eaGBM31z_zfvvzvyswep7u__ry6PHn1t9fybZpyn5pcG1eGpyf1_7vrByWO7dyJvC56pohh2kqXrvJOz_js9uHR9rK8c5JzzlUt128-Mhblt6uUf-nQyGZDIxsKDWjLITTtqqFR5duu2Lb7LTdo3lqL8jtVyr-0tapZa1VD1oK2HKztVLXWL992n2170NpdABq21qL8bpXyL22t36y1fkPWgrYcrO1WtTYo3_aAbXvYat5Zi-J79sVf2tigWWODhowFTTkY2_uIK_WZ9e90tkwXmS51W_a2Z6aTR73vQZauzER_M-lkt83-4-2O2916Ep3l-2_V_sNgsf9qW2B5uFMHlrIWHdaiezwtLc5M2cGdOvDJmdnSYS26x9PqlPb-pv0j2DuFfRYO-G4FLKwkv3VYJx88DPLBwygfgAb5ADTIR7tOPngY5IOHUT4ADfIBaJCPDmtpl5e0WycfvTqG8zAwnIeR4YAGhgMaTQCbsVn8JbWZm7Y0HAJWk9MaB5rLwhQ5UlUqXnTJjxFguizMERvVAQ1cBzSSHeHAdoQj3Qsz1Ep3nka68zTUHeBId4Aj3QuD9Fj3NtC9MFOsdC_MFCvdeRrpztNQd4Aj3QGOdC_MUyvdeRrpztNQd4Aj3QGOdC9M1eO7tsfrrgqzhdV9vPnndwAAAP__u-iUug==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mEuP4kYcxO_5FFafEsXI7gePsbQSUbJRRlox0Qy3hIMXdwZLLEa2kZaM5rtHQIDBjf_ldhtuvKq7XP2vn2ze2CpL9CT-pgsW_cU485lgPpPMZ4r5rM9mPlvn2VwXRZbvfnIQPCbfWRT6LF2tN-Xu45nP5lmuWfTGyrRcahaxafx1qZ91nOg8CJnPEl3G6XK_zTpPv8X5dvx9-y_zWS_Ybfl7uix1Hnlj7v29CUM592QURY-T6Yj57GlTRt5YsNm7z7JNed60KONXzSL-7jc39ltalOlqXgb9S1djXln_LPm69RZxsbjy-7MHYePhYzi8RTr6k8ebxyNbxcO7zUfVmjivs1lleaJznVystF-l1qYIgc2zhf6tLKCkzhYGDhb8Vi7_iIvFiy6f1oGsJDXdrnXkPU6mn59fPv869X758oX5bKn_KX8c858-5enrYv_qNGH1lzW0mbCXLC91HkgjtZ9r1x81iO1aIv8vesXEJOtl60CF1Yyvbv9wsT236DZV7UD0Atkt-oC108QObog-m3ha5eMCv6YB8W4TUrUmHMnDW8KvQwsoqTr42Vlwhh-_E_zAhB3hZ6TWFH6ieb0E2S7ZC1S39AHWTiMzvCF9LOLhrfJxoU_TgHi3CalaE47VFy3p06EFlFQdfewsONNH3Ik-YMKO9DFSa0of2bxekmyX6u2fvzqkD7B2GpnRDeljEQ9vlY8LfZoGxLtNSNWacKy-bEmfDi2gpOroY2fBmT7yTvQBE3akj5FaU_qo5vVSZLv6vW7ZA4ydBubhhuyxCIe3SMeFPE3j4d3mo2pNONZetSRPhxZQUnXksbPgTB51J_KACTuSx0itzV9OV9Z_1sU6WxW60b9J4S4znbzqwxkU2Saf6z_zbL7f5vD2aa_bf5Doojx8yw9vHleHr3YGP4p5Vcw_itWFmNuJuXRRC-6kfnBRyyGtFmTikk5cklv36Z1pMQfnRauFcFHL0Ek9otWKTHxAi_sWYlEVD0jxkD7rISkG1zwixQoU-4GmQgiwYEDFigu0GoKBlkMyADlCAy1HbOAGWi6DFyB4gy02eABqxAcgR4AAckQIJAd14QZhLoNH0dGIqcgNTHAaMnwAjp3GDLp0mjN8BDY3SGNVdloNy07LYdmBHJWdlsOy05QVgLKCRg2YWKBGZQdyVHYgR2VHcjDxgqasAEMn6Du4itwou6BRIxQ4dho16NJp0ghAGmGQxqbsQI3KDuSo7EgOyg7k8K6fpqwAlBU0alDZAWXRuQFMorIDTKKyAzmaeJqyEkyNpB-QK3Kj7JJGjQQ3dJJGDbh0SZNGAtJIgzQ2ZQdqVHYgR2VHclB2IEdllzRlJaCspFGDnvIBZdG5AUyi53yASfSgD-Ro4mnKSnTs9FNzRW6WnUaNAjd0ikZN9dJn7z_8FwAA__9LeSSq

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllGL2kwUhu-_XyHn6itMiDNJ3DVQsJSFCosW17uSi6yZquA6YRJh7eJ_L0m6WKM9Z6aj6WU0z8w7cx7I-wZblclJ-iILiL8BBwYCGATAIAQGESQMcq0WsiiUrl5pgHH2CnGfwXqb78rq54TBQmkJ8RuU63IjIYZ5-ryRM5lmUvt9YJDJMl1v6m1yvX5J9X70uv8BDDy_2nK6K-PeiLORgOTAQO3KX0sfV3ze91ZpsTpd6x1JGBRlupQQ8wP7u5SRaUrBRtw1pfhjyuNSu63SmdQyO1ksqUjqlQtH_ZIWqydZTnOft-Yx3-cy7o0n84fZ08Pnee_T4yMw2Mjv5f918A8f9Xq5en_AhnU8X-BwvgvhJ8pTuc-j9k1c3Ds82ZubG8AxA3zh-cENTbXIOTDPeX1Xebeu8q5dFeZzEOgcAs8Pb-iLRc4785zX90V064vo2pfAfA4BOofQqz9Bt_LFIue9ec7r-xJ060vQtS-h-RxCdA6Rd0NbLFIOTVNe35WwW1fCf9mbLkSbySJX20IataJ-dTiZLWVzWYXa6YX8qtWi3qZ5nNZc_Y3PZFE2_4rmYbxt_qoCmsMDF3joAnOn3DzCaW5xZcIOHrjAQxeYO-VuXdkZLdp0_3c6wO87QGF-emf9Nh26CI7DhOA4TAiOw5TgBE0IHrkIjsOE4DhMCI7DlOAETQg-cBH8zkVRHCYUxWFCURymFCVoQtF7F0VxmFAUhwlFcZhSlKAJRYcuinKnnkDQhKQETVhK0JSmFE51Bbey4NYW3OqCY19wKwzcqTHws8pgZStOU7biNGUrTpO2Ejhlq01ZOp-ZTVuypSlbrfqSNU7ZelYeUFuTw38_AwAA__8RXVfC

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4kwYxe_fTyFz9S5E4jOT-A8WXHYLWyjt0nq3eJGa2SpYI0mEuqXffVFZrYl5zkzGdC-t_WVOTp5zMuOrWCaxvo2edSaGPwUJT0jhCSU8EQhPhGLiiVWaTHWWJen2X_bAdfwihh1PzJerdb7988QT0yTVYvgq8nm-0GIoxtHjQt_rKNap3xGeiHUezRe7ZVbp_DlKN6OXzW_hiba_XfJunQ9bI_JGUkzePJGs8-Olszx60mJIb5758t_mWT5fTnM_PF373BJH6nHTmkXZ7DxyVCJtlLw3goydkN6IKp1QtZygJqwIKqUcL7VeJmmsUx2fXGx3lUqxsoPFHlWETakwsOyoouugwqsl9HuUzR50frfyVcGv8Walh63r2_HV_cPV13Hry82N8MRC_8r_393Ep8_p_Gn294NZAHuXdfk2aScrX4VFJ86u3T9ZmywixyXOl21f1WkfIOAwQN3G28fGCgsvLPrH1AtqwoygUopj8ql-_1xQhYFlVf1jp8K5f-ij-0eaD75k5161_aBOBwABh4fYa7wDLKwgCy8sOsDUC2rCjKBSimP6ZP0OuKAKA8uqOsBOhXMHyI_uAGU--Iqd-6C9OyhYdwAQcHiI_cY7wMIKsvDCogNMvaAmzAgqpTimT9XvgAuqMLCsqgPsVDh3gProDgjMBz9g5z5s12kAsPzhEQ4abwALI8jYCYv8mzpBTVgRVEpxTF5QP_8XVGFgWVX-7VQ45z_4l79DnJF2r7NVssy00a8Mne3N6fhJ783KknU61T_SZLpbZv_xbsft_hDrLN9_S_sP18v9V1uB72EqwvQeDk5gsoNJOtEDF1p2XWileFqyjiveccUuHfIr8zAB3TwtO050z4VWYNIC1nHwsEMLWBbhLguDm-7xg9LlJ6XP0gMeHrgEm4dRsAENgs3TKNg8jYJNoEtRmfK1ArINaBRugKN0IxxMOsBRvomvVEJ4qV04vJRx4usF3TrfLwRSTqWGsXoF8zR8BwMcvYR5HL6FeRymla9X6gPjS_1qlVaehmnlcZhWgKOR5XGY1lLLnhgvCWyf-JYt4KW0ylLV2KRV8k0jwe5N8vsYYBygUVoRDtIKcJRWgMNNM1-yMgTGl1rWJq2ARmkFOEorwtHI8jhKq-S3sLIPcL5lC3g5rfwuFt063zSqA85apaaxSSugUVoRDtIKcJRWgKO0Kr5klQTGl1rW6pTL0_CYy-PwnAtwdNDlcZRWxW9lFbKOb9kCXkqr4veyxVufvP33JwAA___vJvVt

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8K52piDLdnOh2HQMQorlHa0uRu5cGOtCaSxkR1oVvrfR5yGznF8XitudNc0fqTXR8_J0Qut0kTdxE8qp-g3CXJIkkM-ORSQQyFNHcp0OlN5nurtIzvgKnmmyHNoscrWxfbfU4dmqVYUvVCxKJaKIprED0t1p-JEadcjhxJVxItluU2mF0-x3lw8b_6SQ313u-Xtuoh6F4Kmrw6l6-Jt3fflHja9eZzPqwuVz08dyov4UVEkXp3T8oV28snGfO_rrFepTpRWSWWl6ZZEjxx5yZ9xPr9XxW3mioMzmGwyFfWubiaXd_eXPya979fX5NBS_Sk-X4gv3_TicV7-1fjq76_lm5T9PtWF0q4IDyv1tXH9oEXZjlXkbdEjIW7Sfpq50jus8dHtw8r2or1VgrPKlX3XP4v3BgkHthLKxoQWzBeWzAeF35s_ONV82f5gJXuwft8NzqKeQcKhrYSyMaEF9aQl9UDh9-oNT1XPb3-wPnuwQb8cth-vnkHCka2EsjGhBfV8S-qBwu_VG52qXtD-YAP2YMP-WcQzyDe2k0825rOgXWBJO1D2vXbjj7hmHln_TuVZuspVqxukt62ZSh7V7gzydK1n6pdOZ-U2u4-3JVdeIhKVF7tv5e7D1Wr31TZge3jYBRaiEx12osc8LQxqJs3gYRf4oGamdNiJHvO0PKS9_2m_AnuHsM_CAX9aAQtLwW8ddukPHgb9wcOoPwAN-gPQoD8GXfqDh0F_8DDqD0CD_gA06I8ha-mIl3TUpT_GXQznYWA4DyPDAQ0MBzSaACZjs_5LajI3TWk4BIwmpzEONBe1KVJRVUhedMGPEWC6qM0RE9UBDVwHNJId4cB2hCPdazPUSHeeRrrzNNQd4Eh3gCPda4O0qvsA6F6bKUa612aKke48jXTnaag7wJHuAEe61-apke48jXTnaag7wJHuAEe616Zq9a7t8brL2mxhdZ--fvoXAAD__9d5Rsc=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v2kwUhffvr0CzeqsamZk7fEqVUrWRGilKqoRdxcLB04BEMLKNFBrlv1dAgeDB93hsw46vM_fOmXseeXgT8yg0d8GLScTgl5DCE0p4goQntPBEW4w8sYijsUmSKF7_ZCu4CV_FoOWJ6XyxTNcfjzwxjmIjBm8inaYzIwZiGDzNzIMJQhP7LeGJ0KTBdLYps4inL0G8unpd_RGeaPrrkvfLdNC4kmL07olomR7WTdLg2YiBfPeK1_4-TdLpfJz67ePC1voHydOqMQmSyYnfH3pQLj183L-swQAqZYCs1wGd28RhneU8ikMTm_Bopc0quW2qFmjz0EL7XC0gpw4tdCq04JXq8keQTB5Ner_wKePUcLUwg8bN3fD64fH627Dx9fZWeGJmfqf_X8lPX-Lp82TzqsCEdV0m7DGKUxP7ZLn2OXf9XgHbTjnyb9ETTdxFzWjh61bW45Pl-0flpUN6ufD6qumTM79A9f1Qds7ILxcHarGASlkg6_VA5zZRER-yJMFqbAE5lUcwtxYqE0xeiGBgwnYEs1wrSjBVPECKzQ81fe2MEFB9PxXdMyLEwQFZiwVUygJZrwc6t4mK-VUlEVJjC8ipPIS4tVAZIepCCAETtkOI5VpRhFDxABGbH93c3HXcEAKq76eid0aEODgga7GASlkg6_VA5zZRMb9UEiE1toCcykOIWwuVEUIXQgiYsB1CLNeKIkQXD5Bm89NuOgME1N7PRP-MAHHYv6zBACplgKzXAZ3bRMXs6pL4qLEF5FQePtxaqIwPfSF8gAnb4cNyrczfMCfWfzDJIponptA_LK21ZyZ8NtszSKJlPDY_42i8KbN9e7_RbT4ITZJuv5XbNzfz7VfrBj-KZVYsP4r1kVi6iSVVUStZSd2voqYur1as48Q7TmzpNl-ZF0twXrxaqSpqalVS93i1Zh3v8OK2g1hlxR1W3OXPusuKwZ57rFiDYPd5KrQAFiyoOHGBV0Mw8HJIBiBHaODliA3SQsux8QoYb7HFBQ9AjfgA5AgQQI4IgeQgLtIizLHxyDoeMRm5hQnJQ0Z2wLHzmEFb5zkje6C4RRqnsPNqGHZeDsMO5CjsvByGnaesApRVPGrAxAI1CjuQo7ADOQo7koOJVzxlFRg6xT_BZeRW2BWPGqXBsfOoQVvnSaMAaZRFGpewAzUKO5CjsCM5CDuQw6d-nrIKUFbxqEFhB5RF5wYwicIOMInCDuRo4nnKEpga4i_IGbkVduJRQ-CBjnjUgK0TTxoCpCGLNC5hB2oUdiBHYUdyEHYgR2EnnrIEKEs8atAtH1AWnRvAJLrnA0yiiz6Qo4nnKUvo2Plbc0Zuh51HjQYPdJpHTXbro_f__gYAAP__ACbWqA==

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8K52piDLdnOh2HQMQorlHa0uRu5cGOtCaSxkR1oVvrfR5yGznF8XitudNc0fqTXR8_J0Qut0kTdxE8qp-g3CXJIkkM-ORSQQyFNHcp0OlN5nurtIzvgKnmmyHNoscrWxfbfU4dmqVYUvVCxKJaKIprED0t1p-JEadcjhxJVxItluU2mF0-x3lw8b_6SQ313u-Xtuoh6F4Kmrw6l6-Jt3fflHja9eZzPqwuVz08dyov4UVEkXp3T8oV28snGfO_rrFepTpRWSWWl6ZZEjxx5yZ9xPr9XxW3mioMzmGwyFfWubiaXd_eXPya979fX5NBS_Sk-X4gv3_TicV7-1fjq76_lm5T9PtWF0q4IDyv1tXH9oEXZjlXkbdEjIW7Sfpq50jus8dHtw8r2or1VgrPKlX3XP4v3BgkHthLKxoQWzBeWzAeF35s_ONV82f5gJXuwft8NzqKeQcKhrYSyMaEF9aQl9UDh9-oNT1XPb3-wPnuwQb8cth-vnkHCka2EsjGhBfV8S-qBwu_VG52qXtD-YAP2YMP-WcQzyDe2k0825rOgXWBJO1D2vXbjj7hmHln_TuVZuspVqxukt62ZSh7V7gzydK1n6pdOZ-U2u4-3JVdeIhKVF7tv5e7D1Wr31TZge3jYBRaiEx12osc8LQxqJs3gYRf4oGamdNiJHvO0PKS9_2m_AnuHsM_CAX9aAQtLwW8ddukPHgb9wcOoPwAN-gPQoD8GXfqDh0F_8DDqD0CD_gA06I8ha-mIl3TUpT_GXQznYWA4DyPDAQ0MBzSaACZjs_5LajI3TWk4BIwmpzEONBe1KVJRVUhedMGPEWC6qM0RE9UBDVwHNJId4cB2hCPdazPUSHeeRrrzNNQd4Eh3gCPda4O0qvsA6F6bKUa612aKke48jXTnaag7wJHuAEe61-apke48jXTnaag7wJHuAEe616Zq9a7t8brL2mxhdZ--fvoXAAD__9d5Rsc=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v2kwUhffvr0CzeqsamZk7fEqVUrWRGilKqoRdxcLB04BEMLKNFBrlv1dAgeDB93hsw46vM_fOmXseeXgT8yg0d8GLScTgl5DCE0p4goQntPBEW4w8sYijsUmSKF7_ZCu4CV_FoOWJ6XyxTNcfjzwxjmIjBm8inaYzIwZiGDzNzIMJQhP7LeGJ0KTBdLYps4inL0G8unpd_RGeaPrrkvfLdNC4kmL07olomR7WTdLg2YiBfPeK1_4-TdLpfJz67ePC1voHydOqMQmSyYnfH3pQLj183L-swQAqZYCs1wGd28RhneU8ikMTm_Bopc0quW2qFmjz0EL7XC0gpw4tdCq04JXq8keQTB5Ner_wKePUcLUwg8bN3fD64fH627Dx9fZWeGJmfqf_X8lPX-Lp82TzqsCEdV0m7DGKUxP7ZLn2OXf9XgHbTjnyb9ETTdxFzWjh61bW45Pl-0flpUN6ufD6qumTM79A9f1Qds7ILxcHarGASlkg6_VA5zZRER-yJMFqbAE5lUcwtxYqE0xeiGBgwnYEs1wrSjBVPECKzQ81fe2MEFB9PxXdMyLEwQFZiwVUygJZrwc6t4mK-VUlEVJjC8ipPIS4tVAZIepCCAETtkOI5VpRhFDxABGbH93c3HXcEAKq76eid0aEODgga7GASlkg6_VA5zZRMb9UEiE1toCcykOIWwuVEUIXQgiYsB1CLNeKIkQXD5Bm89NuOgME1N7PRP-MAHHYv6zBACplgKzXAZ3bRMXs6pL4qLEF5FQePtxaqIwPfSF8gAnb4cNyrczfMCfWfzDJIponptA_LK21ZyZ8NtszSKJlPDY_42i8KbN9e7_RbT4ITZJuv5XbNzfz7VfrBj-KZVYsP4r1kVi6iSVVUStZSd2voqYur1as48Q7TmzpNl-ZF0twXrxaqSpqalVS93i1Zh3v8OK2g1hlxR1W3OXPusuKwZ57rFiDYPd5KrQAFiyoOHGBV0Mw8HJIBiBHaODliA3SQsux8QoYb7HFBQ9AjfgA5AgQQI4IgeQgLtIizLHxyDoeMRm5hQnJQ0Z2wLHzmEFb5zkje6C4RRqnsPNqGHZeDsMO5CjsvByGnaesApRVPGrAxAI1CjuQo7ADOQo7koOJVzxlFRg6xT_BZeRW2BWPGqXBsfOoQVvnSaMAaZRFGpewAzUKO5CjsCM5CDuQw6d-nrIKUFbxqEFhB5RF5wYwicIOMInCDuRo4nnKEpga4i_IGbkVduJRQ-CBjnjUgK0TTxoCpCGLNC5hB2oUdiBHYUdyEHYgR2EnnrIEKEs8atAtH1AWnRvAJLrnA0yiiz6Qo4nnKUvo2Plbc0Zuh51HjQYPdJpHTXbro_f__gYAAP__ACbWqA==

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpgQZ5K4a6BgKQsVFi2udyUXWTNVwXXCJMLaxXcvSUqtUc_JdOr0bt3km_nnzAf532CrMjlJX2QB8TfgwEAAgwAYhMAggoRBrtVCFoXS1SsNMM5eIe4zWG_zXVn9O2GwUFpC_AblutxIiGGePm_kTKaZ1H4fGGSyTNebeptcr19SvR-97n8AA8-vtpzuyrg3EpAcGKhd-Wvd43LP-94qLVanC404JIeEQVGmSwkxP7C_yxe5ySeu5juus9sqnUkts5OVkoqkXrlwyC9psXqS5TT3eesO5vtcxr3xZP4we3r4PO99enwEBhv5vXw_4h8-6vVyVf_1--i8dfTjsQKLY13IPFGeyn0etQdwce_wZG_e_co5duW-8PzgJlIaJBy4SiiuJnSgJXekpeg-eIEOPvD88CZqGCS8c5VQXE3oQA3hSI2g--ADdPChV39J_r0aBgnvXSUUVxM6UCNwpEbYffAhOvjIu4kYBvmGbvKJq_kcaBH-h45zIdFMFrnaFrJTg-lXZ5LZUjYzKtROL-RXrRb1Ns3Pac3V3-ZMFmXzVDQ_xtvmURWwOzywgYc2MLfKzSOc5gYjE2bwwAYe2sDcKndrZGe0aNP9P-kAn3eAwvx0Zv02HdoIjsOE4DhMCI7DlOAETQge2QiOw4TgOEwIjsOU4ARNCD6wEfzORlEcJhTFYUJRHKYUJWhC0XsbRXGYUBSHCUVxmFKUoAlFhzaKcqueQNCEpARNWErQlKYUTnUFu7Jg1xbs6oJlX7ArDNyqMfCzymBkK05TtuI0ZStOk7YSOGWrSVk6vzOTtmRKU7Ya9SVjnLL1rDygtiaHdz8DAAD__6FyQjI=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpgQZ5K4a6BgKQsVFi2udyUXWTNVwXXCJMLaxXcvSUqtUc_JdOr0bt3km_nnzAf532CrMjlJX2QB8TfgwEAAgwAYhMAggoRBrtVCFoXS1SsNMM5eIe4zWG_zXVn9O2GwUFpC_AblutxIiGGePm_kTKaZ1H4fGGSyTNebeptcr19SvR-97n8AA8-vtpzuyrg3EpAcGKhd-Wvd43LP-94qLVanC404JIeEQVGmSwkxP7C_yxe5ySeu5juus9sqnUkts5OVkoqkXrlwyC9psXqS5TT3eesO5vtcxr3xZP4we3r4PO99enwEBhv5vXw_4h8-6vVyVf_1--i8dfTjsQKLY13IPFGeyn0etQdwce_wZG_e_co5duW-8PzgJlIaJBy4SiiuJnSgJXekpeg-eIEOPvD88CZqGCS8c5VQXE3oQA3hSI2g--ADdPChV39J_r0aBgnvXSUUVxM6UCNwpEbYffAhOvjIu4kYBvmGbvKJq_kcaBH-h45zIdFMFrnaFrJTg-lXZ5LZUjYzKtROL-RXrRb1Ns3Pac3V3-ZMFmXzVDQ_xtvmURWwOzywgYc2MLfKzSOc5gYjE2bwwAYe2sDcKndrZGe0aNP9P-kAn3eAwvx0Zv02HdoIjsOE4DhMCI7DlOAETQge2QiOw4TgOEwIjsOU4ARNCD6wEfzORlEcJhTFYUJRHKYUJWhC0XsbRXGYUBSHCUVxmFKUoAlFhzaKcqueQNCEpARNWErQlKYUTnUFu7Jg1xbs6oJlX7ArDNyqMfCzymBkK05TtuI0ZStOk7YSOGWrSVk6vzOTtmRKU7Ya9SVjnLL1rDygtiaHdz8DAAD__6FyQjI=

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpgQZ5K4a6BgKQsVFi2udyUXWTNVwXXCJMLaxXcvSbpYo56T6eD0Muo38-ecD_zfYKsyOUlfZAHxD-DAQACDABiEwCCChEGu1UIWhdLVTxpgnL1C3Gew3ua7svo4YbBQWkL8BuW63EiIYZ4-b-RMppnUfh8YZLJM15v6mlyvX1K9H73ufwEDz6-unO7KuDfibCQgOTBQu_LP0ccTn_e9VVqsTs96RxIGRZkuJcT8wP4tZeQypbia8njUbqt0JrXMTg5LKpL6yYVX_ZYWqydZTnOft_Yx3-cy7o0n84fZ08PXee_L4yMw2Mif5cc6-KfPer1cvT8cx9CawfHlAouXu5B8ojyV-zxqj-Hi3eHJ3bz7-jm2fl94fnBDTQ1yDtzmFFdzOhCVOxVVdF-CQJcQeH54Q1kMct65zSmu5nQgi3AqS9B9CQG6hNCr_3luJYtBznu3OcXVnA5kCZzKEnZfQoguIfJuqIpByqHLlOJqSgeihP-tK13INZNFrraF7NSE-tWbyWwpm0kVaqcX8rtWi_qa5nFac_X_eiaLsvlWNA_jbfNVFbA7PLCBhzYwt8rNI5zmBiMTZvDABh7awNwqd2tkZ7Ro0_2_6QCfd4DC_HRm_TYd2giOw4TgOEwIjsOU4ARNCB7ZCI7DhOA4TAiOw5TgBE0IPrAR_M5GURwmFMVhQlEcphQlaELRextFcZhQFIcJRXGYUpSgCUWHNopyq55A0ISkBE1YStCUphROdQW7smDXFuzqgmVfsCsM3Kox8LPKYGQrTlO24jRlK06TthI4ZatJWTrfmUlbMqUpW436kjFO2XpWHlBbk8OH3wEAAP__BoVUrA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4loUxd_vp5D9dC9E4j4n8R9c6OVOYQqlHVrfBh9Sc6YK1kgSoU7pdx9URmti9srJn86jtb-cdVb2WjnxjVZRaO6CF5PQ-DsxOaTIIU0OeeSQT1OH1nE0M0kSxbt_OQA34SuNew4tVutNuvvz1KFZFBsav1G6SJeGxjQJnpbmwQShid0eORSaNFgs98us48VLEG-vXrc_yaGuu1vyfpOOO1fsXCmavjsUbdLTpZM0eDY05nen_PJfFkm6WM1S1z9f-9ISJ-pp25kHyfwyclKibJR8NIKbcUJXcoLbsMIrlHK61GYVxaGJTXh2sf1VCsWqHhZ7UuG3paKEZScV_RoqnEpCvwbJ_NGk92tXZ_yabNdm3Lm5m1w_PF7_P-n8d3tLDi3Nj_Tv_Sb--TdePM9_fziNXeHmBs1afBd1o7Wr_awNF9cenq3NFnmT4uaqrqurVA8QcJyefuvVY2NFU17oSl5wG2Z4hVJqxp6rl0-DKkpYVlQ-dipqlw9_avmo8lOvxKHXXderUgBAwPEODlovAAsruCkvdCUvuA0zvEIpNaOnqhdAgypKWFZUAHYqaheA-tQC0OWnXotD73X37wfWBQAEHO_gsPUCsLCCm_JCV_KC2zDDK5RSM3q6egE0qKKEZUUFYKeidgHoTy0Ar_zUe-LQ-90q8QfLH-_fqPX4WxjBzTihKznBbVjhFUqpGTuvevgbVFHCsqLw26moHX7vj_32cEHXg0nW0SoxpX5Z6O12ZsJnc3AqiTbxzHyLo9l-mcPH-z23_0NokvTwLR8-3KwOX-0EfoQ5C_NH2DuD2Q5mVYse1aFVvw6ttUwr0XEtO67FpX15ZRlmoFumVa8WPahDazBpnug4uNm-BayycF-EwaYH8qD05UkZivRIhkd1gi3DKNiABsGWaRRsmUbBZtClqEzlWgHZBjQKN8BRuhEOJh3gKN8sVyojPNcuEp7LOMv1grYu9wuDlHOuYawewTINn8EARw9hGYdPYRmHaZXrlYfA-Fy_WqVVpmFaZRymFeBoZGUcpjXXsmfGKwbHJ7llM3gurSpXNTZpVXLTKHB6U_I5BhgHaJRWhIO0AhylFeDw0CyXrPKB8bmWtUkroFFaAY7SinA0sjKO0qrkI6waAlxu2QyeT6t8ikVbl5tG98C7Vq5pbNIKaJRWhIO0AhylFeAorVouWa2A8bmWtXrLlWn4mivj8D0X4OhFV8ZRWrV8lNXIOrllM3gurVo-y2a3Pn3_61cAAAD__5LJ8lc=

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ls9q20AQh-99CjOnlq6RdiX5j6DgUgINhCQkORSKDoq1jQ2OJVYyxA1-92I7JpXlzE9r2brFsb7Z0cw3nn2leZro6_hZ5xT-JkmCFAnySJBPggKKBGUmHes8T836kS1wmbxQ6AqazrNFsf53JGicGk3hKxXTYqYppIf4cabvdJxo47gkKNFFPJ1tjsnM9Dk2y9HL8i8J6jrrI28WRdgZKYpWgtJF8Rb3PdzjsjOJ80k50EhStIoE5UX8pCmUK3FcfkHd_GSj_NSH-b3HWcxTk2ijk1KkaE2iRw685M84n9zr4iZz5F4PHpaZDjsXv35c3D50vl9dkaCZ_lN8Hskv38z0abL568P3fn8nz6bm96kptHFksF-mrx_G92vU7FA53oIeSOI67aaZo9z9Ah88PigdL-srJTmlHNV1vLNIb5Fhr36Gp9Retqu9bEN7UPWd9r1jtVf1u6rYrnpdxz-LdxYZ9utneErvVLveqTa8A1Xfedc_1juvflc9tqt-d7NjT--dRYaD-hme0juvXe-8NrwDVd95NzjWO79-V322q0H3LNZZ5Desm98pnfPbdc5vwzlQ851zw1NcLQ_Ev9N5ls5zXevW6K4LppMnvW1Ani7MWN-adLw5ZvvxZsNt7g6Jzovtt2r74XK-_WqdYH243wSWshEdNKKHPC0taqbs4H4TeK9mtnTQiB7ytNqn3f9prwS7-7DHwj7fLZ-FleSPDprMBw-D-eBhNB-ABvMBaDAfvSbzwcNgPngYzQegwXwAGsxHn7V0wEs6aDIfwyaG8zAwnIeR4YAGhgMabQCbtVn9JbXZm7Y0XAJWm9MaB5rLyhYpqSoVL7rk1wgwXVb2iI3qgAauAxrJjnBgO8KR7pUdaqU7TyPdeRrqDnCkO8CR7pVFWta9B3Sv7BQr3Ss7xUp3nka68zTUHeBId4Aj3Sv71Ep3nka68zTUHeBId4Aj3StbtXzXdnndVWW3sLpHq0__AgAA__-EA0JE

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1rOkcUxu_7KeRctXRlnRdfoWBpAw2EJCS5KBQvNu40CsaV3RViQ757Uf9q3HHPM-Ou3vn2zDnzzHl-7PhJ8yQ299G7yWjwDwkKSFJAigLSFFCbRgEt0mRssixJ1z_ZCm7jDxq0AprOF8t8_fEooHGSGhp8Uj7NZ4YG9BK9zsyTiWKThi0KKDZ5NJ1tyizS6XuUroYfq_8ooGa4LvmwzAeNoaTRV0DJMj-sm-XRm6GB-Arca_85zfLpfJyH7ePCQ1FY_yB5XTUmUTY58ftDD9Knh-_7F84GFBs8FFdnGSDqdUCXNnFYZzlP0tikJj5aabNKaZuyBdo8tNC-VAvIqUMLnQotBGd1-VeUTZ5N_rAIVcGpl9XCDBo3f_9x8_jS-P3ujgKamX_zn4fil9_S6dtk88phvLo-4_WcpLlJQ2VZ9mvp-j0Hz07Z8WPRE03cJ81kEepW0eCT5ftH5YVHdLnkhrIZKm94ger7iexcEF4-DnhY4IovVwtEvR7o0iYqskOcia8aW0BOleHLr4XK-BLXwBcYrx2-LMtc8SXd0yPZ8KhmqL35AarvR6J7QX54OCA8LHDlh6sFol4PdGkTFcMrz-RHjS0gp8r44ddCZX7Ia_ADjNeOH5ZlrvxQ7ulRbHh0c3PF8eMHqL4fid4F-eHhgPCwwJUfrhaIej3QpU1UDK86kx81toCcKuOHXwuV-aGuwQ8wXjt-WJa58kO7p0ez4Wk3vekBau8Hon9BenjsXzgb4MoOVwNEvQ7o0iYqBlefyY4aW0BOlbHDr4XK7NDXYAcYrx07LMvO-evlxPpPJlsk88w4_avSWhtm4jezPYAsWaZj85gm402Z7duHjW7zQWyyfPut2L65nW-_Wjf4XSyKYvFdrI_Ewk8sVBW1FJXU_Spq1eXVknVc8Y4rtnSbr8yLBTgvXi1lFbVqVVL3eLVmHe_w4raHWBbFHVbc5c-6y4rBnnusWINg93kqtAAWLKh4cYFXQzDwckgGIEdo4OWIDcJCy7HxEhhvscUHD0CN-ADkCBBAjgiB5CAuwiLMsfHIOh4xBbmFCcFDRnTAsfOYQVvnOSN6oLhFGq-w82oYdl4Oww7kKOy8HIadp6wElJU8asDEAjUKO5CjsAM5CjuSg4mXPGUlGDrJP8EV5FbYJY8aqcGx86hBW-dJIwFppEUan7ADNQo7kKOwIzkIO5DDp36eshJQVvKoQWEHlEXnBjCJwg4wicIO5GjiecoqMDWKvyAX5FbYFY8aBR7oFI8asHXFk0YB0iiLND5hB2oUdiBHYUdyEHYgR2FXPGUVoKziUYNu-YCy6NwAJtE9H2ASXfSBHE08T1mFjp2_NRfkdth51GjwQKd51BS3Pvr66f8AAAD__wCg0iU=

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ltFq2zAUhu_3FOFcbSDjSLbTxjDIGIUVSlu6XAyGL9z4LAmksZEdaFby7sP2WBYnOceaFt01tT_p19EH_t9gnWd4n75gCfF3kCBAgYAABIQgIIJEQKHzGZZlrutXWuA2e4V4KGC5LjZV_e9EwCzXCPEbVMtqhRDDNH1e4ROmGWp_CAIyrNLlqtmm0MuXVG8nr9ufIMDz6y0fNlU8mChIdgLyTfV73f1yz9vBIi0XhwtNJCS7REBZpXOEWO7Ev-WL3ORTZ_Pt19msc52hxuxgpaQmuVdOHPJLWi6-YvVQ-LJzB9NtgfHg5tvnm8fp4NPdHQhY4Y_q_UR--KiX80Xz159zy86592cKLM50IvB97uWFL6Pu6U_uHR7sLfvft6Tu21eeH1zESIOEI1cJ1dmEDpyULpxU_aeuyKkHnh9exAuDhFeuEqqzCR14oVx4EfSfekBOPfSaD8j_98Ig4bWrhOpsQgdeBC68CPtPPSSnHnkXscIg39hNPnU2nwMnQte95kScJyyLfF1ir9YyrA-E2RzbAZX5Rs_wUeezZpv250PDNd_jDMuqfaraH7fr9lEdsD88soHHNrC0yi0jmpYGI1Nm8MgGHtvA0ip3Z2RHtOrSw7_pgJ53QMLycGbDLh3aCE7DjOA0zAhOw5zgDM0IHtkITsOM4DTMCE7DnOAMzQg-shH8ykZRGmYUpWFGURrmFGVoRtFrG0VpmFGUhhlFaZhTlKEZRcc2ikqrnsDQjKQMzVjK0JymHM51BbuyYNcW7OqCZV-wKwzSqjHIo8pgZCtNc7bSNGcrTbO2Mjhnq0lZOr4zk7ZkSnO2GvUlY5yz9ag8kLYmu3e_AgAA__9X8D2q

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l99r4koUx9_vXyHn6V6IxDOT-AsuuOwWtlDa0u3DwuJDamarYI0kEeqW_u-LClqT5nydZPStVT-ZM9-cz8nkjRZJbG6jF5PR8BcxeaTII00eBeRRSGOPlmkyMVmWpJuf7IDr-JWGHY9mi-Uq33w89miSpIaGb5TP8rmhIT1GT3PzYKLYpH6HPIpNHs3m22WW6ewlStej1_Uf8qjtb5a8W-XD1kjR-N2jZJUfrpvl0bOhIb97p6_9bZbls8Uk98PjhUdcuP4BeVq3plE2_eT3hxqUTQ0f988OAtC1AmC3CQSVRRyus1okaWxSEx9daXuVyjJVB5R5KCE8VwkoqUMJ3QYleLWq_B5l0x8mv1v6upDU43pphq2rn1-v7h9bX25uyKO5-Z3_O-L__k9nz9PtX_v2qt5Tz22st0k7Wfo6LO7-07X7R2uzhVeSVr5q-9p6soDV9-3SPeNksUnASQS6VgTsNoOgsoiGYnPN2eKwBJRU1WyxK6HxbOFLzBZ1encrsbl12w-s_Qar729Z74x-WyTATiLQtSJgtxkElUU0lEvV9NthCSipKr_tSmjst7qE3_r07tZicwft7fndzm-w-v6W9c_ot0UC7CQCXSsCdptBUFlEQ7l0Tb8dloCSqvLbroTGfutL-B2c3t2B2Nxh29pusPb-hg3OaLfF_tlBALpWAOw2gaCyiIZiBTXddlgCSqrKbbsSGrsdXPq9_5NyHky2TBaZOemtvrPZkImfzS6gLFmlE3OfJpPtMrt_77bc9oPYZPnuW979c73YfbUp8CPMRZg_wsERzHYwq0b0oAmtuk1orWVaiYlrOXEtLh3KK8swg7plWnUa0b0mtAadFoiJg5sdWsCqCHdFGGy6JzdKV-6UvkgPZHjQRGwZRmIDGogt00hsmUZiM5ilaJjKYwW4DWgkN8CR3QgHnQ5w5DfLI5URXpouEl5ynOXxgrYuzxcGlnNpwlg9gmUaPoMBjh7CMg6fwjIObZXHK_dB8KX5amWrTENbZRzaCnDUsjIObS1N2aPgFYPjkzxlC3jJVlUaNTa2KnnSKHB6U_I5BgQHaGQrwoGtAEe2AhwemuUhq0IQfGnK2tgKaGQrwJGtCEctK-PIViUfYVUf4PKULeBlW-VTLNq6PGl0B7xrlSaNja2ARrYiHNgKcGQrwJGtWh6yWoHgS1PW6i1XpuFrrozD91yAoxddGUe2avkoq1F08pQt4CVbtXyWLW59_P7P3wAAAP__8VPO_Q==

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1r40gQhu_7K0yddtk2UrckfwgCWZYMEwhJSHwYmPFBsXpig2OZlgzxhPz3QXJMRpZTr1qKdYsjPapy1_O69EKrJNbX0ZNOKfxOkgQpEuSRIJ8EBTQVtDbJTKdpYvJbdsBl_EyhK2ixWm-y_N9TQbPEaApfKFtkS00hTaKHpb7TUayN45KgWGfRYlmUWZvFU2S258_bXySo7-QlvyyWmTZh71z2fmxc15v1VBiGl9eTEQm62WT5FZq-Cko22VvR91oP2948SuflKsX9U0FpFj1qCuWraNZ8YN-8Pvvs7tWH3b8_Z7NKTKyNjktPmuYkuuXIEXyN0vm9zm7WjjwY32S71mHv4tv_F7eT3n9XVyRoqX9mf5_Lf87M4nFe_PXh937_Tp7NRO4Tk2njyODwmP798Pl-jTM7dhxvDz3SxHXST9aOcg8P-Gj5oFRe1hdOcsI5qu943efFov1Bk_ZPnRjZbWJkF4kBM9knZtA0Mar-zBU7c6_v-N0ra9H-sEn7p1ZWdaus6kJZMJO9ssOmynr1Z-6xM_f7xd7vWFmL9kdN2j-1sl63ynpdKAtmsld21FRZv_7MfXbmQb97YS2aH9s3f2pd_W519bvQFUxkr-v4M16jjzz_TqfrZJXqWm_Ibn5gOn7UuwGkycbM9K1JZkWZ3cebgitedmKdZruravfhcrW7lDdYHx62gaVsRQet6DFPS4szU3bwsA18cGa2dNCKHvO0OqTdP2mvBLuHsMfCPj8tn4WV5EsHbfLBwyAfPIzyAWiQD0CDfAza5IOHQT54GOUD0CAfgAb5GLKWjnhJR23yMW5jOA8Dw3kYGQ5oYDig0QawWZvVX1KbvWlLwyVgtTmtcaC5rGyRkqpS8aJLfo0A02Vlj9ioDmjgOqCR7AgHtiMc6V7ZoVa68zTSnaeh7gBHugMc6V5ZpGXdB0D3yk6x0r2yU6x052mkO09D3QGOdAc40r2yT61052mkO09D3QGOdAc40r2yVcvv2i6vu6rsFlb36etfvwMAAP__P5uQKA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v8kYcxO_9FGhPrWpk7wtvlh4pVftUjRQlUcKhUsvBwdtgiWBkGyk0ynevgALBi__j9RpuCWZ2x7P_-cnmgy3SWN9Hbzpn4V-MM48J5jHJPKaYx3ps4rFllk51nqfZ5is7wW38zsLAY8liuSo2H088Nk0zzcIPViTFXLOQjaOXuX7SUawzP2Aei3URJfPtNssseYuy9c37-l_msa6_2fL3ZF7oLOzc8M7fqyCQ044Iw_D2fjxkHntYFZsrbPLpsXRVHDfNi-hVs5B_evWN_ZbkRbKYFn7v1JWx_lHysu7Monx25vtHD8LGw9dweIN09DebeGSjeHi7-ahKE8d1Vos0i3Wm45OVtqtU2hQBsHm00LuUBZTU0ULfwYLXyOUfUT571sXD0pelpMbrpQ473__89fvjuPPL3R3z2Fz_U_x4w3_6liWvs-1fNcZrYDNez2lW6MyXRmQ_V64_rJHZuTj-X_SMifu0my59FZQDPrv96GR7blFsqte-6PqyXe4Ba4dx7V-QezbxNMrHhXx1A-LtJqQqTThihzckX4sWUFJV5LOz4Ew-fg3ygfHak8-IrC75RP1uCbJasuurdtEDrB3mZXBB9FjEwxvl44KeugHxdhNSlSYcey8aoqdFCyipKvTYWXBGj7gGesB47dFjRFYXPbJ-tyRZLdXdvna1iB5g7TAvwwuixyIe3igfF_TUDYi3m5CqNOHYe9kQPS1aQElVocfOgjN65DXQA8Zrjx4jsrroUfW7pchq9brtggcYO0zL6ILgsQiHN0jHBTt14-Ht5qMqTTh2XjXETosWUFJV2LGz4IwddQ3sgPHaY8eIrMnPTGfWf9L5Ml3kutYvSMEmMB2_6t0B5Okqm-rHLJ1ut9n9-7DVbT-IdV7srvLdP7eL3aWNwa9iXhbzr2J1IuZ2Yi5d1II7qUcuajmg1YJMXNKJS3LrHr0zLebgvGi1EC5qGTiph7RakYn3aXHPQizK4j4pHtBnPSDF4J6HpFiBYo9oKgQACwZUrLhAqyEYaDkkA5AjNNByxAZuoOU0eAGCN9higwegRnwAcgQIIEeEQHJQF24Q5jR4FB2NmJLcwASnIcP74NhpzKBbpznDh2BzgzRWZafVsOy0HJYdyFHZaTksO01ZASgraNSAiQVqVHYgR2UHclR2JAcTL2jKCjB0gn6CK8mNsgsaNUKBY6dRg26dJo0ApBEGaWzKDtSo7ECOyo7koOxADp_6acoKQFlBowaVHVAWnRvAJCo7wCQqO5CjiacpK8HUSPoFuSQ3yi5p1EjwQCdp1IBblzRpJCCNNEhjU3agRmUHclR2JAdlB3JUdklTVgLKSho16C0fUBadG8Akes8HmEQv-kCOJp6mrETHTr81l-Rm2WnUKPBAp2jUlG998vnDfwEAAP__h_QgGA==

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2koQhu_Pr7Dm6hydRfaubT4sRaKqUjVSlEQJF5VaLhy8DUgEo7WRQiP-ewWEpmAyr9cOzl0pPDvjnefN-JlmaaKv4kedUfSdJAlSJMgnQQEJCmkoaG7Skc6y1Kx_sgUukieKPEGT2XyRr_97KGiUGk3RM-WTfKopokF8P9W3Ok60cT0SlOg8nkw3ZeZm8hibZf9p-YsEtdx1yS-Taa5N5PSl82Pheb4-c2QURRdXgy4Jul7kkdNXNFwJShf5S9XXYvdLZxxn4_0yfUnD1VBQlscPmiK5EtW6D-27Hzn--zav3mz-9ZzFLDWJNjrZO2m4JtFPjtzA1zgb3-n8eu7Kg_ENlnMdOeffPp_fDJxPl5ckaKp_5v_25X9nZvIw3vzrz3PLg-d-fSbfZiB3qcm1cWV4eE3_v3l-UOLOjl3Hy6FHmrhKW-ncVd7hBR8tH-6Vl-V9k5xvrmq5_gfkxaL_dpX-T5wY2WxiZBOJASPZJaZdNTGq_MgVO3K_5QYfoKxF_50q_Z9YWdWssqoJZcFIdsp2qirrlx-5z448aG3WftPKWvTfrdL_iZX1m1XWb0JZMJKdst2qygblRx6wIw9bHyCsRfc9--5PrGvQrK5BE7qCgex07b3Ha_SR8291Nk9nmS71huytL0wnD3o7gCxdmJG-MeloU2b78XrDbV52Ep3l22_V9sPFbPvVusHycKcOLGUtOqxF93haWtyZsoM7deCDO7Olw1p0j6fVIe39Tft7sHcI-ywc8NMKWFhJvnRYJx88DPLBwygfgAb5ADTIR7tOPngY5IOHUT4ADfIBaJCPDmtpl5e0WycfvTqG8zAwnIeR4YAGhgMabQCbtVn8S2qzN21puASsNqc1DjSXhS2yp6pUvOiSXyPAdFnYIzaqAxq4DmgkO8KB7QhHuhd2qJXuPI1052moO8CR7gBHuhcW6b7ubaB7YadY6V7YKVa68zTSnaeh7gBHugMc6V7Yp1a68zTSnaeh7gBHugMc6V7Yqvvv2h6vuyrsFlb34eqf3wEAAP__4CmQMg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mEuP4kYcxO_5FFafEsXI7gcvSysRJRtlpNXMapdDpISDF3cGSyxGtpGGjOa7R0CAwY3_5XYbbryqu1z9r59sXtkqS_Rj_F0XLPqLceYzwXwmmc8U81mfzXy2zrO5Loos3_3kIHhIXlgU-ixdrTfl7uOZz-ZZrln0ysq0XGoWsWn8bam_6DjReRAynyW6jNPlfpt1nn6P8-3kZfsv81kv2G35e7osdR55E-79vQlDqT94PIqih8fpiPnsaVNG3kSw2ZvPsk153rUo42fNIv7mN3f2W1qU6WpeBv1LWxNeWf8s-bb1FnGxuPL7swdh4-F9OrxFPHNPNk9HtkqHdxuPqjVxXmezyvJE5zq5WGm_Sq1NEQKbZwv9W1lASZ0tDBws-K1c_hEXi6-6fFoHspLUdLvWkffxz18_fp56v3z6xHy21P-UP074Tx_y9Hmxf3Uar_prGtqM19csL3UeSCOyn2vXHzXI7Foc_y96xcRj1svWgQqrAV_dfnyxPbfoNVXrQPQC2TH3gLfTvA5uyD2bfFoF5EC-pvnwbgNStSYcscNbkq9DCyipOvLZWXAmH78H-cB4HclnRNaUfKJ5tQTZLNkLVMfoAd5OAzO8IXos8uGtAnJAT9N8eLcBqVoTjr0XLdHToQWUVB167Cw4o0fcAz1gvI7oMSJrih7ZvFqSbJbq7Z-6ukQP8HYamNEN0WORD28VkAN6mubDuw1I1Zpw7L1siZ4OLaCk6tBjZ8EZPfIe6AHjdUSPEVlT9Kjm1VJks_q9jsEDnJ3GZXxD8Fikw1vE44CdpunwbuNRtSYcO69aYqdDCyipOuzYWXDGjroHdsB4HbFjRNbmb6Yr63_RxTpbFbrRP0jhLjCdPOvDARTZJp_rz3k2329zePu01-0_SHRRHr7lhzcPq8NXO4Pvxbwq5u_F6kLM7cRcuqgFd1KPXdRySKsFmbikE5fk1n16Z1rMwXnRaiFc1DJ0Uo9otSITH9DivoVYVMUDUjykz3pIisE1j0ixAsUe01QIARYMqFhxgVZDMNBySAYgR2ig5YgN3EDLZfACBG-wxQYPQI34AOQIEECOCIHkoC7cIMxl8Cg6GjEVuYEJTkOGD8Cx05hBl05zho_A5gZprMpOq2HZaTksO5CjstNyWHaasgJQVtCoARML1KjsQI7KDuSo7EgOJl7QlBVg6AR9B1eRG2UXNGqEAsdOowZdOk0aAUgjDNLYlB2oUdmBHJUdyUHZgRze9dOUFYCygkYNKjugLDo3gElUdoBJVHYgRxNPU1aCqZH0A3JFbpRd0qiR4IZO0qgBly5p0khAGmmQxqbsQI3KDuSo7EgOyg7kqOySpqwElJU0atBTPqAsOjeASfScDzCJHvSBHE08TVmJjp1-aq7IzbLTqFHghk7RqKle-uzth_8CAAD__2gGICI=

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1r2zAUhu_3K8K52kDGkWynjWGQMQorlKZ0uRgMX7ixlgTS2MgONCv578P2SpaPnSPtJN6lEz_SK50H_L7CKs_0ffqsS4i_gwQBCgQEICAEAREkAgqTT3VZ5qZ-pQVusxeI-wIWq2Jd1T8nAqa50RC_QrWolhpimKRPS_2o00wbvw8CMl2li2WzTWEWz6nZjF42P0GA59dbjtdV3BtJMVKQbAXk6-r30rsVnza9eVrO99d6QxIBZZXONMRyK_4tZWSbUomR5KZUf025W2q9yk2mjc72FktqknrlxFG_pOX8q67GhS8P5jHZFDru3Xz7fPMw6X26uwMBS_2jet-k_vDRLGbztwdsUrvDBYzDnUh-n3t54cvo8BpO7h3u7S3txy-x8fvK84MLauqQc2Cf8_yiym5FlZ2KquyHoNAhBJ4fXlAWh5xX9jnPL4vqVhbVqSyB_RACdAih13x5LiWLQ85r-5znlyXoVpagU1lC-yGE6BAi74KqOKQc2qY8vyhht6KE_60rncj1qMsiX5Xaqgn165PpbKbbmyrztZnqB5NPm23ax3HDNd_1TJdV-69qH25X7V91QHt4wIGHHFiycssIp6XDlSk3eMCBhxxYsnIfXNkRrQ7p_p90gN93gMJy_876h3TIERyHCcFxmBAchynBCZoQPOIIjsOE4DhMCI7DlOAETQg-4Ah-xVEUhwlFcZhQFIcpRQmaUPSaoygOE4riMKEoDlOKEjSh6JCjqGT1BIImJCVowlKCpjSlcKor8MoCry3w6gKzL_AKg2Q1BnlUGZxsxWnKVpymbMVp0lYCp2x1KUvHM3NpS640ZatTX3LGKVuPygNqa7J99ysAAP__OltTOg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r2zAUxd_3KYKeNnBwrmTnHwwytsIKpS1dHwYjD26sNYE0DrYDzUq_-0jCksaO75GsuHtM0591fHzPsZQXsUhifR096UwMfwkSnpDCE0p4IhCeCMXYE8s0megsS9LNv-yAy_hZDDuemC2Wq3zz57EnJkmqxfBF5LN8rsVQ3EcPc32no1infkd4ItZ5NJtvl1mms6coXY-e13-EJ9r-ZsmbVT5sjcgbSTF-9USyyg-XzvLoUYshvXrmy3-bZflsMcn98HjtU0scqId1axpl09PIQYm0UfLWCDJ2QnojqnRC1XKCmrAiqJRyuNRqkaSxTnV8dLHtVSrFyg4We1ARNqXCwLKDiq6DCq-W0O9RNv2h85ulrwp-3a-Xeti6-Pn14va-9eXqSnhirn_nH7d38OlzOnuc_vtglr7eeS2-TtrJ0ldh0YaTa_eP1iaLvHFx82XbV3WqBwjYT0-38eqxscLCC4vyMfWCmjAjqJTiGHuqXz5nVGFgWVX52KlwLh961_KR5lMv2aFXbT-oUwBAwP4J9hovAAsryMILiwIw9YKaMCOolOIYPVm_AM6owsCyqgKwU-FcAPJdC0CZT71ihz5ob88H1gUABOyfYL_xArCwgiy8sCgAUy-oCTOCSimO0VP1C-CMKgwsqyoAOxXOBaDetQAC86kP2KEP23XiD5bfP79B4_G3MIKMnbAIv6kT1IQVQaUUx9gF9cN_RhUGllWF306Fc_iD__bbwwlddzpbJotMG_2y0NncmY4f9c6pLFmlE32bJpPtMruPN1tu-4dYZ_nuW9p9uFzsvtoIfAtTEaa3cHAEkx1M0okeuNCy60IrxdOSdVzxjit26ZBfmYcJ6OZp2XGiey60ApMWsI6Dhx1awLIId1kY3HSPH5QuPyl9lh7w8MAl2DyMgg1oEGyeRsHmaRRsAl2KypSvFZBtQKNwAxylG-Fg0gGO8k18pRLCS-3C4aWME18v6Nb5fiGQcio1jNUrmKfhOxjg6CXM4_AtzOMwrXy9Uh8YX-pXq7TyNEwrj8O0AhyNLI_DtJZa9sh4SWD7xLdsAS-lVZaqxiatkm8aCXZvkt_HAOMAjdKKcJBWgKO0AhxumvmSlSEwvtSyNmkFNEorwFFaEY5GlsdRWiW_hZV9gPMtW8DLaeV3sejW-aZRHXDWKjWNTVoBjdKKcJBWgKO0AhylVfElqyQwvtSyVqdcnobHXB6H51yAo4Muj6O0Kn4rq5B1fMsW8FJaFb-XLd76-PXD3wAAAP__OP3w5Q==

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ls9q20AQh-99CjOnlq6RdiX5j6CQUgINhCQkORSKD4q1jQ2OJVYyxA1592I5JpXlzE9rybrFsb7Z0cw3nn2hZRLrq-hJZxT-JkmCFAnySJBPggKaCEpNMtVZlpjNI1vgIn6m0BU0X6arfPPviaBpYjSFL5TP84WmkO6jh4W-1VGsjeOSoFjn0XxRHJOa-VNk1mfP678kqO9sjrxe5WHvTNLkVVCyyt_ivod7WPdmUTYrByqenwjK8uhRUyhfxXH5BXXzU43yUx_m9x5ntUxMrI2OS5EmGxI9cuAlf0bZ7E7n16kj93pwv0512Dv_9eP85r73_fKSBC30n_zzmfzyzcwfZ8VfH_bl_Z08m5rfJSbXxpHBfpm-fhjfr1GzQ-V4C3ogiaukn6SOcvcLfPD4oHS8rK-U5JRyVN_xTiK9RYaD-hm2qb3sVnvZhfag6jvtB8dqr-p3VbFd9fqOfxLvLDIc1s-wTe9Ut96pLrwDVd95NzzWO69-Vz22q36_2LHte2eR4ah-hm1653XrndeFd6DqO-9Gx3rn1--qz3Y16J_EOov8xnXza9M5v1vn_C6cAzXfOTdu42p5IP6tztJkmelat0Z3UzAdP-ptA7JkZab6xiTT4pjtx-uCK-4Osc7y7bdq--Fiuf1qk2B9eNgElrIRHTSixzwtLWqm7OBhE3ivZrZ00Ige87Tap93_aa8Eu_uwx8I-3y2fhZXkjw6azAcPg_ngYTQfgAbzAWgwH4Mm88HDYD54GM0HoMF8ABrMx5C1dMRLOmoyH-MmhvMwMJyHkeGABoYDGm0Am7VZ_SW12Zu2NFwCVpvTGgeay8oWKakqFS-65NcIMF1W9oiN6oAGrgMayY5wYDvCke6VHWqlO08j3Xka6g5wpDvAke6VRVrWfQB0r-wUK90rO8VKd55GuvM01B3gSHeAI90r-9RKd55GuvM01B3gSHeAI90rW7V813Z53VVlt7C6T14__QsAAP__gN1CRA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFtrKkkUhd_nV8h-mmFa2rp4hYEMM4EJhCQkeRg4-NCx60TB2NLdQjwh__2gHjV22XtV2a1v3lbtXav2-ujyg2ZJbO6iN5PR4BsJCkhSQIoC0hRQm4YBzdNkZLIsSVc_2Qhu4ncatAKazOaLfPXxMKBRkhoafFA-yaeGBvQcvUzNo4lik4YtCig2eTSZrsvM08lblC6v3pc_KKBmuCp5v8gHjStBw8-AkkW-XzfLo1dDA_EZuNf-d5Llk9koD9uHha3195KXZWMcZeMjv9_3IH16-Lp_4WyALDVAnWSAqNcBXdrEfp3FLEljk5r4YKX1KqVtyhZoc99C-1wtIKf2LXQqtBCc1OV_UTZ-Mvn9PFQFp56XczNoXP__z_XDc-Pv21sKaGq-579fiT_-Siev4_Urh3x1fcbrKUlzk4bKsuzP0vV7Dp4ds-PXokeauEuayTzUraLBR8v3D8oLj-hyyQ1lM1Te8ALVdxPZOSO8fBzwsMAVX64WiHo90KVNVGSHOBFfNbaAnCrDl18LlfElLoEvMF5bfFmWueJLuqdHsuFRzVB78wNU341E94z88HBAeFjgyg9XC0S9HujSJiqGV57IjxpbQE6V8cOvhcr8kJfgBxivLT8sy1z5odzTo9jw6Ob6iuPHD1B9NxK9M_LDwwHhYYErP1wtEPV6oEubqBhedSI_amwBOVXGD78WKvNDXYIfYLy2_LAsc-WHdk-PZsPTbnrTA9TeDUT_jPTw2L9wNsCVHa4GiHod0KVNVAyuPpEdNbaAnCpjh18LldmhL8EOMF5bdliWnfLXy5H1H002T2aZcfpXpbUyzMSvZnMAWbJIR-YhTUbrMpu392vd-oPYZPnmW7F5czPbfLVq8KtYFMXiq1gfiIWfWKgqaikqqftV1KrLqyXruOIdV2zpNl-ZFwtwXrxayipq1aqk7vFqzTre4cVtD7EsijusuMufdZcVgz33WLEGwe7zVGgBLFhQ8eICr4Zg4OWQDECO0MDLERuEhZZD4yUw3mKLDx6AGvEByBEggBwRAslBXIRFmEPjkXU8YgpyCxOCh4zogGPnMYO2znNG9EBxizReYefVMOy8HIYdyFHYeTkMO09ZCSgredSAiQVqFHYgR2EHchR2JAcTL3nKSjB0kn-CK8itsEseNVKDY-dRg7bOk0YC0kiLND5hB2oUdiBHYUdyEHYgh0_9PGUloKzkUYPCDiiLzg1gEoUdYBKFHcjRxPOUVWBqFH9BLsitsCseNQo80CkeNWDriieNAqRRFml8wg7UKOxAjsKO5CDsQI7CrnjKKkBZxaMG3fIBZdG5AUyiez7AJLroAzmaeJ6yCh07f2suyO2w86jR4IFO86gpbn34-dvPAAAA___7htIl

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8K52piDLdnOh2HQMQorlLa0vRiMXLix1gTS2MgONCv97yNOQ-c4Pq8VN7prGj_S66Pn5OiFlmmiruInlVP0mwQ5JMkhnxwKyKGQJg5lOp2qPE_15pEtcJE8U-Q5NF9mq2Lz74lD01Qril6omBcLRRHdxw8LdaviRGnXI4cSVcTzRblNpudPsV6fPa__kkN9d7Pl9aqIemeCJq8Opavibd335R7WvVmcz6oLlc9PHMqL-FFRJF6d4_KFdvLJxnzv66yWqU6UVkllpcmGRI8ceMmfcT67U8V15oq9M7hfZyrqnf_6cX5z3_t-eUkOLdSf4vOZ-PJNzx9n5V-N7_3-Tr5Jze9SXSjtinC_TF8b1w9a1OxQOd4WPRDiKu2nmSu9_QIf3D6sbC_aKyU4pVzZd_2TSG-QcGAroWxMaEF7YUN7UPWd9oNjtZftT1Wyp-r33eAk3hkkHNpKKBsTWvBO2vAOVH3n3fBY7_z2p-qzpxr0yxn78d4ZJBzZSigbE1rwzrfhHaj6zrvRsd4F7U81YE817J_EOoN8Yzv5ZGM-C84FNpwDNd85N_6Iq-WB9W9VnqXLXLW6NXqbgqnkUW0PIE9XeqpudDott9l-vC658u6QqLzYfiu3Hy6W2682AdvDwy6wEJ3osBM95mlhUDNpBg-7wHs1M6XDTvSYp-U-7f1P-xXY24d9Fg740wpYWAp-67BLf_Aw6A8eRv0BaNAfgAb9MejSHzwM-oOHUX8AGvQHoEF_DFlLR7ykoy79Me5iOA8Dw3kYGQ5oYDig0QQwGZv1X1KTuWlKwyFgNDmNcaC5qE2RiqpC8qILfowA00VtjpioDmjgOqCR7AgHtiMc6V6boUa68zTSnaeh7gBHugMc6V4bpFXdB0D32kwx0r02U4x052mkO09D3QGOdAc40r02T41052mkO09D3QGOdAc40r02Vat3bY_XXdZmC6v75PXTvwAAAP__FIVCPw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mN9r4k4Uxd-_f4XM03fZSJy5409Y6LJb2EJpS9uHhcWH1MxWwRpJItQt_d8XddWaMfdkkuibv87cO2fu-ZDxTcyi0NwELyYRg19CCk8o4QkSntDCE20x9MQ8jkYmSaJ49ZON4Cp8FYOWJyaz-SJdfTz0xCiKjRi8iXSSTo0YiMfgaWruTRCa2G8JT4QmDSbTdZl5PHkJ4uXF6_KP8ETTX5W8XaSDxoUUw3dPRIt0v26SBs9GDOS7V7z290mSTmaj1G8fFrbW30uelo1xkIyP_H7fg3Lp4eP-ZQ0GUCkDZL0O6Nwm9ussZlEcmtiEByutV8ltU7VAm_sW2qdqATm1b6FToQWvVJc_gmT8YNLbuU8Zpx6XczNoXP78dnn32Ph6fS08MTW_0_8v5Kcv8eR5vH5VYLy6LuP1EMWpiX2yLPucu36vgGfH7Pi36JEmbqJmNPd1K2vw0fL9g_LSIbpccn3V9MkZXqD6biI7J4SXiwO1WEClLJD1eqBzm6jIDlkSXzW2gJzKw5dbC5XxJc-BLzBeW3xZlhXFlyqeHsWGh5q-duYHqL4bie4J-eHggKzFAiplgazXA53bRMXwqpL8qLEF5FQeP9xaqMwPdQ5-gPHa8sOyrCg_qHh6iA2Pbq6vOG78ANV3I9E7IT8cHJC1WEClLJD1eqBzm6gYXirJjxpbQE7l8cOthcr8oHPwA4zXlh-WZUX5oYunR7PhaTed6QFq7waif0J6OOxf1mAAlTJA1uuAzm2iYnB1SXbU2AJyKo8dbi1UZoc-BzvAeG3ZYVlW5q-XI-vfm2QezRJT6F-V1sowEz6bzQEk0SIembs4Gq3LbN7ernXrD0KTpJtv5ebN1Wzz1arBj2KZFcuPYn0glm5iSVXUSlZS96uoqcurFes48Y4TW7rNV-bFEpwXr1aqippaldQ9Xq1Zxzu8uO0gVllxhxV3-bPusmKw5x4r1iDYfZ4KLYAFCypOXODVEAy8HJIByBEaeDlig7TQcmi8AsZbbHHBA1AjPgA5AgSQI0IgOYiLtAhzaDyyjkdMRm5hQvKQkR1w7Dxm0NZ5zsgeKG6RxinsvBqGnZfDsAM5Cjsvh2HnKasAZRWPGjCxQI3CDuQo7ECOwo7kYOIVT1kFhk7xT3AZuRV2xaNGaXDsPGrQ1nnSKEAaZZHGJexAjcIO5CjsSA7CDuTwqZ-nrAKUVTxqUNgBZdG5AUyisANMorADOZp4nrIEpob4C3JGboWdeNQQeKAjHjVg68SThgBpyCKNS9iBGoUdyFHYkRyEHchR2ImnLAHKEo8adMsHlEXnBjCJ7vkAk-iiD-Ro4nnKEjp2_tackdth51GjwQOd5lGT3frw_b-_AQAA__9dYNIg

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ltFq2zAUhu_3FOFcbSDjSLbTxjDIGIUVSlu6XAyGL9z4LAmksZEdaFby7sP2WBYnOceaFt01tT_p19EH_t9gnWd4n75gCfF3kCBAgYAABIQgIIJEQKHzGZZlrutXWuA2e4V4KGC5LjZV_e9EwCzXCPEbVMtqhRDDNH1e4ROmGWp_CAIyrNLlqtmm0MuXVG8nr9ufIMDz6y0fNlU8mChIdgLyTfV73f1yz9vBIi0XhwtNJCS7REBZpXOEWO7Ev-WL3ORTZ_Pt19msc52hxuxgpaQmuVdOHPJLWi6-YvVQ-LJzB9NtgfHg5tvnm8fp4NPdHQhY4Y_q_UR--KiX80Xz159zy86592cKLM50IvB97uWFL6Pu6U_uHR7sLfvft6Tu21eeH1zESIOEI1cJ1dmEDpyULpxU_aeuyKkHnh9exAuDhFeuEqqzCR14oVx4EfSfekBOPfSaD8j_98Ig4bWrhOpsQgdeBC68CPtPPSSnHnkXscIg39hNPnU2nwMnQte95kScJyyLfF1ir9YyrA-E2RzbAZX5Rs_wUeezZpv250PDNd_jDMuqfaraH7fr9lEdsD88soHHNrC0yi0jmpYGI1Nm8MgGHtvA0ip3Z2RHtOrSw7_pgJ53QMLycGbDLh3aCE7DjOA0zAhOw5zgDM0IHtkITsOM4DTMCE7DnOAMzQg-shH8ykZRGmYUpWFGURrmFGVoRtFrG0VpmFGUhhlFaZhTlKEZRcc2ikqrnsDQjKQMzVjK0JymHM51BbuyYNcW7OqCZV-wKwzSqjHIo8pgZCtNc7bSNGcrTbO2Mjhnq0lZOr4zk7ZkSnO2GvUlY5yz9ag8kLYmu3e_AgAA__9X8D2q

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l99r4koUx9_vXyHn6V6IxDOT-AsuuOwWtlDa0u3DwuJDamarYI0kEeqW_u-LClqT5nydZPStVT-ZM9-cz8nkjRZJbG6jF5PR8BcxeaTII00eBeRRSGOPlmkyMVmWpJuf7IDr-JWGHY9mi-Uq33w89miSpIaGb5TP8rmhIT1GT3PzYKLYpH6HPIpNHs3m22WW6ewlStej1_Uf8qjtb5a8W-XD1kjR-N2jZJUfrpvl0bOhIb97p6_9bZbls8Uk98PjhUdcuP4BeVq3plE2_eT3hxqUTQ0f988OAtC1AmC3CQSVRRyus1okaWxSEx9daXuVyjJVB5R5KCE8VwkoqUMJ3QYleLWq_B5l0x8mv1v6upDU43pphq2rn1-v7h9bX25uyKO5-Z3_O-L__k9nz9PtX_v2qt5Tz22st0k7Wfo6LO7-07X7R2uzhVeSVr5q-9p6soDV9-3SPeNksUnASQS6VgTsNoOgsoiGYnPN2eKwBJRU1WyxK6HxbOFLzBZ1encrsbl12w-s_Qar729Z74x-WyTATiLQtSJgtxkElUU0lEvV9NthCSipKr_tSmjst7qE3_r07tZicwft7fndzm-w-v6W9c_ot0UC7CQCXSsCdptBUFlEQ7l0Tb8dloCSqvLbroTGfutL-B2c3t2B2Nxh29pusPb-hg3OaLfF_tlBALpWAOw2gaCyiIZiBTXddlgCSqrKbbsSGrsdXPq9_5NyHky2TBaZOemtvrPZkImfzS6gLFmlE3OfJpPtMrt_77bc9oPYZPnuW979c73YfbUp8CPMRZg_wsERzHYwq0b0oAmtuk1orWVaiYlrOXEtLh3KK8swg7plWnUa0b0mtAadFoiJg5sdWsCqCHdFGGy6JzdKV-6UvkgPZHjQRGwZRmIDGogt00hsmUZiM5ilaJjKYwW4DWgkN8CR3QgHnQ5w5DfLI5URXpouEl5ynOXxgrYuzxcGlnNpwlg9gmUaPoMBjh7CMg6fwjIObZXHK_dB8KX5amWrTENbZRzaCnDUsjIObS1N2aPgFYPjkzxlC3jJVlUaNTa2KnnSKHB6U_I5BgQHaGQrwoGtAEe2AhwemuUhq0IQfGnK2tgKaGQrwJGtCEctK-PIViUfYVUf4PKULeBlW-VTLNq6PGl0B7xrlSaNja2ARrYiHNgKcGQrwJGtWh6yWoHgS1PW6i1XpuFrrozD91yAoxddGUe2avkoq1F08pQt4CVbtXyWLW59_P7P3wAAAP__8VPO_Q==

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltGK2kAUhu_7FHKuWpgQZ5K4a6BgKQtdWNZl60Wh5CJrpiq4TphEWLv47iVJF2s052Q6OHsZ9Zv5c84H_q-wUZm8T59lAfFP4MBAAIMAGITAIIKEQa7VXBaF0tVPGuA2e4F4yGC1ybdl9XHCYK60hPgVylW5lhDDLH1ay0eZZlL7Q2CQyTJdretrcr16TvVu8rL7DQw8v7pyui3jwYSziYBkz0Bty79HH0582g2WabE8PusNSRgUZbqQEPM9-7-UkcuUojPl4ajtRulMapkdHZZUJPWTM6_6LS2W32U5zX3e2sdsl8t4cPPj683DbPDl7g4YrOWv8mOd-tNnvVos3x4OM2gN4PBmgcWbnYl9rzyV-zxqz-Ds3eHR3bz_7jm2e194fnBBRw1yjtzmFJ05HVjK3Vkq-m9AoBsIPD-8oCkGOa_c5hSdOR2YItyZEvTfQIBuIPTqP5xLmWKQ89ptTtGZ04EpgTtTwv4bCNENRN4FPTFIOXaZUnSmdGBJ-D796EyoR1nkalPIXu1nWL2WzBayGVOhtnouH7Sa19c0j9Oaq__LM1mUzbeiebjdNF9VAfvDIxt4bANzq9w8wmluMDJhBo9s4LENzK1yt0Z2Qos2PfyXDvB5ByjMj2c2bNOhjeA4TAiOw4TgOEwJTtCE4JGN4DhMCI7DhOA4TAlO0ITgIxvBr2wUxWFCURwmFMVhSlGCJhS9tlEUhwlFcZhQFIcpRQmaUHRsoyi36gkETUhK0ISlBE1pSuFUV7ArC3Ztwa4uWPYFu8LArRoDP6kMRrbiNGUrTlO24jRpK4FTtpqUpdOdmbQlU5qy1agvGeOUrSflAbU12X_4EwAA__9qz1Ak

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1r20oQhu_PrzBzdQ7IyLMr-QsOpLSBBkIS0lwUii8UaxsbHMtIMsQN-e_FNrVjyZpXq4_00nEe7eyreUYrv9IyCs1N8GwSGv8gJocUOaTJIY8c8mni0CqOpiZJonj7L3vgKnyhcc-h-XK1Trd_njg0jWJD41dK5-nC0JgegseFuTdBaGK3Rw6FJg3mi90yq3j-HMSbi5fNL3Ko626XvF2n484FOxeKJm8ORev0eOkkDZ4MjfnNKb_8l3mSzpfT1PVP1z63xJF63HRmQTI7jxwrUTaVvA-Cm0lCV0qC24jCKyzleKn1MopDE5vw5GK7qxQWq3q42GMVfltVlIjsWEW_RhVOpUK_Bsnsm0lvV67O5PWwWZlx5_L758u7h86n62tyaGF-pv_udvDf__H8afbnw7HnCnc2aDbfm6gbrVztZzM4u_bwZG22kE1yzVVdV1eZO6CAQ-v0W587NlE0lYWulAW3EYZXWEpN57n65GmwihKRFU0euypqTx7-uMmjyre8Ejted12viv2ggMPtG7Ruv0UU3FQWulIW3EYYXmEpNb1T1e1vsIoSkRXZb1dFbfvVx9mvy7e8Fjve6-5eC6ztBwUcbt-wdfstouCmstCVsuA2wvAKS6npna5uf4NVlIisyH67Kmrbrz_Ofq98y3tix_vdKu6D5Q83b9S6-xZBcDNJ6EpJcBtReIWl1HTOq25-g1WUiKzIfLsqapvv_Z3fG84UdW-SVbRMTKlfE3rbbZnwyexjSqJ1PDV3cTTdLbP_eLvjdn8ITZLuv-X9h6vl_qttge9hzsL8HvZOYLaDWdWiR3Vo1a9Day3TSkxcy4lrcWlfXlmGGdQt06pXix7UoTXoNE9MHNxs3wJWWbgvwmDTA7lR-nKnDEV6JMOjOmLLMBIb0EBsmUZiyzQSm8EsRcNUHivAbUAjuQGO7EY46HSAI79ZHqmM8Nx0kfCc4yyPF7R1eb4wsJxzE8bqESzT8BkMcPQQlnH4FJZxaKs8XnkIgs_NVytbZRraKuPQVoCjlpVxaGtuyp4Erxgcn-Qpm8FztqrcqLGxVcmTRoHTm5LPMSA4QCNbEQ5sBTiyFeDw0CwPWeWD4HNT1sZWQCNbAY5sRThqWRlHtir5CKuGAJenbAbP2yqfYtHW5Umje-BdKzdpbGwFNLIV4cBWgCNbAY5s1fKQ1QoEn5uyVm-5Mg1fc2UcvucCHL3oyjiyVctHWY2ik6dsBs_ZquWzbHbrk7d_fgcAAP__F-ztzw==
