# LogicTest: 5node

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysVluL2kwYvv9-xfBefaUT4kziKVduuxYEq1u10LLkIjXDIrhOOhMhrvjfi0llq5h3JofLJPPMc0Q8gv69hQCW4-n484rs1ZZ8Wcy_kufxj6fpw2RG_n-cLFfLb9MP5O-RrDiQHd7I99lkPiMP0-mdb_PF43hBPv0kWQgUdjIWs-hVaAiegQEFDhQ8oOADhS6EFBIl10Jrqc5HjjlgEmcQdChsdsk-Pb8OKaylEhAcId2kWwEBrKJfW7EQUSyU2wEKsUijzTanyQ5vo0RtXiN1AArLJNrpgDjumXm-TwMyYhCeKMh9-n69TqMXAQE70XoSuq1J4KUS3pmlioUS8TUnhKc7ImfSkYnLriMq4-5Usb-UKhXKZTfWR-xjqTevrrfi0lJ73M6ef0XP7NtlFu263HG9yhOrIKLXogheKqLJyFiNkRkCuIysV3dk3D5gbhOw57h-5ZYriOi3KIKXimjSMq_RsiGAS8v9ui179gF7NgH7Tv6LXq3lCiIGLYrgpSKatOzVaNkQwKXlQd2WffuAfZuAu07ljitIGLYmgZdKaNKwX6Nhg_1Lw8M2_hLcuX8hdCJ3WlgqDymI-EUUQWm5V2vxpOQ6pyke5zkufxELnRZfefEw2eWf8v7_BbMmYI6CvStw5xbsoWAfZ_Zx2Qyn7qLoPk7dawLuo-ABLnvQJLEhCmbMMBN8ZEY4PjPGceMMH5rBOcOXxroGOL41IxwfG-sZrONzM1nH98aGBji-OCMc3xzv4NY5vrlb6-Hpvz8BAAD__-vKM3c=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt-L2k4Uxd-_f0W4T9_SkTiTxB952rZaEKxu1ULLkofUDEvATezMBHTF_72YFFKte2cmyaMx557PnHsIcwL5awchrKfz6aeNU4id83m1_OI8Tb8_zj_MFs7_k9l6s_46f-f8eeVQvXA4vjrfFrPl4s7z5WoyXTkffziHCAhkecIX8QuXED4BBQIMCHhAwAcCAUQE9iLfcilzcXnlVApmyQHCPoE02xfq8jgisM0Fh_AEKlU7DiFs4p87vuJxwoXbBwIJV3G6K20Ox9eHvUhfYnEEAut9nMnQ6bkX52WhQueBQnQmkBeqHi9V_MwhpGfSDCHoDIHZIExSqdJsq1x6kwFi4DUzCIwN_DcN6rlFlouEC55cTY3OGAIzP2Ngc8Z1LhQXLqO349-_OX9wNZ-a94Qa9MRlPdezLqsFxKBDCGYDUbfpn6wN62psMGhYV2YeIzOJ0eu5vvUuLSCGHUIwG4g6atZwl8YGw4a79Mxj9Exi9Hvld95ulxYQow4hmA1EHbXXcJfGBqOGu_TNY_RNYgx61pu0QBh3hsBsEOqY_YZ7NDYYd3AduGOw4nKfZ5LfXAvuT-5frgs8eebV3ULmhdjyR5FvS5vq57LUlQ8SLlX1r1f9mGXVXxfAv8UUFTNczFCxfyWmt2KvjdhHxQGOHeBn1hx6gKrHuHiIike4eNQmsXEbMcU7RnUlw1tGNYnTVj2jrYpG8abRoQYd7xodaOR42XTseNt0arxujGrQ8cKxvubTgjdOw87wwt2qo_N_vwMAAP__-ZQ87A==

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysl19v2koQxd_vp1jN0726RmZ2zT9LV8ptQ1SkFFKgaquUB4pXkSVi07UtkUR89wpc4UCTmV3Hj9g-e-bs_GazeYLs5xpCmA2vh-_nojBrcTWdfBS3w6831_-PxuLvy9FsPvt0_Y_4_cm2_GD78Ci-fBhOh2IrvhfttloJJT6PR5Mx96H-TygxmV4Op-LdN7FdgAdJGunx8l5nEN4CggcSPFDgQQAedGDhwcakK51lqdl_8nQQjKIthG0P4mRT5PvHCw9WqdEQPkEe52sNIcyXP9Z6qpeRNn4bPIh0vozXB5vtw-PFxsT3S_MAHsw2yyQLRcvfO0-KPBQXCIudB2mRV8tn-fJOQ4g7z76Eq3ida6ON3zn1L5_vfaptCcNwNJ73XzWWLsbPs2Nz4VWt8MikX_HhAxfjyzjL42SV-_IsOZGsU8-gY23QfdWgWrdIUhNpo6OTVRc7qgRln7HnknGWmlwbX-H58v--un7_ZH10INQCUF-2fOU8n0wRR0S7Tc-nS_om46ta8ZHJ7zyhjHE1QH_gZTmh1gbdmhMq7RsobfqnWn7gjC9TxLF_vabxdUiPTcZXteIjk98ZX8a4okvWxNfaoFcTX2XfQGXTv6B1uMO44csUcexfv2l8HdJjk_FVrfjI5HfGlzGu6FI18bU26NfEN7BvYGDTv07LGV6mhGP3Bk3D65AdmwuvaoVHJr0zuoxxRVZQE11rg0EDV_sXDKY626RJps-u-C-v3N5f_XV0p8v_E7K0MCt9Y9LVwab8OTnoDg8ineXlWyx_jJLy1b7A52IkxR1aLEmxosWKFAe0OCDF3RMxnos7bxF3SXGPLrtHb5ik1X1SPaDFA5oSplnIQMZRRmOGTHCkQWM6hjRpnJpGDZkRQRo2ZLqGNG7I8IY0cNhn5DRx3M7RyDFqSRMnGeIkTZzkTjaaOMmMi6SRk8zpJt90vMk3nW-SJk4yxEnmiOPaRhMnmXGRNHKqzfxJopljdk7RyJ2rF7u_fgUAAP__drSVQQ==

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysl19v2koQxd_vp1jN0726RmZ2zT9LV8ptQ1SkFFKgaquUB4pXkSVi07UtkUR898q4gkCTmV3Hj9g-e-bs_GazeYLs5xpCmA2vh-_nojBrcTWdfBS3w6831_-PxuLvy9FsPvt0_Y_4_cm2-mD78Ci-fBhOh2Irvhfttlr9JwLxeTyajLkvtUAxmV4Op-LdN7FdgAdJGunx8l5nEN4CggcSPFDgQQAedGDhwcakK51lqSk_edoLRtEWwrYHcbIp8vLxwoNVajSET5DH-VpDCPPlj7We6mWkjd8GDyKdL-P13mb78HixMfH90jyAB7PNMslC0fJL50mRh-ICYbHzIC3y4_JZvrzTEOLOsy_hKl7n2mjjd079q-elz2FXwjAcjef9V32li-_z6NhcdlUrOzLhS3i49IGL82Wc5XGyyn15Fp2I1qln0LE26L5qcFy3SFITaaOjk1UXO6oEZZ-x55JxlppcG1_h-fL_vrp-_2R9dEDUglBftnzlPJ9MEQdGuw3Pp0v4JtOrWumRie8-oYzzcYD-wMtyQq0NujUnVNp3UNo0ULX8wBlfpohDA3sN4-sQHptMr2qlRya-O76M85EuWRNfa4NeTXyVfQeVTQOD1v4O44YvU8Shgf2G8XUIj02mV7XSIxPfHV_G-UiXqomvtUG_Jr6BfQcDmwZ2Ws7wMiUc2jdoGF6H6NhcdlUrOzLh3dFlnI9kBTXRtTYYNHC1f8FgqrNNmmT67Ir_8srt8uqvoztd_Z-QpYVZ6RuTrvY21c_JXrd_EOksr95i9WOUVK_KAp-LkRR3aLEkxYoWK1Ic0OKAFHdPxHgu7rxF3CXFPbrsHr1hklb3SfWAFg9oSphmIQMZRxmNGTLBkQaN6RjSpHFqGjVkRgRp2JDpGtK4IcMb0sBhn5HTxHE7RyPHqCVNnGSIkzRxkjvZaOIkMy6SRk4yp5t80_Em33S-SZo4yRAnmSOOaxtNnGTGRdLIqTbzJ4lmjtk5RSN3rl7s_voVAAD__20OlTs=

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysldGKm0wcxe-_pxj-V19hxMyMZjdeZWlTCFizTVIoLF7YOCwB17EzCroh716ibbdZknFGc6njz3M855AcQP3MIIDNIlx83KJKZujzevUFPS2-P4YPywj9_2m52W6-hh_Q70dqjJrumbp5Rd-i5SpCD2H457jBqP57HAOGXKQ8Sl64guAJCGCggIEBBg8w-BBjKKTYcaWEPD1yaIFlWkMwwbDPi6o83Y4x7ITkEByg3JcZhwC2yY-Mr3mSculOAEPKy2SftTJ18zov5P4lkQ1g2BRJrgLkuCflVVUGaE7xnEB8xCCq8k1Blckzh4Ac8TAXvqULguf0qgt61cWbuJAplzw9l4X4eMFnJBxRuOQ8qGvaEwPtKr-krtP2jbTZmTYxT58YpO9Sx2VDVmDhY2rtw2IH5EY7IAN2QM0zoCYZMMf1hnRh4ePO2odFF_RGXdABXTDzDJhJBp7T_npZd2Hh497ah0UX7EZdsAFdeOYZeCYZ-M6QJixczCxdWPTg3agHb-T_1IU3r7kqRK644ZtjDDx95t2HKFHJHX-UYtfKdJerlmtvpFyV3SntLpZ5e9RW9C9MxsBUCzM9zLQwmZ7Rk_e0p6Wneml_DDwd89F3Wnimh-_HwLMxtol-Y6RvZPqV9eKjdkZ6hub34Pql9eL6rb33Hh__-xUAAP__Ixk2GA==

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysVk2L2kAYvvdXDO9ppRPiTOJXTm67FgSrW7XQsuSQmmERXCedRIiK_72YVFxl887k47ZJ5pnnk8UjxH834MFiNBl9XZKd2pBv89l38jL69Tx5HE_Jw9N4sVz8mLTIw_8zaX4i3R_IbP40mpMvv8m-RX5Ox7MpeZxM0IOH1vXv1AcKWxmKafAmYvBegAEFDhQcoOAChQ74FCIlVyKOpTofOWaAcZiC16aw3ka75Pzap7CSSoB3hGSdbAR4sAz-bMRcBKFQdhsohCIJ1puMJt0fhpFavwVqDxQWUbCNPWLZZ-bZLvHIkIF_oiB3yfX6OAleBXjsRKtJ6DQmgRdKuDJLFQolwltO8E8fiJxKS0Y2u42oiLtdxv5CqkQom91ZH7LPhd6cqt7ySwvtcTN77g09M2-XGbRrc8t2Sk-shIhugyJ4oYg6I2MVRqYJ4DKybtWRcfOAuUnAjmW7pVsuIaLXoAheKKJOy7xCy5oALi33qrbsmAfsmATsWtl_9HItlxDRb1AELxRRp2WnQsuaAC4t96u27JoH7JoE3LFKd1xCwqAxCbxQQp2G3QoNa-xfGh408ZPgg_vnIo7kNhaGyn0KInwVeVCx3KmVeFZyldHkj7MMl70IRZzkX3n-MN5mn7L-34NZHTBHwc4NuH0PdlCwizO7uGyGU3dQdA-n7tYB91BwH5fdr5PYAAUzppkJPjItHJ8Z47hxhg9N45zhS2MdDRzfmhaOj411Ndbxuems43tjAw0cX5wWjm-Ot3HrHN_cvXX_9OlfAAAA___q9jn6

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk2P2jwUhffvr7DuatBrFOwkfGQ1baESEoUpUKnVKIuUWKNITEJtR-JD_PeKpFIKnbmxQ3aQ-Pg8Pvco8gnUry0EsJrMJp_WJJdb8nm5-EKeJ9-fZh-mc_Iwnq7Wq6-zDnn4s2ZfrtgfjmSxHE-W5OMPcuiQb_PpYo4uOnaq3_sQKKRZLObRq1AQPAMDChwouEDBAwo-hBR2MtsIpTJ5WXIqBNN4D0GPQpLucn15HFLYZFJAcAKd6K2AANbRz61YiigW0ukBhVjoKNkWNvvD8XEnk9dIHoDCahelKiBd5-K8yHVAHhmEZwpZrqvtlY5eBATsTJsh-K0hcBuEcaJ0km60w24yQAzcZga-sYH3rkG1b55mMhZSxFe7hmcMgZuf0bc54yqTWkiHs9vt_393__7V_sy8J8ygJw7vOq51WS0g-i1CcBuIqk3_ZG1YV2ODfsO6cvMYuUmMbtfxrGdpATFoEYLbQFRR84azNDYYNJylax6jaxKj1y2-83aztIAYtgjBbSCqqN2GszQ2GDacpWceo2cSo9-1nqQFwqg1BG6DUMXsNZyjscGohevAGwZLoXZZqsTNteDtnXuX64KIX0R5t1BZLjfiSWabwqb8uyh0xYNYKF2-dcs_07R8dQH8W8xQMcfFHBV7V2J2K3bvEXuo2MexffzMNYfuo-oRLh6g4iEuHt6T2OgeMcM7xupKhreM1STO7uoZu6toDG8aG9Sg411j_Ro5XrY6drxtdWq8bpzVoOOF472aTwveuBp2jhfuVh2e__sdAAD__5v9Q28=

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysVk2L2kAYvvdXDO9ppRPiTOJXTm67FgSrW7XQsuSQmmERXCedRIiK_72YVFxl887k45hknnk-EY8Q_92AB4vRZPR1SXZqQ77NZ9_Jy-jX8-RxPCUPT-PFcvFj0iIP_8-k-Yl0fyCz-dNoTr78JvsW-Tkdz6bkcTLBD1JyaF0fUx8obGUopsGbiMF7AQYUOFBwgIILFDrgU4iUXIk4lup85JgBxmEKXpvCehvtkvNrn8JKKgHeEZJ1shHgwTL4sxFzEYRC2W2gEIokWG8ymnR_GEZq_RaoPVBYRME29ohln5lnu8QjQwb-iYLcJdfr4yR4FeCxE60modOYBF4o4cosVSiUCG85wT99IHIqLRnZ7DaiIu52GfsLqRKhbHZnfcg-F3pzqnrLLy20x83suTf0zLxdZtCuzS3bKT2xEiK6DYrghSLqjIxVGJkmgMvIulVHxs0D5iYBO5btlm65hIhegyJ4oYg6LfMKLWsCuLTcq9qyYx6wYxKwa2W_6OVaLiGi36AIXiiiTstOhZY1AVxa7ldt2TUP2DUJuGOV7riEhEFjEnihhDoNuxUa1ti_NDxo4i_BB_fPRRzJbSwMlfsURPgq8qBiuVMr8azkKqPJH2cZLnsRijjJv_L8YbzNPmX9vwezOmCOgp0bcPse7KBgF2d2cdkMp-6g6B5O3a0D7qHgPi67XyexAQpmTDMTfGRaOD4zxnHjDB-axjnDl8Y6Gji-NS0cHxvraqzjc9NZx_fGBho4vjgtHN8cb-PWOb65e-v-6dO_AAAA__9enTq_

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkc9q8zAQxO_fU4g9xSCI5dx0-kLjgsF10jgpheCDkZZgUKVUf0oh-N2LZWia0pS0PWp2fzsz6AjuWQGHOi_zmw0JVpHb9fKO7PLHVTkvKjJZFPWmvi8T8jAvt3lNJiyhZJIlZFsVy-pdzQZ1ljRAQRuJVfuEDvgOGDQUDtYIdM7YQTrGhUK-Ak8pdPoQ_CA3FISxCPwIvvMKgYMyolXkpVUBHUmnKVCQ6NtOxf2eggn-RDvf7hE46-kvHdiUXeWQXXQ4HQ7aWIkW5aeLX2RYdM53WvhpdrYL_xlcSjD7Scc1uoPRDq_qlg4JUe5xrONMsAJX1ohoMz6XkYuCROfHaTY-Ch1H8RM-wuwvcPYtPDuD077p_70FAAD__6Ke6m8=

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ls1u2kAQgO99CmtOibrI3rXNj6VKpA1VkSikmEOryAcHbwMSwe7aSHEi3r3ChKa2YceLE98C7Dc7nvkm42eI_6zAAXcwGnyZaRux0r5OJ9-128HPm9HVcKxdXA_dmftjdKldvJxJ9yce06dLbTieDabu7tur0ejoicn0ejDVPv_SUg8IrMOAj_0HHoNzCxQIMCBgAgELCNjgEYhEOOdxHIrdkecMGAaP4BgElutok-y-9gjMQ8HBeYZkmaw4ODDz71Z8yv2AC90AAgFP_OUqu-YxfepHYvngixQIuJG_jh2tpe9unmwSR-sz8LYEwk3yEv416l2qLfx4kY_Xp-BtPQJx4t9zcOiWnJem3Wia7GSar3E261AEXPAgF8nbkdiRI8_6zY8XLk8mkU4LHZmlEXfy7gCBFf-dXPTp5SexvF9kf_17dFp49NfHMlWq74Yi4UKndrFSH0_GtyqU7VhFXoIeSWIctsJIZ0axxkevt3PX0-py0Qpy6aylm-8yBQqJthtOlJ1MtIE5oA3NAVL_wxy0z50DVr2_rEp_zZZuvYuICol2Gk6UnUy0ARFZQyIi9T-I2DlXRLN6f80q_bVa2Vp-exEVEu02nCg7mWgDIpoNiYjU_yBi91wRrer9tar01269i4YKafYaTZOdTLMBCa2GJESqf5Cw9xavp0fiT3kcheuYV3rzNHY148E93_cgDjdizm9EOM-u2X-cZFz2uhHwONn_yvYfhuvsp6yv1eFOHZjSWrRdi-7JaapQM6oGd-rAhZqp0nYtuienWZE2_qfNHGwUYVMKW_KbLSnMqPxqu858yGFkPuQwNh8IjcwHQiPz0a4zH3IYmQ85jM0HQiPzgdDIfHSklnblknbrzEevjuFyGDFcDmOGIzRiOEJjG0BlbZb_k6rsTVUaXQJKm1MZRzSnpS2SU5UyuehUvkYQ02lpj6iojtCI6wiNyY7hiO0Yjule2qFKustpTHc5jeqO4JjuCI7pXlqked3biO6lnaKke2mnKOkupzHd5TSqO4JjuiM4pntpnyrpLqcx3eU0qjuCY7ojOKZ7aavm37UNue6stFukunvbD38DAAD__4DQfNY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMzPmy1KlbBuqItGwBS5arbjwwjRBYjG1jRQ2yn-vMMk68eD3zMQ2dwnweI5f5jwa88SS_zYsYLPhePjb3NnHG-f36eRP58vw78_jT6M75-p2NJvP_hpfO1cvnzmcPvF4-H7tjO7mw-ns-Oq5dyfT2-HU-fUf57BgLttGK3UXflMJC74wzlwmmMskc5nPXNZhC5ft4mipkiSKjx95yoDR6pEFbZett7t9enx54bJlFCsWPLF0nW4UC9g8_LpRUxWuVOy1mctWKg3Xm2yZx8P3m128_hbGB-ay2S7cJoHT8o4rT_Zp4NwItnh2WbRP88snaXivWMCf3Y9F6NQWQdhEuF0n6Xq7TD1emMENLyyQM18PzkOYPJz5fB5CfixEp9YQfmmI_Dr7bRSvVKxW766UXaU0pkCzyiN0moqAJpVH6FaI4H4o5R9h8jBT6WTnycKk5oedCt70_9N4zFy2Uf-mVzf8-pd4ff-Q_fVjm5ffVs9mh82iOFWxJ7Wp_Vx6_b7B2M5N5OWiZ0LcRa1o5_nt4ozPLj94tzw3Fwk3EIknWp60tplFiG6NIYRNiFwlvEGfGYfoNugzXp9M0KzKfFZjBDSpMp_ZRajsM34hn4Ed9uozbWqmPhPmXRYmXZYtz7cWikWIXo0hhE2IvMuiQaEYh-g1KBRRX5vRrMqEUmMENKkyodhFqCwUcSGhgB32KhRtaqZCkeZdliZd9lvZI5GdUCxC9GsMIWxC5F2WDQrFOES_QaHI-tqMZlUmlBojoEmVCcUuQmWhyAsJBeywV6FoUzMVim_eZd-ky52WtU4sIgxqiyBsIuQ99huUiXGIQYMy8etrMppVmUxqjIAmVSYTuwiVZeJfSCZgh73KRJvaR36-OXP9qUp20TZRRr_MtI8zU6t7dfoOkmgfL9XnOFpmy5z-nWRc9sJKJenpXXn6Z7Q9vXUM-BbmJCxoWBRh_hb238HcDuayCi14JXpQhZY9mpYk3akCczBymhaiCi3bleg-TfvkNu3ScMcCFkW4S8I9uiA9Egb33Cdhn9NLD0iag2ZzWiocLM41rdiYAdBIDQBHbkA4kAPAkR04LRegB0AjPwAcCQLgyBAIB3XhmmHeb1k0OloxBVzTBKclw7ugMLRm0K3TnhFtsDhtGj4AuKYaq7LTNCw7jcOyAxyVncZR2YVmWZuyAxqVHeCo7ABHZUc42PECnFvR6VFTDYVrZRe0aoQPjs20atCt06YRfbA4bRoBTjRCU43VmZ-m4aGfxuGpH-Do2E_jsOyaZa3KTtOw7DQOy07jsOwARzuePstK8LVL8IDM6bJLWjUSnKQlrRpw65I2jQTHCkmbRnYArqnGpuyARmUHOCo7wkHZAQ4f8jXLWj3l0zR8zKdx-JxP4_BBH-Box9NnWYm-N_osW8D1stOq8cFJ2qdVU7z1xfNP_wcAAP__HUwL5g==

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryBRktlBalrx3ydCtY4A_uJ59W6l8WO__vJIeZ9B_VxCCJPeoPdxStZyST6NR1_Ibe_bzeCqPyRn1_3JdPJ1cE7OXtYUuxWPxRMZja97Y_LhOynOSX847Y0n2wVXgwGyOAIKqzQRw_hBKAhvgQEFDhR8oBAAhRZEFDKZzoRSqdwueS6BfvIIYZPCYpWt8-2_IwqzVAoInyFf5EsBIUzju6UYizgR0msChUTk8WJZHvNYPHUzuXiIZQEUJlm8UiFpeNuTR-s8JF0O0YZCus5ftn_d9a4g81jN9_frMog2EQWVx_cCQrahfxez5TQmPxnzdZ_1KpWJkCLZ2ynaktiSI3f9HKv5ROSjzGOVNzItMhHuuwMUluJHftZl5-_l4n5e_vX76qxy9ddr-RbXOpJ5mDbSzGOt6gCOnh3snc3qv3lW4817vOH5b6KoQdC246D8ZFAHkjJHkvL68-d15u83vOBNRDEIeuE4KD8Z1IEo3JEofv35-3XmHzTKb86_F8Ug6KXjoPxkUAei-I5ECerPP6gz_1bjTTQxiNlxGpOfjOlAkuA_dKMjicZCZelKiVrNp7m9k0juxW5GKl3LmbiR6aw8ZvdzVHLlVzwRKt895bsf_VX5qJx7fbhtA3dsYGaVm7X0NDMYGTOD2zZwxwZmVrkrIzugeZVu_kn7etjXwmx_Zs0qHdgIrocRwfUwIrgexgRHaETwlo3gehgRXA8jguthTHCERgRv2wh-YaOoHkYU1cOIonoYUxShEUUvbRTVw4iiehhRVA9jiiI0omjHRlFm1RMQGpEUoRFLERrTFMOxrmBXFuzagl1dsOwLdoWBWTUGdlAZjGzV05itehqzVU-jtiI4ZqtJWTqcuklbMqUxW436kjGO2XpQHrS2Rpt3vwIAAP__qX57Jw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmNFu4kYUhu_7FNa5SiQjmBkbiKVK2TZURaJhC1y0WnHhxdMEicWubaSwUd69wlR1sOPze2I7vQvgz_P7ZL7DGZ4p-XtHHi0ns8nPK-sQ76xfFvPfrC-TPz7PPk3vrau76XK1_H12bV39e83xfMXT8bs1X9xNFtZPf1rHa2t6v5oslqcL-AvXZNM-DPS9_00n5H0hQTZJskmRTQ7Z5NLapigONzpJwvh0yXMGTIMn8gY2bffRIT29vbZpE8aavGdKt-lOk0cr_-tOL7Qf6Lg_IJsCnfrbXbbM0_H7bRRvv_nxkWxaRv4-8axe_7Ty_JB61q2k9YtN4SHNb5-k_oMmT7zY74vgthZBmkS42ybpdr9J-6JQg1tRWCBnvh6tRz95fOP6PIR6Xwi31RBOZYj8Pod9GAc61sHFnbK7VMaUqFZ5BLerCKhSeYRhgwj2u1L-6iePS53Oo74qVGp1jLT3yv9PsxnZtNN_pVe34vrHePvwmP313zavfqxRu5W9D3th1FdusQBvrj2-WFvUt1zUsLwve31l3GoMQgxbDCFNQuSeiw6bTe0Qww6bjWjPdFSrqmbTYgRUqapmYxahcbMRH9RsZH3XZB3XVK_vGAtvEGLUYghpEiJ3TXYofO0Qow6Fl-3ZhmpVJXyLEVClqoQ3i9BYePlBwqv6rqk6rjm9bN43E94gxLjFENIkRO6a6lD42iHGHQqv2rMN1apK-BYjoEpVCW8WobHw6oOEd-q75tRxze0Z624Q4aa1CNIkQu6Z06HstUPcdCi7055pqFZVsrcYAVWqSnazCI1ld_6H3w7eSLTQSRTuE13rl4HB6Zl08KDPNUrCQ7zRn-Nwky1zfjnPuOyNQCfp-VN1fjHdnz86BXwNCxaWPCyLsHgNOxewMIOFbETfNKHlsAmtFE8rlnabwKLR0nLQiB41oRXYLA67TcH_yzWAZREesjB46BGv5pDXa8zSQvD0DU8PQF8odRUTtwGN5EY4sBvgSG-AI79FqaWaCA5oZDjAkeIIB9sd4EhyUWqsl1sW4aUWw-El0QXfY9Cj801GjIFufJsRI4CXGo2RrTwNbQU4spXHoa08Dm0tNVkjW3ka2srj0FaAoy3L49BW_gtGCjBE8WNrAS_ZKvnBFTy65DuNdMHcy3ca6QC81GmM5maehoMzwNHkzONwdOZxZKssdVkTWwGNbAU4shXhaMvyOLJV8l8wcgxwfpIt4GVb-VEWPTrfaRQ4pSpwQAZztOKHGlB3QCNbEQ5sBTiyFeDwpMsflNFRFxzxmy0OD7sAR6dd8BsB2jX8F4xCpeNH2QJeslXxs2zx0dcvP_wTAAD__1qkDGw=

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1v2kgYhe_3V1jvVaI1MjNjvixVSndLVSQWuoC0u-py4cJsgkQxOzYSNMp_rwxNCJjM8WuIc1fAz8z0MM-ZIfcU_z-ngIbtbvv3kbMyc-fjoP-H86X99-fu-07PufrQGY6Gf3avnaufz6x3T6w3352_PrUHbWft_LuqVtXEkddOpzdqD4bpY--7XYjodynTH3xoD5zf_nHWY3JpEU11L_ymYwq-kCCXJLmkyCWfXKrR2KWliSY6jiOTPnK_BTrTNQVVl2aL5SpJ3x67NImMpuCeklky1xTQKPw61wMdTrXxquTSVCfhbL6dZr35frM0s2-h2ZBLw2W4iAOn4qUz91dJ4NwIGj-4FK2S_fBxEt5qCsSDm38JH2fzRBttvNrh_Lv303n2uQRB0OmNmkcT78f6unHuwvjucKDtQveLk5zFPc9HXC4gVSggARKaXCYg_8XF7cdZLSIz1UZPD0YapyR65MT_8FMY3w110l968ijj0Wapg0OByKW5_i-5uhHX78zs9m77rxyZ1ziZDyOTaOPJ2nFSv744fj1HbKcS-TnoiUX0okq09FT1OOOT0zcOpheMbZ1jV3uy4im2-GART_u6_hbicxK6ZESqUEQCZPQq6oty1RclqQ8yf1S_XlR9mX9nyTwbS1U8n-0eWMTTxmq8hXuMhMQlI1KFIhIgo1dxT5brnizJPZD5o3uNou6p_DtL5dlYfmV7LeW5BxbxtLGab-EeIyFxyYhUoYgEyOhV3FPluqdKcg9k_uhes6h7fv6d5efZWLUK2zywhKdt1XoL8xj5iMsFpAoFJEBCr-KdX653fknegcwfvWtd4qfmifEHOl5Gi1jn-hVZTTPT01u9-w7iaGUm-rOJJttpdi_7W277xlTHye5TsXvRWew-Shf4HBbHsHgO-wew5MFCnEU3zqGlOotu2WlpTVzZE1eMxAUPPkqcSzfOoY8S59ItO-1bE6_ZE69Z4bp95rr9uwZ6Nax00w43z3HTDiM3AQ3ctNPITUADN1v2NqyCOsyUKcdOQCM9EQ78BDgSFOHAUJGp1MPgJQje3qlAUpFpl8PJfTB5pl5Yp6CdhscgwNE5aMfhQQhwYJuwd6uog-Az7crSzU5D3QCOdLPjUDeAI93sJ4sAR4vIlCxLN3vJSlCyklOy2csXq2TZONAN4Eg3hKOLp71kJShZmSlZjm6ARrohHOgGcKQbwoFu0n7ASHDASPv9Fegm7SUrQclKTslmtxyrZNk40o1Vsmwc6WYvWQlKVnIu8NlvnXWDZ-NIN9Ydno0j3ewHjAIHjLL_SeRYt_HDLz8CAAD__zsY2Ek=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Ftv4kYbB_D791NYc5XoNTJzMAdLK2XbsFokCltAaqstFyxMEyQWU9tIsFG-ewVs4nDw8_cwQ-4C-O_nEPsn8BNL_52ziA1andavQ2-VzL1P_d5v3tfWn186H9td7-a-PRgOfu_cejc_j1nvj1hvfnh_fG71W97a-3tVrcqJJ269dnfY6g-2h6HD9Yft8b3-favv_fKXtx4xny3iqe6Ov-uURV8ZZz4TzGeS-Uwxn4Vs5LNlEk90msbJ9pCnXaA9XbOo6rPZYrnKtm-PfDaJE82iJ5bNsrlmERuOv811X4-nOgmqzGdTnY1n812Z9ebH3TKZfR8nG-azwXK8SCOvEmwr91ZZ5N1xNnr2WbzK8tOn2fhBs4g_--Vb-DSbZzrRSRAe1t-_v62T7yWKonZ32CgsLEwKv52duxteXjQ8B9NP8PDKpPD9LM1mi0kWiKPJTybLM9823uM4fTxzfN5EeFkTodMmaoVN5OdZLeJkqhM9PTjT7iyFbUq0q7yF-rVaQJvKW2hYtOBf1OXncfo40FlvGaijTQ03Sx29QfBjp8N8Ntf_ZDd3_PZDMnt43P1V4v5qmlxhgzjJdBKok639vxivaom9nVvJz7Oe6aIbV-JlEFaPl3y-_qGe3ACxEoYFohJIY8JBE6-K1VwTbjK9y_HlReNzML8x4qBw7ie_IuKlm6hdEXHuTlC0qyLEHbaANlWEuFkL1ojzd0IcXGEviJ9srTTiojwjoowishIoY0RBE6-K1F0jajA9dzm-vGh8DuY3RhQUzv0SV0S0dBP1KyIq3AmGdlWEqMMW0KaKEDVrwRpR8U6IgivsBdGTrZVGVJZnRJZRRFV2P_nNEAVNvCrScI2owfTc5fjyovE5mN8YUVA490teEdHSTTSuiKh0JxjaVRGiDltAmypC1KwFa0TlOyEKrrAXRE-2VhpRVZ4RVUaRsGJMKGjh1ZCma0INZufuhpcXDc_B9MaAgsK5XeqKgJZuonlFQJU7vdCuigB12ALaVBGgZi1YA6reCVBwhb0AerK1i57HninQ1-kyXqS61KPW6nZpevqg9_-ENF4lE_0liSe7MvuXvV1u98ZUp9n-U75_0V7sP9o2-DbMyXBIhwUZlnRYkmFFh9VxmL8N1w7C3CzM6zZpYZWWVmkF0iGZtgrzhk1aWKWlVVqBdI28TEG4bhAWx-EGGW7SN0iTRqFK981pU0KECq0KFyBOu8JrIE7LwgEt_OQmO4wDEzl9uQGaQBrZBOIIJxBHOoE44omf3GomPoE0AgrEkVAgjogCcWQUp53hTRCnpTmKnzjFaWtEFXyJAN9fAFWCtkYAawRtjQDWCNoaAawRtDUCff-ysgakkTUgjqwBcWQNiCNrhJU1II2sAXFkDYgja0AcWSNoawSwRtDWCGCNoK2RwBppZ42krZHAGgl-LwFrJG2NBNZI2hoJrJFW1oA0sgbEkTUgjqwBcWSNtLIGpJE1II6sAXFkDYgjayRtjQTWSNoaCayRtDUKWKPsrFG0NQpYo2hrFLBGgacz6PEMbY0C1igra0AaPt-xswbE4RMeO2uUlTUgjawBcWQNiCNrQBxZo2hrFLBG0dYoYI2irQmBNaGhNaPn__0XAAD__6XUZuQ=

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmO9v2jgcxt_fX2F9X7W6oGA7_Io0id2NaUgc7ADp7rTjRQa-FokRzglSWdX_fQJWaBLqJw40vFtpPrb3xJ_Hpo8U_b8gn0adXuf3MVvrBfs4HPzBvnT-_tx73-2zmw_d0Xj0Z--W3fx8ZrN_4mHznf31qTPssAf277palVMmb1m3P-4MR9vH3vd6EFHvGL9lg-GHzpD99g_bTMihZThT_eCbisj_QpwcEuSQJIc8cqhGE4dWOpyqKAr19pHHHdCdPZBfdWi-XK3j7ccTh6ahVuQ_UjyPF4p8GgdfF2qogpnSbpUcmqk4mC920zxsvrdXev4t0BtyaLQKlpHPKu525sE69lmbO21BkyeHwnV8nCGKgztFPn9y8q_i43wRK620W0suYf_5dqpjNL7vd_vj5mEV6SUcR_26YfdBdJ8css1p8nRcprBZ5suw-EXTkoXS4iCuKZOXTct7dZnHcdbLUM-UVrPESJMtiR458X_9FET3IxUPVq5IBT7erJSfVIscWqj_4ps2v32n53f3u38dX8Cr6dds0h-FOlbaFbV0Ur--On49R2ynEvk56IlF9MNKuHJlNZ3xyekbiem5xR7PscVdUXFlkUoA6zhs8vp1K8EmrgvnJQvlxUFgb1wKvNxS4CWVAkj_uRTqRUtB5N9mIs8ukxXXK2IlWMdhlzWua6VFXPzCeclCeXEQ2BtbKcq1UpRkJUj_2cpGUStl_m0m8-wyr7K74VpbCdZx2GXN61ppERe_cF6yUF4cBPbGVspyrZQlWQnSf7ayWdRKL_828_LsslqliJNgFYc91rqukxZh8YumJQulxUFcb2ykV66RXklGgvSfjWxd4ivtifGHKlqFy0jl-rZa3WamZndq_w6icK2n6rMOp7tp9j8Odtzug5mK4v1v-f6H7nL_q-0CX8I8DfOXsJeAhR3M-Vl04xxayLPolpkWxsSlOXFpkTi3g1OJ29KNc-hU4rZ0y0x7xsRr5sRrRrhunrluftdAr4aRbprh5jlummHkJqCBm2YauQlo4GbL3IZVUIeZMrWxE9BIT4QDPwGOBEU4MJRnKjUZvADBmzsVSMoz7ZKc3AOTZ-rF6hQ00_AYBDg6B804PAgBDmzj5m7ldRB8pl2tdDPTUDeAI93MONQN4Eg388nCwdHCMyVrpZu5ZAUoWWFTstnLl1XJWuNAN4Aj3RCOLp7mkhWgZEWmZG10AzTSDeFAN4Aj3RAOdBPmA0aAA0aY769AN2EuWQFKVtiUbHbLWZWsNY50sypZaxzpZi5ZAUpW2Fzgs2_d6gZvjSPdrO7w1jjSzXzASHDASPOfRNK6TZ5--REAAP__Cbn3AA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F1v2lYcBvD7fQrrXCWakTkv5sVSJbqFqkgMOkDapo4LF84SJIqZbaTQKN-9AhIcXvx_bB87dw3xw3n61PxE_cSi_5fMY-Nuv_v7xNqES-vTaPiH9bX795f-x97AurnrjSfjP_u31s3LNdvDFY_bH9Zfn7ujrvVo_bup1-XMkrdWbzDpjsa7y9Dl-oPFb63h6K47sn77x9pOmc1WwVwP_O86Yt5XxpnNBLOZZDZTzGYum9psHQYzHUVBuLvkaR_ozR-ZV7fZYrXexLuXpzabBaFm3hOLF_FSM49N_G9LPdL-XIdOndlsrmN_sdwf87j90VmHi-9-uGU2G6_9VeRZNWd38nATe1aH2x3Bps82CzZxckIU-_eaefzZzt7i02IZ61CHjnta4fD67qhkGs_zeoNJ69givYLIU-HtELzUJWShJTiYYmbJ7EuoPBXuFlG8WM1iR5zN0OFnBySZb1vrwY8erlyflHCLlXBLLdFILZG8z2YVhHMd6vnJO-3fJbWmRFslFZpVVUBLJRVaBhXsQi0_-9HDWMfDtaPOlpps19p7w-PHfp_ZbKn_i286_PZDuLh_2P8p-bCl_rXaee6wcRDGOnTUxWq_pptWz7DbtUle3vVKi0FQC9aOWz8f-fr5p6jyHKJlAM0RNUcWwR30OJLWqA73PFOUvIUstAUHYxjwDioksvIKec9colEh77w8W9FWabyXWAEtlcZ7vgrGvPN34h3cYa-8X6yWmXeR3RSRhRRZc1QRXkGPIynN6njNMQUveQtZaAsOxjDgFVRIZBMV8pq5RLNCXkV5tqGt0ngtsQJaKo3XfBWMeRXvxCu4w155vVgtM68yuykyCymqtn96kJtX0ONISqs6XnNMwUveQhbagoMxDHgFFRLZZIW8Zi7RqpBXWZ5taKs0XkusgJZK4zVfBWNe5TvxCu6wV14vVsvMq8puispCilsrgitocQSlXR2uOYbgpS4hCy3BwRQGtIIKiWqqQlozl2hXSKsqzzW0VRqtJVZAS6XRmq-CMa3qnWgFd9grrRerFXrue-WAkY7WwSrSmR7p1nej6fm9PvwjRMEmnOkvYTDbH3P4cbjP7V-Y6yg-_JYffuitDr_aFXwb5mTYpcOCDEs6LMmwosPqPMzfhhsnYZ4vzJsmaWGUlkZpBdIumTYK85ZJWhilpVFagXSDvE1BuJkjLM7DLTLcpj8gbRqFOt2b06a4CBVaFS5AnHaFN0CcloUDWvjFh-w0Dkzk9O0GaAJpZBOII5xAHOkE4ognfvFRy-MTSCOgQBwJBeKIKBBHRnHaGd4GcVqas_iFU5y2RtTBlwjw_QVQJWhrBLBG0NYIYI2grRHAGkFbI9D3LyNrQBpZA-LIGhBH1oA4skYYWQPSyBoQR9aAOLIGxJE1grZGAGsEbY0A1gjaGgmskWbWSNoaCayR4P9LwBpJWyOBNZK2RgJrpJE1II2sAXFkDYgja0AcWSONrAFpZA2II2tAHFkD4sgaSVsjgTWStkYCayRtjQLWKDNrFG2NAtYo2hoFrFHg6Qx6PENbo4A1ysgakIbPd8ysAXH4hMfMGmVkDUgja0AcWQPiyBoQR9Yo2hoFrFG0NQpYo2hrXGCNm9Oa6fMvPwMAAP__tpGFmw==

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jwYhs_fXxE9R61kFJwPWiK9EtXGNCQGHeFgUpWDlHgFKU0yO5FIK_77lNCO8TE_8QzZYYiv-LafS-J-BfEjBg_84Xj4YW4UPDY-zaZfjIfht_vx3WhiXH0c-XP_6_jaeFuyJka5XbMuX4zRZD6c-dXvd-Px-5KSGOtfSwIgkKQRm4TPTID3ABQIWEDABgIOEHAhIJDxdMGESHm15LUGRtEavC6BVZIVefVzQGCRcgbeK-SrPGbgwTx8jNmMhRHjZhcIRCwPV3G9zbp8GWR89RzyEgj4WZgIz-iY1c7TIveMgUUGFIINgbTI33bYffixNJahWO5_ckDJwIJgExAQefjEwKMb8ndhXcWwbztrhbX-GHb3qSJJecQ4i_Y-FlQktuTEiT-HYumzfJqZ9GA68zJj3r49QCBm3_OrOvj1_3z1tHx_kF3D7ny2xvlOhJ-knTQzqXt4Eyf3dvb2ps1FoA1EMK2OaV_QW4W4PeW45zeXtmsubdtcq_k4rCbjsDumc0F7FOLeKMc9vz1Wu_ZYbdtjNx-H3WQcTqf-s7qUPQpxb5Xjnt8eu1177LbtcZqPw2kyDrdzQXcUwvYVw57fHKddc5x_2bdORJsxkaWJYI3aVLc6HIue2PayRFrwBbvn6aLeZvs4rbm6DURM5Nu31vZhlNSv6gE0h3s6cF8Hplq5qSunqcKVUTW4pwP3dWCqlfvgyo5o65Du_k7bctiWwnT_zrqHtKMjuBxGBJfDiOByGBMcoRHBXR3B5TAiuBxGBJfDmOAIjQje0xH8RkdROYwoKocRReUwpihCI4re6igqhxFF5TCiqBzGFEVoRNG-jqJUqycgNCIpQiOWIjSmKYZjXUGvLOi1Bb26oNkX9AoD1WoM9KgyKNkqpzFb5TRmq5xGbUVwzFaVsnR86yptSZXGbFXqS8o4ZutReZDaGmz--xkAAP__MRCLvQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7tCsNgpmxgViqlFU3VZFosg08VFrx4IVpgsRiahsJNsp_r4C0Tmx8zwy208dgPub4xudjhidK_15RSJOb8c0vU2-brLxf7-9-977e_Pll_Gl06334PJpMJ3-MP3ovb9kJb396z27_wxvdTm_uJ4fXXy7vhbf77_KMBK3jhbmNvpuUwq8kSZAiQZoE-SQooJmgTRLPTZrGyeEtT0dgtNhR2BO0XG-22eHlmaB5nBgKnyhbZitDIU2jbytzb6KFSbo9ErQwWbRcHZfZ7X9cb5Ll9yjZk6DJJlqnodfpHla-22ahd63EtaTZs6B4m-UrpFn0YCiUz-KyFIFjCimuVWUK5ZLi8zLNlut51pWFSZxbI8e-7b3HKH08j-RR9GVRghai-JVR8o_aruNkYRKzePNhx0-pDKss5panCNpKYTGyPEW_RgpxUdDfovRxYrK7TVcX5jXdb0z4ygafxmMStDJ_ZR-ON_Hx52T58PjvH3YNGDQ75du4E2-6OihO4uzawzdrS3sHSAsHdFWnqy9xkUOOvnMOBxuBHLkCZOs2so7Sb91GsjkPWMytykYNprAYWZWN3FLUtpF8bxsp-yYqmybqTte_xAgOOQbOORyMAHLkNVStG8E6yqB1I6jmumgxtyojNJjCYmRVRnBLUdsI6r2NoO2bqG2a6HeO5wlnIzjkGDrncDACyJHXULduBOsow9aNoJvrosXcqozQYAqLkVUZwS1FbSPo9zaCb99E36aJQecSHzikuHJM4WADkCKvoN-6DayjXLVuA7-5HlrMrcoGDaawGFmVDdxS1LaB_3_-fnEm2r1JN_E6NVa_TvQON2cWD-Y0rDTeJnPzJYnnx2VOf94dueMLC5Nmp6v69Mdofbp0CPgaliyseFgVYfka9t_A0g2WqhZ9VYdW_Tq01jytWTqoA8taS6teLXpQh9bgYfHZxxT8vwIHWBXhPguDmx7w1ezz9RqytJQ8fcXTPeCFklVcug1oVG6Eg3YDHNUb4KjfsqRUl4IDGjUc4KjiCAePO8BRyWVJrG8fWYSXFMPhpaJL3jHo1nnJyCGoG68ZOQB4STRObeVp2FaAo7byOGwrj8O2liTr1Faehm3lcdhWgKNHlsdhW_kvGCXBJorfthbwUlsVv3EFt65406gA7Ht50ygf4CXTOO2beRpunAGOds48DrfOPI7aqkqWdWkroFFbAY7ainD0yPI4aqviv2DUEOD8TraAl9vKb2XRrfOm0eCUqsEBGeyjNb-pAXMHNGorwkFbAY7aCnB40uUPyuioC4749RaHh12Ao9Mu-I0APTX8F4xGo-O3sgW81FbN72WLtz57_umfAAAA___n7Cla

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1v2kwQgO_vr7DmFPQuMru2-bBUKWlDVSQKKebQKvLBwduARLC7NhIkyn-vMEHUGO94cbI3CPvMjmeeyfgFkj9LcMHrD_tfpsZaLI2vk_F3477_8254MxgZV7cDb-r9GDaMq7czm_2JzfbZGE9u-xPj8y9j2zAGo2l_4u0O3AyH0sPPjePnjQ8EVlHIR8ETT8C9BwoEGBCwgIANBBzwCcQimvEkicTuyEsGDMINuC0Ci1W8Tnd_9gnMIsHBfYF0kS45uDANHpZ8woOQC7MFBEKeBotlds1m-3wdi8VTILZAwIuDVeIaTXN383idusY1Bf-VQLRO38Ifoz5sjXmQzPPxsvM-gSQNHjm49JVclqajNU1WmuYxznoViZALHuYi-TsSO3LmWb8Fydzj6Tg26UlHptuYu3mNgMCS_06vrmnjk1g8zrNPpY9-fCxLpfpeJFIuTOqcVur_0vh2hbKdq8hb0DNJjKJmFJusdVrjs9c7uetpdbloBblM1jStD5kChUTbmhNlpYlqmAOqaQ6Q-h_moH3pHLDq_WVV-ms1TftDRFRItKM5UVaaqAYRmSYRkfofROxcKqJVvb9Wlf7azWwtv7-ICol2NSfKShPVIKKlSUSk_gcRu5eKaFfvr12lv07zQzRUSLOnNU1WmqYGCW1NEiLVP0jYe4_X0zPxJzyJo1XCK715tnY14-Ej3_cgidZixu9ENMuu2X8dZ1z2uhHyJN3_yvZfBqvsp6yv1eFOHZjSWrRTi-7JaapQM6oGd-rAJzVTpZ1adE9Os1O69S9t5eDWKWxJYVt-sy2FGZVf7dSZDzmMzIccxuYDoZH5QGhkPtp15kMOI_Mhh7H5QGhkPhAamY-O1NKuXNJunfno1TFcDiOGy2HMcIRGDEdobAOorM3if1KVvalKo0tAaXMq44jmtLBFcqpSJhedytcIYjot7BEV1REacR2hMdkxHLEdwzHdCztUSXc5jekup1HdERzTHcEx3QuLNK97G9G9sFOUdC_sFCXd5TSmu5xGdUdwTHcEx3Qv7FMl3eU0prucRnVHcEx3BMd0L2zV_Lt2S647K-wWqe7-639_AwAA___juoKq

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mEtv6kYYhvf9FdasEtXIzIWbpUo5baiKRMMpsGh1xMIHpgkSB1PbSJAo_70CEjlh8PfOxHZ2ufjxvP6Y99GYJ5b-t2Ihm_SH_d-m3jZZeb-PR3963_p_fx1-Gdx5V7eDyXTy1_Dau3q5Zne6Yrd_9Ebj2_7Y-_Ufb3_tDe6m_fHkcAF14eN1_vNuxny2jhf6LvqhUxZ-Y5z5TDCfSeYzxXzWYjOfbZJ4rtM0Tg6XPB2BwWLHwqbPluvNNjv8eeazeZxoFj6xbJmtNAvZNPq-0mMdLXQSNJnPFjqLlqvjMrv9480mWf6Ikj3z2WQTrdPQawSHlUfbLPRuOJs9-yzeZvnt0yy61yzkz_7HIrQqiyBcItwu02y5nmcBP5uBsUDOfN97D1H6cOH6PIT8WIhWpSFUYYj8Ptt1nCx0ohfv7nS8S2FMgWaVR2jVFQFNKo_QLhHB_1DKP6L0YaKz0SaQZ5Oa7jc6fKOCL8Mh89lK_5td3fDrX5Ll_cPxJ4tt3nHZYZM4yXQSSGNqPxfev2sxtksTebnphRB3cSPeBKp5PuOLy_feLc_tRcItRBKIRiCdbeYQol1hCOESIlcJr9Fn1iHaNfqMVycTNKsin1UYAU2qyGduEUr7jH-Sz8AOe_WZMTVbnwn7LgubLstGoJyF4hCiU2EI4RIi77KoUSjWITo1CkVU12Y0qyKhVBgBTapIKG4RSgtFfJJQwA57FYoxNVuhSPsuS5suq8bxlchNKA4huhWGEC4h8i7LGoViHaJbo1BkdW1GsyoSSoUR0KSKhOIWobRQ5CcJBeywV6EYU7MVirLvsrLpcqvhrBOHCL3KIgiXCHmPVY0ysQ7Rq1Emqromo1kVyaTCCGhSRTJxi1BaJuqTZAJ22KtMjKl95OubC_cf63QTr1Nt9c1M8zAzvbjXp88gjbfJXH9N4vlxmdOvoyN3_MNCp9npv_L0y2B9-tch4FuYk7CgYXEO87ewegdzN5jLMrTgpeheGVp2aFqSdKsMzMHIaVqIMrRslqK7NK3Ibdqm4ZYDLM7hNgl36IJ0SBg8c5eEFaeX7pE0B83mtFQ4WJwbWnExA6CRGgCO3IBwIAeAIztwWi5AD4BGfgA4EgTAkSEQDurCDcO837JodLRiznBDE5yWDG-DwtCaQY9Oe0Y0weK0aXgP4IZqnMpO07DsNA7LDnBUdhpHZReGZV3KDmhUdoCjsgMclR3hYMcLcG5Fp0dDNRRulF3QqhEKHJtp1aBHp00jumBx2jQCnGiEoRqnMz9Nw0M_jcNTP8DRsZ_GYdkNyzqVnaZh2Wkclp3GYdkBjnY8fZaV4GOX4AWZ02WXtGokOElLWjXg0SVtGgmOFZI2jWwB3FCNS9kBjcoOcFR2hIOyAxy-5BuWdXrLp2n4mk_j8D2fxuGLPsDRjqfPshJ9bvRZ9gw3y06rRoGTtKJVc_7os-ef_g8AAP__l74Rug==

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9v2j4QwN-_f0V0T0Vfo2An4UekSe1WpiEx6AgPm6o8pMQrSJRkTpCgVf_3iVDEQogvJq3fmsYf-3L3Oc4vkPxZggtef9j_MjXWYml8nYy_G_f9n3fDm8HIuLodeFPvx7BhXL2t2exXbLbPxnhy258Yn38Z24YxGE37E2-34GY4lC8mxnPj-LjxgcAqCvkoeOIJuPdAgQADAhYQsIGAAz6BWEQzniSR2C15yYBBuAG3RWCxitfp7t8-gVkkOLgvkC7SJQcXpsHDkk94EHJhtoBAyNNgscyO2Wyfr2OxeArEFgh4cbBKXKNp7k4er1PXuKbgvxKI1unb9sddH7bGPEjm-f2y9T6BJA0eObj0lVwWpqM1TFYa5nGf9SoSIRc8zO3k70hsyZlv_RYkc4-n49ikJxWZbmPu5k0CAkv-O726po1PYvE4z_4q_fTjZ1kq2fcikXJhUuc0U_-X7m9XSNu5jLxteiaIUdSMYpO1TnN89ngndzytLhetIJfJmqb1IV2gEGhbc6CsNFANfUA19QGS_0MftC_tA1a9vqxKfa2maX-IiAqBdjQHykoD1SAi0yQikv-DiJ1LRbSq19eqUl-7mY3l9xdRIdCu5kBZaaAaRLQ0iYjk_yBi91IR7er1tavU12l-iIYKYfa0hslKw9Qgoa1JQiT7Bwl773E9PbP_hCdxtEp4pZtna5czHj7yfQ2SaC1m_E5Es-yY_eM447LrRsiTdP-W7R8Gq-xVVtfqcKcOTGkt2qlF9-Q0VcgZVYM7deCTnKnSTi26J6fZKd36l7ZycOsUtqSwLT_ZlsKMyo926vSHHEb6Qw5j_YHQSH8gNNIf7Tr9IYeR_pDDWH8gNNIfCI30R0dqaVcuabdOf_TqGC6HEcPlMGY4QiOGIzQ2AVTGZvGXVGVuqtLoEFCanMo4ojktTJGcqpTJRafyMYKYTgtzREV1hEZcR2hMdgxHbMdwTPfCDFXSXU5justpVHcEx3RHcEz3wiDN695GdC_MFCXdCzNFSXc5jekup1HdERzTHcEx3QvzVEl3OY3pLqdR3REc0x3BMd0LUzV_127JdWeF2SLV3X_9728AAAD__0Yeg28=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FdasEtXIzAdflirltqEqEg23wKLVFQtfmCZIXExtI0Gi_PcKSOSEwe-Zie3sQuLHc_wy59E4Tyz9b8VCNukP-79NvW2y8n4fj_70vvX__jr8Mrjzrm4Hk-nkr-G1d_Vyze50xW7_6I3Gt_2x9-s_3v7aG9xN--PJ4QLyQt97vM4_7mbMZ-t4oe-iHzpl4TfGmc8E85lkPlPMZy0289kmiec6TePkcMnTERgsdixs-my53myzw69nPpvHiWbhE8uW2UqzkE2j7ys91tFCJ0GT-Wyhs2i5Oi6z2z_ebJLljyjZM59NNtE6Db1GcFh5tM1C74az2bPP4m2W3z7NonvNQv7sfyxCq7IIwiXC7TLNlut5FvCzGRgL5Mz3vfcQpQ8Xrs9DyI-FaFUaQhWGyO-zXcfJQid68e5Ox7sUxhRoVnmEVl0R0KTyCO0SEfwPpfwjSh8mOhttAnk2qel-o8M3NvgyHDKfrfS_2dUNv_4lWd4_HH-y2OYdlx02iZNMJ4E0pvZz4f27FmO7NJGXm14IcRc34k2gmuczvrh8793y3F4k3EIkgWgE0tlmDiHaFYYQLiFylfAafWYdol2jz3h1MkGzKvJZhRHQpIp85hahtM_4J_kM7LBXnxlTs_WZsO-ysOmybATKWSgOIToVhhAuIfIuixqFYh2iU6NQRHVtRrMqEkqFEdCkioTiFqG0UMQnCQXssFehGFOzFYq077K06bJqHF-J3ITiEKJbYQjhEiLvsqxRKNYhujUKRVbXZjSrIqFUGAFNqkgobhFKC0V-klDADnsVijE1W6Eo-y4rmy63Gs46cYjQqyyCcImQ91jVKBPrEL0aZaKqazKaVZFMKoyAJlUkE7cIpWWiPkkmYIe9ysSY2kf-fXPh_mOdbuJ1qq3-M9M8zEwv7vXpO0jjbTLXX5N4flzm9HF05I6_WOg0O_1Vnj4M1qc_HQK-hTkJCxoW5zB_C6t3MHeDuSxDC16K7pWhZYemJUm3ysAcjJymhShDy2YpukvTitymbRpuOcDiHG6TcIcuSIeEwTN3SVhxeukeSXPQbE5LhYPFuaEVFzMAGqkB4MgNCAdyADiyA6flAvQAaOQHgCNBABwZAuGgLtwwzPsti0ZHK-YMNzTBacnwNigMrRn06LRnRBMsTpuG9wBuqMap7DQNy07jsOwAR2WncVR2YVjWpeyARmUHOCo7wFHZEQ52vADnVnR6NFRD4UbZBa0aocCxmVYNenTaNKILFqdNI8CJRhiqcTrz0zQ89NM4PPUDHB37aRyW3bCsU9lpGpadxmHZaRyWHeBox9NnWQm-dglekDlddkmrRoKTtKRVAx5d0qaR4FghadPIFsAN1biUHdCo7ABHZUc4KDvA4Uu-YVmnt3yahq_5NA7f82kcvugDHO14-iwr0fdGn2XPcLPstGoUOEkrWjXnjz57_un_AAAA__-qkBJ_

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryBRktlBKq3471NCtY4A_uJ59W6l8WO__vJIeZ9B_VxCCJPeoPdxStZyST6NR1_Ibe_bzeCqPyRn1_3JdPJ1cE7OXtZsdiseN09kNL7ujcmH7-TpnPSH0954Uiy4GgyQxRFQWKWJGMYPQkF4CwwocKDgA4UAKLQgopDJdCaUSmWx5LkE-skjhE0Ki1W2zot_RxRmqRQQPkO-yJcCQpjGd0sxFnEipNcEConI48WyPOZx89TN5OIhlhugMMnilQpJwytOHq3zkHQ5RFsK6Tp_2f5117sNmcdqvr9fl0G0jSioPL4XELIt_buYLacx-cmYr_usV6lMhBTJ3k5RQWJLjtz1c6zmE5GPMo9V3sh0k4lw3x2gsBQ_8rMuO38vF_fz8q_fV2eVq79ey7e41pHMw7SRZh5rVQdw9Oxg72xW_82zGm_e4w3PfxNFDYK2HQflJ4M6kJQ5kpTXnz-vM3-_4QVvIopB0AvHQfnJoA5E4Y5E8evP368z_6BRfnP-vSgGQS8dB-UngzoQxXckSlB__kGd-bcab6KJQcyO05j8ZEwHkgT_oRsdSTQWKktXStRqPs3iTiK5F7sZqXQtZ-JGprPymN3PUcmVX_FEqHz3lO9-9Fflo3Lu9eG2DdyxgZlVbtbS08xgZMwMbtvAHRuYWeWujOyA5lW6-Sft62FfC7P9mTWrdGAjuB5GBNfDiOB6GBMcoRHBWzaC62FEcD2MCK6HMcERGhG8bSP4hY2iehhRVA8jiuphTFGERhS9tFFUDyOK6mFEUT2MKYrQiKIdG0WZVU9AaERShEYsRWhMUwzHuoJdWbBrC3Z1wbIv2BUGZtUY2EFlMLJVT2O26mnMVj2N2orgmK0mZelw6iZtyZTGbDXqS8Y4ZutBedDaGm3f_QoAAP__3Gl7KQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryBRktlBKq3471NCtY4A_uJ59W6l8WO__vJIeZ9B_VxCCJPeoPdxStZyST6NR1_Ibe_bzeCqPyRn1_3JdPJ1cE7OXtZsdiseN09kNL7ujcmH7-TpnPSH0954Uiy4GgyQxRFQWKWJGMYPQkF4CwwocKDgA4UAKLQgopDJdCaUSmWx5LkE-skjhE0Ki1W2zot_RxRmqRQQPkO-yJcCQpjGd0sxFnEipNcEConI48WyPOZx89TN5OIhlhugMMnilQpJwytOHq3zkHQ5RFsK6Tp_2f5117sNmcdqvr9fl0G0jSioPL4XELIt_buYLacx-cmYr_usV6lMhBTJ3k5RQWJLjtz1c6zmE5GPMo9V3sh0k4lw3x2gsBQ_8rMuO38vF_fz8q_fV2eVq79ey7e41pHMw7SRZh5rVQdw9Oxg72xW_82zGm_e4w3PfxNFDYK2HQflJ4M6kJQ5kpTXnz-vM3-_4QVvIopB0AvHQfnJoA5E4Y5E8evP368z_6BRfnP-vSgGQS8dB-UngzoQxXckSlB__kGd-bcab6KJQcyO05j8ZEwHkgT_oRsdSTQWKktXStRqPs3iTiK5F7sZqXQtZ-JGprPymN3PUcmVX_FEqHz3lO9-9Fflo3Lu9eG2DdyxgZlVbtbS08xgZMwMbtvAHRuYWeWujOyA5lW6-Sft62FfC7P9mTWrdGAjuB5GBNfDiOB6GBMcoRHBWzaC62FEcD2MCK6HMcERGhG8bSP4hY2iehhRVA8jiuphTFGERhS9tFFUDyOK6mFEUT2MKYrQiKIdG0WZVU9AaERShEYsRWhMUwzHuoJdWbBrC3Z1wbIv2BUGZtUY2EFlMLJVT2O26mnMVj2N2orgmK0mZelw6iZtyZTGbDXqS8Y4ZutBedDaGm3f_QoAAP__3Gl7KQ==

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdF3Asko2Am0RJrUamMaEoMOOEyqckiJV5AoyewgQav-9ylJESOAv3gWyTHET_z68yPxvoH8swIPpv1h_8vM2oiV9W0y_mE99n89DO8HI6vxdTCdTX8Om9bHkm2-oNHYPxNrl_-03b02rcFo1p9M0xf3w6F1flHTBwLrKOSj4IVL8B6BAgEGBBwg4AKBDvgEYhHNuZSRSJe8ZcAg3ILXJrBcx5sk_dknMI8EB-8NkmWy4uDBLHha8QkPQi7sNhAIeRIsV9k2293rXSyWL4HYAYFpHKylZ7XsdOfxJvGsO0ruGPjvBKJN8rHD4cNPO2sRyMXxJ_eIT0AmwTMHj76T_wvbqSEsuxj28KnNOhIhFzw8-pifktiSMyf-HsjFlCfj2KaF25ntYu4dCwQEVvx30siCNz-L5fNi_3AYQ2EGh8M5Boc7k3wUtaLYpp3iGM7u7R7tTctbQEtYYLOW7VxRWo243VrisotxK9CWVqotK38XrMxdOC3bvaI6GnFvaonLLsatQB1WqTpO-btwytyF28r-o66ljkbc21risotxK1DHqVQdt_xduGXuotO6ojgaYXs1hGUXw1agjVtbxzqTa8JlHK0lL9Wg2unJePjM80nJaCPm_EFE82yb_HGccVkDCLlM8rcsfxiss1fZ9MvDXRO4ZwJTo9y0o6apxsioHtw1gXsmMDXKXRjZCc2KdPtf2lHDjhKmxzNrF2nXRHA1jAiuhhHB1TAmOEIjgndMBFfDiOBqGBFcDWOCIzQieNdE8BsTRdUwoqgaRhRVw5iiCI0oemuiqBpGFFXDiKJqGFMUoRFFeyaKUqOegNCIpAiNWIrQmKYYjnUFs7Jg1hbM6oJhXzArDNSoMdCTyqBlq5rGbFXTmK1qGrUVwTFbdcrS6dR12pIujdmq1Ze0cczWk_KgtNV___Q3AAD__6sBjWY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7lEiDYGZsIJYqZdVNVSSabAMPlVY8eGGaILGY2kYKG-W_V0AjJza-Zwbb2Ufj-TxnLnOO7_iZ0n9XFNLkZnzz29TbJivv9_u7P72vN39_GX8a3XoXn0eT6eSv8aX3_5Cn44CLi9dr4e2OPz3tflx6o9vpzf1kf-P0gMsZCVrHC3MbfTcphV9JkiBFgjQJ8klQQDNBmySemzSNk_2Q5wMwWjxR2BO0XG-22f7nmaB5nBgKnylbZitDIU2jbytzb6KFSbo9ErQwWbRcHaZ52v243iTL71GyI0GTTbROQ6_T3c98t81C71qKa0WzF0HxNstnSLPowVAoX8R5KoImVSgXFZ-XabZcz7OuLFTi1Bw59m3nPUbp42kkl6LPkxK0IMWvlJI_aruOk4VJzOLdww5PqRSrLOqWqwjaUmFRslxFv4YKcZbQP6L0cWKyu01XF-o13W1M-CYQPo3HJGhl_skuDou4_DVZPjy-XuQOqFzcoNkS38adeNPVQbEMJ-cevptb2geAtAiArup09TlB5KCj36wO5aIj979sPYqspfRbjyLZXAhY1K0qihpUYVGyqihyU1E7iuSHRpGyt6GysaHudP1z4sBBx6BZHcpFR-5B1XocWEsZtB4HqjkjWtStKg4aVGFRsqo4cFNROw7Uh8aBtrehtrGh3zkcI5zjwEHHsFkdykVH7kHdehxYSxm2Hge6OSNa1K0qDhpUYVGyqjhwU1E7DvSHxoFvb0PfxoZB55wwcFBx1aQK5aIi95_fehRYS7lqPQr85kxoUbeqKGhQhUXJqqLATUXtKPB_2jeLE7ruTbqJ16mx-iLR26_MLB7MsVJpvE3m5ksSzw_THC_vDtzhh4VJs-NdfbwYrY-39gLfwpKFFQ-rIizfwv47WLrBUtWir-rQql-H1pqnNUsHdWBZa2rVq0UP6tAabBaf3abg_wocYFWE-ywMFj3grdnn7TVkaSl5-oqneyAXSqni4m1AI3MjHLgb4MjeAEf-lqVIdTE4oJHDAY4sjnCw3QGOTC5Lwfp-yyK8FDEcXjK65DMGLZ0PGTkEduNjRg4AXgoaJ7fyNHQrwJFbeRy6lcehW0sh6-RWnoZu5XHoVoCjLcvj0K38C0ZJ0ETxbWsBL7lV8Y0rWLrik0YFoO_lk0b5AC8ljVPfzNOwcQY46px5HLbOPI7cqkop6-JWQCO3Ahy5FeFoy_I4cqviXzBqCHC-ky3gZbfyrSxaOp80GpxSNTgggz5a800NqDugkVsRDtwKcORWgMOTLn9QRkddcMSvNzk87AIcnXbBNwK0a_gXjEal41vZAl5yq-Z72eLSZy-__BcAAP__VU4rAw==

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9vok4QwN-_fwWZpzbfNbAL-IPkEnutlzPxak986KXhgcpeNbHCLZhIG__3i1ivRewOK8pbKfvZHWY-4-wrxH_m4IDbG_Sux9pSzLVvo-EP7aF3fze46t9qFzd9d-z-HFxqF29r0u2KVfpyqfXur3t3Y-1qMPj3eqVdubk1w9FNb6R9_aWlHhBYhAG_9Z95DM4DUCDAgIAJBCwgYINHIBLhhMdxKDZLXjOgH6zAMQjMFtEy2fzbIzAJBQfnFZJZMufgwNh_nPMR9wMudAMIBDzxZ_PsmFX60o3E7NkXKRBwI38RO1pD35w8XCaO1mXgrQmEy-Rt-_ddH1Nt6sfT_H5dCt7aIxAn_hMHh67JcWHaimHSSmGyT8N832e5CEXABQ9yO3kbElty4Fu_-_HU5ckw0uleRcZpxJ0P9gCBOf-dXHTp5Rcxe5pmf3363e_fZKqk3g1FwoVO7f00_f_p_laJnB1Kx9umB4K4DRthpDNjP8EHj7dzx9PyZtESZumsoZtnaQGFQJvKgZ6yCWi9TUDraAIk-bsmaB7bBKx8cVmZ4poN3TqLhQqBtpQDPaWFrF4LWR0WIsnfWdg61kKzfHHNMsW1Gtk0Pr2FCoG2lQM9pYVmvRaadViIJH9nYftYC63yxbXKFNdunMVBhTA7imGe0kCrXgOtOgxEUr8zsHOKK-mB_Uc8jsJFzEvdNo1NwnjwxLcFiMOlmPA7EU6yY7aPw4zLbhkBj5PtW7Z96C-2rzYBlodbVWBKK9F2Jbojp6lCzpga3KoC7-VMlbYr0R05zfZp4yNt5mBjHzalsCWvliWFGZUfbVfpDzmM9IccxvoDoZH-QGikP5pV-kMOI_0hh7H-QGikPxAa6Y-W1NK2XNJ2lf7oVDFcDiOGy2HMcIRGDEdobAKojM3iL6nK3FSl0SGgNDmVcURzWpgiOVUpk4tO5WMEMZ0W5oiK6giNuI7QmOwYjtiO4ZjuhRmqpLucxnSX06juCI7pjuCY7oVBmte9iehemClKuhdmipLuchrTXU6juiM4pjuCY7oX5qmS7nIa011Oo7ojOKY7gmO6F6Zq_q5tyHVnhdki1d1b__c3AAD__2zTeK0=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMzPmy1KlpBuqRqIhBS62WnHhhWmCxGJqGylslP9eAcs6ePB7ZmKbuyT48Ry_zHk0zitL_luygI37g_6nibOJl84fo-Ffzpf-58fB7f2Dc3V3P56M_x5cO1c_rtkernjZfr92-p8_9R8nPz96cW7HJ58PR3f9kfP7P852yly2iubqIfymEhZ8YZy5TDCXSeYyn7msxaYuW8fRTCVJFO8ued0D9_MXFjRdtlitN-nuz1OXzaJYseCVpYt0qVjAJuHXpRqpcK5ir8lcNldpuFjul3nZfr9Zx4tvYbxlLhuvw1USOA1vt_JwkwbOjWDTN5dFmzS7fZKGT4oF_M39WISWZQReGEHYRLhbJOliNUs9npuBtkDGfN06z2HyfOb6LIT8WIhWpSH8whDZfTarKJ6rWM1P7rS_S2FMgWaVRWjVFQFNKovQLhHB_VDKP8PkeazS4dqTuUlNtmsVHA1wOxgwly3Vv-nVDb_-LV48Pe9_MtjjHZvtNY7iVMWe1Eb2a-H9uwYzOzeOHzc9E-IhakRrz2_mB3x2-d7J8tzcItzAIp5oeNJaZRYh2tYhTGUGQmQe4TXKzDhEu0aZ8epMgmZVJLMKI6BJFcnMLkJpmfFLyAxsr6PMtJGZykyYF1mYFFk2PN_aJhYhOtYhTG0CQmRFFjXaxDhEp0abiOqqjGZVZJMKI6BJFdnELkJpm4hL2ARsr6NNtJGZ2kSaF1maFNlv7N-E7GxiEaJrHcLUJiBEVmRZo02MQ3RrtImsrspoVkU2qTACmlSRTewilLaJvIRNwPY62kQbmalNfPMi-yZFbjWsXWIRoWcZwdQkIEJWYr9GkxiH6NVoEr-6GqNZFZmkwghoUkUmsYtQ2iT-JUwCttfRJNrIPvIvmzP3H6lkHa0SZfTfmOZuYGr-pA5fQBJt4pl6jKPZfpnDr8M9t__DXCXp4VNx-OV-dfhoF_A9zElY0rDIw_w97J_A3A7msgwteCm6V4aWHZqWJN0qA3MwcpoWogwtm6XoLk375DZt03DLAhZ5uE3CHbogHRIGz9wlYZ_TS_dImgOa01LhyCqaVmzMAGikBoAjNyAcyAHgyA6clgvQA6CRHwCOBAFwZAiEg7pwzTCnWxaNjlZMDtc0wWnJ8DYoDK0Z9Oi0Z3gPLE6bRjQBrqnGquw0DctO47DsAEdlp3FUdqFZ1qbsgEZlBzgqO8BR2REOdrygz60CnR411VC4VnZBq0b44NhMqwY9Om0aAY4kgjaN6AJcU43VmZ-m4aGfxuGpH-Do2E_jsOyaZa3KTtOw7DQOy07jsOwARzuePstK8LVL-iybw7WyS_CKDI7CklYNeHRJm0a2wOK0aSQ4lUhNNTZlBzQqO8BR2REOyg5w-JKvWdbqLZ-m4Ws-jcP3fBqHL_oARzuePstK9L3RZ9kcrpedVo0PjsI-rZr8o0_ffvk_AAD__5BZB70=

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lkFv2jAYhu_7FdZ3aiWjYCfQEmkSXcs0JFY64NCpyiElXkGiJLOD1LTiv0-Eai0B_MXz6lspfuzXnx-J9wXU7wWEMO4NepcTspIL8nU0_E7uerc3g4v-NTm56o8n4x-DU3LyuqbYrngqnslwdNUbkS8_SXFKereXvZsJuRgMkJURUFimibiOH4WC8A4YUOBAwQcKAVBoQUQhk-lUKJXKzZKXEugnTxA2KcyX2Srf_DuiME2lgPAF8nm-EBDCJL5fiJGIEyG9JlBIRB7PF-UxT8VzN5Pzx1gWQGGcxUsVkoa3OXm4ykPS5RCtKaSr_HX7t13vCzKL1Wx3vy6DaB1RUHn8ICBka_pvMVtOY_KjMd_2WS1TmQgpkp2dog2JLTlw12-xmo1FPsw8VnmRSZGJ8J04QGEhfuUnXXb6Wc4fZuVff-_NKvd-u5NvcacDga_TRpp5rFW9_cGzg52zWf1nZzWe3eMNz_8QPw2Cth0H5UeDOjCUuTCU1x8-rzN8v-EFH2KJQdAzx0H50aAOLOEuLPHrD9-vM_ygUf7U_H9LDIKeOw7KjwZ1YInvwpKg_vCDOsNvNT7EEYOYHacx-dGYDgwJXPehA3FGQmXpUolabae5uZBIHsR2QCpdyam4kem0PGb7cVhy5S93IlS-_ZZvP_SX2682AevDbRu4YwMzq9yspaeZwci4Gdy2gTs2MLPKXRnZHs2rdPM97evn7WthtjuzZpUObATXw4jgehgRXA9jgiM0InjLRnA9jAiuhxHB9TAmOEIjgrdtBD-zUVQPI4rqYURRPYwpitCIouc2iuphRFE9jCiqhzFFERpRtGOjKLPqCQiNSIrQiKUIjWmK4VhXsCsLdm3Bri5Y9gW7wsCsGgPbqwxGtuppzFY9jdmqp1FbERyz1aQs7b-ZSVsypTFbjfqSMY7ZulcetLZG609_AgAA__-lH3W3

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mNFu4kYUhu_7FNa5SiQjmBkbiKVK2W6oGomGFLjYasWFF08TJBa7tpHCRnn3CtPWiR2f3xPb3AXw5_nnZL7DMc-U_L0ljxaT6eTz0trHW-vX-ex36-vky_300-2ddXFzu1gu_pheWhf_XnM4XfF0-GHN5jeTufXLn9bh0pp8-Ty5X4KrVmTTLgz0nf9dJ-R9JUE2SbJJkU0O2eTSyqYoDtc6ScL4eMlzBtwGT-QNbNrson16fHtl0zqMNXnPlG7SrSaPlv63rZ5rP9Bxf0A2BTr1N9tsmafDj-so3nz34wPZtIj8XeJZvf5x5dk-9axrSasXm8J9mt8-Sf0HTZ54sT8WwW0tgjSJcLNJ0s1unfZFoQbXorBAznw7WI9-8vjO9XkI9bEQbqshnMoQ-X32uzAOdKyDN3fK7lIZU6Ja5RHcriKgSuURhg0i2B9K-ZufPC50Oov6qlCp5SHS3n_yf5pOyaat_iu9uBaXP8ebh8fsr__PePWeRu2W9S7shVFfucXdv7v2-M3aor7ioobifdnrK-M-YxBi2GIIaRIil1x02Glqhxh22GlEe5qjWlV1mhYjoEpVdRqzCI07jThHp5H1RZN1RFO9vmNsu0GIUYshpEmIXDTZoe21Q4w6tF22pxqqVZXtLUZAlaqy3SxCY9vlOWxX9UVTdURzetmYb2a7QYhxiyGkSYhcNNWh7bVDjDu0XbWnGqpVle0tRkCVqrLdLEJj29U5bHfqi-bUEc3tGbtuEOGqtQjSJEIumdOh6bVDXHVoutOeZqhWVaa3GAFVqsp0swiNTXfO_XvBO3HmOonCXaJr_RowOG5IBw_6VKAk3MdrfR-H62yZ08tZxmVvBDpJT5_K04vb3emjY8DXsGBhxcOyCIvXsPMGFmawkI3oqya0HDahleJpxdJuE1g0WloOGtGjJrQCh8Vhjyn4f7kGsCzCQxYGmx7xdg15vcYsLQY8fcXTAvSFUlcxcRvQSG6EA7sBjvQGOPJblFqqieCARoYDHCmOcHDcAY4kF6XG-vbIIrzUYji8JLrgewzaOt9kxAjoxrcZMQZ4qdEY2crT0FaAI1t5HNrK49DWUpM1spWnoa08Dm0FODqyPA5t5b9gpABDFBhbBW-r5AdXsHXJdxrpgLmX7zTSBXip0xjNzTwNB2eAo8mZx-HozOPIVlnqsia2AhrZCnBkK8LRkeVxZKvkv2DkGOD8JFvAy7byoyzaOt9pFBhlFd9pFHhCVvxQA-oOaGQrwoGtAEe2Ahw-6fIPyuhRFzziN1scPuwCHD3tgt8I0Knhv2AUKh0_yhbwkq2Kn2WLW1-9_PRPAAAA___Flwb8

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1v2kgUhu_3V4zOVaI1MjNjvixVSrelKhIbsoC0XXW5cGE2QaKYHRsJGuW_V4aGBEzm9QFC7gr4mTl9Oc-ZIfeU_D-hkHrNdvNDX8ztRHzqdv4UX5tfbtrvW9fi4mOr1-_91b4UF7-eWayfWCx_iL8_N7tNsRD_zstlPRTqUjS_fGje9MX7dhs-b95lQKf7sdkVf_wjFgPyaBqPzHX03SQUfiVJHinySJNHAXlUoYFHMxsPTZLENnvkfgW0RgsKyx6Np7N5mr098GgYW0PhPaXjdGIopH70bWK6JhoZ65fJo5FJo_Fktc1i-eNqZsffI7skj3qzaJqEouRnO3fmaSiuJA0ePIrn6dPySRrdGgrlg1e8hE_jSWqssX5le__1-9k-mxzDMGxd9-s7-z4t9W0p7qLkbnudVZ1PtSlObc_jkafLRx-UjwQBZY1zioSCF6t7Wmc-je3IWDPaWmmQkeiRPf_Fz1Fy1zNpZ-arnZD7y5kJn9lDHk3Mf-nFlbx8Z8e3d6t_FUi8wkm8F9vUWF9VdmP6_cX1qwUy2xfHr0X3FHEdl-KZr8u7Ae_dvra1vWQ0dYGe9lXJ12zrQRGbrq6-gfWcgE6ZkD4oIQkieh3v5Xm9l-fwHiT-6H31UO9V8b5SRdpKl_yALR4oYtNWtTcQjxGQPGVC-qCEJIjodcRT5xVPnUM8kPijeLVDxdPF-0oXaaugtLqN8sQDRWzaqv4G4jECkqdMSB-UkAQRvY54-rzi6XOIBxJ_FK9-qHhB8b4KirRVpcTWDpSwaarGG2jHiEeeLh99UD4SBPQ60gXnlS44h3Qg8UfpGqf4ebln_a5JZvE0MYV-OZazwMzo1qy_gCSe26G5sfFwtc36ZWfFrd4YmSRdfyrXL1rT9UdZgc9huQvL53CwBUseLOVRdO0YWumj6IabVs7EtTtxzUhc8eCdxLl07Rh6J3Eu3XDTgTPxijvxihOuur_rqvu7BnrVnHTdDdePcdMNIzcBDdx008hNQAM3G-5pWAbjMDdMOXYCGumJcOAnwJGgCAeGytxI3Q5egeDdMxVIKnPTZXvzAGyeGy-sU9BNw2MQ4OgcdOPwIAQ4sE26Z6usguBz05Wlm5uGugEc6ebGoW4AR7q5TxYJjhaZG7Is3dxDVoEhqzhDNn_5Yg1ZNg50AzjSDeHo4ukesgoMWZUbshzdAI10QzjQDeBIN4QD3ZT7gFHggFHu-yvQTbmHrAJDVnGGbH5z1pBl40g31pBl40g395BVYMgqzgU-33KsGzwbR7qx7vBsHOnmPmA0OGC0-08iu7oNHn77GQAA___NrNLZ

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Ftv2kgbB_D791NYc5XoNTJzMAdLldJtqIrEhiwgbVddLijMJkgUs7aRoFG--wooOBz8_D2MnbuG-O_n0PFPxC8s_nfGAtZvdVqfBs4ymjmfe93fnW-tr4-dj-0H5-a-3R_0_-jcOje_rlntrlitfzp_fmn1Ws7K-XtZrcqxI26d1tdPrccBvFZ_2Fzc7d23es5vfzmrIXPZPJzoh9EPHbPgG-PMZYK5TDKXKeYynw1dtojCsY7jMNpc8rINtCcrFlRdNp0vlsnm46HLxmGkWfDCkmky0yxgg9H3me7p0URHXpW5bKKT0XS2LbNa_7xbRNMfo2jNXNZfjOZx4FS8TeXuMgmcO86Gry4Ll0l6-zgZPWkW8Fc3fwufp7NERzry_OP6u883dQ47DIKg_TBoZNYVJnXfjs6Lm11eNTsHw28OBZpemVS-n8bJdD5OPHEy-tloaeb72nkexc8Xrk-b8K9rwi-0iVpmE-l9lvMwmuhIT47utL1LZpsS7SptoV5WC2hTaQsNixbcq7r8Moqf-zrpLjx1sqnBeqGDvYAfOx3mspn-J7m547cfounT8_ZfOZ6upsnx6odRoiNPna3s_9lyVXMs7dI-ft31QhcPYSVceH71dMOX6x_TyQ0IyyGYJyqeNPYbNHEwrFaw3ybDFzm9vGp6DsY3FxxUTvHkJQqeu4laiYLz4vhEu8oSvMAW0KayBDdrwVpw_h6Cg-O1F_xsZbkFF_kREXkMkRVPGQsKmjgYUi9YUIPheZHTy6um52B8c0FB5RQvUaKguZuolyioKI4vtKssQQtsAW0qS1CzFqwFFe8hKDhee0HPVpZbUJkfEZnHEFXZ_qVvJiho4mBIo2BBDYbnRU4vr5qeg_HNBQWVU7xkiYLmbqJRoqCyOL7QrrIELbAFtKksQc1asBZUvoeg4HjtBT1bWW5BVX5EVB5D_Iqxn6CFgyDNgv00GJ0XN7u8anYOhjfXE1RO4VIl6pm7iWaJeqri6EK7ytKzwBbQprL0NGvBWk_1HnqC47XX82xlV72DvVCgp-NFOI91rter1c3G9ORJ7_4H4nAZjfVjFI63ZXY_dre57QcTHSe73_LdD-357lebBt-GORlWdFiQYUmHJRn26bA6DfO34dpRmJuFed0mLazS0iqtQNon01Zh3rBJC6u0tEorkK6RxxSE6wZhcRpukOEm_YA0aRSqdN-cNsVHqNCqcAHitCsc2MBpWThAjZ89ZMfxGojTxw3QBNLIJhBHOIE40gnEEU_87FEz8QmkEVAgjoQCcUQUiCOjOO0Mb4I4Lc1J_MwpTlsjquBLBPj-AqgStDUCWCNoawSwRtDWCPQFirZGAGuElTUgjawBcWQNiCNrQBxZI6ysAWlkDYgja0AcWQPiyBpBWyOANYK2RgBrBG2NBNZIO2skbY0E1kjw9xKwRtLWSGCNpK2RwBppZQ1II2tAHFkD4sgaEEfWSCtrQBpZA-LIGhBH1oA4skbS1khgjaStkcAaSVujgDXKzhoF3swAaxRtjULvV2hrFLBG0dYoYI2ysgak4fsdO2tAHL7hsbNGWVkD0sgaEEfWgDiyBsSRNYq2RgFrFG2NAtYo2hofWOMbWjN8_d9_AQAA__8QPmF0

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmO9v2jgcxt_fX2F9X7W6oGA7_Io0id3GNCSu9ADpdtrxIgNfi8RIzglSWdX_fQJWKAn1Ewca3g3Ix_Ye_Hls-kjx_3PyadjpdT6M2FLP2adB_0_2tfPltve-e8OuPnaHo-FfvWt29euZ1faJh9UP9vfnzqDDHti_y2pVqneMX7POlw-d2xF73-tBYMLkNesPPnYG7I9_2GpMDi3CqboJvquY_K_EySFBDklyyCOHajR2KNLhRMVxqNePPG6A7vSB_KpDs0W0TNZvjx2ahFqR_0jJLJkr8mkUfJurgQqmSrtVcmiqkmA230zzsPrRjvTse6BX5NAwChaxzyrueub-MvFZmzttQeMnh8Jlsp8hToI7RT5_cvKv4tNsniittFs7XML2_fVU-yh93-_ejJq7VaSXsB_124rdB_H94ZBtTuOn_TKFzTJfhsXPmpYslBYHcU2YPG9a3qvL3I-zXIR6qrSaHow0XpPokSP_189BfD9UST9yRSrw0SpS_gutyKG5-i-5avPrd3p2d7_51z79V6Ov2UQ_DHWitCtq6Zh-f3X8eo7MjsXxa9Aji7gJK2Hkymo64KPTNw6m5xYbPMf-dkXFlUX6AKxjt8Prl-0Dm7jOnJcslBcHgb1xI_ByG4GX0Qgg-udGqBdtBJF_j4k8W0xWXK-IkmAduy3WuKySFnHxM-clC-XFQWBvrKQoV0lRhpIg-mclG0WVlPn3mMyzxbzK5mJrrSRYx26LNS-rpEVc_Mx5yUJ5cRDYGyspy1VSlqEkiP5ZyWZRJb38e8zLs8VqlSJCglXsNljrskJahMXPmpYslBYHcb2xjl65Onpl6Aiif9axdY6fsUfGH6g4ChexyvULtboOTE3v1PYLiMOlnqhbHU4202xf9jfc5o2pipPtp3z7orvYfrRe4EuYp2H-EvYOYG4Hc34S3TiFFvIkumWmhTFxaU5cWiQu7OBU4rZ04xQ6lbgt3TLTnjHxmjnxmhGum7_ruvm7Bno1jHTTDDdPcdMMIzcBDdw008hNQAM3W-Y2rII6zJSpjZ2ARnoiHPgJcCQowoGhPFOph8ELELy5U4GkPNMuh5N7YPJMvVidgmYaHoMAR-egGYcHIcCBbdzcrbwOgs-0q5VuZhrqBnCkmxmHugEc6WY-WTg4WnimZK10M5esACUrbEo2e_myKllrHOgGcKQbwtHF01yyApSsyJSsjW6ARrohHOgGcKQbwoFuwnzACHDACPP9FegmzCUrQMkKm5LNTm5VstY40s2qZK1xpJu5ZAUoWWFzgc9uOasbvDWOdLO6w1vjSDfzASPBASPNfxJJ6zZ--u1nAAAA__-_EfGQ

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F1v2kgfBfD751NYc5XoMTLzYl4sVaLbUBWJDVlA2q66XLgwmyBRzNpGCo3y3VdAweHF_2N77Nw1xIc5PTU_Ub-w6N8F89io2-9-GlvrcGF9Hg5-t751vz70P_burZu73mg8-qN_a938umazv-J589P680t32LWerb_X9brUHyx-a3W_fuo-jOHFU0veWoPhXXdo_faXtZkwmy2Dmb73f-iIed8YZzYTzGaS2Uwxm7lsYrNVGEx1FAXh9pKXXaA3e2Ze3Wbz5Wodb1-e2GwahJp5LyyexwvNPDb2vy_0UPszHTp1ZrOZjv35YnfM8-ZnZxXOf_jhhtlstPKXkWfVnO3Jg3XsWR1udwSbvNosWMfJCVHsP2rm8Vc7e4vP80WsQx067mmF_evbo5IZPc_r3Y9bxxbpFUSeCm-H4KUuIQstwcEUU0tmX0LlqXA3j-L5cho74myGDj87IMl831hPfvR05fqkhFushFtqiUZqieR91ssgnOlQz07eafcuqTUl2iqp0KyqAloqqdAyqGAXavnFj55GOh6sHHW21Hiz0t6Bxo_9PrPZQv8T33T47Ydw_vi0-1PySUv9O7Xz3F6jIIx16KiLyf6fDlo9w2jX9vj1rlda3Ae1YOW49fOFr59_KirPwVkGzRxRc2QR2UGPo2eN6mTPM0XJW8hCW3AwhoHtoELCKq_Q9swlGhXazsuDFW2VZnuJFdBSabbnq2BsO38P28HtdbD9YrLMtovsoIgsnsiao4rYCnocPWlWZ2uOKXjJW8hCW3AwhoGtoELCmqjQ1swlmhXaKsqDDW2VZmuJFdBSabbmq2Bsq3gPW8HtdbD1YrLMtsrsoMgsnqja7qFBbltBj6MnrepszTEFL3kLWWgLDsYwsBVUSFiTFdqauUSrQltlebChrdJsLbECWirN1nwVjG2V72EruL0Otl5MltlWlR0UlcUTt1ZEVtDiqEm7OllzDMFLXUIWWoKDKQxcBRUS0lSFrmYu0a7QVVUeamirNFdLrICWSnM1XwVjV9V7uApur4OrF5MVetZ75YChjlbBMtKZHuPWt4vp2aPe_wtEwTqc6ocwmO6O2f842OV2L8x0FO9_y_c_9Jb7X20Lvg1zMqzosCDDkg5LMuzSYXUe5m_DjZMwzxfmTZO0MEpLo7QCaZdMG4V5yyQtjNLSKK1AukHepiDczBEW5-EWGW7TH5A2jUKd7s1pU1yECq0KFyBOu8KBDZyWhQPU-MWH7DTeAHH6dgM0gTSyCcQRTiCOdAJxxBO_-Kjl8QmkEVAgjoQCcUQUiCOjOO0Mb4M4Lc1Z_MIpTlsj6uBLBPj-AqgStDUCWCNoawSwRtDWCPQFirZGAGuEkTUgjawBcWQNiCNrQBxZI4ysAWlkDYgja0AcWQPiyBpBWyOANYK2RgBrBG2NBNZIM2skbY0E1kjw_yVgjaStkcAaSVsjgTXSyBqQRtaAOLIGxJE1II6skUbWgDSyBsSRNSCOrAFxZI2krZHAGklbI4E1krZGAWuUmTUKPJkB1ijaGoWer9DWKGCNoq1RwBplZA1Iw-c7ZtaAOHzCY2aNMrIGpJE1II6sAXFkDYgjaxRtjQLWKNoaBaxRtDUusMbNac3k9X__BQAA__9Q0IAr

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6xz1UpGwU6gJdIkqo5pSKx0hYtKVS5S4hUkSjI7kUir_vcpSbuWj_nEM2SXIXns1z6PxPsM6tcSfJgMRoPLKcnkkny9GX8nd4Pb69HF8IqcfBlOppMfo1Py-smakrz6Zp0_kcHt5eB6Si5Go7f3OSXrP-8DoLCKI3EVPgoF_h0woMCBggsUPKDQgYBCIuOZUCqWxSfPJTCM1uC3KSxWSZYWPwcUZrEU4D9DukiXAnyYhvdLcSPCSEinDRQikYaLZbnNOn_qJ3LxGMocKEyScKV80nKKncdZ6pM-o30OwQuFOEtfd3hf-D4n81DNN5d8QwIKKg0fBPjshf5b2I5hWE77zDYs_2vY96WyVSwjIUW0sVhQkNgne078LVTziUjHicO2pjPNE-F_UAcoLMXP9KRMffpZLh7mbw-6gb0fzrU43J7kV3ErThzW2b6GvXt7G3uz-hawGhY4vOW4R5TWIG7XOO7htWXNassa1ZbXnwWvMwu35XhHVMcg7plx3MOrw5tVhzeqjlt_Fm6dWXit8j_qWOoYxD03jnt4ddxm1XEbVcerPwuvziw6rSOKYxC2Zxj28Np4zWrj_beOtSfXjVBJvFKiVoNqFycT0YOobkrFmZyJaxnPym2qx3HJlQ0gEiqt3vLqYbiqXhUB68NdG7hnAzOr3Kyjp5nBlXEzuGsD92xgZpV768p2aL5Ntz_Srv6-XS3MNu-svU17NoLrYURwPYwIrocxwREaEbxjI7geRgTXw4jgehgTHKERwbs2gp_ZKKqHEUX1MKKoHsYURWhE0XMbRfUwoqgeRhTVw5iiCI0o2rNRlFn1BIRGJEVoxFKExjTFcKwr2JUFu7ZgVxcs-4JdYWBWjYHtVAYjW_U0ZquexmzV06itCI7ZalKWdmdm0pZMacxWo75kjGO27pQHra3By6ffAQAA__-bNoZN

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7tCsNgpmxgViqlNUuVSPRJA08rLTiwQvTBInF1DYSbJT_XgFNndjxPTPYTh-J-fCZG5-PGR4p_XtFIU1G49HnqbdNVt5vdzd_eN9GX2_Hn66uvQ9fribTyZ_jj96_b9kJb396z27_0xt9_Ty6nT5f2wtv99-1GQlaxwtzHf0wKYXfSJIgRYI0CfJJUEAzQZsknps0jZPDWx6PwNViR2FP0HK92WaHP88EzePEUPhI2TJbGQppGn1fmTsTLUzS7ZGghcmi5ep4m93-5-UmWf6Ikj0JmmyidRp6ne7hzjfbLPQupbhUNHsSFG-z_A5pFt0bCuWTOC9F4JhCiUtZmUK5pPiyTLPlep51ZWESb600x77vvYcofXgbyaPo86IELUTxK6PkH7Vdx8nCJGbx6sOOn1IZVlnMLU8RtJXCYmR5in6NFOKsoL9H6cPEZDebri7Ma7rfmPBZBZ_GYxK0Mn9lH44r-Phrsrx_eH5hV8JBsyO-jjvxpquD4hjevPfw1b2lvQCkhQC6qtPV54jIIUffOYeDikCOvP-ydRVZR-m3riLZnAQs5lalogZTWIysSkVuKWqrSL6ripR9DZVNDXWn65-jA4ccA-ccDjoAOfIOqtZ1YB1l0LoOVHNFtJhblQ4aTGExsioduKWorQP1rjrQ9jXUNjX0O8djhLMOHHIMnXM46ADkyDuoW9eBdZRh6zrQzRXRYm5VOmgwhcXIqnTglqK2DvS76sC3r6FvU8Ogc44MHFJcOKZwUAFIkffPb10F1lEuWleB31wJLeZWpYIGU1iMrEoFbilqq8D_336zeCPXnUk38To1Vr9I9A4rM4t7c5pUGm-TublN4vnxNqeXN0fu-IeFSbPTVXV6cbU-XToEfAlLFtY8rIqwfAn7r2DpBktVi76oQ6t-HVprntYsHdSBZa1bq14telCH1uBh8dnHFPy_AgdYFeE-C4NFD_h29fl6DVla9nj6gqcl8ELJKi7dBjQqN8JBuwGO6g1w1G9ZUqpLwQGNGg5wVHGEg8cd4KjksiTW148swkuK4fBS0SXvGLR0XjJyAOrGa0YOAV4SjVNbeRq2FeCorTwO28rjsK0lyTq1ladhW3kcthXg6JHlcdhW_gtGSbCJAttWybdV8RtXsHTFm0b5YN_Lm0YFAC-ZxmnfzNNw4wxwtHPmcbh15nHUVlWyrEtbAY3aCnDUVoSjR5bHUVsV_wWjhgDnd7IFvNxWfiuLls6bRoOtrOZNo8EJWfObGjB3QKO2Ihy0FeCorQCHJ13-oIyOuuCIX-_m8LALcHTaBb8RoKeG_4LRaHT8VraAl9qq-b1scemzp1_-CQAA__-vLCPq

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v4jgQwN_vU1jzVHRGwU7Cn0gntddyOiS2dAkPXVV5SIm3IFGSdYJEWvW7rwhlaQj1xITmDYp_48nMbzp5hfjXAhxw-8P-9YSs5IL8Nx59Iw_9-7vh1eCWXNwM3In7fdggF-9n1tsT6_SFjMY3_TH59wdJG6R_f92_m5Cr4fDPyZRcuUePvzT2n9ceUFiGgbj1n0UMzgMwoMCBggkULKBgg0chkuFUxHEoN0deM2AQrMFpUZgvo1Wy-bNHYRpKAc4rJPNkIcCBif-4EGPhB0IaLaAQiMSfL7Jr1unLZSTnz75MgYIb-cvYIU1jc_NolTjkkoH3RiFcJe_h91EfUzLz41k-XnbeoxAn_pMAh73R09K0NdPkldLkn6a5j7NahjIQUgS5SN6GxI4cedb__XjmimQUGeygI5M0Es4HkYDCQvxMLi5Z4x85f5plnz5tz_6ZTJ3Su6FMhDSYfVimvz-Nb5Wo2bFyvAc9ksRt2Awjg7cOC3z0ejt3PStvFithlsGbhvklI6CRaFs70XMOAat3CFgdQ4AUfzcE7VOHgJdvLi_TXLNpWF9ioUaiHe1Ez2khr9dCXoeFSPF3FnZOtdAs31yzTHOtZraNz2-hRqJd7UTPaaFZr4VmHRYixd9Z2D3VQqt8c60yzbWbX-KgRpo9zTTPaaBVr4FWHQYipd8Z2DvHK-mR-GMRR-EyFqXeNlubgongSWwbEIcrORV3Mpxm12y_jjIue8sIRJxsf-XbL4Pl9qdNguXhThWYsUq0XYnuqWmmUTOuB3eqwAc106XtSnRPTfNDuvWRNnNw6xA2lbCl7palhDlTX21XmQ81jMyHGsbmA6GR-UBoZD7aVeZDDSPzoYax-UBoZD4QGpmPjtLSrlrSbpX56FUxXA0jhqthzHCERgxHaGwD6KzN4n9Snb2pS6NLQGtzauOI5qywRXKqMq4WnanXCGI6K-wRHdURGnEdoTHZMRyxHcMx3Qs7VEt3NY3prqZR3REc0x3BMd0LizSvexvRvbBTtHQv7BQt3dU0pruaRnVHcEx3BMd0L-xTLd3VNKa7mkZ1R3BMdwTHdC9s1fy7dkutOy_sFqXu3ttfvwMAAP__eLR-jA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMzPmy1KlpBuqRqIhBS62WnHhhWmCxGJqGwkS5b9XwLLeePB7ZmKbu3z48Ry_zHk05pUl_y1ZwMb9Qf_TxNnES-eP0fAv50v_8-Pg9v7Bubq7H0_Gfw-unavv12yPV2x3L85wdNcfOb__4-yunf7nT_3HyY-rds7t-OylL9fZz9spc9kqmquH8JtKWPCFceYywVwmmct85rIWm7psHUczlSRRvL_k9QDcz7csaLpssVpv0v2fpy6bRbFiwStLF-lSsYBNwq9LNVLhXMVek7lsrtJwsTwss9293Kzjxbcw3jGXjdfhKgmchrdfebhJA-eGs-mby6JNmt0-ScMnxQL-5n4sQssygiiMIGwi3C2SdLGapR7PzUB7xoz5unOew-T5zPVZCPmxEK1KQ_iFIbL7bFZRPFexmr-70-EuhTEFmlUWoVVXBDSpLEK7RAT3Qyn_DJPnsUqHa0_mJjXZrVVwksHtYMBctlT_plc3_Pq3ePH0fPjJoGYdm-01juJUxZ7URvZr4f27BjM7N47vNz0T4iFqRGvPb-YHfHb53rvlublFuIFFPNHwpLXKLEK0rUOYygyEyDzCa5SZcYh2jTLj1ZkEzapIZhVGQJMqkpldhNIy45eQGdheJ5lpIzOVmTAvsjApsmx4vrVNLEJ0rEOY2gSEyIosarSJcYhOjTYR1VUZzarIJhVGQJMqsoldhNI2EZewCdheJ5toIzO1iTQvsjQpst84vAnZ2cQiRNc6hKlNQIisyLJGmxiH6NZoE1ldldGsimxSYQQ0qSKb2EUobRN5CZuA7XWyiTYyU5v45kX2TYrcali7xCJCzzKCqUlAhKzEfo0mMQ7Rq9EkfnU1RrMqMkmFEdCkikxiF6G0SfxLmARsr5NJtJF95CubM_cfqWQdrRJl9G1Mcz8wNX9Sxw8giTbxTD3G0eywzPHX4YE7_GGukvT4X3H85X51_Nc-4M8wJ2FJwyIP859h_x3M7WAuy9CCl6J7ZWjZoWlJ0q0yMAcjp2khytCyWYru0rRPbtM2DbcsYJGH2yTcoQvSIWHwzF0S9jm9dI-kOaA5LRWOrKJpxcYMgEZqADhyA8KBHACO7MBpuQA9ABr5AeBIEABHhkA4qAvXDPN-y6LR0YrJ4ZomOC0Z3gaFoTWDHp32DO-BxWnTiCbANdVYlZ2mYdlpHJYd4KjsNI7KLjTL2pQd0KjsAEdlBzgqO8LBjhf0uVWg06OmGgrXyi5o1QgfHJtp1aBHp00jwJFE0KYRXYBrqrE689M0PPTTODz1Axwd-2kcll2zrFXZaRqWncZh2Wkclh3gaMfTZ1kJPnZJn2VzuFZ2CV6RwVFY0qoBjy5p08gWWJw2jQSnEqmpxqbsgEZlBzgqO8JB2QEOX_I1y1q95dM0fM2ncfieT-PwRR_gaMfTZ1mJPjf6LJvD9bLTqvHBUdinVZN_9OnbL_8HAAD__yqGDZw=

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk9v4joQwO_vU1hzKnpGiZ2EP5Ge1L6W1SKxpQscuqpySIm3IFGSdYIErfrdV4QiGkI8MWlzaxr_7MnMbxi_QvxnAS6Me4Pe9YSs5IJ8Gw1_kIfe_d3gqn9LLm7648n456BBLt7XrHcr1psXMhzd9Ebk_19k0yC9--ve3YRcDQbqlZS8NA6Paw8oLMNA3PrPIgb3ARhQ4EDBAgo2UHDAoxDJcCriOJTbJa8p0A_W4JoU5stolWz_7VGYhlKA-wrJPFkIcGHiPy7ESPiBkIYJFAKR-PNFesx683IZyfmzLzdAYRz5y9glTWN78nCVuOSSgfdGIVwl79sfdn3ckJkfz7L7pes9CnHiPwlw2Rs9L0yn1jB5YZiHfVbLUAZCiiCzk7clsSUnvvW7H8_GIhlGBjuqyGQTCfeDRkBhIX4nF5es8Z-cP83Svwq_-_BNlk7qx6FMhDSYc5ymfwv3t0vk7FQ63jc9EcRt2Awjg5vHCT55vJM5npU3i5Uwy-BNw_qSFtAItFVzoLww0BqagNXRBEjy903QOrcJePni8jLFtZqG_SUWagTarjlQXhhoDRbyOixEkr-3sH2uhVb54lplims302n8-RZqBNqpOVBeGGgNFlp1WIgkf29h51wL7fLFtcsU12l-iYMaYXZrDZMXhlmDgXYdBiKp3xvY_Ywr6Yn9RyKOwmUsSt02zW3CRPAkdgWIw5WcijsZTtNjdo_DlEtvGYGIk91bvnvoL3evtgGWh9tVYMYq0U4luqummUbOuB7crgIf5UyXdirRXTXNj2nzI21lYPMYtpSwra6WrYQ5Ux_tVOkPNYz0hxrG-gOhkf5AaKQ_WlX6Qw0j_aGGsf5AaKQ_EBrpj7bS0o5a0k6V_uhWMVwNI4arYcxwhEYMR2hsAuiMzfwvqc7c1KXRIaA1ObVxRHOWmyIZVRlXi87UYwQxneXmiI7qCI24jtCY7BiO2I7hmO65Gaqlu5rGdFfTqO4IjumO4JjuuUGa1b2F6J6bKVq652aKlu5qGtNdTaO6IzimO4JjuufmqZbuahrTXU2juiM4pjuCY7rnpmr2rm2qdee52aLU3Xv7528AAAD__6Wvff8=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMzPmy1KlbDdUjURDClxsteLCC9MEicXUNhIkyn-vMIu88eD3zMR27kLix3P8MufROC8s-W_NAjYdjoafZ84uXjt_TMZ_OV-HXx5Gn-7unavbu-ls-vfo2rn6cc3-dMX-8OyMJ7fDifP7P87h2hl--Tx8mNFXuc7zdf5xP2cu20RLdR9-VwkLvjLOXCaYyyRzmc9c1mFzl23jaKGSJIqPl7xkwN1yz4K2y1ab7S49_nruskUUKxa8sHSVrhUL2Cz8tlYTFS5V7LWZy5YqDVfrbJn94flmG6--h_GBuWy6DTdJ4LS848rjXRo4N5zNX10W7dL89kkaPioW8Ff3fRE6tUUQNhFuV0m62ixSjxdmoC2QM98OzlOYPF24Pg8h3xeiU2sIvzREfp_dJoqXKlbLN3fK7lIaU6BZ5RE6TUVAk8ojdCtEcN-V8s8weZqqdLz1ZGFSs8NWBWcVfBqNmMvW6t_06oZf_xavHp-ynwz2eM9me02jOFWxJ7WR_Vp6_77BzC6N48dNL4S4j1rR1vPbxQFfXH7wZnlubhFuYBFPtDxprTKLEN0aQwibELlHeIMyMw7RbVBmvD6ToFmVyazGCGhSZTKzi1BZZvwjZAa211lm2shMZSbMiyxMiixbnm9tE4sQvRpDCJsQeZFFgzYxDtFr0CaiviqjWZXZpMYIaFJlNrGLUNkm4iNsArbX2SbayExtIs2LLE2K7LeyNyE7m1iE6NcYQtiEyIssG7SJcYh-gzaR9VUZzarMJjVGQJMqs4ldhMo2kR9hE7C9zjbRRmZqE9-8yL5JkTsta5dYRBjUFkHYRMhL7DdoEuMQgwZN4tdXYzSrMpPUGAFNqswkdhEqm8T_CJOA7XU2iTay9_zL5sL9JyrZRptEGf03pn0cmFo-qtMXkES7eKEe4miRLXP6OM647BdLlaSnv4rTh7vN6U_HgD_DnIQlDYsizH-G_Tcwt4O5rEILXokeVKFlj6YlSXeqwByMnKaFqELLdiW6T9M-uU27NNyxgEUR7pJwjy5Ij4TBM_dJ2Of00gOS5oDmtFQ4soqmFRszABqpAeDIDQgHcgA4sgOn5QL0AGjkB4AjQQAcGQLhoC5cM8zbLYtGRyumgGua4LRkeBcUhtYMenTaM3wAFqdNI9oA11RjVXaahmWncVh2gKOy0zgqu9Asa1N2QKOyAxyVHeCo7AgHO17Q51aBTo-aaihcK7ugVSN8cGymVYMenTaNAEcSQZtG9AGuqcbqzE_T8NBP4_DUD3B07KdxWHbNslZlp2lYdhqHZadxWHaAox1Pn2Ul-NolfZYt4FrZJXhFBkdhSasGPLqkTSM7YHHaNBKcSqSmGpuyAxqVHeCo7AgHZQc4fMnXLGv1lk_T8DWfxuF7Po3DF32Aox1Pn2Ul-t7os2wB18tOq8YHR2GfVk3x0eevv_wfAAD__8HcDQ8=

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lkFv2jAYhu_7FdZ3aiWjYCfQEmkSXcs0JFY64NCpyiElXkGiJLODVFrx3yeSai0B_MXz6lspfuzXnx-J9wXU7wWEMO4NepcTspIL8nU0_E7uerc3g4v-NTm56o8n4x-DU3LyumZdrnhaP5Ph6Ko3Il9-kudT0ru97N1MyMVggKyMgMIyTcR1_CgUhHfAgAIHCj5QCIBCCyIKmUynQqlUbpe8FEA_eYKwSWG-zFb59t8RhWkqBYQvkM_zhYAQJvH9QoxEnAjpNYFCIvJ4viiOeVo_dzM5f4zlGiiMs3ipQtLwticPV3lIuhyiDYV0lb9u_7br_ZrMYjXb3a_LINpEFFQePwgI2Yb-W8yW05j8aMy3fVbLVCZCimRnp2hLYksO3PVbrGZjkQ8zj1VeZLLORPhOHKCwEL_yky47_SznD7Pir7_3ZpV7v93Jt7jTgcDXaSPNPNaq3v7g2cHO2az-s7Maz-7xhud_iJ8GQduOg_KjQR0YylwYyusPn9cZvt_wgg-xxCDomeOg_GhQB5ZwF5b49Yfv1xl-0Ch-av6_JQZBzx0H5UeDOrDEd2FJUH_4QZ3htxof4ohBzI7TmPxoTAeGBK770IE4I6GydKlErbbT3F5IJA-iHJBKV3IqbmQ6LY4pPw4LrvjlToTKy295-aG_LL_aBqwPt23gjg3MrHKzlp5mBiPjZnDbBu7YwMwqd2VkezSv0s33tK-ft6-F2e7MmlU6sBFcDyOC62FEcD2MCY7QiOAtG8H1MCK4HkYE18OY4AiNCN62EfzMRlE9jCiqhxFF9TCmKEIjip7bKKqHEUX1MKKoHsYURWhE0Y6NosyqJyA0IilCI5YiNKYphmNdwa4s2LUFu7pg2RfsCgOzagxsrzIY2aqnMVv1NGarnkZtRXDMVpOytP9mJm3JlMZsNepLxjhm61550NoabT79CQAA___X6XW5

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mNFu4kYUhu_7FNa5SiQjmBkbiKVK2W6oGomGFLjYasWFF08TJBa7tpFCorx7hWnrjR2f3xPb3AXw5_nnZL7DMS-U_L0ljxaT6eTz0trHW-vX-ex36-vky_300-2ddXFzu1gu_pheWhf_XnM4XfF0eLZm85vJ3PrlT-v50pp8-Ty5X4KrVmTTLgz0nf9dJ-R9JUE2SbJJkU0O2eTSyqYoDtc6ScL4eMlLBtwGT-QNbNrson16fHtl0zqMNXkvlG7SrSaPlv63rZ5rP9Bxf0A2BTr1N9tsmafD83UUb7778YFsWkT-LvGsXv-48myfeta1pNWrTeE-zW-fpP6DJk-82h-L4LYWQZpEuNkk6Wa3TvuiUINrUVggZ74drEc_eXzn-jyE-lgIt9UQTmWI_D77XRgHOtbBmztld6mMKVGt8ghuVxFQpfIIwwYR7A-l_M1PHhc6nUV9VajU8hBp7z_5P02nZNNW_5VeXIvLn-PNw2P21_9nvHpPo3bLehf2wqiv3OLu3117_GZtUV9xUUPxvuz1lXGfMQgxbDGENAmRSy467DS1Qww77DSiPc1Rrao6TYsRUKWqOo1ZhMadRpyj08j6osk6oqle3zG23SDEqMUQ0iRELprs0PbaIUYd2i7bUw3Vqsr2FiOgSlXZbhahse3yHLar-qKpOqI5vWzMN7PdIMS4xRDSJEQumurQ9tohxh3artpTDdWqyvYWI6BKVdluFqGx7eoctjv1RXPqiOb2jF03iHDVWgRpEiGXzOnQ9Nohrjo03WlPM1SrKtNbjIAqVWW6WYTGpjvn_r3gnThznUThLtG1fg0YHDekgwd9KlAS7uO1vo_DdbbM6eUs47I3Ap2kp0_l6cXt7vTRMeCPsGBhxcOyCIsfYecNLMxgIRvRV01oOWxCK8XTiqXdJrBotLQcNKJHTWgFDovDHlPw_3INYFmEhywMNj3i7Rryeo1ZWgx4-oqnBegLpa5i4jagkdwIB3YDHOkNcOS3KLVUE8EBjQwHOFIc4eC4AxxJLkqN9e2RRXipxXB4SXTB9xi0db7JiBHQjW8zYgzwUqMxspWnoa0AR7byOLSVx6GtpSZrZCtPQ1t5HNoKcHRkeRzayn_BSAGGKDC2Ct5WyQ-uYOuS7zTSAXMv32mkC_BSpzGam3kaDs4AR5Mzj8PRmceRrbLUZU1sBTSyFeDIVoSjI8vjyFbJf8HIMcD5SbaAl23lR1m0db7TKDDKKr7TKPCErPihBtQd0MhWhANbAY5sBTh80uUflNGjLnjEb7Y4fNgFOHraBb8RoFPDf8EoVDp-lC3gJVsVP8sWt756_emfAAAA__8UVAb-

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllFr4kwUhu-_XzGcK4WROJNoa-CDlq7LCm7tVi8KJRepma2CNdmZCNrS_76YtFijzsnsYHI5Os_MO-c8kPMG6s8CfBj3h_2bCVnJBfl-P_pJHvsPd8PrwS1pfBuMJ-Nfwyb52LLONzQan2tKNvlP681rk_Qfbvp3E3I9HJLjO5oBUFjGkbgNX4QC_xEYUOBAwQUKHlDoQEAhkfFUKBXL7Za3DBhEa_DbFObLZJVufw4oTGMpwH-DdJ4uBPgwCZ8W4l6EkZBOGyhEIg3ni-ya9eb1KpHzl1BugMI4CZfKJy1ne_NolfrkitErDsE7hXiVftywO_hpQ2ahmu0f-YkEFFQaPgvw2Tv9t7CdGsLyk2F3R62WsYyEFNHeYcGWxLYcefGPUM3GIh0lDit0Z7JJhP_FHqCwEL_TRpa6-b-cP88-F7saFAqwe5lr8bIjsW_jVpw4rFOswdG7vb27WXkFWAkFHN5y3DMaaxC3W0tcfjJuBc6y6pzl5RvByzTCbTneGb0xiHtRS1x-Mm4F3vDqvHHLN8It0wivlX2azuWNQdzLWuLyk3Er8MatzhuvfCO8Mo3otM5ojUHYXg1h-cmwFTjj1TNXHQl1L1QSL5UoNTW1t88S0bPIy6TilZyKOxlPs2vy5Sjjsq9-JFSa_8vzxWCZ_7UNWB7u2sA9G5hZ5WYdPc0MSsbN4K4N3LOBmVXuQskOaF6k219pV19vVwuz_Zq1i7RnI7geRgTXw4jgehgTHKERwTs2guthRHA9jAiuhzHBERoRvGsj-IWNonoYUVQPI4rqYUxRhEYUvbRRVA8jiuphRFE9jCmK0IiiPRtFmdWcgNCIpAiNWIrQmKYYjs0KdsOC3bRgNy5Yzgt2AwOzmhjYwchgZKuexmzV05itehq1FcExW02GpcOemUxLpjRmq9G8ZIxjth4MD1pbg_f__gYAAP__B2KH9g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4jgUhd_3V0T3qZWMwHYCNNJKHc2w2kps2y08jDTiIQPeFokhbBKkMlX_-wrYKoWQe2ySdB5N8sXHF5-T67xQ-u-CQhoNhoPPY2-dLLw_Hu7-8r4Nvt4PP93cehdfbkbj0d_DS-__W573N1xcvI2Ft9n_9Lz5eekNvn4e3I-901cvJyRoGc_MbfTDpBR-I0mCFAnSJMgnQQFNBK2SeGrSNE62t7zsgJvZM4UdQfPlap1tf54ImsaJofCFsnm2MBTSOPq-MA8mmpmk3SFBM5NF88VumufNz-tVMv8RJRsSNFpFyzT0Wu3tzHfrLPSupbhWNHkVFK-zfIY0ix4NhfJVnKciqFOFclHxZZ5m8-U0a8ujSpyaI8e-b7ynKH06jeRS9HlSggak-KVS8ketl3EyM4mZHTxs95RSscqibrmKoCkVFiXLVXQrqBBnCf0zSp9GJrtbtfVRvcablQnf0uDTcEiCFuaf7GK3gsvfk_nj09sg3_6lK-vVW9_buBWv2jo4rsHJufsHc0t790sL97dVq63PSSEHHd16dSgXHbn5ZeM5ZC2l23gOyfoSwKJuZTlUowqLkpXlkJuKyjkkPy6HlL0HlY0Hdavtn5MFDjp69epQLjpyA6rGs8BaSq_xLFD1udCibmVZUKMKi5KVZYGbispZoD4uC7S9B7WNB_3W7vTgnAUOOvr16lAuOnID6sazwFpKv_Es0PW50KJuZVlQowqLkpVlgZuKylmgPy4LfHsP-jYeDFrnJIGDiqs6VSgXFbn5_MZzwFrKVeM54NfnQIu6leVAjSosSlaWA24qKueA_2u-U5wQ9WDSVbxMjdVXiM52WWb2aPZlSuN1MjX3STzdTbMf3u243Q8zk2b7q2o_uFnuL20FvoclC2seVsewfA_7B7B0g6WqRF9VoVW3Cq01T2uWDqrAstLUqlOJ7lWhNdgsPrtNwf8VOMDqGO6yMFh0j3dXl7dXn6Vlh6eveFqCXCikiou3AY3MjXDgboAjewMc-VsWItXF4IBGDgc4sjjCwXYHODK5LATr4ZZFeCFiOLxgdMlnDFo6HzKyB-zGx4zsA7wQNE5u5WnoVoAjt_I4dCuPQ7cWQtbJrTwN3crj0K0AR1uWx6Fb-ReMkqCJAm2r5N2q-MYVLF3xSaN80PfySaMCgBeSxqlv5mnYOAMcdc48DltnHkduVYWUdXEroJFbAY7cinC0ZXkcuVXxLxjVBzjfyR7hRbfyrSxaOp80GrSymk8aDU7Imm9qQN0BjdyKcOBWgCO3AhyedPmDMjrqgiN-tcnhYRfg6LQLvhGgXcO_YDQqHd_KHuEFt2q-lz1e-uT1t_8CAAD__w66JZM=
