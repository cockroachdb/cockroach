# LogicTest: 5node

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysVk2L2kAYvvdXDO-ppROSmcSvnHbbtSBY3aqFliWH1AyL4GbSSQK64n8vxpWtkrwz-TgmmWeeT8QDpH-34MNyPB1_XZFcbcm3xfw7eRr_epzeT2bk48NkuVr-mH4ib0d25wO7_Sv5OZvMZ-R-Oi35Nl88jBfky2-yC4BCLCMxC19ECv4TMKDAgYILFDyg0IOAQqLkWqSpVKcjhwIwiXbgOxQ2cZJnp9cBhbVUAvwDZJtsK8CHVfhnKxYijISyHaAQiSzcbAuaRG1eQrW_2-1fgcIyCePUJ5Z9Yp7nmU_uGARHCjLP3q9Ps_BZgM-OtJmEXmcSeKWEd-Y8lioSSkRXrMGxRORMWjKxmXNzspzbqWN_KVUmlM1urN-xz5XeXANvZc7eLq20x83seVf0zLxdZtCuzS3brT2xGiL6HYrglSLajIw1GJkmgMvI-k1Hxs0D5iYBu5bt1W65hohBhyJ4pYg2LfMGLWsCuLQ8aNqyax6waxKwZxW_6PVariFi2KEIXimiTctug5Y1AVxaHjZt2TMP2DMJuGfV7riGhFFnEnilhDYNew0a1ti_NDzq4i9Byf0LkSYyToWh8oCCiJ7FOahU5motHpVcFzTnx3mBK15EIs3OX_n5YRIXn4r-_wezNmCOgt0rsHMLdlGwhzN7uGyGU_dQ9ACn7rcBD1DwEJc9bJPYCAUzppkJPjItHJ8Z47hxhg9N45zhS2M9DRzfmhaOj431Ndbxuems43tjIw0cX5wWjm-OO7h1jm_u1npw_PAvAAD__xq8NpI=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysll-L2kAUxd_7KcJ9aulIvDOJrnnatloQrG7VQsuSh9QMS8BN7GQCuuJ3LyaLuxGdP4mPSebcc3-eg8we8n9rCGAxmoy-LZ1CrJ3v89kP53H0-2HyZTx1Pg7Hi-Xi5-ST83pkWx3Y7l6cX9PxbHrh_Ww-HM2dr3-cbQgE0izm0-iZ5xA8AgIBCgQYEPCAgA8hgY3IVjzPM3E8si8F43gLQZdAkm4KeXwdElhlgkOwB5nINYcAltHfNZ_zKObC7QKBmMsoWZc2G5E8R2J3v929AIHFJkrzwOm4R-dZIQPnHiE8EMgK-TY-l9EThwAPxHyFYZLLJF1J16_7K-ZTm_nvEfF2jKwRI5pDelcN3uYWaSZiLnhcmxoeVCvQrvEKvg3jIhOSC5fi-fjPV-f3avPRIkeDGF3acZl1WTVLnH7FXsOy2kDekpI1okRzzHpdqTkmNaFkHdezzlKzxImy3zBLC0i8JSVrRInmmPUsmTkmM6H0OuVfvV2WmiVOlHcNs7SAxFtSskaUaI5Zz9Izx_RMKP2OdZKaFU6Mg4ZJWiDi7RhZI0Y0h7x-HbhgMOf5JktzfnYtuDy5e7wu8PiJV3eLPCvEij-IbFXaVI-zUle-iHkuq69YPYzT6tNxwfdiVIq9mhjPxVQpZmpn1sbZU4p9tbOvFFOqVveU6r5a3G8DfacUD9TOgzbOqOmYrmStWobqmqGmZ9iqaKhuGmqqhuqu6czVXUNN2bBV21BdN9T0DVsVjqoLRzWFo3aFCw8f_gcAAP__so088A==

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt9q2zAUh-_3FOJcbUzBObLTP4ZBtzVlgS7pnIxtdL7wbFEMrp3JMrgtefdhe6R1aSXZymUs_c45-vRB9ADl3wx8WM8v5583pBIZuQhWX8n1_OfV5cfFkrw9X6w362-X78j_LXW3ob67Jz--zIM5qcnvajp1Y-KS78vFaqnbyD8Ql6yC83lAPv0idQgU8iLhy-iWl-BfAwIFBhRcoOABhRmEFLaiiHlZFqLZ8tAGFkkN_pRCmm8r2XwOKcSF4OA_gExlxsGHTfQn4wGPEi6cKVBIuIzSrG2zFeltJO7O6rt7oLDeRnnpk4nTdL5IM8mFT85wfzTf9xfLzQlQWFWyWYFwR6Go5GPvUkY3HHzcUfP5ztNSpnksnVl_OEV9NqT-0_PjeADNlZkTcEcRQHME3qsNHutWeSESLnjSqxruVCOwqfEIsyFnXBdCcuEwfF7-_av1j3r1ccAtG1yywyaOe1jPNRPuER-N9HwIARsENqabMkBzCH3TmTkEZsLAnTjeYTXQTLhHcDxSgwEE0AaBjQamDNAcQl8D1xyCa8LAm7R_PwfUQDPhHsHJSA0GEEAbBDYamDJAcwh9DTxzCJ4Jg9nksBJo5tsDOB0pwYDz43gANgqYEkBzBK8_fV5oEPByW-Qlf_YEernytHka8eSGd--osqhEzK9EEbdtup-rNtd-SHgpu1XsfizybqkZ8GkYlWGvF8bnYaYMu-rOrk1nTxmeqTvPlGHG1OkjZfpYHT62OfSJMnyq7nxq0xk1jukks7IM1ZqhxjO0Eg3VpqFGNVS7pmuudg01sqGVbajWDTW-oZVwTC0c0wjHhgkX7t78CwAA__9_SZP8

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt9umzAUh-_3FNa52jRH5BjSP0iTuq2pFqlLOpJpmzouGFgVEoXMGIm2yrtPwJSWqrUNziXYv3OOPz4JP0D5NwMf1vPL-ecNqURGLoLVV3I9_3l1-XGxJG_PF-vN-tvlO_J_S91tqO_uyY8v82BOavK7mk7d-APxyPflYrXU7eQEySo4nwfk0y9Sh0AhLxK-jG55Cf41IFBgQMEFCh5QmEFIYSuKmJdlIZotD21gkdTgTymk-baSzeuQQlwIDv4DyFRmHHzYRH8yHvAo4cKZAoWEyyjN2jZbkd5G4u6svrsHCuttlJc-mThN54s0k1z45Awfj-b7_mK5OQEKq0o2SxDuKBSVfGxeyuiGg487aj7geVrKNI-lM-tPp6jPhtR_CgDHE-AEzQG4owCgOQHv1QaPdau8EAkXPOlVDXeqEdjUeITZkDOuCyG5cBg-L__-1fpHvfo44CMbfGOHTRz3wJ5rRtwzPhrp-RAENgwsTDdFgOYM-qYzcwbMBIE7cbwDa6AZcc_geKQGAxCgDQMLDUwRoDmDvgauOQPXBIE3af8-h9RAM-KewclIDQYgQBsGFhqYIkBzBn0NPHMGngmC2eTAEmgG3BM4HSnBAAA4noCFAqYA0JzA61efFxoEvNwWecmfXYFerjxtrkY8ueHdPaosKhHzK1HEbZvucdXm2hcJL2W3it3DIu-WmgGfhlEZ9nphfB5myrCr7uzadPaU4Zm680wZZkydPlKmj9XhY5tDnyjDp-rOpzadUeOYTjIry1CtGWo8QyvRUG0aalRDtWu65mrXUCMbWtmGat1Q4xtaCcfUwjGNcGyYcOHuzb8AAAD__9wdk_Y=

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lVFvmzAUhd_3K6z7tElGxDakLU-ptkyKxEiXZNKkigcWrCoSxcwGCRrlv0-BbV2i1NiQPYLvxzm-5yjZg_qZQQDreTj_uEGVzNDn1fILepx_fwjvFxF6_2mx3qy_hh_Q75Eao6abqZsX9C1aLCN0H4Z_jhuM6r_HMWDIRcqj5JkrCB6BAAYKGBhg8ACDDzGGQootV0rI48i-BRZpDcEEwy4vqvL4OsawFZJDsIdyV2YcAtgkPzK-4knKpTsBDCkvk13WyhRy95zIZlY3L4BhXSS5CpDjHpWXVRmgGcEzCvEBg6jKVwVVJk8cAnLAw1z4li4onpE3XdA3XbyKV7mQKZc8PRGODxd8RsIRhUsmZ5OXtSf_Rds30mYn2sR8-8Rg-y51XDakBRY-ptY-LHpArpQFGdADar4DarID5rjekCwsfNxY-7DIgl4pCzogC2a-A2ayA89pf72ss7DwcWvtwyILdqUs2IAsPPMdeCY78J0hSVi4uLN0YZGDd6UcvJH_Uxe-vOKqELnihl-OMfD0iXcXUaKSW_4gxbaV6R6XLde-SLkqu1PaPSzy9qiN6F-YjIGpFmZ6mGlhMj2hJ-e0p6Wneml_DDwdc-kbLXynh2_HwHdjbBN9x0hfyfQt68VH9Yz0FM3vwfVN68X1XTv3Hh_e_QoAAP__JGE5Mw==

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysVttq2zAYvt9TiP-qZTK2ZOfkq3ZrBoEs6ZIONoovvFiUQGp5sg05kHcfcRqyhPiXfLirbX36jpTsIP27Ah_mw_Hw6wvJ1Yp8m02_k9fhr-fx42hC7p5G85f5j_E9ufs4sz6eWG-2ZDp7Gs7Il99kc09-TkbTCXkcj9GD2_vz3-sAKMQyEpPwXaTgvwIDChwouEDBAwodCCgkSi5Emkp1OLIrAKNoDb5DYRkneXZ4HVBYSCXA30G2zFYCfHgJ_6zETISRULYDFCKRhctVQZOo5XuoNg_rzRYozJMwTn1i2QfmaZ755IFBsKcg8-x8fZqFbwJ8tqf1JHRak8BLJZyZ81iqSCgRXbAG-xsiJ9KSic2cq5O3uZ0q9udSZULZ7Mr6A_tc6s018HbL2celpfa4mT3vgp6Zt8sM2rW5ZbuVJ1ZBRLdFEbxURJORsRoj0wRwGlm37si4ecDcJGDXsr3KLVcQ0WtRBC8V0aRlXqNlTQCnlnt1W3bNA3ZNAvas4j96tZYriOi3KIKXimjSslujZU0Ap5b7dVv2zAP2TALuWJU7riBh0JoEXiqhScNejYY19k8ND9r4SXDj_plIExmnwlB5QEFEb-IYVCpztRDPSi4KmuPjtMAVLyKRZsev_PgwiotPRf__g1kTMEfB7gXYuQa7KNjDmT1cNsOpOyi6h1N3m4B7KLiPy-43SWyAghnTzAQfmRaOz4xx3DjDh6ZxzvClsY4Gjm9NC8fHxroa6_jcdNbxvbGBBo4vTgvHN8cd3DrHN3dtPdh_-hcAAP__Geg9FQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk1v2kwUhffvr7DuKtE7yNwZOwSv0hYqIVFIgUqtIi9cPIosEZuOxxIf4r9X2BXEKMyHzS6259xzn5wjNHvI_6wggPlwPPyycAqxcr7Opt-cl-HP5_Gn0cS5G4zmi_n38b1z9-_Mpjqx2e6c6WwwnDmffznbe-fHZDSdKA_t7s9_b0IgkGYxn0RvPIfgBRAIUCDAgIAHBHwICaxFtuR5nonjkX0pGMUbCLoEknRdyOPrkMAyExyCPchErjgEsIh-r_iMRzEXbhcIxFxGyaq0WYvkLRLbp812BwTm6yjNA6fjHp2nhQycJ4TwQCAr5Hl8LqNXDgEeiPkKgySXSbqUrl_3V8ynNvPfI-LtGFkjRjSH9K4anOcWaSZiLnhcmxoeVCvQrvEKvg3jPBOSC5fi5fj_r85_qM1HixwNYnRpx2XWZdUscfovPjQsqw3kLSlZI0o0x6zXlZpjUhNK1nE96yw1S5woew2ztIDEW1KyRpRojlnPkpljMhNKr1P-1NtlqVniRPnYMEsLSLwlJWtEieaY9Sw9c0zPhNLvWCepWeHE2G-YpAUi3o6RNWJEc8jr14EPDGY8X2dpzi-uBR9P7h6vCzx-5dXdIs8KseTPIluWNtXjtNSVL2Key-orVg-jtPp0XPC9GJVirybGSzFVipnambVx9pRiX-3sK8WUqtUPSnVPLe61gX5Uivtq534bZ9R0TFeyVi1Ddc1Q0zNsVTRUNw01VUN113Tm6q6hpmzYqm2orhtq-oatCkfVhaOawlG7woWH__4GAAD__1T2Q3M=

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysVtuK2kAYvu9TDP_VLp2QzCSecrXbrgXB6la30LLkIjXDIriZdJKAB3z3YlyxivlncrhMMt98R8QdpH9X4MN8OB5-fSG5WpFvs-l38jr89Tx-HE3I3dNo_jL_Mb4ndx9n1scT682WTGdPwxn58pts7snPyWg6IY_jMX6Qku39-XEdAIVYRmISvosU_FdgQIEDBRcoeEChAwGFRMmFSFOpDkd2BWAUrcF3KCzjJM8OrwMKC6kE-DvIltlKgA8v4Z-VmIkwEsp2gEIksnC5KmgStXwP1eZhvdkChXkSxqlPLPvAPM0znzwwCPYUZJ6dr0-z8E2Az_a0noROaxJ4qYQzcx5LFQklogvWYH9D5ERaMrGZc3XyNrdTxf5cqkwom11Zf2CfS725Bt5uOfu4tNQeN7PnXdAz83aZQbs2t2y38sQqiOi2KIKXimgyMlZjZJoATiPr1h0ZNw-YmwTsWrZXueUKInotiuClIpq0zGu0rAng1HKvbsuuecCuScCeVfyiV2u5goh-iyJ4qYgmLbs1WtYEcGq5X7dlzzxgzyTgjlW54woSBq1J4KUSmjTs1WhYY__U8KCNvwQ37p-JNJFxKgyVBxRE9CaOQaUyVwvxrOSioDk-Tgtc8SISaXb8yo8Po7j4VPT_P5g1AXMU7F6AnWuwi4I9nNnDZTOcuoOiezh1twm4h4L7uOx-k8QGKJgxzUzwkWnh-MwYx40zfGga5wxfGuto4PjWtHB8bKyrsY7PTWcd3xsbaOD44rRwfHPcwa1zfHPX1oP9p38BAAD__42APdo=

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkc9q8zAQxO_fU4g9xSCI5dx0-kLjgsF10jgpheCDkZZgUKVUf0oh-N2LZWia0pS0PWp2fzsz6AjuWQGHOi_zmw0JVpHb9fKO7PLHVTkvKjJZFPWmvi8T8jAvt3lNJiyhZJIlZFsVy-pdzQZ1ljRAQRuJVfuEDvgOGDQUDtYIdM7YQTrGhUK-Ak8pdPoQ_CA3FISxCPwIvvMKgYMyolXkpVUBHUmnKVCQ6NtOxf2eggn-RDvf7hE46-kvHdiUXeWQXXQ4HQ7aWIkW5aeLX2RYdM53WvhpdrYL_xlcSjD7Scc1uoPRDq_qlg4JUe5xrONMsAJX1ohoMz6XkYuCROfHaTY-Ch1H8RM-wuwvcPYtPDuD077p_70FAAD__6Ke6m8=

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9u2jAUh-_3FNG5ajWjYCfhT6RJdCvTkBh0hItNVS5S4hUkSjInSE0r3n1KKOuSgE9M2twV8Gf_cvydnjxD9GcNNjjD8fDLXNuKtfZ1Nv2u3Q5_3oyvRhPt4nrkzJ0f40vt4mVNsl_xmDxdaqPJfDhz0m-vxuOjK6az6-FM-_xLS1wgsAl8PvEeeAT2LVAgwICAAQRMIGCBSyAUwYJHUSDSJc8ZMPIfwW4TWG3CbZx-7RJYBIKD_QzxKl5zsGHu3a35jHs-F3obCPg89lbr7JhQrB48kQwekycg4ITeJrK1lp6ePN3GtjZg4O4IBNv4ZfvXXe8SbelFy_x-AwruziUQxd49B5vuyHkxrUZjspMxX_fZbgLhc8H93E5uSmJLjjzrNy9aOjyehjot3Mg8CbmddwcIrPnv-GJALz-J1f0y--vfo9PCo78-lqFSfScQMRc6tYqV-nhyf7NC2Y5V5GXTIyEmQSsIddYu1vjo8VbueFpdLlpBLp21dONdukAhaKfhoOxk0Ab6gDbUB0j9D33QObcPWPX7ZVXu12jp5ruIqBC023BQdjJoAyKyhkRE6n8QsXuuiEb1-zWq3K_Zysby24uoELTXcFB2MmgDIhoNiYjU_yBi71wRzer3a1a5X6v1LhoqxOw3GpOdjNmAhGZDEiLVP0jYf4vX0yP7z3gUBpuIV3rzbKc14_49399BFGzFgt-IYJEds_84zbjsdcPnUbz_le0_jDb7n9KA1eFuHZjSWrRVi-7LaapQM6YGd-vAhZqp0lYtui-nWZFu_08bObhdhA0pbMpvy5TCjMqPtur0hxxG-kMOY_2B0Eh_IDTSH506_SGHkf6Qw1h_IDTSHwiN9EdXamlPLmmvTn_06xguhxHD5TBmOEIjhiM0NgFUxmb5P6nK3FSl0SGgNDmVcURzWpoiOVUpk4tO5WMEMZ2W5oiK6giNuI7QmOwYjtiO4ZjupRmqpLucxnSX06juCI7pjuCY7qVBmte9g-hemilKupdmipLuchrTXU6juiM4pjuCY7qX5qmS7nIa011Oo7ojOKY7gmO6l6Zq_l27LdedlWaLVHd39-FvAAAA__9fq3zW

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v4kYUxd_7Kaz7lKhGZv4QiKVK2TZURaJhCzy0WvHghWmCxGJqGylslO9eARsINr7HY5u8JeAzc3zmnp9sXij-b0E-jbr97m9jZx0tnN-Hgz-dL92_P_c_9R6cq_veaDz6q3_tXP24ZrO_4nnz_drpPYy7w9H203PfDob33aHz6z_OZkIuLcOZeQi-mZj8LyTIJUkuKXJJk0stmri0isKpieMw2l7yshP0Zs_kN12aL1frZPvxxKVpGBnyXyiZJwtDPo2DrwszNMHMRF6TXJqZJJgvdtusovm3INrcPW--k0ujVbCMfafhbXcerBPfuZM0eXUpXCfH5eMkeDTki1e3uIX7eZzMl9PEa53ufydS6x8lXzfOUxA_nbn-6EHaeHgfg6gvB1UqB1FvEDrXxHGd9TKMZiYys5OVdqvk2pRNYPNooXUpCyipo4WbChbcUi7_COKnkUkGK0-lkhpvVsZ_1_9P_T65tDD_Jld34vqXaP74tPvrMGH5t9W2mbBRGCUm8lQmtZ9z1-8UiO1cIj8WPWPiIWyEK0830xmf3f72ZHthUeICHfZkw1PWNAMmDrN5c0Ga2QRRZxKqVBKi3ih0romKMBEleVajBZRUHs_sLFTmmfggnoEJe-NZJrWiPJPFeySL1Eg1PG0NFGDiMBztCwLFIghRZxKqVBKi3ih0romKbZYlgVKjBZRUHlDsLFQGivwgoIAJewNKJrWiQFHFe6SK1Eg3dm9FdkABJg7D0bkgUCyCEHUmoUolIeqNQueaqNhmVRIoNVpASeUBxc5CZaCoDwIKmLA3oGRSKwoUXbxHukiNWg1rnAALh9G4vSBOLGIQ9eWgSuUg6g1C55qo2GRdEiY1WkBJ5cHEzkJlmOgPggmYsDeYZFIr8_PNmfWHJl6Fy9gU-mWmuc3MzB7N_gzicB1NzeconO622f872Ol2H8xMnOy_Fft_esv9V1uD78UiLRbvxfpELOzEQlVRS1FJfVtFrdq8WrKJKz5xxW7d4nfmxQKcF6-WsopaNSupO7xas4nf8OKWhVimxTesuM2fdZsVg3vusGINin3LU6EJsJCBihUXeDUEAy-HZAByhAZejtggMmg5DV6C4DNsscEDUCM-ADkCBJAjQiA5qIvIEOY0eBQdj5iUPIMJwUNG3IBj5zGDbp3njOiAzTOksSo7r4Zl5-Ww7ECOys7LYdl5ykpAWcmjBkwsUKOyAzkqO5CjsiM5mHjJU1aCoZP8E1xKnim75FEjNTh2HjXo1nnSSEAamSGNTdmBGpUdyFHZkRyUHcjhUz9PWQkoK3nUoLIDyqJzA5hEZQeYRGUHcjTxPGUVmBrFvyCn5JmyKx41CjzQKR414NYVTxoFSKMypLEpO1CjsgM5KjuSg7IDOSq74imrAGUVjxr0lg8oi84NYBK95wNMohd9IEcTz1NWoWPn35pT8mzZedRo8ECnedSkb33y-tP_AQAA___L4gvN

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6xz1UpGwU6gJdIkupVpSAw64GJTlYuUeAWJkswOUtOK_z4lVOv48onn1bsrxY_9-viReJ9B_VxCCJPeoPdxStZyST6NR1_Ibe_bzeCqPyRn1_3JdPJ1cE7OXtYU2xWPxRMZja97Y_LhOynOSX847Y0n5YKrwQBZHAGFVZqIYfwgFIS3wIACBwo-UAiAQgsiCplMZ0KpVJZLniugnzxC2KSwWGXrvPx3RGGWSgHhM-SLfCkghGl8txRjESdCek2gkIg8XiyrYzK5eIhl0X0snoDCJItXKiQNrzx5tM5D0uUQbSik6_xl-9dd7woyj9V8d78ug2gTUVB5fC8gZBv6dzFbTmPykzFf91mvUpkIKZKdnaKSxJYcuevnWM0nIh9lHtt7kWmRiXDXHaCwFD_ysy47fy8X9_Pqr99XZ3tXf72Wb3GtI5mHaSPNPNbaH8DRs4Ods1n9l2c1Xt7jDc9_E0UNgrYdB-UngzqQlDmSlNefP68zf7_hBW8iikHQC8dB-cmgDkThjkTx68_frzP_oFH95vx7UQyCXjoOyk8GdSCK70iUoP78gzrzbzXeRBODmB2nMfnJmA4kCf5DNzqSaCxUlq6UqNV8muWdRHIvtjNS6VrOxI1MZ9Ux24-jiqt-xROh8u23fPuhv9p-VQasD7dt4I4NzKxys5aeZgYj42Zw2wbu2MDMKvfeyA5ovk83_6R9_bx9Lcx2Z9bcpwMbwfUwIrgeRgTXw5jgCI0I3rIRXA8jguthRHA9jAmO0IjgbRvBL2wU1cOIonoYUVQPY4oiNKLopY2iehhRVA8jiuphTFGERhTt2CjKrHoCQiOSIjRiKUJjmmI41hXsyoJdW7CrC5Z9wa4wMKvGwA4qg5GtehqzVU9jtupp1FYEx2w1KUuHb2bSlkxpzFajvmSMY7YelAetrdHm3a8AAAD__4iBeyc=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7lEhGMDM2IZYqZdtQFYmGLfDQasWDF08TJBa7tpHCRvnvFaaCYMf3eGyTfUvAn-f4-J7jMS-U_Lsmj2bD8fDXubWN19Zv08kf1pfhX5_Hn0YP1tX9aDaf_Tm-tq7-P2Z3OOJ5992aTO-HU-uXv63dtTV6mA-ns_0B_IELsmkTBvrB_6YT8r6QIJsk2aTIJodscmlhUxSHS50kYbw_5CUDRsEzeT2bVptom-4_Xti0DGNN3gulq3StyaO5_3Wtp9oPdNztkU2BTv3VOlsmilff_Hh397z7TjbNIn-TeFanu195sk09607S4tWmcJueTp-k_qMmT7za1SXcr5J0tVmmXfd8_TuRO_8J-bqznvzk6Z3jTxqkiYa3Noj2fFC1fBDtGuGUijidZ7sJ40DHOjg7U3aWUpmyB2SeJLiXkoCcOknoN5Bg11L5u588zXQ6iboq59R8F2nvTf4_jcdk01r_k17dieuf49XjU_bXccLKL-umXWcfwk4YdZWbN-DdtQdnawuDhFUIWFd2usq4aoCI4-D0L1g1Jka06YSq5YRo1wqnVETDpIuaZdOiBORUWdmYSWhcNuKDykZWn3NZZcxVp-sYBx6ION68mwsG3sAI0aYTqpYTol0rnFIRDdMmawa-RQnIqbLAm0loHHj5QYFX1edcVRlzp5Nt-c0CD0Qcb97ggoE3MEK06YSq5YRo1wqnVETDtKmagW9RAnKqLPBmEhoHXn1Q4J3qc-5UGXO3Yxx3IOF4624vGHcDG0R7PqhaPoh2jXBKRTRMmlMz7C1KQE6Vhd1MQuOwOz_gt4N3FE11EoWbRFf6ZaC3vyYdPOqDR0m4jZf6cxwus2UO_04yLvsg0El6-FYc_hltDl_tBb6FRR4Wb2HnDBZmsJCN6NsmtOw3oZXiack6rnjHFbu0y6_MwwLo5mnZa0TfNKEVmDSHdRzcbNcAlnm4z8Lgom_4QenzkzJg6Vsevm0SbB5GwQY0CDZPo2DzNAq2AF2KypSvFZBtQKNwAxylG-Fg0gGO8i34ShUIL7QLhxcyLvh6QZfO94sAKReFhjF6BPM0fAYDHD2EeRw-hXkcppWvVzEAxhf61SitPA3TyuMwrQBHI8vjMK2Flj0zXgqwfeJbNocX0ioLVWOSVsk3jQS7N8nvY4BxgEZpRThIK8BRWgEON818yUoXGF9oWZO0AhqlFeAorQhHI8vjKK2S38LKAcD5ls3hxbTyu1h06XzTqB541yo0jUlaAY3SinCQVoCjtAIcpVXxJaskML7QskZvuTwNX3N5HL7nAhy96PI4Sqvit7IKWce3bA4vpFXxe9n8pS9ef_ovAAD__6E_C5A=

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v4jgQwN_vU1jz1OqMEjsJfyJVau9KVSQOeoC0u-rykBJvQaIk6yQStOp3XyWU7YZQT0xK3krjX4aZ-Q3jF4h-LsGFcbff_XdCErkkN6Phf-S--_Wuf9UbkLPr3ngy_r9_Ts7ezqy3J9abZ_LltjvqkjX5npimNSP8nPQGk-5onB676vdRRFykzHB03R2Rf76R9RQorAJfDLwnEYF7DwwocKBgAQUbKDgwpRDKYCaiKJDpkZcM6PlrcE0Ki1WYxOm_pxRmgRTgvkC8iJcCXJh4D0sxEp4vpGECBV_E3mKZhQnl4smTm8v15hkojENvFbmkYaSRbxbLWEiXXLLfWbqu2xtM2kBhmMTpE5i-UgiS-C32e8iHDZl70TwfLDs_pRDF3qMAl73S43Jwjs4hLfvnJsE_TOL9PckqkL6Qws-9aZqS2JEDlbj1ovlYxMPQYHvNnGxC4eZFBApL8SM-u2TnF3LxOM_--jD197Qsnd6MAxkLaTBnv1J_f_h-u0TZDlXk7aUHvsQgaAShwc39Gh8M7-TCs_LqsRLqGbxhWPUPkEYWzQpZnHqEWL0jxGoaIaQ7uxFqHjtCvHz3eZnuWw3Drt9hjSxaFbI4tcO8Xod5TQ4j3dk53DrWYat8960y3bcb2VWhZoc1smhXyOLUDlv1OmzV5DDSnZ3D7WMdtst33y7TfadRv8EaOXSOzuHU_tr1-mvX5C_Sm52_nc-4ih94_0hEYbCKRKlbtpnWTPiPYtuDKEjkTNzJYJaF2X4cZlx2P_JFFG-f8u2H3mr7KP2C5eFWFZixSrRTie6oaaZRM64Ht6rAezXTpZ1KdEdN833a_JO2crC5D1tK2FZ3y1bCnKlDO1XmQw0j86GGsflAaGQ-EBqZj2aV-VDDyHyoYWw-EBqZD4RG5qOltLStlrRdZT46VQxXw4jhahgzHKERwxEa2wA6a7P4S6qzN3VpdAlobU5tHNGcFbZITlXG1aIz9RpBTGeFPaKjOkIjriM0JjuGI7ZjOKZ7YYdq6a6mMd3VNKo7gmO6Izime2GR5nVvIroXdoqW7oWdoqW7msZ0V9Oo7giO6Y7gmO6Ffaqlu5rGdFfTqO4IjumO4Jjuha2av2ubat15YbcodZ--_vUrAAD__0qR08k=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYfxe-fT2HNVaLHCOaFl1haKduG1SJR2AJSW225YGGaILGY2kaCjfLdK2ADwcb_M-MxuUvAZ-b4zP_8ZPPM4n8XLGDDdrf968hbRwvv06D_m_e1_eeX7sdOz7t56AxHw9-7t97Nz2s2hys22x_eH5_bg7a38f5e12py6olbr9MbtQfD3WXocv1hd31_8NAeeL_85W3GzGfLcKZ7k-86ZsFXxpnPBPOZZD5TzGd1NvbZKgqnOo7DaHfJ817QmW1YUPPZfLlaJ7uPxz6bhpFmwTNL5slCs4CNJt8WeqAnMx1Va8xnM51M5ov9Nqto_n0Sbe832x_MZ8PVZBkHXqW62_nTfJHoKPDu-fEOgyDo9EYt5rP-Otl9w8YvPgvXyWnvOJk8ahbwF9_c38M8TubLaVKtn5vLrH-SfNt6T5P46cL1Jw_CxsPbjHjxkHbnap6SLJQSLzcmlWvitM56GUYzHenZ2Ur7VXJtihqwebJQv5YFlNTJQsPBgl_I5edJ_DTUSX9VlamkRtuVDt7A5GO3y3y20P8kN_f89kM0f3za_2UwYU2bCRuGUaKjqsyk9v_c9VsGsV1K5OeiF0z0wkq4qqpaOuOL29-dbc8tKm7Q8KqoVGW5IAQOj4PbuCIIbVJyickFhaY58XKDUrkmHDnEC6KwRAsoqTwU2llwRiF_JxSCCXtFYSY1UxQK85YJk5LJSlWVyyLg8Dg5zSuyyCIl7hKTC4tMc-LlBqVyTTiCQBRkUYkWUFJ5LLKz4Mwi8U4sAhP2yqJMaqYskuYtkyYlU5X9m1qJLAIOj5PTuiKLLFLiLjG5sMg0J15uUCrXhCMIZEEWlWgBJZXHIjsLziyS78QiMGGvLMqkZsoiZd4yZVKyeqVcEgF_x7m5uyKJLDLixUNy4ZBpSrzcmFSuCUcIqIIcKtECSiqPQ3YWnDmk3olDYMJeOZRJrchPVRfWH-h4FS5jbfQrVG2XmZ496sMZxOE6muovUTjdb3P4t7_X7T-Y6Tg5fMsP_3SWh692Bt-KeVrM34rVmZjbibl0UQvupL5zUcsmrRZk4pJOXJJb1-mdaTEH50WrhXBRy5qTukWrFZl4gxbXLcQiLW6Q4iZ91k1SDO65RYoVKPYdTYUawEIGKlZcoNUQDLQckgHIERpoOWIDz6DlPHgBgs-wxQYPQI34AOQIEECOCIHkoC48Q5jz4FF0NGJS8gwmOA0Z3gDHTmMG3TrNGd4Cm2dIY1V2Wg3LTsth2YEclZ2Ww7LTlBWAsoJGDZhYoEZlB3JUdiBHZUdyMPGCpqwAQyfoJ7iUPFN2QaNGKHDsNGrQrdOkEYA0IkMam7IDNSo7kKOyIzkoO5DDp36asgJQVtCoQWUHlEXnBjCJyg4wicoO5GjiacpKMDWSfkFOyTNllzRqJHigkzRqwK1LmjQSkEZmSGNTdqBGZQdyVHYkB2UHclR2SVNWAspKGjXoLR9QFp0bwCR6zweYRC_6QI4mnqasRMdOvzWn5Nmy06hR4IFO0ahJ3_r45X__BQAA__9LB2LA

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt1u6kYQgO_7FKu5Cuoie9c2P5YikTZEQaKQAlJbpb5w8DYgEeyujQSJePcjQ0iOMdnx4uC7w2G_HWbmm8y-Qfz_AlwYd_vd3ydkJRfkbjT8gzx2_37o3_QG5Oq2N56M_-zXyNX7mc3-xHrzSv667466ZE3-XZmmNSVWjfQGk-5onB676fdRRFwTViPD0W13RH77h2w8oLAMAzHwX0QM7iMwoMCBggUUbKDggEchkuFUxHEo0yNvO6AXrME1KcyX0SpJ_9ujMA2lAPcNknmyEODCxH9aiJHwAyENEygEIvHni12YSM5ffLnprDevQGEc-cvYJXUjjXw3XyRCuqTDPrJ0Xbc3mLSAwnCVuKTDwdtSCFfJe-zPkE8bMvPjWTZYh4G39SjEif8swGVbel4Oztk5pGX_3iT4l0l83rNahjIQUgSZm7yUxI6cqMS9H8_GIhlGBjtq5mQTCTcrIlBYiP-Sqw6rXcv582z3r4_U2VHqn2lZOr0ZhzIR0mDOcaV-_fJ-u0DZTlXk_dITP2IQ1sPI4OZxjU-GdzLhWXH1WAH1DF43rOoHSCOLRoksLj1CrNoRYhWNENKdwwg1zh0hXrz7vEj3rbphV--wRhbNEllc2mFercO8IoeR7hwcbp7rsFW8-1aR7tv13VOhYoc1smiVyOLSDlvVOmxV5DDSnYPDrXMdtot33y7SfadevcEaObTPzuHS_trV-mtX5C_Sm4O_7e94ip-4fyTiKFzGotAr20xrJoJnse9BHK7kVDzIcLoLs_843HG791Eg4mT_Ld9_6C33X6U_sDjcLAMzVop2StFtNc00asb14GYZ-KhmurRTim6raX5Mmz_TVgY2j2FLCdvqbtlKmDN1aKfMfKhhZD7UMDYfCI3MB0Ij89EoMx9qGJkPNYzNB0Ij84HQyHw0lZa21JK2ysxHu4zhahgxXA1jhiM0YjhCYxtAZ23m_5Lq7E1dGl0CWptTG0c0Z7ktklGVcbXoTL1GENNZbo_oqI7QiOsIjcmO4YjtGI7pntuhWrqraUx3NY3qjuCY7giO6Z5bpFndG4juuZ2ipXtup2jprqYx3dU0qjuCY7ojOKZ7bp9q6a6mMd3VNKo7gmO6Izime26rZt_aplp3ntstSt297S8_AgAA__-K3tPW

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYfxe-fT2HNVaLHCOaFl1haiW3DapEobAGprbZcsDBNkFhMbSOFjfLdK2ADwcb_M-MxuUvAx3PmzP_8ZPPM4n-XLGCjTq_z69jbREvv03Dwm_e18-eX3sdu37u5747Go997t97Nz2u2hyuetj-8Pz53hh3vyft7U6vJmSdvvW5_3BmOdpehy_UHj996g-F9Z-j98pe3nTCfrcK57k-_65gFXxlnPhPMZ5L5TDGf1dnEZ-sonOk4DqPdJc97QXf-xIKazxar9SbZfTzx2SyMNAueWbJIlpoFbDz9ttRDPZ3rqFpjPpvrZLpY7pdZR4vv02jbftr-YD4braerOPAq1d3KnxbLREeB1-bHHQZB0O2PW8xng00SeG3BJi8-CzfJae04mT5oFvAX39zf_SJOFqtZUq2fm2vz1P1Pkm9b73EaP164_uRB2Hh4mxEvHtLuXM1TkoVS4uXGpHJNnO6zWYXRXEd6fnan_V1ybYoasHmyUL-WBZTUyULDwYJfyOXnafw40slgXZWppMbbtQ7ewORjr8d8ttT_JDdtfvshWjw87v86Tlj-tpo2EzYKo0RHVZlJ7f-5928ZxHYpkZ83vWCiH1bCdVXV0hlfXP7ubHluUXGDhldFpSrLBSFweBzcxhVBaJOSS0wuKDTNiZcblMo14cghXhCFJVpASeWh0M6CMwr5O6EQTNgrCjOpmaJQmLdMmJRMVqqqXBYBh8fJaV6RRRYpcZeYXFhkmhMvNyiVa8IRBKIgi0q0gJLKY5GdBWcWiXdiEZiwVxZlUjNlkTRvmTQpmars39RKZBFweJyc1hVZZJESd4nJhUWmOfFyg1K5JhxBIAuyqEQLKKk8FtlZcGaRfCcWgQl7ZVEmNVMWKfOWKZOS1Svlkgj4O87N3RVJZJERLx6SC4dMU-LlxqRyTThCQBXkUIkWUFJ5HLKz4Mwh9U4cAhP2yqFMakV-qrpw_6GO1-Eq1ka_QtV2men5gz6cQRxuopn-EoWz_TKHfwd73f6DuY6Tw7f88E93dfhqZ_CtmKfF_K1YnYm5nZhLF7XgTuo7F7Vs0mpBJi7pxCW5dJ1emRZzcF60WggXtaw5qVu0WpGJN2hx3UIs0uIGKW7SZ90kxWDPLVKsQLHvaCrUABYyULHiAq2GYKDlkAxAjtBAyxEbeAYt58ELEHyGLTZ4AGrEByBHgAByRAgkB3XhGcKcB4-ioxGTkmcwwWnI8AY4dhozaOs0Z3gLLJ4hjVXZaTUsOy2HZQdyVHZaDstOU1YAygoaNWBigRqVHchR2YEclR3JwcQLmrICDJ2gn-BS8kzZBY0aocCx06hBW6dJIwBpRIY0NmUHalR2IEdlR3JQdiCHT_00ZQWgrKBRg8oOKIvODWASlR1gEpUdyNHE05SVYGok_YKckmfKLmnUSPBAJ2nUgK1LmjQSkEZmSGNTdqBGZQdyVHYkB2UHclR2SVNWAspKGjXoLR9QFp0bwCR6zweYRC_6QI4mnqasRMdOvzWn5Nmy06hR4IFO0ahJb33y8r__AgAA__8cdmLN

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll9v2jwUxu_fTxGdq1YyCnYCLZFeiWpjGhKDDriYVOUiJV5BSpPMTiTSqt99StKu48984hmyyxD_4sc-P4nnGeSPCDxYjCajD0srF5H1aT77Yt2Nvt1ObsZT6-LjeLFcfJ1cWq9LtsQq6jXb4skaT5ej-aL8_WYyeVtSEGv7a4kPBOIk5NPgkUvw7oACAQYEHCDgAoEe-ARSkay4lIkolzxXwDjcgtclsInTPCt_9gmsEsHBe4Zsk0UcPFgG9xGf8yDkwu4CgZBnwSaqtknF5jEQxXBbPAGBRRrE0rM6drnzLM88a0jJkIH_QiDJs9cd3j98X1jrQK53P_mG-ARkFjxw8OgL-buwPc2wjAypaVj2x7Dvn8rjRIRc8HDnY35JYkuOnPhzINcLns1Sm-5NZ1mk3Nu1BwhE_Ht2UQW__F9sHtZvD6qZvZ_PMTjfkfDTpJOkNu3t38TRvd2dvWlzEWgDEWzWsZ0zeqsRt68d9_Tm0nbNpW2by5qPgzUZh9Ox3TPaoxH3Sjvu6e1h7drD2rbHaT4Op8k43E71Z3UuezTiXmvHPb09Trv2OG3b4zYfh9tkHL3OGd3RCDvQDHt6c9x2zXH_Zd86Em3OZZrEkjdqU93ycDx84PVlySQXK34rklW1Tf04q7iqDYRcZvVbVj-M4_pVGbA53DeBByYwNcpNe2qaalwZ04P7JvDABKZGufeu7IBm-3T3d9pR37ejhOnunXX3addEcDWMCK6GEcHVMCY4QiOC90wEV8OI4GoYEVwNY4IjNCJ430TwKxNF1TCiqBpGFFXDmKIIjSh6baKoGkYUVcOIomoYUxShEUUHJopSo56A0IikCI1YitCYphiOdQWzsmDWFszqgmFfMCsM1Kgx0IPKoGWrmsZsVdOYrWoatRXBMVt1ytLhzHTaki6N2arVl7RxzNaD8qC01X_572cAAAD__xATi70=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7tCsNgpkxhFiqlFU3VZFosg08VFrx4IVpgsRiahsJNsp_rzApBBvfM2Pj7COYz3N8fM_xmGdK_l1QQKPb4e1vY28dL7zfH-7_9L7e_v1l-Glw5334PBiNR38NP3qvP9kIb7v_zWb7wxvcjW8fRrvvXw9vhbc5HJ6QoGU0M3fhd5NQ8JUkCVIkSJMgnwR1aSJoFUdTkyRRvPvJcwYMZhsKOoLmy9U63X09ETSNYkPBM6XzdGEooHH4bWEeTDgzcbtDgmYmDeeLbJlVPP8extubzfYHCRqtwmUSeK32buX7dRp4N1LcKJq8CIrW6XGFJA0fDQXyRdir-DxP0vlymra7pxLOLXGkvm29pzB5Oo8clSgXJW_9kK6GKHEjSw3RlQyRTTjil0o5nmq9jOKZic3s5GTZWUrFqg4We1TRbUqFhWVHFb0aKkQloX-EydPIpPerts75Nd6uTPCmDT4NhyRoYf5JP2QX8fHXeP749P8HuxxeXdblu6gVrdq6m3fi7Nr9k7WlQ_IsgtdWrbau0kVAx2GOeo13kYsj7pY4tJGtJbIJT_xSKTV7QFZvowuqsLCsrI3cVNRuI_nebaTs51_ZjL9utf0qjQB0HO7lVeON4OCIdLfEoRFsLZFNeOKXSqmZRVW9ES6owsKyskZwU1G7EdR7N4K2n39tM_5-K3ulcG4EoONwL_uNN4KDI9LdEodGsLVENuGJXyqlZhZ19Ua4oAoLy8oawU1F7UbQ790Ivv38-zbj321V6QOg4nAnrxvvAwc_pKshDm1ga4hswhG_VErNHPrV2-CCKiwsK2sDNxW128D_mf9fnJH2YJJVtEyM1b8Tnd3Fmdmj2ZuVROt4ar7E0TRbZv_xPuOyL2YmSfdH5f7DYLk_tBP4FpZ5WL6F_RNYusFS1aKv69CqV4fWmqcV67jmHdfs0l1-ZR6WQDdPq04t-qoOrcGk-azj4GZ3HWCVh3ssDC76ih-UHj8pfZa-5uHrOsHmYRRsQINg8zQKNk-jYEvQpahM-VoB2QY0CjfAUboRDiYd4Cjfkq9UifBCu3B4IeOSrxd06Xy_SJByWWgYp0cwT8NnMMDRQ5jH4VOYx2Fa-XqVfWB8oV-d0srTMK08DtMKcDSyPA7TWmjZE-OVBNsnvmVzeCGtqlA1LmlVfNMosHtT_D4GGAdolFaEg7QCHKUV4HDTzJes6gLjCy3rklZAo7QCHKUV4WhkeRylVfFbWNUHON-yObyYVn4Xiy6dbxrdAe9ahaZxSSugUVoRDtIKcJRWgKO0ar5ktQLGF1rW6S2Xp-FrLo_D91yAoxddHkdp1fxWViPr-JbN4YW0an4vm7_0ycsv_wUAAP__w6sofg==

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9vokwUh-_fT0HOVc07BmYA_5Bs0u7WzZq42hUvdtNwQWW2mlhhB0y0Tb_7BqxxEZnDSMud1nlmfpx5Tg8vEP9ZgQPuYDT4MtM2YqV9nU6-a_eDn3ejm-FYu7odujP3x6ilXb2t2e5XbHfP2mR6O5hqn39pu5Y2HM8GUzddcDMaSRc_t46ftx4QWIcBH_tPPAbnHigQYEDABAIWELDBIxCJcM7jOBTpkpcMGAZbcAwCy3W0SdI_ewTmoeDgvECyTFYcHJj5Dys-5X7AhW4AgYAn_nKVHROJ5ZMvdtfb3TMQcCN_HTtaW09PnmwSR7um4L0SCDfJ2_bHXR922sKPF_n9svUegTjxHzk49JVcFtNuNCYrjXncZ7MORcAFD3I7eSmJLTnzrN_8eOHyZBLp9ORGZruIO3mNgMCK_06urmnrk1g-LrJPpY9-fCxTpfpuKBIudGqfVur_0v2tCmU7V5G3Tc-EGIftMNKZcVrjs8fbueNpdbloBbl01tbND-kChaCdhoOy0qAN9AFtqA-Q-h_6oHNpH7Dq98uq3K_Z1q0PEVEhaLfhoKw0aAMisoZEROp_ELF7qYhm9fs1q9yv1c7G8vuLqBC013BQVhq0ARHNhkRE6n8QsXepiFb1-7Wq3K_d_hANFWL2G43JSmM2IKHVkIRI9Q8S9t_j9fTM_lMeR-E65pXePI20Zjx45Ps7iMONmPM7Ec6zY_ZfJxmXvW4EPE72v7L9l-F6_1MasDrcrQNTWou2a9F9OU0VasbU4G4d-KRmqrRdi-7LaXZKG__SZg42TmFTClvy27KkMKPyo-06_SGHkf6Qw1h_IDTSHwiN9EenTn_IYaQ_5DDWHwiN9AdCI_3RlVrak0vaq9Mf_TqGy2HEcDmMGY7QiOEIjU0AlbFZ_E-qMjdVaXQIKE1OZRzRnBamSE5VyuSiU_kYQUynhTmiojpCI64jNCY7hiO2Yzime2GGKukupzHd5TSqO4JjuiM4pnthkOZ17yC6F2aKku6FmaKku5zGdJfTqO4IjumO4JjuhXmqpLucxnSX06juCI7pjuCY7oWpmn_XNuS6s8Jskeruvf73NwAA___ClYKq

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FdasEtXIzAcfsVQptw1VkWi4BRatrlj4wjRB4mJqGwkS5b9XmCQED36PxzbZJeAzc3zmPY9snln835L5bNwb9H6bOJto6fw-Gv7pfOv9_XXwpX_vXN31x5PxX4Nr5-r1mu3hiu3uyRmO7noj59d_nN2107-f9Ebj_QXUhU_Xx7-3U-ayVTjX98EPHTP_G-PMZYK5TDKXKeayFpu6bB2FMx3HYbS_5DkV9Odb5jddtlitN8n-46nLZmGkmf_MkkWy1Mxnk-D7Uo90MNeR12Qum-skWCzTbdbR4kcQ7W63uyfmsvE6WMW-0_D2Ow83ie_ccjZ9cVm4SY7Lx0nwoJnPX9ziFu4WcbJYzRKvdbq_sf5R8n3nPAbx45nrjx6EjYePMfD6cpClcuD1BqFyTRzX2azCaK4jPT9ZKV0l16ZoAptHC61LWUBJHS20K1hwS7n8I4gfxzoZrj2ZSWqyW2v_Awq-DAbMZUv9b3J1y69_iRYPj-lfBSasYzNh4zBKdORJI7Wfc9fvFojtXCKvi54xcR82wrWnmtmMz25_c7I9tyhxgQ57ouFJa5oBE--z2b4gzWyCqDMJWSoJXm8UKtdERZjwkjyr0QJKKo9ndhYq84x_Es_AhL3xzEitKM9E8R6JIjWSDU9ZAwWYeB-OzgWBYhEErzMJWSoJXm8UKtdExTaLkkCp0QJKKg8odhYqA0V8ElDAhL0BxUitKFBk8R7JIjVSjfStyA4owMT7cHQvCBSLIHidSchSSfB6o1C5Jiq2WZYESo0WUFJ5QLGzUBko8pOAAibsDShGakWBoor3SBWpUathjRNg4X00bi6IE4sYeH05yFI58HqDULkmKjZZlYRJjRZQUnkwsbNQGSbqk2ACJuwNJkZqZX6-ObP-SMfrcBXrQr_MNPeZ6fmDPpxBHG6imf4ahbN0m8O_w1SXfjDXcXL4lh_-6a8OX-0NfhTzrJh_FKsTMbcTc1lFLXgl9U0VtezQakEmLunEJbl1i96ZFnNwXrRaiCpq2ayk7tJqRSbepsUtC7HIitukuEOfdYcUg3vukmIFin1DU6EJsGBAxYoLtBqCgZZDMgA5QgMtR2zgBlpOgxcgeIMtNngAasQHIEeAAHJECCQHdeEGYU6DR9HRiMnIDUxwGjK8DY6dxgy6dZozvAs2N0hjVXZaDctOy2HZgRyVnZbDstOUFYCygkYNmFigRmUHclR2IEdlR3Iw8YKmrABDJ-gnuIzcKLugUSMUOHYaNejWadIIQBphkMam7ECNyg7kqOxIDsoO5PCpn6asAJQVNGpQ2QFl0bkBTKKyA0yisgM5mniashJMjaRfkDNyo-ySRo0ED3SSRg24dUmTRgLSSIM0NmUHalR2IEdlR3JQdiBHZZc0ZSWgrKRRg97yAWXRuQFMovd8gEn0og_kaOJpykp07PRbc0Zulp1GjQIPdIpGTfbWpy8__R8AAP__SPwRoQ==

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9vok4QwN-_fwWZp5rvGtgF_EFySXtXL2fiaU98uEvDA5W9amKFWzDRNv3fL2CNh8gOKy1vpexnd5j5jLMvEP9ZgQPuYDT4MtM2YqV9nU6-a_eDn3ejm-FYu7odujP3x6ilXb2t2e5XbHfP2mR6O5hqn39pu5Y2HM8GUzddcDMayRcT7bl1fNx6QGAdBnzsP_EYnHugQIABARMIWEDABo9AJMI5j-NQpEteMmAYbMExCCzX0SZJ_-0RmIeCg_MCyTJZcXBg5j-s-JT7ARe6AQQCnvjLVXZMJJZPvthdb3fPQMCN_HXsaG09PXmySRztmoL3SiDcJG_bH3d92GkLP17k98vWewTixH_k4NBXclmYdqNhstIwj_ts1qEIuOBBbicvJbElZ771mx8vXJ5MIp2eVGS2i7iTNwkIrPjv5Oqatj6J5eMi-6v004-fZapk3w1FwoVO7dNM_V-6v1Uhbecy8rbpmSDGYTuMdGac5vjs8XbueFpdLlpBLp21dfNDukAh0E7DgbLSQBvoA9pQHyD5P_RB59I-YNXry6rU12zr1oeIqBBot-FAWWmgDYjIGhIRyf9BxO6lIprV62tWqa_Vzsby-4uoEGiv4UBZaaANiGg2JCKS_4OIvUtFtKrX16pSX7v9IRoqhNlvNExWGmYDEloNSYhk_yBh_z2up2f2n_I4Ctcxr3TzNNKc8eCR72sQhxsx53cinGfH7B8nGZddNwIeJ_u3bP8wXO9fpQFWh7t1YEpr0XYtui-nqULOmBrcrQOf5EyVtmvRfTnNTmnjX9rMwcYpbEphS14tSwozKj_artMfchjpDzmM9QdCI_2B0Eh_dOr0hxxG-kMOY_2B0Eh_IDTSH12ppT25pL06_dGvY7gcRgyXw5jhCI0YjtDYBFAZm8VfUpW5qUqjQ0BpcirjiOa0MEVyqlImF53KxwhiOi3MERXVERpxHaEx2TEcsR3DMd0LM1RJdzmN6S6nUd0RHNMdwTHdC4M0r3sH0b0wU5R0L8wUJd3lNKa7nEZ1R3BMdwTHdC_MUyXd5TSmu5xGdUdwTHcEx3QvTNX8XduQ684Ks0Wqu_f6398AAAD__yT5g28=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FdasEtXIzAcfsVQptw1VkWi4BRatrlj4wjRB4mJqGwkS5b9XmCQED36PxzbZheAzc3zmPY9snln835L5bNwb9H6bOJto6fw-Gv7pfOv9_XXwpX_vXN31x5PxX4Nr5-r1mu3hiu3uyRmO7noj59d_nN2107-f9Ebj_QXkha7zdH38uJ0yl63Cub4PfuiY-d8YZy4TzGWSuUwxl7XY1GXrKJzpOA6j_SXPqaA_3zK_6bLFar1J9v-eumwWRpr5zyxZJEvNfDYJvi_1SAdzHXlN5rK5ToLFMt1mHS1-BNHudrt7Yi4br4NV7DsNb7_zcJP4zi1n0xeXhZvkuHycBA-a-fzFLW7hbhEni9Us8Vqn-xvrHyXfd85jED-euf7oQdh4-BgDry8HWSoHXm8QKtfEcZ3NKozmOtLzk5XSVXJtiiawebTQupQFlNTRQruCBbeUyz-C-HGsk-Hak5mkJru19j_Q4MtgwFy21P8mV7f8-pdo8fCY_lVgwjo2EzYOo0RHnjRS-zl3_W6B2M4l8rroGRP3YSNce6qZzfjs9jcn23OLEhfosCcanrSmGTDxPpvtC9LMJog6k5ClkuD1RqFyTVSECS_JsxotoKTyeGZnoTLP-CfxDEzYG8-M1IryTBTvkShSI9nwlDVQgIn34ehcECgWQfA6k5ClkuD1RqFyTVRssygJlBotoKTygGJnoTJQxCcBBUzYG1CM1IoCRRbvkSxSI9VI34rsgAJMvA9H94JAsQiC15mELJUErzcKlWuiYptlSaDUaAEllQcUOwuVgSI_CShgwt6AYqRWFCiqeI9UkRq1GtY4ARbeR-PmgjixiIHXl4MslQOvNwiVa6Jik1VJmNRoASWVBxM7C5Vhoj4JJmDC3mBipFbm55sz6490vA5XsS70y0xzn5meP-jDGcThJprpr1E4S7c5fBymuvQfcx0nh2_54UN_dfhqb_CjmGfF_KNYnYi5nZjLKmrBK6lvqqhlh1YLMnFJJy7JrVv0zrSYg_Oi1UJUUctmJXWXVisy8TYtblmIRVbcJsUd-qw7pBjcc5cUK1DsG5oKTYAFAypWXKDVEAy0HJIByBEaaDliAzfQchq8AMEbbLHBA1AjPgA5AgSQI0IgOagLNwhzGjyKjkZMRm5ggtOQ4W1w7DRm0K3TnOFdsLlBGquy02pYdloOyw7kqOy0HJadpqwAlBU0asDEAjUqO5CjsgM5KjuSg4kXNGUFGDpBP8Fl5EbZBY0aocCx06hBt06TRgDSCIM0NmUHalR2IEdlR3JQdiCHT_00ZQWgrKBRg8oOKIvODWASlR1gEpUdyNHE05SVYGok_YKckRtllzRqJHigkzRqwK1LmjQSkEYapLEpO1CjsgM5KjuSg7IDOSq7pCkrAWUljRr0lg8oi84NYBK95wNMohd9IEcTT1NWomOn35ozcrPsNGoUeKBTNGqytz59-en_AAAA__9bzhJm

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryBRktlBKq3471NCtY4A_uJ59W6l-LFff34k3mdQP5cQwqQ36H2ckrVckk_j0Rdy2_t2M7jqD8nZdX8ynXwdnJOzlzWb3YrHzRMZja97Y_LhO3k6J_3htDeeFAuuBgNkcQQUVmkihvGDUBDeAgMKHCj4QCEACi2IKGQynQmlUlkseS6BfvIIYZPCYpWt8-LfEYVZKgWEz5Av8qWAEKbx3VKMRZwI6TWBQiLyeLEsj8nk4iGWm-7j5gkoTLJ4pULS8IqTR-s8JF0O0ZZCus5ftn_d9W5D5rGa7-_XZRBtIwoqj-8FhGxL_y5my2lMfjLm6z7rVSoTIUWyt1NUkNiSI3f9HKv5ROSjzGOVF5luMhHuuwMUluJHftZl5-_l4n5e_vX76qxy9ddr-RbXOpJ5mDbSzGOt6gCOnh3snc3qvzyr8fIeb3j-myhqELTtOCg_GdSBpMyRpLz-_Hmd-fsNL3gTUQyCXjgOyk8GdSAKdySKX3_-fp35B43yN-ffi2IQ9NJxUH4yqANRfEeiBPXnH9SZf6vxJpoYxOw4jclPxnQgSfAfutGRRGOhsnSlRK3m0yzuJJJ7sZuRStdyJm5kOiuP2X0clVz5K54Ile--5bsP_dXuqyJgfbhtA3dsYGaVm7X0NDMYGTeD2zZwxwZmVrkrIzugeZVu_kn7-nn7Wpjtz6xZpQMbwfUwIrgeRgTXw5jgCI0I3rIRXA8jguthRHA9jAmO0IjgbRvBL2wU1cOIonoYUVQPY4oiNKLopY2iehhRVA8jiuphTFGERhTt2CjKrHoCQiOSIjRiKUJjmmI41hXsyoJdW7CrC5Z9wa4wMKvGwA4qg5GtehqzVU9jtupp1FYEx2w1KUuHb2bSlkxpzFajvmSMY7YelAetrdH23a8AAAD__7tseyk=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryBRktlBKq3471NCtY4A_uJ59W6l-LFff34k3mdQP5cQwqQ36H2ckrVckk_j0Rdy2_t2M7jqD8nZdX8ynXwdnJOzlzWb3YrHzRMZja97Y_LhO3k6J_3htDeeFAuuBgNkcQQUVmkihvGDUBDeAgMKHCj4QCEACi2IKGQynQmlUlkseS6BfvIIYZPCYpWt8-LfEYVZKgWEz5Av8qWAEKbx3VKMRZwI6TWBQiLyeLEsj8nk4iGWm-7j5gkoTLJ4pULS8IqTR-s8JF0O0ZZCus5ftn_d9W5D5rGa7-_XZRBtIwoqj-8FhGxL_y5my2lMfjLm6z7rVSoTIUWyt1NUkNiSI3f9HKv5ROSjzGOVF5luMhHuuwMUluJHftZl5-_l4n5e_vX76qxy9ddr-RbXOpJ5mDbSzGOt6gCOnh3snc3qvzyr8fIeb3j-myhqELTtOCg_GdSBpMyRpLz-_Hmd-fsNL3gTUQyCXjgOyk8GdSAKdySKX3_-fp35B43yN-ffi2IQ9NJxUH4yqANRfEeiBPXnH9SZf6vxJpoYxOw4jclPxnQgSfAfutGRRGOhsnSlRK3m0yzuJJJ7sZuRStdyJm5kOiuP2X0clVz5K54Ile--5bsP_dXuqyJgfbhtA3dsYGaVm7X0NDMYGTeD2zZwxwZmVrkrIzugeZVu_kn7-nn7Wpjtz6xZpQMbwfUwIrgeRgTXw5jgCI0I3rIRXA8jguthRHA9jAmO0IjgbRvBL2wU1cOIonoYUVQPY4oiNKLopY2iehhRVA8jiuphTFGERhTt2CjKrHoCQiOSIjRiKUJjmmI41hXsyoJdW7CrC5Z9wa4wMKvGwA4qg5GtehqzVU9jtupp1FYEx2w1KUuHb2bSlkxpzFajvmSMY7YelAetrdH23a8AAAD__7tseyk=

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdF3Asko2Am0RJrUamMaEoMOOEyqckiJV5AoyewgQav-9ylJESOAv3gWyTHET_za3yPxvoH8swIPpv1h_8vM2oiV9W0y_mE99n89DO8HI6vxdTCdTX8Om9bHkm2-oNHYPxNrl_-03b02rcFo1p9M0xf3w6F1flHTBwLrKOSj4IVL8B6BAgEGBBwg4AKBDvgEYhHNuZSRSJe8ZcAg3ILXJrBcx5sk_dknMI8EB-8NkmWy4uDBLHha8QkPQi7sNhAIeRIsV9k2sVi-BGJ3t929AoFpHKylZ7XsdOfxJvGsO0ruGPjvBKJN8rHD4cNPO2sRyMXxJ_eIT0AmwTMHj76T_wvbqSEsuxj28KnNOhIhFzw8-pifktiSMyf-HsjFlCfj2KaF6cx2MfeOBQICK_47aWTBm5_F8nmxfzhcQ-EODodzDA53JvkoakWxTTvFazi7t3u0Ny1vAS1hgc1atnNFaTXidmuJyy7GrUBbWqm2rPwsWJlZOC3bvaI6GnFvaonLLsatQB1WqTpO-Vk4ZWbhtrL_qGupoxH3tpa47GLcCtRxKlXHLT8Lt8wsOq0riqMRtldDWHYxbAXauLV1rDO5JlzG0VryUg2qnZ6Mh888vykZbcScP4honm2TP44zLmsAIZdJ_pblD4N1_ioNWB7umsA9E5ga5aYdNU01rozpwV0TuGcCU6PchSs7oVmRbv9LO-r7dpQwPb6zdpF2TQRXw4jgahgRXA1jgiM0InjHRHA1jAiuhhHB1TAmOEIjgndNBL8xUVQNI4qqYURRNYwpitCIorcmiqphRFE1jCiqhjFFERpRtGeiKDXqCQiNSIrQiKUIjWmK4VhXMCsLZm3BrC4Y9gWzwkCNGgM9qQxatqppzFY1jdmqplFbERyzVacsnc5Mpy3p0pitWn1JG8dsPSkPSlv9909_AwAA__-KBI1m

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9v4kYUxd_7Kaz7lEiDYGYMIZYqZdVNVSSabAMPlVY8eGGaILHYtY0UNsp3rzBNABvf4_Gf7KPBP-b4-J7jMS8U_7sijya349vfps4mWjm_P9z_6Xy9_fvL-NPozrn4PJpMJ3-NL53_T3nen3Bx8XYsnO3-o-ftj0tndDe9fZjsvjh_wuWMBK2Dhbnzv5uYvK8kSZAiQZoEuSSoTzNBYRTMTRwH0e6UlxQYLZ7J6wlarsNNsvt4JmgeRIa8F0qWycqQR1P_28o8GH9hom6PBC1M4i9X6TJhtPzuR9ub5-0PEjQJ_XXsOZ3ubuX7TeI5N1LcKJq9Cgo2yWGFOPEfDXnyVZRX8XkZJ8v1POn2TyWcW-JAfds6T378dB45KFE2So79kI0aoisZIttwxC2UcvipzTqIFiYyi5MfS3-lUKzqYbEHFf22VJSw7KBiUEOFqCT0Dz9-mpjkPuzqjF_TbWi8o0L4NB6ToJX5J7lIL-Ly12j5-PR2cBi7wou7atbiu6AThF3dz9pwdu3hydrSInYlUtdVna6uUkRAx_sQDVovIhtHGrZEV7JEtuGJWyilZgnI6lXUoIoSlhVVkZ2K2lUkP7SKVPnhV2VmX3e6bpU6ADreb-RV63Vg4Yhs2BJdyRLZhiduoZSaQVTV66BBFSUsK6oDOxW160B9aB3o8sOvy8y-20nfJKzrAOh4v5HD1uvAwhHZsCW6kiWyDU_cQik1g6ir10GDKkpYVlQHdipq14H-0Dpwyw-_W2b2-50qZQBUvN_G69bLwMIP2aghupIhsg1H3EIpNUPoVq-CBlWUsKyoCuxU1K4C96f9Z3FG14OJw2Adm1L_SPR2V2YWj2bvVBxsorn5EgXzdJn94X3KpR8sTJzsv5X7g9F6_9VO4DEss7A8ht0TWNrBUtWir-vQalCH1pqnFeu45h3X7NJ9fmUelkA3T6teLfqqDq3BpLms4-Bm9y1glYUHLAwu-ooflAE_KUOWvubh6zrB5mEUbECDYPM0CjZPo2BL0KWoTPlaAdkGNAo3wFG6EQ4mHeAo35KvVInwXLtweC7jkq8XdOl8v0iQcplrGKtHME_DZzDA0UOYx-FTmMdhWvl6lUNgfK5frdLK0zCtPA7TCnA0sjwO05pr2RPjlQTbJ75lM3gurSpXNTZpVXzTKLB7U_w-BhgHaJRWhIO0AhylFeBw08yXrOoD43Mta5NWQKO0AhylFeFoZHkcpVXxW1g1BDjfshk8n1Z-F4sunW8a3QPvWrmmsUkroFFaEQ7SCnCUVoCjtGq-ZLUCxuda1uotl6fhay6Pw_dcgKMXXR5HadX8VlYj6_iWzeC5tGp-L5u99NnrL_8FAAD__yjAKic=

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9vok4QwN-_fwWZpzbfNbAL-IPkEnutlzPxak986KXhgcpeNbHCLZhIG__3i1ivRewOK8pbKfvZHWY-4-wrxH_m4IDbG_Sux9pSzLVvo-EP7aF3fze46t9qFzd9d-z-HFxqF29r0u2KVfpyqfXur3t3Y-1qMPj3eqVdubk1w9FNb6R9_aWlHhBYhAG_9Z95DM4DUCDAgIAJBCwgYINHIBLhhMdxKDZLXjOgH6zAMQjMFtEy2fzbIzAJBQfnFZJZMufgwNh_nPMR9wMudAMIBDzxZ_PsmEjMnn2RdlfpCxBwI38RO1pD35w8XCaO1mXgrQmEy-Rt-_ddH1Nt6sfT_H5dCt7aIxAn_hMHh67JcWHaimHSSmGyT8N832e5CEXABQ9yO3kbElty4Fu_-_HU5ckw0uleRcZpxJ0P9gCBOf-dXHTp5Rcxe5pmf3363e_fZKqk3g1FwoVO7f00_f_p_laJnB1Kx9umB4K4DRthpDNjP8EHj7dzx9PyZtESZumsoZtnaQGFQJvKgZ6yCWi9TUDraAIk-bsmaB7bBKx8cVmZ4poN3TqLhQqBtpQDPaWFrF4LWR0WIsnfWdg61kKzfHHNMsW1Gtk0Pr2FCoG2lQM9pYVmvRaadViIJH9nYftYC63yxbXKFNdunMVBhTA7imGe0kCrXgOtOgxEUr8zsHOKK-mB_Uc8jsJFzEvdNo1NwnjwxLcFiMOlmPA7EU6yY7aPw4zLbhkBj5PtW7Z96C-2rzYBlodbVWBKK9F2Jbojp6lCzpga3KoC7-VMlbYr0R05zfZp4yNt5mBjHzalsCWvliWFGZUfbVfpDzmM9IccxvoDoZH-QGikP5pV-kMOI_0hh7H-QGikPxAa6Y-W1NK2XNJ2lf7oVDFcDiOGy2HMcIRGDEdobAKojM3iL6nK3FSl0SGgNDmVcURzWpgiOVUpk4tO5WMEMZ0W5oiK6giNuI7QmOwYjtiO4ZjuhRmqpLucxnSX06juCI7pjuCY7oVBmte9iehemClKuhdmipLuchrTXU6juiM4pjuCY7oX5qmS7nIa011Oo7ojOKY7gmO6F6Zq_q5tyHVnhdki1d1b__c3AAD__2oDeK0=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMx98xFKlpBuqRqIhBS62WnHhhWmCxGJqGylslP9eYQIEG79nBhvukthn5vjMex7ZeWPxfzPms0Gn2_kydJbRzPmj3_vL-db5-tS9e3h0ru4fBsPB391r5-rjntXmjtfVz2un8_VL52m4u_Tq3A0Orvf6952-8_s_zmrEXDYPJ_ox-KFj5n9jnLlMMJdJ5jLFXNZgI5ctonCs4ziM1re8pYKHySvz6y6bzhfLZP3nkcvGYaSZ_8aSaTLTzGfD4PtM93Uw0ZFXZy6b6CSYztJtFtH0RxCtbl9XP5nLBotgHvtOzVvv3FsmvnMr2OjdZeEy2S8fJ8GzZj5_d80t3E_jZDofJ17jcP9bnll_L_m-cl6C-OXI_XsPwsbD5xi4bQ5Zn3sP8qQceLVBqEIT-3WW8zCa6EhPDlZKVym0KerA5t5C41wWUFJ7C80SFtyTXP4ZxC8DnfQWnswkNVwttL8lwF23y1w20_8mV7f8-rdo-vyS_mQwXi2b8RqEUaIjT-Yi-7Vw_bZBZsfi-Fj0iInHsBYuPFXPBnx0-5uD7blFgw0K7ImaJ61RBkzsBrN5RpTZBGGfhCnMTJPg1UahCk2UJAk_EWYVWkBJFcHMzkJpmPFLwAyM1xZmuchMYSbMSyRMOiRrnrKmCTCxm4zWGWliEQS3T8KUJqZJ8GqjUIUmSlZZnEiTCi2gpIpoYmehNE3EJWgCxmtLk1xkpjSR5iWSJh1StfRjyI4mwMRuMtpnpIlFENw-CVOamCbBq41CFZooWWV5Ik0qtICSKqKJnYXSNJGXoAkYry1NcpGZ0kSZl0iZdKhRs2YJsLCbi5szssQiBm6bgylJTHPg1QahCk2UrLE6kSQVWkBJFZHEzkJpkqhLkASM15YkuchO-ZfNkfX7Ol6E81gb_Temvg5MT5715gDicBmN9VMUjtNtNr_2Ul36h4mOk81VvvnlYb65tDb4WcyzYv5ZrA7E3E7MZRm14KXUN2XUskWrBZm4pBOX5NYNemdazMF50WohyqhlvZS6TasVmXiTFjcsxCIrbpLiFn3WLVIMnrlNihUo9g1NhTrAQg4qVlyg1RAMtBySAcgRGmg5YgPPoeUweAGCz7HFBg9AjfgA5AgQQI4IgeSgLjxHmMPgUXQ0YjLyHCY4DRneBMdOYwY9Os0Z3gab50hjVXZaDctOy2HZgRyVnZbDstOUFYCygkYNmFigRmUHclR2IEdlR3Iw8YKmrABDJ-g3uIw8V3ZBo0YocOw0atCj06QRgDQiRxqbsgM1KjuQo7IjOSg7kMO3fpqyAlBW0KhBZQeURecGMInKDjCJyg7kaOJpykowNZL-QM7Ic2WXNGokeKGTNGrAo0uaNBKQRuZIY1N2oEZlB3JUdiQHZQdyVHZJU1YCykoaNegrH1AWnRvAJPrOB5hEH_pAjiaepqxEx05_NWfk-bLTqFHghU7RqMk--uj9l_8DAAD__0CZB6Q=

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lkFv2jAYhu_7FdZ3aiWjYCfQEmkSXcs0JFY64NCpyiElXkGiJLOD1LTiv0-Eai0B_MXz6lspfuzXnx-J9wXU7wWEMO4NepcTspIL8nU0_E7uerc3g4v-NTm56o8n4x-DU3LyuqbYrngqnslwdNUbkS8_SXFKereXvZsJuRgMkJURUFimibiOH4WC8A4YUOBAwQcKAVBoQUQhk-lUKJXKzZKXEugnTxA2KcyX2Srf_DuiME2lgPAF8nm-EBDCJL5fiJGIEyG9JlBIRB7PF-UxmZw_xrLoPhXPQGGcxUsVkoa3OXm4ykPS5RCtKaSr_HX7t13vCzKL1Wx3vy6DaB1RUHn8ICBka_pvMVtOY_KjMd_2WS1TmQgpkp2dog2JLTlw12-xmo1FPsw8VnmRSZGJ8J04QGEhfuUnXXb6Wc4fZuVff-_NKvd-u5NvcacDga_TRpp5rFW9_cGzg52zWf1nZzWe3eMNz_8QPw2Cth0H5UeDOjCUuTCU1x8-rzN8v-EFH2KJQdAzx0H50aAOLOEuLPHrD9-vM_ygUf7U_H9LDIKeOw7KjwZ1YInvwpKg_vCDOsNvNT7EEYOYHacx-dGYDgwJXPehA3FGQmXpUolabae5uZBIHsR2QCpdyam4kem0PGb7cVhy5S93IlS-_ZZvP_SX2682AevDbRu4YwMzq9yspaeZwci4Gdy2gTs2MLPKXRnZHs2rdPM97evn7WthtjuzZpUObATXw4jgehgRXA9jgiM0InjLRnA9jAiuhxHB9TAmOEIjgrdtBD-zUVQPI4rqYURRPYwpitCIouc2iuphRFE9jCiqhzFFERpRtGOjKLPqCQiNSIrQiKUIjWmK4VhXsCsLdm3Bri5Y9gW7wsCsGgPbqwxGtuppzFY9jdmqp1FbERyz1aQs7b-ZSVsypTFbjfqSMY7ZulcetLZG609_AgAA__-iT3W3

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mNFvolgYxd_3ryDfU5tg9N4L1pJs0tmpm23i1q76MJuJD4zcbU0cYQGTOk3_9424oxXKd7iAfWuVH_dw-M7h4gsl_67Io-lwNPw8szbxyvp9Mv7T-jr88jD6dHdvXdzeTWfTv0aX1sX_x2z3Rzxvf1jjye1wYv32t7W9tIZfPg8fZuCoOdm0DgN973_XCXlfSZBNkmxSZJNDNrk0tymKw4VOkjDeHfKSAXfBM3k9m5braJPuPp7btAhjTd4Lpct0pcmjmf9tpSfaD3Tc7ZFNgU795SpbJoqX3_14e_O8_UE2TSN_nXhWp7tbebxJPetG0vzVpnCTHk-fpP6jJk-82tUl3C6TdLlepF33dP0bkTv_Efm2tZ785Omd448apImGtzaI9nxQtXwQ7RrhlIo4nmezDuNAxzo4OVN2llKZsgdkHiW455KAnDpK6DeQYNdS-YefPE11Oo66KufUbBtp72f4P41GZNNK_5Ne3IjLX-Pl41P212G8yq_pql1b78NOGHWVm7_6d9cenKwtDOJVIV1d2ekq454BIg5T0z9jz5gY0aYTqpYTol0rnFIRDWMuajZNixKQU2VNYyahcdOIj2gaWX3IZZUZV52uY5x2IOJw567OmHYDI0SbTqhaToh2rXBKRTSMmqyZ9hYlIKfK0m4moXHa5UekXVUfclVlxp1OttM3SzsQcbhzgzOm3cAI0aYTqpYTol0rnFIRDaOmaqa9RQnIqbK0m0lonHb1EWl3qg-5U2XG3Y5x1oGEw327PmPWDWwQ7fmgavkg2jXCKRXRMGZOzaS3KAE5VZZ0MwmNk-589O8F78iZ6CQK14mu9GtAb3dBOnjUe4OScBMv9EMcLrJl9v-OMy77INBJuv9W7P-5W--_2gl8C4s8LN7CzgkszGAhG9HXTWjZb0IrxdOSdVzxjit2aZdfmYcF0M3TsteIvmpCKzBpDus4uNmuASzzcJ-FwUVf8YPS5ydlwNLXPHzdJNg8jIINaBBsnkbB5mkUbAG6FJUpXysg24BG4QY4SjfCwaQDHOVb8JUqEF5oFw4vZFzw9YIune8XAVIuCg1j9AjmafgMBjh6CPM4fArzOEwrX69iAIwv9KtRWnkappXHYVoBjkaWx2FaCy17YrwUYPvEt2wOL6RVFqrGJK2SbxoJdm-S38cA4wCN0opwkFaAo7QCHG6a-ZKVLjC-0LImaQU0SivAUVoRjkaWx1FaJb-FlQOA8y2bw4tp5Xex6NL5plE98K5VaBqTtAIapRXhIK0AR2kFOEqr4ktWSWB8oWWN3nJ5Gr7m8jh8zwU4etHlcZRWxW9lFbKOb9kcXkir4vey-Uufv_7yXwAAAP__KKkGIA==

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lm9P4kwQwN8_n2IzrzTPkna3LX-amOijNZLwgAck58XjRaV7QoK0ty0JaPzulxY5heJOl0rfid1fh5n5DbMvEP-egQsDr-NdDslCzsh1v_c_uffubjsX7S45uWoPhoNvnVNy8nZmuT6xXD2T7zde3yNL8nNhmtaY8FPi3V16t0Ny0emg58VZCvT6V16f_PeDLEdAYR4Gous_iRjce2BAgQMFCyjYQMGBEYVIhmMRx6FMj7xkQDtYgmtSmM6jRZL-e0RhHEoB7gsk02QmwIWh_zATfeEHQhomUAhE4k9nWZhITp98uTpfrp6BwiDy57FLakYa-Xo6S4R0yTn7m6Lruu3usAkUeoskfQKjVwrhInmL_R7yYUUmfjzZDpadH1GIE_9RgMte6WE5OAfnkJb9a5Pgnybx_p7FPJSBkCLYetMoJbEjeypx48eTgUh6kcF2mjlcRcL9YCFQmIlfyck5Oz2T08dJ9teneb_nZOk0ZhDKREiDObtl-vfT99sFaravHG8v3fMlumEtjAxu7hZ4b3hnKzwr7h0r4J3Ba4ZV_fRoZFEvkcWx54dVOz-sivlBWrOZn_qh88OLt54Xab1VM-zqBdbIolEii2MLzKsVmFchMNKajcCNQwW2irfeKtJ6u5bdECoWWCOLZoksji2wVa3AVhUCI63ZCNw8VGC7eOvtIq13atXrq5FD6-Acji2vXa28dhXyIo3ZyNv6iuv3nvf3RRyF81gUulmbacFE8CjWDYjDhRyLWxmOszDrj72My65FgYiT9VO-_tCerx-lX7A43CgDM1aKdkrRLTXNNGrG9eBGGXinZrq0U4puqWm-S5sfaWsLNndhSwnb6m7ZSpgzdWinzHyoYWQ-1DA2HwiNzAdCI_NRLzMfahiZDzWMzQdCI_OB0Mh8NJSWNtWSNsvMR6uM4WoYMVwNY4YjNGI4QmMbQGdt5n9JdfamLo0uAa3NqY0jmrPcFtlSlXG16Ey9RhDTWW6P6KiO0IjrCI3JjuGI7RiO6Z7boVq6q2lMdzWN6o7gmO4IjumeW6TbutcR3XM7RUv33E7R0l1NY7qraVR3BMd0R3BM99w-1dJdTWO6q2lUdwTHdEdwTPfcVt2-a5tq3Xlutyh1H73-8ycAAP__vDHOWQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v2kgYhe_3V1hzlWiNYD74iKVK6TZURWJDFpC2qy4XFGYTJIpZ20jQKP-9AgIEjN8z4zG5S8Bn5vjMex7ZPLP4_ykLWK_Zbn7qe4to6n3udv70vjW_PrQ_tu69q7tWr9_7q33tXb1es9xesVz99P7-0uw2vaX376JSkSNPXHvNr5-aD314rf6wvrjTvWt2vT_-8ZYD5rNZONb3wx86ZsE3xpnPBPOZZD5TzGdVNvDZPApHOo7DaH3J80bQGi9ZUPHZZDZfJOuPBz4bhZFmwTNLJslUs4D1h9-nuquHYx2VK8xnY50MJ9PNNvNo8mMYrW6Xq5_MZ735cBYHXqm83vnzZJroKPBu-f72giBo3fcbzGedRbL-hg1efBYuksPecTJ81CzgL765v7tJnExmo6RcPTaXWv8g-b7ynobx05nrDx6EjYe3GfH8Ia3P1TwlmSslXmxMKtPEYZ3FLIzGOtLjo5U2q2TaFBVg82CheikLKKmDhZqDBT-Xyy_D-Kmnk868LE-S6q_mOtiR5GO7zXw21f8lV7f8-kM0eXza_GUwXnWb8eqFUaKjskxF9nvm-g2DzM7F8broGRP3YSmcl1XlNOCz298cbc8t-m1Q77IolWWxFAQO91NbuyAFbVJyicmFg6Y58WKDUpkmHCHEc3KwQAsoqSwO2llw5iB_Dw6C8dpxMBWZKQeFecWEScNkqayKBRFwuB-b-gVBZJESd4nJBUSmOfFig1KZJhwpIHKCqEALKKksENlZcAaReA8QgfHagSgVmSmIpHnFpEnDVGnzglYgiIDD_dg0Lggii5S4S0wuIDLNiRcblMo04UgBmRNEBVpASWWByM6CM4jke4AIjNcORKnITEGkzCumTBpWLRWLIeBvPzQ3F8SQRUY8f0guEDJNiRcbk8o04UgAlRNCBVpASWVByM6CM4TUe0AIjNcOQqnI8vw8dWb9ro7n4SzWRr88VdaB6fGj3h5AHC6ikX6IwtFmm-2_nY1u88FYx8n2W779pzXbfrU2-FbMT8X8rVgdibmdmEsXteBO6hsXtazTakEmLunEJbl1ld6ZFnNwXrRaCBe1rDipG7RakYnXaHHVQixOxTVSXKfPuk6KwT03SLECxb6hqVABWEhBxYoLtBqCgZZDMgA5QgMtR2zgKbQcBy9A8Cm22OABqBEfgBwBAsgRIZAc1IWnCHMcPIqORsyJPIUJTkOG18Cx05hBt05zhjfA5inSWJWdVsOy03JYdiBHZaflsOw0ZQWgrKBRAyYWqFHZgRyVHchR2ZEcTLygKSvA0An6Ce5Eniq7oFEjFDh2GjXo1mnSCEAakSKNTdmBGpUdyFHZkRyUHcjhUz9NWQEoK2jUoLIDyqJzA5hEZQeYRGUHcjTxNGUlmBpJvyCfyFNllzRqJHigkzRqwK1LmjQSkEamSGNTdqBGZQdyVHYkB2UHclR2SVNWAspKGjXoLR9QFp0bwCR6zweYRC_6QI4mnqasRMdOvzWfyNNlp1GjwAOdolFzeuuDl99-BQAA__9VD11Q

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElt9u2jAUh-_3FNa5KlpQYifhT6RKdG2qIjHoAGmdulykxCtIlGROkKAV7z4BZRRCfWJS0rtS8tk5Pt-P4xeI_47BgZ7bci_7ZCrG5Lrb-U7u3bvb1kWzTc6umr1-70erRM5en5mvn5jNn8nPG7frkhn5PTUMk58TWiLu3aV72ycXrRYKDIhZIp3uldsl336RuQcaTMKAt_0nHoNzDxQ0YKCBCRpYoIENngaRCAc8jkOxfORlBTSDGTiGBqNJNE2W__Y0GISCg_MCySgZc3Cg7z-MeZf7ARe6ARoEPPFH49U2kRg9-WLemM2fQYNe5E9ih5T15c7Xo3HChUMadFui4zjNdr8GGnSmiUMaDLyFBuE0ed18u-fDnAz9eLi7W4OCt_A0iBP_kYNDF9pxRdhHFzEg5sfWwN6tYbvOdBKKgAse7KzkLUnskQMHcePHwx5POpFO95rZn0fceSMhaDDmf5KzBi2di9HjcPXX_7rpXt3bmkyVvvRCkXChU3v_mL6-u76V4cwOHcfrogdeoh2Ww0hnxv4BH9ze3tmeZteOZtBOZ2Xd_IT0KJRRyVHGifNDi80PLSI_SGc2-akcmx-WvfMsS-fNsm59gsAKZVRzlHFigVmxArMiBEY6sxG4eqzAZvbOm1k6b5VXF4SiBVYoo5ajjBMLbBYrsFmEwEhnNgLXjhXYyt55K0vn7fIn6KtQRP3oIk4sr1WsvFYR8iJ92chb_4jr94H1uzyOwknMM92sjeWB8eCRrxsQh1Mx4LciHKy2WX_srLjVtSjgcbL-lq0_NCfrr5YvmB2u5oEpzUXbuei6nKYKZ8bU4GoeeO_MVGk7F12X02yfNt7S5g5s7MOmFLbk3bKkMKPyre08-ZDDSD7kMJYPhEbygdBIPip58iGHkXzIYSwfCI3kA6GRfFSlltbkktby5KOex3A5jBguhzHDERoxHKGxCaAyNtO_pCpzU5VGh4DS5FTGEc1paorsqEqZXHQqHyOI6TQ1R1RUR2jEdYTGZMdwxHYMx3RPzVAl3eU0prucRnVHcEx3BMd0Tw3SXd0riO6pmaKke2qmKOkupzHd5TSqO4JjuiM4pntqnirpLqcx3eU0qjuCY7ojOKZ7aqru3rUNue4sNVukunuLL_8CAAD__7KvzmY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v2kgYhe_3V4zmKtEawXzwEUuV6DZURWJDFpC2qy4XFGYTJIpZ20ihUf57BQQINn6PhzG5S8DHc-bMex7ZPPPo_xn3eb_VaX0asGU4Y5973T_Zt9bX-87H9h27um33B_2_Otfs6vWa1faKp9VP9veXVq_Fnti_y0pFmQ9MXLPW10-t-wG8eMzUNev2bls99sc_bDXkHp8HE3M3-mEi7n_jgntcco8r7nHNPV7lQ48vwmBsoigI15c8bwTtyRP3Kx6fzhfLeP3x0OPjIDTcf-bxNJ4Z7vPB6PvM9MxoYsJyhXt8YuLRdLZZZhFOf4zCVfNp9ZN7vL8YzSOflcrrlT9PZ7EJfdYUh-35vt--GzS4x7vL2GdNyYcvHg-W8WHxKB49GO6LFy-_wdtpFE_n47hcPXbXFIn7HyTfV-xxFD2euP7gQdp4eBuSOD-lMVP5Q1JnhSSKTUlnmjjcZzkPwokJzeToTpu7ZNqUFWDzYKF6KQsoqYOFmoMF7yyXX0bRY9_E3UVZJZIarBbG34HkY6fDPT4z_8VXTXH9IZw-PG7-2o9X9p7qNuPVD8LYhGWViuz3zPs3cmR2Ko7Xm54wcReUgkVZV5IBn1z-5mh5YVHvHO0uy1JZFUxBYHE_trULUtAmJpecHDiYNyZRbE4604QjhMSZHCzQAkoqi4N2Fpw5KN6Dg2C8dhxMRZaXgzJ_w2SegqlSWRcMImBxPzf1C4LIIibhkpMDiPLGJIrNSWeacKSAPBNEBVpASWWByM6CM4jke4AIjNcORKnI8oJI5W-YylMwXdq8nxUJImBxPzeNC4LIIibhkpMDiPLGJIrNSWeacKSAOhNEBVpASWWByM6CM4jUe4AIjNcORKnI8oJI52-YzlOwaqlgDAGD-6m5uSCGLEIS56fkAKG8IYliU9KZJhwJoM-EUIEWUFJZELKz4Awh_R4QAuO1g1AqsnN-njpx_56JFsE8Mrl-eaqsAzOTB7M9gChYhmNzHwbjzTLbf7sb3eaDiYni7bdi-097vv1qbfCtWCTF4q1YH4mFnVgoF7UUTuobF7Wq02pJJq7oxBW5dJVemRYLcF60WkoXtao4qRu0WpOJ12hx1UIsk-IaKa7TZ10nxWDPDVKsQbFvaCpUABZSULHiAq2GYKDlkAxAjtBAyxEbRAotx8FLEHyKLTZ4AGrEByBHgAByRAgkB3URKcIcB4-ioxGTkKcwIWjIiBo4dhozaOs0Z0QDLJ4ijVXZaTUsOy2HZQdyVHZaDstOU1YCykoaNWBigRqVHchR2YEclR3JwcRLmrISDJ2kn-AS8lTZJY0aqcGx06hBW6dJIwFpZIo0NmUHalR2IEdlR3JQdiCHT_00ZSWgrKRRg8oOKIvODWASlR1gEpUdyNHE05RVYGoU_YKckKfKrmjUKPBAp2jUgK0rmjQKkEalSGNTdqBGZQdyVHYkB2UHclR2RVNWAcoqGjXoLR9QFp0bwCR6zweYRC_6QI4mnqasQsdOvzUn5Omy06jR4IFO06hJbn348tuvAAAA__-0tF1d

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6xz1UpGwU6gJdIkqo5pSKx0hYtKVS5S4hUkSjI7kUir_vcpSbuWj_nEM2SXIXns1z6PxPsM6tcSfJgMRoPLKcnkkny9GX8nd4Pb69HF8IqcfBlOppMfo1Py-smakrz6Zp0_kcHt5eB6Si5Go7f3OSXrP-8DoLCKI3EVPgoF_h0woMCBggsUPKDQgYBCIuOZUCqWxSfPJTCM1uC3KSxWSZYWPwcUZrEU4D9DukiXAnyYhvdLcSPCSEinDRQikYaLZblNIhePocz76_wJKEyScKV80nKKncdZ6pM-o30OwQuFOEtfd3hf-D4n81DNN5d8QwIKKg0fBPjshf5b2I5hWE77zDYs_2vY96WyVSwjIUW0sVhQkNgne078LVTziUjHicO2pjPNE-F_UAcoLMXP9KRMffpZLh7mbw-6gb0fzrU43J7kV3ErThzW2b6GvXt7G3uz-hawGhY4vOW4R5TWIG7XOO7htWXNassa1ZbXnwWvMwu35XhHVMcg7plx3MOrw5tVhzeqjlt_Fm6dWXit8j_qWOoYxD03jnt4ddxm1XEbVcerPwuvziw6rSOKYxC2Zxj28Np4zWrj_beOtSfXjVBJvFKiVoNqFycT0YOobkrFmZyJaxnPym2qx3HJlQ0gEiqt3vLqYbiqXhUB68NdG7hnAzOr3Kyjp5nBlXEzuGsD92xgZpV768p2aL5Ntz_Srv6-XS3MNu-svU17NoLrYURwPYwIrocxwREaEbxjI7geRgTXw4jgehgTHKERwbs2gp_ZKKqHEUX1MKKoHsYURWhE0XMbRfUwoqgeRhTVw5iiCI0o2rNRlFn1BIRGJEVoxFKExjTFcKwr2JUFu7ZgVxcs-4JdYWBWjYHtVAYjW_U0ZquexmzV06itCI7ZalKWdmdm0pZMacxWo75kjGO27pQHra3By6ffAQAA__-YZoZN

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv2kgUhd_3V1j3qZUGwcwYQiytlKpltZHYJBt4qFTx4MJsgkQxaxsJGuW_rzAbCHZ8z4yN00cwn-f4-J7jMU-U_LuggEaD4eDz2FvHC--P-9u_vG-Dr3fDT9c33ocv16Px6O_hR-__n2yEt93_ZrP96Q2-fh7cjV-ObYW3ORybkKBlNDM34Q-TUPCNJAlSJEiTIJ8EdWkiaBVHU5MkUbz7yVMGXM82FHQEzZerdbr7eiJoGsWGgidK5-nCUEDj8PvC3JtwZuJ2hwTNTBrOF9kyq3j-I4y3V5vtTxI0WoXLJPBa7d3Kt-s08K6kuFI0eRYUrdPjCkkaPhgK5LOwV_FlnqTz5TRtd08lvLXEkfq-9R7D5PFt5KhEuSh57Yd0NUSJK1lqiK5kiGzCEb9UyvFU62UUz0xsZicny85SKlZ1sNijim5TKiwsO6ro1VAhKgn9M0weRya9XbV1zq_xdmWClyr4NBySoIX5J_2QXcHH3-P5w-PLB7sQXpzX4puoFa3aupu34c21-ydrS4fYWaSurVptXaWIgI7DEPUaLyIXR9wtcagiW0tkE574pVJqloCsXkVnVGFhWVkVuamoXUXyXatI2Q-_spl93Wr7VeoA6DjcyIvG68DBEeluiUMd2Foim_DEL5VSM4iqeh2cUYWFZWV14Kaidh2od60DbT_82mb2_Vb2JuFcB0DH4Ub2G68DB0ekuyUOdWBriWzCE79USs0g6up1cEYVFpaV1YGbitp1oN-1Dnz74fdtZr_bqlIGQMXhNl42XgYOfkhXQxyqwNYQ2YQjfqmUmiH0q1fBGVVYWFZWBW4qaleB_8v-s3hD171JVtEyMVb_SHR2V2ZmD2bvVBKt46m5i6Nptsz-423GZV_MTJLuj8r9h-vl_tBO4GtY5mH5GvZPYOkGS1WLvqxDq14dWmueVqzjmndcs0t3-ZV5WALdPK06teiLOrQGk-azjoOb3XWAVR7usTC46At-UHr8pPRZ-pKHL-sEm4dRsAENgs3TKNg8jYItQZeiMuVrBWQb0CjcAEfpRjiYdICjfEu-UiXCC-3C4YWMS75e0KXz_SJBymWhYZwewTwNn8EARw9hHodPYR6HaeXrVfaB8YV-dUorT8O08jhMK8DRyPI4TGuhZU-MVxJsn_iWzeGFtKpC1bikVfFNo8DuTfH7GGAcoFFaEQ7SCnCUVoDDTTNfsqoLjC-0rEtaAY3SCnCUVoSjkeVxlFbFb2FVH-B8y-bwYlr5XSy6dL5pdAe8axWaxiWtgEZpRThIK8BRWgGO0qr5ktUKGF9oWae3XJ6Gr7k8Dt9zAY5edHkcpVXzW1mNrONbNocX0qr5vWz-0ifPv_0XAAD__6dTIw4=

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v4jgQwN_vU1jzVHRGwU7Cn0gntddyOiS2dAkPXVV5SIm3IFGSdYJEWvW7rwhlaQj1xITmDYp_48nMbzp5hfjXAhxw-8P-9YSs5IL8Nx59Iw_9-7vh1eCWXNwM3In7fdggF-9n1tsT6_SFjMY3_TH59wdJG6R_f92_m5Cr4fDPyZRcuUePvzT2n9ceUFiGgbj1n0UMzgMwoMCBggkULKBgg0chkuFUxHEoN0deM2AQrMFpUZgvo1Wy-bNHYRpKAc4rJPNkIcCBif-4EGPhB0IaLaAQiMSfL7JrIjl_9mV6uU5fgIIb-cvYIU1jc_NolTjkkoH3RiFcJe_h91EfUzLz41k-XnbeoxAn_pMAh73R09K0NdPkldLkn6a5j7NahjIQUgS5SN6GxI4cedb__XjmimQUGeygI5M0Es4HkYDCQvxMLi5Z4x85f5plnz5tz_6ZTJ3Su6FMhDSYfVimvz-Nb5Wo2bFyvAc9ksRt2Awjg7cOC3z0ejt3PStvFithlsGbhvklI6CRaFs70XMOAat3CFgdQ4AUfzcE7VOHgJdvLi_TXLNpWF9ioUaiHe1Ez2khr9dCXoeFSPF3FnZOtdAs31yzTHOtZraNz2-hRqJd7UTPaaFZr4VmHRYixd9Z2D3VQqt8c60yzbWbX-KgRpo9zTTPaaBVr4FWHQYipd8Z2DvHK-mR-GMRR-EyFqXeNlubgongSWwbEIcrORV3Mpxm12y_jjIue8sIRJxsf-XbL4Pl9qdNguXhThWYsUq0XYnuqWmmUTOuB3eqwAc106XtSnRPTfNDuvWRNnNw6xA2lbCl7palhDlTX21XmQ81jMyHGsbmA6GR-UBoZD7aVeZDDSPzoYax-UBoZD4QGpmPjtLSrlrSbpX56FUxXA0jhqthzHCERgxHaGwD6KzN4n9Snb2pS6NLQGtzauOI5qywRXKqMq4WnanXCGI6K-wRHdURGnEdoTHZMRyxHcMx3Qs7VEt3NY3prqZR3REc0x3BMd0LizSvexvRvbBTtHQv7BQt3dU0pruaRnVHcEx3BMd0L-xTLd3VNKa7mkZ1R3BMdwTHdC9s1fy7dkutOy_sFqXu3ttfvwMAAP__deR-jA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjmA8-YqlS0g1VI9GQAhdbrbjwwjRBYjG1jQSJ8t8rYIHgwe-ZwSZ3CfjMHJ95zyObN5b8N2UB67c77S8DbxFPvT963b-8b-2vT527h0fv6v6hP-j_3bn2rn5es9xesVy9et3efbvn_f6Pt7r22l-_tJ8G-6tW3l3_5KWv14e_l0Pms1k01o_hD52w4BvjzGeC-Uwynynmszob-mweRyOdJFG8vuRtI3gYL1lQ89lkNl-k64-HPhtFsWbBG0sn6VSzgA3C71Pd0-FYx9Ua89lYp-FkutlmHk9-hPHqdrl6ZT7rz8NZEniV6nrn7iINvFvOhu8-ixbpYfkkDZ81C_i7b2_hfpKkk9kordaP9zfWP0i-r7yXMHk5cf3Bg3Dx8DEG7pqDyM1BnpUDLzcIlWvisM5iFsVjHevx0UqbVXJtihqwebBQv5QFlNTBQqOABf8sl3-GyUtfp915VWaSGqzmOtjB4K7TYT6b6n_Tq1t-_Vs8eX7Z_GVRs6bLePWjONVxVRqR_Zq7fssis1Nx_Fz0hInHqBLNq6qWDfjk9jdH23OHBlsUuCoqVemMMmBiP5iNC6LMJQj3JGxhZpsELzcKlWuiIEn4mTAr0QJKKg9mbhYKw4x_BszAeO1gZkRmCzNhXyJh0yFZqSpnmgAT-8loXpAmDkFw9yRsaWKbBC83CpVromCVxZk0KdECSiqPJm4WCtNEfAZNwHjtaGJEZksTaV8iadMhVdm8DLnRBJjYT0brgjRxCIK7J2FLE9skeLlRqFwTBassz6RJiRZQUnk0cbNQmCbyM2gCxmtHEyMyW5oo-xIpmw7VK84sARb2c3FzQZY4xMBdc7AliW0OvNwgVK6JgjVWZ5KkRAsoqTySuFkoTBL1GSQB47UjiRHZOT_ZnFi_p5N5NEu01a8xtXVgevystweQRIt4pJ_iaLTZZvtvd6PbfDDWSbr9lm__eZhtv1ob_CjmWTH_KFZHYu4m5rKIWvBC6psiatmk1YJMXNKJS3LrOr0zLebgvGi1EEXUslZI3aLViky8QYvrDmKRFTdIcZM-6yYpBvfcIsUKFPuGpkINYMGAihMXaDUEAy2HZAByhAZajtjADbQcBy9A8AZbXPAA1IgPQI4AAeSIEEgO6sINwhwHj6KjEZORG5jgNGR4Axw7jRl06zRneAtsbpDGqey0GpadlsOyAzkqOy2HZacpKwBlBY0aMLFAjcoO5KjsQI7KjuRg4gVNWQGGTtBPcBm5UXZBo0YocOw0atCt06QRgDTCII1L2YEalR3IUdmRHJQdyOFTP01ZASgraNSgsgPKonMDmERlB5hEZQdyNPE0ZSWYGkm_IGfkRtkljRoJHugkjRpw65ImjQSkkQZpXMoO1KjsQI7KjuSg7ECOyi5pykpAWUmjBr3lA8qicwOYRO_5AJPoRR_I0cTTlJXo2Om35ozcLDuNGgUe6BSNmuytD99_-T8AAP__2B4Ngw==

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk9v4joQwO_vU1hzKnpGiZ2EP5Ge1L6W1SKxpQscuqpySIm3IFGSdYIErfrdV4QiGkI8MWlzaxr_7MnMbxi_QvxnAS6Me4Pe9YSs5IJ8Gw1_kIfe_d3gqn9LLm7648n456BBLt7XrHcr1psXMhzd9Ebk_19k0yC9--ve3YRcDQbqlZS8NA6Paw8oLMNA3PrPIgb3ARhQ4EDBAgo2UHDAoxDJcCriOJTbJa8p0A_W4JoU5stolWz_7VGYhlKA-wrJPFkIcGHiPy7ESPiBkIYJFAKR-PNFekwk58--3FyuNy9AYRz5y9glTWN78nCVuOSSgfdGIVwl79sfdn3ckJkfz7L7pes9CnHiPwlw2Rs9L0yn1jB5YZiHfVbLUAZCiiCzk7clsSUnvvW7H8_GIhlGBjuqyGQTCfeDRkBhIX4nF5es8Z-cP83Svwq_-_BNlk7qx6FMhDSYc5ymfwv3t0vk7FQ63jc9EcRt2Awjg5vHCT55vJM5npU3i5Uwy-BNw_qSFtAItFVzoLww0BqagNXRBEjy903QOrcJePni8jLFtZqG_SUWagTarjlQXhhoDRbyOixEkr-3sH2uhVb54lplims302n8-RZqBNqpOVBeGGgNFlp1WIgkf29h51wL7fLFtcsU12l-iYMaYXZrDZMXhlmDgXYdBiKp3xvY_Ywr6Yn9RyKOwmUsSt02zW3CRPAkdgWIw5WcijsZTtNjdo_DlEtvGYGIk91bvnvoL3evtgGWh9tVYMYq0U4luqummUbOuB7crgIf5UyXdirRXTXNj2nzI21lYPMYtpSwra6WrYQ5Ux_tVOkPNYz0hxrG-gOhkf5AaKQ_WlX6Qw0j_aGGsf5AaKQ_EBrpj7bS0o5a0k6V_uhWMVwNI4arYcxwhEYMR2hsAuiMzfwvqc7c1KXRIaA1ObVxRHOWmyIZVRlXi87UYwQxneXmiI7qCI24jtCY7BiO2I7hmO65Gaqlu5rGdFfTqO4IjumO4JjuuUGa1b2F6J6bKVq652aKlu5qGtNdTaO6IzimO4JjuufmqZbuahrTXU2juiM4pjuCY7rnpmr2rm2qdee52aLU3Xv7528AAAD__6Lfff8=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMx98xFKlbDdUjURDClxsteLCC9MEicXUNhIkyn-vgBCCB7_HYxvuQvCZOT7znkc2ryz-b8Z8Nuh0O1-HzjKaOX_0e3853zvfHrtf7h-cq7v7wXDwd_fauXq_ZrW7YrV-cXr9u07f-f0fZ33tdL597TwO6atc5-X68HE1Yi6bhxP9EPzUMfO_M85cJpjLJHOZYi5rsJHLFlE41nEcRptLXreC-8mK-XWXTeeLZbL598hl4zDSzH9lyTSZaeazYfBjpvs6mOjIqzOXTXQSTGfbbRbR9GcQrW9X6xfmssEimMe-U_M2O_eWie_ccjZ6c1m4TA7Lx0nwpJnP39z8Fu6mcTKdjxOvcby_sf5B8mPtPAfx84nrDx6EjYfPMfDqcpCFcuDVBqEyTRzWWc7DaKIjPTlaabtKpk1RBzYPFhrnsoCSOlholrDgFnL5ZxA_D3TSW3gyldRwvdD-HgVful3mspn-N7m65de_RdOn5-1fOcarZTNegzBKdORJI7JfM9dv58jsVBzvi54w8RDWwoWn6umAT25_c7Q9t2hwjgJ7ouZJa5QBEx-D2TwjymyCqDIJWSgJXm0UKtNESZLwgjCr0AJKKgtmdhZKw4xfAmZgvPYwMyLLCzORv0QiT4dkzVPWNAEmPiajdUaaWATBq0xCFkqCVxuFyjRRssqiIE0qtICSyqKJnYXSNBGXoAkYrz1NjMjy0kTmL5HM0yFV274M2dEEmPiYjPYZaWIRBK8yCVkoCV5tFCrTRMkqy4I0qdACSiqLJnYWStNEXoImYLz2NDEiy0sTlb9EKk-HGjVrlgALH3Nxc0aWWMTAq8tBFsqBVxuEyjRRssaqIEkqtICSyiKJnYXSJFGXIAkYrz1JjMiK_GRzYv2-jhfhPNa5fo2pbwLTkye9O4A4XEZj_RiF4-02u4-9rW77j4mOk923fPfhfr77amPws5inxfyzWB2JuZ2YyzJqwUupb8qoZYtWCzJxSScuya0b9M60mIPzotVClFHLeil1m1YrMvEmLW5YiEVa3CTFLfqsW6QY3HObFCtQ7BuaCnWABQMqVlyg1RAMtBySAcgRGmg5YgM30HIcvADBG2yxwQNQIz4AOQIEkCNCIDmoCzcIcxw8io5GTEpuYILTkOFNcOw0ZtCt05zhbbC5QRqrstNqWHZaDssO5KjstByWnaasAJQVNGrAxAI1KjuQo7IDOSo7koOJFzRlBRg6QT_BpeRG2QWNGqHAsdOoQbdOk0YA0giDNDZlB2pUdiBHZUdyUHYgh0_9NGUFoKygUYPKDiiLzg1gEpUdYBKVHcjRxNOUlWBqJP2CnJIbZZc0aiR4oJM0asCtS5o0EpBGGqSxKTtQo7IDOSo7koOyAzkqu6QpKwFlJY0a9JYPKIvODWASvecDTKIXfSBHE09TVqJjp9-aU3Kz7DRqFHigUzRq0rc-evvl_wAAAP__chwM9g==

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lkFv2jAYhu_7FdZ3aiWjYCfQEmkSXcs0JFY64NCpyiElXkGiJLODVFrx3yeSai0B_MXz6lspfuzXnx-J9wXU7wWEMO4NepcTspIL8nU0_E7uerc3g4v-NTm56o8n4x-DU3LyumZdrnhaP5Ph6Ko3Il9-kudT0ru97N1MyMVggKyMgMIyTcR1_CgUhHfAgAIHCj5QCIBCCyIKmUynQqlUbpe8FEA_eYKwSWG-zFb59t8RhWkqBYQvkM_zhYAQJvH9QoxEnAjpNYFCIvJ4viiOyeT8MZbr7tP6GSiMs3ipQtLwticPV3lIuhyiDYV0lb9u_7br_ZrMYjXb3a_LINpEFFQePwgI2Yb-W8yW05j8aMy3fVbLVCZCimRnp2hLYksO3PVbrGZjkQ8zj1VeZLLORPhOHKCwEL_yky47_SznD7Pir7_3ZpV7v93Jt7jTgcDXaSPNPNaq3v7g2cHO2az-s7Maz-7xhud_iJ8GQduOg_KjQR0YylwYyusPn9cZvt_wgg-xxCDomeOg_GhQB5ZwF5b49Yfv1xl-0Ch-av6_JQZBzx0H5UeDOrDEd2FJUH_4QZ3htxof4ohBzI7TmPxoTAeGBK770IE4I6GydKlErbbT3F5IJA-iHJBKV3IqbmQ6LY4pPw4LrvjlToTKy295-aG_LL_aBqwPt23gjg3MrHKzlp5mBiPjZnDbBu7YwMwqd2VkezSv0s33tK-ft6-F2e7MmlU6sBFcDyOC62FEcD2MCY7QiOAtG8H1MCK4HkYE18OY4AiNCN62EfzMRlE9jCiqhxFF9TCmKEIjip7bKKqHEUX1MKKoHsYURWhE0Y6NosyqJyA0IilCI5YiNKYphmNdwa4s2LUFu7pg2RfsCgOzagxsrzIY2aqnMVv1NGarnkZtRXDMVpOytP9mJm3JlMZsNepLxjhm61550NoabT79CQAA___VGXW5

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mNFvqkgYxd_3ryDfU5tgdGbQWpJNevfWzTZxa1d9uJsbH7gy25pYYQGT2qb_-0bcqxXKdxhA31rlxxwO3zkMvlH875JcmgyGg69Tax0trd_Hoz-t74NvD8Mvd_fWxe3dZDr5a3hpXfx_zGZ3xMvm1RqNbwdj67e_rddLa_Dt6-BhCo6akU2rwNf33rOOyf1OgmySZJMimxyyqUszm8IomOs4DqLtIW8pcOe_kNuxabEK18n245lN8yDS5L5RskiWmlyaej-Weqw9X0ftDtnk68RbLNNlwmjx7EWbm5fNK9k0Cb1V7Fqt9nbl0TpxrRtJs3ebgnVyOH2ceI-aXPFul5dwu4iTxWqetLvH69-IzPkPyI-N9eTFT58cf9AgTTR8tEE054Oq5INo1ginUMThPOtVEPk60v7RmdKzFMqUHSDzIKF7KgnIqYOEXg0JdiWVf3jx00Qno7CtMk5NN6F2f4b_y3BINi31P8nFjbj8NVo8PqV_7cer-JqumrX1PmgFYVt1s1f_6dr9o7WFQbxKpKstW21l3DNAxH5qeifsGRMjmnRCVXJCNGuFUyiiZsxFxaZpUAJyqqhpzCTUbhpxjqaR5Ydclplx1Wo7xmkHIvZ37uqEaTcwQjTphKrkhGjWCqdQRM2oyYppb1ACcqoo7WYSaqddniPtqvyQqzIz7rTSnb5Z2oGI_Z3rnzDtBkaIJp1QlZwQzVrhFIqoGTVVMe0NSkBOFaXdTELttKtzpN0pP-ROmRnvtoyzDiTs79v1CbNuYINozgdVyQfRrBFOoYiaMXMqJr1BCcipoqSbSaiddOfcvxd8Imes4zBYxbrUrwGd7QVp_1HvDIqDdTTXD1EwT5fZ_TtKufQDX8fJ7lux--dutftqK_AjLLKw-Ag7R7Awg4WsRV_XoWWvDq0UT0vWccU7rtilu_zKPCyAbp6WnVr0VR1agUlzWMfBze4awDIL91gYXPQVPyg9flL6LH3Nw9d1gs3DKNiABsHmaRRsnkbBFqBLUZnytQKyDWgUboCjdCMcTDrAUb4FX6kC4bl24fBcxgVfL-jS-X4RIOUi1zBGj2Cehs9ggKOHMI_DpzCPw7Ty9Sr6wPhcvxqlladhWnkcphXgaGR5HKY117JHxksBtk98y2bwXFplrmpM0ir5ppFg9yb5fQwwDtAorQgHaQU4SivA4aaZL1nZBcbnWtYkrYBGaQU4SivC0cjyOEqr5Lewsg9wvmUzeD6t_C4WXTrfNKoD3rVyTWOSVkCjtCIcpBXgKK0AR2lVfMkqCYzPtazRWy5Pw9dcHofvuQBHL7o8jtKq-K2sQtbxLZvBc2lV_F42e-mz91_-CwAA__93TQYi

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllFr4kwUhu-_XzGcK4WROJNoa-CDlq7LCm7tVi8KJRepma2CNdmZCNrS_76YtFijzsnsYHI5Os_MO-c8kPMG6s8CfBj3h_2bCVnJBfl-P_pJHvsPd8PrwS1pfBuMJ-Nfwyb52LLONzQan2tKNvlP681rk_Qfbvp3E3I9HJLjO5oBUFjGkbgNX4QC_xEYUOBAwQUKHlDoQEAhkfFUKBXL7Za3DBhEa_DbFObLZJVufw4oTGMpwH-DdJ4uBPgwCZ8W4l6EkZBOGyhEIg3ni-yaRM5fQrm5Wm9egcI4CZfKJy1ne_NolfrkitErDsE7hXiVftywO_hpQ2ahmu0f-YkEFFQaPgvw2Tv9t7CdGsLyk2F3R62WsYyEFNHeYcGWxLYcefGPUM3GIh0lDit0Z7JJhP_FHqCwEL_TRpa6-b-cP88-F7saFAqwe5lr8bIjsW_jVpw4rFOswdG7vb27WXkFWAkFHN5y3DMaaxC3W0tcfjJuBc6y6pzl5RvByzTCbTneGb0xiHtRS1x-Mm4F3vDqvHHLN8It0wivlX2azuWNQdzLWuLyk3Er8MatzhuvfCO8Mo3otM5ojUHYXg1h-cmwFTjj1TNXHQl1L1QSL5UoNTW1t88S0bPIy6TilZyKOxlPs2vy5Sjjsq9-JFSa_8vzxWCZ_7UNWB7u2sA9G5hZ5WYdPc0MSsbN4K4N3LOBmVXuQskOaF6k219pV19vVwuz_Zq1i7RnI7geRgTXw4jgehgTHKERwTs2guthRHA9jAiuhzHBERoRvGsj-IWNonoYUVQPI4rqYUxRhEYUvbRRVA8jiuphRFE9jCmK0IiiPRtFmdWcgNCIpAiNWIrQmKYYjs0KdsOC3bRgNy5Yzgt2AwOzmhjYwchgZKuexmzV05itehq1FcExW02GpcOemUxLpjRmq9G8ZIxjth4MD1pbg_f__gYAAP__BJKH9g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9v4kYUxd_7Kaz7lEiDYGYMIZYqZbVL1Ug0SQMPK6148MI0QWKxaxspbJTvXmGaEGx8j8d_so_8-TFnju85HvNM8b8r8mgyGo8-T51NtHL-uL_9y_k2-no3_nR945x9uZ5MJ3-Pz53_v_K0_8LZ2etr4Wz3bz1tf547o6-fR3dT5_Sn5zMStA4W5sb_YWLyvpEkQYoEaRLkkqA-zQSFUTA3cRxEu688p8D14om8nqDlOtwku7dnguZBZMh7pmSZrAx5NPW_r8y98Rcm6vZI0MIk_nKVLhNGyx9-tL162v4kQZPQX8ee0-nuVr7dJJ5zJcWVotmLoGCTHFaIE__BkCdfRHkVX5ZxslzPk27_WMKpJQ7U963z6MePp5GDEmWj5L0fslFDdCVDZBuOuIVSDj-1WQfRwkRmcfRj6a8UilU9LPagot-WihKWHVQMaqgQlYT-6cePE5Pchl2d8Wu6DY332gafxmMStDL_JGfpDs5_j5YPj68vDjNXuLOLZv29CTpB2NX9rAcn1x4erS0tMlcicl3V6eoqLQR0vE3QoPUWsnGkYUt0JUtkG564hVJqNoCs3kMNqihhWVEP2amo3UPy43pIlZ98VWbwdafrVukCoOPtKl603gUWjsiGLdGVLJFteOIWSqmZQlW9CxpUUcKyoi6wU1G7C9THdYEuP_m6zOC7nfQBwroLgI63qzhsvQssHJENW6IrWSLb8MQtlFIzhbp6FzSoooRlRV1gp6J2F-iP6wK3_OS7ZQa_36nSBEDF2zW8bL0JLPyQjRqiKxki23DELZRSM4Fu9R5oUEUJy4p6wE5F7R5wf83_FCdE3Zs4DNaxKfUvRG-3LbN4MHub4mATzc1dFMzTZfYvb1MufWNh4mT_qdy_uF7vP9oJfA_LLCzfw-4RLO1gqWrRl3VoNahDa83TinVc845rduk-vzIPS6Cbp1WvFn1Rh9Zg0lzWcXCx-xawysIDFgabvuAHZcBPypClL3n4sk6weRgFG9Ag2DyNgs3TKNgSdCkqU75WQLYBjcINcJRuhINJBzjKt-QrVSI81y4cnsu45OsFbZ3vFwlSLnMNY3UL5ml4DwY4ugnzOLwL8zhMK1-vcgiMz_WrVVp5GqaVx2FaAY5GlsdhWnMte2S8kuD4xLdsBs-lVeWqxiatim8aBU5vij_HAOMAjdKKcJBWgKO0AhwemvmSVX1gfK5lbdIKaJRWgKO0IhyNLI-jtCr-CKuGAOdbNoPn08qfYtHW-abRPfCslWsam7QCGqUV4SCtAEdpBThKq-ZLVitgfK5lrZ5yeRo-5vI4fM4FOHrQ5XGUVs0fZTWyjm_ZDJ5Lq-bPstmtz15--y8AAP___oUktw==
