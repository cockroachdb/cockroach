# LogicTest: 5node-dist-opt

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW EXPERIMENTAL_RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lk9vozAQxe_7Kaq5rhEZY_KHU669tKt2b6sc2DCqIqUY2Y7UbpXvvgKE2kTN2CbkCPS9-fnNU50PqHVFD-UrWSj-AIIACQIyEKBAQA4bAY3RW7JWm_ZPesF99QbFTMCubg6ufb0RsNWGoPgAt3N7ggJ-l3_39ERlRSadgYCKXLnbd2Mas3stzfv67f0fCHhuytoWd0naTn48uOJujbA5CtAH92lvXflCUOBRjEPIJ0OQMQjP2jgyKZ4lsMafF_2zMf75FP6fttpUZKj6zvQbiAed6CaVp2e8NF6djMfwDWLABlOZpFl0jSIg5hNCyBiIYdE4dtGB_vOx_jI8RBkSYpakKnqTERCLCSFkDMSQtLxR0oP_Yqx_Fh5iFhKiSrr_vnGbjIBYTgghYyCGpLMbJT34L8f6q_AQVUiIeRK9xwiE1WQIMgZhSFndKOXBf3WjnwBPZBtdWwq6fWft_U3VC_X3vdUHs6VfRm-7Mf3jY6frXlRkXf9V9g_3df-pBfwqRlac8WLJitWJGM_F2TVixZ8Zee6cVS948ZwVL3nx4ppDL68Rr1gxehJDvmToaxlfMw86XtUz5IuGuQedrxrOPXK-az52vmw-Nd82XHnQ-b7JmUfON87DLvnCnas3xx__AwAA__-BxeXG

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslkFvozAQhe_7K6q5riMyNiQNpx720st21e5tlQMbRhVSipFtpHar_PcVIKUlasY2cATnzZsv7wn5HWpd0s_ihSzkfwBBgAQBCgSkICCDvYDG6ANZq033k0FwX75CvhZQ1U3rutd7AQdtCPJ3cJU7EuTwu_h7pEcqSjLJGgSU5Irq2Ns0pnopzNvd69s_EPDUFLXNb1ZJ5_zQuvzmDmF_EqBb9zHeuuKZIMeTCF_hR2VdVR9cko39mfkyZv5nRFyOUU1ixHDI9KrBx9y21qYkQ-Vo6v7ErSDXwStkMYxP2jgyicTL8d-vzt-M5mNEjgExJnKVqOiyepY4_4ubiWWNgVySUk2ixHDMcV1lOKYMoVSrJI3O0rPEmXI7McsISFySUk2ixHDMcZYqHFOFUKar_lMfl6VniTPl7cQsIyBxSUo1iRLDMcdZpuGYaQhltopO0rPCmXE3MckIRFyOUU1ixHDI69eBLwweyTa6tnRxLfh68rq7LlD5TMPdwurWHOiX0YfeZnh86HX9i5KsG05xeLivh6Nuwc9iZMXpSIyXYsmKFe-s5jinrDjjnTNWLCWv3rDqLS_ezoG-ZcU73nk3xxk9HfOVbFbLkK8ZenqGs4qGfNPQUzXku-Yz57uGnrLhrLYhXzf09A1nFU7yhZOewsm4wu1P3_4HAAD__6taIWc=

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk1r4zAQhu_7K8JcV8Eeyc6HYKGHZSGXdml7283Baw_FkFpBkqHdkv9eHENah0aSrRxj95139PiB6g0aVdFt8UwG5B9AYMCBgQAGGTDIYctgr1VJxijd_Ukf2FQvIFMGdbNvbfd4y6BUmkC-ga3tjkDCY_FvR_dUVKSTFBhUZIt6d6zZ6_q50K83L6__gcHDvmiMnM2TrvlXvbOk5ewGZ3_bNBXlTEgpN7ePK2Bw19ruDWwPDFRrP7qNLZ4IJB5Y-H4_a2PrprRJPlzOMZ-Pmf_5_DgdAP0YQ0BMIoDhCLKLBR9z20bpijRVg6nbg2sFngavkI8544PSlnTC8Xz894vzF4P5OOIrB3zkhM8TcV3PPRueEC8mej6GQAyCGNNDGWA4hKHpPBwCD2Eg5kl2XQ08G54QLCdqMIIAxiCI0SCUAYZDGGogwiGIEAbZ_Pjv54oaeDY8IVhN1GAEAYxBEKNBKAMMhzDUIAuHkIUwyOfXlcCz3wnAeqIEI86P0wHEKBBKAMMRXL76fFFwT2avGkNnV6CvJ6fd1YiqJ-rvUUa1uqTfWpXHmv7n3TF3fFCRsf1b7H9smv5Vt-DnMDrD2SCM52HuDAt3s4hpzpzh3N2cO8Ocu9MLZ3rpDi9jDr1yhtfu5nVMM3oc80kWZRm6NUOPZxglGrpNQ49q6HbNV-52DT2yYZRt6NYNPb5hlHDcLRz3CMfHCbc9fHsPAAD__4-gb1o=

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslk1r4zAQhu_7K8JcV8Ee2c6HYKGHZSGXdml7283Baw_FkFpGkqHdkv9ebENah0aSrRxt5513_PiB6A1qWdJt_kwaxB9AYMCBQQIMUmCQwZ5Bo2RBWkvV_WQI7MoXEDGDqm5a093eMyikIhBvYCpzIBDwmP870D3lJakoBgYlmbw69DWNqp5z9Xrz8vofGDw0ea3FYhl1zb-qgyElFje4-NvGcVL8WKRCiN3t4wYY3LWmewT7IwPZmo9ybfInAoFH5r_gz0qbqi5MlI23s8znU-Z_BoDzCdAC_QEkswCgP4H0YsHH3LaWqiRF5Wjq_mhbgcfeK2RT3vFBKkMq4ng-_vvF-avRfJzwkT2-ccSXUXJlzx0rnhivZno-BUEIgwDTfRGgP4Ox6dyfAfdBkCyj9MoaOFY8MVjP1GACAgxhEKCBLwL0ZzDWIPFnkPggSJf9v881NXCseGKwmanBBAQYwiBAA18E6M9grEHqzyD1QZAtryyBY8ETge1MCSYAwPkEAhTwBYD-BC4ffb4ouCfdyFrT2RHo68lxdzSi8omGc5SWrSrot5JFXzNc3vW5_kZJ2gxPcbjY1cOjbsHPYbSG01EYz8PcGk7szUlIc2oNZ_bmzBrm3J5eWdNre3gd8tIba3hrb96GNKPDMZdkQZahXTN0eIZBoqHdNHSohnbXXOV219AhGwbZhnbd0OEbBgnH7cJxh3B8mnD747f3AAAA___-6W9V

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyklE2PqjAUhvf3V5izLoEW8IMVWzd64727CQuGnhgSpaQtiY7hv0-AhaPRSQ9d0vbJ--RtOTdolMRdeUYD2QdwYCCAQQwMEmCQQsGg1apCY5QejkzAVl4gixjUTdvZYblgUCmNkN3A1vaEkMH_8vOEBywl6jACBhJtWZ_GmFbX51Jf88v1Cxj8a8vGZIsgHJL3nc0WOWe5gKJnoDp7TzC2PCJkvGfzLFKihWA5f2sh3lrcw7tGaYka5UNw0b_w3KlAtSGPnk6-zo4fsrl7A9yhgVAEYTznJggeS7IH4S6Eu4dw8YiDMJnTB8FjRfYg9BG7e8QuHkkw_knkPggea7IHoY_E3SNx8UiDOW0QLDZEi5lz64XFAU2rGoNOUyka5hrKI05D0KhOV_hXq2qMmT73IzcuSDR22hXTx7YZt8aafsLcBxa_wpw_0NEzHftEJz5w6gMvfeCVD7z2gTder4T2xor-z3cAAAD__18c6HE=

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lk9vozAQxe_7Kaq5rhEZY_KHU669tKt2b6sc2DCqIqUY2Y7UbpXvvgKE2kTN2CbkCPS9-fnNU50PqHVFD-UrWSj-AIIACQIyEKBAQA4bAY3RW7JWm_ZPesF99QbFTMCubg6ufb0RsNWGoPgAt3N7ggJ-l3_39ERlRSadgYCKXLnbd2Mas3stzfv67f0fCHhuytoWd0naTn48uOJujbA5CtAH92lvXflCUOBRjEPIJ0OQMQjP2jgyKZ4lsMafF_2zMf75FP6fttpUZKj6zvQbiAed6CaVp2e8NF6djMfwDWLABlOZpFl0jSIg5hNCyBiIYdE4dtGB_vOx_jI8RBkSYpakKnqTERCLCSFkDMSQtLxR0oP_Yqx_Fh5iFhKiSrr_vnGbjIBYTgghYyCGpLMbJT34L8f6q_AQVUiIeRK9xwiE1WQIMgZhSFndKOXBf3WjnwBPZBtdWwq6fWft_U3VC_X3vdUHs6VfRm-7Mf3jY6frXlRkXf9V9g_3df-pBfwqRlac8WLJitWJGM_F2TVixZ8Zee6cVS948ZwVL3nx4ppDL68Rr1gxehJDvmToaxlfMw86XtUz5IuGuQedrxrOPXK-az52vmw-Nd82XHnQ-b7JmUfON87DLvnCnas3xx__AwAA__-BxeXG

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslkFvozAQhe_7K6q5riMyNiQNpx720st21e5tlQMbRhVSipFtpHar_PcVIKUlasY2cATnzZsv7wn5HWpd0s_ihSzkfwBBgAQBCgSkICCDvYDG6ANZq033k0FwX75CvhZQ1U3rutd7AQdtCPJ3cJU7EuTwu_h7pEcqSjLJGgSU5Irq2Ns0pnopzNvd69s_EPDUFLXNb1ZJ5_zQuvzmDmF_EqBb9zHeuuKZIMeTCF_hR2VdVR9cko39mfkyZv5nRFyOUU1ixHDI9KrBx9y21qYkQ-Vo6v7ErSDXwStkMYxP2jgyicTL8d-vzt-M5mNEjgExJnKVqOiyepY4_4ubiWWNgVySUk2ixHDMcV1lOKYMoVSrJI3O0rPEmXI7McsISFySUk2ixHDMcZYqHFOFUKar_lMfl6VniTPl7cQsIyBxSUo1iRLDMcdZpuGYaQhltopO0rPCmXE3MckIRFyOUU1ixHDI69eBLwweyTa6tnRxLfh68rq7LlD5TMPdwurWHOiX0YfeZnh86HX9i5KsG05xeLivh6Nuwc9iZMXpSIyXYsmKFe-s5jinrDjjnTNWLCWv3rDqLS_ezoG-ZcU73nk3xxk9HfOVbFbLkK8ZenqGs4qGfNPQUzXku-Yz57uGnrLhrLYhXzf09A1nFU7yhZOewsm4wu1P3_4HAAD__6taIWc=

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lk9vozAQxe_7Kaq5rhEZY_KHU669tKt2b6sc2DCqIqUY2Y7UbpXvvgKE2kTN2CbkCPS9-fnNU50PqHVFD-UrWSj-AIIACQIyEKBAQA4bAY3RW7JWm_ZPesF99QbFTMCubg6ufb0RsNWGoPgAt3N7ggJ-l3_39ERlRSadgYCKXLnbd2Mas3stzfv67f0fCHhuytoWd0naTn48uOJujbA5CtAH92lvXflCUOBRjEPIJ0OQMQjP2jgyKZ4lsMafF_2zMf75FP6fttpUZKj6zvQbiAed6CaVp2e8NF6djMfwDWLABlOZpFl0jSIg5hNCyBiIYdE4dtGB_vOx_jI8RBkSYpakKnqTERCLCSFkDMSQtLxR0oP_Yqx_Fh5iFhKiSrr_vnGbjIBYTgghYyCGpLMbJT34L8f6q_AQVUiIeRK9xwiE1WQIMgZhSFndKOXBf3WjnwBPZBtdWwq6fWft_U3VC_X3vdUHs6VfRm-7Mf3jY6frXlRkXf9V9g_3df-pBfwqRlac8WLJitWJGM_F2TVixZ8Zee6cVS948ZwVL3nx4ppDL68Rr1gxehJDvmToaxlfMw86XtUz5IuGuQedrxrOPXK-az52vmw-Nd82XHnQ-b7JmUfON87DLvnCnas3xx__AwAA__-BxeXG

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkTFLBDEQhXt_xTF1YJO9LpWFzTUqtrJFSIYjEDNLZiLCsf9dNinOE09Wr8zM--a9R06QKeCje0MG-woGJgVzIY_MVNZRFxzCB1itIOa5yjqeFHgqCPYEEiUhWEjkXdq9u1SRd3rQoCCguJiaflFAVc40izsiWLOofzqYwWxyGK86nA_XTCVgwfDt4g8ZHiJLzF6G8UIL9wauJdj_peML8kyZcVM3vSbEcMReh6kWj8-FfLPpz6fGtUFAlr4d--OQ26p9wlfY3AKPv8L7C1gv03L3GQAA___qN9W_

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v2jwUxu_fT4HO1TvNKLGT8CfSJKap0ipV7VS4m3KREq8gURI5QSqr-O4TUNYlIX5i0vpuDH72k3N-pycvtE4TeRs_yZzCn8SJkSBGHjHyiVFAEaNMpXOZ56na_-QIXCfPFLqMlutsU-z_O2I0T5Wk8IWKZbGSFNIsfljJexknUjkuMUpkES9Xh2sytXyK1XbyvP1NjKZZvM7DXt_Z33y3KcLeRFC0Y5Ruitfj30592PYWcb4onzfhFO0iRnkRP0oK-Y5dFjOwGlM0xnw7Z7NOVSKVTEonRXsS_eTMs36P88VUFneZwysdmW0zGfaub2dX99Orb7Pe15sbYrSSv4r_J_zTF7V8XBz-9ffReeXR3x7LM6n-NFWFVA4PqpX63Hi-36Js5yryeuiZELdpP80c4VZrfPb6oHQ9by8XbyGXI_qO9yFTYBB0YDmoaAxqYQ64pTkA9T_NweDSORDt-yva9NfrO_6HiGgQdGg5qGgMakFEYUlEUP-TiMNLRfTa99dr01-_f1jL7y-iQdCR5aCiMagFET1LIoL6n0QcXSqi376_fpv-Bv0P0dAg5thqTNEY04KEviUJQfVPEo7f4_X0zPn3Ms_SdS5bvXm6-5rJ5FEee5CnGzWXP1Q6P1xz_Hh34A6vG4nMi-O34vjhen38ah-wPTzsAnPeiQ460WM9zQ1qJszgYRe4UjNTOuhEj_W0qNLuv7RXgt0q7GlhX98tXwsLrr866DIfehjMhx5G8wFoMB-ABvMx6DIfehjMhx5G8wFoMB-ABvMx1Fo60ks66jIf4y6G62FguB5GhgMaGA5otAFM1mb9L6nJ3jSl4RIw2pzGONCc17ZISVUu9KJz_RoBpvPaHjFRHdDAdUAj2REObEc40r22Q41019NIdz0NdQc40h3gSPfaIi3rPgC613aKke61nWKku55GuutpqDvAke4AR7rX9qmR7noa6a6noe4AR7oDHOle26rld21Xr7uo7Rat7tHuvz8BAAD__yMtXoc=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF-P4jYUxd_7KZCfWjUo2Nf8i1SJql2pI61mqoG3iocscQcklkRJkJau5rtXwAJDTO6Jk8Ab_459cnzPTwnfxSaOzHP41WQi-EdI4QklPEHCE1p4oi_mnkjSeGGyLE73PzkKnqJvIuh5YrVJtvn-47knFnFqRPBd5Kt8bUQgZuGXtXk1YWRSvyc8EZk8XK0P2yTp6muY7ibfdv8JT0yTcJMFna6_3_llmwediRLzd0_E2_yyfJaHb0YE8t2rbuHPVZavNovc71_vP5GF9S-SL7vOMsyWN35_8aBcPHyMQbaXA9XKQbYbhC41cVlnu4nTyKQmulrpsEqpTdUDNi8W-veygJK6WBg0sODVcvlXmC2nJn9JfCokNdslJug8Pc8-vU4__THr_P75s_DE2vyb_zyRv_yWrt6Wh1fnCSu_rKHLhE3jNDepT1Zqv5auP6oQ261Efix6w8Rz3I0TX_eKGd_cfny1vXQocYUO-6rrkzPNgInzbA7uSDOXINpMgmolIduNQpeaaAgTWZNnLVpASZXxzM1CY57JB_EMTNiJZ1ZqVXmmqvdIVakRdX3tDBRg4jwcwzsCxSEI2WYSVCsJ2W4UutREwzarmkBp0QJKqgwobhYaA0U9CChgwk5AsVKrChSq3iOqUiPdPTwVuQEFmDgPx-iOQHEIQraZBNVKQrYbhS410bDNVBMoLVpASZUBxc1CY6DQg4ACJuwEFCu1qkDR1Xukq9So33XGCbBwHo3xHXHiEINsLweqlYNsNwhdaqJhk3VNmLRoASVVBhM3C41hoh8EEzBhJ5hYqdX5--bG-q8mS-JNZir9M9PbZ2aiN3M8gyzepgvzdxovDtsc374cdIcPIpPlx2_l8c3T5vjV3uBHsSyK5UexvhJLN7GkJmolG6nHTdQ05NWKTZz4xIndus_vzIslOC9erVQTNfUaqUe8WrOJD3hx30GsiuIBKx7yZz1kxeCaR6xYg2KPeSr0ABYsqDhxgVdDMPBySAYgR2jg5YgN0kLLdfAKBG-xxQUPQI34AOQIEECOCIHkoC7SIsx18Cg6HjEFuYUJyUNGDsCx85hBl85zRo7A5hZpnMrOq2HZeTksO5CjsvNyWHaesgpQVvGoARML1KjsQI7KDuSo7EgOJl7xlFVg6BR_B1eQW2VXPGqUBsfOowZdOk8aBUijLNK4lB2oUdmBHJUdyUHZgRze9fOUVYCyikcNKjugLDo3gElUdoBJVHYgRxPPU5bA1BD_gFyQW2UnHjUEbuiIRw24dOJJQ4A0ZJHGpexAjcoO5KjsSA7KDuSo7MRTlgBliUcNesoHlEXnBjCJnvMBJtGDPpCjiecpS-jY-afmgtwuO48aDW7oNI-a4qXP33_6PwAA___UW-5o

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFr2zAYhu_7FeE7bSDjSLbTxjDIGIUVSjKS3IYPbqwlgdQykgPNSv77sD2WxYn1WdOi3Zraj_Tq0wN-3yAXGZ-mL1xB_A0oEGBAIAACIRCIICFQSLHiSglZvdIAj9krxEMC27zYl9W_EwIrITnEb1Buyx2HGJbp847PeZpx6Q-BQMbLdLurtynk9iWVh8nr4QcQWBRpruKB51c7z_ZlPJgwSI4ExL78tfxp1efDYJOqzfl6EwrJMSGgynTNIaZH8ncxI6cxWWfM0zr7XMiMS56drZRUJPbKlbN-SdVmwctZ4dPWjSwPBY8Hj9Plw3zx8Hk5-PT0BAR2_Hv5fkI_fJTb9ab-6_fRaevop2MFFse6knkqPFH4NGoP4Ore4dnetP_N0x437zPPD26iqEHQkeOgrDOoA0mpI0lZ__mzPvMPPD-8iSgGQe8cB2WdQR2IwhyJEvSff9Bn_qFXf3P-vSgGQe8dB2WdQR2IEjgSJew__7DP_CPvJpoYxBw7jck6YzqQJPwP3ehKojlXhcgV79V8htWZeLbmzYyU2MsV_yrFqt6m-TmrufornnFVNk9Z8-Mxbx5VAfvDIxt4bANTq9w00tPUYGTMDB7ZwGMbmFrlbo3sgmZtevgnHejnHWhhej6zYZsObQTXw4jgehgRXA9jgiM0InhkI7geRgTXw4jgehgTHKERwUc2gt_ZKKqHEUX1MKKoHsYURWhE0XsbRfUwoqgeRhTVw5iiCI0oOrZRlFr1BIRGJEVoxFKExjTFcKwr2JUFu7ZgVxcs-4JdYaBWjYFeVAYjW_U0ZquexmzV06itCI7ZalKWLu_MpC2Z0pitRn3JGMdsvSgPWluT47ufAQAA__9XmVno

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF1r-kgYxe_3U8hc7UIkPjOJL4EFl93CFkq7tN4tXqRmtgrWhCRC3dLv_kcFrUnznExm7P_Ot1_m5OQ5JxPfxSZN9H38qgsR_StIeEIKTyjhiUB4IhRzT2R5utBFkeb7nxyB2-RNRANPrDbZttx_PPfEIs21iN5FuSrXWkRiFj-v9aOOE537A-GJRJfxan1YJstXr3G-m77t_heeeMriTRH1-v5-5YdtGfWmUsw_PJFuy_PhizJ-0SKiD6-9hL9WRbnaLEo_vFx_SpXjn5HnXW8ZF8svfn_WIE00fLaB3PmgOvlAbo0IGkWcj7PdpHmic51cHOlwlEaZcgBkniWE15KAnDpLGFpI8Dqp_Dsulk-6fMh8VXFqtst01Lu9n908Pt38Oev9cXcnPLHW_5W_Tum33_PVy_Lw6jRhzac1cuvsfdpPM1-FVQO-XHt8sTYZJKxFwHzZ95Vx1QARp8EZXrFqTIxw6YTq5AS5tSJoFGGZdOpYNg4lIKeaysZMgnXZ0DeVjWw_57LNmKu-HxgHHog4XbzRFQNvYAS5dEJ1coLcWhE0irBMm-wYeIcSkFNNgTeTYB14-U2BV-3nXLUZ86B_2PKbBR6IOF288RUDb2AEuXRCdXKC3FoRNIqwTJvqGHiHEpBTTYE3k2AdePVNgQ_az3nQZszDvnHcgYTTpZtcMe4GNpA7H1QnH8itEUGjCMukBR3D7lACcqop7GYSrMMe_IT_Dr5Q9KiLLN0UutU_A4P9OenkRR89KtJtvtD_5OnisMzx7cOBO3yQ6KI8fkvHN7eb41d7gZ9hqsL0GQ4uYDKDSVrRExtaDm1opXhaso4r3nHFLh3yK_MwAd08LQdW9MiGVmDSAtZxcLFDA1hW4SELg5Me8YMy5CdlzNITHp7YBJuHUbABDYLN0yjYPI2CTaBLUZnytQKyDWgUboCjdCMcTDrAUb6Jr1RCeK1dOLyWceLrBZ063y8EUk61hjG6BfM0vAcDHN2EeRzehXkcppWvVxoD42v9apRWnoZp5XGYVoCjkeVxmNZay14YLwlsn_iWreC1tMpa1ZikVfJNI8HuTfL7GGAcoFFaEQ7SCnCUVoDDTTNfsjIExtda1iStgEZpBThKK8LRyPI4Sqvkt7ByDHC-ZSt4Pa38LhadOt80agCetWpNY5JWQKO0IhykFeAorQBHaVV8ySoJjK-1rNFTLk_Dx1weh8-5AEcPujyO0qr4raxC1vEtW8FraVX8XrZ66vOPX34EAAD__9HR6zs=

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v2jwUxu_fTxGdq3eaUWIn4U-kSp2mTkOq6FS427hIiVeQKImcIJVV_e5TQlEXAn7ipOSuNPnZHJ_fw_ELbeJITsInmVLwkzgxEsTIJUYeMfJpzihR8UKmaazyV_bAOHqmwGG02iTbLP_3nNEiVpKCF8pW2VpSQLPwYS3vZRhJZTvEKJJZuFoX2yRq9RSq3fXz7g8xmibhJg2snp3v_G21zqQKrGtu_do6jruwRBAE48lsSIzutln-hOavjOJt9rb3-5YPO2sZpsvyZsX7c0ZpFj5KCvgra1aD37gGefXRRYizRbyvs93EKpJKRqWV5jmJXjlxEt_DdDmV2V1i86NmznaJDKzxZHZzP735OrO-3N4So7X8nf1_zT9dqdXjsvjrbOnvZbkmvZnGKpPK5v7xSX0-u75X49hOncjboie-xCTuxYktnOMzPrm9X9qe11eP11DPFj3b7T5ABlX0W1Rx6QjxbiPEO4oQ6M4hQv2mERL1uy_qdN_t2V73DhtUMWhRxaUdFt06LDpyGHTn4PCgqcNu_e67dbrv9YqrQscOG1QxbFHFpR12u3XY7chh0J2Dw8OmDnv1u-_V6b7f695ggxpGjWu4tL9et_56HfkLenPwd_QRV_ET69_LNIk3qax1y3byM5PRo9z3II23aiF_qHhRbLP_eFdwxf0okmm2fyr2H8ab_aP8C9aHB21gzlvRfit6pKe5wZkJM3jQBj46M1Pab0WP9LQ4pp1_abcEO8ewq4U9fbc8LSy4fmu_TT70MMiHHkb5ADTIB6BBPvpt8qGHQT70MMoHoEE-AA3yMdBaOtRLOmyTj1Ebw_UwMFwPI8MBDQwHNJoAJmOz-ktqMjdNaTgEjCanMQ4055UpUlKVC73oXD9GgOm8MkdMVAc0cB3QSHaEA9sRjnSvzFAj3fU00l1PQ90BjnQHONK9MkjLuveB7pWZYqR7ZaYY6a6nke56GuoOcKQ7wJHulXlqpLueRrrraag7wJHuAEe6V6Zq-a7t6HUXldmi1X3--t_fAAAA___lQaxm

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K9BctaqRPR98xNJKqdqtGmmVVAl3bS68eJpYYrFlG2lplP9eAQWCB79nxmO4SzBn5vjMex7ZvLFlnur75JuuWPwX4yxgggVMsoApFrARew5YUeZzXVV5ufnKTnCXfmdxFLBsWazqzcfPAZvnpWbxG6uzeqFZzGbJ14V-1EmqyzBiAUt1nWSL7TZFmX1LyvXt9_W_LGBPRbKs4sEw3Oz8e7aodRkPbvng71UUyflAxHF8dz-bsoA9rOrNFfb8HrB8VR_3rurkRbOYvwf2_n7LqjpbzutwdGrOWP8o-boevCbV65nvHz0IFw8fM-LdQ9KfXFKSnVLi_cakWk0c11kt8zLVpU5PVtqu0mpTRMDm0cLoUhZQUkcLYw8LQSeXfyTV65OuH4pQNpKarQsdD-7uZ58fnz7_Ohv88uULC9hC_1P_eMt_-lRmL6_bvywmbOIyYU95WesylEZqP7euP7WI7Vwi_y96xsR9PsyLUEXNjM9uf3OyPXeouEXDQzEMZb8gBA4Pgzu-IAhdUvKJyQeFtjnxfoNSrSY8OcQ7orBHCyipNhS6WfBGIb8SCsGE7VFopGaLQmHfMmFTMjkMVb8sAg4PkzO5IIscUuI-MfmwyDYn3m9QqtWEJwhERxb1aAEl1cYiNwveLBJXYhGYsD2LjNRsWSTtWyZtSqaG2ze1HlkEHB4mZ3pBFjmkxH1i8mGRbU6836BUqwlPEMiOLOrRAkqqjUVuFrxZJK_EIjBhexYZqdmySNm3TNmUbDTsl0TA32Fubi5IIoeMePeQfDhkmxLvNybVasITAqojh3q0gJJq45CbBW8OqStxCEzYnkNGal1-qjqz_qOuinxZaatfoaJNZjp90bszqPJVOdd_lvl8u83u34etbvtBqqt6d5Xv_rlb7i5tDH4U86aYfxSrEzF3E3PpoxbcS33jo5YTWi3IxCWduCS3HtE702IOzotWC-GjlpGXekqrFZn4mBaPHMSiKR6T4gl91hNSDO55SooVKPYNTYUIYMGAihMXaDUEAy2HZAByhAZajtjADbScBi9A8AZbXPAA1IgPQI4AAeSIEEgO6sINwpwGj6KjEdOQG5jgNGT4GBw7jRl06zRn-BRsbpDGqey0GpadlsOyAzkqOy2HZacpKwBlBY0aMLFAjcoO5KjsQI7KjuRg4gVNWQGGTtBPcA25UXZBo0YocOw0atCt06QRgDTCII1L2YEalR3IUdmRHJQdyOFTP01ZASgraNSgsgPKonMDmERlB5hEZQdyNPE0ZSWYGkm_IDfkRtkljRoJHugkjRpw65ImjQSkkQZpXMoO1KjsQI7KjuSg7ECOyi5pykpAWUmjBr3lA8qicwOYRO_5AJPoRR_I0cTTlJXo2Om35obcLDuNGgUe6BSNmuatP7__8F8AAAD__zB7PFY=

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1v2kAQhu_9FdacWnWRvWubD0uRqKpURYpIFbi1Pjh4G5AIttZGCo347xUQmtom-3px8C0EHg-z87zMPtMqieU4epQZBT-JEyNBjFxi5BEjn0JGqUpmMssStfvIARjFTxQ4jBardJ3v_h0ymiVKUvBM-SJfSgpoGt0v5Z2MYqlshxjFMo8Wy32ZVC0eI7UZPm3-EKNJGq2ywOrYu8rfFstcqsAacuvX2nHcmeUGQTAaT_vE6HadB9ZQULhllKzzl9qvJe831jzK5sViQ07hNmSU5dGDpIBv2Xk9-Gf3IK8s_r5NiDebeH3OepWoWCoZF54U7kj0kRMn8T3K5hOZ36Y2Lw1zukllYI3G0-u7yfXXqfXl5oYYLeXv_OOQf7pSi4f5_q9_rfNS669tuSazmSQql8rmfvmkPr_5fK_GsZ06kZeHnvgS46STpLZwymd8srxfKM_rq8drqGeLju22HyCDLroNurh0hHi7EeItRQhM5xih7rkREvWnL-pM3-3YXvsOG3TRa9DFpR0W7TosWnIYTOfocO9ch93603frTN_r7K8KLTts0EW_QReXdtht12G3JYfBdI4O98912Ks_fa_O9P1O-wYb9DA4u4dL--u166_Xkr9gNkd_B-9xFT_x_DuZpckqk7Vu2c7uzGT8IA8zyJK1mskfKpntyxxe3u65_f0olll-eFccXoxWh7d2X7A-3GsCc96I9hvRAz3NDc5MmMG9JnDpzExpvxE90NOiTDv_024Bdsqwq4U9_bQ8LSy4vrTfJB96GORDD6N8ABrkA9AgH90m-dDDIB96GOUD0CAfgAb56Gkt7esl7TfJx6CJ4XoYGK6HkeGABoYDGm0Ak7VZ_SU12ZumNFwCRpvTGAea88oWKajKhV50rl8jwHRe2SMmqgMauA5oJDvCge0IR7pXdqiR7noa6a6noe4AR7oDHOleWaRF3btA98pOMdK9slOMdNfTSHc9DXUHONId4Ej3yj410l1PI931NNQd4Eh3gCPdK1u1eNd29LqLym7R6h5uP_wNAAD__8vMrHA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFtr40Ycxd_7KcQ8tVRGmosvESy4tFsaWJKS-K3Ng9aaJgKvJSQZNg357sV2Y8ca639mNHLefDszR2f-54fkF7YuMn2TftM1S_5inIVMsJBJFjLFQjZmDyErq2Kp67qotj_ZC66z7yyJQ5avy02z_fghZMui0ix5YU3erDRL2CL9utJ3Os10FcUsZJlu0ny126as8m9p9Tz__vwvC9l9ma7rJBhF251_z1eNrpJgzoO_N3Esl4FMkuT6ZjFjIbvdNEkwF-zhNWTFpjnuXTfpo2YJfw3t_f2W102-XjbR-NTcnLfWP0q-PgdPaf105vdHD8LFw_uMeP-Q9KeA26cke6XEh41JdZo4rrNZF1WmK52drLRbpdOmiIHNo4XxpSygpI4WJh4Wwl4u_0jrp3vd3JaRbCW1eC51ElzfLD7f3X_-dRH88uULC9lK_9P8OOc_faryx6fdq8OEdV_W1GXC7ouq0VUkjdR-7lx_ZhHbuUT-X_SMiZtiVJSRitsZn93-6mR77lBxi4ZHYhTJYUEIHB4Gd3JBELqk5BOTDwptc-LDBqU6TXhyiPdE4YAWUFJdKHSz4I1C_kEoBBP2hkIjNVsUCvuWCZuSyVGkhmURcHiYnOkFWeSQEveJyYdFtjnxYYNSnSY8QSB6smhACyipLha5WfBmkfggFoEJe2ORkZoti6R9y6RNydRo96Q2IIuAw8PkzC7IIoeUuE9MPiyyzYkPG5TqNOEJAtmTRQNaQEl1scjNgjeL5AexCEzYG4uM1GxZpOxbpmxKNh4NSyLg7zA3VxckkUNGvH9IPhyyTYkPG5PqNOEJAdWTQwNaQEl1ccjNgjeH1AdxCEzYG4eM1Pr8VXVm_Ttdl8W61lb_QsXbzHT2qPdnUBebaqn_rIrlbpv929udbvdBputm_y3fv7le77_aGnwv5m0xfy9WJ2LuJubSRy24l_rKRy2ntFqQiUs6cUluPaZ3psUcnBetFsJHLWMv9YxWKzLxCS0eO4hFWzwhxVP6rKekGFzzjBQrUOwrmgoxwIIBFScu0GoIBloOyQDkCA20HLGBG2g5DV6A4A22uOABqBEfgBwBAsgRIZAc1IUbhDkNHkVHI6YlNzDBacjwCTh2GjPo0mnO8BnY3CCNU9lpNSw7LYdlB3JUdloOy05TVgDKCho1YGKBGpUdyFHZgRyVHcnBxAuasgIMnaDv4Fpyo-yCRo1Q4Nhp1KBLp0kjAGmEQRqXsgM1KjuQo7IjOSg7kMO7fpqyAlBW0KhBZQeURecGMInKDjCJyg7kaOJpykowNZJ-QG7JjbJLGjUS3NBJGjXg0iVNGglIIw3SuJQdqFHZgRyVHclB2YEclV3SlJWAspJGDXrKB5RF5wYwiZ7zASbRgz6Qo4mnKSvRsdNPzS25WXYaNQrc0CkaNe1Lf3j94b8AAAD__35sPGA=

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll-L2kwUxu_fTyHn6i1MiDNJ3DVQsJSFLixa1LuSi6yZquBmwkyEtYvfvSTpYv3TOZkeTS9j8pt5Zs4PfN4gV5kcpy_SQPwNODAQwCAABiEwiCBhUGi1kMYoXX3SAI_ZK8R9Buu82JbVzwmDhdIS4jco1-VGQgzz9HkjpzLNpPb7wCCTZbre1NsUev2S6t3odfcDGMyKNDdxz_OrnSfbMu6NOBsJSPYM1Lb8tcNh4eddb5Wa1fGS70jCwJTpUkLM9-zvwkaOYQUbcWpY8cewh6W2udKZ1DI7WiypSOyTCyf-kprVTJaTwucn05nvChn3Hsfzh-ns4fO89-npCRhs5Pfy_zr4h496vVy9P9hmdjhfQDjfhfBj5anC59HpTVzcOzzam7cXgbcQwReeH9zQW4e4A-e41zeXd2su79pc0X4cos04As8Pb2iPQ9w757jXt0d0a4_o2p6g_TiCNuMIvfrP6lb2OMS9d457fXuCbu0JurYnbD-OsM04Iu-G7jiEHTqGvb45YbfmhP-yb12INpWmULmRrdpUvzqczJayuSyjtnohv2q1qLdpHic1V7eBTJqyeSuah8e8eVUFbA8PKPCQAnNSbh7Zae5wZcINHlDgIQXmpNwnV3ZGi1O6_zsd2O87sML8-M76p3RIEdwOI4LbYURwO4wJjtCI4BFFcDuMCG6HEcHtMCY4QiOCDyiC31EUtcOIonYYUdQOY4oiNKLoPUVRO4woaocRRe0wpihCI4oOKYpyUk9AaERShEYsRWhMUwzHugKtLNDaAq0uEPsCrTBwUmPgZ5XByVY7jdlqpzFb7TRqK4JjtrqUpfOZubQlVxqz1akvOeOYrWflwWprsv_vZwAAAP__3WZveA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4kwYxe_fTyFz9S5E4jOT-Cew4LJb2EJpl9a7xYvUzFbBmpBEqFv63ReV1ZqY58wkpntp7S9zcvKckxlfxSqO9G34rDMR_BQkHCGFI5RwhCcc4YupI5I0nuksi9Ptv-yB6-hFBD1HLFbJOt_-eeqIWZxqEbyKfJEvtQjEJHxc6nsdRjp1e8IRkc7DxXK3TJIunsN0M37Z_BaOeEjCVRZ0uu525bt1HnTG5IylmL45Il7nxxWyPHzSIqA3x1zFt0WWL1az3PVPJZxb4kg9bjrzMJufR45KpI2S936QrSHSGVOlIaqWIdSGI16llOOl1qs4jXSqo5OL7a5SKVb2sNijCr8tFQaWHVX0G6hwagn9HmbzB53fJa4q-DXZJDroXN9Oru4frr5OOl9uboQjlvpX_v_uJj59ThdP878fzHI4uKzLt3E3TlzlF504u_bwZG2ySJ5B8FzZdVWdLgI6DnPUb72LbByxt8SijUwtoTY88SqlNOwBqt9GF1RhYFlVG9mpaNxG9NFtJM3nX5qMv-q6Xp1GADoOz3LQeiNYOEL2llg0gqkl1IYnXqWUhlmU9RvhgioMLKtqBDsVjRtBfnQjKPP5Vybj73V3RwrrRgA6Ds9y2HojWDhC9pZYNIKpJdSGJ16llIZZVPUb4YIqDCyragQ7FY0bQX10I3jm8--ZjL_frdMHQMXhSY5a7wMLP8jWEIs2MDWE2nDEq5TSMIde_Ta4oAoDy6rawE5F4zbw_uXvF2ek3essiVeZNvp1ore9OR096b1ZWbxOZ_pHGs92y-w_3u243R8ineX7b2n_4Xq1_2or8D1MRZjew94JTHYwyUb0qAkt-01opXhaso4r3nHFLu3zK_MwAd08LXuN6EETWoFJ81jHwcP2LWBZhPssDG56wA9Kn5-UIUuPeHjUJNg8jIINaBBsnkbB5mkUbAJdisqUrxWQbUCjcAMcpRvhYNIBjvJNfKUSwkvtwuGljBNfL-jW-X4hkHIqNYzVK5in4TsY4OglzOPwLczjMK18vdIQGF_qV6u08jRMK4_DtAIcjSyPw7SWWvbEeElg-8S3bAEvpVWWqsYmrZJvGgl2b5LfxwDjAI3SinCQVoCjtAIcbpr5kpU-ML7UsjZpBTRKK8BRWhGORpbHUVolv4WVQ4DzLVvAy2nld7Ho1vmmUT1w1io1jU1aAY3SinCQVoCjtAIcpVXxJaskML7UslanXJ6Gx1weh-dcgKODLo-jtCp-K6uQdXzLFvBSWhW_ly3e-vTtvz8BAAD__zpQDTI=

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8K52piCLdnOh2HQMQorlHY0uRu5cGOtCaSRkR1oVvrfR5yGznGs14pb3TWNH-n10XNy9Exrlcqb5FHmFP8mTowEMQqIUUiMIpoxyrSayzxXevfIHrhKnyj2GS3X2abY_XvGaK60pPiZimWxkhTTNLlfyTuZpFJ7PjFKZZEsV-U2mV4-Jnp78bT9S4wmWbLO417f2-18uyni3gWn2QsjtSlel39b9X7bWyT5orpe-fyMUV4kD5Ji_sLOixk5jSkaY76ts1krnUot08pKsx2JHjnxrj-TfDGRxW3m8aMTmW4zGfeubqaXd5PLH9Pe9-trYrSSf4rPF_zLN718WJR_Nb7622sFNtWfKF1I7fHouFJfG9cPW5TtVEVeFz0R4kb1VeYJ_7jGJ7ePKtvz9nLxFnJ5ou8FH9IFFkEHjoOKxqAO-oA76gNQ_0MfDM7tA9H-fEWb8w36XvghIloEHToOKhqDOhBROBIR1P8g4vBcEYP25xu0Od-wX47l9xfRIujIcVDRGNSBiIEjEUH9DyKOzhUxbH--YZvzjfofoqFFzLHTmKIxpgMJQ0cSguofJBy_x_X0xPp3Ms_UOpetbp7-rmYyfZD7M8jVRs_lL63m5Tb7j7clV143UpkX-2_F_sPVev_VLmB7eNgF5rwTHXWix2aaW9RM2MHDLvBRzWzpqBM9NtPimPb_p4MK7B_DgREOzacVGmHBzVtHXfrDDIP-MMOoPwAN-gPQoD8GXfrDDIP-MMOoPwAN-gPQoD-GRktHZklHXfpj3MVwMwwMN8PIcEADwwGNJoDN2Kz_ktrMTVsaDgGryWmNA815bYpUVOXCLDo3jxFgOq_NERvVAQ1cBzSSHeHAdoQj3Wsz1Ep3M410N9NQd4Aj3QGOdK8N0qruA6B7baZY6V6bKVa6m2mku5mGugMc6Q5wpHttnlrpbqaR7mYa6g5wpDvAke61qVq9a_tm3UVtthh1n718-hcAAP__RbNefQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mN-L6kYcxd_7V8g8tTQSZ77jr0BhS3uhC5fdsvpWfMg101XwmpBEWLvs_17Uq64Z8z2ZJPrmrzNzcuZ7PiS-i3Ucmafwu8lE8I-QwhNKeIKEJ7TwRF_MPJGk8dxkWZzufnIQPEZvIuh5YrlONvnu45kn5nFqRPAu8mW-MiIQ0_DbyryYMDKp3xOeiEweLlf7bZJ0-T1Mtw9v2_-EJyZJuM6CTtff7fy8yYPOgxSzD0_Em_y8fJaHr0YE8sOrbuHPZZYv1_Pc71_ub61_lnzbdhZhtrjy-7MH5eLhcwyyvRyoVg6y3SB0qYnzOpt1nEYmNdHFSvtVSm2qHrB5ttC_lQWU1NnCoIEFr5bLv8JsMTH5c-JTIanpNjFB5_Fp-uVl8uWPaef3r1-FJ1bm3_znB_nLb-nydbF_VWHChi4TNonT3KQ-Wan9Wrr-qEJs1xL5segVE09xN0583StmfHX78cX20qHEFTrsq65PzjQDJk6zObghzVyCaDMJqpWEbDcKXWqiIUxkTZ61aAElVcYzNwuNeSbvxDMwYUeeWalV5Zmq3iNVpUbU9bUzUICJ03AMbwgUhyBkm0lQrSRku1HoUhMN26xqAqVFCyipMqC4WWgMFHUnoIAJOwLFSq0qUKh6j6hKjXR3_1TkBhRg4jQcoxsCxSEI2WYSVCsJ2W4UutREwzZTTaC0aAElVQYUNwuNgUJ3AgqYsCNQrNSqAkVX75GuUqN-1xknwMJpNMY3xIlDDLK9HKhWDrLdIHSpiYZN1jVh0qIFlFQZTNwsNIaJvhNMwIQdYWKlVufvmyvrv5gsideZqfTPTG-XmYlezeEMsniTzs3faTzfb3N4-7zX7T-ITJYfvpWHN4_rw1c7g5_FsiiWn8X6QizdxJKaqJVspB43UdOQVys2ceITJ3brPr8zL5bgvHi1Uk3U1GukHvFqzSY-4MV9B7EqigeseMif9ZAVg2sesWINij3mqdADWLCg4sQFXg3BwMshGYAcoYGXIzZICy2XwSsQvMUWFzwANeIDkCNAADkiBJKDukiLMJfBo-h4xBTkFiYkDxk5AMfOYwZdOs8ZOQKbW6RxKjuvhmXn5bDsQI7Kzsth2XnKKkBZxaMGTCxQo7IDOSo7kKOyIzmYeMVTVoGhU_wdXEFulV3xqFEaHDuPGnTpPGkUII2ySONSdqBGZQdyVHYkB2UHcnjXz1NWAcoqHjWo7ICy6NwAJlHZASZR2YEcTTxPWQJTQ_wDckFulZ141BC4oSMeNeDSiScNAdKQRRqXsgM1KjuQo7IjOSg7kKOyE09ZApQlHjXoKR9QFp0bwCR6zgeYRA_6QI4mnqcsoWPnn5oLcrvsPGo0uKHTPGqKlz77-On_AAAA__-RYO5e

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8K52piCLdnOh2HQMQorlHY0uRu5cGOtCaSRkR1oVvrfR5yGznGs14pb3TWNH-n10XNy9Exrlcqb5FHmFP8mTowEMQqIUUiMIpoxyrSayzxXevfIHrhKnyj2GS3X2abY_XvGaK60pPiZimWxkhTTNLlfyTuZpFJ7PjFKZZEsV-U2mV4-Jnp78bT9S4wmWbLO417f2-18uyni3gWn2QsjtSlel39b9X7bWyT5orpe-fyMUV4kD5Ji_sLOixk5jSkaY76ts1krnUot08pKsx2JHjnxrj-TfDGRxW3m8aMTmW4zGfeubqaXd5PLH9Pe9-trYrSSf4rPF_zLN718WJR_Nb7622sFNtWfKF1I7fHouFJfG9cPW5TtVEVeFz0R4kb1VeYJ_7jGJ7ePKtvz9nLxFnJ5ou8FH9IFFkEHjoOKxqAO-oA76gNQ_0MfDM7tA9H-fEWb8w36XvghIloEHToOKhqDOhBROBIR1P8g4vBcEYP25xu0Od-wX47l9xfRIujIcVDRGNSBiIEjEUH9DyKOzhUxbH--YZvzjfofoqFFzLHTmKIxpgMJQ0cSguofJBy_x_X0xPp3Ms_UOpetbp7-rmYyfZD7M8jVRs_lL63m5Tb7j7clV143UpkX-2_F_sPVev_VLmB7eNgF5rwTHXWix2aaW9RM2MHDLvBRzWzpqBM9NtPimPb_p4MK7B_DgREOzacVGmHBzVtHXfrDDIP-MMOoPwAN-gPQoD8GXfrDDIP-MMOoPwAN-gPQoD-GRktHZklHXfpj3MVwMwwMN8PIcEADwwGNJoDN2Kz_ktrMTVsaDgGryWmNA815bYpUVOXCLDo3jxFgOq_NERvVAQ1cBzSSHeHAdoQj3Wsz1Ep3M410N9NQd4Aj3QGOdK8N0qruA6B7baZY6V6bKVa6m2mku5mGugMc6Q5wpHttnlrpbqaR7mYa6g5wpDvAke61qVq9a_tm3UVtthh1n718-hcAAP__RbNefQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mN-L6kYcxd_7V8g8tTQSZ77jr0BhS3uhC5fdsvpWfMg101XwmpBEWLvs_17Uq64Z8z2ZJPrmrzNzcuZ7PiS-i3Ucmafwu8lE8I-QwhNKeIKEJ7TwRF_MPJGk8dxkWZzufnIQPEZvIuh5YrlONvnu45kn5nFqRPAu8mW-MiIQ0_DbyryYMDKp3xOeiEweLlf7bZJ0-T1Mtw9v2_-EJyZJuM6CTtff7fy8yYPOgxSzD0_Em_y8fJaHr0YE8sOrbuHPZZYv1_Pc71_ub61_lnzbdhZhtrjy-7MH5eLhcwyyvRyoVg6y3SB0qYnzOpt1nEYmNdHFSvtVSm2qHrB5ttC_lQWU1NnCoIEFr5bLv8JsMTH5c-JTIanpNjFB5_Fp-uVl8uWPaef3r1-FJ1bm3_znB_nLb-nydbF_VWHChi4TNonT3KQ-Wan9Wrr-qEJs1xL5segVE09xN0583StmfHX78cX20qHEFTrsq65PzjQDJk6zObghzVyCaDMJqpWEbDcKXWqiIUxkTZ61aAElVcYzNwuNeSbvxDMwYUeeWalV5Zmq3iNVpUbU9bUzUICJ03AMbwgUhyBkm0lQrSRku1HoUhMN26xqAqVFCyipMqC4WWgMFHUnoIAJOwLFSq0qUKh6j6hKjXR3_1TkBhRg4jQcoxsCxSEI2WYSVCsJ2W4UutREwzZTTaC0aAElVQYUNwuNgUJ3AgqYsCNQrNSqAkVX75GuUqN-1xknwMJpNMY3xIlDDLK9HKhWDrLdIHSpiYZN1jVh0qIFlFQZTNwsNIaJvhNMwIQdYWKlVufvmyvrv5gsideZqfTPTG-XmYlezeEMsniTzs3faTzfb3N4-7zX7T-ITJYfvpWHN4_rw1c7g5_FsiiWn8X6QizdxJKaqJVspB43UdOQVys2ceITJ3brPr8zL5bgvHi1Uk3U1GukHvFqzSY-4MV9B7EqigeseMif9ZAVg2sesWINij3mqdADWLCg4sQFXg3BwMshGYAcoYGXIzZICy2XwSsQvMUWFzwANeIDkCNAADkiBJKDukiLMJfBo-h4xBTkFiYkDxk5AMfOYwZdOs8ZOQKbW6RxKjuvhmXn5bDsQI7Kzsth2XnKKkBZxaMGTCxQo7IDOSo7kKOyIzmYeMVTVoGhU_wdXEFulV3xqFEaHDuPGnTpPGkUII2ySONSdqBGZQdyVHYkB2UHcnjXz1NWAcoqHjWo7ICy6NwAJlHZASZR2YEcTTxPWQJTQ_wDckFulZ141BC4oSMeNeDSiScNAdKQRRqXsgM1KjuQo7IjOSg7kKOyE09ZApQlHjXoKR9QFp0bwCR6zgeYRA_6QI4mnqcsoWPnn5oLcrvsPGo0uKHTPGqKlz77-On_AAAA__-RYO5e

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFr2zAYhu_7FeE7bSDjSLbTxjDIGIUVSjKS3IYPbqwlgdQykgPNSv77sD2WxYn1WdOi3Zraj_Tq0wN-3yAXGZ-mL1xB_A0oEGBAIAACIRCIICFQSLHiSglZvdIAj9krxEMC27zYl9W_EwIrITnEb1Buyx2HGJbp847PeZpx6Q-BQMbLdLurtynk9iWVh8nr4QcQWBRpruKB51c7z_ZlPJgwSI4ExL78tfxp1efDYJOqzfl6EwrJMSGgynTNIaZH8ncxI6cxWWfM0zr7XMiMS56drZRUJPbKlbN-SdVmwctZ4dPWjSwPBY8Hj9Plw3zx8Hk5-PT0BAR2_Hv5fkI_fJTb9ab-6_fRaevop2MFFse6knkqPFH4NGoP4Ore4dnetP_N0x437zPPD26iqEHQkeOgrDOoA0mpI0lZ__mzPvMPPD-8iSgGQe8cB2WdQR2IwhyJEvSff9Bn_qFXf3P-vSgGQe8dB2WdQR2IEjgSJew__7DP_CPvJpoYxBw7jck6YzqQJPwP3ehKojlXhcgV79V8htWZeLbmzYyU2MsV_yrFqt6m-TmrufornnFVNk9Z8-Mxbx5VAfvDIxt4bANTq9w00tPUYGTMDB7ZwGMbmFrlbo3sgmZtevgnHejnHWhhej6zYZsObQTXw4jgehgRXA9jgiM0InhkI7geRgTXw4jgehgTHKERwUc2gt_ZKKqHEUX1MKKoHsYURWhE0XsbRfUwoqgeRhTVw5iiCI0oOrZRlFr1BIRGJEVoxFKExjTFcKwr2JUFu7ZgVxcs-4JdYaBWjYFeVAYjW_U0ZquexmzV06itCI7ZalKWLu_MpC2Z0pitRn3JGMdsvSgPWluT47ufAQAA__9XmVno

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFr2zAYhu_7FeE7bSDjSLbTxjDIGIUVSjKS3IYPbqwlgdQykgPNSv77sD2WxYn1WdOi3Zraj_Tq0wN-3yAXGZ-mL1xB_A0oEGBAIAACIRCIICFQSLHiSglZvdIAj9krxEMC27zYl9W_EwIrITnEb1Buyx2HGJbp847PeZpx6Q-BQMbLdLurtynk9iWVh8nr4QcQWBRpruKB51c7z_ZlPJgwSI4ExL78tfxp1efDYJOqzfl6EwrJMSGgynTNIaZH8ncxI6cxWWfM0zr7XMiMS56drZRUJPbKlbN-SdVmwctZ4dPWjSwPBY8Hj9Plw3zx8Hk5-PT0BAR2_Hv5fkI_fJTb9ab-6_fRaevop2MFFse6knkqPFH4NGoP4Ore4dnetP_N0x437zPPD26iqEHQkeOgrDOoA0mpI0lZ__mzPvMPPD-8iSgGQe8cB2WdQR2IwhyJEvSff9Bn_qFXf3P-vSgGQe8dB2WdQR2IEjgSJew__7DP_CPvJpoYxBw7jck6YzqQJPwP3ehKojlXhcgV79V8htWZeLbmzYyU2MsV_yrFqt6m-TmrufornnFVNk9Z8-Mxbx5VAfvDIxt4bANTq9w00tPUYGTMDB7ZwGMbmFrlbo3sgmZtevgnHejnHWhhej6zYZsObQTXw4jgehgRXA9jgiM0InhkI7geRgTXw4jgehgTHKERwUc2gt_ZKKqHEUX1MKKoHsYURWhE0XsbRfUwoqgeRhTVw5iiCI0oOrZRlFr1BIRGJEVoxFKExjTFcKwr2JUFu7ZgVxcs-4JdYaBWjYFeVAYjW_U0ZquexmzV06itCI7ZalKWLu_MpC2Z0pitRn3JGMdsvSgPWluT47ufAQAA__9XmVno

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllGL2kwUhu-_XyHn6itMiDNJ3DVQsJSFCosW9a7kImumKriZMBNh7eJ_L0m6WKOZk-lgcpk1T-adcx7Y9x1SkfBZ_MoVhD-AAgEGBDwg4AOBACICmRRrrpSQxSsVME3eIBwS2KXZIS_-HBFYC8khfId8l-85hLCKX_Z8weOES3cIBBKex7t9eUwmd6-xPE7ejr-AwDKLUxUOHLc4eX7Iw8GEkgmD6ERAHPI_J5w__HIcbGO1vfzkBxIRUHm84RDSE_m3sEEPYVlj2POnDqmQCZc8ufhYVJDYKzdu_C1W2yXP55lLa9tZHTMeDqaz1dNi-fR1Nfjy_AwE9vxn_n8Z_NNnudtsPx7OY6jN4Hw5z-JyN5LPhCMylwb1Mdw82784m7a3gLawwGWO691RWoO4o17issa4HWhLO9WWtd8Fa7MLz3H9O6pjEPehl7isMW4H6rBO1fHa78JrswvfKf9H3Usdg7iPvcRljXE7UMfrVB2__S78NrsInDuKYxB23ENY1hi2A2383jrWjVwLrjKRKt6qQQ2Lm_Fkw6tJKXGQa_5dinV5TPU4L7myASRc5dWvrHqYptVPRcD28MgGHtvA1Co3DfQ0NRgZM4NHNvDYBqZWuWsju6JZnR7-TXv6eXtamF7ObFinfRvB9TAiuB5GBNfDmOAIjQge2AiuhxHB9TAiuB7GBEdoRPCRjeAPNorqYURRPYwoqocxRREaUfTRRlE9jCiqhxFF9TCmKEIjio5tFKVWPQGhEUkRGrEUoTFNMRzrCnZlwa4t2NUFy75gVxioVWOgV5XByFY9jdmqpzFb9TRqK4JjtpqUpeudmbQlUxqz1agvGeOYrVflQWtrdPrvdwAAAP__prFsYg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmE9r40gUxO_7KUyfdkFGft2S_wgWsuwEJhCSIfFt8EGxemKDYwlJhnhCvvtgm7FjyXqlVkuZo-P81NWlV6WW38Q6jvRd-KIzEXwXJBwhhSOUcIQnHOGLmSOSNJ7rLIvT3b8cgJvoVQQDRyzXySbf_XnmiHmcahG8iXyZr7QIxDR8WukHHUY6dQfCEZHOw-Vqv0ySLl_CdHv1uv0pHPGYhOss6PXd3cr3mzzoXZFzJcXs3RHxJj-tkOXhsxYBvTv1VXxZZvlyPc9d_1zCpSVO1NO2twizxWXkpESaKPnoB7VqiGpkCHXhiFcp5XSpzTpOI53q6Oxi-6tUipUDLPakwu9KRQ3LTiqGFiqcRkK_htniUef3iasKfk23iQ56N3fT64fH6_-nvf9ub4UjVvpH_vd-E__8my6fF78_nMaucnOjdi2-i_tx4iq_aMPFtcdna5NB7GqkzpV9VzUpIqDjOETDzovIxJGWLVGNLKEuPPEqpViWADWvohZV1LCsqorMVFhXEX1qFcn6wy_rzL7qu16TOgA6jjdy1HkdGDhCLVuiGllCXXjiVUqxDKJsXgctqqhhWVUdmKmwrgP5qXWg6g-_qjP7Xn__JmFcB0DH8UaOO68DA0eoZUtUI0uoC0-8SimWQVTN66BFFTUsq6oDMxXWdaA-tQ68-sPv1Zl9v9-kDICK422cdF4GBn5Qq4aoRoZQF454lVIsQ-g1r4IWVdSwrKoKzFRYV4H3x36zuKDrQWdJvM50rV8kBrud6ehZH5zK4k0619_SeL5f5vDxfs_t_xDpLD98S4cPN-vDVzuBH2EqwvQR9s5gMoNJWtETG1oObWileFqyjiveccUu7fMr8zAB3TwtB1b0yIZWYNI81nFws30DWBbhIQuDTY_4QRnykzJm6QkPT2yCzcMo2IAGweZpFGyeRsEm0KWoTPlaAdkGNAo3wFG6EQ4mHeAo38RXKiG81C4cXso48fWCts73C4GUU6lhjB7BPA2fwQBHD2Eeh09hHodp5euVxsD4Ur8apZWnYVp5HKYV4GhkeRymtdSyZ8ZLAscnvmULeCmtslQ1JmmVfNNIcHqT_DkGGAdolFaEg7QCHKUV4PDQzJes9IHxpZY1SSugUVoBjtKKcDSyPI7SKvkjrBwDnG_ZAl5OK3-KRVvnm0YNwLtWqWlM0gpolFaEg7QCHKUV4Citii9ZJYHxpZY1esvlafiay-PwPRfg6EWXx1FaFX-UVcg6vmULeCmtij_LFrc-e__rVwAAAP__sgcKHA==

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1r20AQhu_9FWZOLV0j7Uryh6DgUgINhCQkORSKDoq1jQ2OJVYyxA3-78V2TCrLmVdr2brVtZ_d0czzZvRK8zTR1_Gzzin8TZIEKRLkkSCfBAUUCcpMOtZ5npr1T7bAZfJCoStoOs8Wxfq_I0Hj1GgKX6mYFjNNIT3EjzN9p-NEG8clQYku4ulsc01mps-xWY5eln9J0H0Wz_Ow03XWN98sirAzUhStBKWL4u3491Mfl51JnE_K540kRatIUF7ET5pCuRLHlRlYlikblak-LPP9nMU8NYk2OimdFK1J9JMDz_ozzif3urjJHLk3kYdlpsPOxa8fF7cPne9XVyRopv8Un0fyyzczfZps_vXhc78_k2fT-vvUFNo4Mthv09cPz_dr9OxQO94OPVDEddpNM0e5-w0-eH1Qul7WN0vWMMtRXcc7SwQsCu1ZF3rKEMh2QyDbCAFo_i4EvWNDoOoPV9UZrtd1_LNYaFFo37rQU1qo2rVQtWEhaP7Owv6xFnr1h-vVGa7f3Wzj01toUejAutBTWui1a6HXhoWg-TsLB8da6Ncfrl9nuEH3LA5alDm0LPOUBvrtGui3YSBo_c7A4SleSQ-cf6fzLJ3nutbbprtumE6e9HYAebowY31r0vHmmu3Hmw23ectIdF5sv1XbD5fz7VfrAuvD_SawlI3ooBE95Glp0TNlB_ebwHs9s6WDRvSQp9U-7f5PeyXY3Yc9Fvb5afksrCR_ddAkHzwM8sHDKB-ABvkANMhHr0k-eBjkg4dRPgAN8gFokI8-a-mAl3TQJB_DJobzMDCch5HhgAaGAxptAJu1Wf1LarM3bWm4BKw2pzUONJeVLVJSVSpedMmvEWC6rOwRG9UBDVwHNJId4cB2hCPdKzvUSneeRrrzNNQd4Eh3gCPdK4u0rHsP6F7ZKVa6V3aKle48jXTnaag7wJHuAEe6V_aple48jXTnaag7wJHuAEe6V7Zq-V3b5XVXld3C6h6tPv0LAAD__56IWfo=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mN9r4kocxd_vXyHzdC83EueHvwIXvOwWtlDa0vZhYfEhNbNVsCYkEeqW_u-LumrNmO-ZSaJv_jozJ2e-50PiO1vEkb4NX3XGgh-MM48J5jHJPKaYx7ps7LEkjSc6y-J0_ZOt4Dp6Y0HHY7NFsszXH489NolTzYJ3ls_yuWYBewqf5_pBh5FO_Q7zWKTzcDbfbJOks9cwXY3eVr-Yxx6TcJEFrba_3vlumQetkWDjD4_Fy_ywfJaHL5oF_MOzt_B1luWzxST3u8f7j3hh_YPkedWahtn0xO8PHoSLh88xcNccij4PHmSlHHizQahSE4d1los4jXSqo6OVNquU2hQdYPNgoXsuCyipg4VeDQteJZffwmz6qPO7xJeFpJ5WiQ5aV9-_XN0_tf6_uWEem-uf-d8j_s9_6exlunllMV59l_F6jNNcp740Ivu3dP2BRWan4viz6AkTt3E7TnzVKQZ8cvvh0fbcocEWBfZF25fOKAMm9oPZOyPKXIJwT8IWZrZJ8GajUKUmapKEV4RZgxZQUmUwc7NQG2b8EjAD47WDmRGZLcyEfYmETYdk21fONAEm9pPRPyNNHILg7knY0sQ2Cd5sFKrURM0qi4o0adACSqqMJm4WatNEXIImYLx2NDEis6WJtC-RtOmQam8ehtxoAkzsJ2NwRpo4BMHdk7CliW0SvNkoVKmJmlWWFWnSoAWUVBlN3CzUpom8BE3AeO1oYkRmSxNlXyJl06Fu25klwMJ-LoZnZIlDDNw1B1uS2ObAmw1ClZqoWWNVkSQNWkBJlZHEzUJtkqhLkASM144kRmRV_rI5sf6DzpJ4kWmrf2M668B09KK3B5DFy3Si79N4stlm-_Zuo9t8EOks337Lt2-uF9uv1gY_i3lRzD-L1ZGYu4m5rKMWvJZ6WEct-7RakIlLOnFJbt2ld6bFHJwXrRaijlp2aqkHtFqRifdocddBLIriHinu02fdJ8XgmgekWIFiD2kqdAAWDKg4cYFWQzDQckgGIEdooOWIDdxAy3HwAgRvsMUFD0CN-ADkCBBAjgiB5KAu3CDMcfAoOhoxBbmBCU5DhvfAsdOYQZdOc4YPwOYGaZzKTqth2Wk5LDuQo7LTclh2mrICUFbQqAETC9So7ECOyg7kqOxIDiZe0JQVYOgEfQdXkBtlFzRqhALHTqMGXTpNGgFIIwzSuJQdqFHZgRyVHclB2YEc3vXTlBWAsoJGDSo7oCw6N4BJVHaASVR2IEcTT1NWgqmR9ANyQW6UXdKokeCGTtKoAZcuadJIQBppkMal7ECNyg7kqOxIDsoO5KjskqasBJSVNGrQUz6gLDo3gEn0nA8wiR70gRxNPE1ZiY6dfmouyM2y06hR4IZO0agpXvr446_fAQAA__8-NOnb

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ltFq2zAUhu_3FOFcbSDjSLbTxjDIGIUVSlPaXAyGL9z4LAmktpEcaFby7sP2WBYn0bGmRndN7U_6dfSB_zfIiwzv0xdUEP8ADgwEMAiAQQgMIkgYlLKYo1KFrF9pgdvsFeIhg1Vebqr63wmDeSER4jeoVtUaIYZZ-rzGR0wzlP4QGGRYpat1s00pVy-p3E5et7-AwVOZ5ioeeH6983RTxYOJgGTHoNhUf5bfr_q8HSxTtTxcb8Ih2SUMVJUuEGK-Y_8XM3IaU5yNuV9nkxcyQ4nZwUpJTVKvnDjrt1Qtn7Calj7v3MhsW2I8uPn-9eZhNvhydwcM1viz-jjhnz7L1WLZ_PX33Lxz7v2ZAosznQh8X3hF6fOoe_qTe4cHe_P-1857XLsvPD-4iJ8GQUeOg4qzQR0Yyl0YKvoPX_QZfuD54UUsMQh65TioOBvUgSXChSVB_-EHfYYfes2n5v0tMQh67TioOBvUgSWBC0vC_sMP-ww_8i7iiEHMsdOY4mxMB4aErvvQiTiPqMoiV9ir7QzrA2G2wHZAqtjIOT7IYt5s0_6cNlzz5c5QVe1T0f64zdtHdcD-8MgGHtvA3Co3j_Q0NxiZMINHNvDYBuZWuTsjO6JFlx7-Swf6eQdamB_ObNilQxvB9TAhuB4mBNfDlOAETQge2QiuhwnB9TAhuB6mBCdoQvCRjeBXNorqYUJRPUwoqocpRQmaUPTaRlE9TCiqhwlF9TClKEETio5tFOVWPYGgCUkJmrCUoClNKZzqCnZlwa4t2NUFy75gVxi4VWPgR5XByFY9Tdmqpylb9TRpK4FTtpqUpeM7M2lLpjRlq1FfMsYpW4_Kg9bWZPfhdwAAAP__ubNVYA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1r-kgYxe_3U8hc7UIkPjOJL4EFl90_bKG0pe3FwuJFamarYE1IItQt_e5_VNCaNM_JZEbv-uIvc-bkOScTP8Q6TfRd_KYLEf0rSHhCCk8o4YlAeCIUM09keTrXRZHmu48cgJvkXUQDTyzX2abc_XnmiXmaaxF9iHJZrrSIxHP8stKPOk507g-EJxJdxsvVfpksX77F-Xb6vv1feOIpi9dF1Ov7u5XvN2XUm0ox-_REuilPly_K-FWLiD699hL-Whblcj0v_fB8_SlVrn9CXra9RVwsvvn8SYM00fDVBnLng-rkA7k1ImgUcbrOZp3mic51cnal_VUaZcoBkHmSEF5KAnLqJGFoIcHrpPLvuFg86fI-81XFqedtpqPej3_-_PHw3Pvj9lZ4YqX_K3-d0m-_58vXxf6n43g172nk1ta7tJ9mvgqru_927fHZ2mQQrxbp8mXfV8Y9A0Qcp2Z4wZ4xMcKlE6qTE-TWiqBRhGXMqWPTOJSAnGpqGjMJ1k1D12ga2X7IZZsZV30_ME47EHG8c6MLpt3ACHLphOrkBLm1ImgUYRk12THtDiUgp5rSbibBOu3yGmlX7YdctZnxoL8_6ZulHYg43rnxBdNuYAS5dEJ1coLcWhE0irCMmuqYdocSkFNNaTeTYJ12dY20B-2HPGgz42HfOOtAwvG-TS6YdQMbyJ0PqpMP5NaIoFGEZcyCjkl3KAE51ZR0MwnWSQ-u_X3BN3IedZGl60K3-jZgsNuQTl71waAi3eRz_ZCn8_0yh1_v99z-D4kuysN_6fDLzfrwr53ArzBVYfoKB2cwmcEkreiJDS2HNrRSPC1ZxxXvuGKXDvmVeZiAbp6WAyt6ZEMrMGkB6zi42aEBLKvwkIXBpkf8oAz5SRmz9ISHJzbB5mEUbECDYPM0CjZPo2AT6FJUpnytgGwDGoUb4CjdCAeTDnCUb-IrlRBeaxcOr2Wc-HpBW-f7hUDKqdYwRo9gnobPYICjhzCPw6cwj8O08vVKY2B8rV-N0srTMK08DtMKcDSyPA7TWmvZM-MlgeMT37IVvJZWWasak7RKvmkkOL1J_hwDjAM0SivCQVoBjtIKcHho5ktWhsD4WsuapBXQKK0AR2lFOBpZHkdplfwRVo4BzrdsBa-nlT_Foq3zTaMG4F2r1jQmaQU0SivCQVoBjtIKcJRWxZesksD4WssaveXyNHzN5XH4ngtw9KLL4yitij_KKmQd37IVvJZWxZ9lq1ufff7yMwAA__8wq-az

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9r2zwUxu_fT2HO1TumYEu288dQ6BgdK5S2tLkYbLlwY60JpLGRHWhW-t2HnYbOcaLHihvdNbV_Uo7O78nRCy3TRF7HTzKn6CdxYiSIkU-MAmIU0oRRptKpzPNUla9sgMvkmSKP0XyZrYry3xNG01RJil6omBcLSRGN44eFvJNxIpXrEaNEFvF8UW2TqflTrNbnz-s_xOg-i5d55PTccudv80UhVeScc-fXyvP8qSOiKLq8Hg-J0c2qKJ_Q5JVRuire9n7f8mHtzOJ8Vt-sen_CKC_iR0kRf2XH1RAeXYM8--gixMEi3tdZLVOVSCWT2kqTkkSv7DmJ73E-u5fFTebynWaO15mMnIsfXy9ux86XqytitJC_i__P-aczNX-cVX8drPu9Jt-kMfepKqRyebh7TJ8Prh-0OLN9x_G26J4vcZ320swV3u4B790-rG3P23vHW3jnip7r20-PQRX9DlWcOj_cbn64jfyA1mzz0z82P6J960Wb1vs9N7AvsEEVgw5VnFpgYVdgYUNg0JqtwINjBfbbt95v0_qgV90QLAtsUMWwQxWnFti3K7BvQ2DQmq3Aw2MFDtq3PmjT-rBnX1-DGkZH13BqeQO78gY25AWN2co7-ojr957172SepctctrpZe-WByeRRbhqQpys1lbcqnVbbbD7eVFx1LUpkXmyeis2Hy-XmUfkF28ODLjDnneiwEz3S09zgzIQZPOgC75yZKR12okd6WuzS3r-0X4O9XdjXwoG-W4EWFly_ddglH3oY5EMPo3wAGuQD0CAf_S750MMgH3oY5QPQIB-ABvkYaC0d6iUddsnHqIvhehgYroeR4YAGhgMaTQCTsdn8JTWZm6Y0HAJGk9MYB5rzxhSpqcqFXnSuHyPAdN6YIyaqAxq4DmgkO8KB7QhHujdmqJHuehrprqeh7gBHugMc6d4YpHXd-0D3xkwx0r0xU4x019NIdz0NdQc40h3gSPfGPDXSXU8j3fU01B3gSHeAI90bU7V-1_b0uovGbNHqPnn9728AAAD___m9p94=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1r40YYhe_7K8xctVRGmg9_RLCQ0m5pYEmWTS4KbS601jQWeC0hybBuyH8vtms71ljvmdHIvkssn5mjM-95kPzKlnmq75NvumLxX4yzgAkWMMkCpljARuw5YEWZz3RV5eXmKzvBXfqdxVHAsmWxqjcfPwdslpeaxa-szuqFZjF7Sr4u9BedpLoMIxawVNdJtthuU5TZt6Rc335f_8sC9lgkyyoeDMPNzr9ni1qX8eCWD_5eRZGcDUQcx3f3T1MWsIdVvbnCnt8Clq_q495VnbxoFvO3wN7fb1lVZ8tZHY5OzRnrHyVf14N5Us3PfP_oQbh4eJ8R7x6S_uCSkuyUEu83JtVq4rjOapmXqS51erLSdpVWmyICNo8WRpeygJI6Whh7WAg6ufwjqeaPun4oQtlI6mld6Hjw8c9fP35-Gvzy6RML2EL_U_94y3_6UGYv8-1fFuM1cRmvx7ysdRlKI7KfW9efWmR2Lo7_Fz1j4j4f5kWoombAZ7e_OdmeO_Tbot6hGIayXwoCh4epHV-Qgi4p-cTkw0HbnHi_QalWE54Q4h052KMFlFQbB90seHOQX4ODYLz2HDQis-WgsK-YsGmYHIaqXxABh4exmVwQRA4pcZ-YfEBkmxPvNyjVasKTAqIjiHq0gJJqA5GbBW8QiWuACIzXHkRGZLYgkvYVkzYNU8PtC1qPIAIOD2MzvSCIHFLiPjH5gMg2J95vUKrVhCcFZEcQ9WgBJdUGIjcL3iCS1wARGK89iIzIbEGk7CumbBo2GvaLIeDvMDQ3F8SQQ0a8e0g-ELJNifcbk2o14UkA1RFCPVpASbVByM2CN4TUNSAExmsPISOyLj9PnVn_i66KfFlpq1-eok1gOn3RuwOo8lU505_LfLbdZvfvw1a3_SDVVb27ynf_3C13lzYG34t5U8zfi9WJmLuJufRRC-6lvvFRywmtFmTikk5ckluP6J1pMQfnRauF8FHLyEs9pdWKTHxMi0cOYtEUj0nxhD7rCSkG9zwlxQoU-4amQgSwYEDFiQu0GoKBlkMyADlCAy1HbOAGWk6DFyB4gy0ueABqxAcgR4AAckQIJAd14QZhToNH0dGIacgNTHAaMnwMjp3GDLp1mjN8CjY3SONUdloNy07LYdmBHJWdlsOy05QVgLKCRg2YWKBGZQdyVHYgR2VHcjDxgqasAEMn6Ce4htwou6BRIxQ4dho16NZp0ghAGmGQxqXsQI3KDuSo7EgOyg7k8KmfpqwAlBU0alDZAWXRuQFMorIDTKKyAzmaeJqyEkyNpF-QG3Kj7JJGjQQPdJJGDbh1SZNGAtJIgzQuZQdqVHYgR2VHclB2IEdllzRlJaCspFGD3vIBZdG5AUyi93yASfSiD-Ro4mnKSnTs9FtzQ26WnUaNAg90ikZN89af3374LwAA__9lNDfO

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElk1v2kAQhu_9FdacWnWRvWubD0uRqKpUjRQlUcKhUuuDg7cBiWBrbaTQiP9eAaGpbbKvFwdzC4HHw-w8L7PPNE9ieRU9yoyCn8SJkSBGLjHyiJFPIaNUJWOZZYlaf2QLXMRPFDiMpvN0ka__HTIaJ0pS8Ez5NJ9JCmgU3c_krYxiqWyHGMUyj6azTZlUTR8jtRw-Lf8Qo7s0mmeB1bHXlb9NZ7lUgTXk1q-F47jyzOJBEFxcjfrE6HqRB9ZQULhilCzyl-KvNe-X1iTKJsVqQ07hKmSU5dGDpICv2GFN-Ac3Mbbc9-1BvNnD63MW80TFUsm48KRwTaKP7DmI71E2uZP5dWrz0jBHy1QG1vmPr-c3I-vL5SUxmsnf-cch_3Smpg-TzV__-ualvl97ck3mcpeoXCqb--Vj-vzm870aZ7bvOF4euudLXCWdJLWFUz7gveX9QnleXzteQztbdGz3BOkxaKPboI0j54e3mx_eRn7AZHb56R6aH1F_8qLO5N2O7Z1AYIM2eg3aOLLAol2BRRsCg8nsBO4dKrBbf_Juncl7nc0FoW2BDdroN2jjyAK77QrstiEwmMxO4P6hAnv1J-_VmbzfOYG-Bk0MDm7iyPJ67crrtSEvmMtO3sF7XL_3PP9WZmkyz2Stm7WzPjAZP8jtALJkocbyRiXjTZnty-sNt7kWxTLLt--K7YuL-fat9ResD_eawJw3ov1G9EBPc4MzE2ZwrwlcOjNT2m9ED_S0KNPO_7RbgJ0y7GphTz8tTwsLri_tN8mHHgb50MMoH4AG-QA0yEe3ST70MMiHHkb5ADTIB6BBPnpaS_t6SftN8jFoYrgeBobrYWQ4oIHhgEYbwGRtVn9JTfamKQ2XgNHmNMaB5ryyRQqqcqEXnevXCDCdV_aIieqABq4DGsmOcGA7wpHulR1qpLueRrrraag7wJHuAEe6VxZpUfcu0L2yU4x0r-wUI931NNJdT0PdAY50BzjSvbJPjXTX00h3PQ11BzjSHeBI98pWLd61Hb3uorJbtLqHqw9_AwAA__-YNKfo

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFtr40Ycxd_7KcQ8tVRGmosvESy4tFsaWJJlk4dCmwetNU0EXktIMmwa8t2L7caONdb_zGhkv_l2Zo7O_M8PyS9sVWT6Jv2ma5b8xTgLmWAhkyxkioVszB5CVlbFQtd1UW1-shNcZ99ZEocsX5XrZvPxQ8gWRaVZ8sKavFlqlrD79OtSf9FppqsoZiHLdJPmy-02ZZV_S6vn-ffnf1nI7sp0VSfBKNrs_Hu-bHSVBHMe_L2OY6k_BDxJkuub-xkL2e26SYK5YA-vISvWzWHzukkfNUv4a2hv8Le8bvLVoonGx-7mvLX-QfL1OXhK66cTvz94EC4e3ofE-6e0CKR9SLJXSHzYlFSnicM661VRZbrS2dFK21U6bYoY2DxYGJ_LAkrqYGHiYSHs5fKPtH66081tGclWUvfPpU6Cj3_--vHzffDLp08sZEv9T_PjnP_0ocofn7av9uPVfU1Tl_G6K6pGV5E0Ivu5c_2ZRWan4vh_0RMmbopRUUYqbgd8cvuro-25Q70t2h2JUSQHpiCwuB_byRkp6BKTT04eHLSNiQ-bk-o04Qkh3pODA1pASXVx0M2CNwf5JTgIxuuNg0ZkthwU9g0TNgWTo0gNDCJgcT830zOCyCEm7pOTB4hsY-LD5qQ6TXhSQPQE0YAWUFJdIHKz4A0icQkQgfF6A5ERmS2IpH3DpE3B1Gj7fDYkiIDF_dzMzggih5i4T04eILKNiQ-bk-o04UkB2RNEA1pASXWByM2CN4jkJUAExusNREZktiBS9g1TNgUbjwbGEDC4n5qrM2LIISTePyUPCNmGxIdNSXWa8CSA6gmhAS2gpLog5GbBG0LqEhAC4_UGISOyPn9PnVj_i67LYlVrq3-e4k1gOnvUuwOoi3W10J-rYrHdZvf2dqvbfpDputl9y3dvrle7rzYG34t5W8zfi9WRmLuJufRRC-6lvvJRyymtFmTikk5ckluP6Z1pMQfnRauF8FHL2Es9o9WKTHxCi8cOYtEWT0jxlD7rKSkG1zwjxQoU-4qmQgywYEDFiQu0GoKBlkMyADlCAy1HbOAGWo6DFyB4gy0ueABqxAcgR4AAckQIJAd14QZhjoNH0dGIackNTHAaMnwCjp3GDLp0mjN8BjY3SONUdloNy07LYdmBHJWdlsOy05QVgLKCRg2YWKBGZQdyVHYgR2VHcjDxgqasAEMn6Du4ltwou6BRIxQ4dho16NJp0ghAGmGQxqXsQI3KDuSo7EgOyg7k8K6fpqwAlBU0alDZAWXRuQFMorIDTKKyAzmaeJqyEkyNpB-QW3Kj7JJGjQQ3dJJGDbh0SZNGAtJIgzQuZQdqVHYgR2VHclB2IEdllzRlJaCspFGDnvIBZdG5AUyi53yASfSgD-Ro4mnKSnTs9FNzS26WnUaNAjd0ikZN-9IfXn_4LwAA__9DIDfY

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllFr2zwUhu-_XxHO1TeQcSTbaWMYZIzCCqUpbS4GwxdurCWB1DKSA81K_vuwvZLFyXSsncS7dOxHeqXzQN43yFUm79MXaSD-BhwYCGAQAIMQGESQMCi0mktjlK4-aYDb7BXiIYNVXmzK6ueEwVxpCfEblKtyLSGGWfq8lo8yzaT2h8Agk2W6WtfbFHr1kurt5HX7Axg8FWlu4oHnVztPN2U8mHA2EZDsGKhN-WuH_cLP28EyNcvDJd-RhIEp04WEmO_Y34WNHMMKNuHUsOKPYfdLbXKlM6lldrBYUpHYJydO_CU1yydZTguft6Yz2xYyHtx8_XzzMBt8ursDBmv5vfy_Tv3ho14tlu8PtoHtDxcQDnci-b3yVOHzqH0NJ_cOD_bm3S3gHSzwhecHF5TWIe7IOe75teX9ast71VZ0n4XoMovA88MLquMQ98o57vnVEf2qI3pVJ-g-i6DLLEKv_o-6lDoOca-d455fnaBfdYJe1Qm7zyLsMovIu6A4DmHHjmHPr03YrzbhP-tYJ3I9SlOo3MhODWpYnUxmC9nclFEbPZcPWs3rbZrHac3VDSCTpmzeiubhNm9eVQG7wyMKPKbAnJSbR3aaO1yZcINHFHhMgTkpd-vKjmjRpoe_04H9vgMrzA_vbNimQ4rgdhgR3A4jgtthTHCERgSPKILbYURwO4wIbocxwREaEXxEEfyKoqgdRhS1w4iidhhTFKERRa8pitphRFE7jChqhzFFERpRdExRlJN6AkIjkiI0YilCY5piONYVaGWB1hZodYHYF2iFgZMaAz-qDE622mnMVjuN2WqnUVsRHLPVpSwdz8ylLbnSmK1OfckZx2w9Kg9WW5Pdfz8DAAD__7IPavA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9r4kwYxe_fTyFz9S5E4jOT-Cew4LJb2EJpS9uLhcWL1MxWwZqQRKhb-t0XldWamOfMJKZ7ae0vc3LynJMZX8UyjvR1-KwzEfwUJBwhhSOUcIQnHOGLiSOSNJ7qLIvTzb_sgMvoRQQ9R8yXySrf_HniiGmcahG8inyeL7QIxEP4uNB3Oox06vaEIyKdh_PFdpkknT-H6Xr8sv4tHHGfhMss6HTdzco3qzzojMkZSzF5c0S8yg8rZHn4pEVAb465im_zLJ8vp7nrH0s4tcSBelx3ZmE2O40clEgbJe_9IFtDpDOmSkNULUOoDUe8SimHS62WcRrpVEdHF9tepVKs7GGxBxV-WyoMLDuo6DdQ4dQS-j3MZvc6v0lcVfDrYZ3ooHPx4-vF7UPny9WVcMRC_8r_397Bp8_p_Gn294NZCAfntfg67saJq_yiDSfXHh6tTRaxM0idK7uuqlNEQMd-iPqtF5GNI_aWWFSRqSXUhidepZSGJUD1q-iMKgwsq6oiOxWNq4g-tIqk-fBLk9lXXderUwdAx_5BDlqvAwtHyN4SizowtYTa8MSrlNIwiLJ-HZxRhYFlVXVgp6JxHcgPrQNlPvzKZPa97vYkYV0HQMf-QQ5brwMLR8jeEos6MLWE2vDEq5TSMIiqfh2cUYWBZVV1YKeicR2oD60Dz3z4PZPZ97t1ygCo2D_GUetlYOEH2RpiUQWmhlAbjniVUhqG0KtfBWdUYWBZVRXYqWhcBd4_-83ihK47nSXxMtNGv0j0Nnemoye9cyqLV-lU36bxdLvM7uPNltv-IdJZvvuWdh8ul7uvNgLfw1SE6T3sHcFkB5NsRI-a0LLfhFaKpyXruOIdV-zSPr8yDxPQzdOy14geNKEVmDSPdRw8bN8ClkW4z8Lgpgf8oPT5SRmy9IiHR02CzcMo2IAGweZpFGyeRsEm0KWoTPlaAdkGNAo3wFG6EQ4mHeAo38RXKiG81C4cXso48fWCbp3vFwIpp1LDWL2CeRq-gwGOXsI8Dt_CPA7TytcrDYHxpX61SitPw7TyOEwrwNHI8jhMa6llj4yXBLZPfMsW8FJaZalqbNIq-aaRYPcm-X0MMA7QKK0IB2kFOEorwOGmmS9Z6QPjSy1rk1ZAo7QCHKUV4WhkeRylVfJbWDkEON-yBbycVn4Xi26dbxrVA2etUtPYpBXQKK0IB2kFOEorwFFaFV-ySgLjSy1rdcrlaXjM5XF4zgU4OujyOEqr4reyClnHt2wBL6VV8XvZ4q1P3v77EwAA__8vwwiq

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lk1r20AQhu_9FWZOLV0j7Uryh6CQUgINhCQkORSKD4q1jQ2OJVYyxA3578VyTCrLmVdrybrVtZ7d8czzZvRCyyTWV9GTzij8TZIEKRLkkSCfBAU0EZSaZKqzLDGbR7bARfxMoStovkxX-ea_J4KmidEUvlA-zxeaQrqPHhb6VkexNo5LgmKdR_NFcU1q5k-RWZ89r_-SoLs0WmZhr-9sbr5e5WHvTNLkVVCyyt-Ofz_1Yd2bRdmsfF7x_ERQlkePmkL5Ko4rM7AsUzUqU31Y5vs5q2ViYm10XDppsiHRIwd-688om93p_Dp15N5E7tepDnvnv36c39z3vl9ekqCF_pN_PpNfvpn546z414fjef9Nnk3r7xKTa-PIYL9NXz8836_Rs0PteDv0QBFXST9JHeXuN_jg9UHpelnfLFnDLEf1He8kEbAodGBdaJshkN2GQHYRAtD8XQgGx4ZA1R-uqjNcr-_4J7HQotChdaFtWqi6tVB1YSFo_s7C4bEWevWH69UZrt8vtnH7FloUOrIutE0LvW4t9LqwEDR_Z-HoWAv9-sP16ww36J_EQYsyx5Zltmmg362BfhcGgtbvDBy38Up64PxbnaXJMtO13jbdTcN0_Ki3A8iSlZnqG5NMi2u2H68LrnjLiHWWb79V2w8Xy-1XmwLrw8MmsJSN6KARPeZpadEzZQcPm8B7PbOlg0b0mKfVPu3-T3sl2N2HPRb2-Wn5LKwkf3XQJB88DPLBwygfgAb5ADTIx6BJPngY5IOHUT4ADfIBaJCPIWvpiJd01CQf4yaG8zAwnIeR4YAGhgMabQCbtVn9S2qzN21puASsNqc1DjSXlS1SUlUqXnTJrxFguqzsERvVAQ1cBzSSHeHAdoQj3Ss71Ep3nka68zTUHeBId4Aj3SuLtKz7AOhe2SlWuld2ipXuPI1052moO8CR7gBHulf2qZXuPI1052moO8CR7gBHule2avld2-V1V5Xdwuo-ef30LwAA__-bP1n6

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1r4kwcxe-fTyFz9SwbifPiW2Chy25hC6UtbS8WFi9SM1sFa0ISoW7pd1_UVWvG_M9MEr3z7cycnPmfH4lvbB5H-iZ80RkLfjHOPCaYxyTzmGIe67KRx5I0Hussi9PVTzaCq-iVBR2PTefJIl99PPLYOE41C95YPs1nmgXsMXya6XsdRjr1O8xjkc7D6Wy9TZJOX8J0efG6_MM89pCE8yxotf3VzreLPGhdcDZ691i8yPfLZ3n4rFnA3z17C9-nWT6dj3O_e7i_sf5e8rRsTcJscuT3ew_CxcPHGLhrDqI0B1kpB95sEKrUxH6dxTxOI53q6GCl9SqlNkUH2Nxb6J7KAkpqb6FXw4JXyeWPMJs86Pw28WUhqcdlooPW5c9vl3ePra_X18xjM_07__-Cf_qSTp8n61cWNeu7jNdDnOY69aUR2efS9QcWmR2L49-iR0zcxO048VWnGPDR7YcH23OHBlsU2BdtXzqjDJjYDWbvhChzCcI9CVuY2SbBm41ClZqoSRJeEWYNWkBJlcHMzUJtmPFzwAyM1xZmRmS2MBP2JRI2HZJtXznTBJjYTUb_hDRxCIK7J2FLE9skeLNRqFITNassKtKkQQsoqTKauFmoTRNxDpqA8drSxIjMlibSvkTSpkOqvX4YcqMJMLGbjMEJaeIQBHdPwpYmtknwZqNQpSZqVllWpEmDFlBSZTRxs1CbJvIcNAHjtaWJEZktTZR9iZRNh7ptZ5YAC7u5GJ6QJQ4xcNccbElimwNvNghVaqJmjVVFkjRoASVVRhI3C7VJos5BEjBeW5IYkVX5y-bI-vc6S-J5pq3-jemsAtPRs94cQBYv0rG-S-PxepvN29u1bv1BpLN88y3fvLmab75aGfwo5kUx_yhWB2LuJuayjlrwWuphHbXs02pBJi7pxCW5dZfemRZzcF60Wog6atmppR7QakUm3qPFXQexKIp7pLhPn3WfFINrHpBiBYo9pKnQAVgwoOLEBVoNwUDLIRmAHKGBliM2cAMth8ELELzBFhc8ADXiA5AjQAA5IgSSg7pwgzCHwaPoaMQU5AYmOA0Z3gPHTmMGXTrNGT4AmxukcSo7rYZlp-Ww7ECOyk7LYdlpygpAWUGjBkwsUKOyAzkqO5CjsiM5mHhBU1aAoRP0HVxBbpRd0KgRChw7jRp06TRpBCCNMEjjUnagRmUHclR2JAdlB3J4109TVgDKCho1qOyAsujcACZR2QEmUdmBHE08TVkJpkbSD8gFuVF2SaNGghs6SaMGXLqkSSMBaaRBGpeyAzUqO5CjsiM5KDuQo7JLmrISUFbSqEFP-YCy6NwAJtFzPsAketAHcjTxNGUlOnb6qbkgN8tOo0aBGzpFo6Z46aP3__4GAAD__zkG6ds=

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll1r2zAUhu_3K8K52piCLdnOh2HQMQorlLa0vRiMXLix1gTSyMgONCv97yNOQ-c41mvFje6axo_0-ug5OXqhpUrlVfIkc4p_EydGghgFxCgkRhFNGGVaTWWeK715ZAtcpM8U-4zmy2xVbP49YTRVWlL8QsW8WEiK6T55WMhbmaRSez4xSmWRzBflNpmePyV6ffa8_kuM7rJkmce9vrfZ-XpVxL0zTpNXRmpVvC3_vurDujdL8ll1vfL5CaO8SB4lxfyVHRczchpTNMZ8X2e1VDqVWqaVlSYbEj1y4F1_JvnsThbXmcf3TuR-ncm4d_7rx_nNfe_75SUxWsg_xecz_uWbnj_Oyr8a3_v9nQKb0t8pXUjt8Wi_TF8b1w9b1OxQOd4WPRDiSvVV5gl_v8AHt48q2_P2ZvEWZnmi7wUnaQGLoAPHQUVjUAdNwF00ASj-rgkGxzaBaH-4os3hBn0vPImFFkGHjoOKxqAOLBQuLATF31k4PNbCoP3hBm0ON-yX0_jjLbQIOnIcVDQGdWBh4MJCUPydhaNjLQzbH27Y5nCj_kkctIg5dhpTNMZ0YGDowkBQ-p2B44-4kh5Y_1bmmVrmstVt098UTKaPcnsAuVrpqbzRalpus_14XXLlLSOVebH9Vmw_XCy3X20CtoeHXWDOO9FRJ3psprlFzYQdPOwC79XMlo460WMzLfZp_386qMD-PhwY4dB8WqERFty8ddSlP8ww6A8zjPoD0KA_AA36Y9ClP8ww6A8zjPoD0KA_AA36Y2i0dGSWdNSlP8ZdDDfDwHAzjAwHNDAc0GgC2IzN-i-pzdy0peEQsJqc1jjQnNemSEVVLsyic_MYAabz2hyxUR3QwHVAI9kRDmxHONK9NkOtdDfTSHczDXUHONId4Ej32iCt6j4AutdmipXutZlipbuZRrqbaag7wJHuAEe61-aple5mGulupqHuAEe6AxzpXpuq1bu2b9Zd1GaLUffJ66d_AQAA__8uW1n1

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE9r60YUxff9FGZWLZWRZ-74n6CQ0j7og5CEJItC8UKxprHBsYQkQ9yQ715sP9uxxrpHI8ne-d-ZOTpzzw_JH2IZR-YufDOZCP4RUnhCCU-Q8IQWnuiLiSeSNJ6aLIvTzU92gu_Ruwh6npgvk1W--XjiiWmcGhF8iHyeL4wIxHP4sjCPJoxM6veEJyKTh_PFdpsknb-F6frmff2f8MRTEi6zoNP1Nzvfr_KgcyPF5NMT8So_Lp_l4asRgfz0qlv4c57l8-U09_un-1vrHyUv684szGZnfn_0oFw8fI1BtpcD1cpBthuELjVxXGe1jNPIpCY6WWm7SqlN1QM2jxb6l7KAkjpaGDSw4NVy-VeYzZ5Mfp_4VEjqeZ2YoPPt7z--PTx3fr-9FZ5YmH_zn2_kL7-l89fZ9lWF8Rq6jNdTnOYm9cmK7NfS9UcVMjsXx49Fz5i4i7tx4uteMeCz249PtpcODa5QYF91fXJGGTBxGMzBBVHmEkSbSVCtJGS7UehSEw1JImvCrEULKKkymLlZaAwzeQ2YgfHaw8yKrCrMVPUSqSodoq6vnWkCTBwmY3hBmjgEIdtMgmolIduNQpeaaFhlVZMmLVpASZXRxM1CY5qoa9AEjNeeJlZkVWlC1UtEVTqku9uHITeaABOHyRhdkCYOQcg2k6BaSch2o9ClJhpWmWrSpEULKKkymrhZaEwTugZNwHjtaWJFVpUmunqJdJUO9bvOLAEWDnMxviBLHGKQ7eVAtXKQ7QahS000rLGuSZIWLaCkykjiZqExSfQ1SALGa08SK7I6f9mcWf_RZEm8zEylf2N6m8BM9Gp2B5DFq3RqHtJ4ut1m9_Z-q9t-EJks330rd2--L3dfbQx-FcuiWH4V6xOxdBNLaqJWspF63ERNQ16t2MSJT5zYrfv8zrxYgvPi1Uo1UVOvkXrEqzWb-IAX9x3EqigesOIhf9ZDVgyuecSKNSj2mKdCD2DBgooTF3g1BAMvh2QAcoQGXo7YIC20nAavQPAWW1zwANSID0COAAHkiBBIDuoiLcKcBo-i4xFTkFuYkDxk5AAcO48ZdOk8Z-QIbG6RxqnsvBqWnZfDsgM5Kjsvh2XnKasAZRWPGjCxQI3KDuSo7ECOyo7kYOIVT1kFhk7xd3AFuVV2xaNGaXDsPGrQpfOkUYA0yiKNS9mBGpUdyFHZkRyUHcjhXT9PWQUoq3jUoLIDyqJzA5hEZQeYRGUHcjTxPGUJTA3xD8gFuVV24lFD4IaOeNSASyeeNARIQxZpXMoO1KjsQI7KjuSg7ECOyk48ZQlQlnjUoKd8QFl0bgCT6DkfYBI96AM5mniesoSOnX9qLsjtsvOo0eCGTvOoKV765POn_wMAAP__mkXp1g==

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ltFq2zAUhu_3FOFcbSDjSLbTxjDIGIUVSlPaXAyGL9z4LAmktpEcaFby7sP2WBYn0bGmRndN7U_6dfSB_zfIiwzv0xdUEP8ADgwEMAiAQQgMIkgYlLKYo1KFrF9pgdvsFeIhg1Vebqr63wmDeSER4jeoVtUaIYZZ-rzGR0wzlP4QGGRYpat1s00pVy-p3E5et7-AwVOZ5ioeeH6983RTxYOJgGTHoNhUf5bfr_q8HSxTtTxcb8Ih2SUMVJUuEGK-Y_8XM3IaU5yNuV9nkxcyQ4nZwUpJTVKvnDjrt1Qtn7Calj7v3MhsW2I8uPn-9eZhNvhydwcM1viz-jjhnz7L1WLZ_PX33Lxz7v2ZAosznQh8X3hF6fOoe_qTe4cHe_P-1857XLsvPD-4iJ8GQUeOg4qzQR0Yyl0YKvoPX_QZfuD54UUsMQh65TioOBvUgSXChSVB_-EHfYYfes2n5v0tMQh67TioOBvUgSWBC0vC_sMP-ww_8i7iiEHMsdOY4mxMB4aErvvQiTiPqMoiV9ir7QzrA2G2wHZAqtjIOT7IYt5s0_6cNlzz5c5QVe1T0f64zdtHdcD-8MgGHtvA3Co3j_Q0NxiZMINHNvDYBuZWuTsjO6JFlx7-Swf6eQdamB_ObNilQxvB9TAhuB4mBNfDlOAETQge2QiuhwnB9TAhuB6mBCdoQvCRjeBXNorqYUJRPUwoqocpRQmaUPTaRlE9TCiqhwlF9TClKEETio5tFOVWPYGgCUkJmrCUoClNKZzqCnZlwa4t2NUFy75gVxi4VWPgR5XByFY9Tdmqpylb9TRpK4FTtpqUpeM7M2lLpjRlq1FfMsYpW4_Kg9bWZPfhdwAAAP__ubNVYA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1r-kgYxe_3U8hc7UIkPjOJL4EFl90_bKG0pe3FwuJFamarYE1IItQt_e5_VNCaNM_JZEbv-uIvc-bkOScTP8Q6TfRd_KYLEf0rSHhCCk8o4YlAeCIUM09keTrXRZHmu48cgJvkXUQDTyzX2abc_XnmiXmaaxF9iHJZrrSIxHP8stKPOk507g-EJxJdxsvVfpksX77F-Xb6vv1feOIpi9dF1Ov7u5XvN2XUm0ox-_REuilPly_K-FWLiD699hL-Whblcj0v_fB8_SlVrn9CXra9RVwsvvn8SYM00fDVBnLng-rkA7k1ImgUcbrOZp3mic51cnal_VUaZcoBkHmSEF5KAnLqJGFoIcHrpPLvuFg86fI-81XFqedtpqPej3_-_PHw3Pvj9lZ4YqX_K3-d0m-_58vXxf6n43g172nk1ta7tJ9mvgqru_927fHZ2mQQrxbp8mXfV8Y9A0Qcp2Z4wZ4xMcKlE6qTE-TWiqBRhGXMqWPTOJSAnGpqGjMJ1k1D12ga2X7IZZsZV30_ME47EHG8c6MLpt3ACHLphOrkBLm1ImgUYRk12THtDiUgp5rSbibBOu3yGmlX7YdctZnxoL8_6ZulHYg43rnxBdNuYAS5dEJ1coLcWhE0irCMmuqYdocSkFNNaTeTYJ12dY20B-2HPGgz42HfOOtAwvG-TS6YdQMbyJ0PqpMP5NaIoFGEZcyCjkl3KAE51ZR0MwnWSQ-u_X3BN3IedZGl60K3-jZgsNuQTl71waAi3eRz_ZCn8_0yh1_v99z-D4kuysN_6fDLzfrwr53ArzBVYfoKB2cwmcEkreiJDS2HNrRSPC1ZxxXvuGKXDvmVeZiAbp6WAyt6ZEMrMGkB6zi42aEBLKvwkIXBpkf8oAz5SRmz9ISHJzbB5mEUbECDYPM0CjZPo2AT6FJUpnytgGwDGoUb4CjdCAeTDnCUb-IrlRBeaxcOr2Wc-HpBW-f7hUDKqdYwRo9gnobPYICjhzCPw6cwj8O08vVKY2B8rV-N0srTMK08DtMKcDSyPA7TWmvZM-MlgeMT37IVvJZWWasak7RKvmkkOL1J_hwDjAM0SivCQVoBjtIKcHho5ktWhsD4WsuapBXQKK0AR2lFOBpZHkdplfwRVo4BzrdsBa-nlT_Foq3zTaMG4F2r1jQmaQU0SivCQVoBjtIKcJRWxZesksD4WssaveXyNHzN5XH4ngtw9KLL4yitij_KKmQd37IVvJZWxZ9lq1ufff7yMwAA__8wq-az

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEltFq4kAUhu_3KeRc7cKEOJPE1sCCy1LYQqml9WJhyUVqzqpgkzAToW7x3ZckW1yjzsl0MLmM-mX-OecD_zdIswTv4xdUEP4CDgwEMPCAgQ8MAogY5DKbo1KZLH9SA7fJK4RDBqs03xTlxxGDeSYRwjcoVsUaIYRZ_LzGR4wTlO4QGCRYxKt1dUwuVy-x3E5et3-AwVMepyocOG558nRThIMJZxMB0Y5Btin-nbB_8fN2sIzV8vCV70jEQBXxAiHkO_axsEEPYcXZsPtXbdJMJigxOXhZVJLUT07c-Eeslk9YTHOXN7Yz2-YYDm5-fr95mA2-3d0BgzX-Lj5Xqb98lavF8v1hP4PGAPY38yxudiL2feZkucuD5gxOnu0fnM3bK8BbKOAKx_UuaKxB3FEvccXZuB04y7tzVrRfhGizCM9x_Qt6YxD3qpe44mzcDrwR3XnjtV-E12YRvlP9NV3KG4O4173EFWfjduCN1503fvtF-G0WETgXtMYg7LiHsOJs2A6c8fvpVSdCPaLKs1Rhq9Y0LK-FyQLrMalsI-f4ILN5dUz9OK246l8_QVXU34r64TatvyoDtodHNvDYBuZWuXmgp7nByIQZPLKBxzYwt8rdGNkRLZr08H_a08_b08L8cGbDJu3bCK6HCcH1MCG4HqYEJ2hC8MBGcD1MCK6HCcH1MCU4QROCj2wEv7JRVA8TiuphQlE9TClK0ISi1zaK6mFCUT1MKKqHKUUJmlB0bKMot-oJBE1IStCEpQRNaUrhVFewKwt2bcGuLlj2BbvCwK0aAz-qDEa26mnKVj1N2aqnSVsJnLLVpCwd78ykLZnSlK1GfckYp2w9Kg9aW6Pdp78BAAD__7amZ9o=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmE9r40gUxO_7KUyfdkFGft2S_wgWsuwEJhCSkOQwMPigWD2xwbGEJEM8Id99sM3YsWS9UqulzNFxfurq0qtSy29iFUf6JnzRmQi-CxKOkMIRSjjCE47wxdQRSRrPdJbF6fZf9sBV9CqCgSMWq2Sdb_88dcQsTrUI3kS-yJdaBOIxfFrqex1GOnUHwhGRzsPFcrdMki5ewnRz8br5KRzxkISrLOj13e3Kt-s86F2QcyHF9N0R8To_rpDl4bMWAb079VV8WWT5YjXLXf9UwrkljtTTpjcPs_l55KhEmij56Ae1aohqZAh14YhXKeV4qfUqTiOd6ujkYrurVIqVAyz2qMLvSkUNy44qhhYqnEZCv4bZ_EHnt4mrCn49bhId9C6__X9599j77_paOGKpf-R_73bwz7_p4nn--8Nx5ip3NmrX35u4Hyeu8osenF17fLI2GWSuRuRc2XdVkxYCOg4TNOy8hUwcadkS1cgS6sITr1KKZQNQ8x5qUUUNy6p6yEyFdQ_R5_WQrD_5ss7gq77rNekCoONwF0edd4GBI9SyJaqRJdSFJ16lFMsUyuZd0KKKGpZVdYGZCusukJ_XBar-5Ks6g-_1dy8Qxl0AdBzu4rjzLjBwhFq2RDWyhLrwxKuUYplC1bwLWlRRw7KqLjBTYd0F6vO6wKs_-V6dwff7TZoAqDjcw0nnTWDgB7VqiGpkCHXhiFcpxTKBXvMeaFFFDcuqesBMhXUPeH_md4ozou51lsSrTNf6FWKw3ZaOnvXepixepzN9l8az3TL7j7c7bveHSGf5_lvaf7ha7b_aCvwIUxGmj7B3ApMZTNKKntjQcmhDK8XTknVc8Y4rdmmfX5mHCejmaTmwokc2tAKT5rGOg5vtG8CyCA9ZGGx6xA_KkJ-UMUtPeHhiE2weRsEGNAg2T6Ng8zQKNoEuRWXK1wrINqBRuAGO0o1wMOkAR_kmvlIJ4aV24fBSxomvF7R1vl8IpJxKDWP0COZp-AwGOHoI8zh8CvM4TCtfrzQGxpf61SitPA3TyuMwrQBHI8vjMK2llj0xXhI4PvEtW8BLaZWlqjFJq-SbRoLTm-TPMcA4QKO0IhykFeAorQCHh2a-ZKUPjC-1rElaAY3SCnCUVoSjkeVxlFbJH2HlGOB8yxbwclr5UyzaOt80agDetUpNY5JWQKO0IhykFeAorQBHaVV8ySoJjC-1rNFbLk_D11weh--5AEcvujyO0qr4o6xC1vEtW8BLaVX8Wba49en7X78CAAD__-LGBZQ=
