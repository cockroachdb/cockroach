# LogicTest: 5node-dist

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysll-L2kAUxd_7KYb71NIJcSbxX55227UgWN2qhZYlD6kZFsHNpJMJ6IrfvRhXtoq5M_nzmGTO3N895yDuIfu7gQAWo8no65LkakO-zWffydPo1-PkfjwlHx_Gi-Xix-QTeTuyPR3Y7l7Jz-l4NiX3k8mNb7P5w2hOvvwm2xAoJDIW0-hFZBA8AQMKHCh4QMEHCl0IKaRKrkSWSXU8si8E43gLQYfCOklzfXwdUlhJJSDYg17rjYAAltGfjZiLKBbK7QCFWOhovSnGpGr9Eqnd3Xb3ChQWaZRkAXHc4-RZrgNyxyA8UJC5fr8-09GzgIAdaD2EbmsIvBThfXKeSBULJeLLqetEQ3i4QTqVjkxddulTGUCnigcLqbRQLrva_459Ll3Qs1iwdD36dnXpktxuSf8CgtkHzSyCdrnjepXbVgGi1yIEL4Vo3DdWo28GF85969XtG7d3mdu47DmuXznqChD9FiF4KUTjqHmNqA0unKPu143as3fZs3HZd4qf-WpRV4AYtAjBSyEaR-3ViNrgwjnqQd2ofXuXfRuXu07loCsgDFtD4KUIjWP2a8Rs8OAc87CNPws37p-LLJVJJizJQwoifhYntzKZq5V4VHJVjDk9zgpd8SIWmT595aeHcVJ8Kkrwv5g1EXNU7F2IO9diDxX7-GQfx2b46C6q7uOje03EfVQ8wLEHTRwbomLGDDXBS2aU4zVjHF-c4UUzbM7wprGuQY53zSjHy8Z6htXxuplWx_vGhgY53jijHO8c7-Crc7xz16uHhw__AgAA__-vNkAY

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt-L2k4Uxd-_f0W4T9_SkXhnknXN07bVgmB1qxZaljykZlgCbmJnJqAr_u_FpLibZZ0fiY9J5txzP56DzAHknw1EsBxPx19WXik23tfF_Jv3MP55P_00mXn_jybL1fL79IP378iuPrDbP3s_ZpP57J3388VovPA-__J2MRDIi5TPkicuIXoABAIUCDAgEACBEGICW1GsuZSFOB05VIJJuoOoTyDLt6U6vY4JrAvBITqAytSGQwSr5PeGL3iScuH3gUDKVZJtKputyJ4Ssb_b7Z-BwHKb5DLyev7JeV6qyLtDiI8EilK9jJcqeeQQ4ZHYrzDKpMrytfLDpr9mPnWZ_xoRr8fIWjGiPWRw0eBlbpkXIuWCp82pWa4gPur2oH3rPUIX0GUhFBc-xbfjP16cf9OYjw5hWmTp057PnBtrWOL8K960bKwL5DUpWStKtMdsdpbaY1IbStbzA-csDUucKQcts3SAxGtSslaUaI_ZzJLZYzIbyqBX_d-7ZWlY4kx52zJLB0i8JiVrRYn2mM0sA3vMwIYy7DknaVjhzDhsmaQDIl6PkbViRHvIy3eCdwwWXG6LXPLG9EuT-6frAk8feX3BkEUp1vxeFOvKpn6cV7rqRcqlqr9i_TDJ60-nBV-LUSsOGmJ8K6ZaMdM7sy7OgVYc6p1DrZhSvfpGqx7oxYMu0Lda8VDvPOzijIaOmUrWqWWorxkaeoadiob6pqGhaqjvmslc3zU0lA07tQ31dUND37BT4ai-cNRQOOpWuPj4398AAAD__-AtPn8=

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysll9r2zwUh-_fTyHO1Tum4BzZ6R_DoNuaskCXdE7GNjpfeLYoBtfOZBnclnz3YXukdVkk2cplLP3OOXr0QPQE5e8MfFjPr-cfN6QSGbkKVp_J7fz7zfX7xZL8f7lYb9Zfrt-Qv1vqbkP98Ei-fZoHc1KTn9V06sbEJV-Xi9VSt5G_Iy5ZBZfzgHz4QeoQKORFwpfRPS_BvwUECgwouEDBAwozCClsRRHzsixEs-WpDSySGvwphTTfVrL5HFKIC8HBfwKZyoyDD5voV8YDHiVcOFOgkHAZpVnbZivS-0g8XNQPj0BhvY3y0icTp-l8lWaSC59c4P5ovu8vlpszoLCqZLMC4Y5CUcnn3qWM7jj4uKPm812mpUzzWDqz_nCK-mxI_Zfnx_EAmiszJ-COIoDmCLyDDZ7rVnkhEi540q-a5hLCnWoONjWeYzbkoOtCSC4chq_Lvz1Y_6RXHwdctcFNO2ziuMeVXTPhHvHJSNmHELBBYKO7KQM0h9DXnZlDYCYM3InjHVcDzYR7BKcjNRhAAG0Q2GhgygDNIfQ1cM0huCYMvEn7H3REDTQT7hGcjdRgAAG0QWCjgSkDNIfQ18Azh-CZMJhNjiuBZr49gPOREgw4P44HYKOAKQE0R3D4_fOPBgEvt0Ve8l71Q5WnzdOIJ3e8e0yVRSVifiOKuG3T_Vy1ufZDwkvZrWL3Y5F3S82AL8OoDHu9ML4OM2XYVXd2bTp7yvBM3XmmDDOmTp8o06fq8KnNoc-U4XN153ObzqhxTCeZlWWo1gw1nqGVaKg2DTWqodo1XXO1a6iRDa1sQ7VuqPENrYRjauGYRjg2TLhw99-fAAAA__-YS5WL

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysll9vmzwUxu_fT2Gdq3eaI3IM6R-kSd3WVIvUJR3JtE0dFwysColCZoxEW-W7T8CUlmqxDc5lwM95Dj9-UniC8ncGPqzn1_OPG1KJjFwFq8_kdv795vr9Ykn-v1ysN-sv12_I3yN1d6B-eCTfPs2DOanJz2o6deN3xCNfl4vVUneSEySr4HIekA8_SB0ChbxI-DK65yX4t4BAgQEFFyh4QGEGIYWtKGJeloVojjy1gUVSgz-lkObbSjaXQwpxITj4TyBTmXHwYRP9ynjAo4QLZwoUEi6jNGtrtiK9j8TDRf3wCBTW2ygvfTJxmuarNJNc-OQCnx_N9_3FcnMGFFaVbG5BuKNQVPK5vJTRHQcfd9R8wcu0lGkeS2fW304xnw2Z_xIAjifACZoDcEcBQHMC3sGC57lVXoiEC570p6a5hHCn2oNNjfeYDXnQdSEkFw7D1-PfHpx_0puPA960wYt22MRxjyy7ZsU945ORsg9BYMPAQndTBGjOoK87M2fATBC4E8c7sgaaFfcMTkdqMAAB2jCw0MAUAZoz6GvgmjNwTRB4k_Yv6JgaaFbcMzgbqcEABGjDwEIDUwRozqCvgWfOwDNBMJscWQLNgnsC5yMlGAAAxxOwUMAUAJoTOPz984-CgJfbIi95b_qhydPm04gnd7z7mCqLSsT8RhRxW9P9XLW59kLCS9ndxe7HIu9uNQu-DKMy7PXC-DrMlGFX3ezaNHvK8EzdPFOGGVOnT5TpU3X41Oahz5Thc3XzuU0zahzTSWZlGao1Q41naCUaqk1DjWqodk1XrnYNNbKhlW2o1g01vqGVcEwtHNMIx4YJF-7--xMAAP__9RWVhQ==

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lUFvmzAYhu_7FdZ32iQjYhvShlOqLZMiZUmXZNKkigMLVoWUYmYbCRrlv0-BbV2qxtiQHcE8fA_f-yo5gPq5hwg2s8Xs4xaVco8-r1df0MPs-_3ibr5E7z_NN9vN18UH9PuRCqO6faaqn9G35Xy1RHeLxZ_jGqPq73EMGHKR8mXyxBVED0AAAwUMDDAEgCGEGEMhxY4rJeTpkUMDzNMKohGGLC9KfbodY9gJySE6gM70nkME2-THnq95knLpjwBDynWS7ZsxhcyeEllPq_oZMGyKJFcR8vzT5FWpIzQleEohPmIQpX6ZoHTyyCEiR9zPInS0oHhKLlrQixYvw8tcyJRLnp4PznKNs1xDfHxDeCk8UfjkfGOXJEb_VyK0kmBnEsQ-D2KRh089n_XphYPH2NnDoRnk2qGQHs2g9sugNstgnh_0CcXB48bZwyEUeu1QaI9QmP0ymM0yAq_5hXMOxcHj1tnDIRR27VBYj1AC-2UENssIvT6ROFhMHC0cAgmuHUgw8E_tjTevuSpErrjlm2MMPH3k7RcpUcodv5di14xpL1cN19xIudLtKW0v5nlz1GT1L0yGwNQIMzPMjDAZn9Gj13RgpMfm0eEQeDzko2-M8MQM3w6BJ0O0ibljpKtk5pZ14oN6RjqKFnbg5qZ14uauvXaPj-9-BQAA__8aGEtX

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt2L2kAUxd_7Vwz3aaUT4kziV57cdi0IVrdqoWXJQ2qGRXAz6SQBP_B_L8YVq2zuTD7eNsmcub97zmHxAMnfDXiwGE1GX5ckUxvybT77Tl5Gv54nj-MpeXgaL5aLH5MWeXg_sz2f2O72ZDZ_Gs3Jl99k1yI_p-PZlDxOJujBfev699YHCpEMxTR4Ewl4L8CAAgcKDlBwgUIHfAqxkiuRJFKdjhxywTjcgtemsI7iLD299imspBLgHSBdpxsBHiyDPxsxF0EolN0GCqFIg_UmHxOr9VugdsPtbg8UFnEQJR6x7NPkWZZ6ZMjAP1KQWXq9PkmDVwEeO9JqCJ3GEHghwnVyFkkVCiXC26nrKAX_-AHpVFoyttmtT0UA7TIeLKRKhbLZ3f5D9rlwQcdgwcL16PvVhUtysyXdGwhmHjQzCNrmlu2UblsJiG6DELwQonbfWIW-aVy49K1btW_c3GVu4rJj2W7pqEtA9BqE4IUQtaPmFaLWuHCJulc1asfcZcfEZdfK_82Xi7oERL9BCF4IUTtqp0LUGhcuUferRu2au-yauNyxSgddAmHQGAIvRKgds1shZo0Hl5gHTfxY-OD-uUhiGSXCkNynIMJXcXYrkZlaiWclV_mY8-Ms1-UvQpGk56_8_DCO8k95Cf4XszpijoqdG3H7XuygYhef7OLYDB_dQdU9fHS3jriHivs4dr-OYwNUzJimJnjJtHK8ZozjizO8aJrNGd401tHI8a5p5XjZWFezOl433ep439hAI8cbp5XjneNtfHWOd-5-df_46V8AAAD__3hORps=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysll-L2kAUxd_7KcJ92qUj8c4kuuZp22pBsLpVCy1LHlIzLAE3sZMJ-Ae_ezEpulnq_El82yRz7rm_PQeZA-R_1hDAYjQZfVk6hVg7X-ezb87z6OfT5NN46twNx4vl4vvk3rn7d2Zbndju9s5sPhzNnc-_nN2982M6nk2Vh_b3l7-3IRBIs5hPo1eeQ_AMCAQoEGBAwAMCPoQENiJb8TzPxOnIoRSM4y0EXQJJuink6XVIYJUJDsEBZCLXHAJYRr_XfM6jmAu3CwRiLqNkXdpsRPIaid3jdrcHAotNlOaB03FPzrNCBs4jQngkkBXyMj6X0QuHAI_EfIVhksskXUnXr_sr5lOb-W8R8XaMrBEjmkN6Vw0uc4s0EzEXPK5PTVIJ4VG1B-0a7-HbgC4yIblwKb4f__Hq_F5tPlqEaZClSzsus26sZonzf7HXsLE2kLekZI0o0Ryz3llqjklNKFnH9ayz1Cxxpuw3zNICEm9JyRpRojlmPUtmjslMKL1O-Xtvl6VmiTPlQ8MsLSDxlpSsESWaY9az9MwxPRNKv2OdpGaFM-OgYZIWiHg7RtaIEc0hr98J_mMw5_kmS3Nem35tcvd0XeDxC68uGHlWiBV_EtmqtKkeZ6WufBHzXFZfsXoYp9Wn04JvxagUezUxvhdTpZipnVkbZ08p9tXOvlJMqVrdU6r7anG_DfSDUjxQOw_aOKOmY7qStWoZqmuGmp5hq6KhummoqRqqu6YzV3cNNWXDVm1Ddd1Q0zdsVTiqLhzVFI7aFS48fvgbAAD__6MlRQI=

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt2L2kAUxd_7Vwz3aaUT4kziV57cdi0IVrdqoWXJQ2qGRXAz6SQBP_B_L8YVq2zuTD4ek8yZ-7vnHMQDJH834MFiNBl9XZJMbci3-ew7eRn9ep48jqfk4Wm8WC5-TFrk4f3M9nxiu9uT2fxpNCdffpNdi_ycjmdT8jiZ4Acp2beuj1sfKEQyFNPgTSTgvQADChwoOEDBBQod8CnESq5Ekkh1OnLIBeNwC16bwjqKs_T02qewkkqAd4B0nW4EeLAM_mzEXAShUHYbKIQiDdabfEys1m-B2g23uz1QWMRBlHjEsk-TZ1nqkSED_0hBZun1-iQNXgV47EirIXQaQ-CFCNfJWSRVKJQIb6euoxT84wekU2nJ2Ga3PhUBtMt4sJAqFcpmd_sP2efCBR2DBQvXo-9XFy7JzZZ0byCYedDMIGibW7ZTum0lILoNQvBCiNp9YxX6pnHh0rdu1b5xc5e5icuOZbuloy4B0WsQghdC1I6aV4ha48Il6l7VqB1zlx0Tl10r_5kvF3UJiH6DELwQonbUToWoNS5cou5Xjdo1d9k1cbljlQ66BMKgMQReiFA7ZrdCzBoPLjEPmviz8MH9c5HEMkqEIblPQYSv4uxWIjO1Es9KrvIx58dZrstfhCJJz1_5-WEc5Z_yEvwvZnXEHBU7N-L2vdhBxS4-2cWxGT66g6p7-OhuHXEPFfdx7H4dxwaomDFNTfCSaeV4zRjHF2d40TSbM7xprKOR413TyvGysa5mdbxuutXxvrGBRo43TivHO8fb-Ooc79z96v7x078AAAD__wPQR2A=

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkV9LwzAUxd_9FOE-rRBY0731yeEqFGo3102E0YeSXEYgJjN_RBj97tIUnAMnUx9z7v3dcw45gntVkENTVMXdhgSryP16-UB2xfOqmpc1mSzKZtM8Vgl5mlfboiETllAyyRKyrctl_almgzpLWqCgjcC6e0EH-Q4YtBQO1nB0zthBOsaFUrxDnlKQ-hD8ILcUuLEI-RG89AohB2V4p8hbpwI6kk5ToCDQd1LF_Z6CCf5EO9_tEXLW0z86sCm7yiG76HA6HLSxAi2Ks4sgtYe2_ybIQjovNffT7By4ZXApxuw3RdfoDkY7vKpgOiREscexkzPBclxZw6PN-FxGLgoCnR-n2fgodRzFn_gKs__A2Y_w7AxO-7a_-QgAAP__FLXr_g==

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9u2jAUh-_3FNG5ajWjYCfhT6RJdCvTkBh0wMWmKhcp8QoSTTInSE0r3n1KKOtCiE9M2twV8Gf_4vOdnjxD9GcDNsyH4-GXhbYVG-3rbPpdux3-vBlfjSbaxfVovpj_GF9qFy9rkv2Kx-TpUhtNFsPZPP32ajw-uWI6ux7OtM-_tMQBAn7g8Yn7wCOwb4ECAQYEDCBgAgELHAKhCJY8igKRLnnOgJH3CHabwNoPt3H6tUNgGQgO9jPE63jDwYaFe7fhM-56XOhtIODx2F1vsmNCsX5wRTJ4TJ6AwDx0_cjWWnp68nQb29qAgbMjEGzjl-1fd71LtJUbrfL7DSg4O4dAFLv3HGy6I-fFtBqNyUpjvu6z9QPhccG9_E5rP06PrrjuxFN_c6PVnMfTUKdHtVkkIbfzFgGBDf8dXwzo5Sexvl9lf_27BHp0Ca8PaKjUYR6ImAudWsd39rF0f7PCBZZeC3nZ-kSUSdAKQp3lL6YshJULQavLRivIprOWbrxLVygE7TQclJUGbbQvaEN9gVTi0Bedc_uCVa80q1Jpo6Wb76KkQtBuw0FZadBGlWQNKYlU4qBk91wljeqVNqpU2mxlo_vtlVQI2ms4KCsN2qiSRkNKIpU4KNk7V0mzeqXNKpW2Wu8ipELMfqMxWWnMRnU0G9IRqcNBx_5bvMye2H_GozDwI17pDbWd3hn37vm-GlGwFUt-I4Jldsz-4zTjspcRj0fx_le2_zDy9z-lAavD3TowpbVoqxbdl9NU4c6YGtytAx_dmSpt1aL7cpod0-3_aSMHt49hQwqb8mqZUphR-dFWnf6Qw0h_yGGsPxAa6Q-ERvqjU6c_5DDSH3IY6w-ERvoDoZH-6Eot7ckl7dXpj34dw-UwYrgcxgxHaMRwhMYmgMrYLP4nVZmbqjQ6BJQmpzKOaE4LUySnKmVy0al8jCCm08IcUVEdoRHXERqTHcMR2zEc070wQ5V0l9OY7nIa1R3BMd0RHNO9MEjzuncQ3QszRUn3wkxR0l1OY7rLaVR3BMd0R3BM98I8VdJdTmO6y2lUdwTHdEdwTPfCVM2_a7flurPCbJHq7uw-_A0AAP__HQSOJw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v4kYUxd_7Kaz7lKhGMH_4E0uVsm2oikTDFnhoteLBC9MEicXUNlLYKN-9AjYQ7PgejxnyloDPzPGZe36yeabkvwUFNOr2u7-NvXW88H4fDv70vnT__tz_1Lv3ru56o_Hor_61d_Xjms3-iqfN92uvdz_uDkfbT9_7djC86w69X__xNhPyaRnNzH34zSQUfCFBPknySZFPmnxq0sSnVRxNTZJE8faS552gN3uioOHTfLlap9uPJz5No9hQ8EzpPF0YCmgcfl2YoQlnJq43yKeZScP5YrfNKp5_C-PN7dPmO_k0WoXLJPBq9e3Og3UaeLeSJi8-Rev0uHyShg-GAvHil7dwN0_S-XKa1pun-9-KzPpHydeN9xgmj-9cf_QgbTy8jUG4y0FVykG4DUIXmjius15G8czEZna60nyZ7pcq9CobwOvRR_OiPlBmRx-tc3341f3-ESaPI5MOVnWVCW68WZngDRM-9fvk08L8m17diutf4vnD4-6vw9QV32DbZupGUZyauK5y-f1cuH6nRICFsfg_ln7Hyn1Ui1Z1fRpMkYmbExPCot4l2l2Xtbqy5hwwcZjV1gU5ZxOEyyRUpSSE2yh0oQkXhBEVSefaB8qsiHQVfLghnfgg0oGpeyVdLr-ypJPluyXLVEvV6toaMsDEYUzaF4SMRRDCZRKqUhLCbRS60ISLcsuKkHHtA2VWBJkKPtxARn4QZMDUvUIml19ZyKjy3VJlqqVru_cqO8gAE4cx6VwQMhZBCJdJqEpJCLdR6EITLsqtKkLGtQ-UWRFkKvhwAxn1QZABU_cKmVx-ZSGjy3dLl6lWs2aNGGDhMCQ3F0SMRQzCXQ6qUg7CbRC60ISLYuuKgHHtA2VWBJgKPtwARn8QYMDUvQIml1-VH4XeWX9oklW0TEypX3oa28zM7MHsTyOJ1vHUfI6j6W6b_b-DnW73wcwk6f5bsf-nt9x_tTX4ViyyYvFWrE_Ewk4s1DlqKc5S35yjVm1eLdnEFZ-4Yrdu8jvzYgHOi1dLeY5aNc5Sd3i1ZhNv8eKmhVhmxS1W3ObPus2KwT13WLEGxb7hqdAAWMhBxYoLvBqCgZdDMgA5QgMvR2wQObScBi9B8Dm22OABqBEfgBwBAsgRIZAc1EXkCHMaPIqOR0xGnsOE4CEjWuDYecygW-c5Izpg8xxprMrOq2HZeTksO5CjsvNyWHaeshJQVvKoARML1KjsQI7KDuSo7EgOJl7ylJVg6CT_BJeR58ouedRIDY6dRw26dZ40EpBG5khjU3agRmUHclR2JAdlB3L41M9TVgLKSh41qOyAsujcACZR2QEmUdmBHE08T1kFpkbxL8gZea7sikeNAg90ikcNuHXFk0YB0qgcaWzKDtSo7ECOyo7koOxAjsqueMoqQFnFowa95QPKonMDmETv-QCT6EUfyNHE85RV6Nj5t-aMPF92HjUaPNBpHjXZW5-8_PR_AAAA__-6Niy0

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdF3aiWjYCfQEmkS3co0JAYdcNhU5ZASryDRJLOD1LTiv08J1Tqg8RfPw7uV4sd-7e-ReJ9B_lxDALPBaPBx7mzE2vk0nXxxbgffbkZXw7Fzdj2czWdfR-fO2cuaYrfisXhyJtPrwdT58N0pzp3heD6YzsoFV6MRsjgEAkka83H0wCUEt0CBAAMCHhDwgUAHQgKZSBdcylSUS54rYBg_QtAmsEqyTV7-OySwSAWH4BnyVb7mEMA8ulvzKY9iLtw2EIh5Hq3W1TGZWD1Eoug_Fk9AYJZFiQyclluePNnkgdNnEG4JpJv8ZfvXXe8KZxnJ5f5-fQrhNiQg8-ieQ0C35O9idqzGZLUxX_fZJKmIueDx_k6rJC-PbrjujVt_juRyxvNJ5tKD2cyLjAf7FgGBNf-Rn_Xp-Xuxul9Wf_1-BHrwCK8X9Ewv-EbwcdpKM5fuT6ougL8XgDYXgTYQwWUt1zuJsRpBu5aDstqgVp2llpxlzSfBmkzCa7n-SZTRCHphOSirDWpVGWZJGa_5JLwmk_Bb1c_Sv1dGI-il5aCsNqhVZTxLyvjNJ-E3mUSndRJhNGL2rMZktTGt6uL_hyL1RqIpl1maSN6oIbXLO_H4nu9eS6YbseA3Il1Ux-w-Tiqu-rWPucx337Ldh2Gy-6oM2BzumsA9E5ga5aYdNU01nozpwV0TuGcCU6PcB092RLNDuv0n7anf21PCdP_N2oe0byK4GkYEV8OI4GoYExyhEcE7JoKrYURwNYwIroYxwREaEbxrIviFiaJqGFFUDSOKqmFMUYRGFL00UVQNI4qqYURRNYwpitCIoj0TRalRT0BoRFKERixFaExTDMe6gllZMGsLZnXBsC-YFQZq1BjoUWXQslVNY7aqacxWNY3aiuCYrTpl6XhmOm1Jl8Zs1epL2jhm61F5UNoabt_9CgAA__8PKIxM

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7lEhGMDOGEEuVsm2oikTDFnhoteLBC9PEEmu7tpHCRvnvFVBBsON7PGbIviXgzz4-vud4hhfK_l2RT9PBaPDrzFmnK-e3yfgP58vgr8-jT8MH5-p-OJ1N_xxdO1f_H7PZH_G8-e6MJ_eDifPL387m2hk-zAaT6fYA_sA5uRTFS_0QfNMZ-V9IkEuSXFLkkkcudWnuUpLGC51lcbo95GUHDJfP5HdcCqNknW8_nru0iFNN_gvlYb7S5NMs-LrSEx0sddrukEtLnQfhaneZJA2_Benm7nnznVyaJkGU-U6rvb3yeJ37zp2k-atL8To_nj7Lg0dNvnh160u4D7M8jBZ5u3t6_TtROP8R-bpxnoLs6Z3jjxqkiYa3Ngh7PqhGPgi7RniVIo7nWUdxutSpXp6eKYzy_akqtcoO0HrU0b2oDuTZUUfvXB1uc72_B9nTVOfjpK0Kxs02ifbfdMKn0YhcWul_8qs7cf1zGj4-7f46TF31Dd5cwOiHuBUnbXXqcpWA_okAYRC9Gslry1ZbGXcQEHGYo94FO8jECJtOqEZOCLtWeJUibKRfNGwh2zqQZ1Ut1ECHnRYSH9RCsv7syzqjr1ptz7gEgIjDY7y5YAkYGCFsOqEaOSHsWuFVirARPtmwBGzrQJ5VlUADHXZKQH5QCaj6s6_qjL7X2u0ZzEoAiDg8xv4FS8DACGHTCdXICWHXCq9ShI3wqYYlYFsH8qyqBBrosFMC6oNKwKs_-16d0e-2jCsASDg8xNsLVoCBDcKeD6qRD8KuEV6lCBvB8xoWgG0dyLOqAmigw04BeD_gB4l3FE10lsRRpmv90tDZ3pNePuq9W1m8Thf6cxovdpfZ_zvecbsPljrL99-K_T_DaP_VVuBbWBRh8Rb2TmBhBgt5Fn17Di1759BK8bRkHVe844q9dJe_Mg8LoJunZecs-uYcWoFJ81jHwcPuGsCyCPdYGNz0DT8oPX5S-ix9y8O35wSbh1GwAQ2CzdMo2DyNgi1Al6Iy5WsFZBvQKNwAR-lGOJh0gKN8C75SBcJL7cLhpYwLvl7QrfP9IkDKRalhjF7BPA3fwQBHL2Eeh29hHodp5etV9IHxpX41SitPw7TyOEwrwNHI8jhMa6llT4yXAiyf-JYt4KW0ylLVmKRV8k0jwepN8usYYBygUVoRDtIKcJRWgMNFM1-ysguML7WsSVoBjdIKcJRWhKOR5XGUVskvYWUf4HzLFvByWvlVLLp1vmlUB-y1Sk1jklZAo7QiHKQV4CitAEdpVXzJKgmML7Ws0S6Xp-E2l8fhPhfgaKPL4yitil_KKmQd37IFvJRWxa9li7c-f_3pvwAAAP__0KMsSw==

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll9v4jgQwN_vU1jz1OqMEjsJfyJVau9KVSQOeoC0u-rykBJvQaIk6wQJWvW7rxLKdkOKJyYlvDWNf3Zm5jeMXyD6OQcXhu1u-98RWco5uRn0_yP37a933atOj5xdd4aj4f_dc3L2tma1WbFaP5Mvt-1Bm6zI96VpWhPCz0mnN2oPhsmyq24XRcRFwvQH1-0B-ecbWY2BwiLwRc97EhG498CAAgcKFlCwgYIDYwqhDCYiigKZLHlJgY6_AtekMFuEyzj595jCJJAC3BeIZ_FcgAsj72EuBsLzhTRMoOCL2JvN02NCOXvy5PpytX4GCsPQW0QuqRnJyTezeSykSy7Z7yhd1-30Rk2g0F_GyRsYv1IIlvHb2e9HPqzJ1Ium2cPS9WMKUew9CnDZKz0sBufgGJK0f24QfG8Q7_ssF4H0hRR-dqfZIk6OLrjug5zcetF0KOJ-aLCdso7WoXCzSgKFufgRn12y8ws5e5ymf-1NwnuAlk6VhoGMhTSYs5uzv_fubxdI4N600LetP_iUXlALQoNnE7PvI5zMR7DiKrICKhq8ZljVN5RGFPUSURy7pdipWopV1FJInbYtVT-0pXhxD3gRD6yaYVdvs0YUjRJRHNtmfiqbeUU2I3Xa2tw41GaruAdWEQ_sWnqdqNhmjSiaJaI4ts3WqWy2KrIZqdPW5uahNtvFPbCLeODUqndZI4bWwTEc22T7VCbbFZmMVGlrcuszLu4f7D8QURgsIlHoNm4mORP-o9hUIwqWciLuZDBJj9k89lMuvT35Ioo3b_nmobPYvEo-sDjcKAMzVop2StEtNc00csb14EYZeCdnurRTim6pab5Lm3_SVgY2d2FLCdvqatlKmDP10U6Z_lDDSH-oYaw_EBrpD4RG-qNepj_UMNIfahjrD4RG-gOhkf5oKC1tqiVtlumPVhnD1TBiuBrGDEdoxHCExiaAztjM_5LqzE1dGh0CWpNTG0c0Z7kpklGVcbXoTD1GENNZbo7oqI7QiOsIjcmO4YjtGI7pnpuhWrqraUx3NY3qjuCY7giO6Z4bpFnd64juuZmipXtupmjprqYx3dU0qjuCY7ojOKZ7bp5q6a6mMd3VNKo7gmO6Izime26qZu_aplp3npstSt3Hr3_9CgAA__9KkuUa

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjmA8-YmmlbBtWi0RhC0htteXCC9PEEoupbSTYKP99ZUgg4Pg9Y3vIXQI-M8dn3vPI5pHF_y-Yx8bdfvf3ibOOFs6n0fAP52v37y_9j72Bc3XXG0_Gf_avnavnazb7KzbbH85fn7ujrrNx_l03GnLmiGunN5h0R-P0MnS5_pBePxzddUfOb_84mylz2TKc64H_XcfM-8o4c5lgLpPMZYq5rMmmLltF4UzHcRillzzuBL35hnkNlwXL1TpJP566bBZGmnmPLAmShWYem_jfFnqk_bmO6g3msrlO_GCx22YVBd_9aHu72f5gLhuv_GXsObV6uvOnYJHoyHNu-eEOPc_rDSYd5rLhOkm_YdMnl4Xr5Lh3nPj3mnn8yTX3dxfESbCcJfXmqbnM-kfJt63z4McPb1x_9CCKeHidES8fUnqu5inJUilxuzGpXBPHddbLMJrrSM9PVwqWyX6pXK-iAbwefTQv6gNldvTRqurDLe_3sx8_jHUyXNXlWXCT7Up7rwDzsd9nLlvo_5KrW379IQruH3Z_GUxdu8jUjcMo0VFdZvL7NXf9jkGAubG4z0u_YWUQ1sJVXZ0Gk2fi5sQEL1B-g-7XRa0u7SISODwMcuuCiCySUpWYqkDSNCduNyiVa8IGnHhJSNr2gTLLg2QJH3Ygyd8JkmDqXiCZyc8UksK8ecKkeLJWV3b5BBweZqh9QT4VSIlXiakKn0xz4naDUrkmbHBBlOSTbR8oszw-lfBhh0_infgEpu6FT5n8TPkkzZsnTYqnart3PYt8Ag4PM9S5IJ8KpMSrxFSFT6Y5cbtBqVwTNrggS_LJtg-UWR6fSviwwyf5TnwCU_fCp0x-pnxS5s1TJsVr1uzSCfg7TNDNBelUICNePqQqbDJNiduNSeWasMEEVZJNtn2gzPLYVMKHHTapd2ITmLoXNmXyK_MD2Bvrj3S8CpexNvpVq5Fmpuf3en8acbiOZvpLFM522-z_He50uw_mOk723_L9P73l_qvU4GsxPxfz12J1IubFxFxWUQteSX1TRS3btFqQiUs6cUlu3aR3psUcnBetFqKKWjYqqTu0WpGJt2hxs4BYnItbpLhNn3WbFIN77pBiBYp9Q1OhAbCQgUohLtBqCAZaDskA5AgNtByxgWfQchq8AMFn2FIED0CN-ADkCBBAjgiB5KAuPEOY0-BRdDRizuQZTHAaMrwFjp3GDLp1mjO8AzbPkKZQ2Wk1LDsth2UHclR2Wg7LTlNWAMoKGjVgYoEalR3IUdmBHJUdycHEC5qyAgydoJ_gzuSZsgsaNUKBY6dRg26dJo0ApBEZ0hQpO1CjsgM5KjuSg7IDOXzqpykrAGUFjRpUdkBZdG4Ak6jsAJOo7ECOJp6mrARTI-kX5DN5puySRo0ED3SSRg24dUmTRgLSyAxpipQdqFHZgRyVHclB2YEclV3SlJWAspJGDXrLB5RF5wYwid7zASbRiz6Qo4mnKSvRsdNvzWfybNlp1CjwQKdo1Jzf-vTpl58BAAD__5I_g6c=

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll9v8jYUh-_3KaxzVTSjxE7Cn0iV6FaqIjHoAGmbOi5S4hUkSjInSNCK7_4qUNo3pPjEpIS7UvLYOcfPj-M3iP6fgwvDdrf9-4gs5ZzcDfp_kMf23w_dm06PXN12hqPhn90KuXp_Zr17YrV-JX_dtwdtsiL_Lk3TmhCrQjq9UXswTB676XZRRFwTViH9wW17QH77h6zHQGER-KLnvYgI3EdgQIEDBQso2EDBgTGFUAYTEUWBTB552wIdfwWuSWG2CJdx8u8xhUkgBbhvEM_iuQAXRt7TXAyE5wtpmEDBF7E3m2-3CeXsxZPr1mr9ChSGobeIXFI1kp3vZvNYSJe02EeVrut2eqMGUOgvY5e0OIw3FIJl_L7355ZPazL1oml6sxaD8WZMIYq9ZwEu29DTanBOriFp-_cWwY8W8bnOchFIX0jhp1eaLeJk65zPfdGTey-aDkXcDw12cKyjdSjctJJAYS7-i69arHItZ8_T7V8fTWAHTfgs0NI5pWEgYyEN5hz27Nej69s5Gni0LfR96S9epRdUg9Dg6cYcewkn9RIsv4osh4oGrxpW-YHSqKJWoIpzR4pdKlKspEgh57SPVO3USPH8HvA8HlhVwy7fZo0q6gWqOLfN_FI285JsRs5pb3P9VJut_B5YeTywq9vrRMk2a1TRKFDFuW22LmWzVZLNyDntbW6carOd3wM7jwdOtXyXNWponlzDuU22L2WyXZLJyCntTW5-x8X9i_UHIgqDRSRy3cbNpGfCfxa704iCpZyIBxlMttvsPva33Pb25Iso3n3Ldx86i91XyQvmh-tFYMYK0U4huqmmmUbPuB5cLwIf9EyXdgrRTTXND2nzZ9pKweYhbClhW31athLmTL21UyQfahjJhxrG8oHQSD4QGslHrUg-1DCSDzWM5QOhkXwgNJKPutLShlrSRpF8NIsYroYRw9UwZjhCI4YjNDYBdMZm9pdUZ27q0ugQ0Jqc2jiiOctMkZSqjKtFZ-oxgpjOMnNER3WERlxHaEx2DEdsx3BM98wM1dJdTWO6q2lUdwTHdEdwTPfMIE3rXkN0z8wULd0zM0VLdzWN6a6mUd0RHNMdwTHdM_NUS3c1jemuplHdERzTHcEx3TNTNX3XNtW688xsUeo-3vzyIwAA__-Mv-Un

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K0ZzlahGMB98xNJKbBtWi0RhC0htteWChWmCxGJqGylslP--AhIIdvyesT3kLgEfz5kz73lk88ij_5fc56NOr_P7mG3CJfs0HPzBvnb-_tL72O2zq9vuaDz6s3fNrp6v2R6ueNj-YH997gw77IH9u6nV1Iypa9btjzvD0e4ydLn5wMQ1GwxvO0P22z9sO-EeXwVz059-NxH3v3LBPS65xxX3uOYer_OJx9dhMDNRFIS7Sx73gu78gfs1jy9W6028-3ji8VkQGu4_8ngRLw33-Xj6bWmGZjo3YbXGPT438XSx3C-zDhffp-G2_bD9wT0-Wk9Xkc8q1d3KnxbL2IQ-a4vjDn3f7_bHLe7xwSb2WVvyyZPHg018WjuKp3eG--LJs_d3u4jixWoWV-vn5toicf-T5NuW3U-j-zeuP3mQeTy8zkgUD2l3rvYpqUIpCbcx6UwTp_tsVkE4N6GZn99psYoPt8r0KmvA68lH_aI-UGYnH42yPrzifj9Po_uRiQfrqkoEN96ujf8KMB97Pe7xpfkvvmqL6w_h4u5-_9dx6rI32MwzdaMgjE1YVan8fs28f8siwMxYvOdbv2GlH1SCdVWfB5Nl4ubMhMhRfovuV2WlqtwiEjg8DnLjgojMk1KZmMpA0jYn4TYonWnCBZxEQUi69oEyy4JkAR9uICneCZJg6l4gmcrPFpLSvnnSpniqUtVu-QQcHmeoeUE-5UhJlImpDJ9scxJug9KZJlxwQRbkk2sfKLMsPhXw4YZP8p34BKbuhU-p_Gz5pOybp2yKpyv7dz2HfAIOjzPUuiCfcqQkysRUhk-2OQm3QelMEy64oAryybUPlFkWnwr4cMMn9U58AlP3wqdUfrZ80vbN0zbFq1fc0gn4O07QzQXplCMjUTykMmyyTUm4jUlnmnDBBF2QTa59oMyy2FTAhxs26XdiE5i6Fzal8ivyA9gb9x-aaB2sImP1q1Ztl5mZ35nDaUTBJpyZL2Ew2y9z-Hew1-0_mJsoPnwrDv90V4evdgZfi0VSLF6L9ZlY5BMLVUYtRSn1TRm1atJqSSau6MQVuXSdXpkWC3BetFrKMmpVK6Vu0WpNJt6gxfUcYpkUN0hxkz7rJikGe26RYg2KfUNToQawkIJKLi7QaggGWg7JAOQIDbQcsUGk0HIevATBp9iSBw9AjfgA5AgQQI4IgeSgLiJFmPPgUXQ0YhLyFCYEDRnRAMdOYwZtneaMaIHFU6TJVXZaDctOy2HZgRyVnZbDstOUlYCykkYNmFigRmUHclR2IEdlR3Iw8ZKmrARDJ-knuIQ8VXZJo0ZqcOw0atDWadJIQBqZIk2esgM1KjuQo7IjOSg7kMOnfpqyElBW0qhBZQeURecGMInKDjCJyg7kaOJpyiowNYp-QU7IU2VXNGoUeKBTNGrA1hVNGgVIo1KkyVN2oEZlB3JUdiQHZQdyVHZFU1YByioaNegtH1AWnRvAJHrPB5hEL_pAjiaepqxCx06_NSfk6bLTqNHggU7TqEluffL0y88AAAD__2dQg7Q=

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllFv2jwUhu-_XxGdq1YyCnYCLZE-iWpjGhKDDriYVHGREq9EoklmG4m06n-fkrTrAq1PPEO5DPETv_Z5JN5HkL_WEMBsMBp8mjsbsXa-TCffnJvBj-vR1XDsnH0ezuaz76Nz53nJljh5tWabPzjD8XwwnRW_X41GL0ty4mz_LFkAgSSN-Di85xKCG6BAgAEBDwj4QKADCwKZSJdcylQUSx5LYBhtIWgTiJNso4qfFwSWqeAQPIKK1ZpDAPPwds2nPIy4cNtAIOIqjNflNpmI70OR97f5AxCYZWEiA6flFjtPNipw-pT0GSyeCKQb9bzD64dvc2cVylX9ky_IgoBU4R2HgD6RfwvbMQzLSJ_ahmXvhn391CZJRcQFj-ofixNF4kQVCQzWvnEHX0O5mnE1yVy6M695nvGg7hMQWPOf6qw8yvn_Ir5bvTzopvh6Yu8QJ37jFOO0lWYurQ_xvRB-LQRt7ght4IjLWq53RKUN4naN4x5eanpqqelHS82aD4g1GZDXcv0j-mQQ98I47uF9Yqf2iX20T17zAXlNBuS3yv-6Y_lkEPfSOO7hffJO7ZP30T75zQfkNxlQp3VEmwzC9gzDHt4l_9Qu-acscG9Em3KZpYnkjVpZuzgcj-54dX0y3YglvxbpstymepyUXNkqIi5V9ZZVD8OkelUEbA53beCeDUytctOOnqYGV8bM4K4N3LOBqVXunSvbo9ku3f6b9vT37WlhWr-z9i7t2wiuhxHB9TAiuB7GBEdoRPCOjeB6GBFcDyOC62FMcIRGBO_aCH5ho6geRhTVw4iiehhTFKERRS9tFNXDiKJ6GFFUD2OKIjSiaM9GUWrVExAakRShEUsRGtMUw7GuYFcW7NqCXV2w7At2hYFaNQa6VxmMbNXTmK16GrNVT6O2Ijhmq0lZ2p-ZSVsypTFbjfqSMY7ZulcetLYunv77HQAA__8v56z_

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmN9u4kYYxe_7FNZ3tSsNgpkxhFiqlFU3VZFosg1cVFpx4YVpYom1qW0k2CjvXgEp_xx_Z8bY2UswP8-Z4znHMzxT9u-cAhrdDm9_G3vLdO79_nD_p_f19u8vw0-DO-_D58FoPPpr-NF7_clKeOvdb1brH97gbnz7MNp8_3p5LbzV_vKEBMXJzNyF301GwVeSJEiRIE2CfBLUpYmgRZpMTZYl6eYnz1tgMFtR0BEUxYtlvvl6ImiapIaCZ8qjfG4ooHH4bW4eTDgzabtDgmYmD6P5dphFGn0P0_XNav2DBI0WYZwFXqu9Gfl-mQfejRQ3iiYvgpJlfhghy8NHQ4F8EfYqPkdZHsXTvN09lfDWEAfq29p7CrOnt5GDEuWi5NgP6WqIEjey1BBdyRDZhCN-qZTDrZZxks5MamanN4viXERxvrtdqWrVwaoPcrqNy7Ew8SCnV4cccZn0P8LsaWTy-0Vbn1k5Xi9McNQYn4ZDEjQ3_-QfttP6-GsaPT79_8Euq1cNPYC7pJUs2vrU_TIR_RMR0iGmFiltq1ZbVykuoGO_xHqNF5eLI-6WOFSXrSWyCU_8Uil1dYWsXl1NyLEwsay6Ksqpr7rke1eXss-IsomIbrX9Kq0BdOyf7lXjreHgiHS3xKE1bC2RTXjil0qpK6aqems0IcfCxLLWqCinvtZQ790a2j4j2iYifmt7jnFuDaBj_3T7jbeGgyPS3RKH1rC1RDbhiV8qpa6Y6uqt0YQcCxPLWqOinPpaQ793a_j2GfFtItJtVekMoGL_bK8b7wwHP6SrIQ6NYWuIbMIRv1RKXRH1qzdGE3IsTCxrjIpy6msM_2f-sfKGtAeTLZI4M1b_lnQ2kzOzR7OzL0uW6dR8SZPpdpjdx_stt_1iZrJ8d1XuPgzi3aWNwGNYnsPyGPZPYOkGS3URfX0JrXqX0FrztGId17zjmh26y4_MwxLo5mnVuYi-uoTWYKX5rOPgYXcdYHUO91gYTPqKXyg9fqX0Wfqah68vCTYPo2ADGgSbp1GweRoFW4IuRWXK1wrINqBRuAGO0o1wsNIBjvIt-UqVCC-0C4cXMi75ekFT5_tFgpTLQsM4vYJ5Gr6DAY5ewjwO38I8DtPK16vsA-ML_eqUVp6GaeVxmFaAoyXL4zCthZY9MV5JsH3iW_YML6RVFarGJa2KbxoFdm-K38cA4wCN0opwkFaAo7QCHG6a-ZJVXWB8oWVd0gpolFaAo7QiHC1ZHkdpVfwWVvUBzrfsGV5MK7-LRVPnm0Z3wFmr0DQuaQU0SivCQVoBjtIKcJRWzZesVsD4Qss6nXJ5Gh5zeRyecwGODro8jtKq-a2sRtbxLXuGF9Kq-b3s-dQnL7_8FwAA__8aZWf8

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9u4jgUh-_3KaJzVbRGwU7Cn0grtbtlNUgMdAgXM6q4SImnINEk4wQJWvXdRwlFTEjjE5PWd1D82b_4fKcnL5D82oAL3nA8_G9ubMXG-H82_WrcD7_fjW9GE-PqduTNvW_jlnH1tmZ3WLHbPxvT2e1wZvz7w9i3jNFkPpx52YKb8Vi6-Ll1-rxbAIEwCvjEf-IJuPdAgQADAhYQsIGAAwsCsYiWPEkikS15yYFRsAO3Q2Adxts0-_OCwDISHNwXSNfphoMLc_9hw2fcD7gwO0Ag4Km_3uTHxGL95Iv99W7_DAS82A8T12ib2cnTbeoa1xQWrwSibfq2_WnXh72x8pNVcb98_YJAkvqPHFz6Si6L6WiNySpjnvbZhpEIuOBBcad1mGZH11z3zlN_8ZOVx9NpbNKz2sz3MXeLQgGBDf-ZXl3T1j9i_bjKP1VewukBLZU6eJFIuTCpc35nf1fub9e4wMprIW9bvxNlErWj2GTFi6kK4RRC0Pqy0RqymaxtWp_SFQpBu5qDssqgWvuCauoLpBLHvuhe2hesfqVZnUpbbdP-FCUVgvY0B2WVQbUqyTQpiVTiqGTvUiWt-pW26lTabuej--OVVAja1xyUVQbVqqSlSUmkEkcl-5cqadevtF2n0k77U4RUiDnQGpNVxtSqo61JR6QORx0HH_Ey-87-M57EUZjwWm-onezOePDID9VIoq1Y8jsRLfNjDl-nOZe_jAQ8SQ-_ssOXUXj4KQtYH-41gSltRDuN6IGcpgp3xtTgXhP47M5UaacRPZDT7Jzu_ElbBbhzDltS2JZXy5bCjMqPdpr0hxxG-kMOY_2B0Eh_IDTSH90m_SGHkf6Qw1h_IDTSHwiN9EdPamlfLmm_SX8MmhguhxHD5TBmOEIjhiM0NgFUxmb5P6nK3FSl0SGgNDmVcURzWpoiBVUpk4tO5WMEMZ2W5oiK6giNuI7QmOwYjtiO4ZjupRmqpLucxnSX06juCI7pjuCY7qVBWtS9i-hemilKupdmipLuchrTXU6juiM4pjuCY7qX5qmS7nIa011Oo7ojOKY7gmO6l6Zq8V27I9edlWaLVPfF61-_AwAA___HVZP7

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FdasEtXIzAcfsVQptw1VkWi4BRatrlj4wjRB4mJqGwkS5b9XQBKCJ36PxwzsEvCZOT7znkc2zyz9b85CNuz0Or-NvFUy934f9P_0vnX-_tr70r33ru66w9Hwr961d_V6zXp_xXrz5PUHd52B9-s_3uba696POoPh9gLqwqfrw9_rMfPZIp7q--iHTln4jXHmM8F8JpnPFPNZg419tkziiU7TONle8rwTdKdrFtZ9NlssV9n247HPJnGiWfjMslk21yxko-j7XA90NNVJUGc-m-osms132yyT2Y8o2dyuN0_MZ8NltEhDrxZsd-6vstC75Wz84rN4lR2WT7PoQbOQv_jlLdzN0my2mGRB43h_Y_2D5PvGe4zSx0-uP3gQNh4-xsDd5SAr5cDdBqEKTRzWWS3iZKoTPT1eabbI9ksVehV14PXgo3FWHyizg4_mqT786n7_iNLHoc76y0Dmghttljr8gIcvvR7z2Vz_m13d8utfktnD4-6vElPXspm6YZxkOgmkkd_Pheu3SwRYGIv_uvQnVu7jWrwM1HEwRSZujkxwi3qXaHcgaoG05hww8T6rzTNyziYIl0nISklwt1GoQhMuCMMrks61D5RZEekq-HBDOn4h0oGpeyOdkV9Z0ony3RJlqiVrgbKGDDDxPiatM0LGIgjuMglZKQnuNgpVaMJFuUVFyLj2gTIrgkwFH24gIy4EGTB1b5Ax8isLGVm-W7JMtVRt915lBxlg4n1M2meEjEUQ3GUSslIS3G0UqtCEi3LLipBx7QNlVgSZCj7cQEZeCDJg6t4gY-RXFjKqfLdUmWo1ataIARbeh-TmjIixiIG7y0FWyoG7DUIVmnBRbFURMK59oMyKAFPBhxvAqAsBBkzdG2CM_Kr8KPTJ-gOdLuNFqkv90lPfZqanD3p_Gmm8Sib6axJPdtvs_-3vdLsPpjrN9t_y_T_dxf6rrcGPYp4X849idSTmdmIuT1ELfpL65hS1bNFqQSYu6cQluXWD3pkWc3BetFqIU9SyfpK6TasVmXiTFjcsxCIvbpLiFn3WLVIM7rlNihUo9g1NhTrAggEVKy7QaggGWg7JAOQIDbQcsYEbaDkOXoDgDbbY4AGoER-AHAECyBEhkBzUhRuEOQ4eRUcjJic3MMFpyPAmOHYaM-jWac7wNtjcII1V2Wk1LDsth2UHclR2Wg7LTlNWAMoKGjVgYoEalR3IUdmBHJUdycHEC5qyAgydoJ_gcnKj7IJGjVDg2GnUoFunSSMAaYRBGpuyAzUqO5CjsiM5KDuQw6d-mrICUFbQqEFlB5RF5wYwicoOMInKDuRo4mnKSjA1kn5BzsmNsksaNRI80EkaNeDWJU0aCUgjDdLYlB2oUdmBHJUdyUHZgRyVXdKUlYCykkYNessHlEXnBjCJ3vMBJtGLPpCjiacpK9Gx02_NOblZdho1CjzQKRo1-Vsfv_z0fwAAAP__ovYyiA==

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9u4jgUh-_3KaJzVbRGwU7Cn0grtbtlNUgMdAgXM6q4SImnINEk4wQJWvXdRwlFTEjjE5PWd03xZ__w-Q4nL5D82oAL3nA8_G9ubMXG-H82_WrcD7_fjW9GE-PqduTNvW_jlnH1tmZ3WLHbPxvT2e1wZvz7w9i3jNFkPpx52YKb8Vi-mBjPrdPjbgEEwijgE_-JJ-DeAwUCDAhYQMAGAg4sCMQiWvIkiUS25CUHRsEO3A6BdRhv0-zfCwLLSHBwXyBdpxsOLsz9hw2fcT_gwuwAgYCn_nqTHxOL9ZMv9te7_TMQ8GI_TFyjbWYnT7epa1xTWLwSiLbp2_anXR_2xspPVsX98vULAknqP3Jw6Su5LKajNSarjHnaZxtGIuCCB8Wd1mGaHV1z3Tvf-oufrDyeTmOTntVmvo-5W3QKCGz4z_Tqmrb-EevHVf5X5SWcvqClUgcvEikXJnXO7-zvyv3tGhdYeS3kbet3okyidhSbrHgxVSGcQghaXzZaQzaTtU3rU7pCIWhXc1BWGVRrX1BNfYFU4tgX3Uv7gtWvNKtTaatt2p-ipELQnuagrDKoViWZJiWRShyV7F2qpFW_0ladStvtfHR_vJIKQfuag7LKoFqVtDQpiVTiqGT_UiXt-pW261TaaX-KkAoxB1pjssqYWnW0NemI1OGo4-AjXmbf2X_GkzgKE17rDbWT3RkPHvmhGkm0FUt-J6JlfszhcZpz-ctIwJP08Ck7PIzCw0dZwPpwrwlMaSPaaUQP5DRVuDOmBveawGd3pko7jeiBnGbndOdP2irAnXPYksK2vFq2FGZUfrTTpD_kMNIfchjrD4RG-gOhkf7oNukPOYz0hxzG-gOhkf5AaKQ_elJL-3JJ-036Y9DEcDmMGC6HMcMRGjEcobEJoDI2y7-kKnNTlUaHgNLkVMYRzWlpihRUpUwuOpWPEcR0WpojKqojNOI6QmOyYzhiO4ZjupdmqJLuchrTXU6juiM4pjuCY7qXBmlR9y6ie2mmKOlemilKustpTHc5jeqO4JjuCI7pXpqnSrrLaUx3OY3qjuCY7giO6V6aqsV37Y5cd1aaLVLdF69__Q4AAP__VNGUwA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v6kYYhff9FdasEtXIzAcfsVQptw1VkWi4BRatrlj4wjRB4mJqGwkS5b9XQBKCJ36PxwzsQvCZOT7znkc2zyz9b85CNuz0Or-NvFUy934f9P_0vnX-_tr70r33ru66w9Hwr961d_V6zXp_xXrz5PUHd52B9-s_3uba696POoPh9gLyQt97uj58XI-ZzxbxVN9HP3TKwm-MM58J5jPJfKaYzxps7LNlEk90msbJ9pLnnaA7XbOw7rPZYrnKtv8e-2wSJ5qFzyybZXPNQjaKvs_1QEdTnQR15rOpzqLZfLfNMpn9iJLN7XrzxHw2XEaLNPRqwXbn_ioLvVvOxi8-i1fZYfk0ix40C_mLX97C3SzNZotJFjSO9zfWP0i-b7zHKH385PqDB2Hj4WMM3F0OslIO3G0QqtDEYZ3VIk6mOtHT45Vmi2y_VKFXUQdeDz4aZ_WBMjv4aJ7qw6_u948ofRzqrL8MZC640Wapww-E-NLrMZ_N9b_Z1S2__iWZPTzu_ioxdS2bqRvGSaaTQBr5_Vy4frtEgIWx-K9Lf2LlPq7Fy0AdB1Nk4ubIBLeod4l2B6IWSGvOARPvs9o8I-dsgnCZhKyUBHcbhSo04YIwvCLpXPtAmRWRroIPN6TjFyIdmLo30hn5lSWdKN8tUaZashYoa8gAE-9j0jojZCyC4C6TkJWS4G6jUIUmXJRbVISMax8osyLIVPDhBjLiQpABU_cGGSO_spCR5bsly1RL1XbvVXaQASbex6R9RshYBMFdJiErJcHdRqEKTbgot6wIGdc-UGZFkKngww1k5IUgA6buDTJGfmUho8p3S5WpVqNmjRhg4X1Ibs6IGIsYuLscZKUcuNsgVKEJF8VWFQHj2gfKrAgwFXy4AYy6EGDA1L0Bxsivyo9Cn6w_0OkyXqS61C899W1mevqg96eRxqtkor8m8WS3zf5jf6fb_WOq02z_Ld9_6C72X20NfhTzvJh_FKsjMbcTc3mKWvCT1DenqGWLVgsycUknLsmtG_TOtJiD86LVQpyilvWT1G1arcjEm7S4YSEWeXGTFLfos26RYnDPbVKsQLFvaCrUARYMqFhxgVZDMNBySAYgR2ig5YgN3EDLcfACBG-wxQYPQI34AOQIEECOCIHkoC7cIMxx8Cg6GjE5uYEJTkOGN8Gx05hBt05zhrfB5gZprMpOq2HZaTksO5CjstNyWHaasgJQVtCoARML1KjsQI7KDuSo7EgOJl7QlBVg6AT9BJeTG2UXNGqEAsdOowbdOk0aAUgjDNLYlB2oUdmBHJUdyUHZgRw-9dOUFYCygkYNKjugLDo3gElUdoBJVHYgRxNPU1aCqZH0C3JObpRd0qiR4IFO0qgBty5p0khAGmmQxqbsQI3KDuSo7EgOyg7kqOySpqwElJU0atBbPqAsOjeASfSeDzCJXvSBHE08TVmJjp1-a87JzbLTqFHggU7RqMnf-vjlp_8DAAD__wdpM00=

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryDRJLODVFrx36eEah1Q_MXz8G6l-LFf-3sk3mdQP5cQwqQ36H2ckpVckk_j0Rdy2_t2M7jqD8nZdX8ynXwdnJOzlzXr7YrH9RMZja97Y_LhO3k6J_3htDeelAuuBgNkcQQU0iwRw_hBKAhvgQEFDhR8oBAAhRZEFHKZzYRSmSyXPFdAP3mEsElhkearovx3RGGWSQHhMxSLYikghGl8txRjESdCek2gkIgiXiyrY3K5eIjluvu4fgIKkzxOVUgaXnnyaFWEpMsh2lDIVsXL9q-73q3JPFbz3f26DKJNREEV8b2AkG3o38VsOY3Jj8Z83WeVZjIRUiS7Oy3Sojy65ro3bv05VvOJKEa5x_ZmM13nIty1CCgsxY_irMvO38vF_bz66_cjsL1HeL2gb3vBN4IPs0aWe2x3UscCBDsBWH0RWA0RPN7w_JMYaxC07TgoPxrUqbPMkbO8_iR4nUn4DS84iTIGQS8cB-VHgzpVhjtSxq8_Cb_OJIJG9bP075UxCHrpOCg_GtSpMr4jZYL6kwjqTKLVOIkwBjE7TmPyozGd6hL8hyL1RqKxUHmWKlGrITXLO4nkXmxfS2UrORM3MptVx2w_jiqu-rVPhCq23_Lth366_aoMWB9u28AdG5hZ5WYtPc0MnoybwW0buGMDM6vce092QPN9uvkn7evf29fCbPfNmvt0YCO4HkYE18OI4HoYExyhEcFbNoLrYURwPYwIrocxwREaEbxtI_iFjaJ6GFFUDyOK6mFMUYRGFL20UVQPI4rqYURRPYwpitCIoh0bRZlVT0BoRFKERixFaExTDMe6gl1ZsGsLdnXBsi_YFQZm1RjYQWUwslVPY7bqacxWPY3aiuCYrSZl6XBmJm3JlMZsNepLxjhm60F50Noabd79CgAA__9CgYxO

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkS3co0JAYdcNhU5ZASryDRJLODVFrx36eEah1Q_MXz8G6l-LFf-3sk3mdQP5cQwqQ36H2ckpVckk_j0Rdy2_t2M7jqD8nZdX8ynXwdnJOzlzXr7YrH9RMZja97Y_LhO3k6J_3htDeelAuuBgNkcQQU0iwRw_hBKAhvgQEFDhR8oBAAhRZEFHKZzYRSmSyXPFdAP3mEsElhkearovx3RGGWSQHhMxSLYikghGl8txRjESdCek2gkIgiXiyrY3K5eIjluvu4fgIKkzxOVUgaXnnyaFWEpMsh2lDIVsXL9q-73q3JPFbz3f26DKJNREEV8b2AkG3o38VsOY3Jj8Z83WeVZjIRUiS7Oy3Sojy65ro3bv05VvOJKEa5x_ZmM13nIty1CCgsxY_irMvO38vF_bz66_cjsL1HeL2gb3vBN4IPs0aWe2x3UscCBDsBWH0RWA0RPN7w_JMYaxC07TgoPxrUqbPMkbO8_iR4nUn4DS84iTIGQS8cB-VHgzpVhjtSxq8_Cb_OJIJG9bP075UxCHrpOCg_GtSpMr4jZYL6kwjqTKLVOIkwBjE7TmPyozGd6hL8hyL1RqKxUHmWKlGrITXLO4nkXmxfS2UrORM3MptVx2w_jiqu-rVPhCq23_Lth366_aoMWB9u28AdG5hZ5WYtPc0MnoybwW0buGMDM6vce092QPN9uvkn7evf29fCbPfNmvt0YCO4HkYE18OI4HoYExyhEcFbNoLrYURwPYwIrocxwREaEbxtI_iFjaJ6GFFUDyOK6mFMUYRGFL20UVQPI4rqYURRPYwpitCIoh0bRZlVT0BoRFKERixFaExTDMe6gl1ZsGsLdnXBsi_YFQZm1RjYQWUwslVPY7bqacxWPY3aiuCYrSZl6XBmJm3JlMZsNepLxjhm60F50Noabd79CgAA__9CgYxO

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1r4kAUhu_3V4RzpTASZxJtDSy07Lqs4GpXvVgoXqRmtgZskp0ZQVv635ckLa5fczI72FzGzJO8OecB3xeQf1YQwLQ_7H-ZOWuxcr5Nxj-c-_6vu-HtYOQ0vg6ms-nPYdN5O7IpDzQa79fE2ZY_bbbPTWcwmvUn0_zG7XDonD7UnAOBJI34KHziEoJ7oECAAQEPCPhAoANzAplIF1zKVORHXgpgEG0gaBOIk2yt8p_nBBap4BC8gIrVikMAs_BhxSc8jLhw20Ag4iqMV8VrMhE_hWJ7s9k-A4FpFiYycFpu_ubxWgXODSU3DOavBNK1envD7sEPW2cZyuX-I9-ROQGpwkcOAX0l_xe2U0NYdjbs7lHrJBURFzzaf1icKBInKk9gcPbEDL6Hcjnlapy59GBfs23Gg32lgMCK_1aN4lOan0X8uHy_2A3mYCq7z_WsPvd0_FHaSjOX7m_vXAB_LwCtLgetIIfLWq53QZcN4nZricvOxq3FZvqhNrPq22FVtuO1XP-CMhnEvaolLjsbtxaZ2IfK5FXfjldlO36r-Hu7lEwGca9ricvOxq1FJu9DZfKrb8evsp1O64IqGYTt1RCWnQ1bi0h-bYXtRK4Jl1maSF6pibXzL-PRIy9nJ9O1WPA7kS6K15SX44IrmkTEpSrvsvJikJS38oDV4a4N3LOBqVVu2tHT1GBkzAzu2sA9G5ha5T4Y2RHNDun2v7Snn7enhen-zNqHtG8juB5GBNfDiOB6GBMcoRHBOzaC62FEcD2MCK6HMcERGhG8ayP4lY2iehhRVA8jiuphTFGERhS9tlFUDyOK6mFEUT2MKYrQiKI9G0WpVU9AaERShEYsRWhMUwzHuoJdWbBrC3Z1wbIv2BUGatUY6FFlMLJVT2O26mnMVj2N2orgmK0mZel4ZyZtyZTGbDXqS8Y4ZutRedDaOn_99DcAAP__pB2tMQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmN9u4kYYxe_7FNZ3lUiDYGYMIZYqZdVNVSSabAMXlVZceGGaWGJtahspbJR3r8BN-GP8HXtsZy8N_jFnjuccz_BCyb9L8mhyO779beqs46Xz-8P9n87X27-_jD-N7pyLz6PJdPLX-NL5_5bn7IaLi7dr4Wyyj543Py6d0d309mGy_eL8DZczEhRGC3PnfzcJeV9JkiBFgjQJcklQn2aCVnE0N0kSxdtbXnbAaPFMXk9QEK7W6fbjmaB5FBvyXigN0qUhj6b-t6V5MP7CxN0eCVqY1A-Wu2FWcfDdjzc3z5sfJGiy8sPEczrd7cj369RzbqS4UTR7FRSt0_0ISeo_GvLkqyiv4nOQpEE4T7v9YwnnhthT3zbOk588nUf2SlQVJYd-yEYN0VaGyDYccQul7H9qHUbxwsRmcfxjQZiKIEyznytUrXpY9V5Ov3U5JUzcyxk0IUfUk_6HnzxNTHq_6uoTK6eblfEOSuPTeEyCluaf9GI3rctf4-Dx6e1ivzQLp3tVa7rn5d9FnWjV1ce2FwkYHgmQFfJZIp5d1elqm8YCOt7X1qD1xqriSMOWaCtLZBueuIVSmioJad9ZbcgpYWJRZ1nKaa6z5Id2liofEFUmH7rTdW0qA-h4f7RXrVdGBUdkw5ZoK0tkG564hVKayqiyr4w25JQwsagyLOU0VxnqQytDlw-ILpMPt7M7ulSuDKDj_dEOW6-MCo7Ihi3RVpbINjxxC6U0lVFtXxltyClhYlFlWMpprjL0h1aGWz4gbpl89Ds2hQFUvD_Y69YLo4IfslFDtJUhsg1H3EIpTeXTta-LNuSUMLGoLizlNFcX7k_7I-WMrgeTrKIwMaX-IeltZ2YWjybzLonW8dx8iaP5bpjs8n7H7T5YmCTNvpXZxSjMvtoKPITlKSwPYfcIltVgqWrR13VoNahDa83TinVc845rdug-PzIPS6Cbp1WvFn1Vh9Zgpbms4-Bh9yvA6hQesDCY9BW_UAb8Shmy9DUPX9cJNg-jYAMaBJunUbB5GgVbgi5FZcrXCsg2oFG4AY7SjXCw0gGO8i35SpUIz7ULh-cyLvl6QVPn-0WClMtcw1R6BfM0fAcDHL2EeRy-hXkcppWvVzkExuf6tVJaeRqmlcdhWgGOliyPw7TmWvbIeCXB9olv2RM8l1aVq5oqaVV80yiwe1P8PgYYB2iUVoSDtAIcpRXgcNPMl6zqA-NzLVslrYBGaQU4SivC0ZLlcZRWxW9h1RDgfMue4Pm08rtYNHW-aXQPnLVyTVMlrYBGaUU4SCvAUVoBjtKq-ZLVChifa9lKp1yehsdcHofnXICjgy6Po7RqfiurkXV8y57gubRqfi97OvXZ6y__BQAA__-4Imgu

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1vokwUx--fT0HOVZtnDM4AvpBsYrd1syZu7YoX3TRcUJmtJhbYARNp43ffiHVbpM5hxJe7WuY3c5zz-3t4hfjPDGxwuv3u9Uibi5n2bTj4oT107-_6V71b7eKm54ycn_1L7eJtTbpesUhfLrXu_XX3bqRd9fv_Hi-0Kye3ZjC86Q61r7-01AUCQejzW--Zx2A_AAUCDAgYQMAEAha4BCIRjnkch2K15DUDev4C7DqBaRDNk9W_XQLjUHCwXyGZJjMONoy8xxkfcs_nQq8DAZ8n3nSWHROJ6bMn0s4ifQECTuQFsa3V9NXJg3liax0G7pJAOE_etn_f9THVJl48ye_XoeAuXQJx4j1xsOmS7FempVgmrVQm21nm-z7zIBQ-F9zP7zQNktXRJdd98q2_e_HE4ckg0ulWb0ZpxO0PHgGBGf-dXHTo5RcxfZpkf-28gfdvZ6g0wQlFwoVOre0L-3_n_maJ29t5J-Rt609KuQ1rYaSz_K3sKsLKFUHLm0ZLmKazmm4cJRIKhTaUCz1kKOi5QkFPEQqkDZtQNPYNBSvfZlamzUZNN4_io0KhTeVCD-kjO5eP7BQ-Im3Y-Njc10ejfJuNMm02a9nEPryPCoW2lAs9pI_GuXw0TuEj0oaNj619fTTLt9ks02ardhQbFcpsK5Z5SBfNc7lonsJFpAkbF9uHeIH9ZP8hj6MwiHmpt9L66sK4_8TXrYjDuRjzOxGOs2PWHwcZl72D-DxO1k_Z-kMvWD9aFVgeblaBKa1EW5XotpymCnfG1OBmFXjrzlRpqxLdltNsm65_pI0cXN-GDSlsyrtlSmFG5UdbVfIhh5F8yGEsHwiN5AOhkXw0quRDDiP5kMNYPhAayQdCI_loSi1tySVtVclHu4rhchgxXA5jhiM0YjhCYxNAZWwWf0lV5qYqjQ4BpcmpjCOa08IUyalKmVx0Kh8jiOm0MEdUVEdoxHWExmTHcMR2DMd0L8xQJd3lNKa7nEZ1R3BMdwTHdC8M0rzuDUT3wkxR0r0wU5R0l9OY7nIa1R3BMd0RHNO9ME-VdJfTmO5yGtUdwTHdERzTvTBV8-_adbnurDBbpLq7y__-BgAA__87d4n-

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMx98xFKlpBuqRqIhBS62WnHhhWmCxGJqGylslP9eAQGCHb9nxgy5S2KfmeMz73lk54Wl_81YyAadbufL0FsmM--Pfu8v71vn60P35u7eu7i9GwwHf3cvvYu3e1bbO55XPy-9ztcvnYfh_tKzdzM4ut7r33b63u__eKsR89k8nuj76IdOWfiNceYzwXwmmc8U81mDjXy2SOKxTtM4Wd_yshHcTZ5ZWPfZdL5YZus_j3w2jhPNwheWTbOZZiEbRt9nuq-jiU6COvPZRGfRdLbZZpFMf0TJ6vp59ZP5bLCI5mno1YL1zr1lFnrXgo1efRYvs8PyaRY9ahbyV9_cwu00zabzcRY0jve_5rn1D5LvK-8pSp8-uP_gQdh4eB8Dt80h7_PgQVbKgbsNQpWaOKyznMfJRCd6crzSdJ5tlyr1KurA68FH46w-UGYHH81TffjV_f4ZpU8DnfUWgcwFN1wtdLijwk23y3w20_9mF9f88rdk-vi0-clg5Fo2IzeIk0wngSyE92vp-m2D9Eoz8d-W_sDKfVyLF4E6TqXMxNWRCW7RbYNqB6IWSGvIARP7QW2eEXI2QdgnYYo50yS42yhUqQkXeOEVMefaB8qsDHMVfLjBHP8MzIGR22GuEJ4p5oR5sYRJr2QtUNaEASb2M9I6I2EsguD2SZgSxjQJ7jYKVWrCRbNFRcK49oEyKyNMBR9uCCM-gzBg5HaEKYRnShhpXixp0itV23xO2REGmNjPSPuMhLEIgtsnYUoY0yS42yhUqQkXzZYVCePaB8qsjDAVfLghjPwMwoCR2xGmEJ4pYZR5sZRJrxo1a74AC_sJuTojXyxi4LY5mNLFNAfuNghVasJFq1VFurj2gTIro0sFH27ooj6DLmDkdnQphFflH0EfrN_X6SKep9rovzv1dWB68qi3R5HGy2SsH5J4vNlm-2tvo9v8YaLTbHuVb3-5m28vrQ2-F_O8mL8XqyMxtxNzeYpa8JPUV6eoZYtWCzJxSScuya0b9M60mIPzotVCnKKW9ZPUbVqtyMSbtLhhIRZ5cZMUt-izbpFi8MxtUqxAsa9oKtQBFgpQseICrYZgoOWQDECO0EDLERt4AS3HwQsQfIEtNngAasQHIEeAAHJECCQHdeEFwhwHj6KjEZOTFzDBacjwJjh2GjPo0WnO8DbYvEAaq7LTalh2Wg7LDuSo7LQclp2mrACUFTRqwMQCNSo7kKOyAzkqO5KDiRc0ZQUYOkG_weXkhbILGjVCgWOnUYMenSaNAKQRBdLYlB2oUdmBHJUdyUHZgRy-9dOUFYCygkYNKjugLDo3gElUdoBJVHYgRxNPU1aCqZH0B3JOXii7pFEjwQudpFEDHl3SpJGANLJAGpuyAzUqO5CjsiM5KDuQo7JLmrISUFbSqEFf-YCy6NwAJtF3PsAk-tAHcjTxNGUlOnb6qzknL5adRo0CL3SKRk3-0Uevv_wfAAD__28FKIs=

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lkFv2jAYhu_7FdZ3aiWjYCfQEmkSXcs0JFY64NCpyiElXkGiSWYHqWnFf58I1Vqg-Ivn4VspfuzX_h6J9wXU7wWEMO4NepcTspQL8nU0_E7uerc3g4v-NTm56o8n4x-DU3LyuqbcrHgqn8lwdNUbkS8_SXlKereXvZsJuRgMkJURUEizRFzHj0JBeAcMKHCg4AOFACi0IKKQy2wqlMrkeslLBfSTJwibFOZpvizW_44oTDMpIHyBYl4sBIQwie8XYiTiREivCRQSUcTzRXVMLuePsSy7T-UzUBjncapC0vDWJw-XRUi6HKIVhWxZvG7_tut9SWaxmm3v12UQrSIKqogfBIRsRf8tZstpTH4w5ts-yzSTiZAi2d5pnhbro2uu--DW32I1G4timHtsZzaTMhfhO4WAwkL8Kk667PSznD_Mqr_-vgDbeYG32_m2t_sg9XXWyHKPbY_pUIBgKwCrbwGrYYHHG55_FF0NgrYdB-UHgzoVlrkQltcfA68zBr_hBUfxxSDomeOg_GBQp75wF7749cfg1xlD0Kh-jf6_LwZBzx0H5QeDOvXFd-FLUH8MQZ0xtBpHscUgZsdpTH4wplNXAtfl6YM4I6HyLFWiVitqri8kkgexeSqVLeVU3MhsWh2z-TisuOoXPhGq2HzLNx_66eardcD6cNsG7tjAzCo3a-lpZvBk3Axu28AdG5hZ5d55sj2a79LN97Svf29fC7PtN2vu0oGN4HoYEVwPI4LrYUxwhEYEb9kIrocRwfUwIrgexgRHaETwto3gZzaK6mFEUT2MKKqHMUURGlH03EZRPYwoqocRRfUwpihCI4p2bBRlVj0BoRFJERqxFKExTTEc6wp2ZcGuLdjVBcu-YFcYmFVjYHuVwchWPY3ZqqcxW_U0aiuCY7aalKX9mZm0JVMas9WoLxnjmK175UFra7T69CcAAP__-N6G3A==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFFv4kYUhd_7K6z7lEhGMDOGEEuVst1QNRINKfCw1YoHL0wTS6zt2kYKG-W_V0AXgh3f4zFD3hLwZx8f33M8wwtl_y7Jp8lgOPg8dVbp0vl9PPrT-Tr48jD8dHfvXNzeTaaTv4aXzsX_x6x3Rzyvfzij8e1g7Pz2t7O-dAZfPg8epuCoGbkUxQt9H3zXGflfSZBLklxS5JJHLnVp5lKSxnOdZXG6OeRlC9wtnsnvuBRGySrffDxzaR6nmvwXysN8qcmnafBtqcc6WOi03SGXFjoPwuX2Mkkafg_S9c3z-ge5NEmCKPOdVntz5dEq950bSbNXl-JVfjh9lgePmnzx6taXcBtmeRjN83b3-Po3onD-A_Jt7TwF2dM7xx80SBMNb20Q9nxQjXwQdo3wKkUczrOK4nShU704PlMY5btTVWqVHaD1oKN7Vh3Is4OO3qk63OZ6_wiyp4nOR0lbFYybrhPt_yyET8MhubTU_-QXN-Ly1zR8fNr-tR-56ru7OoPL93ErTtrq2OIqAf0jAcIgdzVi15attjIuICBiP0S9MxaQiRE2nVCNnBB2rfAqRdiIvmhYQbZ1IM-qKqiBDjsVJD6igmT9wZd15l612p5xAwAR-2d4dcYGMDBC2HRCNXJC2LXCqxRhI3myYQPY1oE8q2qABjrsNID8iAZQ9Qdf1Zl7r7XdKpg1ABCxf4b9MzaAgRHCphOqkRPCrhVepQgbyVMNG8C2DuRZVQM00GGnAdRHNIBXf_C9OnPfbRnnH0jYP8HrM-bfwAZhzwfVyAdh1wivUoSN1HkN029bB_KsKv0NdNhJv_fRP0K8I2essySOMl3r14XO5ob04lHvrMriVTrXD2k8315m9-9oy20_WOgs330rdv_cRbuvNgLfwqIIi7ewdwQLM1jIk-jrU2jZO4VWiqcl67jiHVfspbv8lXlYAN08LTsn0Ven0ApMmsc6Dh521wCWRbjHwuCmr_hB6fGT0mfpax6-PiXYPIyCDWgQbJ5GweZpFGwBuhSVKV8rINuARuEGOEo3wsGkAxzlW_CVKhBeahcOL2Vc8PWCbp3vFwFSLkoNY_QK5mn4DgY4egnzOHwL8zhMK1-vog-ML_WrUVp5GqaVx2FaAY5GlsdhWkste2S8FGD5xLdsAS-lVZaqxiStkm8aCVZvkl_HAOMAjdKKcJBWgKO0AhwumvmSlV1gfKllTdIKaJRWgKO0IhyNLI-jtEp-CSv7AOdbtoCX08qvYtGt802jOmCvVWoak7QCGqUV4SCtAEdpBThKq-JLVklgfKlljXa5PA23uTwO97kARxtdHkdpVfxSViHr-JYt4KW0Kn4tW7z12esv_wUAAP__E78m2w==

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll9P4koUwN_vp5icJ80d0k7_8KeJiV6tkYQLLpCsG5eHSmeFBGl3WhLQ-N03LbJaKnM6VMqbtfOb6TnndzjzAtHvGTgwcDvu5ZAsxIxc93v_k3v37rZz0e6Sk6v2YDj41jklJ29rlusVy9Uz-X7j9l2yJD8Xum6OiXFK3LtL93ZILjoddD0_S4Be_8rtk_9-kOUIKMwDn3e9Jx6Bcw8MKBhAwQQKFlCwYUQhFMGYR1EgkiUvKdD2l-DoFKbzcBEn_x5RGAeCg_MC8TSecXBg6D3MeJ97PheaDhR8HnvTWXpMKKZPnlidL1fPQGEQevPIITUtOfl6Oou5cMg5-xui4zjt7rAJFHqLOHkDo1cKwSJ-O_v9yIcVmXjRJHtYun5EIYq9Rw4Oe6X7xWDvHUOS9q8NwtgZxPs-i3kgfC64n91pOo-Towuu-yQnN140GfC4F2psq6zDVcidDz4ChRn_FZ-cs9MzMX2cpH_tzMB7dKZKiQaBiLnQmL2dsH937m8VyN7OnNC3rT_5lG5QC0LNyGZl10fYmY9gxT1kBTzUjJpmVt9NClHUS0Rx6H5ix-onVkU_IUXa9FN9334yiktgFJHArGlW9SorRNEoEcWhVTaOpbJRhcpIkTYqN_ZV2SwugVlEAquW3iIqVlkhimaJKA6tsnkslc0qVEaKtFG5ua_KVnEJrCIS2LXqRVaIobV3DIfW2DqWxlYVGiMl2mjc-orL-if793kUBvOIF7qB60nCuP_I16WIgoUY81sRjNNj1o-9lEsvTT6P4vVbY_3Qnq9fJR9YHG6UgRkrRdul6JacZgo5M9TgRhl4K2eqtF2KbslpY5vWP9JmBta3YVMKW_JqWVLYYPKj7TL9IYeR_pDDWH8gNNIfCI30R71Mf8hhpD_kMNYfCI30B0Ij_dGQWtqUS9os0x-tMobLYcRwOYwZjtCI4QiNTQCVsZn_JVWZm6o0OgSUJqcyjmjOclMkoyoz5KIz-RhBTGe5OaKiOkIjriM0JjuGI7ZjOKZ7boYq6S6nMd3lNKo7gmO6Izime26QZnWvI7rnZoqS7rmZoqS7nMZ0l9Oo7giO6Y7gmO65eaqku5zGdJfTqO4IjumO4JjuuamavWvrct2N3GyR6j56_edPAAAA__-ISd-q

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v2kgfxe-fT2HNVaLHyMwLL7FUKd2GqkhsyALSdtXlwoXZxBLFrG0kaJTvvgIKBBz_z9gecpeAz8zxmf_5yeaZJf_OmM-GnV7n08hZxjPn86D_u_Ot8_Wh97F771zddYej4R-9a-fq1zWr3RWr9U_nzy-dQcdZOX8v63U5ccS10_n6qfMwgtfqD5uL-4O7zsD57S9nNWYum0dTfR_80AnzvzHOXCaYyyRzmWIua7CxyxZxNNFJEsWbS563gu50xfy6y8L5YpluPh67bBLFmvnPLA3TmWY-GwXfZ3qgg6mOvTpz2VSnQTjbbrOIwx9BvL5drX8ylw0XwTzxnZq32flzOEt17Du3_HB7vu9370dt5rL-Mt18w8YvLouW6XHvJA0eNfP5i2vu7y5M0nA-Sb3GqbnM-kfJ97XzFCRPb1x_9CCKeHidES8f0uZczVOSpVLidmNSuSaO6yznUTzVsZ6erhTO091SuV5FHXg9-mhc1AfK7OijWdWHW97vlyB5Guq0v_DkWXCj9UL7e7p87PWYy2b6n_Tqll9_iMPHp-1fBiPXKjJywyhOdezJTHj_z12_bZBebibur6XfsHIf1aKFp05TyTNxc2KCF2i-QfE9UfOkXT4Ch4cpbl6Qj0VSqhJTFUKa5sTtBqVyTdggEy9JSNs-UGZ5hCzhww4h-XsQEozcnpCZ8EwJKcxrJ0xaJ2uesgsn4PAwQK0LwqlASrxKTFXgZJoTtxuUyjVhAwqiJJxs-0CZ5cGphA87cBLvAScwcns4ZcIzhZM0r500aZ2qbV_xLMIJODwMUPuCcCqQEq8SUxU4mebE7Qalck3YgIIsCSfbPlBmeXAq4cMOnOR7wAmM3B5OmfBM4aTMa6dMWteo2UUT8HcYn5sLoqlARrx8SFXAZJoStxuTyjVhAwiqJJhs-0CZ5YGphA87YFLvASYwcnswZcIr86PXG-sPdLKI5ok2-iWrvglMTx_17iiSaBlP9EMcTbbb7P7tb3XbD6Y6SXff8t0_3fnuq43B12J-LuavxepEzIuJuayiFryS-qaKWrZotSATl3Tikty6Qe9Mizk4L1otRBW1rFdSt2m1IhNv0uJGAbE4FzdJcYs-6xYpBvfcJsUKFPuGpkIdYCEDlUJcoNUQDLQckgHIERpoOWIDz6DlNHgBgs-wpQgegBrxAcgRIIAcEQLJQV14hjCnwaPoaMScyTOY4DRkeBMcO40ZdOs0Z3gbbJ4hTaGy02pYdloOyw7kqOy0HJadpqwAlBU0asDEAjUqO5CjsgM5KjuSg4kXNGUFGDpBP8GdyTNlFzRqhALHTqMG3TpNGgFIIzKkKVJ2oEZlB3JUdiQHZQdy-NRPU1YAygoaNajsgLLo3AAmUdkBJlHZgRxNPE1ZCaZG0i_IZ_JM2SWNGgke6CSNGnDrkiaNBKSRGdIUKTtQo7IDOSo7koOyAzkqu6QpKwFlJY0a9JYPKIvODWASvecDTKIXfSBHE09TVqJjp9-az-TZstOoUeCBTtGoOb_18cv__gsAAP__VBl-Nw==

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElt9uwjYUh-_3FNa5KppRYifhT6RKdG2qIjHoAGmdOi5S4hUkSjInSNCKd5-AMhpSfGJS4K6UfHbO8ffj-APifyfgQs9rebd9MpMTct_t_E6evafH1k2zTa7umr1-749WiVx9PrPYPDFfvJM_H7yuR-bk75lpWuKasBLxnm69xz65abVQYEisEul077wu-e0vshgAhWkYiLb_JmJwn4EBBQ4ULKBgAwUHBhQiGQ5FHIdy9cjHGmgGc3BNCuNpNEtW_x5QGIZSgPsByTiZCHCh779MRFf4gZCGCRQCkfjjyXqbSI7ffLlozBfvQKEX-dPYJWVjtfP9eJII6ZIG25Xoum6z3a8Bhc4scUmDw2BJIZwln5vv9nxZkJEfj9K7NRgMlgMKceK_CnDZkh5XhHN0EUNi_WwN_GANu3Vm01AGQoogvdJ4mqy2zvncNy158ONRTySdyGB7x9pfRML9oiNQmIh_kqsGK13L8eto_df_HWB7HdhVZ-mcUC-UiZAGc_Yb9uvB9e0c3TvYE_q59Dev0g7LYWTwdFcOvYSTegmWX0OWQ0ODlw3rAmnSKKNSoIwT54ldKk_sHHlCzmibp8qxeeL5HeB5HLDKhn0BlTXKqBYo48Qq80upzM-hMnJGW5Wrx6ps5XfAyuOAXV5fIs6tskYZtQJlnFhl61IqW-dQGTmjrcq1Y1W28ztg53HAKV9AZI0i6kcXcWKN7UtpbJ9DY-SEthrXf-Ky_s36XRFH4TQWuW7g5qphIngVm6OIw5kcikcZDtfbbD521tz60hSIONl8yzcfmtPNV6sXzA9Xi8CMFaKdQnRdTTONnnE9uFoE3uuZLu0Uoutqmu_T5lfaSsHmPmwpYVt9WrYS5ky9tVMkH2oYyYcaxvKB0Eg-EBrJR6VIPtQwkg81jOUDoZF8IDSSj6rS0ppa0lqRfNSLGK6GEcPVMGY4QiOGIzQ2AXTGZvaXVGdu6tLoENCanNo4ojnLTJGUqoyrRWfqMYKYzjJzREd1hEZcR2hMdgxHbMdwTPfMDNXSXU1juqtpVHcEx3RHcEz3zCBN615BdM_MFC3dMzNFS3c1jemuplHdERzTHcEx3TPzVEt3NY3prqZR3REc0x3BMd0zUzV91zbVuvPMbFHqPlj-8l8AAAD__4Cn37c=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v2kgfxe-fTzGaq0SPEcwLL7FUiW5DVSQ2ZAFpu-pyQWE2QaKYtY0UGuW7r4ACwY7_Z2wPuUvAx3PmzP_8ZPPMo38X3OfDTq_zacTW4YJ9HvR_Z986X-97H7t37Oq2OxwN_-hds6tf12z2VzxtfrI_v3QGHfbE_l7Xasp8YOKadb5-6tyP4MVTpq5Zf3DbGbDf_mKbMff4MpiZu8kPE3H_Gxfc45J7XHGPa-7xOh97fBUGUxNFQbi95Hkn6M6euF_z-Hy5Wsfbj8cenwah4f4zj-fxwnCfjybfF2ZgJjMTVmvc4zMTT-aL3TKrcP5jEm7aT5uf3OPD1WQZ-axS3a78eb6ITeiztjhtz_f97t2oxT3eX8c-a0s-fvF4sI5Pi0fx5MFwX7x49gZv51E8X07jav3cXVsk7n-SfN-wx0n0-Mb1Jw8yj4fXIYniKU2Zsg9JFQpJuE1JZ5o43We9DMKZCc3s_E7zZby_VaZXWQNeTz7qF_WBMjv5aJT14RX3-2USPQ5N3F9VVSK40WZl_ANcPvZ63OML80981RbXH8L5w-Pur-PIZe-umWfkhkEYm7CqUuH9P_P-LYv0MjPxft36DSt3QSVYVfV5Klkmbs5MiBzFt-h9VVaqyjEfgcXjGDcuyMc8MZXJqQQhbWMSbnPSmSZckEkUJKRrHyizLEIW8OGGkOI9CAlG7kDIVHi2hJT2rZM2pVOVqnYMJ2DxOEHNC8IpR0yiTE4l4GQbk3Cbk8404QIKsiCcXPtAmWXBqYAPN3CS7wEnMHIHOKXCs4WTsm-dsimdruze8FzCCVg8TlDrgnDKEZMok1MJONnGJNzmpDNNuICCKggn1z5QZllwKuDDDZzUe8AJjNwBTqnwbOGk7VunbUpXrzhGEzB4nJ-bC6IpR0iieEolwGQbknCbks404QIIuiCYXPtAmWWBqYAPN2DS7wEmMHIHMKXCK_Kj1xv3H5hoFSwjY_VLVm0bmJk9mP1RRME6nJr7MJjultn_29_pdh_MTBTvvxX7f7rL_Vdbg6_FIikWr8X6TCzyiYUqo5ailPqmjFo1abUkE1d04opcuk6vTIsFOC9aLWUZtaqVUrdotSYTb9Dieg6xTIobpLhJn3WTFIM9t0ixBsW-oalQA1hIQSUXF2g1BAMth2QAcoQGWo7YIFJoOQ9eguBTbMmDB6BGfAByBAggR4RAclAXkSLMefAoOhoxCXkKE4KGjGiAY6cxg7ZOc0a0wOIp0uQqO62GZaflsOxAjspOy2HZacpKQFlJowZMLFCjsgM5KjuQo7IjOZh4SVNWgqGT9BNcQp4qu6RRIzU4dho1aOs0aSQgjUyRJk_ZgRqVHchR2ZEclB3I4VM_TVkJKCtp1KCyA8qicwOYRGUHmERlB3I08TRlFZgaRb8gJ-SpsisaNQo80CkaNWDriiaNAqRRKdLkKTtQo7IDOSo7koOyAzkqu6IpqwBlFY0a9JYPKIvODWASvecDTKIXfSBHE09TVqFjp9-aE_J02WnUaPBAp2nUJLc-fvnffwEAAP__t2B-RA==

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdZ3aiWjYCfQEmkSVcc0JFa6wqFSxSElXolEk8w2EmnV_z6RtGuB1l88QzmG5LFf-3sk3kdQf-YQwqg36J2PyULOyfer4U9y07u-HJz1L8jRt_5oPPo1OCbPnywpKapvlsUD6V2f9y7H5GwweHlfULL8934CFNIsFhfRvVAQ3gADChwo-EAhAAotmFDIZTYVSmVy9cljCfTjJYRNCkmaL_Tq5wmFaSYFhI-gEz0XEMI4up2LKxHFQnpNoBALHSXzcptcJveRLLrL4gEojPIoVSFpeKudhwsdki6jXQ6TJwrZQj_v8LrwbUFmkZqtL_mCTCgoHd0JCNkT_b-wLcuwnHaZa1j-YdjXpRZpJmMhRby-WJJqmqR6lcDi23fu4EekZiOhh7nHNuY1LnIRvpEJKMzFb31UnuP4q0zuZi8PphG-HtffxXHfOcJF1shyj61P8KMQwVoIVl8QVkMQjzc8f48-W8RtW8fdvdHs0EazTzWa158OrzMdv-EFe5TJIu6Jddzdy8QPLRP_VJn8-tPx60wnaJR_cfuSySLuqXXc3cvkH1om_1NlCupPJ6gznVZjjypZhO1Yht29SMGhRQoOVtreyXUlVJ6lStRqYs3VyUR8J6q7U9lCTsWlzKblNtXjsOTKJhELpau3vHrop9WrVcD6cNsF7rjAzCk3a5lpZnFl3A5uu8AdF5g55d64si2ab9LNt7Rvvm_fCLP1O2tu0oGL4GYYEdwMI4KbYUxwhEYEb7kIboYRwc0wIrgZxgRHaETwtovgJy6KmmFEUTOMKGqGMUURGlH01EVRM4woaoYRRc0wpihCI4p2XBRlTj0BoRFJERqxFKExTTEc6wpuZcGtLbjVBce-4FYYmFNjYFuVwcpWM43ZaqYxW800aiuCY7balKXtmdm0JVsas9WqL1njmK1b5cFo6-Tpy98AAAD__364p48=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmEFv4jgcxe_7KaL_aUYyAtuB0kgrdTTDaiuxbbdwGGnEIQPeNhKTsEmQYKp-9xWwhUKa_7ND0jlC-MXPL34vNk-U_TungEaD4eDz2Fumc--P-9u_vG-Dr3fDT9c33ocv16Px6O_hR-__n6yEt979ZrX-6Q2-fh7cjV-urYW32l-bkKA4mZmb8IfJKPhGkgQpEqRJkE-CujQRtEiTqcmyJN385GkLXM9WFHQERfFimW--ngiaJqmh4InyKJ8bCmgcfp-bexPOTNrukKCZycNovh1mkUY_wnR9tVr_JEGjRRhngddqb0a-XeaBdyXFlaLJs6BkmR9GyPLwwVAgn4W9ii9RlkfxNG93jyW8NcSB-r72HsPs8W3koES5KHnth3Q1RIkrWWqIrmSIbMIRv1TK4VbLOElnJjWz45tFcS6iON_drlS16mDVBzndxuVYmHiQ06tDjjhP-p9h9jgy-e2irU-sHK8XJnipi0_DIQmam3_yD9s5ffw9jR4eXz7YBfWiIfdvklayaOtj68tE9I9ESIeMWkS0rVptXaW1gI79-uo13loujrhb4tBbtpbIJjzxS6XUVRSyem81IcfCxLLeqiinvt6S79pbyj4gyiYfutX2q1QG0LF_tBeNV4aDI9LdEofKsLVENuGJXyqlroyq6pXRhBwLE8sqo6Kc-ipDvWtlaPuAaJt8-K3t8cW5MoCO_aPtN14ZDo5Id0scKsPWEtmEJ36plLoyqqtXRhNyLEwsq4yKcuqrDP2uleHbB8S3yUe3VaUwgIr9g71svDAc_JCuhjjUha0hsglH_FIpdeXTr14XTcixMLGsLirKqa8u_F_2Z8obuu5NtkjizFj9Q9LZzMzMHszOuyxZplNzlybT7TC7j7dbbvvFzGT57qrcfbiOd5c2Al_D8hSWr2H_CJZusFRn0Zfn0Kp3Dq01TyvWcc07rtmhu_zIPCyBbp5WnbPoi3NoDVaazzoOHnbXAVancI-FwaQv-IXS41dKn6UvefjynGDzMAo2oEGweRoFm6dRsCXoUlSmfK2AbAMahRvgKN0IBysd4Cjfkq9UifBCu3B4IeOSrxc0db5fJEi5LDSM0yuYp-E7GODoJczj8C3M4zCtfL3KPjC-0K9OaeVpmFYeh2kFOFqyPA7TWmjZI-OVBNsnvmVP8EJaVaFqXNKq-KZRYPem-H0MMA7QKK0IB2kFOEorwOGmmS9Z1QXGF1rWJa2ARmkFOEorwtGS5XGUVsVvYVUf4HzLnuDFtPK7WDR1vml0B5y1Ck3jklZAo7QiHKQV4CitAEdp1XzJagWML7Ss0ymXp-Exl8fhORfg6KDL4yitmt_KamQd37IneCGtmt_Lnk598vzbfwEAAP__v5JijA==

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll9v2jwUh-_fT2Gdq6LXKNhJ-BNpUruWaUisdMBFp4qLlHgFiSaZEyTSqt99IpTREPCJCYU7KH7sE5_n15NXiP7MwIFBu9u-HpK5nJFv_d4P8tC-v-tedW7JxU1nMBz87FbIxfuaxWrFInkhvf5Nu0--_iJJhbTvr9t3Q3LV7f5bmZCrwc7lL5XN58UIKPiBJ27dZxGB8wAMKHCgYAIFCyjYMKIQymAsoiiQyyWvKdDxFuDUKEz9cB4v_zyiMA6kAOcV4mk8E-DA0H2cib5wPSGNGlDwROxOZ-kxoZw-uzK5XCQvQGEQun7kkKqxPLk3jx1yyWD0RiGYx-_bb3Z9TMjEjSbZ_dL1IwpR7D4JcNgbPaxMW7NMXqpMvrfMzT5zP5CekMLL7jT14-XRBdfteOrvbjQZiLgXGmyrN8MkFM4HpYDCTPyOLy5Z5YucPk3ST3sbtXk6U6cJg0DGQhrM3r6w__fubxW4vb13Qt-33lHKbVANQoNnb2VfEXamCFbcNFbANINXDfNTIqFRaF270GOGgp0rFOwUoUDasA5F_dBQ8OJt5kXabFYN61N81Ci0oV3oMX3k5_KRn8JHpA1rHxuH-mgWb7NZpM1WNZ3Yx_dRo9CmdqHH9NE8l4_mKXxE2rD2sXmoj1bxNltF2mxXP8VGjTJbmmUe00XrXC5ap3ARacLaxdYxXmB37N8XURj4kSj0VlpbXpjwnsSqFVEwl2NxJ4Nxeszqay_l0ncQT0Tx6le--tLxVz8tCywON8rAjJWi7VJ0S00zjTvjenCjDLx1Z7q0XYpuqWm-Tdc-0mYGrm3DphK21N2ylDBn6qPtMvlQw0g-1DCWD4RG8oHQSD7qZfKhhpF8qGEsHwiN5AOhkXw0lJY21ZI2y-SjVcZwNYwYroYxwxEaMRyhsQmgMzbz_0l15qYujQ4BrcmpjSOas9wUyajKuFp0ph4jiOksN0d0VEdoxHWExmTHcMR2DMd0z81QLd3VNKa7mkZ1R3BMdwTHdM8N0qzudUT33EzR0j03U7R0V9OY7moa1R3BMd0RHNM9N0-1dFfTmO5qGtUdwTHdERzTPTdVs-_aNbXuPDdblLqP3v77GwAA__-QL4_d

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMx98xFKlpBuqRqIhBS62WnHhhWmCxGJqGwkS5b9XwAIBx--ZMQN3CfjMHJ95zyObN5b-N2Eh67XarS99b55MvD-6nb-8b62vT-27h0fv6v6h1-_93b72rn5es9hcsVi-ep3ufavr_f6Pt7z2Wl-_tJ76u6uW3l3v00tfr_d_LwbMZ9N4pB-jHzpl4TfGmc8E85lkPlPMZzU28NksiYc6TeNkdcnbWvAwWrCw6rPxdDbPVh8PfDaME83CN5aNs4lmIetH3ye6q6ORToIq89lIZ9F4st5mlox_RMnydrF8ZT7rzaJpGnqVYLVzZ56F3i1ng3efxfNsv3yaRc-ahfzdN7dwP06z8XSYBbXD_XPr7yXfl95LlL58cv3eg7Dx8DEGbpuDKMxBlsqBuw1CFZrYrzOfxslIJ3p0uNJ4mm2WKvQqqsDr3kftrD5QZnsf9VN9-OX9_hmlLz2ddWaBPAquv5zpcAuIu3ab-Wyi_82ubvn1b8n4-WX9l0H1GjYj14uTTCeBzIX3a-H6TYP0CjPxfy79iZXHuBLPAnWYSpGJmwMT3KLbBtUORCWQ1pADJnaDWj8j5GyCsE_CFHOmSXC3UahCEy7wwktizrUPlFkR5kr4cIM5fgnMgZHbYi4XninmhHmxhEmvZCVQ1oQBJnYz0jgjYSyC4PZJmBLGNAnuNgpVaMJFs0VJwrj2gTIrIkwJH24IIy5BGDByW8LkwjMljDQvljTplaqsX6fsCANM7GakeUbCWATB7ZMwJYxpEtxtFKrQhItmy5KEce0DZVZEmBI-3BBGXoIwYOS2hMmFZ0oYZV4sZdKrWsWaL8DCbkJuzsgXixi4bQ6mdDHNgbsNQhWacNFqVZIurn2gzIroUsKHG7qoS9AFjNyWLrnwyvwQ9Mn6XZ3O4mmqjX7dqa4C06NnvTmKNJ4nQ_2UxMP1Npt_O2vd-oORTrPNt3zzz8N089XK4EcxPxbzj2J1IOZ2Yi5PUQt-kvrmFLVs0GpBJi7pxCW5dY3emRZzcF60WohT1LJ6krpJqxWZeJ0W1yzE4lhcJ8UN-qwbpBjcc5MUK1DsG5oKVYCFHFSsuECrIRhoOSQDkCM00HLEBp5Dy2HwAgSfY4sNHoAa8QHIESCAHBECyUFdeI4wh8Gj6GjEHMlzmOA0ZHgdHDuNGXTrNGd4E2yeI41V2Wk1LDsth2UHclR2Wg7LTlNWAMoKGjVgYoEalR3IUdmBHJUdycHEC5qyAgydoJ_gjuS5sgsaNUKBY6dRg26dJo0ApBE50tiUHahR2YEclR3JQdmBHD7105QVgLKCRg0qO6AsOjeASVR2gElUdiBHE09TVoKpkfQL8pE8V3ZJo0aCBzpJowbcuqRJIwFpZI40NmUHalR2IEdlR3JQdiBHZZc0ZSWgrKRRg97yAWXRuQFMovd8gEn0og_kaOJpykp07PRb85E8X3YaNQo80CkaNce3Pnj_5f8AAAD__3UNLmo=

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9u2jAUh-_3FNa5KppRsJPwJ9Kkdi3TkFjpgItOFRcp8QoSJZkTJGjVd58IRTSk8YlJ67um-LN_-HyHk2eI_y3Ag1G3370ck5VckB_DwS9y17296V_0rsnZVW80Hv3u18jZ65r1bsV680QGw6vukHz_QzY10r297N6MyUW_r15JyVPt8LieAIVlGIhr_1HE4N0BAwocKNhAwQEKLkwoRDKcijgO5XbJcwr0gjV4DQrzZbRKtv-eUJiGUoD3DMk8WQjwYOzfL8RQ-IGQVgMoBCLx54v0mEjOH325OV9vnoDCKPKXsUfq1vbkwSrxyDmDyQuFcJW8bn_Y9X5DZn48y-6Xrp9QiBP_QYDHXuhpMV2jMXlhzMM-q2UoAyFFkN1pvky2R5dc9863_unHs5FIBpHFjmoz3kTCeyMUUFiIv8nZOat9k_OHWfpX4Q0cvp2tU4RRKBMhLeYeX9jXwv2dErdXeCf0det3olyH9TCyePZWikK4mRCsvGmshGkWr1v2p7SERtCm4aC8MKjRpmAmmgIpw74pmqc2BS9fZl6mzHbdcj7FR42gLcNBeWFQoz5yEz4iZdj72DrVR7t8me0yZXbq6cT-eB81grYNB-WFQY36aJvwESnD3sf2qT465cvslCmzW_8UGzVidozG5IUxjbromHARKcLexc5HvMC-s_9QxFG4jEWpt9LG9sJE8CB2pYjDlZyKGxlO02N2j4OUS99BAhEnu0_57qG33H20DVgeblWBGatEu5XojppmGnfG9eBWFfjoznRptxLdUdP8mG68pe0M3DiGbSXsqKvlKGHO1Ee7VfpDDSP9oYax_kBopD8QGumPZpX-UMNIf6hhrD8QGukPhEb6o6W0tK2WtF2lPzpVDFfDiOFqGDMcoRHDERqbADpjM_9LqjM3dWl0CGhNTm0c0ZzlpkhGVcbVojP1GEFMZ7k5oqM6QiOuIzQmO4YjtmM4pntuhmrprqYx3dU0qjuCY7ojOKZ7bpBmdW8iuudmipbuuZmipbuaxnRX06juCI7pjuCY7rl5qqW7msZ0V9Oo7giO6Y7gmO65qZp9126odee52aLUffLy5X8AAAD__57Oj1A=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMx98xFKlbDdUjURDClxsteLCC9MEicXUNhIkyn-vgBCCJ36Pxwy5C8Fn5vjMex7ZPLP0vxkL2aDT7Xwdestk5v3R7_3lfe98u-9-ub3zLm5uB8PB391L7-L1mtXuitX6yev1bzp97_d_vPWl1_n2tXM_pK_yvafLw8fViPlsHk_0XfRTpyz8zjjzmWA-k8xnivmswUY-WyTxWKdpnGwued4KbicrFtZ9Np0vltnm3yOfjeNEs_CZZdNsplnIhtGPme7raKKToM58NtFZNJ1tt1kk059Rsr5erZ-YzwaLaJ6GXi3Y7NxbZqF3zdnoxWfxMjssn2bRg2Yhf_HLW7iZptl0Ps6CxvH-xvoHyY-19xiljx9cf_AgbDy8j4G7y0FWyoG7DUIVmjiss5zHyUQnenK80nSe7ZYq9CrqwOvBR-OsPlBmBx_NU3341f3-GaWPA531FoHMBTdcL3S4x8OXbpf5bKb_zS6u-eVvyfThcftXiZFr2YzcIE4ynQTSCO_XwvXbJdIrzMR_XfoDK3dxLV4E6jiVIhNXRya4RbdLVDsQtUBaQw6YeBvU5hkhZxOEyyRkpSS42yhUoQkXeOEVMefaB8qsCHMVfLjBHP8MzIGR22POCK8s5kT5YokyvZK1QFkTBph4m5HWGQljEQR3mYSslAR3G4UqNOGi2aIiYVz7QJkVEaaCDzeEEZ9BGDBye8IY4ZUljCxfLFmmV6q2fZ2yIwww8TYj7TMSxiII7jIJWSkJ7jYKVWjCRbNlRcK49oEyKyJMBR9uCCM_gzBg5PaEMcIrSxhVvliqTK8aNWu-AAtvE3J1Rr5YxMDd5SAr5cDdBqEKTbhotapIF9c-UGZFdKngww1d1GfQBYzcni5GeFV-CPpg_b5OF_E81aV-3alvAtOTB707ijReJmN9n8Tj7Ta7j72tbvuPiU6z3bd89-F2vvtqY_C9mOfF_L1YHYm5nZjLU9SCn6S-OkUtW7RakIlLOnFJbt2gd6bFHJwXrRbiFLWsn6Ru02pFJt6kxQ0LsciLm6S4RZ91ixSDe26TYgWKfUVToQ6wYEDFigu0GoKBlkMyADlCAy1HbOAGWo6DFyB4gy02eABqxAcgR4AAckQIJAd14QZhjoNH0dGIyckNTHAaMrwJjp3GDLp1mjO8DTY3SGNVdloNy07LYdmBHJWdlsOy05QVgLKCRg2YWKBGZQdyVHYgR2VHcjDxgqasAEMn6Ce4nNwou6BRIxQ4dho16NZp0ghAGmGQxqbsQI3KDuSo7EgOyg7k8KmfpqwAlBU0alDZAWXRuQFMorIDTKKyAzmaeJqyEkyNpF-Qc3Kj7JJGjQQPdJJGDbh1SZNGAtJIgzQ2ZQdqVHYgR2VHclB2IEdllzRlJaCspFGD3vIBZdG5AUyi93yASfSiD-Ro4mnKSnTs9FtzTm6WnUaNAg90ikZN_tZHL7_8HwAA___Vei3d

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lkFv2jAYhu_7FdZ3aiWjYCfQEmkSXcs0JFY64NCpyiElXkGiSWYHqbTiv0-Eai3Q-Ivn4VspfuzX_h6J9wXU7wWEMO4NepcTspQL8nU0_E7uerc3g4v-NTm56o8n4x-DU3Lyuma1XfG0eibD0VVvRL78JM-npHd72buZkIvBAFkZAYU0S8R1_CgUhHfAgAIHCj5QCIBCCyIKucymQqlMbpa8lEA_eYKwSWGe5sti8--IwjSTAsIXKObFQkAIk_h-IUYiToT0mkAhEUU8X5TH5HL-GMtV92n1DBTGeZyqkDS8zcnDZRGSLodoTSFbFq_bv-16vyKzWM129-syiNYRBVXEDwJCtqb_FrPlNCavjPm2zzLNZCKkSHZ3mqfF5uia6z649bdYzcaiGOYe25vNZJWL8J1CQGEhfhUnXXb6Wc4fZuVff1-A7b3A2-1829t9kPo6a2S5x3bHVBUg2AnA6lvAaljg8YbnH0VXg6Btx0F5ZVCnwjIXwvL6Y-B1xuA3vOAovhgEPXMclFcGdeoLd-GLX38Mfp0xBI3y1-j_-2IQ9NxxUF4Z1KkvvgtfgvpjCOqModU4ii0GMTtOY_LKmE5dCVyXpw_ijITKs1SJWq2oubmQSB7E9qlUtpRTcSOzaXnM9uOw5Mpf-ESoYvst337op9uvNgHrw20buGMDM6vcrKWnmcGTcTO4bQN3bGBmlXvvyQ5ovk8339O-_r19Lcx236y5Twc2guthRHA9jAiuhzHBERoRvGUjuB5GBNfDiOB6GBMcoRHB2zaCn9koqocRRfUwoqgexhRFaETRcxtF9TCiqB5GFNXDmKIIjSjasVGUWfUEhEYkRWjEUoTGNMVwrCvYlQW7tmBXFyz7gl1hYFaNgR1UBiNb9TRmq57GbNXTqK0IjtlqUpYOZ2bSlkxpzFajvmSMY7YelAetrdH6058AAAD__ywlht4=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mFFv4kYUhd_7K6z7lEhGMDOGEEuVst1QNRINKfCw1YoHL0wTS6zt2kYKifLfK6ALwV7f4zFD3hLwZx8f33M8wytl_y7Jp8lgOPg8dVbp0vl9PPrT-Tr48jD8dHfvXNzeTaaTv4aXzsX_x6x3RzyvX5zR-HYwdn7723m5dAZfPg8epuCoGbkUxQt9H3zXGflfSZBLklxS5JJHLnVp5lKSxnOdZXG6OeR1C9wtnsnvuBRGySrffDxzaR6nmvxXysN8qcmnafBtqcc6WOi03SGXFjoPwuX2Mkkafg_S9c3z-oVcmiRBlPlOq7258miV-86NpNmbS_EqP5w-y4NHTb54c-tLuA2zPIzmebt7fP0bUTj_Afm2dp6C7Oknxx80SBMN720Q9nxQjXwQdo3wKkUczrOK4nShU704PlMY5btTVWqVHaD1oKN7Vh3Is4OO3qk63OZ6_wiyp4nOR0lbFYybrhPt_yiET8MhubTU_-QXN-Ly1zR8fNr-tR-56ru7OoPL93ErTtrq2OIqAf0jAcIgdzVi15attjIuICBiP0S9MxaQiRE2nVCNnBB2rfAqRdiIvmhYQbZ1IM-qKqiBDjsVJD6igmT9wZd15l612p5xAwAR-2d4dcYGMDBC2HRCNXJC2LXCqxRhI3myYQPY1oE8q2qABjrsNID8iAZQ9Qdf1Zl7r7XdKpg1ABCxf4b9MzaAgRHCphOqkRPCrhVepQgbyVMNG8C2DuRZVQM00GGnAdRHNIBXf_C9OnPfbRnnH0jYP8HrM-bfwAZhzwfVyAdh1wivUoSN1HkN029bB_KsKv0NdNhJv_fRP0L8RM5YZ0kcZbrWrwudzQ3pxaPeWZXFq3SuH9J4vr3M7t_Rltt-sNBZvvtW7P65i3ZfbQS-h0URFu9h7wgWZrCQJ9HXp9CydwqtFE9L1nHFO67YS3f5K_OwALp5WnZOoq9OoRWYNI91HDzsrgEsi3CPhcFNX_GD0uMnpc_S1zx8fUqweRgFG9Ag2DyNgs3TKNgCdCkqU75WQLYBjcINcJRuhINJBzjKt-ArVSC81C4cXsq44OsF3TrfLwKkXJQaxugVzNPwHQxw9BLmcfgW5nGYVr5eRR8YX-pXo7TyNEwrj8O0AhyNLI_DtJZa9sh4KcDyiW_ZAl5KqyxVjUlaJd80EqzeJL-OAcYBGqUV4SCtAEdpBThcNPMlK7vA-FLLmqQV0CitAEdpRTgaWR5HaZX8Elb2Ac63bAEvp5VfxaJb55tGdcBeq9Q0JmkFNEorwkFaAY7SCnCUVsWXrJLA-FLLGu1yeRpuc3kc7nMBjja6PI7SqvilrELW8S1bwEtpVfxatnjrs7df_gsAAP__YzUm3Q==

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll9r4kwUxu_fTxHOlcJInEm0NfBCS9dlBbd2qxeF4kVqZmvAJtmZEbSl330xabH-yZzMDprLmPklT875gc8byD8LCGDcH_ZvJs5SLJzv96OfzmP_4W54Pbh1Gt8G48n417DpfBxZFQcajc9r4qyLn1br16bTf7jp302c6-HQOX6iOQUCSRrx2_CFSwgegQIBBgQ8IOADgQ5MCWQinXEpU7E58pYDg2gFQZtAnGRLtfl5SmCWCg7BG6hYLTgEMAmfFvyehxEXbhsIRFyF8SJ_TSbil1Csr1brVyAwzsJEBk7L3bx5tFSBc0XJFYPpO4F0qT7esH3w09qZh3K--8hPZEpAqvCZQ0Dfyb-F7dQQlpWG3T5qmaQi4oJHuw-LE0XiRG0SGJw9MoMfoZyPuRplLt3b12Sd8eCLT0BgwX-rRv4dzf9F_Dz_vNhOZW8k22_1rL71ePbbtJVmLt1dXVkAfycArW4GrWCGy1qud0KRDeJ2a4nLSuPWojI9n8qs-mpYldV4Ldc_oUkGcS9qictK49ZiEjufSV711XhVVuO38n-1U5lkEPeylrisNG4tJnnnM8mvvhq_ymo6rRN6ZBC2V0NYVhq2Fov8ekrakVD3XGZpInml9tXefBaPnnkxOJkuxYzfiXSWv6a4HOVc3h4iLlVxlxUXg6S4tQlYHe7awD0bmFrlph09TQ1Gxszgrg3cs4GpVe69kR3QbJ9uf6U9_bw9LUx3Z9bep30bwfUwIrgeRgTXw5jgCI0I3rERXA8jguthRHA9jAmO0IjgXRvBL2wU1cOIonoYUVQPY4oiNKLopY2iehhRVA8jiuphTFGERhTt2ShKrXoCQiOSIjRiKUJjmmI41hXsyoJdW7CrC5Z9wa4wUKvGQA8qg5GtehqzVU9jtupp1FYEx2w1KUuHOzNpS6Y0ZqtRXzLGMVsPyoPW1un7f38DAAD___3up8E=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmEFv4jgcxe_7KaL_qZWMwHagNNJKHc2w2kps2y0cRhpxyIC3jcQkbBKkMlW_-wqyLYWQ_0ucpHMM8IufX_xebJ4p-XdJHk1G49HnqbOOl84f97d_Od9GX-_Gn65vnLMv15Pp5O_xufP_T56yH5ydvV4LZ5N99LT5ee6Mvn4e3U2d09-ez0hQGC3Mjf_DJOR9I0mCFAnSJMglQX2aCVrF0dwkSRRvf_K8A64XT-T1BAXhap1uP54JmkexIe-Z0iBdGvJo6n9fmnvjL0zc7ZGghUn9YLkbZhUHP_x4c_W0-UmCJis_TDyn092OfLtOPedKiitFsxdB0Trdj5Ck_oMhT76I8iq-BEkahPO02z-UcGqIPfV94zz6yeNpZK9EVVHy3g_ZqCHayhDZhiNuoZT9rdZhFC9MbBaHNwvCVARhmt2uULXqYdV7Of3W5ZQwcS9n0IQcUU_6n37yODHp7aqrj6ycblbGe22MT-MxCVqaf9Kz3ZzOf4-Dh8fXi_26LJzrRa25ntZ-E3WiVVcfel4kYHggQFYIZ4lsdlWnq23qCuh4W1iD1uuqiiMNW6KtLJFteOIWSmmqIaR9YbUhp4SJRYVlKae5wpIfV1iqfDpUmXDoTte16Qug4-25XrTeFxUckQ1boq0skW144hZKaSqgyr4v2pBTwsSivrCU01xfqI_rC10-HbpMONzO7sRSuS-AjrfnOmy9Lyo4Ihu2RFtZItvwxC2U0lRAtX1ftCGnhIlFfWEpp7m-0B_XF275dLhlwtHv2LQFUPH2VC9bb4sKfshGDdFWhsg2HHELpTQVTte-K9qQU8LEoq6wlNNcV7i_5s-TE6LuTbKKwsSU-lekt52WWTyYzLgkWsdzcxdH890w2eXtjtt9sDBJmn0rs4vrMPtqK_A9LI9h-R52D2BZDZaqFn1Zh1aDOrTWPK1YxzXvuGaH7vMj87AEunla9WrRF3VoDVaayzoOHna_AqyO4QELg0lf8AtlwK-UIUtf8vBlnWDzMAo2oEGweRoFm6dRsCXoUlSmfK2AbAMahRvgKN0IBysd4Cjfkq9UifBcu3B4LuOSrxc0db5fJEi5zDVMpVcwT8N3MMDRS5jH4VuYx2Fa-XqVQ2B8rl8rpZWnYVp5HKYV4GjJ8jhMa65lD4xXEmyf-JY9wnNpVbmqqZJWxTeNArs3xe9jgHGARmlFOEgrwFFaAQ43zXzJqj4wPteyVdIKaJRWgKO0IhwtWR5HaVX8FlYNAc637BGeTyu_i0VT55tG98BZK9c0VdIKaJRWhIO0AhylFeAorZovWa2A8bmWrXTK5Wl4zOVxeM4FODro8jhKq-a3shpZx7fsEZ5Lq-b3ssdTn7389l8AAAD__2heYr4=
