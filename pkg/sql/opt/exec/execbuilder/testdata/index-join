exec-raw
CREATE TABLE x (
  a INT PRIMARY KEY,
  b INT,
  c INT,
  INDEX(b),
  INDEX(c)
)
----

exec-raw
INSERT INTO x VALUES (1, 3, 10), (2, 2, 30), (3, 1, 20)
----

exec hide-colnames
EXPLAIN (VERBOSE) SELECT c FROM x ORDER BY b
----
render           ·         ·          (c)     ·
 │               render 0  c          ·       ·
 └── index-join  ·         ·          (b, c)  +c
      ├── scan   ·         ·          (a, b)  +b
      │          table     x@x_b_idx  ·       ·
      │          spans     ALL        ·       ·
      └── scan   ·         ·          (b, c)  ·
·                table     x@primary  ·       ·

exec hide-colnames
SELECT c FROM x ORDER BY b
----
20
30
10

# tests adapted from logictest -- select_non_covering_index

exec-raw
CREATE TABLE t (
  a INT PRIMARY KEY,
  b INT,
  c INT,
  d INT,
  INDEX b (b),
  UNIQUE INDEX c (c),
  FAMILY (a),
  FAMILY (b),
  FAMILY (c),
  FAMILY (d)
)
----

exec-raw
INSERT INTO t VALUES (1, 2, 3, 4), (5, 6, 7, 8)
----

# TODO(justin): this is limited by our ability to push filters into index joins
# at the moment.
exec hide-colnames
EXPLAIN (VERBOSE) SELECT * FROM t WHERE b = 2
----
filter     ·       ·          (a, b, c, d)  ·
 │         filter  b = 2      ·             ·
 └── scan  ·       ·          (a, b, c, d)  ·
·          table   t@primary  ·             ·
·          spans   ALL        ·             ·
