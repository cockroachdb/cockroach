# LogicTest: 5node-dist

# First, we set up two data tables:
#   - NumToSquare maps integers from 1 to 100 to their squares
#   - NumToStr maps integers from 1 to 100*100 to strings; this table is
#     split and distributed to all nodes.
statement ok
CREATE TABLE NumToSquare (x INT PRIMARY KEY, xsquared INT)

statement ok
INSERT INTO NumToSquare SELECT i, i*i FROM generate_series(1, 100) AS g(i)

statement ok
CREATE TABLE NumToStr (y INT PRIMARY KEY, str STRING)

# Split into five parts.
statement ok
ALTER TABLE NumToStr SPLIT AT SELECT (i * 100 * 100 / 5)::int FROM generate_series(1, 4) AS g(i)

# Relocate the five parts to the five nodes.
statement ok
ALTER TABLE NumToStr EXPERIMENTAL_RELOCATE
  SELECT ARRAY[i+1], (i * 100 * 100 / 5)::int FROM generate_series(0, 4) AS g(i)

# Verify data placement.
query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW RANGES FROM TABLE NumToSquare]
----
start_key  end_key  replicas  lease_holder
NULL       NULL     {1}       1

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW RANGES FROM TABLE NumToStr]
----
start_key  end_key  replicas  lease_holder
NULL       /2000    {1}       1
/2000      /4000    {2}       2
/4000      /6000    {3}       3
/6000      /8000    {4}       4
/8000      NULL     {5}       5

#
# -- Basic tests --
#

# Query with a restricted span.

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT 5, 2+y, * FROM NumToStr WHERE y <= 10 ORDER BY str]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkFFLwzAUhd_9FZfri7pIm-pAAkLVVSzMbbYFldmH2l5GoUtqkoJj9L_LWsVNmOjjOfeck4-s0bxVKDAOxsFNAo2u4Daa3sM8eJqNr8IJHI3COIkfxsfwGRky8GAAKwYnfVQ2S6uM1fB4F0QBrOClcd2z_BK4C9NoFERw_QzG6hQZSlXQJFuSQTFHjinDWqucjFF6Y627QFi8o3AZlrJu7MZOGeZKE4o12tJWhAKT7LWiiLKCtOMiw4JsVlbdbK3LZaZX_hcXMozrTBoBpw53nUNkGJEsSAsYCiHCSXLBwOcDb0sw8D1MW4aqsd8QxmYLQsFb9nfQWGlL2uG7jP75YO-895_5iEytpKGd-X3LbpsypGJB_V8b1eicZlrl3TO9nHa9zijI2P7KexHK_rQB3C7zX8vej3LaHnwEAAD___w4xj8=

# Query which requires a full table scan.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT 5, 2 + y, * FROM NumToStr WHERE y % 1000 = 0 ORDER BY str]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElG-L2kAQxt_3UwwDhbu6YjZGz1so2PZyVLB6jUJbDl-kZpBAzKa7K1TE717y57jzOJNFC74Q3M0888z8Zpkd6j8JCpz5Y__LHDYqgftg-g0e_Z8P40-jCVzdjWbz2ffxNVQhPQYutGDL4EMZmm7WRmqj4MdXP_DhagvvgTuOcw0fwYFpcOcH8PkXaKMWyDCVEU3CNWkUj8iRoYsMu8jQQ4Y9XDDMlFyS1lLlIbtCMIr-onAYxmm2Mfn1guFSKkKxQxObhFDgPPydUEBhRKrjIMOITBgnhU2m4nWotsOnSpHhLAtTLaDdcR0nj76PE0NKwNWQV-ULIUaT-aDoovqPDANKozyuV10xGPKW--LAYOjiYs9QbsxzsdqEK0LB98y-oZlUhlSnd9jL0GsdTe8eTf-cVaqIFEWHSePUsKefNipOV8gqpzcKm8i2zDr8EPKxmroHNXH7GXLbGRYjbHe8yw2yoatqkP1TB-naQ3OtoXkFtP7loDV0VUG7ORVa1x5a1xpav4A2uBy0hq4qaINToXn20DxraDmu9oV4NTRU8br9Hyv2jfQB6UymmqwWpZOvWopWVO5rLTdqSQ9KLgub8jgtdMVFRNqUX3l5GKXlp7zAl2JeK3YPxPy12K13brDu1qq9erF3Tt29WnG_3rl_jvNNrXhQ7zw4x_m2flZOwzOpf2SvvRf7d_8CAAD__7fVLhU=

# Query with a restricted span + filter.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT str FROM NumToStr WHERE y < 10 AND str LIKE '%e%' ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyMkE1L60AUhvf3VxzOpbSFuTS5rpxVq001GJM6CajULMbkUAJpJs4HWEr-uyRR1IXg8v2Ydx7OCc1LjRzTIAouM3C6ho1IbmEXPGyjVRjDbB2mWXoXzeG9YqweK407WNWr--tABDA7wpPzvLMCfG8Oq3gNsz6MwpsAphOaTOeQiHUg4OIRjjkybFRJsTyQQb5DH3OGrVYFGaN0b52GQli-IvcYVk3rbG_nDAulCfkJbWVrQo6ZfK5JkCxJLzxkWJKVVT3Mtro6SH1cfrAiw7SVjeHwb3G--IsMN1VtSXNY_v-CyjlPMxHGV8gwcbZPMe8YKmc_MYyVe0Lud-z3qIJMqxpD3yh_Wva6nCGVexrPYZTTBW21KoZvRpkM7wajJGPH1B9F2IxRl3d_3gIAAP__QCCYHg==

# Query which requires a full table scan.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT str FROM NumToStr WHERE y % 1000 = 0 AND str LIKE '%i%' ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlFGLm0AQgN_7K5aBcEo3ZDUmHAsFr43XSlNzVaEthw82DkEwrt1doSHkvxfXa-9SLsWSh9ybszMfM9_AuAf1owIOSbAM3qWklRW5jVefyH3w9W55E0bEWoRJmnxe2uShRGnZl9TtVosu-vIhiANiWTsyIg5jzCZvCLPJTbQgVpdfhh8DcjUqR1c2WcWLICZvv5FdBhRqUWCUb1EBvwcHKLhAYQoUPKAwg4xCI8UalRKyK9kbICx-AmcUyrppdfecUVgLicD3oEtdIXBI8-8VxpgXKCcMKBSo87IybRpZbnO583-PDxSSJq8VJ-OJy1hXfVtWGiUnluU7D06c8zBKr43an29j6LtPBDnnSRqH0XsbKKxazYnvUt-B7EBBtPpxYKXzDQJ3DvSE1KOLkAVKLI4tlJZlvaFlrYGC776G7PDMGiIxFs1kdoSeGsU9GsUZvl9n6H7NescT77JLdoebuYPNPGM2v6zZdLjZdLDZ3JhdX9bMG27mDTbrnMYv5NqfkYpRNaJWOOh4WXf9WGyw_3Uo0co13kmxNm36cGU481Cg0n3W6YOwNikz4FPY-Sc8P4LZ37B7TufpObB3Djz7Lzg7vPoVAAD__8JhMbI=

#
# -- Join tests --
#

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, str FROM NumToSquare JOIN NumToStr ON y = xsquared]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlVGL4jwUhu-_XxHO1QxksGmrjoWBfuzOsg6zOjt6sTD0omOzWqhNJ0lBEf_70lbQ6k7SbhS8bJsnOXneQ88GxEcCHkwenx-_TFHOE_TtdfwDvT3-enn-fzhCN1-Hk-nk5_Mt2i1ZYSQkr1al-VIy8ZGHnKKn8XC0eyE5Go_QGj2gVfUxCgBDyiI6CpdUgPcGBDDYgMEBDC5g6EKAIeNsRoVgvFiyKYFhtALPwhCnWS6L1wGGGeMUvA3IWCYUPJiG7wl9pWFEeccCDBGVYZyUx2Q8XoZ87R8UChgmWZgKD91BsMXAcrnber_j-xotQrGo7-XbEGwDDEKGcwoe2eJ_K5GoSpT8oL6ObVlWyyJJrUj70yL3--Qp4xHlNKrvFKcSx6ksjm-0Vkgep_Pq9OPrfw_F4onFKeWdXp1M6G9549u3DzyeL-SNT24BwziXHvIJ9t2jy-8v5phdTFXsiN2xrEPqMX1Wh1urgzTvArtpF5RNcNdxz9sK5ApaoX-JVrCbR-A0jsAtI-idNwL7CiK4v0QETvMI3MYR9MoI7s8bgXMFEQwuEYHbPIJu4wgK-W1npsq-ewX2iXXpefSX81-pyFgqaKMJYxU3oNGcVpoEy_mMvnA2K4-pHsclV_7VIypk9dWuHoZp9akosDncNYH7JvDABCZETZMWxux2cNcE7pvAAxP4yNgJbR_T1iHtqHU7SpjUfVvHtGsSlhrWhKWGNWGpYU1YalgXVtckrJ6JbjWs0a2GNbrVsEa3Gtbp7pvovjfRrYY1utWwRrca1uhWwzrdAxPdpM2wPP2HtpmWbWndz7_NvGxL65yTk-mhlB5s__sTAAD__wODErY=

query TTTTT
EXPLAIN (VERBOSE) SELECT x, str FROM NumToSquare JOIN NumToStr ON x = y WHERE x % 2 = 0
----
·                distributed         true                 ·            ·
·                vectorized          false                ·            ·
render           ·                   ·                    (x, str)     ·
 │               render 0            x                    ·            ·
 │               render 1            str                  ·            ·
 └── merge-join  ·                   ·                    (x, y, str)  ·
      │          type                inner                ·            ·
      │          equality            (x) = (y)            ·            ·
      │          left cols are key   ·                    ·            ·
      │          right cols are key  ·                    ·            ·
      │          mergeJoinOrder      +"(x=y)"             ·            ·
      ├── scan   ·                   ·                    (x)          +x
      │          table               numtosquare@primary  ·            ·
      │          spans               ALL                  ·            ·
      │          filter              (x % 2) = 0          ·            ·
      └── scan   ·                   ·                    (y, str)     +y
·                table               numtostr@primary     ·            ·
·                spans               ALL                  ·            ·
·                filter              (y % 2) = 0          ·            ·

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, str FROM NumToSquare JOIN NumToStr ON x = y WHERE x % 2 = 0]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlt9q2zAUh-_3FOLAIKUqsWznn6GQsaUspU26JLBByYUba6nBtVJJhpTSdx-2M1KnrSRPC8ldbOuzzvl9wifPIB4TCGA6uBp8naGMJ-hiMr5Gt4NfN1dfhiPU-DaczqY_rk7QZskaIyF5uSrNHiQTj1nIKbocD0ebG5Kj8Qit0Tl6Qj-_DyYD1Fijz8g9QefImQOGlEV0FD5QAcEtEMDgAgYPMPiAoQVzDCvOFlQIxvMlzwUwjNYQOBjidJXJ_PYcw4JxCsEzyFgmFAKYhXcJndAworzpAIaIyjBOim1WPH4I-VP_Vc2AYboKUxGgM8BwESeS8gA1-iQvNgiC4WjWLWre_AYM40wGqE9g_oKBZXJTybaAuyd0H4r76tbF-jkGIcMlhYC84H_riKg6kvxVO03XcRyznmw6cT_sZPueLGU8opxG1TfFqcy33q77aBUWksfpEjD0yWm5-25G15Qv6SWLU8qb7eoLEvpbNvrk9OScx8v78udWI-57O_1ve_Osevtb9bv1jtgZWzVJVedHdfiVOoj5aXFNT0txWM6a_gGODDmGI9PZz5FxzVV5xqr8QlX7AKrcY1DV3Y8qz1yVb6yqXajqHkCVdwyqevtR5ZurahmryiUZ_gX4f5b8Y7BEnP3Py3dKmFCxYqmgRhPQyZug0ZKWSQmW8QW94WxRbFNejguuGCgRFbJ86pYXw7R8lBdoDrds4I4N3LOBCVHTpEZibj24ZQN3bOCeDbyT2Bva3aWd17SnjttTwqSat7NL-zay1LBGlhrWyFLDGllqWCerZSOrbRO3GtbErYY1cathTdxqWBd3xyburk3calgTtxrWxK2GNXGrYV3cPZu4SZ1h-fYbWmda1qV1H_8687IurcucvJkeytDnL5_-BAAA__9DSkhF

#
# -- Aggregation tests --
#

# Sum the numbers in the NumToStr table.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(y) FROM NumToStr]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslFGLm0wUhu-_XyHnKoEJcdS4Wa-yfE0hkN1sYwqFxQvrHERQx86M0CXkvxe1ZXVpxtnYS_W887wPR-YM8kcOAYTb_fb_k1WL3Pp8PDxaL9tvz_uH3ZM1-7QLT-GX_dz6PSLrYvY676bKulBcKhEBgZIzfIoLlBC8AAUCDhBwgYAHBFYQEagET1BKLpqRcxvYsZ8Q2ASysqpV8zoikHCBEJxBZSpHCOAUf8_xiDFDsbSBAEMVZ3mLqURWxOJ186cHEAiruJSBtVg6tt1MH2oVWBsK0YUAr9UbRqo4RQjohZhXeUhTgWmsuFiuhk3Cr4-zDZ1fxThXMW-n1yUXDAWy4dEMk6yIc4gu-kbU_lgld1CJmi-Bmi6h3cFi6d2yiZE-PW9_yiYcc23HWNtrtf1btEf69LTvpmi75tqusbbfaq9v0R7p09NeT9H2zLU9Y-1GePFh45EqPeP7f3XT_AVzRFnxUuIAce1ku7mAkKXYXVuS1yLBZ8GTFtM9Htpc-4KhVN1X2j3syu5TU7AfptqwMwjT92FHTx5Bu9q0pw97U3qvtGFfT_ankO-04bWevJ5Cvtfvyh75TfQ_2Xt2dPnvVwAAAP___67gJg==

# Count the rows in the NumToStr table.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT count(*) FROM NumToStr]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslF2Lm0AUhu_7K-RcZcuE-BU369Uu2xSErG6jSwuLLFYPIpgZOzNCS8h_L2rLamhGib1Uz-vzPh6ZI4gfJbgQbnfbx0ireal93gdP2uv22_PuwfO1xScvjMIvuxvtz0jKaioXH2-6OVofJBOSx0CAsgz95IAC3FcwgIAJBCwgYAOBNcQEKs5SFILxZuTYBrzsJ7g6gYJWtWxuxwRSxhHcI8hClgguRMn3EveYZMhXOhDIUCZF2WIqXhwS_uv-bw8gEFYJFa62XJm63kwHtXQ1n1GE-ESA1fIdJGSSI7jGiUwv85DnHPNEMr5aD7s8Bi9-9LYPvoaLm4ss8yLrHVFTxjPkmA3fX1AJ8UldyTj7PuHL05vnR4t743Ila1DJmL4LY-ou2lUsV_Z1Cxlp1LN3Zi_EnG5vTra3W3vnOvuRRj3729n21nR7a7K909pvrrMfadSz38y2t6fb25PtG-_lFeIjZXrid__1FPoHa4-iYlTggHPpzXpzQGGWY3ekCVbzFJ85S1tMdxm0ufZGhkJ2T43uwqPdo6ZgP2wow-YgbJyHTTV5BG0p07Y6bM_pvVaGHTXZmUO-VYY3avJmDvlOvSt95DdR_2Tn7Pj04XcAAAD__4To7w0=

# Count how many numbers contain the digit 5.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT count(*) FROM NumToStr WHERE str LIKE '%five%']
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF-Lm0wUxu_fTzEcWDb7MiFqTDY7V1m2bivNmq26bGGRxcbTIBgnnRlLS8h3L2rLxtCMgs2df87j8-N3ZHYgv2XAIHAWzl1ICpGRe3_5QF6cz4-LW9cjg3duEAafFlfk98iKF7ka_H9Vz-XFRnGpBHn-4PgOKa8W7keHXF58Tb_jxWUEFHKeoBdvUAJ7ARMoWEBhDBRsoDCBiMJW8BVKyUU5sqsCbvIDmEEhzbeFKh9HFFZcILAdqFRlCAzC-EuGPsYJipEBFBJUcZpVNVuRbmLxc_6HDygE2ziXjAxHlmGU0_dpplAwMreayIyxIPRd7z1QWBaKEY_nCNGeAi_UG4xU8RqBmXvaHfh2vRa4jhUXo0mT92755IWv_vI5GFyd7LJOdr1VFDkXCQpMmt9PcwXRXo9kHjkMnh5eXS8czM3TSOMGktl9X2bXfVXrGo7s8y2thfrA0LT30qzuhqzOhuzK0PR8hlqoDwxd9zY07m5o3NnQtDI0O5-hFuoDQ7PehuzuhuzOhko3wzPJaQE-kHPzT0_Fv3T5KLc8l9joOfVlozwwMVljfcRKXogVPgq-qmrq22WVqx4kKFX91qxv3Lx-VQIehk1t2GqEzeOwpW9uqR5r07Y-bPfhnmjDU33ztE_ztTY80zfP-jTf6HdltPwm-p_suDva__crAAD__3TsJt0=

#
# -- Limit tests --
#

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT y FROM NumToStr LIMIT 5]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyMT0tLMzEU3X-_IpzVJ0TsLLrJqqIVAtOHnVkIJYs4uZTATDLmAZYy_106UcSF4PI87jnnXhDfegg063r90LIcevZ02G3Ycf2yr-_llv1_lE3bPNc37NNyLgaXh-RjCqyWG9mypQKH84a2eqAIcUQFxTEG31GMPlypy2yQ5h1iwWHdmNOVVhydDwRxQbKpJwi0-rWnA2lD4W4BDkNJ236OHYMddDivvvrB0YzaRcFuwbHLSbBVBY7aDjaxJdTE4XP67opJnwiimvjf9xwojt5F-jHlt-TFpDjInKj8HH0OHe2D7-aaAnfz3UwYiqmoVQHSFWlS07-PAAAA__9944W2

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT y FROM NumToStr ORDER BY y LIMIT 5]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyMT01Lw0AUvPsrHnNSWLE59LKnqo0QSJua5KCUHNbkUQJJNu4HWEL-uzSriAfB43y8mXkT7HsHiSJO48eSvOnoKc92dIxfDul9sqfrbVKUxXN6Q1-WczAMvnfaOkNZvo1zenilM6XJLilpXUFg0A3vVc8W8ogIlcBodM3WanOhpsWQNB-QK4F2GL270JVArQ1DTnCt6xgSpXrrOGfVsLlbQaBhp9puiR1N2ytz3nxPgUAxqsFKuoVA5p2kTQSBtO1bR2tUs4D27qfLOnViyGgW_9-Tsx31YPnXlL-SV3MlwM2Jw89We1Pzweh6qQkwW-4WomHrghoFkAxBmqv56jMAAP__ahCIpg==

# Test that the correct node is chosen in a reverse scan with multiple spans.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT y FROM NumToStr WHERE y < 1000 OR y > 9000 ORDER BY y DESC LIMIT 5]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyMUM0Ok0AQvvsUk_HSJtuw1PTAnqotRhJaKpCoqRxWmFQSYHF3SSQN726Aqq2J1eN8f_PNXNF8q1Bg4of-LoVOV_A2jg5w9j-ewtfBERb7IEmT9-ESbpJ-FjRdbZWxGj6882MfFj187jh_lYPLOV9CFP-CCLwbtPdjePMJetj7yQ7C4BCksMmQYaMKOsqaDIozushwgxnDVqucjFF6hK-TKCi-o-AMy6bt7AhnDHOlCcUVbWkrQoFHtVKtM6YUZGVZTbKBoersb5Ox8kIo1gO7C3afB6fyS0UxyYK0wx_isdVlLXW__fkVZJi0sjECVo7nec5LkE0BLij7lUYy6qyA7dgxLOvSwgb_1tB9aPiP02MyrWoM_dftfMgYUnGh-b1GdTqnk1b5tGYeo8k3AQUZO7PreQiamRoL3pvdp2b-hzkbXvwIAAD__-tKysw=

query TTTTT
EXPLAIN (VERBOSE) SELECT x FROM (SELECT x, 2*x, x+1 FROM NumToSquare)
----
·     distributed  true                 ·    ·
·     vectorized   true                 ·    ·
scan  ·            ·                    (x)  ·
·     table        numtosquare@primary  ·    ·
·     spans        ALL                  ·    ·

# Verifies that unused renders don't cause us to do rendering instead of a
# simple projection.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM (SELECT x, 2*x, x+1 FROM NumToSquare)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyMT01L80AYvL-_YplT-7pi43FPFa0QqG1tchDKHtbsQwkku-l-QCTkv0uyinoQPC3zsTPzDPCXBgLFZru5L1l0DXs87p_YafNy2N7lO7Z4yIuyeN4u2YelT4bFJ-Tslv2fnp5dsSyJJrbB-ktUjpYSHMZq2qmWPMQJGSRH52xF3ls3UcNsyHUPseKoTRfDREuOyjqCGBDq0BAESvXa0JGUJnezAoemoOpmju1c3Sr3tv7WDY6iU8YLdg2OfQyCrTPIkcPG8FXigzoTRDbyvw85ku-s8fRjw2_Jq1FykD5TOtbb6Co6OFvNNQnu538zocmHpGYJ5CZJoxz_vQcAAP__tUyKSg==

query TTTTT
EXPLAIN (VERBOSE) SELECT y, str, repeat('test', y) AS res FROM NumToStr ORDER BY res
----
·                    distributed  true               ·              ·
·                    vectorized   false              ·              ·
render               ·            ·                  (y, str, res)  ·
 │                   render 0     y                  ·              ·
 │                   render 1     str                ·              ·
 │                   render 2     res                ·              ·
 └── sort            ·            ·                  (res, y, str)  +res
      │              order        +res               ·              ·
      └── render     ·            ·                  (res, y, str)  ·
           │         render 0     repeat('test', y)  ·              ·
           │         render 1     y                  ·              ·
           │         render 2     str                ·              ·
           └── scan  ·            ·                  (y, str)       ·
·                    table        numtostr@primary   ·              ·
·                    spans        ALL                ·              ·

query TTTTT
EXPLAIN (VERBOSE) SELECT y, str, repeat('test', y) AS res FROM NumToStr ORDER BY res LIMIT 10
----
·                         distributed  true               ·              ·
·                         vectorized   true               ·              ·
render                    ·            ·                  (y, str, res)  ·
 │                        render 0     y                  ·              ·
 │                        render 1     str                ·              ·
 │                        render 2     res                ·              ·
 └── limit                ·            ·                  (res, y, str)  +res
      │                   count        10                 ·              ·
      └── sort            ·            ·                  (res, y, str)  +res
           │              order        +res               ·              ·
           └── render     ·            ·                  (res, y, str)  ·
                │         render 0     repeat('test', y)  ·              ·
                │         render 1     y                  ·              ·
                │         render 2     str                ·              ·
                └── scan  ·            ·                  (y, str)       ·
·                         table        numtostr@primary   ·              ·
·                         spans        ALL                ·              ·

# Regression test for #20481.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT count(*) FROM (SELECT 1 AS one FROM NumToSquare WHERE x > 10 ORDER BY xsquared LIMIT 10)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkU1r20AQhu_9FcOc7HaLtfJtT3ETlQoUK5VU0pKKspUGIZB3lf0AF-P_XqQNNC7YxMd9533mGdgD2ucBBZZJltxW4M0An4v8Hp6S7w_ZJt3C4i4tq_JrtoSXSqO9cov3y9BbvKQcNiVoRSFVfue0ffbSEDx-SYoE9vDTR9GagEeQF3dJAZ9-wD5UWsjS-7QCHi1rZKh0S1u5I4viCTnWDEejG7JWmyk6zIW03aOIGPZq9G6Ka4aNNoTigK53A6HASv4eqCDZkllFyLAlJ_thXjuafifNn5tXhyLDcpTKClhx_hHrI0Pt3b_t1smOUPAje_sFpTaOzIqfym_iD8gw907AVqtJnPW73gGPzlrja6ybrjPUSafNKj413-bfttWvIn8sF8uzrvU1roLsqJWlE8-5zdGxZkhtR-EfrfamoQejm1kTnvnMzUFL1oUpD49UhdF04GuYX4Tjy3B8EV7_B9fHd38DAAD__wAHBz4=
