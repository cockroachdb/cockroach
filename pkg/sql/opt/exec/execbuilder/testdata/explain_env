# LogicTest: local !metamorphic
# We must turn off metamorphic variables because some are included in
# EXPLAIN (OPT, ENV) output.

statement ok
CREATE TABLE x (
  a INT PRIMARY KEY,
  b INT,
  INDEX (b),
  FAMILY "primary" (a, b)
)

statement ok
ALTER TABLE x INJECT STATISTICS '[
  {
    "columns": ["a"],
    "created_at": "2018-01-01 1:00:00.00000+00:00",
    "row_count": 123123,
    "distinct_count": 100,
    "histo_buckets": []
  },
  {
    "columns": ["b"],
    "created_at": "2018-01-01 1:00:00.00000+00:00",
    "row_count": 123123,
    "distinct_count": 123123,
    "histo_buckets": []
  }
]'

statement ok
CREATE TABLE y (
  u INT PRIMARY KEY,
  v INT REFERENCES x,
  INDEX (v),
  FAMILY "primary" (u, v)
)

query T
EXPLAIN (OPT, ENV) SELECT * FROM x WHERE b = 3
----
https://cockroachdb.github.io/text/decode.html#eJy0Vt9O47gXvp48xVFvBn5qIaW_C1Q00nZKVtvdUlCbmR2EkOUkJ6kXxza2UwqrleYheEKeZGWnQGdFmh2tphdV457vO_--c5xeDz6jNkyKIYxleqMlTZenHwHXmCYV4xlqsGgsrGqrIOj1gHIu74jSqKhGQg2RyhLFqYAlNWCXCBnmtOIWVpRXOASZ5w6XSmOJSakw5I7ZJdlYkVRyYtgDtsAz6iK55412k8V5F85OL73xhpsJu5P7eNvYaioMTS2TgijNpGb2vgkopC4pb0LfVpQze09kTgzqFUsbA9BYVJzqJiKNNCNS8MY4novzBrYySHLpmoXaE5k2Embq3uYV58TShGPdr124RRQ7oDW3HD64kxOA14CeLWllpXOBwrOyUnGWMksMckwtyaUmlXIdbnQl3oJvp-s4EmrTJTGWWixR2ObAv2ETBrUlOTWWKGqX_wpUVtwy5X7IjOUspS4G4xru69ZS6Q3JAyseaEH-kKx5dmqna-XKREVGWCGkRiKkJStmmKNJJa9KYQgTJJWqTSpMWNQrynfOkpLGFhqNA3CqC6w14dRAtLxrLGw_DEOPkelmApRlJXvAjCiqLXNVwowwkeHas-3OWzinUmeoMSOcGtuSm1O9lxHRuJQlulhJXexstye3w4zirN5QhLOSNTo7Cv9_vMH43PRm1DSm1LSJ7lvQkhkrC03L70J58fm1aen3-duWjW8Cti0FVRCri_LAsJJx6lYisUuNZil5Y0nDg4GHasxREy7lTaW8yo2f0vym1amWihauj0yoytYSYKJogWn0hhtXO3voG2huOTE0x41o2qJy9w8TBXktqb_SFGpb6cRvgMaKvI13G9e1QlccidIyoQnjO26dBhpNRSZLYrBZ5TWSlfggRePUf4rHzqwSqRTGasrcrArp1srK139rcFvHqq7ZClMr9a7bXQTBeB6N4gji0cdpBKpKOEsP1rAXvKMwmcXHMDuPYfZpOu0G75LNSf00Pp8t4vloMothTdQN3sPFfHI2ml_Cb9El7FEYLcb73eDdZHYafYE1SQjL1rCX-PNg_yQIRtM4mv_T82T2azSOYRGP4skinowX8P4qAAD403-7T4euCv9m0RlC2H093uzizhCuXg5r-87L8_W2vUZqMSPUdobQOQr7x72w3wv7EPaHYTgMw86WsbtnmUjdK1MlHKAfbvv2y8S_Ttl75QLrbIP9Ln0GbsPcjnwhPBr0jwb-v7-6_zXl5Iek7CP8cVkH1-9PgiD6cjEdTWawd34RdyGafd6HRTR1ovgf_Dw_P4M1_P5LNI8ggQ8wOAl6vV4v8PfZ-qeNzAJ4enx8evz69PgVXubJDuHw6LA_hKvDAfTgcHAd_B0AAP__4rTYRg==


statement error ENV only supported with \(OPT\) option
EXPLAIN (ENV) SELECT * FROM x WHERE b = 3

#
# Multiple Tables.
#

query T
EXPLAIN (OPT, ENV) SELECT * FROM x, y WHERE b = 3
----
https://cockroachdb.github.io/text/decode.html#eJy0Vt9u27YXvq6e4sA3dX6wGzn5XQQOCsx11c1b6hS22rUoCoKSjmQuFMmSlGpnGFDsGXK5p8uTDKSUxF0te8XQXAQ2_X3n73cOORzCG9SGSTGGqUyvtKTp6vkzwDWmScV4hhosGgt1gwqC4RAo5_ITURoV1UioIVJZojgVsKIG7Aohw5xW3EJNeYVjkHnueKk0lpiUCkM-MbsiLYqkkhPDrvEAPaMukg3vxM2WlwN4-fydB7e2mbB7bZ9tg62mwtDUMimI0kxqZjddRCF1SXkX-2NFObMbInNiUNcs7QxAY1FxqrsMaaQZkYJ3xnFXnB3cyiDJpWsWam_IHDLCTNPbvOKcWJpwbPq1j7eMYke05iOHp-7kHOAhoDskrax0LlB4q6xUnKXMEoMcU0tyqUmlXIc7XYld9O10nY2E2nRFjKUWSxS2O_AvrAmD2pKcGksUtat_RSorbplyH2TGcpZSF4NxDfd1O1Dp1sg1K65pQX6TrHt2Gqdr5cpERUZYIaRGIqQlNTPMmUklr0phCBMkleqQVJiwqGvK986SksYWGo0jcKoLbDTh1EC0_NRZ2FEYhp4j03YClGUlu8aMKKotc1XCjDCR4dpb25-3cE6lzlBjRjg19kBuTvVeRkTjSpboYiVNsbP9ntwOM4qzZkMRzkrW6ewk_P9Zy_G56XbUNKbUHBLdl6QVM1YWmpbfxPLi82vT0m_zty0b3wQ8tBRUQawuyieGlYxTtxKJXWk0K8k7Sxo-OfVUjTlqwqW8qpRXufFTml8ddKqlooXrIxOqso0EmCgO0DR6YOtqbw99A81HTgzNsRXNoajc_cNEQR5K6q80hdpWOvEboLMiu_lu47pW6IojUVomNGF8z63TYUZTkcmSGOxWecNkJV5L0Tn1r-Opg1UilcJYTZmbVSHdWql9_bcG9-BYNTWrMbVS77vdRRBMF9EkjiCePLuIQFUJZ-mTNfSDRxRm8_gM5pcxzF9fXAyCR0l70nybXs6X8WIym8ewJuoKN_BqMXs5WbyDX6J30KcwWU6PBsGj2fx59BbWJCEsW0M_8efB0XkQTC7iaPFPz7P5z9E0hmU8iWfLeDZdwuP3AQDA7_6_--vRuvAvi94YwsHDcbuLe2N4f3_Y4Hv33z9s4zVSixmhtjeG3kk4OhuGo2E4gnA0DsNxGPa2wO6eZSJ1T6ZKOMIo3Pbtl4l_TtmNcoH1tsl-l94Rt2luR94bPDkdnZz63_4Y_NeUk--Sso_w-2UdfHh8vluRG6fI6itF1l2K3OxQZHWnyC9wNckd8sXlIpr9OG-Q9REsohfRIppPo-W9NPv0Qc6O5-Vc75XzZqecfZbR21cXk9kc-pev4gFE8zdHsIwuHPZ_8GJx-RLWA9jArz9FiwgSeAqn58FwOBwGTAjUQ_9s6adaGnMUwO3NX7c3n29vPoO_1jdfnax_aOfP_fKnq_XtzU0LuN83dgzHJ8ejMbw_PoUhHJ9-CLZgOeMWtYG-1RUeBX8HAAD__wttO5A=

#
# Same table twice should only show up once.
#

query T
EXPLAIN (OPT, ENV) SELECT * FROM x one, x two
----
https://cockroachdb.github.io/text/decode.html#eJy0Vs9u2zgTP1dPMfClzge7kJPvEDjowXW8gHcdJ7DVokEQELQ0krmhSIYcOU4WC_Qhctyny5MsSDmJu4jsLRb1wZDI-c3f38yo24UvaJ3Qqg9Dnd5YzdPl6SfANaaLSsgMLRA6glUtFUXdLnAp9R0zFg23yLhj2hAzkitYcge0RMgw55UkWHFZYR90nntcqh0xl3Ll2J2gJdtIsVRL5sQD7oFn3HtyLxvlxvPzDpydXgbhjW6haKfu421hslw5npLQihkrtBV03wRU2pZcNqFvKy4F3TOdM4d2JdJGBywWleS2SZFFnjGtZKMfz8l5A1s5ZLn2xUIbFLl9SoSra5tXUjLiC4l1vXbh5qPEA8ndSvjoT04AXh16luQVaW8CVdAqSiNFKog5lJgSy7VllfEVbjSl3oJvh-t1LDilS-aIE5aoqNnx77Qph5ZYzh0xw2n5r0BlJUkY_6AzkYuUex-cL3jI255Mb5Q8iOKBF-x3LZp7pza6Nj5NXGVMFEpbZEoTWwknvJpUy6pUjgnFUm32UUUoQrvicmcvGe2osOg8QHJbYM0JzwZm9V1jYntxHAeMTjcdYEiU4gEzZrgl4bOEGRMqw3XQtjtu5Y1qm6HFjEnuaE9snvWBRsziUpfofWV1srPdlvwMc0aKekIxKUrRaOww_v_xBhNis5tWs5hyt49034OWwpEuLC9_CBXIF8Ym8R-zt02bUATcNxRMwcgW5QcnSiG5H4mMlhbdUsvGlMYfjgLUYo6WSa1vKhNY7kKX5jd7jVpteOHrKJSpqKaAUMUemMUguDG1s4ahgO5WMsdz3JBmn1d-_whVsNeUhpVm0FJlF2ECNGbkbbyfuL4UtpLIjNULvhByx9ZpUGO5ynTJHDazvEaKEh-0auz6z8nQi1Uq1cqR5cL3qtJ-rKxC_rcad29b1TlbYUra7truKoqGs9EgGUEy-DQZgakWUqQf1tCO3nEYT5NjmJ4nMP08mXSid4vNSf02PJ_Ok9lgPE1gzcwN3sPFbHw2mF3Cb6NLaHMYzIcHnejdeHo6-gprtmAiW0N7Ec6jg5MoGkyS0eyflsfTX0fDBObJIBnPk_FwDu-vIgCAP8K__7X4qghfFq0-xJ3X480sbvXh6uWwlm-9vF9vy1vkhBnj1OpD6zDuHXfjXjfuQdzrx3E_jltbwn7PCpX6T6ZKeUAv3rYdhkn4nKJ74x1rbYPDLH0GbsP8jHxReHjUOzwKd392_mvIi58ScvDw50UdXb8_iaLR14vJYDyF9vlF0oHR9MsBzEcTT4r_wS-z8zNYw2AOWmGnfqI7fRJ1u91uJJRC2w0rvZ1a7dxBBE-Pfz09fnt6_AZh5a3hiruPWuF1wxXd6XD1uLnKhSS0DtpkKzyI_g4AAP__FRvwug==

#
# Set a relevant session variable to a non-default value and ensure it shows up
# in the environment dump.
#

statement ok
SET reorder_joins_limit = 63

query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyUVdFS28gSfY6-ot8CtzCQy9YWBcWDY8Sud41M2Uo2VCrVNZZa0iyjmWFmJDBP-Qi-kC_ZmpHZkBSyNm_gOud0q8_pntEIPpKxXMkTmKjsxiiWVefvge4pWzVc5GTAkXXQdqgoGo2ACaHuUBvSzBAyi0o71IJJqJgFVxHkVLBGOGiZaOgEVFF4XqasQ5sxafGOuwo3KMyUQMsfaICeM9_JWvTipsv5HlyeXwfwRptLt1X7-CXYGSYtyxxXErXhynC37iNKZWom-ti3DRPcrVEVaMm0POttwFDZCGb6hAyxHJUUvX08D-cVbmMJC-XNIhOE7JAIt523RSMEOrYS1Pm1jbeMU0909lbAmf_lFOBbQ89I1jjlS5AMqrzWgmfcoSVBmcNCGWy0d7i3lHyN_vJzvcaKuaxC65ijmqTrb_w7NWnJOCyYdaiZq_4TqW6E49r_oXJe8Iz5Hqw3PMxtYNIbkQdePrAS_1a8f3e6ovfaj4nJHHkplSGUymHLLfcymRJNLS1yiZnSQ1Hh0pFpmdi6S1pZVxqyniCYKanLhE8DGnXXO9h3h4eHgaOyzQZox2v-QDlqZhz3U6IcuczpPqht_27piyqTk6EcBbNu4Nt86kOM0FClavK9YjfsfHslf8OsFry7UCh4zXuL_f_wl-MNJ3yb2ayaoYzZodB9T6q4dao0rP4pVghfOJuO_Vy9l7EJJtDQUdAlOlPW-5bXXDB_EtFVhmylRO9ID_ePAtVQQQaFUjeNDim3YUuLm8GiRmlWeh-51I3rIsBlOXSIDAXkplZn4hn8evTqTQoe2luBlhW0yc1QY_4J4rLEb1MNr5om4xqzCkegdyiv8_3R9W6YRhBqo1ZsxcWWh6dHxjCZqxot9Qe9Y_KaHpTsXfwP6cTDGpkpaZ1h3K-rVP6ytMGCF7s7uFndzFrKnDLbHngZRZNFPE5jSMfvZzHoZiV4tr-GnehNA9MkPYZknkLyYTbbi960m1-6_ybzZJkuxtMkhTXqG1rD1WJ6OV5cw5_xNew0MF5Odn_EtVh45MV8EU9_SzpkuwuL-CJexMkkXj63cL_DPHmanMefAo_n97DTBtFo9zSKxrM0XvzY9jT5I56ksEzH6XSZTidLePv5y9vTKIo_Xc3G0wR25lfpHsTJx11YxjOP_R9cLOaXsIa_fo8XMTRwBken0Wg0GkXhTK4jeHp8fHr8-vT4Ff71xp3AwbsT-HxwBCM4OPoS_RMAAP__Rg53bA==

# Make sure it shows up correctly even if it matches the cluster setting.
statement ok
SET CLUSTER SETTING sql.defaults.reorder_joins_limit = 63


query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyUVdFS28gSfY6-ot8CtzCQy9YWBcWDY8Sud41M2Uo2VCrVNZZa0iyjmWFmJDBP-Qi-kC_ZmpHZkBSyNm_gOud0q8_pntEIPpKxXMkTmKjsxiiWVefvge4pWzVc5GTAkXXQdqgoGo2ACaHuUBvSzBAyi0o71IJJqJgFVxHkVLBGOGiZaOgEVFF4XqasQ5sxafGOuwo3KMyUQMsfaICeM9_JWvTipsv5HlyeXwfwRptLt1X7-CXYGSYtyxxXErXhynC37iNKZWom-ti3DRPcrVEVaMm0POttwFDZCGb6hAyxHJUUvX08D-cVbmMJC-XNIhOE7JAIt523RSMEOrYS1Pm1jbeMU0909lbAmf_lFOBbQ89I1jjlS5AMqrzWgmfcoSVBmcNCGWy0d7i3lHyN_vJzvcaKuaxC65ijmqTrb_w7NWnJOCyYdaiZq_4TqW6E49r_oXJe8Iz5Hqw3PMxtYNIbkQdePrAS_1a8f3e6ovfaj4nJHHkplSGUymHLLfcymRJNLS1yiZnSQ1Hh0pFpmdi6S1pZVxqyniCYKanLhE8DGnXXO9h3h4eHgaOyzQZox2v-QDlqZhz3U6IcuczpPqht_27piyqTk6EcBbNu4Nt86kOM0FClavK9YjfsfHslf8OsFry7UCh4zXuL_f_wl-MNJ3yb2ayaoYzZodB9T6q4dao0rP4pVghfOJuO_Vy9l7EJJtDQUdAlOlPW-5bXXDB_EtFVhmylRO9ID_ePAtVQQQaFUjeNDim3YUuLm8GiRmlWeh-51I3rIsBlOXSIDAXkplZn4hn8evTqTQoe2luBlhW0yc1QY_4J4rLEb1MNr5om4xqzCkegdyiv8_3R9W6YRhBqo1ZsxcWWh6dHxjCZqxot9Qe9Y_KaHpTsXfwP6cTDGpkpaZ1h3K-rVP6ytMGCF7s7uFndzFrKnDLbHngZRZNFPE5jSMfvZzHoZiV4tr-GnehNA9MkPYZknkLyYTbbi960m1-6_ybzZJkuxtMkhTXqG1rD1WJ6OV5cw5_xNew0MF5Odn_EtVh45MV8EU9_SzpkuwuL-CJexMkkXj63cL_DPHmanMefAo_n97DTBtFo9zSKxrM0XvzY9jT5I56ksEzH6XSZTidLePv5y9vTKIo_Xc3G0wR25lfpHsTJx11YxjOP_R9cLOaXsIa_fo8XMTRwBken0Wg0GkXhTK4jeHp8fHr8-vT4Ff71xp3AwbsT-HxwBCM4OPoS_RMAAP__Rg53bA==

statement ok
SET enable_zigzag_join = false

query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyUVdFS28gSfY6-ot8CtzCQy9YWBcWDY8Sud41M2Uo2VCrVNZZa8iyjmWFmJDBP-Qi-kC_ZmpHYkBSyNm_g6nO6dc7pntEIPpKxXMkTmKjsxiiWrc_fA91Ttqq5yMmAI-ugaauiaDQCJoS6Q21IM0PILCrtUAsmYc0suDVBTgWrhYOGiZpOQBWFx2XKOrQZkxbvuFtjV4WZEmj5Aw3Ac-Yn2YjeuulyvgeX59ehuOPm0m3lPn5Z7AyTlmWOK4nacGW42_QBpTIVE33o25oJ7jaoCrRkGp71DmCorAUzfUSGWI5Kit45nsV5BVtbwkJ5s8gEIjtEwm3rbVELgY6tBLV-bcMt49QDnb0VcOZ_OQX4NtBzJaud8i1IBlZeacEz7tCSoMxhoQzW2jvc20q-Bn_5uZ5jxVy2RuuYo4qk6x_8OzZpyTgsmHWomVv_J1BVC8e1_0PlvOAZ8zNYb3jQbUixjuWBlw-sxL8Vl1vE6xrfay8VkznyUipDKJXDhlvumTIl6kpa5BIzpYfiwqUj0zCxdZ-0sq40ZD1AMFNSmwufCDTqrlfcd4eHhwGjsm4LtOMVf6AcNTOOe6UoRy5zug9s2wWXvqkyORnKUTDrBr7NJz9ECQ2tVUV-Vmz1zrd38nfMasHbK4WCV7y32f8PfznuMOHbTLduhjJmh4L3PWjNrVOlYdVPoUIAw-l07Of6vYxNMIGGDoMu0Zmy2re84oL5s4hubciuleiV9HD_KEANFWRQKHVT6xB0Gza1uBlsapRmpfeRS127NgJclkOrZShUdr1aE8_g16NXVyt4aG8FWlZQl5uhwfwzxGWJ31QNL5sm42qzCoegV5TX8f7wejdMLQi1USu24mLL49NDY5jMVYWW-oPeInlFD0r2Lv6HdOLLapkpaZ1h3K-rVP6yNMGCF7s7uFmtZg1lTpltj7yMoskiHqcxpOP3sxh0vRI829_ATvSmhmmSHkMyTyH5MJvtRW-a7pf2v8k8WaaL8TRJYYP6hjZwtZhejhfX8Gd8DTs1jJeT3R_rGix85cV8EU9_S9rKZhcW8UW8iJNJvHwe4X6HefA0OY8_BRzP72GnCaTR7mkUjWdpvPhx7GnyRzxJYZmO0-kynU6W8Pbzl7enURR_upqNpwnszK_SPYiTj7uwjGe-9n9wsZhfwgb--j1exFDDGRydRqPRaBSFM7mJ4Onx8enx69PjV_jXG3cCB-9O4PPBEYzg4OhL9E8AAAD__-Sad84=

statement ok
SET optimizer_use_histograms = false

query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyMVdFO48gSfR5_Rb0NXBFgLqsVAvGQCWY3u8FBiWd20GhU6thlp5d2d9PdNoSn-Qi-kC9ZddvswAjH-wZRnVPlc05Vj0bwmYzlSp7ARGU3RrFsff4R6J6yVc1FTgYcWQdNWxVFoxEwIdQdakOaGUJmUWmHWjAJa2bBrQlyKlgtHDRM1HQCqig8LlPWoc2YtHjH3Rq7KsyUQMsfaACeMz_JRvTWTZfzPbg8vw7FHTeXbiv38ctiZ5i0LHNcSdSGK8Pdpg8olamY6EPf1kxwt0FVoCXT8Kx3AENlLZjpIzLEclRS9M7xLM4b2NoSFsqbRSYQ2SESbltvi1oIdGwlqPVrG24Zpx7o7K2AM__LKcCPgZ4rWe2Ub0EysPJKC55xh5YEZQ4LZbDW3uHeVvIt-MvP9Rwr5rI1WsccVSRd_-Cv2KQl47Bg1qFmbv2fQFUtHNf-D5XzgmfMz2C94UG3IcU6lgdePrAS_1ZcbhGva3yvvVRM5shLqQyhVA4bbrlnypSoK2mRS8yUHooLl45Mw8TWfdLKutKQ9QDBTEltLnwi0Ki7XnE_HB4eBozKui3Qjlf8gXLUzDjulaIcuczpPrBtF1z6psrkZChHwawb-Daf_BAlNLRWFflZsdU7397J3zGrBW-vFApe8d5m_z_85bjDhG8z3boZypjdGjxv_2vUmlunSsMqOxiC18AQwnA-HRsK-2vky-gEI2joOOgSnSmrfcsrLpg_jejWhuxaiV5ZD_ePAtRQQQaFUje1DmG3YVuLm8GmRmlWei-51LVrY8BlObRehkJl16s18gx-PXpT2eCjvRVoWUFddoYG808RlyX-UDW8bpqMq80qHINeUd7G--Pr3TC1INRGrdiKiy0PUA-NYTJXFVrqD3uL5BU9KNm7_J_SiS-rZaakdYZxv7JS-evSBAte7O_gdrWaNZQ5ZbY99DKKJot4nMaQjj_OYtD1SvBsfwM70bsapkl6DMk8heTTbLYXvWu6X9r_JvNkmS7G0ySFDeob2sDVYno5XlzDn_E17NQwXk52f65rsPCVF_NFPP0taSubXVjEF_EiTibx8nmE-x3mwdPkPP4ScDy_h50mkEa7p1E0nqXx4uexp8kf8SSFZTpOp8t0OlnC-6_f3p9GUfzlajaeJrAzv0r3IE4-78Iynvna_8HFYn4JG_jr93gRQw1ncHQajUajURRO5SaCp8fHp8fvT4_f4V9v3AkcfDiBrwdHMIKDo2_RPwEAAP__rcN4MA==

statement ok
SET optimizer_use_multicol_stats = false

query T
EXPLAIN (OPT, ENV) SELECT * FROM y WHERE u = 3
----
https://cockroachdb.github.io/text/decode.html#eJyMVdFS28gSfY6-ot8CtzCQy9YWBcWDY8Sud41M2Uo2VCrVNZZa8iyjmWFmJDBP-Qi-kC_ZmpHZkARJ-wauPqdb55zuGY3gIxnLlTyBicpujGLZ-vw90D1lq5qLnAw4sg6atiqKRiNgQqg71IY0M4TMotIOtWAS1syCWxPkVLBaOGiYqOkEVFF4XKasQ5sxafGOuzVuqzBTAi1_oAF4zvwkG9FZN13O9-Dy_DoUb7m5dL3cxy-LnWHSssxxJVEbrgx3my6gVKZiogt9WzPB3QZVgZZMw7POAQyVtWCmi8gQy1FJ0TnHszivYGtLWChvFplAZIdIuG29LWoh0LGVoNavPtwyTj3Q2VsBZ_6XU4BvAz1Xstop34JkYOWVFjzjDi0JyhwWymCtvcOdreRr8Jef6zlWzGVrtI45qki67sG_Y5OWjMOCWYeaufV_AlW1cFz7P1TOC54xP4P1hgfdhhTbsjzw8oGV-Lfiske8beN77aViMkdeSmUIpXLYcMs9U6ZEXUmLXGKm9FBcuHRkGiZ690kr60pD1gMEMyW1ufCJQKPuOsV9d3h4GDAq226BdrziD5SjZsZxrxTlyGVO94GtX3DpmyqTk6EcBbNu4Nt88kOU0NBaVeRnxVbvvL-Tv2NWC95eKRS84p3N_n_4y_EWE77NbNfNUMZsb_C8_d-j1tw6VRpW2f4Q_IwMKQz30zE3gP5p2JfxCWbQ0IHQJTpTVvuWV1wwfx7RrQ3ZtRKd0h7uHwWooYIMCqVuah0Cb8PGFjeDTY3SrPR-cqlr10aBy3JoxQyFym2v1swz-PXoVX2Cl_ZWoGUFbfMzNJh_jrgs8Zuq4YXTZFxtVuEgdIryOt4fYO-GqQWhNmrFVlz0PEIdNIbJXFVoqTvwLZJX9KBk5wH4kE58WS0zJa0zjPu1lcpfmCZY8GKHBzes1ayhzCnT99jLKJos4nEaQzp-P4tB1yvBs_0N7ERvapgm6TEk8xSSD7PZXvSm2f7S_jeZJ8t0MZ4mKWxQ39AGrhbTy_HiGv6Mr2GnhvFysvtjXYOFr7yYL-Lpb0lb2ezCIr6IF3EyiZfPI9zvMA-eJufxp4Dj-T3sNIE02j2NovEsjRc_jj1N_ognKSzTcTpdptPJEt5-_vL2NIriT1ez8TSBnflVugdx8nEXlvHM1_4PLhbzS9jAX7_HixhqOIOj02g0Go2icC43ETw9Pj49fn16_Ar_euNO4ODdCXw-OIIRHBx9if4JAAD__7lOeJI=

statement ok
RESET reorder_joins_limit

statement ok
RESET enable_zigzag_join

statement ok
RESET optimizer_use_histograms

statement ok
RESET optimizer_use_multicol_stats

#
# Test sequences.
#

statement ok
CREATE SEQUENCE seq

query T
EXPLAIN (OPT, ENV) SELECT * FROM seq
----
https://cockroachdb.github.io/text/decode.html#eJyUVcFu20gMvfsr5ri7qAMnbptsgx68rhYIEDvd2Am6J2I8oiRuRjNjDuUk_vrFSC6aApHV3ASb75HD90iOx-oeOZJ3n9Tcmwf22lRf_lL4hGbTkM2RlWAUteuiRqPxWGlr_SMExqAZQUfwQSBY7VSlo5IKVY6FbqyonbYNflK-KBLO-CgQjXYRHkkqOESB8RYi7XEAnutUybPtjbta3bxTiy__tsEHbnJylPviZbCwdlEbIe8gMHkmee4DOs-1tn3obaMtyTP4AiLyjkxvAYxlYzX3ETHqHLyzvXV8b84r2CYiFD6JhdwSxSESip22RWMtiN5Y7PQ6hltl6wSUuLXqc_rlUqkfBX2P1I34lAJdy0p1sGRIIKJFI1B4hiYkhXtTudfgL5-bODZaTAVRtGCNTvoL_4nNRWSBQkeBoKX6JVDdWKGQPnxOBRmdaohJ8LZvA50-kOyp3OsS_vPUPztd0qeQ2qRdDlQ6zwjOC-woUqIx3ja1i0AOjA9DViEnyDttj85S8FFKxpgAVnOJnSeSG4D9Y29jTyeTSYvx5jABQaimPeYQNAulLmEO5HJ8atmOv9ulpJ5zZMzB6igDb0uub20EjJWvMdUKXbPz45nSDovBUrehwFJNvcnOJu8vDpj2bXwYNUaj45DpfgZVFMWXrOs3oVrztWtT9NvyvbRNKwIOLYVQgnBZn0Sqyeq0EkEqxlh529vSycm0hTIWyGC9f2hC6_LYTmnxMJiUfdBl0pFcaKSzALlyaBExtpGHXJ2In9XH6as7qdUwbi1EXeDBN0OFpRNEroQfXW2vWkCWhjftEuhtyuv4tHSTGtxYhMB-ozdkjxyeHhrWLvc1ROw3eoekGvfe9Q7-3XqewhpnvIvCmtK4Op82y66V4MXsDk5W17MdGvF87MC70Wh-m83WmVpl_9xly3mmQrOxZE4ibtXiank_u77L1KlazL51n3-enU2n52eT6ceLD-_Pzz9cTM7V1XJ-my2y5VqdqtV6drtWp5ejUfbt6_Xsaql-u_m6fqey5f3vapVdZ_O1-kP9fXuzUBG3l6PxeDweRdw26AyOu6uU_hn9HwAA__-wnkTd

#
# Test views.
#

statement ok
CREATE VIEW v AS SELECT a, b, u, v FROM x, y WHERE b = 3

query T
EXPLAIN (OPT, ENV) SELECT * FROM v
----
https://cockroachdb.github.io/text/decode.html#eJy0Vt9u27YXvo6e4sA3tX-wEzn-YQgcFJjrqpu31C5s9R-KgqCkI5kLRaokpdoZBhR7hlzu6fIkAyk7cVbLXjG0F0VEf9_5-51D9nrwBpVmUgxhLONrJWm8fP4McIVxVDKeoAKD2kBVozyv1wPKufxMCoUFVUioJrIwpOBUwJJqMEuEBFNacgMV5SUOQaap5cVSG6JjKjT5zMySbFAklpxodoNH6Am1kax5I26ymHXh5fP3DryxzYQ5aPtiF2wUFZrGhklBCsWkYmbdRBRS5ZQ3sT-VlDOzJjIlGlXF4sYAFGYlp6rJkEKaECl4Yxzb4uzhlhpJKm2zUDlD-pgRpuvepiXnxNCIY92vQ7xFEFqi0Z84PLUnlwAPAW2RtDTSukDhrLK84CxmhmjkGBuSSkXKwna40ZXYR99N19qIqImXRBtqMEdhmgN_ZE1oVIakVBtSULP8V6S85IYV9g-ZsJTF1MagbcNd3Y5UemPkhmU3NCO_SdY8O7XTVWHLREVCWCakQiKkIRXTzJqJJS9zoQkTJJbFMakwYVBVlB-cpUJqkynUlsCpyrDWhFUDUfJzY2H7vu87jow3E1AYlrMbTEhBlWG2SpgQJhJcOWuH8xbWqVQJKkwIp9ocyc2q3smIKFzKHG2spC52ctiT3WG64KzeUISznDU6O_f_f7HhuNzUZtQUxlQfE91j0pJpIzNF829iOfG5tWnot_nblY1rAh5bCkVGjMryU81yxqldicQsFeql5I0l9U8HjqowRUW4lNdl4VSu3ZSm10edKlnQzPaRiaI0tQSYyI4tIoUOufFVN_Ep_DDYu5NcD_UnTjRNcaObY4HZK4iJjDxU1d1qBSpTqsgtgcai7OfbpWu7oUqOpFAyohHjBy6eBjOKikTmRGOz0Gsmy_FGisbBfx2OLawUsRTaKMrsuAppN0vlWrAzu0cnq65ZhbGR6tAFLzxvPA9GYQDh6NlVAEUZcRafrqDtnVCYTMMLmM5CmL6-uup6J9HmpP4az6aLcD6aTENYkeIa1_BqPnk5mr-HX4P30KYwWow7Xe9kMn0evIMViQhLVtCO3LnXufS80VUYzP_peTL9JRiHsAhH4WQRTsYLePLBAwD43f1v_7VolbnHRWsIfvfheLOOW0P4cH9Y41v33x938QqpwYRQ0xpC69zvX_T8fs_vg98f-v7Q91s7YHvVMhHbV1MpLKHv7_p2-8S9qMy6sIG1dslunW6JuzS7Ju8Nng_65wP32x_d_5py9F1SdhF-v6y9j08u9ytybRVZfqXIqkmR6z2KLLeKfISrSGqRL2bzYPLTtEZWHZgHL4J5MB0Hi3tptumDnC3Pybk6KOf1XjnvZvlmErzdois3dnbQut5JadPzOjBawCK4sjZoF6IulF2o4MV89tLtotNtcN1Hn2t4-3MwDyCCpzC49Lzg3aur0WQK7dmrsAvB9E1na_R_ta3q0uv1ej2PCYGq595F7VhJrTse3N3-dXf75e72C7h3w_qrk9WPm-m2v_xpO3l3e7sB3G8zM4Sz87P-ED6cDaAHZ4OP3g4sZdyg0tA2qsSO93cAAAD__8LDVSA=

#
# Test tables in user-defined schemas.
#

statement ok
CREATE SCHEMA s;
CREATE TABLE s.t (a int primary key)

query T
EXPLAIN (OPT, ENV) SELECT * FROM s.t;
----
https://cockroachdb.github.io/text/decode.html#eJyUVV1v20YQfA5_xb3FLizDbYrCiJEHRVEBtbJsSExQoygWJ3JJbn28O-8t5Y9fX9xRQRTAFJs3QdiZXe7Mzk0m6gtyIGffq5kr7tnpovn0UeETFtuOTImsBIOoXV-VZZOJ0sa4R_CMXjOCDuC8gDfaqkYHJQ2qEivdGVE7bTp8r1xVRVzhgkAotA3wSNLAvgoKZyDQC47ASx0neTaDdYvNzZm6_nSXivfcZOUo9-VhsbC2QRdCzoJnckzyPAS0jltthtAPnTYkz-AqCMg7KgYHYKw7o3mIiFGX4KwZnOPrcl7BdgGhclEs5EQUxkgo9NpWnTEgemuw1-sYbjPPI1DCg1Ef4j9XSn0b6Gul7sTFFmgTK7XeUEECAQ0WApVj6HxUeLCVfQ1--LmRY6ulaCCIFmzRyvDg37HZgCxQ6SDgtTT_C9R2RsjHH66kigodZwhR8LS3kU3vSV6oftE1_Oto-Hb6pk8-rknbEqi2jhGsE9hRoEhTONO1NgBZKJwfswpZQd5pc_SWvAtSM4YIMJpr7D0R3QDsHgcX-_PFxUXCuGJ_AV6opRcswWsWilvCEsiW-JTYjn-3jU0dl8hYgtFBRr4tuj7ZCBgb12KcFfpll8c7xQwL3lCfUGCopcFmv1z8ernHpG_j_akxFjqMme57UENBXM26_SFUMl-KTdE_1u_QNkkEHAsFX4Nw3Z4HasnoGIkgDWNonBlc6cX5uwRlrJDBOHff-eTykK60uh9tys7rOupI1nfSW4BsPRZEjKly36sX8YP67d2rmZQ0DA8Ggq5w75uxweITRLaGb1tNr5pHlo63KQQGl_I6PoZuVIM7g-DZbfWWzJGHZ4CGtS1dCwGHjd4jqcUXZwcP_3M-i2WdLZwNwpriuVoXk2WXJDi43dHL6ne2w0IcH3vgbZbN1vNpPlf59ONyrsK5qJPsjVaLVX6pVje5Wn1eLs-yN7Ob1SZfTxerXAn4e3xWt-vF9XR9p_6c36kTraab2Wl2epVl02U-Xx_QLVZ_zGe52uTTfLHJF7ONevv3P2-vsmz-1-1yulipk5vb_EzNV19O1Wa-jLU_qd_XN9cRfZVNJpNJlvJKsv8CAAD__3SdR4U=

#
# Test default_transaction_quality_of_service settings.
#

statement ok
SET default_transaction_quality_of_service=background

query T
EXPLAIN (OPT, ENV) VALUES(1);
----
https://cockroachdb.github.io/text/decode.html#eJyUVcFuG0cMvesr5mgDVmA3RREk8CFNfAiQJgHsGO2JoGa5K9azwzGHK9s65SP8hf6SYmYVxAG02uYmCHyPnPceuculuybNLPG1eyf-RgX9-v2fju7JrwYODakzyuY2Y9VisVw6DEHuICklVALMIMkgBYxujdnZmlxDLQ7B3AbDQK-dtG3BeckG2WPMcMe2hl0VeAmQeUsz8AbLJA9hsu7D5ecT99f7f2rxjpujHeR-9bzYFGNGbywRkrIo28MUMIr2GBaXF1d74bcDBrYHkBYy6YY9uXO3Qn_TqQyxeePcj77fKZW6IaBOTaSEDUgMkyN912kPdsgErRTfSCtRniPhPNrcDiGA4SrQaN0hXBWDs-Xb4M7LP3ufiYNJaUGxsnKfAns2yBTIG7SiMKRi9mSruA_-_LmFY4Xm15ANjXqKNj34T2wxkxq0mA0S2vp_gfohGKfyQxpu2WOZIRfrq24zSu9IttxtsYN_hafXaGx6n4pMGBvgLooSRDHYcOZC4yUMfczAEbykuahwNNINhoNrlSRbp5QLIKB2NGaipAFU7iaFPTs9Pa0Y8btdSMY9b6mBhGpcVKIGODZ0X9kOvzuWpqINKTUQMNvM20rqa4xAaS09lVlhFLs53Kmcs5wCj8cKAvc82ey3099f7TD1bbpbNSWPeS50P4PWnE06xf6XUDV89YIa_lq_57GpJtDcUUgdmHb9i8w9ByzXEWytlNcSJiU9ffGyQpVaUggiN0OqKc91S9ub2aYqCbviI8c02BgBjt3cIVKqlbteo4nn7o-Xe29S9TDfBsjY0i43c4OVrxHHDn6oWj9widQGXdUjMCnKfnw5usUNHQJBUlnhisOBb9AEjWJspIdM00EfkdzTVuLk4n-9elfKhuglZlPksq5RymXZVAue7e7sZo2abcib6KFvfVwsLv7-8vHth0_u6POXqxN38en62F2__fj14tIdnR2_WSyXy-WilueFe3p8fHr89vT4zR2dnRwv_gsAAP__QkEw2g==

statement ok
SET default_transaction_quality_of_service=critical

query T
EXPLAIN (OPT, ENV) VALUES(1);
----
https://cockroachdb.github.io/text/decode.html#eJyUVcFuG0cMvesr5mgDVmA3RREk8CFNfAiQJgHsGO2JoGa5K9azwzGHK9s65SP8hf6SYmYVxAG02uYmCHyPnPceuculuybNLPG1eyf-RgX9-v2fju7JrwYODakzyuY2Y9VisVw6DEHuICklVALMIMkgBYxujdnZmlxDLQ7B3AbDQK-dtG3BeckG2WPMcMe2hl0VeAmQeUsz8AbLJA9hsu7D5ecT99f7f2rxjpujHeR-9bzYFGNGbywRkrIo28MUMIr2GBaXF1d74bcDBrYHkBYy6YY9uXPnlY09hjfO_ej6nVCpGwLq1DxK2IDEMDnQd5X2YIdM0EpxjbQS5TkSzqPJ7RACGK4CjcYdwlUpOFu-De68_LP3mTiYlBYUKyv3KbBng0yBvEErCkMqVk-2ivvgz59bOFZofg3Z0KinaNOD_8QWM6lBi9kgoa3_F6gfgnEqP6Thlj2WGXIxvuo2o_SOZMvdFjv4V3h6icam96nIhLEB7qIoQRSDDWcuNF7C0McMHMFLmosKRyPdYDi4VEmydUq5AAJqR2MmShpA5W5S2LPT09OKEb_bhGTc85YaSKjGRSVqgGND95Xt8LtjaSrakFIDAbPNvK2kvsYIlNbSU5kVRrGbw53KMcsp8HiqIHDPk81-O_391Q5T36a7VVPymOdC9zNozdmkU-x_CVXDV--n4a_1ex6bagLNHYXUgWnXv8jcc8ByG8HWSnktYVLS0xcvK1SpJYUgcjOkmvJct7S9mW2qkrArPnJMg40R4NjNHSKlWrnrNZp47v54ufcmVQ_zbYCMLe1yMzdY-RZx7OCHqvXzlkht0FU9ApOi7MeXo1vc0CEQJJUVrjgc-AJN0CjGRnrINB30Eck9bSVOLv7Xq3elbIheYjZFLusapVyWTbXg2e7Obtao2Ya8iR760sfF4uLvLx_ffvjkjj5_uTpxF5-uj931249fLy7d0dnxm8VyuVwuanleuKfHx6fHb0-P39zR2cnx4r8AAAD__xVIMAU=
