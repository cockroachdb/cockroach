# LogicTest: 5node

statement ok
CREATE TABLE xyz (
  id INT PRIMARY KEY,
  x INT,
  y INT,
  z INT
)

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (4), (6), (7)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 0),
  (ARRAY[2], 2),
  (ARRAY[3], 4),
  (ARRAY[4], 6),
  (ARRAY[5], 7)


query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW RANGES FROM TABLE xyz WITH DETAILS]
ORDER BY 1
----
start_key           end_key       replicas  lease_holder
<before:/Table/62>  …/1/2         {1}       1
…/1/2               …/1/4         {2}       2
…/1/4               …/1/6         {3}       3
…/1/6               …/1/7         {4}       4
…/1/7               <after:/Max>  {5}       5

query T
EXPLAIN (VERBOSE) SELECT x, y, z, ordinality FROM xyz WITH ORDINALITY
----
distribution: local
vectorized: true
·
• ordinality
│ columns: (x, y, z, "ordinality")
│ estimated row count: 1,000 (missing stats)
│
└── • scan
      columns: (x, y, z)
      estimated row count: 1,000 (missing stats)
      table: xyz@xyz_pkey
      spans: FULL SCAN

query T
EXPLAIN (DISTSQL) SELECT x, y, z, ordinality FROM xyz WITH ORDINALITY
----
distribution: local
vectorized: true
·
• ordinality
│
└── • scan
      missing stats
      table: xyz@xyz_pkey
      spans: FULL SCAN
·
Diagram: https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkFFr2z4Uxd__n0Kcp_9ApnHcsEZPK03GDGnSxYZtrKZo0m0m6liepFA7wd992Fm7rrDSPd5zr87v6Bzgf5QQmH--WpynS_b_LM3y7OPiDcvmi_lFzhrOWs72nF3DOm0qWZrQXoO9X68uWdPu2ac0_8BW61m6PF-k-RdwVFbTUm7JQ3xFjIKjdlaR99b10mE4SHUDMeIwVb0LvVxwKOsI4oBgQkkQyOW3ktYkNbmTETg0BWnKwbZp9--adn9T31ELjgtb7raVFw9xwZHVshciFB2H3YXfGB_khiDiJ7nSGcSo46-Ptnrs4iT-I9nfaONntPhfaGvyta08vYo0ekaK4q7gIL2hY_ve7pyiK2fVcHscV4PRIGjy4biNj0NaPax8cCS3j2U9dYpfdBq_5FRw3Jb2_sZoCLxVNE70mYpOk_EkOp3oSXQ21UkU01RJlUyTidboH8iN7yvKvtv7wTZv6_6Dt7L0xHEp72hGgdzWVMYHo35tuu6_nwEAAP__Htj1IQ==
