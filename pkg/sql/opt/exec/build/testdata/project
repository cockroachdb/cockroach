exec-raw
CREATE DATABASE t
----

exec-raw
CREATE TABLE t.a (x INT PRIMARY KEY, y INT)
----

exec-raw
INSERT INTO t.a VALUES (1, 10), (2, 20), (3, 30)
----

exec-explain
SELECT * FROM t.a WHERE x > 1
----
filter     0  filter  ·       ·          (x, y)  ·
 │         0  ·       filter  @1 > 1     ·       ·
 └── scan  1  scan    ·       ·          (x, y)  ·
·          1  ·       table   a@primary  ·       ·
·          1  ·       spans   ALL        ·       ·

exec
SELECT * FROM t.a WHERE x > 1
----
2  20
3  30

exec-explain
SELECT * FROM t.a WHERE y > 1
----
filter     0  filter  ·       ·          (x, y)  ·
 │         0  ·       filter  @2 > 1     ·       ·
 └── scan  1  scan    ·       ·          (x, y)  ·
·          1  ·       table   a@primary  ·       ·
·          1  ·       spans   ALL        ·       ·

exec
SELECT * FROM t.a WHERE y > 1
----
1  10
2  20
3  30

exec-explain
SELECT * FROM t.a WHERE x > 1 AND x < 3
----
filter     0  filter  ·       ·                      (x, y)  ·
 │         0  ·       filter  (@1 > 1) AND (@1 < 3)  ·       ·
 └── scan  1  scan    ·       ·                      (x, y)  ·
·          1  ·       table   a@primary              ·       ·
·          1  ·       spans   ALL                    ·       ·

exec
SELECT * FROM t.a WHERE x > 1 AND x < 3
----
2  20

exec-explain
SELECT x + 1 FROM t.a
----
render     0  render  ·         ·          ("@1 + 1:::INT")  ·
 │         0  ·       render 0  x + 1      ·                 ·
 └── scan  1  scan    ·         ·          (x, y)            ·
·          1  ·       table     a@primary  ·                 ·
·          1  ·       spans     ALL        ·                 ·

exec
SELECT x + 1 FROM t.a
----
2
3
4

exec-explain
SELECT x, x + 1, y, y + 1, x + y FROM t.a
----
render     0  render  ·         ·          ("@1", "@1 + 1:::INT", "@2", "@2 + 1:::INT", "@1 + @2")  ·
 │         0  ·       render 0  x          ·                                                        ·
 │         0  ·       render 1  x + 1      ·                                                        ·
 │         0  ·       render 2  y          ·                                                        ·
 │         0  ·       render 3  y + 1      ·                                                        ·
 │         0  ·       render 4  x + y      ·                                                        ·
 └── scan  1  scan    ·         ·          (x, y)                                                   ·
·          1  ·       table     a@primary  ·                                                        ·
·          1  ·       spans     ALL        ·                                                        ·

exec
SELECT x, x + 1, y, y + 1, x + y FROM t.a
----
1  2  10  11  11
2  3  20  21  22
3  4  30  31  33

exec-explain
SELECT u + v FROM (SELECT x + 3, y + 10 FROM t.a) AS foo(u, v)
----
project
 ├── columns: column5:int:null:5
 ├── project
 │    ├── columns: column3:int:null:3 column4:int:null:4
 │    ├── scan
 │    │    └── columns: a.x:int:1 a.y:int:null:2
 │    └── projections
 │         ├── plus [type=int]
 │         │    ├── variable: a.x [type=int]
 │         │    └── const: 3 [type=int]
 │         └── plus [type=int]
 │              ├── variable: a.y [type=int]
 │              └── const: 10 [type=int]
 └── projections
      └── plus [type=int]
           ├── variable: column3 [type=int]
           └── variable: column4 [type=int]

exec
SELECT u + v FROM (SELECT x + 3, y + 10 FROM t.a) AS foo(u, v)
----
