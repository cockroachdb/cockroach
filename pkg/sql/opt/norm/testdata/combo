exec-ddl
CREATE TABLE a (
    x INT PRIMARY KEY,
    i INT,
    f FLOAT,
    s STRING,
    j JSON,
    UNIQUE INDEX (s DESC, f) STORING (j)
)
----
TABLE a
 ├── x int not null
 ├── i int
 ├── f float
 ├── s string
 ├── j jsonb
 ├── INDEX primary
 │    └── x int not null
 └── INDEX secondary
      ├── s string desc
      ├── f float
      ├── x int not null (storing)
      └── j jsonb (storing)

exec-ddl
CREATE TABLE t.b (x INT PRIMARY KEY, z INT)
----
TABLE b
 ├── x int not null
 ├── z int
 └── INDEX primary
      └── x int not null

# --------------------------------------------------
# Use optsteps.
# --------------------------------------------------
optsteps
SELECT s FROM a INNER JOIN b ON a.x=b.x AND i+1=10
----
================================================================================
Initial expression
  Cost: 2000.00
================================================================================
  project
   ├── columns: s:4(string)
   ├── inner-join
   │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int!null) b.z:7(int)
   │    ├── scan a
   │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
   │    │    └── keys: (1) weak(3,4)
   │    ├── scan b
   │    │    ├── columns: b.x:6(int!null) b.z:7(int)
   │    │    └── keys: (6)
   │    └── and [type=bool, outer=(1,2,6)]
   │         ├── eq [type=bool, outer=(1,6)]
   │         │    ├── variable: a.x [type=int, outer=(1)]
   │         │    └── variable: b.x [type=int, outer=(6)]
   │         └── eq [type=bool, outer=(2)]
   │              ├── plus [type=int, outer=(2)]
   │              │    ├── variable: a.i [type=int, outer=(2)]
   │              │    └── const: 1 [type=int]
   │              └── const: 10 [type=int]
   └── projections [outer=(4)]
        └── variable: a.s [type=string, outer=(4)]
================================================================================
NormalizeCmpPlusConst
  Cost: 2000.00
================================================================================
   project
    ├── columns: s:4(string)
    ├── inner-join
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int!null) b.z:7(int)
    │    ├── scan a
    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    │    └── keys: (1) weak(3,4)
    │    ├── scan b
    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    │    └── keys: (6)
    │    └── and [type=bool, outer=(1,2,6)]
    │         ├── eq [type=bool, outer=(1,6)]
    │         │    ├── variable: a.x [type=int, outer=(1)]
    │         │    └── variable: b.x [type=int, outer=(6)]
    │         └── eq [type=bool, outer=(2)]
  - │              ├── plus [type=int, outer=(2)]
  - │              │    ├── variable: a.i [type=int, outer=(2)]
  - │              │    └── const: 1 [type=int]
  - │              └── const: 10 [type=int]
  + │              ├── variable: a.i [type=int, outer=(2)]
  + │              └── minus [type=int]
  + │                   ├── const: 10 [type=int]
  + │                   └── const: 1 [type=int]
    └── projections [outer=(4)]
         └── variable: a.s [type=string, outer=(4)]
================================================================================
EnsureJoinFiltersAnd
  Cost: 2000.00
================================================================================
   project
    ├── columns: s:4(string)
    ├── inner-join
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int!null) b.z:7(int)
    │    ├── scan a
    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    │    └── keys: (1) weak(3,4)
    │    ├── scan b
    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    │    └── keys: (6)
  - │    └── and [type=bool, outer=(1,2,6)]
  + │    └── filters [type=bool, outer=(1,2,6)]
    │         ├── eq [type=bool, outer=(1,6)]
    │         │    ├── variable: a.x [type=int, outer=(1)]
    │         │    └── variable: b.x [type=int, outer=(6)]
    │         └── eq [type=bool, outer=(2)]
    │              ├── variable: a.i [type=int, outer=(2)]
    │              └── minus [type=int]
    │                   ├── const: 10 [type=int]
    │                   └── const: 1 [type=int]
    └── projections [outer=(4)]
         └── variable: a.s [type=string, outer=(4)]
================================================================================
PushFilterIntoJoinLeft
  Cost: 2100.00
================================================================================
   project
    ├── columns: s:4(string)
    ├── inner-join
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int!null) b.z:7(int)
  - │    ├── scan a
  + │    ├── select
    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    │    └── keys: (1) weak(3,4)
  + │    │    ├── keys: (1) weak(3,4)
  + │    │    ├── scan a
  + │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  + │    │    │    └── keys: (1) weak(3,4)
  + │    │    └── filters [type=bool, outer=(2)]
  + │    │         └── eq [type=bool, outer=(2)]
  + │    │              ├── variable: a.i [type=int, outer=(2)]
  + │    │              └── minus [type=int]
  + │    │                   ├── const: 10 [type=int]
  + │    │                   └── const: 1 [type=int]
    │    ├── scan b
    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    │    └── keys: (6)
  - │    └── filters [type=bool, outer=(1,2,6)]
  - │         ├── eq [type=bool, outer=(1,6)]
  - │         │    ├── variable: a.x [type=int, outer=(1)]
  - │         │    └── variable: b.x [type=int, outer=(6)]
  - │         └── eq [type=bool, outer=(2)]
  - │              ├── variable: a.i [type=int, outer=(2)]
  - │              └── minus [type=int]
  - │                   ├── const: 10 [type=int]
  - │                   └── const: 1 [type=int]
  + │    └── filters [type=bool, outer=(1,6)]
  + │         └── eq [type=bool, outer=(1,6)]
  + │              ├── variable: a.x [type=int, outer=(1)]
  + │              └── variable: b.x [type=int, outer=(6)]
    └── projections [outer=(4)]
         └── variable: a.s [type=string, outer=(4)]
================================================================================
FilterUnusedJoinLeftCols
  Cost: 2100.00
================================================================================
   project
    ├── columns: s:4(string)
    ├── inner-join
  - │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int!null) b.z:7(int)
  - │    ├── select
  - │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    │    ├── keys: (1) weak(3,4)
  - │    │    ├── scan a
  + │    ├── columns: a.x:1(int!null) a.s:4(string) b.x:6(int!null) b.z:7(int)
  + │    ├── project
  + │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  + │    │    ├── keys: (1)
  + │    │    ├── select
    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    │    │    └── keys: (1) weak(3,4)
  - │    │    └── filters [type=bool, outer=(2)]
  - │    │         └── eq [type=bool, outer=(2)]
  - │    │              ├── variable: a.i [type=int, outer=(2)]
  - │    │              └── minus [type=int]
  - │    │                   ├── const: 10 [type=int]
  - │    │                   └── const: 1 [type=int]
  + │    │    │    ├── keys: (1) weak(3,4)
  + │    │    │    ├── scan a
  + │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  + │    │    │    │    └── keys: (1) weak(3,4)
  + │    │    │    └── filters [type=bool, outer=(2)]
  + │    │    │         └── eq [type=bool, outer=(2)]
  + │    │    │              ├── variable: a.i [type=int, outer=(2)]
  + │    │    │              └── minus [type=int]
  + │    │    │                   ├── const: 10 [type=int]
  + │    │    │                   └── const: 1 [type=int]
  + │    │    └── projections [outer=(1,4)]
  + │    │         ├── variable: a.x [type=int, outer=(1)]
  + │    │         └── variable: a.s [type=string, outer=(4)]
    │    ├── scan b
    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    │    └── keys: (6)
    │    └── filters [type=bool, outer=(1,6)]
    │         └── eq [type=bool, outer=(1,6)]
    │              ├── variable: a.x [type=int, outer=(1)]
    │              └── variable: b.x [type=int, outer=(6)]
    └── projections [outer=(4)]
         └── variable: a.s [type=string, outer=(4)]
================================================================================
FilterUnusedSelectCols
  Cost: 2100.00
================================================================================
   project
    ├── columns: s:4(string)
    ├── inner-join
    │    ├── columns: a.x:1(int!null) a.s:4(string) b.x:6(int!null) b.z:7(int)
    │    ├── project
    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
    │    │    ├── keys: (1)
    │    │    ├── select
  - │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    │    │    ├── keys: (1) weak(3,4)
  + │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
  + │    │    │    ├── keys: (1)
    │    │    │    ├── scan a
  - │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    │    │    │    └── keys: (1) weak(3,4)
  + │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
  + │    │    │    │    └── keys: (1)
    │    │    │    └── filters [type=bool, outer=(2)]
    │    │    │         └── eq [type=bool, outer=(2)]
    │    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │    │              └── minus [type=int]
    │    │    │                   ├── const: 10 [type=int]
    │    │    │                   └── const: 1 [type=int]
    │    │    └── projections [outer=(1,4)]
    │    │         ├── variable: a.x [type=int, outer=(1)]
    │    │         └── variable: a.s [type=string, outer=(4)]
    │    ├── scan b
    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    │    └── keys: (6)
    │    └── filters [type=bool, outer=(1,6)]
    │         └── eq [type=bool, outer=(1,6)]
    │              ├── variable: a.x [type=int, outer=(1)]
    │              └── variable: b.x [type=int, outer=(6)]
    └── projections [outer=(4)]
         └── variable: a.s [type=string, outer=(4)]
================================================================================
FilterUnusedJoinRightCols
  Cost: 2100.00
================================================================================
   project
    ├── columns: s:4(string)
    ├── inner-join
  - │    ├── columns: a.x:1(int!null) a.s:4(string) b.x:6(int!null) b.z:7(int)
  + │    ├── columns: a.x:1(int!null) a.s:4(string) b.x:6(int!null)
    │    ├── project
    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
    │    │    ├── keys: (1)
    │    │    ├── select
    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
    │    │    │    ├── keys: (1)
    │    │    │    ├── scan a
    │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
    │    │    │    │    └── keys: (1)
    │    │    │    └── filters [type=bool, outer=(2)]
    │    │    │         └── eq [type=bool, outer=(2)]
    │    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │    │              └── minus [type=int]
    │    │    │                   ├── const: 10 [type=int]
    │    │    │                   └── const: 1 [type=int]
    │    │    └── projections [outer=(1,4)]
    │    │         ├── variable: a.x [type=int, outer=(1)]
    │    │         └── variable: a.s [type=string, outer=(4)]
    │    ├── scan b
  - │    │    ├── columns: b.x:6(int!null) b.z:7(int)
  + │    │    ├── columns: b.x:6(int!null)
    │    │    └── keys: (6)
    │    └── filters [type=bool, outer=(1,6)]
    │         └── eq [type=bool, outer=(1,6)]
    │              ├── variable: a.x [type=int, outer=(1)]
    │              └── variable: b.x [type=int, outer=(6)]
    └── projections [outer=(4)]
         └── variable: a.s [type=string, outer=(4)]
--------------------------------------------------------------------------------
GenerateIndexScans (higher cost)
--------------------------------------------------------------------------------
   project
    ├── columns: s:4(string)
    ├── inner-join
    │    ├── columns: a.x:1(int!null) a.s:4(string) b.x:6(int!null)
    │    ├── project
    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
    │    │    ├── keys: (1)
    │    │    ├── select
    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
    │    │    │    ├── keys: (1)
  - │    │    │    ├── scan a
  + │    │    │    ├── lookup-join
    │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
  - │    │    │    │    └── keys: (1)
  + │    │    │    │    ├── table: a
  + │    │    │    │    ├── keys: (1)
  + │    │    │    │    └── scan a@secondary
  + │    │    │    │         ├── columns: a.x:1(int!null) a.s:4(string)
  + │    │    │    │         └── keys: (1)
    │    │    │    └── filters [type=bool, outer=(2)]
    │    │    │         └── eq [type=bool, outer=(2)]
    │    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │    │              └── minus [type=int]
    │    │    │                   ├── const: 10 [type=int]
    │    │    │                   └── const: 1 [type=int]
    │    │    └── projections [outer=(1,4)]
    │    │         ├── variable: a.x [type=int, outer=(1)]
    │    │         └── variable: a.s [type=string, outer=(4)]
    │    ├── scan b
    │    │    ├── columns: b.x:6(int!null)
    │    │    └── keys: (6)
    │    └── filters [type=bool, outer=(1,6)]
    │         └── eq [type=bool, outer=(1,6)]
    │              ├── variable: a.x [type=int, outer=(1)]
    │              └── variable: b.x [type=int, outer=(6)]
    └── projections [outer=(4)]
         └── variable: a.s [type=string, outer=(4)]
--------------------------------------------------------------------------------
ConstrainScan (higher cost)
--------------------------------------------------------------------------------
   project
    ├── columns: s:4(string)
    ├── inner-join
    │    ├── columns: a.x:1(int!null) a.s:4(string) b.x:6(int!null)
    │    ├── project
    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
    │    │    ├── keys: (1)
    │    │    ├── select
    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
    │    │    │    ├── keys: (1)
  - │    │    │    ├── lookup-join
  + │    │    │    ├── scan a
    │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
  - │    │    │    │    ├── table: a
  - │    │    │    │    ├── keys: (1)
  - │    │    │    │    └── scan a@secondary
  - │    │    │    │         ├── columns: a.x:1(int!null) a.s:4(string)
  - │    │    │    │         └── keys: (1)
  + │    │    │    │    └── keys: (1)
    │    │    │    └── filters [type=bool, outer=(2)]
    │    │    │         └── eq [type=bool, outer=(2)]
    │    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │    │              └── minus [type=int]
    │    │    │                   ├── const: 10 [type=int]
    │    │    │                   └── const: 1 [type=int]
    │    │    └── projections [outer=(1,4)]
    │    │         ├── variable: a.x [type=int, outer=(1)]
    │    │         └── variable: a.s [type=string, outer=(4)]
    │    ├── scan b
    │    │    ├── columns: b.x:6(int!null)
    │    │    └── keys: (6)
    │    └── filters [type=bool, outer=(1,6)]
    │         └── eq [type=bool, outer=(1,6)]
    │              ├── variable: a.x [type=int, outer=(1)]
    │              └── variable: b.x [type=int, outer=(6)]
    └── projections [outer=(4)]
         └── variable: a.s [type=string, outer=(4)]
--------------------------------------------------------------------------------
GenerateIndexScans (no changes)
--------------------------------------------------------------------------------
================================================================================
Final best expression
  Cost: 2100.00
================================================================================
  project
   ├── columns: s:4(string)
   ├── inner-join
   │    ├── columns: a.x:1(int!null) a.s:4(string) b.x:6(int!null)
   │    ├── project
   │    │    ├── columns: a.x:1(int!null) a.s:4(string)
   │    │    ├── keys: (1)
   │    │    ├── select
   │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
   │    │    │    ├── keys: (1)
   │    │    │    ├── scan a
   │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.s:4(string)
   │    │    │    │    └── keys: (1)
   │    │    │    └── filters [type=bool, outer=(2)]
   │    │    │         └── eq [type=bool, outer=(2)]
   │    │    │              ├── variable: a.i [type=int, outer=(2)]
   │    │    │              └── minus [type=int]
   │    │    │                   ├── const: 10 [type=int]
   │    │    │                   └── const: 1 [type=int]
   │    │    └── projections [outer=(1,4)]
   │    │         ├── variable: a.x [type=int, outer=(1)]
   │    │         └── variable: a.s [type=string, outer=(4)]
   │    ├── scan b
   │    │    ├── columns: b.x:6(int!null)
   │    │    └── keys: (6)
   │    └── filters [type=bool, outer=(1,6)]
   │         └── eq [type=bool, outer=(1,6)]
   │              ├── variable: a.x [type=int, outer=(1)]
   │              └── variable: b.x [type=int, outer=(6)]
   └── projections [outer=(4)]
        └── variable: a.s [type=string, outer=(4)]


# Select/Project/Limit/Offset rules have cyclical dependencies.
optsteps
SELECT i, i+1 FROM a FULL JOIN b ON a.x=b.x WHERE i=10 ORDER BY i LIMIT 5 OFFSET 1
----
================================================================================
Initial expression
  Cost: 14500.00
================================================================================
  limit
   ├── columns: i:2(int) column8:8(int)
   ├── ordering: +2
   ├── offset
   │    ├── columns: a.i:2(int) column8:8(int)
   │    ├── ordering: +2
   │    ├── sort
   │    │    ├── columns: a.i:2(int) column8:8(int)
   │    │    ├── ordering: +2
   │    │    └── project
   │    │         ├── columns: a.i:2(int) column8:8(int)
   │    │         ├── select
   │    │         │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
   │    │         │    ├── full-join
   │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
   │    │         │    │    ├── scan a
   │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
   │    │         │    │    │    └── keys: (1) weak(3,4)
   │    │         │    │    ├── scan b
   │    │         │    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
   │    │         │    │    │    └── keys: (6)
   │    │         │    │    └── eq [type=bool, outer=(1,6)]
   │    │         │    │         ├── variable: a.x [type=int, outer=(1)]
   │    │         │    │         └── variable: b.x [type=int, outer=(6)]
   │    │         │    └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
   │    │         │         ├── variable: a.i [type=int, outer=(2)]
   │    │         │         └── const: 10 [type=int]
   │    │         └── projections [outer=(2)]
   │    │              ├── variable: a.i [type=int, outer=(2)]
   │    │              └── plus [type=int, outer=(2)]
   │    │                   ├── variable: a.i [type=int, outer=(2)]
   │    │                   └── const: 1 [type=int]
   │    └── const: 1 [type=int]
   └── const: 5 [type=int]
================================================================================
EnsureJoinFilters
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
    │    │         ├── select
    │    │         │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
    │    │         │    ├── full-join
    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
    │    │         │    │    ├── scan a
    │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    │         │    │    │    └── keys: (1) weak(3,4)
    │    │         │    │    ├── scan b
    │    │         │    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    │         │    │    │    └── keys: (6)
  - │    │         │    │    └── eq [type=bool, outer=(1,6)]
  - │    │         │    │         ├── variable: a.x [type=int, outer=(1)]
  - │    │         │    │         └── variable: b.x [type=int, outer=(6)]
  + │    │         │    │    └── filters [type=bool, outer=(1,6)]
  + │    │         │    │         └── eq [type=bool, outer=(1,6)]
  + │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
  + │    │         │    │              └── variable: b.x [type=int, outer=(6)]
    │    │         │    └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │         │         ├── variable: a.i [type=int, outer=(2)]
    │    │         │         └── const: 10 [type=int]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
EnsureSelectFilters
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
    │    │         ├── select
    │    │         │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
    │    │         │    ├── full-join
    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
    │    │         │    │    ├── scan a
    │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    │         │    │    │    └── keys: (1) weak(3,4)
    │    │         │    │    ├── scan b
    │    │         │    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    │         │    │    │    └── keys: (6)
    │    │         │    │    └── filters [type=bool, outer=(1,6)]
    │    │         │    │         └── eq [type=bool, outer=(1,6)]
    │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
    │    │         │    │              └── variable: b.x [type=int, outer=(6)]
  - │    │         │    └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │         ├── variable: a.i [type=int, outer=(2)]
  - │    │         │         └── const: 10 [type=int]
  + │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │              ├── variable: a.i [type=int, outer=(2)]
  + │    │         │              └── const: 10 [type=int]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
FilterUnusedSelectCols
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
    │    │         ├── select
  - │    │         │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
  - │    │         │    ├── full-join
  - │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
  - │    │         │    │    ├── scan a
  - │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    │         │    │    │    └── keys: (1) weak(3,4)
  - │    │         │    │    ├── scan b
  - │    │         │    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
  - │    │         │    │    │    └── keys: (6)
  - │    │         │    │    └── filters [type=bool, outer=(1,6)]
  - │    │         │    │         └── eq [type=bool, outer=(1,6)]
  - │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
  - │    │         │    │              └── variable: b.x [type=int, outer=(6)]
  + │    │         │    ├── columns: a.i:2(int)
  + │    │         │    ├── project
  + │    │         │    │    ├── columns: a.i:2(int)
  + │    │         │    │    ├── full-join
  + │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
  + │    │         │    │    │    ├── scan a
  + │    │         │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  + │    │         │    │    │    │    └── keys: (1) weak(3,4)
  + │    │         │    │    │    ├── scan b
  + │    │         │    │    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
  + │    │         │    │    │    │    └── keys: (6)
  + │    │         │    │    │    └── filters [type=bool, outer=(1,6)]
  + │    │         │    │    │         └── eq [type=bool, outer=(1,6)]
  + │    │         │    │    │              ├── variable: a.x [type=int, outer=(1)]
  + │    │         │    │    │              └── variable: b.x [type=int, outer=(6)]
  + │    │         │    │    └── projections [outer=(2)]
  + │    │         │    │         └── variable: a.i [type=int, outer=(2)]
    │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │         │              ├── variable: a.i [type=int, outer=(2)]
    │    │         │              └── const: 10 [type=int]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
FilterUnusedJoinLeftCols
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
    │    │         ├── select
    │    │         │    ├── columns: a.i:2(int)
    │    │         │    ├── project
    │    │         │    │    ├── columns: a.i:2(int)
    │    │         │    │    ├── full-join
  - │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb) b.x:6(int) b.z:7(int)
  + │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int) b.z:7(int)
    │    │         │    │    │    ├── scan a
  - │    │         │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    │         │    │    │    │    └── keys: (1) weak(3,4)
  + │    │         │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  + │    │         │    │    │    │    └── keys: (1)
    │    │         │    │    │    ├── scan b
    │    │         │    │    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    │         │    │    │    │    └── keys: (6)
    │    │         │    │    │    └── filters [type=bool, outer=(1,6)]
    │    │         │    │    │         └── eq [type=bool, outer=(1,6)]
    │    │         │    │    │              ├── variable: a.x [type=int, outer=(1)]
    │    │         │    │    │              └── variable: b.x [type=int, outer=(6)]
    │    │         │    │    └── projections [outer=(2)]
    │    │         │    │         └── variable: a.i [type=int, outer=(2)]
    │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │         │              ├── variable: a.i [type=int, outer=(2)]
    │    │         │              └── const: 10 [type=int]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
FilterUnusedJoinRightCols
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
    │    │         ├── select
    │    │         │    ├── columns: a.i:2(int)
    │    │         │    ├── project
    │    │         │    │    ├── columns: a.i:2(int)
    │    │         │    │    ├── full-join
  - │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int) b.z:7(int)
  + │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
    │    │         │    │    │    ├── scan a
    │    │         │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
    │    │         │    │    │    │    └── keys: (1)
    │    │         │    │    │    ├── scan b
  - │    │         │    │    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
  + │    │         │    │    │    │    ├── columns: b.x:6(int!null)
    │    │         │    │    │    │    └── keys: (6)
    │    │         │    │    │    └── filters [type=bool, outer=(1,6)]
    │    │         │    │    │         └── eq [type=bool, outer=(1,6)]
    │    │         │    │    │              ├── variable: a.x [type=int, outer=(1)]
    │    │         │    │    │              └── variable: b.x [type=int, outer=(6)]
    │    │         │    │    └── projections [outer=(2)]
    │    │         │    │         └── variable: a.i [type=int, outer=(2)]
    │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │         │              ├── variable: a.i [type=int, outer=(2)]
    │    │         │              └── const: 10 [type=int]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
PushSelectIntoProject
  Cost: 13250.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
    │    │         ├── select
    │    │         │    ├── columns: a.i:2(int)
    │    │         │    ├── project
    │    │         │    │    ├── columns: a.i:2(int)
  - │    │         │    │    ├── full-join
  + │    │         │    │    ├── select
    │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    │    │    ├── scan a
  - │    │         │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  - │    │         │    │    │    │    └── keys: (1)
  - │    │         │    │    │    ├── scan b
  - │    │         │    │    │    │    ├── columns: b.x:6(int!null)
  - │    │         │    │    │    │    └── keys: (6)
  - │    │         │    │    │    └── filters [type=bool, outer=(1,6)]
  - │    │         │    │    │         └── eq [type=bool, outer=(1,6)]
  - │    │         │    │    │              ├── variable: a.x [type=int, outer=(1)]
  - │    │         │    │    │              └── variable: b.x [type=int, outer=(6)]
  + │    │         │    │    │    ├── full-join
  + │    │         │    │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │         │    │    │    │    ├── scan a
  + │    │         │    │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  + │    │         │    │    │    │    │    └── keys: (1)
  + │    │         │    │    │    │    ├── scan b
  + │    │         │    │    │    │    │    ├── columns: b.x:6(int!null)
  + │    │         │    │    │    │    │    └── keys: (6)
  + │    │         │    │    │    │    └── filters [type=bool, outer=(1,6)]
  + │    │         │    │    │    │         └── eq [type=bool, outer=(1,6)]
  + │    │         │    │    │    │              ├── variable: a.x [type=int, outer=(1)]
  + │    │         │    │    │    │              └── variable: b.x [type=int, outer=(6)]
  + │    │         │    │    │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │    │    │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │    │    │              ├── variable: a.i [type=int, outer=(2)]
  + │    │         │    │    │              └── const: 10 [type=int]
    │    │         │    │    └── projections [outer=(2)]
    │    │         │    │         └── variable: a.i [type=int, outer=(2)]
  - │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │              ├── variable: a.i [type=int, outer=(2)]
  - │    │         │              └── const: 10 [type=int]
  + │    │         │    └── filters [type=bool]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
EliminateEmptyAnd
  Cost: 13250.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
    │    │         ├── select
    │    │         │    ├── columns: a.i:2(int)
    │    │         │    ├── project
    │    │         │    │    ├── columns: a.i:2(int)
    │    │         │    │    ├── select
    │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
    │    │         │    │    │    ├── full-join
    │    │         │    │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
    │    │         │    │    │    │    ├── scan a
    │    │         │    │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
    │    │         │    │    │    │    │    └── keys: (1)
    │    │         │    │    │    │    ├── scan b
    │    │         │    │    │    │    │    ├── columns: b.x:6(int!null)
    │    │         │    │    │    │    │    └── keys: (6)
    │    │         │    │    │    │    └── filters [type=bool, outer=(1,6)]
    │    │         │    │    │    │         └── eq [type=bool, outer=(1,6)]
    │    │         │    │    │    │              ├── variable: a.x [type=int, outer=(1)]
    │    │         │    │    │    │              └── variable: b.x [type=int, outer=(6)]
    │    │         │    │    │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │         │    │    │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │         │    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │         │    │    │              └── const: 10 [type=int]
    │    │         │    │    └── projections [outer=(2)]
    │    │         │    │         └── variable: a.i [type=int, outer=(2)]
  - │    │         │    └── filters [type=bool]
  + │    │         │    └── true [type=bool]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
EliminateSelect
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
  - │    │         ├── select
  + │    │         ├── project
    │    │         │    ├── columns: a.i:2(int)
  - │    │         │    ├── project
  - │    │         │    │    ├── columns: a.i:2(int)
  - │    │         │    │    ├── select
  + │    │         │    ├── select
  + │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │         │    │    ├── full-join
    │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    │    │    ├── full-join
  - │    │         │    │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    │    │    │    ├── scan a
  - │    │         │    │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  - │    │         │    │    │    │    │    └── keys: (1)
  - │    │         │    │    │    │    ├── scan b
  - │    │         │    │    │    │    │    ├── columns: b.x:6(int!null)
  - │    │         │    │    │    │    │    └── keys: (6)
  - │    │         │    │    │    │    └── filters [type=bool, outer=(1,6)]
  - │    │         │    │    │    │         └── eq [type=bool, outer=(1,6)]
  - │    │         │    │    │    │              ├── variable: a.x [type=int, outer=(1)]
  - │    │         │    │    │    │              └── variable: b.x [type=int, outer=(6)]
  - │    │         │    │    │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │    │    │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │    │    │              ├── variable: a.i [type=int, outer=(2)]
  - │    │         │    │    │              └── const: 10 [type=int]
  - │    │         │    │    └── projections [outer=(2)]
  - │    │         │    │         └── variable: a.i [type=int, outer=(2)]
  - │    │         │    └── true [type=bool]
  + │    │         │    │    │    ├── scan a
  + │    │         │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  + │    │         │    │    │    │    └── keys: (1)
  + │    │         │    │    │    ├── scan b
  + │    │         │    │    │    │    ├── columns: b.x:6(int!null)
  + │    │         │    │    │    │    └── keys: (6)
  + │    │         │    │    │    └── filters [type=bool, outer=(1,6)]
  + │    │         │    │    │         └── eq [type=bool, outer=(1,6)]
  + │    │         │    │    │              ├── variable: a.x [type=int, outer=(1)]
  + │    │         │    │    │              └── variable: b.x [type=int, outer=(6)]
  + │    │         │    │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │    │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │    │              ├── variable: a.i [type=int, outer=(2)]
  + │    │         │    │              └── const: 10 [type=int]
  + │    │         │    └── projections [outer=(2)]
  + │    │         │         └── variable: a.i [type=int, outer=(2)]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
EliminateProjectProject
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
  - │    │         ├── project
  - │    │         │    ├── columns: a.i:2(int)
  - │    │         │    ├── select
  + │    │         ├── select
  + │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │         │    ├── full-join
    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    │    ├── full-join
  - │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    │    │    ├── scan a
  - │    │         │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  - │    │         │    │    │    │    └── keys: (1)
  - │    │         │    │    │    ├── scan b
  - │    │         │    │    │    │    ├── columns: b.x:6(int!null)
  - │    │         │    │    │    │    └── keys: (6)
  - │    │         │    │    │    └── filters [type=bool, outer=(1,6)]
  - │    │         │    │    │         └── eq [type=bool, outer=(1,6)]
  - │    │         │    │    │              ├── variable: a.x [type=int, outer=(1)]
  - │    │         │    │    │              └── variable: b.x [type=int, outer=(6)]
  - │    │         │    │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │    │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │    │              ├── variable: a.i [type=int, outer=(2)]
  - │    │         │    │              └── const: 10 [type=int]
  - │    │         │    └── projections [outer=(2)]
  - │    │         │         └── variable: a.i [type=int, outer=(2)]
  + │    │         │    │    ├── scan a
  + │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  + │    │         │    │    │    └── keys: (1)
  + │    │         │    │    ├── scan b
  + │    │         │    │    │    ├── columns: b.x:6(int!null)
  + │    │         │    │    │    └── keys: (6)
  + │    │         │    │    └── filters [type=bool, outer=(1,6)]
  + │    │         │    │         └── eq [type=bool, outer=(1,6)]
  + │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
  + │    │         │    │              └── variable: b.x [type=int, outer=(6)]
  + │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │              ├── variable: a.i [type=int, outer=(2)]
  + │    │         │              └── const: 10 [type=int]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
FilterUnusedSelectCols
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
  - │    │         ├── select
  - │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    ├── full-join
  + │    │         ├── project
  + │    │         │    ├── columns: a.i:2(int)
  + │    │         │    ├── select
    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    │    ├── scan a
  - │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  - │    │         │    │    │    └── keys: (1)
  - │    │         │    │    ├── scan b
  - │    │         │    │    │    ├── columns: b.x:6(int!null)
  - │    │         │    │    │    └── keys: (6)
  - │    │         │    │    └── filters [type=bool, outer=(1,6)]
  - │    │         │    │         └── eq [type=bool, outer=(1,6)]
  - │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
  - │    │         │    │              └── variable: b.x [type=int, outer=(6)]
  - │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │              ├── variable: a.i [type=int, outer=(2)]
  - │    │         │              └── const: 10 [type=int]
  + │    │         │    │    ├── full-join
  + │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │         │    │    │    ├── scan a
  + │    │         │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  + │    │         │    │    │    │    └── keys: (1)
  + │    │         │    │    │    ├── scan b
  + │    │         │    │    │    │    ├── columns: b.x:6(int!null)
  + │    │         │    │    │    │    └── keys: (6)
  + │    │         │    │    │    └── filters [type=bool, outer=(1,6)]
  + │    │         │    │    │         └── eq [type=bool, outer=(1,6)]
  + │    │         │    │    │              ├── variable: a.x [type=int, outer=(1)]
  + │    │         │    │    │              └── variable: b.x [type=int, outer=(6)]
  + │    │         │    │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │    │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │    │              ├── variable: a.i [type=int, outer=(2)]
  + │    │         │    │              └── const: 10 [type=int]
  + │    │         │    └── projections [outer=(2)]
  + │    │         │         └── variable: a.i [type=int, outer=(2)]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
EliminateProjectProject
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── offset
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── sort
    │    │    ├── columns: a.i:2(int) column8:8(int)
    │    │    ├── ordering: +2
    │    │    └── project
    │    │         ├── columns: a.i:2(int) column8:8(int)
  - │    │         ├── project
  - │    │         │    ├── columns: a.i:2(int)
  - │    │         │    ├── select
  + │    │         ├── select
  + │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │         │    ├── full-join
    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    │    ├── full-join
  - │    │         │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    │    │    ├── scan a
  - │    │         │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  - │    │         │    │    │    │    └── keys: (1)
  - │    │         │    │    │    ├── scan b
  - │    │         │    │    │    │    ├── columns: b.x:6(int!null)
  - │    │         │    │    │    │    └── keys: (6)
  - │    │         │    │    │    └── filters [type=bool, outer=(1,6)]
  - │    │         │    │    │         └── eq [type=bool, outer=(1,6)]
  - │    │         │    │    │              ├── variable: a.x [type=int, outer=(1)]
  - │    │         │    │    │              └── variable: b.x [type=int, outer=(6)]
  - │    │         │    │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │    │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │    │              ├── variable: a.i [type=int, outer=(2)]
  - │    │         │    │              └── const: 10 [type=int]
  - │    │         │    └── projections [outer=(2)]
  - │    │         │         └── variable: a.i [type=int, outer=(2)]
  + │    │         │    │    ├── scan a
  + │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  + │    │         │    │    │    └── keys: (1)
  + │    │         │    │    ├── scan b
  + │    │         │    │    │    ├── columns: b.x:6(int!null)
  + │    │         │    │    │    └── keys: (6)
  + │    │         │    │    └── filters [type=bool, outer=(1,6)]
  + │    │         │    │         └── eq [type=bool, outer=(1,6)]
  + │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
  + │    │         │    │              └── variable: b.x [type=int, outer=(6)]
  + │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │         │              ├── variable: a.i [type=int, outer=(2)]
  + │    │         │              └── const: 10 [type=int]
    │    │         └── projections [outer=(2)]
    │    │              ├── variable: a.i [type=int, outer=(2)]
    │    │              └── plus [type=int, outer=(2)]
    │    │                   ├── variable: a.i [type=int, outer=(2)]
    │    │                   └── const: 1 [type=int]
    │    └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
PushOffsetIntoProject
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
  - ├── offset
  + ├── project
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
  - │    ├── sort
  - │    │    ├── columns: a.i:2(int) column8:8(int)
  + │    ├── offset
  + │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
    │    │    ├── ordering: +2
  - │    │    └── project
  - │    │         ├── columns: a.i:2(int) column8:8(int)
  - │    │         ├── select
  - │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    ├── full-join
  - │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │         │    │    ├── scan a
  - │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  - │    │         │    │    │    └── keys: (1)
  - │    │         │    │    ├── scan b
  - │    │         │    │    │    ├── columns: b.x:6(int!null)
  - │    │         │    │    │    └── keys: (6)
  - │    │         │    │    └── filters [type=bool, outer=(1,6)]
  - │    │         │    │         └── eq [type=bool, outer=(1,6)]
  - │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
  - │    │         │    │              └── variable: b.x [type=int, outer=(6)]
  - │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │         │              ├── variable: a.i [type=int, outer=(2)]
  - │    │         │              └── const: 10 [type=int]
  - │    │         └── projections [outer=(2)]
  - │    │              ├── variable: a.i [type=int, outer=(2)]
  - │    │              └── plus [type=int, outer=(2)]
  - │    │                   ├── variable: a.i [type=int, outer=(2)]
  - │    │                   └── const: 1 [type=int]
  - │    └── const: 1 [type=int]
  + │    │    ├── sort
  + │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │    │    ├── ordering: +2
  + │    │    │    └── select
  + │    │    │         ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │    │         ├── full-join
  + │    │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │    │         │    ├── scan a
  + │    │    │         │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  + │    │    │         │    │    └── keys: (1)
  + │    │    │         │    ├── scan b
  + │    │    │         │    │    ├── columns: b.x:6(int!null)
  + │    │    │         │    │    └── keys: (6)
  + │    │    │         │    └── filters [type=bool, outer=(1,6)]
  + │    │    │         │         └── eq [type=bool, outer=(1,6)]
  + │    │    │         │              ├── variable: a.x [type=int, outer=(1)]
  + │    │    │         │              └── variable: b.x [type=int, outer=(6)]
  + │    │    │         └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │    │              └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │    │                   ├── variable: a.i [type=int, outer=(2)]
  + │    │    │                   └── const: 10 [type=int]
  + │    │    └── const: 1 [type=int]
  + │    └── projections [outer=(2)]
  + │         ├── variable: a.i [type=int, outer=(2)]
  + │         └── plus [type=int, outer=(2)]
  + │              ├── variable: a.i [type=int, outer=(2)]
  + │              └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
FilterUnusedOffsetCols
  Cost: 14500.00
================================================================================
   limit
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── project
    │    ├── columns: a.i:2(int) column8:8(int)
    │    ├── ordering: +2
    │    ├── offset
  - │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │    ├── columns: a.i:2(int)
    │    │    ├── ordering: +2
    │    │    ├── sort
  - │    │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │    │    ├── columns: a.i:2(int)
    │    │    │    ├── ordering: +2
  - │    │    │    └── select
  - │    │    │         ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │    │         ├── full-join
  + │    │    │    └── project
  + │    │    │         ├── columns: a.i:2(int)
  + │    │    │         ├── select
    │    │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │    │         │    ├── scan a
  - │    │    │         │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  - │    │    │         │    │    └── keys: (1)
  - │    │    │         │    ├── scan b
  - │    │    │         │    │    ├── columns: b.x:6(int!null)
  - │    │    │         │    │    └── keys: (6)
  - │    │    │         │    └── filters [type=bool, outer=(1,6)]
  - │    │    │         │         └── eq [type=bool, outer=(1,6)]
  - │    │    │         │              ├── variable: a.x [type=int, outer=(1)]
  - │    │    │         │              └── variable: b.x [type=int, outer=(6)]
  - │    │    │         └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │    │              └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  - │    │    │                   ├── variable: a.i [type=int, outer=(2)]
  - │    │    │                   └── const: 10 [type=int]
  + │    │    │         │    ├── full-join
  + │    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  + │    │    │         │    │    ├── scan a
  + │    │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  + │    │    │         │    │    │    └── keys: (1)
  + │    │    │         │    │    ├── scan b
  + │    │    │         │    │    │    ├── columns: b.x:6(int!null)
  + │    │    │         │    │    │    └── keys: (6)
  + │    │    │         │    │    └── filters [type=bool, outer=(1,6)]
  + │    │    │         │    │         └── eq [type=bool, outer=(1,6)]
  + │    │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
  + │    │    │         │    │              └── variable: b.x [type=int, outer=(6)]
  + │    │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
  + │    │    │         │              ├── variable: a.i [type=int, outer=(2)]
  + │    │    │         │              └── const: 10 [type=int]
  + │    │    │         └── projections [outer=(2)]
  + │    │    │              └── variable: a.i [type=int, outer=(2)]
    │    │    └── const: 1 [type=int]
    │    └── projections [outer=(2)]
    │         ├── variable: a.i [type=int, outer=(2)]
    │         └── plus [type=int, outer=(2)]
    │              ├── variable: a.i [type=int, outer=(2)]
    │              └── const: 1 [type=int]
    └── const: 5 [type=int]
================================================================================
PushLimitIntoProject
  Cost: 14500.00
================================================================================
  -limit
  +project
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
  - ├── project
  - │    ├── columns: a.i:2(int) column8:8(int)
  + ├── limit
  + │    ├── columns: a.i:2(int)
    │    ├── ordering: +2
    │    ├── offset
    │    │    ├── columns: a.i:2(int)
    │    │    ├── ordering: +2
    │    │    ├── sort
    │    │    │    ├── columns: a.i:2(int)
    │    │    │    ├── ordering: +2
    │    │    │    └── project
    │    │    │         ├── columns: a.i:2(int)
    │    │    │         ├── select
    │    │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
    │    │    │         │    ├── full-join
    │    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
    │    │    │         │    │    ├── scan a
    │    │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
    │    │    │         │    │    │    └── keys: (1)
    │    │    │         │    │    ├── scan b
    │    │    │         │    │    │    ├── columns: b.x:6(int!null)
    │    │    │         │    │    │    └── keys: (6)
    │    │    │         │    │    └── filters [type=bool, outer=(1,6)]
    │    │    │         │    │         └── eq [type=bool, outer=(1,6)]
    │    │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
    │    │    │         │    │              └── variable: b.x [type=int, outer=(6)]
    │    │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │    │         │              ├── variable: a.i [type=int, outer=(2)]
    │    │    │         │              └── const: 10 [type=int]
    │    │    │         └── projections [outer=(2)]
    │    │    │              └── variable: a.i [type=int, outer=(2)]
    │    │    └── const: 1 [type=int]
  - │    └── projections [outer=(2)]
  - │         ├── variable: a.i [type=int, outer=(2)]
  - │         └── plus [type=int, outer=(2)]
  - │              ├── variable: a.i [type=int, outer=(2)]
  - │              └── const: 1 [type=int]
  - └── const: 5 [type=int]
  + │    └── const: 5 [type=int]
  + └── projections [outer=(2)]
  +      ├── variable: a.i [type=int, outer=(2)]
  +      └── plus [type=int, outer=(2)]
  +           ├── variable: a.i [type=int, outer=(2)]
  +           └── const: 1 [type=int]
--------------------------------------------------------------------------------
GenerateIndexScans (higher cost)
--------------------------------------------------------------------------------
   project
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── limit
    │    ├── columns: a.i:2(int)
    │    ├── ordering: +2
    │    ├── offset
    │    │    ├── columns: a.i:2(int)
    │    │    ├── ordering: +2
    │    │    ├── sort
    │    │    │    ├── columns: a.i:2(int)
    │    │    │    ├── ordering: +2
    │    │    │    └── project
    │    │    │         ├── columns: a.i:2(int)
    │    │    │         ├── select
    │    │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
    │    │    │         │    ├── full-join
    │    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │    │         │    │    ├── scan a
  + │    │    │         │    │    ├── lookup-join
    │    │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  - │    │    │         │    │    │    └── keys: (1)
  + │    │    │         │    │    │    ├── table: a
  + │    │    │         │    │    │    ├── keys: (1)
  + │    │    │         │    │    │    └── scan a@secondary
  + │    │    │         │    │    │         ├── columns: a.x:1(int!null)
  + │    │    │         │    │    │         └── keys: (1)
    │    │    │         │    │    ├── scan b
    │    │    │         │    │    │    ├── columns: b.x:6(int!null)
    │    │    │         │    │    │    └── keys: (6)
    │    │    │         │    │    └── filters [type=bool, outer=(1,6)]
    │    │    │         │    │         └── eq [type=bool, outer=(1,6)]
    │    │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
    │    │    │         │    │              └── variable: b.x [type=int, outer=(6)]
    │    │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │    │         │              ├── variable: a.i [type=int, outer=(2)]
    │    │    │         │              └── const: 10 [type=int]
    │    │    │         └── projections [outer=(2)]
    │    │    │              └── variable: a.i [type=int, outer=(2)]
    │    │    └── const: 1 [type=int]
    │    └── const: 5 [type=int]
    └── projections [outer=(2)]
         ├── variable: a.i [type=int, outer=(2)]
         └── plus [type=int, outer=(2)]
              ├── variable: a.i [type=int, outer=(2)]
              └── const: 1 [type=int]
--------------------------------------------------------------------------------
GenerateIndexScans (higher cost)
--------------------------------------------------------------------------------
   project
    ├── columns: i:2(int) column8:8(int)
    ├── ordering: +2
    ├── limit
    │    ├── columns: a.i:2(int)
    │    ├── ordering: +2
    │    ├── offset
    │    │    ├── columns: a.i:2(int)
    │    │    ├── ordering: +2
    │    │    ├── sort
    │    │    │    ├── columns: a.i:2(int)
    │    │    │    ├── ordering: +2
    │    │    │    └── project
    │    │    │         ├── columns: a.i:2(int)
    │    │    │         ├── select
    │    │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
    │    │    │         │    ├── full-join
    │    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
  - │    │    │         │    │    ├── lookup-join
  + │    │    │         │    │    ├── scan a
    │    │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
  - │    │    │         │    │    │    ├── table: a
  - │    │    │         │    │    │    ├── keys: (1)
  - │    │    │         │    │    │    └── scan a@secondary
  - │    │    │         │    │    │         ├── columns: a.x:1(int!null)
  - │    │    │         │    │    │         └── keys: (1)
  + │    │    │         │    │    │    └── keys: (1)
    │    │    │         │    │    ├── scan b
    │    │    │         │    │    │    ├── columns: b.x:6(int!null)
    │    │    │         │    │    │    └── keys: (6)
    │    │    │         │    │    └── filters [type=bool, outer=(1,6)]
    │    │    │         │    │         └── eq [type=bool, outer=(1,6)]
    │    │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
    │    │    │         │    │              └── variable: b.x [type=int, outer=(6)]
    │    │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
    │    │    │         │              ├── variable: a.i [type=int, outer=(2)]
    │    │    │         │              └── const: 10 [type=int]
    │    │    │         └── projections [outer=(2)]
    │    │    │              └── variable: a.i [type=int, outer=(2)]
    │    │    └── const: 1 [type=int]
    │    └── const: 5 [type=int]
    └── projections [outer=(2)]
         ├── variable: a.i [type=int, outer=(2)]
         └── plus [type=int, outer=(2)]
              ├── variable: a.i [type=int, outer=(2)]
              └── const: 1 [type=int]
================================================================================
Final best expression
  Cost: 14500.00
================================================================================
  project
   ├── columns: i:2(int) column8:8(int)
   ├── ordering: +2
   ├── limit
   │    ├── columns: a.i:2(int)
   │    ├── ordering: +2
   │    ├── offset
   │    │    ├── columns: a.i:2(int)
   │    │    ├── ordering: +2
   │    │    ├── sort
   │    │    │    ├── columns: a.i:2(int)
   │    │    │    ├── ordering: +2
   │    │    │    └── project
   │    │    │         ├── columns: a.i:2(int)
   │    │    │         ├── select
   │    │    │         │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
   │    │    │         │    ├── full-join
   │    │    │         │    │    ├── columns: a.x:1(int) a.i:2(int) b.x:6(int)
   │    │    │         │    │    ├── scan a
   │    │    │         │    │    │    ├── columns: a.x:1(int!null) a.i:2(int)
   │    │    │         │    │    │    └── keys: (1)
   │    │    │         │    │    ├── scan b
   │    │    │         │    │    │    ├── columns: b.x:6(int!null)
   │    │    │         │    │    │    └── keys: (6)
   │    │    │         │    │    └── filters [type=bool, outer=(1,6)]
   │    │    │         │    │         └── eq [type=bool, outer=(1,6)]
   │    │    │         │    │              ├── variable: a.x [type=int, outer=(1)]
   │    │    │         │    │              └── variable: b.x [type=int, outer=(6)]
   │    │    │         │    └── filters [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
   │    │    │         │         └── eq [type=bool, outer=(2), constraints=(/2: [/10 - /10]; tight)]
   │    │    │         │              ├── variable: a.i [type=int, outer=(2)]
   │    │    │         │              └── const: 10 [type=int]
   │    │    │         └── projections [outer=(2)]
   │    │    │              └── variable: a.i [type=int, outer=(2)]
   │    │    └── const: 1 [type=int]
   │    └── const: 5 [type=int]
   └── projections [outer=(2)]
        ├── variable: a.i [type=int, outer=(2)]
        └── plus [type=int, outer=(2)]
             ├── variable: a.i [type=int, outer=(2)]
             └── const: 1 [type=int]


# Cyclical rules that trigger assert in AddAltFingerprint without extra code to
# check whether nested rule has already called AddAltFingerprint.
optsteps
SELECT SUM(x) FROM a GROUP BY s, x HAVING SUM(x)=1
----
================================================================================
Initial expression
  Cost: 1010.00
================================================================================
  project
   ├── columns: column6:6(decimal)
   ├── select
   │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
   │    ├── keys: (1)
   │    ├── group-by
   │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
   │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
   │    │    ├── keys: (1)
   │    │    ├── project
   │    │    │    ├── columns: a.s:4(string) a.x:1(int!null)
   │    │    │    ├── keys: (1)
   │    │    │    ├── scan a
   │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
   │    │    │    │    └── keys: (1) weak(3,4)
   │    │    │    └── projections [outer=(1,4)]
   │    │    │         ├── variable: a.s [type=string, outer=(4)]
   │    │    │         └── variable: a.x [type=int, outer=(1)]
   │    │    └── aggregations [outer=(1)]
   │    │         └── function: sum [type=decimal, outer=(1)]
   │    │              └── variable: a.x [type=int, outer=(1)]
   │    └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
   │         ├── variable: column6 [type=decimal, outer=(6)]
   │         └── const: 1 [type=decimal]
   └── projections [outer=(6)]
        └── variable: column6 [type=decimal, outer=(6)]
================================================================================
FilterUnusedScanCols
  Cost: 1010.00
================================================================================
   project
    ├── columns: column6:6(decimal)
    ├── select
    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    ├── keys: (1)
    │    ├── group-by
    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
    │    │    ├── keys: (1)
    │    │    ├── project
    │    │    │    ├── columns: a.s:4(string) a.x:1(int!null)
    │    │    │    ├── keys: (1)
    │    │    │    ├── scan a
  - │    │    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    │    │    │    └── keys: (1) weak(3,4)
  + │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  + │    │    │    │    └── keys: (1)
    │    │    │    └── projections [outer=(1,4)]
    │    │    │         ├── variable: a.s [type=string, outer=(4)]
    │    │    │         └── variable: a.x [type=int, outer=(1)]
    │    │    └── aggregations [outer=(1)]
    │    │         └── function: sum [type=decimal, outer=(1)]
    │    │              └── variable: a.x [type=int, outer=(1)]
    │    └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
    │         ├── variable: column6 [type=decimal, outer=(6)]
    │         └── const: 1 [type=decimal]
    └── projections [outer=(6)]
         └── variable: column6 [type=decimal, outer=(6)]
================================================================================
EliminateProject
  Cost: 1010.00
================================================================================
   project
    ├── columns: column6:6(decimal)
    ├── select
    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    ├── keys: (1)
    │    ├── group-by
    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
    │    │    ├── keys: (1)
  - │    │    ├── project
  - │    │    │    ├── columns: a.s:4(string) a.x:1(int!null)
  - │    │    │    ├── keys: (1)
  - │    │    │    ├── scan a
  - │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  - │    │    │    │    └── keys: (1)
  - │    │    │    └── projections [outer=(1,4)]
  - │    │    │         ├── variable: a.s [type=string, outer=(4)]
  - │    │    │         └── variable: a.x [type=int, outer=(1)]
  + │    │    ├── scan a
  + │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  + │    │    │    └── keys: (1)
    │    │    └── aggregations [outer=(1)]
    │    │         └── function: sum [type=decimal, outer=(1)]
    │    │              └── variable: a.x [type=int, outer=(1)]
    │    └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
    │         ├── variable: column6 [type=decimal, outer=(6)]
    │         └── const: 1 [type=decimal]
    └── projections [outer=(6)]
         └── variable: column6 [type=decimal, outer=(6)]
================================================================================
EnsureSelectFilters
  Cost: 1010.00
================================================================================
   project
    ├── columns: column6:6(decimal)
    ├── select
    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    ├── keys: (1)
    │    ├── group-by
    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
    │    │    ├── keys: (1)
    │    │    ├── scan a
    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
    │    │    │    └── keys: (1)
    │    │    └── aggregations [outer=(1)]
    │    │         └── function: sum [type=decimal, outer=(1)]
    │    │              └── variable: a.x [type=int, outer=(1)]
  - │    └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  - │         ├── variable: column6 [type=decimal, outer=(6)]
  - │         └── const: 1 [type=decimal]
  + │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  + │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  + │              ├── variable: column6 [type=decimal, outer=(6)]
  + │              └── const: 1 [type=decimal]
    └── projections [outer=(6)]
         └── variable: column6 [type=decimal, outer=(6)]
================================================================================
FilterUnusedSelectCols
  Cost: 1010.00
================================================================================
   project
    ├── columns: column6:6(decimal)
    ├── select
  - │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  - │    ├── keys: (1)
  - │    ├── group-by
  - │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  - │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
  - │    │    ├── keys: (1)
  - │    │    ├── scan a
  - │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  - │    │    │    └── keys: (1)
  - │    │    └── aggregations [outer=(1)]
  - │    │         └── function: sum [type=decimal, outer=(1)]
  - │    │              └── variable: a.x [type=int, outer=(1)]
  + │    ├── columns: column6:6(decimal)
  + │    ├── project
  + │    │    ├── columns: column6:6(decimal)
  + │    │    ├── group-by
  + │    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  + │    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
  + │    │    │    ├── keys: (1)
  + │    │    │    ├── scan a
  + │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  + │    │    │    │    └── keys: (1)
  + │    │    │    └── aggregations [outer=(1)]
  + │    │    │         └── function: sum [type=decimal, outer=(1)]
  + │    │    │              └── variable: a.x [type=int, outer=(1)]
  + │    │    └── projections [outer=(6)]
  + │    │         └── variable: column6 [type=decimal, outer=(6)]
    │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
    │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
    │              ├── variable: column6 [type=decimal, outer=(6)]
    │              └── const: 1 [type=decimal]
    └── projections [outer=(6)]
         └── variable: column6 [type=decimal, outer=(6)]
================================================================================
PushSelectIntoProject
  Cost: 1011.00
================================================================================
   project
    ├── columns: column6:6(decimal)
    ├── select
    │    ├── columns: column6:6(decimal)
    │    ├── project
    │    │    ├── columns: column6:6(decimal)
  - │    │    ├── group-by
  + │    │    ├── select
    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  - │    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
    │    │    │    ├── keys: (1)
  - │    │    │    ├── scan a
  - │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  - │    │    │    │    └── keys: (1)
  - │    │    │    └── aggregations [outer=(1)]
  - │    │    │         └── function: sum [type=decimal, outer=(1)]
  - │    │    │              └── variable: a.x [type=int, outer=(1)]
  + │    │    │    ├── group-by
  + │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  + │    │    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
  + │    │    │    │    ├── keys: (1)
  + │    │    │    │    ├── scan a
  + │    │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  + │    │    │    │    │    └── keys: (1)
  + │    │    │    │    └── aggregations [outer=(1)]
  + │    │    │    │         └── function: sum [type=decimal, outer=(1)]
  + │    │    │    │              └── variable: a.x [type=int, outer=(1)]
  + │    │    │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  + │    │    │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  + │    │    │              ├── variable: column6 [type=decimal, outer=(6)]
  + │    │    │              └── const: 1 [type=decimal]
    │    │    └── projections [outer=(6)]
    │    │         └── variable: column6 [type=decimal, outer=(6)]
  - │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  - │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  - │              ├── variable: column6 [type=decimal, outer=(6)]
  - │              └── const: 1 [type=decimal]
  + │    └── filters [type=bool]
    └── projections [outer=(6)]
         └── variable: column6 [type=decimal, outer=(6)]
================================================================================
EliminateEmptyAnd
  Cost: 1011.00
================================================================================
   project
    ├── columns: column6:6(decimal)
    ├── select
    │    ├── columns: column6:6(decimal)
    │    ├── project
    │    │    ├── columns: column6:6(decimal)
    │    │    ├── select
    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    │    │    ├── keys: (1)
    │    │    │    ├── group-by
    │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    │    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
    │    │    │    │    ├── keys: (1)
    │    │    │    │    ├── scan a
    │    │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
    │    │    │    │    │    └── keys: (1)
    │    │    │    │    └── aggregations [outer=(1)]
    │    │    │    │         └── function: sum [type=decimal, outer=(1)]
    │    │    │    │              └── variable: a.x [type=int, outer=(1)]
    │    │    │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
    │    │    │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
    │    │    │              ├── variable: column6 [type=decimal, outer=(6)]
    │    │    │              └── const: 1 [type=decimal]
    │    │    └── projections [outer=(6)]
    │    │         └── variable: column6 [type=decimal, outer=(6)]
  - │    └── filters [type=bool]
  + │    └── true [type=bool]
    └── projections [outer=(6)]
         └── variable: column6 [type=decimal, outer=(6)]
================================================================================
EliminateSelect
  Cost: 1010.00
================================================================================
   project
    ├── columns: column6:6(decimal)
  - ├── select
  + ├── project
    │    ├── columns: column6:6(decimal)
  - │    ├── project
  - │    │    ├── columns: column6:6(decimal)
  - │    │    ├── select
  + │    ├── select
  + │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  + │    │    ├── keys: (1)
  + │    │    ├── group-by
    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  + │    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
    │    │    │    ├── keys: (1)
  - │    │    │    ├── group-by
  - │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  - │    │    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
  - │    │    │    │    ├── keys: (1)
  - │    │    │    │    ├── scan a
  - │    │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  - │    │    │    │    │    └── keys: (1)
  - │    │    │    │    └── aggregations [outer=(1)]
  - │    │    │    │         └── function: sum [type=decimal, outer=(1)]
  - │    │    │    │              └── variable: a.x [type=int, outer=(1)]
  - │    │    │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  - │    │    │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  - │    │    │              ├── variable: column6 [type=decimal, outer=(6)]
  - │    │    │              └── const: 1 [type=decimal]
  - │    │    └── projections [outer=(6)]
  - │    │         └── variable: column6 [type=decimal, outer=(6)]
  - │    └── true [type=bool]
  + │    │    │    ├── scan a
  + │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  + │    │    │    │    └── keys: (1)
  + │    │    │    └── aggregations [outer=(1)]
  + │    │    │         └── function: sum [type=decimal, outer=(1)]
  + │    │    │              └── variable: a.x [type=int, outer=(1)]
  + │    │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  + │    │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  + │    │              ├── variable: column6 [type=decimal, outer=(6)]
  + │    │              └── const: 1 [type=decimal]
  + │    └── projections [outer=(6)]
  + │         └── variable: column6 [type=decimal, outer=(6)]
    └── projections [outer=(6)]
         └── variable: column6 [type=decimal, outer=(6)]
================================================================================
EliminateProject
  Cost: 1010.00
================================================================================
   project
    ├── columns: column6:6(decimal)
  - ├── project
  - │    ├── columns: column6:6(decimal)
  - │    ├── select
  + ├── select
  + │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  + │    ├── keys: (1)
  + │    ├── group-by
    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  + │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
    │    │    ├── keys: (1)
  - │    │    ├── group-by
  - │    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
  - │    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
  - │    │    │    ├── keys: (1)
  - │    │    │    ├── scan a
  - │    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  - │    │    │    │    └── keys: (1)
  - │    │    │    └── aggregations [outer=(1)]
  - │    │    │         └── function: sum [type=decimal, outer=(1)]
  - │    │    │              └── variable: a.x [type=int, outer=(1)]
  - │    │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  - │    │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  - │    │              ├── variable: column6 [type=decimal, outer=(6)]
  - │    │              └── const: 1 [type=decimal]
  - │    └── projections [outer=(6)]
  - │         └── variable: column6 [type=decimal, outer=(6)]
  + │    │    ├── scan a
  + │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
  + │    │    │    └── keys: (1)
  + │    │    └── aggregations [outer=(1)]
  + │    │         └── function: sum [type=decimal, outer=(1)]
  + │    │              └── variable: a.x [type=int, outer=(1)]
  + │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  + │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
  + │              ├── variable: column6 [type=decimal, outer=(6)]
  + │              └── const: 1 [type=decimal]
    └── projections [outer=(6)]
         └── variable: column6 [type=decimal, outer=(6)]
--------------------------------------------------------------------------------
GenerateIndexScans (higher cost)
--------------------------------------------------------------------------------
   project
    ├── columns: column6:6(decimal)
    ├── select
    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    ├── keys: (1)
    │    ├── group-by
    │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
    │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
    │    │    ├── keys: (1)
  - │    │    ├── scan a
  + │    │    ├── scan a@secondary
    │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
    │    │    │    └── keys: (1)
    │    │    └── aggregations [outer=(1)]
    │    │         └── function: sum [type=decimal, outer=(1)]
    │    │              └── variable: a.x [type=int, outer=(1)]
    │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
    │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
    │              ├── variable: column6 [type=decimal, outer=(6)]
    │              └── const: 1 [type=decimal]
    └── projections [outer=(6)]
         └── variable: column6 [type=decimal, outer=(6)]
================================================================================
Final best expression
  Cost: 1010.00
================================================================================
  project
   ├── columns: column6:6(decimal)
   ├── select
   │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
   │    ├── keys: (1)
   │    ├── group-by
   │    │    ├── columns: a.x:1(int!null) a.s:4(string) column6:6(decimal)
   │    │    ├── grouping columns: a.x:1(int!null) a.s:4(string)
   │    │    ├── keys: (1)
   │    │    ├── scan a
   │    │    │    ├── columns: a.x:1(int!null) a.s:4(string)
   │    │    │    └── keys: (1)
   │    │    └── aggregations [outer=(1)]
   │    │         └── function: sum [type=decimal, outer=(1)]
   │    │              └── variable: a.x [type=int, outer=(1)]
   │    └── filters [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
   │         └── eq [type=bool, outer=(6), constraints=(/6: [/1 - /1]; tight)]
   │              ├── variable: column6 [type=decimal, outer=(6)]
   │              └── const: 1 [type=decimal]
   └── projections [outer=(6)]
        └── variable: column6 [type=decimal, outer=(6)]

# Exploration patterns with varying costs.
optsteps
SELECT s, x FROM a WHERE s='foo' AND f>100
----
================================================================================
Initial expression
  Cost: 1100.00
================================================================================
  project
   ├── columns: s:4(string) x:1(int!null)
   ├── keys: (1)
   ├── select
   │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
   │    ├── keys: (1) weak(3,4)
   │    ├── scan a
   │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
   │    │    └── keys: (1) weak(3,4)
   │    └── and [type=bool, outer=(3,4), constraints=(/3: [/100.00000000000001 - ]; /4: [/'foo' - /'foo']; tight)]
   │         ├── eq [type=bool, outer=(4), constraints=(/4: [/'foo' - /'foo']; tight)]
   │         │    ├── variable: a.s [type=string, outer=(4)]
   │         │    └── const: 'foo' [type=string]
   │         └── gt [type=bool, outer=(3), constraints=(/3: [/100.00000000000001 - ]; tight)]
   │              ├── variable: a.f [type=float, outer=(3)]
   │              └── const: 100.0 [type=float]
   └── projections [outer=(1,4)]
        ├── variable: a.s [type=string, outer=(4)]
        └── variable: a.x [type=int, outer=(1)]
================================================================================
EnsureSelectFiltersAnd
  Cost: 1100.00
================================================================================
   project
    ├── columns: s:4(string) x:1(int!null)
    ├── keys: (1)
    ├── select
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    ├── keys: (1) weak(3,4)
    │    ├── scan a
    │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    │    └── keys: (1) weak(3,4)
  - │    └── and [type=bool, outer=(3,4), constraints=(/3: [/100.00000000000001 - ]; /4: [/'foo' - /'foo']; tight)]
  + │    └── filters [type=bool, outer=(3,4), constraints=(/3: [/100.00000000000001 - ]; /4: [/'foo' - /'foo']; tight)]
    │         ├── eq [type=bool, outer=(4), constraints=(/4: [/'foo' - /'foo']; tight)]
    │         │    ├── variable: a.s [type=string, outer=(4)]
    │         │    └── const: 'foo' [type=string]
    │         └── gt [type=bool, outer=(3), constraints=(/3: [/100.00000000000001 - ]; tight)]
    │              ├── variable: a.f [type=float, outer=(3)]
    │              └── const: 100.0 [type=float]
    └── projections [outer=(1,4)]
         ├── variable: a.s [type=string, outer=(4)]
         └── variable: a.x [type=int, outer=(1)]
================================================================================
FilterUnusedSelectCols
  Cost: 1100.00
================================================================================
   project
    ├── columns: s:4(string) x:1(int!null)
    ├── keys: (1)
    ├── select
  - │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  + │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
    │    ├── keys: (1) weak(3,4)
    │    ├── scan a
  - │    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  + │    │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
    │    │    └── keys: (1) weak(3,4)
    │    └── filters [type=bool, outer=(3,4), constraints=(/3: [/100.00000000000001 - ]; /4: [/'foo' - /'foo']; tight)]
    │         ├── eq [type=bool, outer=(4), constraints=(/4: [/'foo' - /'foo']; tight)]
    │         │    ├── variable: a.s [type=string, outer=(4)]
    │         │    └── const: 'foo' [type=string]
    │         └── gt [type=bool, outer=(3), constraints=(/3: [/100.00000000000001 - ]; tight)]
    │              ├── variable: a.f [type=float, outer=(3)]
    │              └── const: 100.0 [type=float]
    └── projections [outer=(1,4)]
         ├── variable: a.s [type=string, outer=(4)]
         └── variable: a.x [type=int, outer=(1)]
--------------------------------------------------------------------------------
GenerateIndexScans (higher cost)
--------------------------------------------------------------------------------
   project
    ├── columns: s:4(string) x:1(int!null)
    ├── keys: (1)
    ├── select
    │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
    │    ├── keys: (1) weak(3,4)
  - │    ├── scan a
  + │    ├── scan a@secondary
    │    │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
    │    │    └── keys: (1) weak(3,4)
    │    └── filters [type=bool, outer=(3,4), constraints=(/3: [/100.00000000000001 - ]; /4: [/'foo' - /'foo']; tight)]
    │         ├── eq [type=bool, outer=(4), constraints=(/4: [/'foo' - /'foo']; tight)]
    │         │    ├── variable: a.s [type=string, outer=(4)]
    │         │    └── const: 'foo' [type=string]
    │         └── gt [type=bool, outer=(3), constraints=(/3: [/100.00000000000001 - ]; tight)]
    │              ├── variable: a.f [type=float, outer=(3)]
    │              └── const: 100.0 [type=float]
    └── projections [outer=(1,4)]
         ├── variable: a.s [type=string, outer=(4)]
         └── variable: a.x [type=int, outer=(1)]
--------------------------------------------------------------------------------
ConstrainScan (higher cost)
--------------------------------------------------------------------------------
   project
    ├── columns: s:4(string) x:1(int!null)
    ├── keys: (1)
    ├── select
    │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
    │    ├── keys: (1) weak(3,4)
  - │    ├── scan a@secondary
  + │    ├── scan a
    │    │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
    │    │    └── keys: (1) weak(3,4)
    │    └── filters [type=bool, outer=(3,4), constraints=(/3: [/100.00000000000001 - ]; /4: [/'foo' - /'foo']; tight)]
    │         ├── eq [type=bool, outer=(4), constraints=(/4: [/'foo' - /'foo']; tight)]
    │         │    ├── variable: a.s [type=string, outer=(4)]
    │         │    └── const: 'foo' [type=string]
    │         └── gt [type=bool, outer=(3), constraints=(/3: [/100.00000000000001 - ]; tight)]
    │              ├── variable: a.f [type=float, outer=(3)]
    │              └── const: 100.0 [type=float]
    └── projections [outer=(1,4)]
         ├── variable: a.s [type=string, outer=(4)]
         └── variable: a.x [type=int, outer=(1)]
================================================================================
ConstrainScan
  Cost: 110.00
================================================================================
   project
    ├── columns: s:4(string) x:1(int!null)
    ├── keys: (1)
    ├── select
    │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
    │    ├── keys: (1) weak(3,4)
  - │    ├── scan a
  + │    ├── scan a@secondary
    │    │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
  + │    │    ├── constraint: /-4/3: [/'foo'/100.00000000000001 - /'foo']
    │    │    └── keys: (1) weak(3,4)
  - │    └── filters [type=bool, outer=(3,4), constraints=(/3: [/100.00000000000001 - ]; /4: [/'foo' - /'foo']; tight)]
  - │         ├── eq [type=bool, outer=(4), constraints=(/4: [/'foo' - /'foo']; tight)]
  - │         │    ├── variable: a.s [type=string, outer=(4)]
  - │         │    └── const: 'foo' [type=string]
  - │         └── gt [type=bool, outer=(3), constraints=(/3: [/100.00000000000001 - ]; tight)]
  - │              ├── variable: a.f [type=float, outer=(3)]
  - │              └── const: 100.0 [type=float]
  + │    └── filters [type=bool]
  + │         ├── true [type=bool]
  + │         └── true [type=bool]
    └── projections [outer=(1,4)]
         ├── variable: a.s [type=string, outer=(4)]
         └── variable: a.x [type=int, outer=(1)]
================================================================================
SimplifyFilters
  Cost: 100.00
================================================================================
   project
    ├── columns: s:4(string) x:1(int!null)
    ├── keys: (1)
  - ├── select
  + ├── scan a@secondary
    │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
  - │    ├── keys: (1) weak(3,4)
  - │    ├── scan a@secondary
  - │    │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
  - │    │    ├── constraint: /-4/3: [/'foo'/100.00000000000001 - /'foo']
  - │    │    └── keys: (1) weak(3,4)
  - │    └── filters [type=bool]
  - │         ├── true [type=bool]
  - │         └── true [type=bool]
  + │    ├── constraint: /-4/3: [/'foo'/100.00000000000001 - /'foo']
  + │    └── keys: (1) weak(3,4)
    └── projections [outer=(1,4)]
         ├── variable: a.s [type=string, outer=(4)]
         └── variable: a.x [type=int, outer=(1)]
================================================================================
Final best expression
  Cost: 100.00
================================================================================
  project
   ├── columns: s:4(string) x:1(int!null)
   ├── keys: (1)
   ├── scan a@secondary
   │    ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string)
   │    ├── constraint: /-4/3: [/'foo'/100.00000000000001 - /'foo']
   │    └── keys: (1) weak(3,4)
   └── projections [outer=(1,4)]
        ├── variable: a.s [type=string, outer=(4)]
        └── variable: a.x [type=int, outer=(1)]

# Decorrelation pattern.
optsteps
SELECT * FROM a WHERE EXISTS(SELECT * FROM b WHERE z=i)
----
================================================================================
Initial expression
  Cost: 2200.00
================================================================================
  select
   ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
   ├── keys: (1) weak(3,4)
   ├── scan a
   │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
   │    └── keys: (1) weak(3,4)
   └── exists [type=bool, outer=(2)]
        └── select
             ├── columns: b.x:6(int!null) b.z:7(int)
             ├── outer: (2)
             ├── keys: (6)
             ├── scan b
             │    ├── columns: b.x:6(int!null) b.z:7(int)
             │    └── keys: (6)
             └── eq [type=bool, outer=(2,7)]
                  ├── variable: b.z [type=int, outer=(7)]
                  └── variable: a.i [type=int, outer=(2)]
================================================================================
EnsureSelectFilters
  Cost: 2200.00
================================================================================
   select
    ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
    ├── keys: (1) weak(3,4)
    ├── scan a
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    └── keys: (1) weak(3,4)
    └── exists [type=bool, outer=(2)]
         └── select
              ├── columns: b.x:6(int!null) b.z:7(int)
              ├── outer: (2)
              ├── keys: (6)
              ├── scan b
              │    ├── columns: b.x:6(int!null) b.z:7(int)
              │    └── keys: (6)
  -           └── eq [type=bool, outer=(2,7)]
  -                ├── variable: b.z [type=int, outer=(7)]
  -                └── variable: a.i [type=int, outer=(2)]
  +           └── filters [type=bool, outer=(2,7)]
  +                └── eq [type=bool, outer=(2,7)]
  +                     ├── variable: b.z [type=int, outer=(7)]
  +                     └── variable: a.i [type=int, outer=(2)]
================================================================================
EnsureSelectFilters
  Cost: 2200.00
================================================================================
   select
    ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
    ├── keys: (1) weak(3,4)
    ├── scan a
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    └── keys: (1) weak(3,4)
  - └── exists [type=bool, outer=(2)]
  -      └── select
  -           ├── columns: b.x:6(int!null) b.z:7(int)
  -           ├── outer: (2)
  -           ├── keys: (6)
  -           ├── scan b
  -           │    ├── columns: b.x:6(int!null) b.z:7(int)
  -           │    └── keys: (6)
  -           └── filters [type=bool, outer=(2,7)]
  -                └── eq [type=bool, outer=(2,7)]
  -                     ├── variable: b.z [type=int, outer=(7)]
  -                     └── variable: a.i [type=int, outer=(2)]
  + └── filters [type=bool, outer=(2)]
  +      └── exists [type=bool, outer=(2)]
  +           └── select
  +                ├── columns: b.x:6(int!null) b.z:7(int)
  +                ├── outer: (2)
  +                ├── keys: (6)
  +                ├── scan b
  +                │    ├── columns: b.x:6(int!null) b.z:7(int)
  +                │    └── keys: (6)
  +                └── filters [type=bool, outer=(2,7)]
  +                     └── eq [type=bool, outer=(2,7)]
  +                          ├── variable: b.z [type=int, outer=(7)]
  +                          └── variable: a.i [type=int, outer=(2)]
================================================================================
HoistSelectExists
  Cost: 2100.00
================================================================================
  -select
  +semi-join-apply
    ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
  - ├── keys: (1) weak(3,4)
    ├── scan a
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    └── keys: (1) weak(3,4)
  - └── filters [type=bool, outer=(2)]
  -      └── exists [type=bool, outer=(2)]
  -           └── select
  -                ├── columns: b.x:6(int!null) b.z:7(int)
  -                ├── outer: (2)
  -                ├── keys: (6)
  -                ├── scan b
  -                │    ├── columns: b.x:6(int!null) b.z:7(int)
  -                │    └── keys: (6)
  -                └── filters [type=bool, outer=(2,7)]
  -                     └── eq [type=bool, outer=(2,7)]
  -                          ├── variable: b.z [type=int, outer=(7)]
  -                          └── variable: a.i [type=int, outer=(2)]
  + ├── select
  + │    ├── columns: b.x:6(int!null) b.z:7(int)
  + │    ├── outer: (2)
  + │    ├── keys: (6)
  + │    ├── scan b
  + │    │    ├── columns: b.x:6(int!null) b.z:7(int)
  + │    │    └── keys: (6)
  + │    └── filters [type=bool, outer=(2,7)]
  + │         └── eq [type=bool, outer=(2,7)]
  + │              ├── variable: b.z [type=int, outer=(7)]
  + │              └── variable: a.i [type=int, outer=(2)]
  + └── filters [type=bool]
================================================================================
EliminateEmptyAnd
  Cost: 2100.00
================================================================================
   semi-join-apply
    ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
    ├── scan a
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    └── keys: (1) weak(3,4)
    ├── select
    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    ├── outer: (2)
    │    ├── keys: (6)
    │    ├── scan b
    │    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    │    └── keys: (6)
    │    └── filters [type=bool, outer=(2,7)]
    │         └── eq [type=bool, outer=(2,7)]
    │              ├── variable: b.z [type=int, outer=(7)]
    │              └── variable: a.i [type=int, outer=(2)]
  - └── filters [type=bool]
  + └── true [type=bool]
================================================================================
TryDecorrelateSelect
  Cost: 2000.00
================================================================================
   semi-join-apply
    ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
    ├── scan a
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    └── keys: (1) weak(3,4)
  - ├── select
  + ├── scan b
    │    ├── columns: b.x:6(int!null) b.z:7(int)
  - │    ├── outer: (2)
  - │    ├── keys: (6)
  - │    ├── scan b
  - │    │    ├── columns: b.x:6(int!null) b.z:7(int)
  - │    │    └── keys: (6)
  - │    └── filters [type=bool, outer=(2,7)]
  - │         └── eq [type=bool, outer=(2,7)]
  - │              ├── variable: b.z [type=int, outer=(7)]
  - │              └── variable: a.i [type=int, outer=(2)]
  - └── true [type=bool]
  + │    └── keys: (6)
  + └── filters [type=bool, outer=(2,7)]
  +      └── eq [type=bool, outer=(2,7)]
  +           ├── variable: b.z [type=int, outer=(7)]
  +           └── variable: a.i [type=int, outer=(2)]
================================================================================
DecorrelateJoin
  Cost: 2000.00
================================================================================
  -semi-join-apply
  +semi-join
    ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
    ├── scan a
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
    │    └── keys: (1) weak(3,4)
    ├── scan b
    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    └── keys: (6)
    └── filters [type=bool, outer=(2,7)]
         └── eq [type=bool, outer=(2,7)]
              ├── variable: b.z [type=int, outer=(7)]
              └── variable: a.i [type=int, outer=(2)]
--------------------------------------------------------------------------------
GenerateIndexScans (higher cost)
--------------------------------------------------------------------------------
   semi-join
    ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
  - ├── scan a
  + ├── lookup-join
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    └── keys: (1) weak(3,4)
  + │    ├── table: a
  + │    ├── keys: (1) weak(3,4)
  + │    └── scan a@secondary
  + │         ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  + │         └── keys: (1) weak(3,4)
    ├── scan b
    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    └── keys: (6)
    └── filters [type=bool, outer=(2,7)]
         └── eq [type=bool, outer=(2,7)]
              ├── variable: b.z [type=int, outer=(7)]
              └── variable: a.i [type=int, outer=(2)]
--------------------------------------------------------------------------------
GenerateIndexScans (higher cost)
--------------------------------------------------------------------------------
   semi-join
    ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
  - ├── lookup-join
  + ├── scan a
    │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │    ├── table: a
  - │    ├── keys: (1) weak(3,4)
  - │    └── scan a@secondary
  - │         ├── columns: a.x:1(int!null) a.f:3(float) a.s:4(string) a.j:5(jsonb)
  - │         └── keys: (1) weak(3,4)
  + │    └── keys: (1) weak(3,4)
    ├── scan b
    │    ├── columns: b.x:6(int!null) b.z:7(int)
    │    └── keys: (6)
    └── filters [type=bool, outer=(2,7)]
         └── eq [type=bool, outer=(2,7)]
              ├── variable: b.z [type=int, outer=(7)]
              └── variable: a.i [type=int, outer=(2)]
================================================================================
Final best expression
  Cost: 2000.00
================================================================================
  semi-join
   ├── columns: x:1(int!null) i:2(int) f:3(float) s:4(string) j:5(jsonb)
   ├── scan a
   │    ├── columns: a.x:1(int!null) a.i:2(int) a.f:3(float) a.s:4(string) a.j:5(jsonb)
   │    └── keys: (1) weak(3,4)
   ├── scan b
   │    ├── columns: b.x:6(int!null) b.z:7(int)
   │    └── keys: (6)
   └── filters [type=bool, outer=(2,7)]
        └── eq [type=bool, outer=(2,7)]
             ├── variable: b.z [type=int, outer=(7)]
             └── variable: a.i [type=int, outer=(2)]
