exec-ddl
CREATE TABLE ab (
  a INT PRIMARY KEY,
  b INT,
  INDEX (b)
)
----

# This test ensures that a memo cycle does not cause a stack overflow. Instead,
# the cycle is detected and the optimizer throws an internal error. The cycle is
# created by the test-only exploration rule MemoCycleTestRelRule.
expropt
(MemoCycleTestRel
    (Scan [ (Table "ab") (Cols "a,b") ])
    [ (Eq (Var "b") (Const 1 "int")) ]
)
----
error: memo group optimization passes surpassed limit of 100000; there may be a cycle in the memo
details:
memo (not optimized, ~3KB, required=[])
 ├── G1: (memo-cycle-test-rel G2 G3) (memo-cycle-test-rel G1 G3)
 ├── G2: (scan ab,cols=(1,2)) (scan ab@ab_b_idx,cols=(1,2))
 │    └── []
 │         ├── best: (scan ab,cols=(1,2))
 │         └── cost: 1064.42
 ├── G3: (filters G4)
 ├── G4: (eq G5 G6)
 ├── G5: (variable b)
 └── G6: (const 1)
