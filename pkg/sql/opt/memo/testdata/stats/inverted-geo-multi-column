exec-ddl
CREATE TABLE t (
    k INT PRIMARY KEY,
    g GEOMETRY,
    s STRING,
    i INT,
    INVERTED INDEX m (s, g)
)
----

exec-ddl
ALTER TABLE t INJECT STATISTICS '[
  {
    "columns": ["g"],
    "created_at": "2018-01-01 1:00:00.00000+00:00",
    "row_count": 2000,
    "distinct_count": 7,
    "null_count": 0,
    "histo_col_type":"BYTES",
    "histo_buckets":[
      {"num_eq": 1000, "num_range": 0, "distinct_range": 0, "upper_bound": "\\x42fd0555555555555555"},
      {"num_eq": 1000, "num_range": 1000, "distinct_range": 1, "upper_bound": "\\x42fd0fffffff00000000"},
      {"num_eq": 1000, "num_range": 1000, "distinct_range": 1, "upper_bound": "\\x42fd1000000100000000"},
      {"num_eq": 1000, "num_range": 1000, "distinct_range": 1, "upper_bound": "\\x42fd1aaaaaab00000000"}
     ]
  },
  {
    "columns": ["s"],
    "created_at": "2018-01-01 1:00:00.00000+00:00",
    "row_count": 2000,
    "distinct_count": 40,
    "null_count": 100,
    "histo_col_type": "string",
    "histo_buckets": [
      {"num_eq": 0, "num_range": 0, "distinct_range": 0, "upper_bound": "apple"},
      {"num_eq": 100, "num_range": 200, "distinct_range": 9, "upper_bound": "banana"},
      {"num_eq": 100, "num_range": 300, "distinct_range": 9, "upper_bound": "cherry"},
      {"num_eq": 200, "num_range": 400, "distinct_range": 9, "upper_bound": "mango"},
      {"num_eq": 200, "num_range": 400, "distinct_range": 9, "upper_bound": "pineapple"}
    ]
  },
  {
    "columns": ["i"],
    "created_at": "2018-01-01 1:00:00.00000+00:00",
    "row_count": 2000,
    "distinct_count": 41,
    "null_count": 30,
    "histo_col_type": "int",
    "histo_buckets": [
      {"num_eq": 0, "num_range": 0, "distinct_range": 0, "upper_bound": "0"},
      {"num_eq": 10, "num_range": 190, "distinct_range": 9, "upper_bound": "100"},
      {"num_eq": 10, "num_range": 280, "distinct_range": 9, "upper_bound": "200"},
      {"num_eq": 20, "num_range": 670, "distinct_range": 9, "upper_bound": "300"},
      {"num_eq": 30, "num_range": 760, "distinct_range": 9, "upper_bound": "400"}
    ]
  }
]'
----

# Test a multi-column inverted index scan where the scan.Constraint has a single
# span. The row counts for the scan over the multi-column index should match the
# row counts for the scan over the partial index.

exec-ddl
CREATE INVERTED INDEX p ON t (g) WHERE s = 'banana'
----

opt
SELECT k FROM t@m WHERE s = 'banana' AND st_intersects('LINESTRING(0.5 0.5, 0.7 0.7)', g)
----
project
 ├── columns: k:1(int!null)
 ├── immutable
 ├── stats: [rows=8.262108]
 ├── key: (1)
 └── select
      ├── columns: k:1(int!null) g:2(geometry!null) s:3(string!null)
      ├── immutable
      ├── stats: [rows=8.262108, distinct(2)=7, null(2)=0, avgsize(2)=4, distinct(3)=1, null(3)=0, avgsize(3)=4]
      │   histogram(3)=  0   8.2621
      │                <--- 'banana'
      ├── key: (1)
      ├── fd: ()-->(3), (1)-->(2)
      ├── index-join t
      │    ├── columns: k:1(int!null) g:2(geometry) s:3(string)
      │    ├── stats: [rows=44.49575]
      │    ├── key: (1)
      │    ├── fd: (1)-->(2,3)
      │    └── inverted-filter
      │         ├── columns: k:1(int!null)
      │         ├── inverted expression: /7
      │         │    ├── tight: false, unique: false
      │         │    └── union spans
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │         │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │         ├── pre-filterer expression
      │         │    └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool]
      │         ├── stats: [rows=44.49575]
      │         ├── key: (1)
      │         └── scan t@m
      │              ├── columns: k:1(int!null) g_inverted_key:7(geometry!null)
      │              ├── constraint: /3: [/'banana' - /'banana']
      │              ├── inverted constraint: /7/1
      │              │    └── spans
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │              │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │              ├── flags: force-index=m
      │              ├── stats: [rows=44.49575, distinct(1)=12.7131, null(1)=0, avgsize(1)=4, distinct(3)=1, null(3)=0, avgsize(3)=4, distinct(7)=1.18757, null(7)=0, avgsize(7)=4, distinct(3,7)=1.18757, null(3,7)=0, avgsize(3,7)=8]
      │              │   histogram(3)=  0   44.496
      │              │                <--- 'banana'
      │              │   histogram(7)=  0             0              6.8285e-11           37.468           7.0278             0              0             0
      │              │                <--- '\x42fd1000000000000001' ------------ '\x42fd1000000100000000' -------- '\x42fd1200000000000000' --- '\x42fd1400000000000001'
      │              ├── key: (1)
      │              └── fd: (1)-->(7)
      └── filters
           └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool, outer=(2), immutable, constraints=(/2: (/NULL - ])]

opt
SELECT k FROM t@p WHERE s = 'banana' AND st_intersects('LINESTRING(0.5 0.5, 0.7 0.7)', g)
----
project
 ├── columns: k:1(int!null)
 ├── immutable
 ├── stats: [rows=8.262108]
 ├── key: (1)
 └── select
      ├── columns: k:1(int!null) g:2(geometry!null) s:3(string!null)
      ├── immutable
      ├── stats: [rows=8.262108, distinct(2)=7, null(2)=0, avgsize(2)=4, distinct(3)=1, null(3)=0, avgsize(3)=4]
      │   histogram(3)=  0   8.2621
      │                <--- 'banana'
      ├── key: (1)
      ├── fd: ()-->(3), (1)-->(2)
      ├── index-join t
      │    ├── columns: k:1(int!null) g:2(geometry) s:3(string)
      │    ├── stats: [rows=44.49575]
      │    ├── key: (1)
      │    ├── fd: (1)-->(2,3)
      │    └── inverted-filter
      │         ├── columns: k:1(int!null)
      │         ├── inverted expression: /8
      │         │    ├── tight: false, unique: false
      │         │    └── union spans
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │         │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │         ├── pre-filterer expression
      │         │    └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool]
      │         ├── stats: [rows=44.49575]
      │         ├── key: (1)
      │         └── scan t@p,partial
      │              ├── columns: k:1(int!null) g_inverted_key:8(geometry!null)
      │              ├── inverted constraint: /8/1
      │              │    └── spans
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │              │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │              ├── flags: force-index=p
      │              ├── stats: [rows=44.49575, distinct(1)=12.7131, null(1)=0, avgsize(1)=4, distinct(3)=1, null(3)=0, avgsize(3)=4, distinct(8)=1.18757, null(8)=0, avgsize(8)=4, distinct(3,8)=1.18757, null(3,8)=0, avgsize(3,8)=8]
      │              │   histogram(3)=  0   44.496
      │              │                <--- 'banana'
      │              │   histogram(8)=  0             0              6.8285e-11           37.468           7.0278             0              0             0
      │              │                <--- '\x42fd1000000000000001' ------------ '\x42fd1000000100000000' -------- '\x42fd1200000000000000' --- '\x42fd1400000000000001'
      │              ├── key: (1)
      │              └── fd: (1)-->(8)
      └── filters
           └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool, outer=(2), immutable, constraints=(/2: (/NULL - ])]

exec-ddl
DROP INDEX p
----

# Test a multi-column inverted index scan where the scan.Constraint has multiple
# spans. The row counts for the scan over the multi-column index should match
# the row counts for the scan over the partial index.

exec-ddl
CREATE INVERTED INDEX p ON t (g) WHERE s IN ('apple', 'banana', 'cherry')
----

opt
SELECT k FROM t@m WHERE s IN ('apple', 'banana', 'cherry') AND st_intersects('LINESTRING(0.5 0.5, 0.7 0.7)', g)
----
project
 ├── columns: k:1(int!null)
 ├── immutable
 ├── stats: [rows=16.52422]
 ├── key: (1)
 └── select
      ├── columns: k:1(int!null) g:2(geometry!null) s:3(string!null)
      ├── immutable
      ├── stats: [rows=16.52422, distinct(2)=7, null(2)=0, avgsize(2)=4, distinct(3)=2, null(3)=0, avgsize(3)=4]
      │   histogram(3)=  0   8.2621   0   8.2621
      │                <--- 'banana' --- 'cherry'
      ├── key: (1)
      ├── fd: (1)-->(2,3)
      ├── index-join t
      │    ├── columns: k:1(int!null) g:2(geometry) s:3(string)
      │    ├── stats: [rows=88.99151]
      │    ├── key: (1)
      │    ├── fd: (1)-->(2,3)
      │    └── inverted-filter
      │         ├── columns: k:1(int!null)
      │         ├── inverted expression: /7
      │         │    ├── tight: false, unique: false
      │         │    └── union spans
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │         │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │         ├── pre-filterer expression
      │         │    └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool]
      │         ├── stats: [rows=88.99151]
      │         ├── key: (1)
      │         └── scan t@m
      │              ├── columns: k:1(int!null) g_inverted_key:7(geometry!null)
      │              ├── constraint: /3
      │              │    ├── [/'apple' - /'apple']
      │              │    ├── [/'banana' - /'banana']
      │              │    └── [/'cherry' - /'cherry']
      │              ├── inverted constraint: /7/1
      │              │    └── spans
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │              │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │              ├── flags: force-index=m
      │              ├── stats: [rows=88.99151, distinct(1)=25.4261, null(1)=0, avgsize(1)=4, distinct(3)=2, null(3)=0, avgsize(3)=4, distinct(7)=1.18757, null(7)=0, avgsize(7)=4, distinct(3,7)=2.37514, null(3,7)=0, avgsize(3,7)=8]
      │              │   histogram(3)=  0   44.496   0   44.496
      │              │                <--- 'banana' --- 'cherry'
      │              │   histogram(7)=  0             0              1.3657e-10           74.936           14.056             0              0             0
      │              │                <--- '\x42fd1000000000000001' ------------ '\x42fd1000000100000000' -------- '\x42fd1200000000000000' --- '\x42fd1400000000000001'
      │              ├── key: (1)
      │              └── fd: (1)-->(7)
      └── filters
           └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool, outer=(2), immutable, constraints=(/2: (/NULL - ])]

opt
SELECT k FROM t@p WHERE s IN ('apple', 'banana', 'cherry') AND st_intersects('LINESTRING(0.5 0.5, 0.7 0.7)', g)
----
project
 ├── columns: k:1(int!null)
 ├── immutable
 ├── stats: [rows=16.52422]
 ├── key: (1)
 └── select
      ├── columns: k:1(int!null) g:2(geometry!null) s:3(string!null)
      ├── immutable
      ├── stats: [rows=16.52422, distinct(2)=7, null(2)=0, avgsize(2)=4, distinct(3)=2, null(3)=0, avgsize(3)=4]
      │   histogram(3)=  0   8.2621   0   8.2621
      │                <--- 'banana' --- 'cherry'
      ├── key: (1)
      ├── fd: (1)-->(2,3)
      ├── index-join t
      │    ├── columns: k:1(int!null) g:2(geometry) s:3(string)
      │    ├── stats: [rows=88.99151]
      │    ├── key: (1)
      │    ├── fd: (1)-->(2,3)
      │    └── inverted-filter
      │         ├── columns: k:1(int!null)
      │         ├── inverted expression: /9
      │         │    ├── tight: false, unique: false
      │         │    └── union spans
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │         │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │         ├── pre-filterer expression
      │         │    └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool]
      │         ├── stats: [rows=88.99151]
      │         ├── key: (1)
      │         └── scan t@p,partial
      │              ├── columns: k:1(int!null) g_inverted_key:9(geometry!null)
      │              ├── inverted constraint: /9/1
      │              │    └── spans
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │              │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │              ├── flags: force-index=p
      │              ├── stats: [rows=88.99151, distinct(1)=25.4261, null(1)=0, avgsize(1)=4, distinct(3)=2, null(3)=0, avgsize(3)=4, distinct(9)=1.18757, null(9)=0, avgsize(9)=4, distinct(3,9)=2.37514, null(3,9)=0, avgsize(3,9)=8]
      │              │   histogram(3)=  0   44.496   0   44.496
      │              │                <--- 'banana' --- 'cherry'
      │              │   histogram(9)=  0             0              1.3657e-10           74.936           14.056             0              0             0
      │              │                <--- '\x42fd1000000000000001' ------------ '\x42fd1000000100000000' -------- '\x42fd1200000000000000' --- '\x42fd1400000000000001'
      │              ├── key: (1)
      │              └── fd: (1)-->(9)
      └── filters
           └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool, outer=(2), immutable, constraints=(/2: (/NULL - ])]

exec-ddl
DROP INDEX p
----

# Test a partial, multi-column inverted index scan.

exec-ddl
CREATE INVERTED INDEX mp ON t (i, g) WHERE s IN ('apple', 'banana', 'cherry')
----

opt
SELECT k FROM t@mp WHERE i = 400 AND s IN ('apple', 'banana', 'cherry') AND st_intersects('LINESTRING(0.5 0.5, 0.7 0.7)', g)
----
project
 ├── columns: k:1(int!null)
 ├── immutable
 ├── stats: [rows=0.3019305]
 ├── key: (1)
 └── select
      ├── columns: k:1(int!null) g:2(geometry!null) s:3(string!null) i:4(int!null)
      ├── immutable
      ├── stats: [rows=0.3019305, distinct(2)=0.301931, null(2)=0, avgsize(2)=4, distinct(3)=0.301931, null(3)=0, avgsize(3)=4, distinct(4)=0.301931, null(4)=0, avgsize(4)=4, distinct(3,4)=0.301931, null(3,4)=0, avgsize(3,4)=8]
      │   histogram(3)=  0  0.15097   0  0.15097
      │                <--- 'banana' --- 'cherry'
      │   histogram(4)=  0 0.30193
      │                <---- 400 -
      ├── key: (1)
      ├── fd: ()-->(4), (1)-->(2,3)
      ├── index-join t
      │    ├── columns: k:1(int!null) g:2(geometry) s:3(string) i:4(int)
      │    ├── stats: [rows=4.702752]
      │    ├── key: (1)
      │    ├── fd: (1)-->(2-4)
      │    └── inverted-filter
      │         ├── columns: k:1(int!null)
      │         ├── inverted expression: /10
      │         │    ├── tight: false, unique: false
      │         │    └── union spans
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │         │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │         ├── pre-filterer expression
      │         │    └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool]
      │         ├── stats: [rows=4.702752]
      │         ├── key: (1)
      │         └── scan t@mp,partial
      │              ├── columns: k:1(int!null) g_inverted_key:10(geometry!null)
      │              ├── constraint: /4: [/400 - /400]
      │              ├── inverted constraint: /10/1
      │              │    └── spans
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │              │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │              ├── flags: force-index=mp
      │              ├── stats: [rows=4.702752, distinct(1)=1.34364, null(1)=0, avgsize(1)=4, distinct(3)=2, null(3)=0, avgsize(3)=4, distinct(4)=1, null(4)=0, avgsize(4)=4, distinct(10)=1.18757, null(10)=0, avgsize(10)=4, distinct(3,4,10)=2.37514, null(3,4,10)=0, avgsize(3,4,10)=12]
      │              │   histogram(3)=  0   2.3514   0   2.3514
      │              │                <--- 'banana' --- 'cherry'
      │              │   histogram(4)=  0 4.7028
      │              │                <--- 400 -
      │              │   histogram(10)=  0             0              7.2171e-12            3.96            0.74277             0              0             0
      │              │                 <--- '\x42fd1000000000000001' ------------ '\x42fd1000000100000000' --------- '\x42fd1200000000000000' --- '\x42fd1400000000000001'
      │              ├── key: (1)
      │              └── fd: (1)-->(10)
      └── filters
           └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool, outer=(2), immutable, constraints=(/2: (/NULL - ])]

opt
SELECT k FROM t@mp WHERE i IN (200, 300, 400) AND s IN ('apple', 'banana', 'cherry') AND st_intersects('LINESTRING(0.5 0.5, 0.7 0.7)', g)
----
project
 ├── columns: k:1(int!null)
 ├── immutable
 ├── stats: [rows=0.739125]
 ├── key: (1)
 └── select
      ├── columns: k:1(int!null) g:2(geometry!null) s:3(string!null) i:4(int!null)
      ├── immutable
      ├── stats: [rows=0.739125, distinct(2)=0.739125, null(2)=0, avgsize(2)=4, distinct(3)=0.739125, null(3)=0, avgsize(3)=4, distinct(4)=0.739125, null(4)=0, avgsize(4)=4, distinct(3,4)=0.739125, null(3,4)=0, avgsize(3,4)=8]
      │   histogram(3)=  0  0.36956   0  0.36956
      │                <--- 'banana' --- 'cherry'
      │   histogram(4)=  0 0.12319 0 0.24637 0 0.36956
      │                <---- 200 ----- 300 ----- 400 -
      ├── key: (1)
      ├── fd: (1)-->(2-4)
      ├── index-join t
      │    ├── columns: k:1(int!null) g:2(geometry) s:3(string) i:4(int)
      │    ├── stats: [rows=13.21758]
      │    ├── key: (1)
      │    ├── fd: (1)-->(2-4)
      │    └── inverted-filter
      │         ├── columns: k:1(int!null)
      │         ├── inverted expression: /10
      │         │    ├── tight: false, unique: false
      │         │    └── union spans
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │         │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │         │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │         ├── pre-filterer expression
      │         │    └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool]
      │         ├── stats: [rows=13.21758]
      │         ├── key: (1)
      │         └── scan t@mp,partial
      │              ├── columns: k:1(int!null) g_inverted_key:10(geometry!null)
      │              ├── constraint: /4
      │              │    ├── [/200 - /200]
      │              │    ├── [/300 - /300]
      │              │    └── [/400 - /400]
      │              ├── inverted constraint: /10/1
      │              │    └── spans
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x10\x00\x00\x00\x00\x00\x00\x00"]
      │              │         ├── ["B\xfd\x10\x00\x00\x00\x00\x00\x00\x01", "B\xfd\x12\x00\x00\x00\x00\x00\x00\x00")
      │              │         └── ["B\xfd\x14\x00\x00\x00\x00\x00\x00\x00", "B\xfd\x14\x00\x00\x00\x00\x00\x00\x00"]
      │              ├── flags: force-index=mp
      │              ├── stats: [rows=13.21758, distinct(1)=3.77645, null(1)=0, avgsize(1)=4, distinct(3)=2, null(3)=0, avgsize(3)=4, distinct(4)=3, null(4)=0, avgsize(4)=4, distinct(10)=1.18757, null(10)=0, avgsize(10)=4, distinct(3,4,10)=7.12541, null(3,4,10)=0, avgsize(3,4,10)=12]
      │              │   histogram(3)=  0   6.6088   0   6.6088
      │              │                <--- 'banana' --- 'cherry'
      │              │   histogram(4)=  0 2.2029 0 4.4059 0 6.6088
      │              │                <--- 200 ---- 300 ---- 400 -
      │              │   histogram(10)=  0             0              2.0284e-11           11.13            2.0876             0              0             0
      │              │                 <--- '\x42fd1000000000000001' ------------ '\x42fd1000000100000000' -------- '\x42fd1200000000000000' --- '\x42fd1400000000000001'
      │              ├── key: (1)
      │              └── fd: (1)-->(10)
      └── filters
           └── st_intersects('010200000002000000000000000000E03F000000000000E03F666666666666E63F666666666666E63F', g:2) [type=bool, outer=(2), immutable, constraints=(/2: (/NULL - ])]
