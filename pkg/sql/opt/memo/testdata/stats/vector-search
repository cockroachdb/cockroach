exec-ddl
CREATE TABLE t (x INT PRIMARY KEY, v VECTOR(3));
----

exec-ddl
CREATE VECTOR INDEX ON t (v);
----

# VectorPartitionSearch produces one output row for each input row.
build
INSERT INTO t VALUES (1, '[1, 2, 3]');
----
insert t
 ├── columns: <none>
 ├── insert-mapping:
 │    ├── column1:5 => x:1
 │    └── v_cast:7 => v:2
 ├── vector index put partition columns: vector_index_put_partition1:8(int)
 ├── vector index put centroid columns: vector_index_put_centroid1:9(vector)
 ├── cardinality: [0 - 0]
 ├── volatile, mutations
 ├── stats: [rows=0]
 └── vector-partition-search t@t_v_idx,vector
      ├── columns: column1:5(int!null) v_cast:7(vector!null) vector_index_put_partition1:8(int) vector_index_put_centroid1:9(vector)
      ├── query vector column: v_cast:7
      ├── partition col: vector_index_put_partition1:8
      ├── centroid col: vector_index_put_centroid1:9
      ├── cardinality: [1 - 1]
      ├── immutable
      ├── stats: [rows=1]
      ├── key: ()
      ├── fd: ()-->(5,7-9)
      └── project
           ├── columns: v_cast:7(vector!null) column1:5(int!null)
           ├── cardinality: [1 - 1]
           ├── immutable
           ├── stats: [rows=1]
           ├── key: ()
           ├── fd: ()-->(5,7)
           ├── values
           │    ├── columns: column1:5(int!null) column2:6(vector!null)
           │    ├── cardinality: [1 - 1]
           │    ├── stats: [rows=1]
           │    ├── key: ()
           │    ├── fd: ()-->(5,6)
           │    └── (1, '[1,2,3]') [type=tuple{int, vector}]
           └── projections
                └── assignment-cast: VECTOR(3) [as=v_cast:7, type=vector, outer=(6), immutable]
                     └── column2:6 [type=vector]

build
INSERT INTO t VALUES (1, '[1, 2, 3]'), (2, '[4, 5, 6]'), (3, '[7, 8, 9]');
----
insert t
 ├── columns: <none>
 ├── insert-mapping:
 │    ├── column1:5 => x:1
 │    └── v_cast:7 => v:2
 ├── vector index put partition columns: vector_index_put_partition1:8(int)
 ├── vector index put centroid columns: vector_index_put_centroid1:9(vector)
 ├── cardinality: [0 - 0]
 ├── volatile, mutations
 ├── stats: [rows=0]
 └── vector-partition-search t@t_v_idx,vector
      ├── columns: column1:5(int!null) v_cast:7(vector!null) vector_index_put_partition1:8(int) vector_index_put_centroid1:9(vector)
      ├── query vector column: v_cast:7
      ├── partition col: vector_index_put_partition1:8
      ├── centroid col: vector_index_put_centroid1:9
      ├── cardinality: [3 - 3]
      ├── immutable
      ├── stats: [rows=3]
      └── project
           ├── columns: v_cast:7(vector!null) column1:5(int!null)
           ├── cardinality: [3 - 3]
           ├── immutable
           ├── stats: [rows=3]
           ├── values
           │    ├── columns: column1:5(int!null) column2:6(vector!null)
           │    ├── cardinality: [3 - 3]
           │    ├── stats: [rows=3]
           │    ├── (1, '[1,2,3]') [type=tuple{int, vector}]
           │    ├── (2, '[4,5,6]') [type=tuple{int, vector}]
           │    └── (3, '[7,8,9]') [type=tuple{int, vector}]
           └── projections
                └── assignment-cast: VECTOR(3) [as=v_cast:7, type=vector, outer=(6), immutable]
                     └── column2:6 [type=vector]
