import file=tpcc_schema
----

import file=tpcc_stats_w10
----

# --------------------------------------------------
# 2.4 The New Order Transaction
#
# The New-Order business transaction consists of entering a complete order
# through a single database transaction. It represents a mid-weight, read-write
# transaction with a high frequency of execution and stringent response time
# requirements to satisfy on-line users. This transaction is the backbone of
# the workload. It is designed to place a variable load on the system to
# reflect on-line database activity as typically found in production
# environments.
# --------------------------------------------------
save-tables format=hide-qual database=tpcc save-tables-prefix=new_order_01
SELECT w_tax FROM warehouse WHERE w_id = 1
----
project
 ├── save-table-name: new_order_01_project_1
 ├── columns: w_tax:8(decimal)
 ├── cardinality: [0 - 1]
 ├── stats: [rows=1, distinct(8)=1, null(8)=0]
 ├── key: ()
 ├── fd: ()-->(8)
 └── scan warehouse
      ├── save-table-name: new_order_01_scan_2
      ├── columns: w_id:1(int!null) w_tax:8(decimal)
      ├── constraint: /1: [/1 - /1]
      ├── cardinality: [0 - 1]
      ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(8)=1, null(8)=0]
      ├── key: ()
      └── fd: ()-->(1,8)

stats table=new_order_01_scan_2
----
column_names  row_count  distinct_count  null_count
{w_id}        1          1               0
{w_tax}       1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{w_id}        1.00           1.00           1.00                1.00                0.00            1.00
{w_tax}       1.00           1.00           1.00                1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=new_order_02
SELECT c_discount, c_last, c_credit
FROM customer
WHERE c_w_id = 1 AND c_d_id = 1 AND c_id = 50
----
project
 ├── save-table-name: new_order_02_project_1
 ├── columns: c_discount:16(decimal) c_last:6(varchar) c_credit:14(char)
 ├── cardinality: [0 - 1]
 ├── stats: [rows=1, distinct(6)=0.999501832, null(6)=0, distinct(14)=0.786939691, null(14)=0, distinct(16)=0.999901673, null(16)=0]
 ├── key: ()
 ├── fd: ()-->(6,14,16)
 └── scan customer
      ├── save-table-name: new_order_02_scan_2
      ├── columns: c_id:1(int!null) c_d_id:2(int!null) c_w_id:3(int!null) c_last:6(varchar) c_credit:14(char) c_discount:16(decimal)
      ├── constraint: /3/2/1: [/1/1/50 - /1/1/50]
      ├── cardinality: [0 - 1]
      ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=1, null(3)=0, distinct(6)=0.999501832, null(6)=0, distinct(14)=0.786939691, null(14)=0, distinct(16)=0.999901673, null(16)=0, distinct(1-3)=1, null(1-3)=0]
      ├── key: ()
      └── fd: ()-->(1-3,6,14,16)

stats table=new_order_02_scan_2
----
column_names  row_count  distinct_count  null_count
{c_credit}    1          1               0
{c_d_id}      1          1               0
{c_discount}  1          1               0
{c_id}        1          1               0
{c_last}      1          1               0
{c_w_id}      1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_credit}    1.00           1.00           1.00                1.00                0.00            1.00
{c_d_id}      1.00           1.00           1.00                1.00                0.00            1.00
{c_discount}  1.00           1.00           1.00                1.00                0.00            1.00
{c_id}        1.00           1.00           1.00                1.00                0.00            1.00
{c_last}      1.00           1.00           1.00                1.00                0.00            1.00
{c_w_id}      1.00           1.00           1.00                1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=new_order_03
SELECT i_price, i_name, i_data
FROM item
WHERE i_id IN (125, 150, 175, 200, 25, 50, 75, 100, 225, 250, 275, 300)
ORDER BY i_id
----
scan item
 ├── save-table-name: new_order_03_scan_1
 ├── columns: i_price:4(decimal) i_name:3(varchar) i_data:5(varchar)  [hidden: i_id:1(int!null)]
 ├── constraint: /1
 │    ├── [/25 - /25]
 │    ├── [/50 - /50]
 │    ├── [/75 - /75]
 │    ├── [/100 - /100]
 │    ├── [/125 - /125]
 │    ├── [/150 - /150]
 │    ├── [/175 - /175]
 │    ├── [/200 - /200]
 │    ├── [/225 - /225]
 │    ├── [/250 - /250]
 │    ├── [/275 - /275]
 │    └── [/300 - /300]
 ├── cardinality: [0 - 12]
 ├── stats: [rows=12, distinct(1)=12, null(1)=0, distinct(3)=11.8957521, null(3)=0, distinct(4)=11.9934177, null(4)=0, distinct(5)=11.9945581, null(5)=0]
 ├── key: (1)
 ├── fd: (1)-->(3-5)
 └── ordering: +1

stats table=new_order_03_scan_1
----
column_names  row_count  distinct_count  null_count
{i_data}      12         12              0
{i_id}        12         12              0
{i_name}      12         12              0
{i_price}     12         12              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{i_data}      12.00          1.00           12.00               1.00                0.00            1.00
{i_id}        12.00          1.00           12.00               1.00                0.00            1.00
{i_name}      12.00          1.00           12.00               1.00                0.00            1.00
{i_price}     12.00          1.00           12.00               1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=new_order_04
SELECT s_quantity, s_ytd, s_order_cnt, s_remote_cnt, s_data, s_dist_05
FROM stock
WHERE (s_i_id, s_w_id) IN ((1000, 4), (900, 4), (1100, 4), (1500, 4), (1400, 4))
ORDER BY s_i_id
----
project
 ├── save-table-name: new_order_04_project_1
 ├── columns: s_quantity:3(int) s_ytd:14(int) s_order_cnt:15(int) s_remote_cnt:16(int) s_data:17(varchar) s_dist_05:8(char)  [hidden: s_i_id:1(int!null)]
 ├── cardinality: [0 - 5]
 ├── stats: [rows=5, distinct(1)=5, null(1)=0, distinct(3)=4.86513081, null(3)=0, distinct(8)=4.8037108, null(8)=0, distinct(14)=0.993262137, null(14)=0, distinct(15)=0.993262137, null(15)=0, distinct(16)=0.993262137, null(16)=0, distinct(17)=4.99972957, null(17)=0]
 ├── key: (1)
 ├── fd: (1)-->(3,8,14-17)
 ├── ordering: +1
 └── scan stock
      ├── save-table-name: new_order_04_scan_2
      ├── columns: s_i_id:1(int!null) s_w_id:2(int!null) s_quantity:3(int) s_dist_05:8(char) s_ytd:14(int) s_order_cnt:15(int) s_remote_cnt:16(int) s_data:17(varchar)
      ├── constraint: /2/1
      │    ├── [/4/900 - /4/900]
      │    ├── [/4/1000 - /4/1000]
      │    ├── [/4/1100 - /4/1100]
      │    ├── [/4/1400 - /4/1400]
      │    └── [/4/1500 - /4/1500]
      ├── cardinality: [0 - 5]
      ├── stats: [rows=5, distinct(1)=5, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=4.86513081, null(3)=0, distinct(8)=4.8037108, null(8)=0, distinct(14)=0.993262137, null(14)=0, distinct(15)=0.993262137, null(15)=0, distinct(16)=0.993262137, null(16)=0, distinct(17)=4.99972957, null(17)=0, distinct(1,2)=5, null(1,2)=0]
      ├── key: (1)
      ├── fd: ()-->(2), (1)-->(3,8,14-17)
      └── ordering: +1 opt(2) [actual: +1]

stats table=new_order_04_scan_2
----
column_names    row_count  distinct_count  null_count
{s_data}        5          5               0
{s_dist_05}     5          5               0
{s_i_id}        5          5               0
{s_order_cnt}   5          1               0
{s_quantity}    5          4               0
{s_remote_cnt}  5          1               0
{s_w_id}        5          1               0
{s_ytd}         5          1               0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_data}        5.00           1.00           5.00                1.00                0.00            1.00
{s_dist_05}     5.00           1.00           5.00                1.00                0.00            1.00
{s_i_id}        5.00           1.00           5.00                1.00                0.00            1.00
{s_order_cnt}   5.00           1.00           1.00                1.00                0.00            1.00
{s_quantity}    5.00           1.00           5.00                1.25                0.00            1.00
{s_remote_cnt}  5.00           1.00           1.00                1.00                0.00            1.00
{s_w_id}        5.00           1.00           1.00                1.00                0.00            1.00
{s_ytd}         5.00           1.00           1.00                1.00                0.00            1.00

# --------------------------------------------------
# 2.5 The Payment Transaction
#
# The Payment business transaction updates the customer's balance and reflects
# the payment on the district and warehouse sales statistics. It represents a
# light-weight, read-write transaction with a high frequency of execution and
# stringent response time requirements to satisfy on-line users. In addition,
# this transaction includes non-primary key access to the CUSTOMER table.
# --------------------------------------------------
save-tables format=hide-qual database=tpcc save-tables-prefix=payment_01
SELECT c_id
FROM customer
WHERE c_w_id = 1 AND c_d_id = 1 AND c_last = 'ANTIABLEABLE'
ORDER BY c_first ASC
----
project
 ├── save-table-name: payment_01_project_1
 ├── columns: c_id:1(int!null)  [hidden: c_first:4(varchar)]
 ├── stats: [rows=3.165, distinct(1)=3.16334717, null(1)=0, distinct(4)=3.15605754, null(4)=0]
 ├── key: (1)
 ├── fd: (1)-->(4)
 ├── ordering: +4
 └── scan customer@customer_idx
      ├── save-table-name: payment_01_scan_2
      ├── columns: c_id:1(int!null) c_d_id:2(int!null) c_w_id:3(int!null) c_first:4(varchar) c_last:6(varchar!null)
      ├── constraint: /3/2/6/4/1: [/1/1/'ANTIABLEABLE' - /1/1/'ANTIABLEABLE']
      ├── stats: [rows=3.165, distinct(1)=3.16334717, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=1, null(3)=0, distinct(4)=3.15605754, null(4)=0, distinct(6)=1, null(6)=0, distinct(2,3,6)=1, null(2,3,6)=0]
      │   histogram(3)=  0 3.165
      │                <---- 1 -
      ├── key: (1)
      ├── fd: ()-->(2,3,6), (1)-->(4)
      └── ordering: +4 opt(2,3,6) [actual: +4]

stats table=payment_01_scan_2
----
column_names  row_count  distinct_count  null_count
{c_d_id}      2          1               0
{c_first}     2          2               0
{c_id}        2          2               0
{c_last}      2          1               0
{c_w_id}      2          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_d_id}      3.00           1.50           1.00                1.00                0.00            1.00
{c_first}     3.00           1.50           3.00                1.50                0.00            1.00
{c_id}        3.00           1.50           3.00                1.50                0.00            1.00
{c_last}      3.00           1.50           1.00                1.00                0.00            1.00
{c_w_id}      3.00           1.50           1.00                1.00                0.00            1.00

# --------------------------------------------------
# 2.6 The Order Status Transaction
#
# The Order-Status business transaction queries the status of a customer's last
# order. It represents a mid-weight read-only database transaction with a low
# frequency of execution and response time requirement to satisfy on-line
# users. In addition, this table includes non-primary key access to the
# CUSTOMER table.
# --------------------------------------------------
save-tables format=hide-qual database=tpcc save-tables-prefix=order_status_01
SELECT c_balance, c_first, c_middle, c_last
FROM customer
WHERE c_w_id = 1 AND c_d_id = 1 AND c_id = 50
----
project
 ├── save-table-name: order_status_01_project_1
 ├── columns: c_balance:17(decimal) c_first:4(varchar) c_middle:5(char) c_last:6(varchar)
 ├── cardinality: [0 - 1]
 ├── stats: [rows=1, distinct(4)=0.999106141, null(4)=0, distinct(5)=0.632121172, null(5)=0, distinct(6)=0.999501832, null(6)=0, distinct(17)=0.632121172, null(17)=0]
 ├── key: ()
 ├── fd: ()-->(4-6,17)
 └── scan customer
      ├── save-table-name: order_status_01_scan_2
      ├── columns: c_id:1(int!null) c_d_id:2(int!null) c_w_id:3(int!null) c_first:4(varchar) c_middle:5(char) c_last:6(varchar) c_balance:17(decimal)
      ├── constraint: /3/2/1: [/1/1/50 - /1/1/50]
      ├── cardinality: [0 - 1]
      ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=1, null(3)=0, distinct(4)=0.999106141, null(4)=0, distinct(5)=0.632121172, null(5)=0, distinct(6)=0.999501832, null(6)=0, distinct(17)=0.632121172, null(17)=0, distinct(1-3)=1, null(1-3)=0]
      ├── key: ()
      └── fd: ()-->(1-6,17)

stats table=order_status_01_scan_2
----
column_names  row_count  distinct_count  null_count
{c_balance}   1          1               0
{c_d_id}      1          1               0
{c_first}     1          1               0
{c_id}        1          1               0
{c_last}      1          1               0
{c_middle}    1          1               0
{c_w_id}      1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_balance}   1.00           1.00           1.00                1.00                0.00            1.00
{c_d_id}      1.00           1.00           1.00                1.00                0.00            1.00
{c_first}     1.00           1.00           1.00                1.00                0.00            1.00
{c_id}        1.00           1.00           1.00                1.00                0.00            1.00
{c_last}      1.00           1.00           1.00                1.00                0.00            1.00
{c_middle}    1.00           1.00           1.00                1.00                0.00            1.00
{c_w_id}      1.00           1.00           1.00                1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=order_status_02
SELECT c_id, c_balance, c_first, c_middle
FROM customer
WHERE c_w_id = 2 AND c_d_id = 2 AND c_last = 'ANTIBARESE'
ORDER BY c_first ASC
----
project
 ├── save-table-name: order_status_02_project_1
 ├── columns: c_id:1(int!null) c_balance:17(decimal) c_first:4(varchar) c_middle:5(char)
 ├── stats: [rows=2.853, distinct(1)=2.85165693, null(1)=0, distinct(4)=2.84573236, null(4)=0, distinct(5)=0.942329734, null(5)=0, distinct(17)=0.942329734, null(17)=0]
 ├── key: (1)
 ├── fd: (1)-->(4,5,17)
 ├── ordering: +4
 └── index-join customer
      ├── save-table-name: order_status_02_index_join_2
      ├── columns: c_id:1(int!null) c_d_id:2(int!null) c_w_id:3(int!null) c_first:4(varchar) c_middle:5(char) c_last:6(varchar!null) c_balance:17(decimal)
      ├── stats: [rows=2.853, distinct(1)=2.85165693, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=1, null(3)=0, distinct(4)=2.84573236, null(4)=0, distinct(5)=0.942329734, null(5)=0, distinct(6)=1, null(6)=0, distinct(17)=0.942329734, null(17)=0, distinct(2,3,6)=1, null(2,3,6)=0]
      │   histogram(3)=  0 2.853
      │                <---- 2 -
      ├── key: (1)
      ├── fd: ()-->(2,3,6), (1)-->(4,5,17)
      ├── ordering: +4 opt(2,3,6) [actual: +4]
      └── scan customer@customer_idx
           ├── save-table-name: order_status_02_scan_3
           ├── columns: c_id:1(int!null) c_d_id:2(int!null) c_w_id:3(int!null) c_first:4(varchar) c_last:6(varchar!null)
           ├── constraint: /3/2/6/4/1: [/2/2/'ANTIBARESE' - /2/2/'ANTIBARESE']
           ├── stats: [rows=2.853, distinct(1)=2.85165693, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=1, null(3)=0, distinct(4)=2.84573236, null(4)=0, distinct(6)=1, null(6)=0, distinct(2,3,6)=1, null(2,3,6)=0]
           │   histogram(3)=  0 2.853
           │                <---- 2 -
           ├── key: (1)
           ├── fd: ()-->(2,3,6), (1)-->(4)
           └── ordering: +4 opt(2,3,6) [actual: +4]

stats table=order_status_02_index_join_2
----
column_names  row_count  distinct_count  null_count
{c_balance}   3          1               0
{c_d_id}      3          1               0
{c_first}     3          3               0
{c_id}        3          3               0
{c_last}      3          1               0
{c_middle}    3          1               0
{c_w_id}      3          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_balance}   3.00           1.00           1.00                1.00                0.00            1.00
{c_d_id}      3.00           1.00           1.00                1.00                0.00            1.00
{c_first}     3.00           1.00           3.00                1.00                0.00            1.00
{c_id}        3.00           1.00           3.00                1.00                0.00            1.00
{c_last}      3.00           1.00           1.00                1.00                0.00            1.00
{c_middle}    3.00           1.00           1.00                1.00                0.00            1.00
{c_w_id}      3.00           1.00           1.00                1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=order_status_03
SELECT o_id, o_entry_d, o_carrier_id
FROM "order"
WHERE o_w_id = 4 AND o_d_id = 3 AND o_c_id = 10
ORDER BY o_id DESC
LIMIT 1
----
project
 ├── save-table-name: order_status_03_project_1
 ├── columns: o_id:1(int!null) o_entry_d:5(timestamp) o_carrier_id:6(int)
 ├── cardinality: [0 - 1]
 ├── stats: [rows=0.986644468, distinct(1)=0.986483809, null(1)=0, distinct(5)=0.627174982, null(5)=0, distinct(6)=0.943691252, null(6)=0.29599334]
 ├── key: ()
 ├── fd: ()-->(1,5,6)
 └── scan "order"@order_idx
      ├── save-table-name: order_status_03_scan_2
      ├── columns: o_id:1(int!null) o_d_id:2(int!null) o_w_id:3(int!null) o_c_id:4(int!null) o_entry_d:5(timestamp) o_carrier_id:6(int)
      ├── constraint: /3/2/4/-1: [/4/3/10 - /4/3/10]
      ├── limit: 1
      ├── stats: [rows=0.986644468, distinct(1)=0.986483809, null(1)=0, distinct(2)=0.986644468, null(2)=0, distinct(3)=0.986644468, null(3)=0, distinct(4)=0.986644468, null(4)=0, distinct(5)=0.627174982, null(5)=0, distinct(6)=0.943691252, null(6)=0.29599334]
      ├── key: ()
      └── fd: ()-->(1-6)

save-tables format=hide-qual database=tpcc save-tables-prefix=order_status_04
SELECT ol_i_id, ol_supply_w_id, ol_quantity, ol_amount, ol_delivery_d
FROM order_line
WHERE ol_w_id = 1 AND ol_d_id = 1 AND ol_o_id = 1000
----
project
 ├── save-table-name: order_status_04_project_1
 ├── columns: ol_i_id:5(int!null) ol_supply_w_id:6(int) ol_quantity:8(int) ol_amount:9(decimal) ol_delivery_d:7(timestamp)
 ├── stats: [rows=9.40430419, distinct(5)=9.40387521, null(5)=0, distinct(6)=6.09540837, null(6)=0, distinct(7)=1.98184869, null(7)=2.81742891, distinct(8)=0.999917632, null(8)=0, distinct(9)=9.40424383, null(9)=0]
 └── scan order_line
      ├── save-table-name: order_status_04_scan_2
      ├── columns: ol_o_id:1(int!null) ol_d_id:2(int!null) ol_w_id:3(int!null) ol_i_id:5(int!null) ol_supply_w_id:6(int) ol_delivery_d:7(timestamp) ol_quantity:8(int) ol_amount:9(decimal)
      ├── constraint: /3/2/-1/4: [/1/1/1000 - /1/1/1000]
      ├── stats: [rows=9.40430419, distinct(1)=1, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=1, null(3)=0, distinct(5)=9.40387521, null(5)=0, distinct(6)=6.09540837, null(6)=0, distinct(7)=1.98184869, null(7)=2.81742891, distinct(8)=0.999917632, null(8)=0, distinct(9)=9.40424383, null(9)=0, distinct(1-3)=1, null(1-3)=0]
      │   histogram(3)=  0 9.4043
      │                <---- 1 --
      └── fd: ()-->(1-3)

stats table=order_status_04_scan_2
----
column_names      row_count  distinct_count  null_count
{ol_amount}       12         1               0
{ol_d_id}         12         1               0
{ol_delivery_d}   12         1               0
{ol_i_id}         12         12              0
{ol_o_id}         12         1               0
{ol_quantity}     12         1               0
{ol_supply_w_id}  12         1               0
{ol_w_id}         12         1               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ol_amount}       9.00           1.33           9.00                9.00 <==            0.00            1.00
{ol_d_id}         9.00           1.33           1.00                1.00                0.00            1.00
{ol_delivery_d}   9.00           1.33           2.00                2.00 <==            3.00            +Inf <==
{ol_i_id}         9.00           1.33           9.00                1.33                0.00            1.00
{ol_o_id}         9.00           1.33           1.00                1.00                0.00            1.00
{ol_quantity}     9.00           1.33           1.00                1.00                0.00            1.00
{ol_supply_w_id}  9.00           1.33           6.00                6.00 <==            0.00            1.00
{ol_w_id}         9.00           1.33           1.00                1.00                0.00            1.00

# --------------------------------------------------
# 2.7 The Delivery Transaction
#
# The Delivery business transaction consists of processing a batch of 10 new
# (not yet delivered) orders. Each order is processed (delivered) in full
# within the scope of a read-write database transaction. The number of orders
# delivered as a group (or batched) within the same database transaction is
# implementation specific. The business transaction, comprised of one or more
# (up to 10) database transactions, has a low frequency of execution and must
# complete within a relaxed response time requirement.
#
# The Delivery transaction is intended to be executed in deferred mode through
# a queuing mechanism, rather than interactively, with terminal response
# indicating transaction completion. The result of the deferred execution is
# recorded into a result file.
# --------------------------------------------------
save-tables format=hide-qual database=tpcc save-tables-prefix=delivery_01
SELECT no_o_id
FROM new_order
WHERE no_w_id = 7 AND no_d_id = 6
ORDER BY no_o_id ASC
LIMIT 1
----
project
 ├── save-table-name: delivery_01_project_1
 ├── columns: no_o_id:1(int!null)
 ├── cardinality: [0 - 1]
 ├── stats: [rows=1, distinct(1)=0.999681502, null(1)=0]
 ├── key: ()
 ├── fd: ()-->(1)
 └── scan new_order
      ├── save-table-name: delivery_01_scan_2
      ├── columns: no_o_id:1(int!null) no_d_id:2(int!null) no_w_id:3(int!null)
      ├── constraint: /3/2/1: [/7/6 - /7/6]
      ├── limit: 1
      ├── stats: [rows=1, distinct(1)=0.999681502, null(1)=0, distinct(2)=0.632336252, null(2)=0, distinct(3)=0.632336252, null(3)=0]
      ├── key: ()
      └── fd: ()-->(1-3)

stats table=delivery_01_scan_2
----
column_names  row_count  distinct_count  null_count
{no_d_id}     1          1               0
{no_o_id}     1          1               0
{no_w_id}     1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{no_d_id}     1.00           1.00           1.00                1.00                0.00            1.00
{no_o_id}     1.00           1.00           1.00                1.00                0.00            1.00
{no_w_id}     1.00           1.00           1.00                1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=delivery_02
SELECT sum(ol_amount)
FROM order_line
WHERE ol_w_id = 8 AND ol_d_id = 6 AND ol_o_id = 1000
----
scalar-group-by
 ├── save-table-name: delivery_02_scalar_group_by_1
 ├── columns: sum:11(decimal)
 ├── cardinality: [1 - 1]
 ├── stats: [rows=1, distinct(11)=1, null(11)=0]
 ├── key: ()
 ├── fd: ()-->(11)
 ├── scan order_line
 │    ├── save-table-name: delivery_02_scan_2
 │    ├── columns: ol_o_id:1(int!null) ol_d_id:2(int!null) ol_w_id:3(int!null) ol_amount:9(decimal)
 │    ├── constraint: /3/2/-1/4: [/8/6/1000 - /8/6/1000]
 │    ├── stats: [rows=10.0934032, distinct(1)=1, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=1, null(3)=0, distinct(9)=10.0933337, null(9)=0, distinct(1-3)=1, null(1-3)=0]
 │    │   histogram(3)=  0 10.093
 │    │                <---- 8 --
 │    └── fd: ()-->(1-3)
 └── aggregations
      └── sum [as=sum:11, type=decimal, outer=(9)]
           └── ol_amount:9 [type=decimal]

stats table=delivery_02_scan_2
----
column_names  row_count  distinct_count  null_count
{ol_amount}   7          1               0
{ol_d_id}     7          1               0
{ol_o_id}     7          1               0
{ol_w_id}     7          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ol_amount}   10.00          1.43           10.00               10.00 <==           0.00            1.00
{ol_d_id}     10.00          1.43           1.00                1.00                0.00            1.00
{ol_o_id}     10.00          1.43           1.00                1.00                0.00            1.00
{ol_w_id}     10.00          1.43           1.00                1.00                0.00            1.00

stats table=delivery_02_scalar_group_by_1
----
column_names  row_count  distinct_count  null_count
{sum}         1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{sum}         1.00           1.00           1.00                1.00                0.00            1.00

# --------------------------------------------------
# 2.8 The Stock-Level Transaction
#
# The Stock-Level business transaction determines the number of recently sold
# items that have a stock level below a specified threshold. It represents a
# heavy read-only database transaction with a low frequency of execution, a
# relaxed response time requirement, and relaxed consistency requirements.
# --------------------------------------------------
save-tables format=hide-qual database=tpcc save-tables-prefix=stock_level_01
SELECT d_next_o_id
FROM district
WHERE d_w_id = 4 AND d_id = 9
----
project
 ├── save-table-name: stock_level_01_project_1
 ├── columns: d_next_o_id:11(int)
 ├── cardinality: [0 - 1]
 ├── stats: [rows=1, distinct(11)=0.633967659, null(11)=0]
 ├── key: ()
 ├── fd: ()-->(11)
 └── scan district
      ├── save-table-name: stock_level_01_scan_2
      ├── columns: d_id:1(int!null) d_w_id:2(int!null) d_next_o_id:11(int)
      ├── constraint: /2/1: [/4/9 - /4/9]
      ├── cardinality: [0 - 1]
      ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(2)=1, null(2)=0, distinct(11)=0.633967659, null(11)=0, distinct(1,2)=1, null(1,2)=0]
      ├── key: ()
      └── fd: ()-->(1,2,11)

stats table=stock_level_01_scan_2
----
column_names   row_count  distinct_count  null_count
{d_id}         1          1               0
{d_next_o_id}  1          1               0
{d_w_id}       1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{d_id}         1.00           1.00           1.00                1.00                0.00            1.00
{d_next_o_id}  1.00           1.00           1.00                1.00                0.00            1.00
{d_w_id}       1.00           1.00           1.00                1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=stock_level_02
SELECT count(DISTINCT s_i_id)
FROM order_line
JOIN stock
ON s_i_id=ol_i_id AND s_w_id=ol_w_id
WHERE ol_w_id = 1
    AND ol_d_id = 1
    AND ol_o_id BETWEEN 1000 - 20 AND 1000 - 1
    AND s_quantity < 15
----
scalar-group-by
 ├── save-table-name: stock_level_02_scalar_group_by_1
 ├── columns: count:28(int!null)
 ├── cardinality: [1 - 1]
 ├── stats: [rows=1, distinct(28)=1, null(28)=0]
 ├── key: ()
 ├── fd: ()-->(28)
 ├── distinct-on
 │    ├── save-table-name: stock_level_02_distinct_on_2
 │    ├── columns: s_i_id:11(int!null)
 │    ├── grouping columns: s_i_id:11(int!null)
 │    ├── stats: [rows=187.914589, distinct(11)=187.914589, null(11)=0]
 │    ├── key: (11)
 │    └── inner-join (lookup stock)
 │         ├── save-table-name: stock_level_02_lookup_join_3
 │         ├── columns: ol_o_id:1(int!null) ol_d_id:2(int!null) ol_w_id:3(int!null) ol_i_id:5(int!null) s_i_id:11(int!null) s_w_id:12(int!null) s_quantity:13(int!null)
 │         ├── key columns: [3 5] = [12 11]
 │         ├── lookup columns are key
 │         ├── stats: [rows=218.87081, distinct(1)=19.9996466, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=1, null(3)=0, distinct(5)=187.914589, null(5)=0, distinct(11)=187.914589, null(11)=0, distinct(12)=1, null(12)=0, distinct(13)=30.3110384, null(13)=0]
 │         ├── fd: ()-->(2,3,12), (11)-->(13), (5)==(11), (11)==(5), (3)==(12), (12)==(3)
 │         ├── scan order_line
 │         │    ├── save-table-name: stock_level_02_scan_4
 │         │    ├── columns: ol_o_id:1(int!null) ol_d_id:2(int!null) ol_w_id:3(int!null) ol_i_id:5(int!null)
 │         │    ├── constraint: /3/2/-1/4: [/1/1/999 - /1/1/980]
 │         │    ├── stats: [rows=188.086084, distinct(1)=20, null(1)=0, distinct(2)=1, null(2)=0, distinct(3)=1, null(3)=0, distinct(5)=187.914589, null(5)=0, distinct(2,3)=1, null(2,3)=0, distinct(1-3)=20, null(1-3)=0]
 │         │    │   histogram(3)=  0 188.09
 │         │    │                <---- 1 --
 │         │    └── fd: ()-->(2,3)
 │         └── filters
 │              ├── s_w_id:12 = 1 [type=bool, outer=(12), constraints=(/12: [/1 - /1]; tight), fd=()-->(12)]
 │              └── s_quantity:13 < 15 [type=bool, outer=(13), constraints=(/13: (/NULL - /14]; tight)]
 └── aggregations
      └── count-rows [as=count:28, type=int]

stats table=stock_level_02_scan_4
----
column_names  row_count  distinct_count  null_count
{ol_d_id}     193        1               0
{ol_i_id}     193        193             0
{ol_o_id}     193        20              0
{ol_w_id}     193        1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ol_d_id}     188.00         1.03           1.00                1.00                0.00            1.00
{ol_i_id}     188.00         1.03           188.00              1.03                0.00            1.00
{ol_o_id}     188.00         1.03           20.00               1.00                0.00            1.00
{ol_w_id}     188.00         1.03           1.00                1.00                0.00            1.00

stats table=stock_level_02_lookup_join_3
----
column_names  row_count  distinct_count  null_count
{ol_d_id}     15         1               0
{ol_i_id}     15         15              0
{ol_o_id}     15         11              0
{ol_w_id}     15         1               0
{s_i_id}      15         15              0
{s_quantity}  15         5               0
{s_w_id}      15         1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ol_d_id}     219.00         14.60 <==      1.00                1.00                0.00            1.00
{ol_i_id}     219.00         14.60 <==      188.00              12.53 <==           0.00            1.00
{ol_o_id}     219.00         14.60 <==      20.00               1.82                0.00            1.00
{ol_w_id}     219.00         14.60 <==      1.00                1.00                0.00            1.00
{s_i_id}      219.00         14.60 <==      188.00              12.53 <==           0.00            1.00
{s_quantity}  219.00         14.60 <==      30.00               6.00 <==            0.00            1.00
{s_w_id}      219.00         14.60 <==      1.00                1.00                0.00            1.00

# TODO(radu): add stock_level_02_distinct_on_2.

stats table=stock_level_02_scalar_group_by_1
----
column_names  row_count  distinct_count  null_count
{count}       1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count}       1.00           1.00           1.00                1.00                0.00            1.00

# --------------------------------------------------
# Consistency Queries
#
# These queries run after TPCC in order to check database consistency.
# They are not part of the benchmark itself.
# --------------------------------------------------
save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_01
SELECT count(*)
FROM warehouse
FULL OUTER JOIN
(
    SELECT d_w_id, sum(d_ytd) as sum_d_ytd
    FROM district
    GROUP BY d_w_id
)
ON (w_id = d_w_id)
WHERE w_ytd != sum_d_ytd
----
scalar-group-by
 ├── save-table-name: consistency_01_scalar_group_by_1
 ├── columns: count:22(int!null)
 ├── cardinality: [1 - 1]
 ├── immutable
 ├── stats: [rows=1, distinct(22)=1, null(22)=0]
 ├── key: ()
 ├── fd: ()-->(22)
 ├── inner-join (merge)
 │    ├── save-table-name: consistency_01_merge_join_2
 │    ├── columns: w_id:1(int!null) w_ytd:9(decimal!null) d_w_id:11(int!null) sum:21(decimal!null)
 │    ├── left ordering: +1
 │    ├── right ordering: +11
 │    ├── immutable
 │    ├── stats: [rows=3.33333333, distinct(1)=3.33333333, null(1)=0, distinct(9)=1, null(9)=0, distinct(11)=3.33333333, null(11)=0, distinct(21)=3.33333333, null(21)=0]
 │    ├── key: (11)
 │    ├── fd: (1)-->(9), (11)-->(21), (1)==(11), (11)==(1)
 │    ├── scan warehouse
 │    │    ├── save-table-name: consistency_01_scan_3
 │    │    ├── columns: w_id:1(int!null) w_ytd:9(decimal)
 │    │    ├── stats: [rows=10, distinct(1)=10, null(1)=0, distinct(9)=1, null(9)=0]
 │    │    │   histogram(1)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1
 │    │    │                <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9
 │    │    ├── key: (1)
 │    │    ├── fd: (1)-->(9)
 │    │    └── ordering: +1
 │    ├── group-by
 │    │    ├── save-table-name: consistency_01_group_by_4
 │    │    ├── columns: d_w_id:11(int!null) sum:21(decimal)
 │    │    ├── grouping columns: d_w_id:11(int!null)
 │    │    ├── stats: [rows=10, distinct(11)=10, null(11)=0, distinct(21)=10, null(21)=0]
 │    │    ├── key: (11)
 │    │    ├── fd: (11)-->(21)
 │    │    ├── ordering: +11
 │    │    ├── scan district
 │    │    │    ├── save-table-name: consistency_01_scan_5
 │    │    │    ├── columns: d_w_id:11(int!null) d_ytd:19(decimal)
 │    │    │    ├── stats: [rows=100, distinct(11)=10, null(11)=0, distinct(19)=1, null(19)=0]
 │    │    │    │   histogram(11)=  0 10  0 10  0 10  0 10  0 10  0 10  0 10  0 10  0 10  0 10
 │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9
 │    │    │    └── ordering: +11
 │    │    └── aggregations
 │    │         └── sum [as=sum:21, type=decimal, outer=(19)]
 │    │              └── d_ytd:19 [type=decimal]
 │    └── filters
 │         └── w_ytd:9 != sum:21 [type=bool, outer=(9,21), immutable, constraints=(/9: (/NULL - ]; /21: (/NULL - ])]
 └── aggregations
      └── count-rows [as=count_rows:22, type=int]

stats table=consistency_01_group_by_4
----
column_names  row_count  distinct_count  null_count
{d_w_id}      10         10              0
{sum}         10         1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{d_w_id}      10.00          1.00           10.00               1.00                0.00            1.00
{sum}         10.00          1.00           10.00               10.00 <==           0.00            1.00

stats table=consistency_01_merge_join_2
----
column_names  row_count  distinct_count  null_count
{d_w_id}      0          0               0
{sum}         0          0               0
{w_id}        0          0               0
{w_ytd}       0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{d_w_id}      3.00           +Inf <==       3.00                +Inf <==            0.00            1.00
{sum}         3.00           +Inf <==       3.00                +Inf <==            0.00            1.00
{w_id}        3.00           +Inf <==       3.00                +Inf <==            0.00            1.00
{w_ytd}       3.00           +Inf <==       1.00                +Inf <==            0.00            1.00

stats table=consistency_01_scalar_group_by_1
----
column_names  row_count  distinct_count  null_count
{count}       1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count}       1.00           1.00           1.00                1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_02
SELECT d_next_o_id
FROM district
ORDER BY d_w_id, d_id
----
scan district
 ├── save-table-name: consistency_02_scan_1
 ├── columns: d_next_o_id:11(int)  [hidden: d_id:1(int!null) d_w_id:2(int!null)]
 ├── stats: [rows=100, distinct(1)=10, null(1)=0, distinct(2)=10, null(2)=0, distinct(11)=1, null(11)=0]
 │   histogram(2)=  0 10  0 10  0 10  0 10  0 10  0 10  0 10  0 10  0 10  0 10
 │                <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9
 ├── key: (1,2)
 ├── fd: (1,2)-->(11)
 └── ordering: +2,+1

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_03
SELECT max(no_o_id)
FROM new_order
GROUP BY no_d_id, no_w_id
ORDER BY no_w_id, no_d_id
----
group-by
 ├── save-table-name: consistency_03_group_by_1
 ├── columns: max:4(int!null)  [hidden: no_d_id:2(int!null) no_w_id:3(int!null)]
 ├── grouping columns: no_d_id:2(int!null) no_w_id:3(int!null)
 ├── stats: [rows=100, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(4)=100, null(4)=0, distinct(2,3)=100, null(2,3)=0]
 ├── key: (2,3)
 ├── fd: (2,3)-->(4)
 ├── ordering: +3,+2
 ├── scan new_order
 │    ├── save-table-name: consistency_03_scan_2
 │    ├── columns: no_o_id:1(int!null) no_d_id:2(int!null) no_w_id:3(int!null)
 │    ├── stats: [rows=90000, distinct(1)=900, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(2,3)=100, null(2,3)=0]
 │    │   histogram(3)=  0 9333 0 9189 0 9261 0 9162 0 9306 0 8442 0 8946 0 8532 0 9135 0 8694
 │    │                <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 -
 │    ├── key: (1-3)
 │    └── ordering: +3,+2
 └── aggregations
      └── max [as=max:4, type=int, outer=(1)]
           └── no_o_id:1 [type=int]

stats table=consistency_03_group_by_1
----
column_names  row_count  distinct_count  null_count
{max}         100        1               0
{no_d_id}     100        10              0
{no_w_id}     100        10              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{max}         100.00         1.00           100.00              100.00 <==          0.00            1.00
{no_d_id}     100.00         1.00           10.00               1.00                0.00            1.00
{no_w_id}     100.00         1.00           10.00               1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_04
SELECT max(o_id)
FROM "order"
GROUP BY o_d_id, o_w_id
ORDER BY o_w_id, o_d_id
----
group-by
 ├── save-table-name: consistency_04_group_by_1
 ├── columns: max:9(int!null)  [hidden: o_d_id:2(int!null) o_w_id:3(int!null)]
 ├── grouping columns: o_d_id:2(int!null) o_w_id:3(int!null)
 ├── stats: [rows=100, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(9)=100, null(9)=0, distinct(2,3)=100, null(2,3)=0]
 ├── key: (2,3)
 ├── fd: (2,3)-->(9)
 ├── ordering: +3,+2
 ├── scan "order"@order_idx
 │    ├── save-table-name: consistency_04_scan_2
 │    ├── columns: o_id:1(int!null) o_d_id:2(int!null) o_w_id:3(int!null)
 │    ├── stats: [rows=300000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(2,3)=100, null(2,3)=0]
 │    │   histogram(3)=  0 29280 0 29310 0 31560 0 30000 0 29220 0 30720 0 31110 0 30510 0 29070 0 29220
 │    │                <---- 0 ----- 1 ----- 2 ----- 3 ----- 4 ----- 5 ----- 6 ----- 7 ----- 8 ----- 9 -
 │    ├── key: (1-3)
 │    └── ordering: +3,+2
 └── aggregations
      └── max [as=max:9, type=int, outer=(1)]
           └── o_id:1 [type=int]

stats table=consistency_04_group_by_1
----
column_names  row_count  distinct_count  null_count
{max}         100        1               0
{o_d_id}      100        10              0
{o_w_id}      100        10              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{max}         100.00         1.00           100.00              100.00 <==          0.00            1.00
{o_d_id}      100.00         1.00           10.00               1.00                0.00            1.00
{o_w_id}      100.00         1.00           10.00               1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_05
SELECT count(*)
FROM
(
    SELECT max(no_o_id) - min(no_o_id) - count(*) AS nod
    FROM new_order
    GROUP BY no_w_id, no_d_id
)
WHERE nod != -1
----
scalar-group-by
 ├── save-table-name: consistency_05_scalar_group_by_1
 ├── columns: count:8(int!null)
 ├── cardinality: [1 - 1]
 ├── immutable
 ├── stats: [rows=1, distinct(8)=1, null(8)=0]
 ├── key: ()
 ├── fd: ()-->(8)
 ├── select
 │    ├── save-table-name: consistency_05_select_2
 │    ├── columns: no_d_id:2(int!null) no_w_id:3(int!null) max:4(int!null) min:5(int!null) count_rows:6(int!null)
 │    ├── immutable
 │    ├── stats: [rows=33.3333333, distinct(2)=9.8265847, null(2)=0, distinct(3)=9.8265847, null(3)=0, distinct(4)=33.3333333, null(4)=0, distinct(5)=33.3333333, null(5)=0, distinct(6)=33.3333333, null(6)=0]
 │    ├── key: (2,3)
 │    ├── fd: (2,3)-->(4-6)
 │    ├── group-by
 │    │    ├── save-table-name: consistency_05_group_by_3
 │    │    ├── columns: no_d_id:2(int!null) no_w_id:3(int!null) max:4(int!null) min:5(int!null) count_rows:6(int!null)
 │    │    ├── grouping columns: no_d_id:2(int!null) no_w_id:3(int!null)
 │    │    ├── internal-ordering: +3,+2
 │    │    ├── stats: [rows=100, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(4)=100, null(4)=0, distinct(5)=100, null(5)=0, distinct(6)=100, null(6)=0, distinct(2,3)=100, null(2,3)=0]
 │    │    ├── key: (2,3)
 │    │    ├── fd: (2,3)-->(4-6)
 │    │    ├── scan new_order
 │    │    │    ├── save-table-name: consistency_05_scan_4
 │    │    │    ├── columns: no_o_id:1(int!null) no_d_id:2(int!null) no_w_id:3(int!null)
 │    │    │    ├── stats: [rows=90000, distinct(1)=900, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(2,3)=100, null(2,3)=0]
 │    │    │    │   histogram(3)=  0 9333 0 9189 0 9261 0 9162 0 9306 0 8442 0 8946 0 8532 0 9135 0 8694
 │    │    │    │                <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 -
 │    │    │    ├── key: (1-3)
 │    │    │    └── ordering: +3,+2
 │    │    └── aggregations
 │    │         ├── max [as=max:4, type=int, outer=(1)]
 │    │         │    └── no_o_id:1 [type=int]
 │    │         ├── min [as=min:5, type=int, outer=(1)]
 │    │         │    └── no_o_id:1 [type=int]
 │    │         └── count-rows [as=count_rows:6, type=int]
 │    └── filters
 │         └── ((max:4 - min:5) - count_rows:6) != -1 [type=bool, outer=(4-6), immutable]
 └── aggregations
      └── count-rows [as=count_rows:8, type=int]

stats table=consistency_05_group_by_3
----
column_names  row_count  distinct_count  null_count
{count_rows}  100        1               0
{max}         100        1               0
{min}         100        1               0
{no_d_id}     100        10              0
{no_w_id}     100        10              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count_rows}  100.00         1.00           100.00              100.00 <==          0.00            1.00
{max}         100.00         1.00           100.00              100.00 <==          0.00            1.00
{min}         100.00         1.00           100.00              100.00 <==          0.00            1.00
{no_d_id}     100.00         1.00           10.00               1.00                0.00            1.00
{no_w_id}     100.00         1.00           10.00               1.00                0.00            1.00

stats table=consistency_05_select_2
----
column_names  row_count  distinct_count  null_count
{count_rows}  0          0               0
{max}         0          0               0
{min}         0          0               0
{no_d_id}     0          0               0
{no_w_id}     0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count_rows}  33.00          +Inf <==       33.00               +Inf <==            0.00            1.00
{max}         33.00          +Inf <==       33.00               +Inf <==            0.00            1.00
{min}         33.00          +Inf <==       33.00               +Inf <==            0.00            1.00
{no_d_id}     33.00          +Inf <==       10.00               +Inf <==            0.00            1.00
{no_w_id}     33.00          +Inf <==       10.00               +Inf <==            0.00            1.00

stats table=consistency_05_scalar_group_by_1
----
column_names  row_count  distinct_count  null_count
{count}       1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count}       1.00           1.00           1.00                1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_06
SELECT sum(o_ol_cnt)
FROM "order"
GROUP BY o_w_id, o_d_id
ORDER BY o_w_id, o_d_id
----
group-by
 ├── save-table-name: consistency_06_group_by_1
 ├── columns: sum:9(decimal)  [hidden: o_d_id:2(int!null) o_w_id:3(int!null)]
 ├── grouping columns: o_d_id:2(int!null) o_w_id:3(int!null)
 ├── stats: [rows=100, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(9)=100, null(9)=0, distinct(2,3)=100, null(2,3)=0]
 ├── key: (2,3)
 ├── fd: (2,3)-->(9)
 ├── ordering: +3,+2
 ├── scan "order"
 │    ├── save-table-name: consistency_06_scan_2
 │    ├── columns: o_d_id:2(int!null) o_w_id:3(int!null) o_ol_cnt:7(int)
 │    ├── stats: [rows=300000, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(7)=11, null(7)=0, distinct(2,3)=100, null(2,3)=0]
 │    │   histogram(3)=  0 29280 0 29310 0 31560 0 30000 0 29220 0 30720 0 31110 0 30510 0 29070 0 29220
 │    │                <---- 0 ----- 1 ----- 2 ----- 3 ----- 4 ----- 5 ----- 6 ----- 7 ----- 8 ----- 9 -
 │    └── ordering: +3,+2
 └── aggregations
      └── sum [as=sum:9, type=decimal, outer=(7)]
           └── o_ol_cnt:7 [type=int]

stats table=consistency_06_group_by_1
----
column_names  row_count  distinct_count  null_count
{o_d_id}      100        10              0
{o_w_id}      100        10              0
{sum}         100        93              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_d_id}      100.00         1.00           10.00               1.00                0.00            1.00
{o_w_id}      100.00         1.00           10.00               1.00                0.00            1.00
{sum}         100.00         1.00           100.00              1.08                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_07
SELECT count(*)
FROM order_line
GROUP BY ol_w_id, ol_d_id
ORDER BY ol_w_id, ol_d_id
----
sort
 ├── save-table-name: consistency_07_sort_1
 ├── columns: count:11(int!null)  [hidden: ol_d_id:2(int!null) ol_w_id:3(int!null)]
 ├── stats: [rows=100, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(11)=100, null(11)=0, distinct(2,3)=100, null(2,3)=0]
 ├── key: (2,3)
 ├── fd: (2,3)-->(11)
 ├── ordering: +3,+2
 └── group-by
      ├── save-table-name: consistency_07_group_by_2
      ├── columns: ol_d_id:2(int!null) ol_w_id:3(int!null) count_rows:11(int!null)
      ├── grouping columns: ol_d_id:2(int!null) ol_w_id:3(int!null)
      ├── stats: [rows=100, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(11)=100, null(11)=0, distinct(2,3)=100, null(2,3)=0]
      ├── key: (2,3)
      ├── fd: (2,3)-->(11)
      ├── scan order_line@order_line_stock_fk_idx
      │    ├── save-table-name: consistency_07_scan_3
      │    ├── columns: ol_d_id:2(int!null) ol_w_id:3(int!null)
      │    └── stats: [rows=3001222, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(2,3)=100, null(2,3)=0]
      │        histogram(3)=  0 3.1213e+05 0 2.7851e+05 0 2.9892e+05 0 3.0732e+05 0 2.9892e+05 0 2.9622e+05 0 3.1363e+05 0 2.8392e+05 0 2.9892e+05 0 3.1273e+05
      │                     <------ 0 ---------- 1 ---------- 2 ---------- 3 ---------- 4 ---------- 5 ---------- 6 ---------- 7 ---------- 8 ---------- 9 ----
      └── aggregations
           └── count-rows [as=count_rows:11, type=int]

stats table=consistency_07_group_by_2
----
column_names  row_count  distinct_count  null_count
{count_rows}  100        93              0
{ol_d_id}     100        10              0
{ol_w_id}     100        10              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count_rows}  100.00         1.00           100.00              1.08                0.00            1.00
{ol_d_id}     100.00         1.00           10.00               1.00                0.00            1.00
{ol_w_id}     100.00         1.00           10.00               1.00                0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_08
(SELECT no_w_id, no_d_id, no_o_id FROM new_order)
EXCEPT ALL
(SELECT o_w_id, o_d_id, o_id FROM "order" WHERE o_carrier_id IS NULL)
----
except-all
 ├── save-table-name: consistency_08_except_all_1
 ├── columns: no_w_id:3(int!null) no_d_id:2(int!null) no_o_id:1(int!null)
 ├── left columns: no_w_id:3(int!null) no_d_id:2(int!null) no_o_id:1(int!null)
 ├── right columns: o_w_id:6(int) o_d_id:5(int) o_id:4(int)
 ├── stats: [rows=90000, distinct(1)=900, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0]
 ├── scan new_order
 │    ├── save-table-name: consistency_08_scan_2
 │    ├── columns: no_o_id:1(int!null) no_d_id:2(int!null) no_w_id:3(int!null)
 │    ├── stats: [rows=90000, distinct(1)=900, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0]
 │    │   histogram(3)=  0 9333 0 9189 0 9261 0 9162 0 9306 0 8442 0 8946 0 8532 0 9135 0 8694
 │    │                <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 -
 │    └── key: (1-3)
 └── project
      ├── save-table-name: consistency_08_project_3
      ├── columns: o_id:4(int!null) o_d_id:5(int!null) o_w_id:6(int!null)
      ├── stats: [rows=90000, distinct(4)=2999, null(4)=0, distinct(5)=10, null(5)=0, distinct(6)=10, null(6)=0]
      ├── key: (4-6)
      └── select
           ├── save-table-name: consistency_08_select_4
           ├── columns: o_id:4(int!null) o_d_id:5(int!null) o_w_id:6(int!null) o_carrier_id:9(int)
           ├── stats: [rows=90000, distinct(4)=2999, null(4)=0, distinct(5)=10, null(5)=0, distinct(6)=10, null(6)=0, distinct(9)=1, null(9)=90000]
           ├── key: (4-6)
           ├── fd: ()-->(9)
           ├── scan "order"@order_idx
           │    ├── save-table-name: consistency_08_scan_5
           │    ├── columns: o_id:4(int!null) o_d_id:5(int!null) o_w_id:6(int!null) o_carrier_id:9(int)
           │    ├── stats: [rows=300000, distinct(4)=2999, null(4)=0, distinct(5)=10, null(5)=0, distinct(6)=10, null(6)=0, distinct(9)=11, null(9)=90000]
           │    │   histogram(6)=  0 29280 0 29310 0 31560 0 30000 0 29220 0 30720 0 31110 0 30510 0 29070 0 29220
           │    │                <---- 0 ----- 1 ----- 2 ----- 3 ----- 4 ----- 5 ----- 6 ----- 7 ----- 8 ----- 9 -
           │    ├── key: (4-6)
           │    └── fd: (4-6)-->(9)
           └── filters
                └── o_carrier_id:9 IS NULL [type=bool, outer=(9), constraints=(/9: [/NULL - /NULL]; tight), fd=()-->(9)]

stats table=consistency_08_select_4
----
column_names    row_count  distinct_count  null_count
{o_carrier_id}  90000      1               90000
{o_d_id}        90000      10              0
{o_id}          90000      900             0
{o_w_id}        90000      10              0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_carrier_id}  90000.00       1.00           1.00                1.00                90000.00        1.00
{o_d_id}        90000.00       1.00           10.00               1.00                0.00            1.00
{o_id}          90000.00       1.00           2999.00             3.33 <==            0.00            1.00
{o_w_id}        90000.00       1.00           10.00               1.00                0.00            1.00

stats table=consistency_08_except_all_1
----
column_names  row_count  distinct_count  null_count
{no_d_id}     0          0               0
{no_o_id}     0          0               0
{no_w_id}     0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{no_d_id}     90000.00       +Inf <==       10.00               +Inf <==            0.00            1.00
{no_o_id}     90000.00       +Inf <==       900.00              +Inf <==            0.00            1.00
{no_w_id}     90000.00       +Inf <==       10.00               +Inf <==            0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_09
(SELECT o_w_id, o_d_id, o_id FROM "order" WHERE o_carrier_id IS NULL)
EXCEPT ALL
(SELECT no_w_id, no_d_id, no_o_id FROM new_order)
----
except-all
 ├── save-table-name: consistency_09_except_all_1
 ├── columns: o_w_id:3(int!null) o_d_id:2(int!null) o_id:1(int!null)
 ├── left columns: o_w_id:3(int!null) o_d_id:2(int!null) o_id:1(int!null)
 ├── right columns: no_w_id:11(int) no_d_id:10(int) no_o_id:9(int)
 ├── stats: [rows=90000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0]
 ├── project
 │    ├── save-table-name: consistency_09_project_2
 │    ├── columns: o_id:1(int!null) o_d_id:2(int!null) o_w_id:3(int!null)
 │    ├── stats: [rows=90000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0]
 │    ├── key: (1-3)
 │    └── select
 │         ├── save-table-name: consistency_09_select_3
 │         ├── columns: o_id:1(int!null) o_d_id:2(int!null) o_w_id:3(int!null) o_carrier_id:6(int)
 │         ├── stats: [rows=90000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(6)=1, null(6)=90000]
 │         ├── key: (1-3)
 │         ├── fd: ()-->(6)
 │         ├── scan "order"@order_idx
 │         │    ├── save-table-name: consistency_09_scan_4
 │         │    ├── columns: o_id:1(int!null) o_d_id:2(int!null) o_w_id:3(int!null) o_carrier_id:6(int)
 │         │    ├── stats: [rows=300000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(6)=11, null(6)=90000]
 │         │    │   histogram(3)=  0 29280 0 29310 0 31560 0 30000 0 29220 0 30720 0 31110 0 30510 0 29070 0 29220
 │         │    │                <---- 0 ----- 1 ----- 2 ----- 3 ----- 4 ----- 5 ----- 6 ----- 7 ----- 8 ----- 9 -
 │         │    ├── key: (1-3)
 │         │    └── fd: (1-3)-->(6)
 │         └── filters
 │              └── o_carrier_id:6 IS NULL [type=bool, outer=(6), constraints=(/6: [/NULL - /NULL]; tight), fd=()-->(6)]
 └── scan new_order
      ├── save-table-name: consistency_09_scan_5
      ├── columns: no_o_id:9(int!null) no_d_id:10(int!null) no_w_id:11(int!null)
      ├── stats: [rows=90000, distinct(9)=900, null(9)=0, distinct(10)=10, null(10)=0, distinct(11)=10, null(11)=0]
      │   histogram(11)=  0 9333 0 9189 0 9261 0 9162 0 9306 0 8442 0 8946 0 8532 0 9135 0 8694
      │                 <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 -
      └── key: (9-11)

stats table=consistency_09_except_all_1
----
column_names  row_count  distinct_count  null_count
{o_d_id}      0          0               0
{o_id}        0          0               0
{o_w_id}      0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_d_id}      90000.00       +Inf <==       10.00               +Inf <==            0.00            1.00
{o_id}        90000.00       +Inf <==       2999.00             +Inf <==            0.00            1.00
{o_w_id}      90000.00       +Inf <==       10.00               +Inf <==            0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_10
(
    SELECT o_w_id, o_d_id, o_id, o_ol_cnt
    FROM "order"
    ORDER BY o_w_id, o_d_id, o_id DESC
)
EXCEPT ALL
(
    SELECT ol_w_id, ol_d_id, ol_o_id, count(*)
    FROM order_line
    GROUP BY (ol_w_id, ol_d_id, ol_o_id)
    ORDER BY ol_w_id, ol_d_id, ol_o_id DESC
)
----
except-all
 ├── save-table-name: consistency_10_except_all_1
 ├── columns: o_w_id:3(int!null) o_d_id:2(int!null) o_id:1(int!null) o_ol_cnt:7(int)
 ├── left columns: o_w_id:3(int!null) o_d_id:2(int!null) o_id:1(int!null) o_ol_cnt:7(int)
 ├── right columns: ol_w_id:11(int) ol_d_id:10(int) ol_o_id:9(int) count_rows:19(int)
 ├── stats: [rows=300000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(7)=11, null(7)=0]
 ├── scan "order"
 │    ├── save-table-name: consistency_10_scan_2
 │    ├── columns: o_id:1(int!null) o_d_id:2(int!null) o_w_id:3(int!null) o_ol_cnt:7(int)
 │    ├── stats: [rows=300000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(7)=11, null(7)=0]
 │    │   histogram(3)=  0 29280 0 29310 0 31560 0 30000 0 29220 0 30720 0 31110 0 30510 0 29070 0 29220
 │    │                <---- 0 ----- 1 ----- 2 ----- 3 ----- 4 ----- 5 ----- 6 ----- 7 ----- 8 ----- 9 -
 │    ├── key: (1-3)
 │    └── fd: (1-3)-->(7)
 └── group-by
      ├── save-table-name: consistency_10_group_by_3
      ├── columns: ol_o_id:9(int!null) ol_d_id:10(int!null) ol_w_id:11(int!null) count_rows:19(int!null)
      ├── grouping columns: ol_o_id:9(int!null) ol_d_id:10(int!null) ol_w_id:11(int!null)
      ├── stats: [rows=295745, distinct(9)=2999, null(9)=0, distinct(10)=10, null(10)=0, distinct(11)=10, null(11)=0, distinct(19)=295745, null(19)=0, distinct(9-11)=295745, null(9-11)=0]
      ├── key: (9-11)
      ├── fd: (9-11)-->(19)
      ├── scan order_line@order_line_stock_fk_idx
      │    ├── save-table-name: consistency_10_scan_4
      │    ├── columns: ol_o_id:9(int!null) ol_d_id:10(int!null) ol_w_id:11(int!null)
      │    └── stats: [rows=3001222, distinct(9)=2999, null(9)=0, distinct(10)=10, null(10)=0, distinct(11)=10, null(11)=0, distinct(9-11)=295745, null(9-11)=0]
      │        histogram(11)=  0 3.1213e+05 0 2.7851e+05 0 2.9892e+05 0 3.0732e+05 0 2.9892e+05 0 2.9622e+05 0 3.1363e+05 0 2.8392e+05 0 2.9892e+05 0 3.1273e+05
      │                      <------ 0 ---------- 1 ---------- 2 ---------- 3 ---------- 4 ---------- 5 ---------- 6 ---------- 7 ---------- 8 ---------- 9 ----
      └── aggregations
           └── count-rows [as=count_rows:19, type=int]

stats table=consistency_10_group_by_3
----
column_names  row_count  distinct_count  null_count
{count_rows}  300000     11              0
{ol_d_id}     300000     10              0
{ol_o_id}     300000     2999            0
{ol_w_id}     300000     10              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count_rows}  295745.00      1.01           295745.00           26885.91 <==        0.00            1.00
{ol_d_id}     295745.00      1.01           10.00               1.00                0.00            1.00
{ol_o_id}     295745.00      1.01           2999.00             1.00                0.00            1.00
{ol_w_id}     295745.00      1.01           10.00               1.00                0.00            1.00

stats table=consistency_10_except_all_1
----
column_names  row_count  distinct_count  null_count
{o_d_id}      0          0               0
{o_id}        0          0               0
{o_ol_cnt}    0          0               0
{o_w_id}      0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_d_id}      300000.00      +Inf <==       10.00               +Inf <==            0.00            1.00
{o_id}        300000.00      +Inf <==       2999.00             +Inf <==            0.00            1.00
{o_ol_cnt}    300000.00      +Inf <==       11.00               +Inf <==            0.00            1.00
{o_w_id}      300000.00      +Inf <==       10.00               +Inf <==            0.00            1.00

save-tables format=hide-qual database=tpcc save-tables-prefix=consistency_11
(
    SELECT ol_w_id, ol_d_id, ol_o_id, count(*)
    FROM order_line
    GROUP BY (ol_w_id, ol_d_id, ol_o_id)
    ORDER BY ol_w_id, ol_d_id, ol_o_id DESC
)
EXCEPT ALL
(
    SELECT o_w_id, o_d_id, o_id, o_ol_cnt
    FROM "order"
    ORDER BY o_w_id, o_d_id, o_id DESC
)
----
except-all
 ├── save-table-name: consistency_11_except_all_1
 ├── columns: ol_w_id:3(int!null) ol_d_id:2(int!null) ol_o_id:1(int!null) count:11(int)
 ├── left columns: ol_w_id:3(int!null) ol_d_id:2(int!null) ol_o_id:1(int!null) count_rows:11(int)
 ├── right columns: o_w_id:14(int) o_d_id:13(int) o_id:12(int) o_ol_cnt:18(int)
 ├── stats: [rows=295745, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(11)=295745, null(11)=0]
 ├── group-by
 │    ├── save-table-name: consistency_11_group_by_2
 │    ├── columns: ol_o_id:1(int!null) ol_d_id:2(int!null) ol_w_id:3(int!null) count_rows:11(int!null)
 │    ├── grouping columns: ol_o_id:1(int!null) ol_d_id:2(int!null) ol_w_id:3(int!null)
 │    ├── stats: [rows=295745, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(11)=295745, null(11)=0, distinct(1-3)=295745, null(1-3)=0]
 │    ├── key: (1-3)
 │    ├── fd: (1-3)-->(11)
 │    ├── scan order_line@order_line_stock_fk_idx
 │    │    ├── save-table-name: consistency_11_scan_3
 │    │    ├── columns: ol_o_id:1(int!null) ol_d_id:2(int!null) ol_w_id:3(int!null)
 │    │    └── stats: [rows=3001222, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(1-3)=295745, null(1-3)=0]
 │    │        histogram(3)=  0 3.1213e+05 0 2.7851e+05 0 2.9892e+05 0 3.0732e+05 0 2.9892e+05 0 2.9622e+05 0 3.1363e+05 0 2.8392e+05 0 2.9892e+05 0 3.1273e+05
 │    │                     <------ 0 ---------- 1 ---------- 2 ---------- 3 ---------- 4 ---------- 5 ---------- 6 ---------- 7 ---------- 8 ---------- 9 ----
 │    └── aggregations
 │         └── count-rows [as=count_rows:11, type=int]
 └── scan "order"
      ├── save-table-name: consistency_11_scan_4
      ├── columns: o_id:12(int!null) o_d_id:13(int!null) o_w_id:14(int!null) o_ol_cnt:18(int)
      ├── stats: [rows=300000, distinct(12)=2999, null(12)=0, distinct(13)=10, null(13)=0, distinct(14)=10, null(14)=0, distinct(18)=11, null(18)=0]
      │   histogram(14)=  0 29280 0 29310 0 31560 0 30000 0 29220 0 30720 0 31110 0 30510 0 29070 0 29220
      │                 <---- 0 ----- 1 ----- 2 ----- 3 ----- 4 ----- 5 ----- 6 ----- 7 ----- 8 ----- 9 -
      ├── key: (12-14)
      └── fd: (12-14)-->(18)

stats table=consistency_11_except_all_1
----
column_names  row_count  distinct_count  null_count
{count}       0          0               0
{ol_d_id}     0          0               0
{ol_o_id}     0          0               0
{ol_w_id}     0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count}       295745.00      +Inf <==       295745.00           +Inf <==            0.00            1.00
{ol_d_id}     295745.00      +Inf <==       10.00               +Inf <==            0.00            1.00
{ol_o_id}     295745.00      +Inf <==       2999.00             +Inf <==            0.00            1.00
{ol_w_id}     295745.00      +Inf <==       10.00               +Inf <==            0.00            1.00

save-tables database=tpcc save-tables-prefix=consistency_12
SELECT count(*)
FROM
(
    SELECT o_w_id, o_d_id, o_id
    FROM "order"
    WHERE o_carrier_id IS NULL
)
FULL OUTER JOIN
(
    SELECT ol_w_id, ol_d_id, ol_o_id
    FROM order_line
    WHERE ol_delivery_d IS NULL
)
ON (ol_w_id = o_w_id AND ol_d_id = o_d_id AND ol_o_id = o_id)
WHERE ol_o_id IS NULL OR o_id IS NULL
----
scalar-group-by
 ├── save-table-name: consistency_12_scalar_group_by_1
 ├── columns: count:19(int!null)
 ├── cardinality: [1 - 1]
 ├── stats: [rows=1, distinct(19)=1, null(19)=0]
 ├── key: ()
 ├── fd: ()-->(19)
 ├── select
 │    ├── save-table-name: consistency_12_select_2
 │    ├── columns: o_id:1(int) o_d_id:2(int) o_w_id:3(int) ol_o_id:9(int) ol_d_id:10(int) ol_w_id:11(int)
 │    ├── stats: [rows=299711.333, distinct(1)=2999, null(1)=209767.952, distinct(2)=10, null(2)=209767.952, distinct(3)=10, null(3)=209767.952, distinct(9)=2999, null(9)=0, distinct(10)=10, null(10)=0, distinct(11)=10, null(11)=0]
 │    ├── full-join (hash)
 │    │    ├── save-table-name: consistency_12_full_join_3
 │    │    ├── columns: o_id:1(int) o_d_id:2(int) o_w_id:3(int) ol_o_id:9(int) ol_d_id:10(int) ol_w_id:11(int)
 │    │    ├── multiplicity: left-rows(exactly-one), right-rows(one-or-more)
 │    │    ├── stats: [rows=899134, distinct(1)=2999, null(1)=629303.857, distinct(2)=10, null(2)=629303.857, distinct(3)=10, null(3)=629303.857, distinct(9)=2999, null(9)=0, distinct(10)=10, null(10)=0, distinct(11)=10, null(11)=0]
 │    │    ├── project
 │    │    │    ├── save-table-name: consistency_12_project_4
 │    │    │    ├── columns: ol_o_id:9(int!null) ol_d_id:10(int!null) ol_w_id:11(int!null)
 │    │    │    ├── stats: [rows=899134, distinct(9)=2999, null(9)=0, distinct(10)=10, null(10)=0, distinct(11)=10, null(11)=0]
 │    │    │    └── select
 │    │    │         ├── save-table-name: consistency_12_select_5
 │    │    │         ├── columns: ol_o_id:9(int!null) ol_d_id:10(int!null) ol_w_id:11(int!null) ol_delivery_d:15(timestamp)
 │    │    │         ├── stats: [rows=899134, distinct(9)=2999, null(9)=0, distinct(10)=10, null(10)=0, distinct(11)=10, null(11)=0, distinct(15)=1, null(15)=899134]
 │    │    │         ├── fd: ()-->(15)
 │    │    │         ├── scan order_line
 │    │    │         │    ├── save-table-name: consistency_12_scan_6
 │    │    │         │    ├── columns: ol_o_id:9(int!null) ol_d_id:10(int!null) ol_w_id:11(int!null) ol_delivery_d:15(timestamp)
 │    │    │         │    └── stats: [rows=3001222, distinct(9)=2999, null(9)=0, distinct(10)=10, null(10)=0, distinct(11)=10, null(11)=0, distinct(15)=2, null(15)=899134]
 │    │    │         │        histogram(11)=  0 3.1213e+05 0 2.7851e+05 0 2.9892e+05 0 3.0732e+05 0 2.9892e+05 0 2.9622e+05 0 3.1363e+05 0 2.8392e+05 0 2.9892e+05 0 3.1273e+05
 │    │    │         │                      <------ 0 ---------- 1 ---------- 2 ---------- 3 ---------- 4 ---------- 5 ---------- 6 ---------- 7 ---------- 8 ---------- 9 ----
 │    │    │         └── filters
 │    │    │              └── ol_delivery_d:15 IS NULL [type=bool, outer=(15), constraints=(/15: [/NULL - /NULL]; tight), fd=()-->(15)]
 │    │    ├── project
 │    │    │    ├── save-table-name: consistency_12_project_7
 │    │    │    ├── columns: o_id:1(int!null) o_d_id:2(int!null) o_w_id:3(int!null)
 │    │    │    ├── stats: [rows=90000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0]
 │    │    │    ├── key: (1-3)
 │    │    │    └── select
 │    │    │         ├── save-table-name: consistency_12_select_8
 │    │    │         ├── columns: o_id:1(int!null) o_d_id:2(int!null) o_w_id:3(int!null) o_carrier_id:6(int)
 │    │    │         ├── stats: [rows=90000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(6)=1, null(6)=90000]
 │    │    │         ├── key: (1-3)
 │    │    │         ├── fd: ()-->(6)
 │    │    │         ├── scan "order"@order_idx
 │    │    │         │    ├── save-table-name: consistency_12_scan_9
 │    │    │         │    ├── columns: o_id:1(int!null) o_d_id:2(int!null) o_w_id:3(int!null) o_carrier_id:6(int)
 │    │    │         │    ├── stats: [rows=300000, distinct(1)=2999, null(1)=0, distinct(2)=10, null(2)=0, distinct(3)=10, null(3)=0, distinct(6)=11, null(6)=90000]
 │    │    │         │    │   histogram(3)=  0 29280 0 29310 0 31560 0 30000 0 29220 0 30720 0 31110 0 30510 0 29070 0 29220
 │    │    │         │    │                <---- 0 ----- 1 ----- 2 ----- 3 ----- 4 ----- 5 ----- 6 ----- 7 ----- 8 ----- 9 -
 │    │    │         │    ├── key: (1-3)
 │    │    │         │    └── fd: (1-3)-->(6)
 │    │    │         └── filters
 │    │    │              └── o_carrier_id:6 IS NULL [type=bool, outer=(6), constraints=(/6: [/NULL - /NULL]; tight), fd=()-->(6)]
 │    │    └── filters
 │    │         ├── ol_w_id:11 = o_w_id:3 [type=bool, outer=(3,11), constraints=(/3: (/NULL - ]; /11: (/NULL - ]), fd=(3)==(11), (11)==(3)]
 │    │         ├── ol_d_id:10 = o_d_id:2 [type=bool, outer=(2,10), constraints=(/2: (/NULL - ]; /10: (/NULL - ]), fd=(2)==(10), (10)==(2)]
 │    │         └── ol_o_id:9 = o_id:1 [type=bool, outer=(1,9), constraints=(/1: (/NULL - ]; /9: (/NULL - ]), fd=(1)==(9), (9)==(1)]
 │    └── filters
 │         └── (ol_o_id:9 IS NULL) OR (o_id:1 IS NULL) [type=bool, outer=(1,9)]
 └── aggregations
      └── count-rows [as=count_rows:19, type=int]

stats table=consistency_12_select_5
----
column_names     row_count  distinct_count  null_count
{ol_d_id}        899134     10              0
{ol_delivery_d}  899134     1               899134
{ol_o_id}        899134     900             0
{ol_w_id}        899134     10              0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ol_d_id}        899134.00      1.00           10.00               1.00                0.00            1.00
{ol_delivery_d}  899134.00      1.00           1.00                1.00                899134.00       1.00
{ol_o_id}        899134.00      1.00           2999.00             3.33 <==            0.00            1.00
{ol_w_id}        899134.00      1.00           10.00               1.00                0.00            1.00

stats table=consistency_12_select_8
----
column_names    row_count  distinct_count  null_count
{o_carrier_id}  90000      1               90000
{o_d_id}        90000      10              0
{o_id}          90000      900             0
{o_w_id}        90000      10              0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_carrier_id}  90000.00       1.00           1.00                1.00                90000.00        1.00
{o_d_id}        90000.00       1.00           10.00               1.00                0.00            1.00
{o_id}          90000.00       1.00           2999.00             3.33 <==            0.00            1.00
{o_w_id}        90000.00       1.00           10.00               1.00                0.00            1.00

stats table=consistency_12_full_join_3
----
column_names  row_count  distinct_count  null_count
{o_d_id}      899134     10              0
{o_id}        899134     900             0
{o_w_id}      899134     10              0
{ol_d_id}     899134     10              0
{ol_o_id}     899134     900             0
{ol_w_id}     899134     10              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_d_id}      899134.00      1.00           10.00               1.00                629304.00       +Inf <==
{o_id}        899134.00      1.00           2999.00             3.33 <==            629304.00       +Inf <==
{o_w_id}      899134.00      1.00           10.00               1.00                629304.00       +Inf <==
{ol_d_id}     899134.00      1.00           10.00               1.00                0.00            1.00
{ol_o_id}     899134.00      1.00           2999.00             3.33 <==            0.00            1.00
{ol_w_id}     899134.00      1.00           10.00               1.00                0.00            1.00

stats table=consistency_12_select_2
----
column_names  row_count  distinct_count  null_count
{o_d_id}      0          0               0
{o_id}        0          0               0
{o_w_id}      0          0               0
{ol_d_id}     0          0               0
{ol_o_id}     0          0               0
{ol_w_id}     0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_d_id}      299711.00      +Inf <==       10.00               +Inf <==            209768.00       +Inf <==
{o_id}        299711.00      +Inf <==       2999.00             +Inf <==            209768.00       +Inf <==
{o_w_id}      299711.00      +Inf <==       10.00               +Inf <==            209768.00       +Inf <==
{ol_d_id}     299711.00      +Inf <==       10.00               +Inf <==            0.00            1.00
{ol_o_id}     299711.00      +Inf <==       2999.00             +Inf <==            0.00            1.00
{ol_w_id}     299711.00      +Inf <==       10.00               +Inf <==            0.00            1.00

stats table=consistency_12_scalar_group_by_1
----
column_names  row_count  distinct_count  null_count
{count}       1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count}       1.00           1.00           1.00                1.00                0.00            1.00
