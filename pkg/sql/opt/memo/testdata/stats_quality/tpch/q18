import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q18
# Large Volume Customer
# Ranks customers based on their having placed a large quantity order. Large
# quantity orders are defined as those orders whose total quantity is above a
# certain level.
#
# Finds a list of the top 100 customers who have ever placed large quantity
# orders. The query lists the customer name, customer key, the order key, date
# and total price and the quantity for the order.
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q18
SELECT
    c_name,
    c_custkey,
    o_orderkey,
    o_orderdate,
    o_totalprice,
    sum(l_quantity)
FROM
    customer,
    orders,
    lineitem
WHERE
    o_orderkey IN (
        SELECT
            l_orderkey
        FROM
            lineitem
        GROUP BY
            l_orderkey HAVING
                sum(l_quantity) > 300
    )
    AND c_custkey = o_custkey
    AND o_orderkey = l_orderkey
GROUP BY
    c_name,
    c_custkey,
    o_orderkey,
    o_orderdate,
    o_totalprice
ORDER BY
    o_totalprice DESC,
    o_orderdate
LIMIT 100;
----
----
top-k
 ├── save-table-name: q18_top_k_1
 ├── columns: c_name:2(varchar!null) c_custkey:1(int!null) o_orderkey:11(int!null) o_orderdate:15(date!null) o_totalprice:14(float!null) sum:59(float!null)
 ├── internal-ordering: -14,+15
 ├── k: 100
 ├── cardinality: [0 - 100]
 ├── stats: [rows=100, distinct(1)=100, null(1)=0, avgsize(1)=4, distinct(2)=100, null(2)=0, avgsize(2)=4, distinct(11)=100, null(11)=0, avgsize(11)=4, distinct(14)=100, null(14)=0, avgsize(14)=4, distinct(15)=100, null(15)=0, avgsize(15)=4, distinct(59)=100, null(59)=0, avgsize(59)=4]
 ├── key: (11)
 ├── fd: (1)-->(2), (11)-->(1,2,14,15,59)
 ├── ordering: -14,+15
 └── group-by (hash)
      ├── save-table-name: q18_group_by_2
      ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) o_orderkey:11(int!null) o_totalprice:14(float!null) o_orderdate:15(date!null) sum:59(float!null)
      ├── grouping columns: o_orderkey:11(int!null)
      ├── stats: [rows=499399.1, distinct(1)=499399, null(1)=0, avgsize(1)=4, distinct(2)=499399, null(2)=0, avgsize(2)=4, distinct(11)=499399, null(11)=0, avgsize(11)=4, distinct(14)=499399, null(14)=0, avgsize(14)=4, distinct(15)=499399, null(15)=0, avgsize(15)=4, distinct(59)=499399, null(59)=0, avgsize(59)=4]
      ├── key: (11)
      ├── fd: (1)-->(2), (11)-->(1,2,14,15,59)
      ├── inner-join (hash)
      │    ├── save-table-name: q18_inner_join_3
      │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_totalprice:14(float!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_quantity:26(float!null)
      │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
      │    ├── stats: [rows=2016723, distinct(1)=99656, null(1)=0, avgsize(1)=4, distinct(2)=150000, null(2)=0, avgsize(2)=4, distinct(11)=499399, null(11)=0, avgsize(11)=4, distinct(12)=99656, null(12)=0, avgsize(12)=4, distinct(14)=488633, null(14)=0, avgsize(14)=4, distinct(15)=2406, null(15)=0, avgsize(15)=4, distinct(22)=499399, null(22)=0, avgsize(22)=4, distinct(26)=50, null(26)=0, avgsize(26)=4]
      │    ├── fd: (1)-->(2), (11)-->(12,14,15), (11)==(22), (22)==(11), (1)==(12), (12)==(1)
      │    ├── inner-join (merge)
      │    │    ├── save-table-name: q18_merge_join_4
      │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_totalprice:14(float!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_quantity:26(float!null)
      │    │    ├── left ordering: +22
      │    │    ├── right ordering: +11
      │    │    ├── stats: [rows=2000764, distinct(11)=509090, null(11)=0, avgsize(11)=4, distinct(12)=99656, null(12)=0, avgsize(12)=4, distinct(14)=497246, null(14)=0, avgsize(14)=4, distinct(15)=2406, null(15)=0, avgsize(15)=4, distinct(22)=509090, null(22)=0, avgsize(22)=4, distinct(26)=50, null(26)=0, avgsize(26)=4]
      │    │    ├── fd: (11)-->(12,14,15), (11)==(22), (22)==(11)
      │    │    ├── scan lineitem
      │    │    │    ├── save-table-name: q18_scan_5
      │    │    │    ├── columns: l_orderkey:22(int!null) l_quantity:26(float!null)
      │    │    │    ├── stats: [rows=6002293, distinct(22)=1.52727e+06, null(22)=0, avgsize(22)=4, distinct(26)=50, null(26)=0, avgsize(26)=4]
      │    │    │    │   histogram(22)=  0  600  29411   600   29411   600   29411   600   29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600
      │    │    │    │                 <--- 576 ------- 38535 ------- 66885 ------- 93380 ------- 127425 ------- 157218 ------- 184483 ------- 215330 ------- 252869 ------- 283878 ------- 313798 ------- 337056 ------- 372549 ------- 399591 ------- 426245 ------- 460578 ------- 498439 ------- 526049 ------- 554468 ------- 577921 ------- 609187 ------- 639524 ------- 665345 ------- 686180 ------- 721539 ------- 755680 ------- 782756 ------- 814496 ------- 845446 ------- 872130 ------- 910912 ------- 933697 ------- 965184 ------- 1000353 ------- 1038658 ------- 1073667 ------- 1097891 ------- 1131330 ------- 1157732 ------- 1179943 ------- 1206401 ------- 1230150 ------- 1261824 ------- 1293217 ------- 1326754 ------- 1357573 ------- 1390145 ------- 1429312 ------- 1460418 ------- 1491104 ------- 1523937 ------- 1559812 ------- 1591653 ------- 1615174 ------- 1646759 ------- 1670465 ------- 1696321 ------- 1724192 ------- 1748033 ------- 1777570 ------- 1807428 ------- 1836962 ------- 1872481 ------- 1902817 ------- 1928324 ------- 1960775 ------- 1985989 ------- 2019107 ------- 2044613 ------- 2071490 ------- 2101959 ------- 2135555 ------- 2164486 ------- 2186337 ------- 2213989 ------- 2246309 ------- 2276992 ------- 2306403 ------- 2329921 ------- 2354977 ------- 2380711 ------- 2410529 ------- 2437920 ------- 2462017 ------- 2483714 ------- 2513920 ------- 2542855 ------- 2574112 ------- 2596035 ------- 2625031 ------- 2658051 ------- 2695046 ------- 2725222 ------- 2754245 ------- 2777702 ------- 2804896 ------- 2844579 ------- 2873860 ------- 2903459 ------- 2933249 ------- 2965479 ------- 2996160 ------- 3022976 ------- 3053152 ------- 3083623 ------- 3111136 ------- 3144033 ------- 3180134 ------- 3209799 ------- 3239394 ------- 3270886 ------- 3297664 ------- 3329444 ------- 3357574 ------- 3380838 ------- 3412196 ------- 3438917 ------- 3462467 ------- 3498629 ------- 3530208 ------- 3562148 ------- 3589889 ------- 3621063 ------- 3655456 ------- 3686724 ------- 3709029 ------- 3738215 ------- 3767687 ------- 3804547 ------- 3831142 ------- 3875111 ------- 3905605 ------- 3933795 ------- 3966593 ------- 3995558 ------- 4020134 ------- 4052513 ------- 4078949 ------- 4114208 ------- 4149762 ------- 4176135 ------- 4207782 ------- 4241376 ------- 4270502 ------- 4304167 ------- 4333669 ------- 4362818 ------- 4393537 ------- 4423076 ------- 4452064 ------- 4491143 ------- 4522723 ------- 4550883 ------- 4581382 ------- 4616002 ------- 4649410 ------- 4680485 ------- 4715584 ------- 4740036 ------- 4771554 ------- 4799461 ------- 4826690 ------- 4855525 ------- 4887974 ------- 4917479 ------- 4950885 ------- 4984195 ------- 5010113 ------- 5033571 ------- 5065472 ------- 5100512 ------- 5129413 ------- 5160069 ------- 5186596 ------- 5221538 ------- 5252964 ------- 5284069 ------- 5314051 ------- 5353026 ------- 5388961 ------- 5424644 ------- 5452676 ------- 5483553 ------- 5516612 ------- 5551041 ------- 5579878 ------- 5612576 ------- 5643427 ------- 5673666 ------- 5709218 ------- 5737221 ------- 5766119 ------- 5795044 ------- 5826560 ------- 5855943 ------- 5889604 ------- 5917607 ------- 5942535 ------- 5969639 ------- 5999557
      │    │    │    │   histogram(26)=  0 1.1524e+05 5.7772e+06 1.0984e+05
      │    │    │    │                 <----- 1.0 ----------------- 50.0 --
      │    │    │    └── ordering: +22
      │    │    ├── semi-join (merge)
      │    │    │    ├── save-table-name: q18_merge_join_6
      │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_totalprice:14(float!null) o_orderdate:15(date!null)
      │    │    │    ├── left ordering: +11
      │    │    │    ├── right ordering: +40
      │    │    │    ├── stats: [rows=509090, distinct(11)=509090, null(11)=0, avgsize(11)=4, distinct(12)=99656, null(12)=0, avgsize(12)=4, distinct(14)=507049, null(14)=0, avgsize(14)=4, distinct(15)=2406, null(15)=0, avgsize(15)=4]
      │    │    │    ├── key: (11)
      │    │    │    ├── fd: (11)-->(12,14,15)
      │    │    │    ├── ordering: +11
      │    │    │    ├── scan orders
      │    │    │    │    ├── save-table-name: q18_scan_7
      │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_totalprice:14(float!null) o_orderdate:15(date!null)
      │    │    │    │    ├── stats: [rows=1500000, distinct(11)=1.5e+06, null(11)=0, avgsize(11)=4, distinct(12)=99853, null(12)=0, avgsize(12)=4, distinct(14)=1.4694e+06, null(14)=0, avgsize(14)=4, distinct(15)=2406, null(15)=0, avgsize(15)=4]
      │    │    │    │    │   histogram(11)=  0           0            0 0.99998 7461.9 0.99998 7285.9 0.99998 7544.9 0.99998 7589.9 0.99998  7222.9 0.99998  7324.9 0.99998  7506.9 0.99998  7351.9 0.99998  7777.9 0.99998  7576.9 0.99998  7731.9 0.99998  7694.9 0.99998  7586.9 0.99998  7569.9 0.99998  7757.9 0.99998  7624.9 0.99998  7506.9 0.99998  7245.9 0.99998  7820.9 0.99998  7539.9 0.99998  7455.9 0.99998  7589.9 0.99998  7740.9 0.99998  7604.9 0.99998  7710.9 0.99998  7709.9 0.99998  7708.9 0.99998  7490.9 0.99998  7527.9 0.99998  7331.9 0.99998  7311.9 0.99998  7576.9  0.99998  7545.9  0.99998  7277.9  0.99998  7392.9  0.99998  7508.9  0.99998  7622.9  0.99998  7581.9  0.99998  7775.9  0.99998  7523.9  0.99998  7568.9  0.99998  7483.9  0.99998  7662.9  0.99998  7368.9  0.99998  7470.9  0.99998  7380.9  0.99998  7647.9  0.99998  7381.9  0.99998  7635.9  0.99998  7490.9  0.99998  7446.9  0.99998  7526.9  0.99998  7441.9  0.99998  7265.9  0.99998  7960.9  0.99998  7251.9  0.99998  7514.9  0.99998  7294.9  0.99998  7502.9  0.99998  7285.9  0.99998  7320.9  0.99998  7235.9  0.99998  7451.9  0.99998  7810.9  0.99998  7378.9  0.99998  7418.9  0.99998  7661.9  0.99998  7404.9  0.99998  7432.9  0.99998  7579.9  0.99998  7836.9  0.99998  7445.9  0.99998  7355.9  0.99998  7617.9  0.99998  7110.9  0.99998  7398.9  0.99998  7622.9  0.99998  7655.9  0.99998  7433.9  0.99998  7656.9  0.99998  7404.9  0.99998  7474.9  0.99998  7572.9  0.99998  7688.9  0.99998  7559.9  0.99998  7414.9  0.99998  7523.9  0.99998  7558.9  0.99998  7330.9  0.99998  7587.9  0.99998  7388.9  0.99998  7327.9  0.99998  7671.9  0.99998  7523.9  0.99998  7687.9  0.99998  7524.9  0.99998  7614.9  0.99998  7463.9  0.99998  7594.9  0.99998  7372.9  0.99998  7670.9  0.99998  7310.9  0.99998  7270.9  0.99998  7399.9  0.99998  7688.9  0.99998  7487.9  0.99998  7556.9  0.99998  7365.9  0.99998  7521.9  0.99998  7762.9  0.99998  7386.9  0.99998  7399.9  0.99998  7562.9  0.99998  7502.9  0.99998  7201.9  0.99998  7595.9  0.99998  7525.9  0.99998  7451.9  0.99998  7280.9  0.99998  7307.9  0.99998  7386.9  0.99998  7345.9  0.99998  7383.9  0.99998  7530.9  0.99998  7706.9  0.99998  7581.9  0.99998  7512.9  0.99998  7536.9  0.99998  7210.9  0.99998  7689.9  0.99998  7658.9  0.99998  7358.9  0.99998  7646.9  0.99998  7252.9  0.99998  7327.9  0.99998  7525.9  0.99998  7564.9  0.99998  7524.9  0.99998  7438.9  0.99998  7493.9  0.99998  7419.9  0.99998  7509.9  0.99998  7595.9  0.99998  7396.9  0.99998  7378.9  0.99998  7330.9  0.99998  7387.9  0.99998  7552.9  0.99998  7330.9  0.99998  7431.9  0.99998  7773.9  0.99998  7853.9  0.99998  7562.9  0.99998  7548.9  0.99998  7847.9  0.99998  7933.9  0.99998  7768.9  0.99998  7738.9  0.99998  7480.9  0.99998  7679.9  0.99998  7663.9  0.99998  7587.9  0.99998  7527.9  0.99998  7466.9  0.99998  7444.9  0.99998  7519.9  0.99998  7830.9  0.99998  7568.9  0.99998  7671.9  0.99998  7637.9  0.99998  7462.9  0.99998  7851.9  0.99998  7483.9  0.99998  7765.9  0.99998  7451.9  0.99998  8050.9  0.99998  7644.9  0.99998  7724.9  0.99998  7471.9  0.99998  7517.9  0.99998  7830.9  0.99998  7387.9  0.99998  7749.9  0.99998  7545.9  0.99998  7718.9  0.99998  7384.9  0.99998  7464.9  0.99998  7467.9  0.99998  7809.9  0.99998  7766.9  0.99998  7511.9  0.99998  7641.9  0.99998  7711.9  0.99998  7729.9  0.99998  7631.9  0.99998  7734.9  0.99998  7931.9  0.99998  7586.9  0.99998  7964.9  0.99998  0           0
      │    │    │    │    │                 <--- -9223372036854775808 --- 1472 --------- 30469 -------- 54689 -------- 85922 -------- 118369 -------- 140867 -------- 166146 -------- 196357 -------- 222375 -------- 259877 -------- 291970 -------- 328227 -------- 363490 -------- 395873 -------- 427783 -------- 464741 -------- 498146 -------- 528358 -------- 551493 -------- 590144 -------- 621254 -------- 650083 -------- 682531 -------- 719041 -------- 751906 -------- 787617 -------- 823298 -------- 858944 -------- 888739 -------- 919527 -------- 944996 -------- 969922 -------- 1002020 -------- 1033280 -------- 1057284 -------- 1084416 -------- 1114693 -------- 1148034 -------- 1180262 -------- 1217697 -------- 1248386 -------- 1280261 -------- 1309862 -------- 1344263 -------- 1370759 -------- 1400003 -------- 1426822 -------- 1460837 -------- 1487680 -------- 1521376 -------- 1551174 -------- 1579779 -------- 1610532 -------- 1638983 -------- 1662660 -------- 1705024 -------- 1728321 -------- 1758757 -------- 1783239 -------- 1813344 -------- 1837573 -------- 1862757 -------- 1885607 -------- 1914340 -------- 1952706 -------- 1979458 -------- 2007302 -------- 2041697 -------- 2069157 -------- 2097383 -------- 2129571 -------- 2168643 -------- 2197223 -------- 2223363 -------- 2256577 -------- 2275975 -------- 2303264 -------- 2336608 -------- 2370823 -------- 2399074 -------- 2433315 -------- 2460771 -------- 2490114 -------- 2522119 -------- 2557218 -------- 2588866 -------- 2616610 -------- 2647296 -------- 2678913 -------- 2704354 -------- 2736743 -------- 2763779 -------- 2789157 -------- 2823812 -------- 2854502 -------- 2889572 -------- 2920263 -------- 2953378 -------- 2982439 -------- 3015013 -------- 3041603 -------- 3076227 -------- 3101125 -------- 3124930 -------- 3152260 -------- 3187366 -------- 3217059 -------- 3248611 -------- 3275008 -------- 3305634 -------- 3342721 -------- 3369702 -------- 3397031 -------- 3428771 -------- 3458885 -------- 3480806 -------- 3513408 -------- 3544129 -------- 3572866 -------- 3596965 -------- 3621794 -------- 3648771 -------- 3674624 -------- 3701510 -------- 3732387 -------- 3767974 -------- 3800224 -------- 3830599 -------- 3861635 -------- 3883808 -------- 3918949 -------- 3953249 -------- 3979456 -------- 4013443 -------- 4036775 -------- 4062148 -------- 4092867 -------- 4124641 -------- 4155333 -------- 4183718 -------- 4213574 -------- 4241445 -------- 4271751 -------- 4304354 -------- 4331590 -------- 4358338 -------- 4383782 -------- 4410791 -------- 4442244 -------- 4467687 -------- 4495876 -------- 4529761 -------- 4565792 -------- 4593991 -------- 4621829 -------- 4657703 -------- 4695878 -------- 4729632 -------- 4762593 -------- 4788581 -------- 4819943 -------- 4850885 -------- 4879777 -------- 4907042 -------- 4932640 -------- 4957638 -------- 4984675 -------- 5020100 -------- 5048481 -------- 5079622 -------- 5109862 -------- 5135363 -------- 5171364 -------- 5197414 -------- 5231104 -------- 5256289 -------- 5297604 -------- 5328038 -------- 5360608 -------- 5386337 -------- 5413315 -------- 5448743 -------- 5472197 -------- 5505440 -------- 5533184 -------- 5565603 -------- 5588963 -------- 5614503 -------- 5640135 -------- 5675008 -------- 5708709 -------- 5735522 -------- 5765862 -------- 5798085 -------- 5830787 -------- 5860867 -------- 5893703 -------- 5931844 -------- 5960706 -------- 5999719 --- 9223372036854775807
      │    │    │    │    │   histogram(12)=  0 150  7350  150  7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7200   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7200   450   7350   150   7200   300   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   150   7200   300   7350   150   7200   300   7350   300   7200   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   300   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   300   7350   150   7350   300    7350   150    7350   150    7350   300    7350   150    7350   150    7350   150    7350   150    7350   150    7350   450    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   300    7350   300    7350   150    7350   150    7350   150    7350   300    7350   150    7350   150    7350   150    7350   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7350   300    7500   150    7500   150    7500   150    7350   300    7500   150    7500   150    7500   150    7500   150    7500   150    7500   300    7350   150    7500   150    7350   300    7500   150    7500   150    7500   150    7500   150    7500   150
      │    │    │    │    │                 <--- 25 ------ 758 ------ 1460 ------ 2207 ------ 2911 ------ 3766 ------ 4592 ------ 5371 ------ 6080 ------ 6773 ------ 7421 ------ 8009 ------ 8668 ------ 9583 ------ 10459 ------ 11120 ------ 11872 ------ 12722 ------ 13612 ------ 14390 ------ 15179 ------ 15862 ------ 16658 ------ 17234 ------ 18083 ------ 18862 ------ 19577 ------ 20138 ------ 20869 ------ 21644 ------ 22265 ------ 23105 ------ 23966 ------ 24782 ------ 25532 ------ 26317 ------ 27071 ------ 27664 ------ 28414 ------ 29291 ------ 30097 ------ 30917 ------ 31571 ------ 32357 ------ 33175 ------ 33820 ------ 34678 ------ 35311 ------ 35935 ------ 36689 ------ 37360 ------ 37969 ------ 38792 ------ 39442 ------ 40268 ------ 41044 ------ 41656 ------ 42370 ------ 43085 ------ 43909 ------ 44672 ------ 45326 ------ 46310 ------ 47150 ------ 47801 ------ 48563 ------ 49336 ------ 50111 ------ 50747 ------ 51631 ------ 52250 ------ 52873 ------ 53753 ------ 54632 ------ 55324 ------ 56141 ------ 56924 ------ 57524 ------ 58382 ------ 59069 ------ 59915 ------ 60779 ------ 61466 ------ 62306 ------ 63041 ------ 63799 ------ 64415 ------ 65452 ------ 66266 ------ 67055 ------ 67754 ------ 68510 ------ 69350 ------ 70127 ------ 70702 ------ 71462 ------ 72428 ------ 73267 ------ 74005 ------ 74719 ------ 75695 ------ 76400 ------ 77000 ------ 77953 ------ 78557 ------ 79315 ------ 79925 ------ 80530 ------ 81220 ------ 81902 ------ 82607 ------ 83179 ------ 84025 ------ 84970 ------ 85844 ------ 86657 ------ 87184 ------ 88037 ------ 88840 ------ 89531 ------ 90134 ------ 90893 ------ 91651 ------ 92528 ------ 93278 ------ 93944 ------ 94579 ------ 95708 ------ 96323 ------ 97174 ------ 97856 ------ 98602 ------ 99260 ------ 99967 ------ 100567 ------ 101209 ------ 101923 ------ 102734 ------ 103540 ------ 104402 ------ 105101 ------ 105854 ------ 106667 ------ 107584 ------ 108601 ------ 109366 ------ 110185 ------ 111109 ------ 112079 ------ 112712 ------ 113375 ------ 114088 ------ 114719 ------ 115409 ------ 116246 ------ 117028 ------ 117703 ------ 118441 ------ 119161 ------ 119911 ------ 120542 ------ 121391 ------ 122210 ------ 123049 ------ 123794 ------ 124418 ------ 125149 ------ 125963 ------ 126791 ------ 127537 ------ 128390 ------ 129067 ------ 129604 ------ 130400 ------ 131039 ------ 131752 ------ 132460 ------ 133154 ------ 133693 ------ 134515 ------ 135289 ------ 135959 ------ 136651 ------ 137456 ------ 138158 ------ 138947 ------ 139789 ------ 140599 ------ 141446 ------ 142318 ------ 143132 ------ 143698 ------ 144484 ------ 145376 ------ 146068 ------ 146774 ------ 147730 ------ 148436 ------ 149324 ------ 149992
      │    │    │    │    │   histogram(14)=  0         150         1.4997e+06      150
      │    │    │    │    │                 <--- 929.1190185546875 ------------ 465073.34375
      │    │    │    │    │   histogram(15)=  0      750       7350      450       6600      900       7200      750       7350      450       6750      750       7350      750       7200      300       6600      1050      7350      600       7350      600       7200      900       7350      750       6900      750       6900      900       6600      900       7350      1200      6600      1350      6900      900       7200      300       7050      600       7350      750       7200      300       6300      1050      6900      600       7050      900       6450      900       6150      1200      6750      750       7050      750       6750      750       6900      1050      6450      900       6450      900       6300      1200      7200      900       6600      750       6900      1200      7050      1200      7200      600       6750      1200      6900      750       6900      450       6900      600       6750      1650      5850      1500      7200      300       7200      600       6600      750       7200      900       6900      900       6900      450       6600      750       6750      1200      6750      600       7200      150       6900      1350      6300      1050      7200      600       7050      600       7200      1050      7050      450       7050      900       7200      750       6450      1200      6900      1050      6600      900       7050      750       6750      900       6900      600       7200      450       6900      600       7050      900       6600      1050      6900      600       7050      1350      7200      450       6450      900       7050      1350      7200      150       7050      750       6900      1050      7050      900       6750      600       7050      1800      6600      750       6300      1350      7200      600       7200      450       6600      900       6900      450       6750      600       6600      900       7050      300       7050      450       7050      750       6900      600       6900      750       7050      300       7050      450       7200      600       7200      750       7200      150       7050      750       6750      1050      7050      750       7050      450       6600      600       6750      600       7050      300       6750      900       6900      450       6900      450       6600      1050      7050      450       6300      1200      6750      600       6900      750       6600      750       6750      450       6750      600       7050      900       6750      600       6600      750       6900      600       6750      750       6750      750       6900      600       6600      600       6300      1050      7050      450       6750      1050      6750      750       6750      900       6900      450       6450      750       6900      300       6450      750       6900      1050      7050      600       6900      750       7050      750       6600      1200      6600      1050      6750      1050      6600      750       6900      600       7050      150       7050      450       6450      1200      6750      750       7050      600       6600      450       6750      750       6450      750       6750      750       6600      600       5700      1350      6300      900       6900      600       6750      750       6300      900       6450      600       6600      450       6000      1050      6750      450       6300      900       6900      900       6450      600       6900      750       6450      750       6600      1200      6750      450       6300      900       6600      600       6600      1200      6750      1200      6600      1050      6300      1050      6450      900       6600      450       6750      600       6300      600       6300      600       6000      1200      6450      1050      6150      750       6300      600       6600      600       6450      600       6600      900       5550      1200      6450      900       5550      1050      6000      900       5850      900       6300      300       6450      600       6450      450       5850      450
      │    │    │    │    │                 <--- '1992-01-01' ------ '1992-01-14' ------ '1992-01-25' ------ '1992-02-09' ------ '1992-02-23' ------ '1992-03-06' ------ '1992-03-19' ------ '1992-03-30' ------ '1992-04-12' ------ '1992-04-24' ------ '1992-05-07' ------ '1992-05-20' ------ '1992-05-31' ------ '1992-06-13' ------ '1992-06-27' ------ '1992-07-09' ------ '1992-07-21' ------ '1992-08-03' ------ '1992-08-17' ------ '1992-09-01' ------ '1992-09-13' ------ '1992-09-23' ------ '1992-10-06' ------ '1992-10-16' ------ '1992-10-29' ------ '1992-11-09' ------ '1992-11-20' ------ '1992-12-03' ------ '1992-12-14' ------ '1992-12-27' ------ '1993-01-09' ------ '1993-01-21' ------ '1993-02-01' ------ '1993-02-13' ------ '1993-02-23' ------ '1993-03-07' ------ '1993-03-17' ------ '1993-03-30' ------ '1993-04-12' ------ '1993-04-24' ------ '1993-05-08' ------ '1993-05-19' ------ '1993-06-01' ------ '1993-06-12' ------ '1993-06-20' ------ '1993-06-30' ------ '1993-07-11' ------ '1993-07-22' ------ '1993-08-02' ------ '1993-08-14' ------ '1993-08-25' ------ '1993-09-05' ------ '1993-09-16' ------ '1993-09-27' ------ '1993-10-10' ------ '1993-10-24' ------ '1993-11-04' ------ '1993-11-15' ------ '1993-11-27' ------ '1993-12-10' ------ '1993-12-25' ------ '1994-01-08' ------ '1994-01-19' ------ '1994-01-30' ------ '1994-02-12' ------ '1994-02-25' ------ '1994-03-06' ------ '1994-03-19' ------ '1994-03-31' ------ '1994-04-12' ------ '1994-04-22' ------ '1994-05-05' ------ '1994-05-19' ------ '1994-05-30' ------ '1994-06-10' ------ '1994-06-23' ------ '1994-07-05' ------ '1994-07-16' ------ '1994-07-25' ------ '1994-08-06' ------ '1994-08-18' ------ '1994-08-31' ------ '1994-09-10' ------ '1994-09-25' ------ '1994-10-06' ------ '1994-10-21' ------ '1994-11-01' ------ '1994-11-12' ------ '1994-11-27' ------ '1994-12-08' ------ '1994-12-21' ------ '1995-01-04' ------ '1995-01-17' ------ '1995-02-01' ------ '1995-02-11' ------ '1995-02-23' ------ '1995-03-08' ------ '1995-03-21' ------ '1995-04-05' ------ '1995-04-18' ------ '1995-04-30' ------ '1995-05-13' ------ '1995-05-25' ------ '1995-06-08' ------ '1995-06-22' ------ '1995-07-07' ------ '1995-07-19' ------ '1995-07-29' ------ '1995-08-13' ------ '1995-08-24' ------ '1995-09-05' ------ '1995-09-20' ------ '1995-10-05' ------ '1995-10-14' ------ '1995-10-25' ------ '1995-11-06' ------ '1995-11-16' ------ '1995-11-26' ------ '1995-12-09' ------ '1995-12-21' ------ '1995-12-31' ------ '1996-01-11' ------ '1996-01-23' ------ '1996-02-03' ------ '1996-02-21' ------ '1996-03-02' ------ '1996-03-16' ------ '1996-03-27' ------ '1996-04-08' ------ '1996-04-20' ------ '1996-05-03' ------ '1996-05-13' ------ '1996-05-24' ------ '1996-06-06' ------ '1996-06-19' ------ '1996-06-30' ------ '1996-07-14' ------ '1996-07-25' ------ '1996-08-04' ------ '1996-08-19' ------ '1996-09-03' ------ '1996-09-14' ------ '1996-09-25' ------ '1996-10-09' ------ '1996-10-19' ------ '1996-11-01' ------ '1996-11-11' ------ '1996-11-23' ------ '1996-12-05' ------ '1996-12-19' ------ '1996-12-29' ------ '1997-01-12' ------ '1997-01-22' ------ '1997-02-06' ------ '1997-02-24' ------ '1997-03-08' ------ '1997-03-19' ------ '1997-04-01' ------ '1997-04-12' ------ '1997-04-23' ------ '1997-05-05' ------ '1997-05-15' ------ '1997-05-25' ------ '1997-06-07' ------ '1997-06-18' ------ '1997-07-02' ------ '1997-07-11' ------ '1997-07-24' ------ '1997-08-04' ------ '1997-08-17' ------ '1997-08-26' ------ '1997-09-09' ------ '1997-09-19' ------ '1997-09-28' ------ '1997-10-09' ------ '1997-10-19' ------ '1997-11-01' ------ '1997-11-13' ------ '1997-11-24' ------ '1997-12-05' ------ '1997-12-20' ------ '1997-12-30' ------ '1998-01-12' ------ '1998-01-23' ------ '1998-02-05' ------ '1998-02-17' ------ '1998-02-26' ------ '1998-03-12' ------ '1998-03-23' ------ '1998-04-03' ------ '1998-04-13' ------ '1998-04-24' ------ '1998-05-07' ------ '1998-05-19' ------ '1998-06-01' ------ '1998-06-13' ------ '1998-06-27' ------ '1998-07-12' ------ '1998-07-26' ------ '1998-08-02'
      │    │    │    │    ├── key: (11)
      │    │    │    │    ├── fd: (11)-->(12,14,15)
      │    │    │    │    └── ordering: +11
      │    │    │    ├── select
      │    │    │    │    ├── save-table-name: q18_select_8
      │    │    │    │    ├── columns: l_orderkey:40(int!null) sum:58(float!null)
      │    │    │    │    ├── stats: [rows=509090, distinct(40)=509090, null(40)=0, avgsize(40)=4, distinct(58)=509090, null(58)=0, avgsize(58)=4]
      │    │    │    │    ├── key: (40)
      │    │    │    │    ├── fd: (40)-->(58)
      │    │    │    │    ├── ordering: +40
      │    │    │    │    ├── group-by (streaming)
      │    │    │    │    │    ├── save-table-name: q18_group_by_9
      │    │    │    │    │    ├── columns: l_orderkey:40(int!null) sum:58(float!null)
      │    │    │    │    │    ├── grouping columns: l_orderkey:40(int!null)
      │    │    │    │    │    ├── stats: [rows=1527270, distinct(40)=1.52727e+06, null(40)=0, avgsize(40)=4, distinct(58)=1.52727e+06, null(58)=0, avgsize(58)=4]
      │    │    │    │    │    ├── key: (40)
      │    │    │    │    │    ├── fd: (40)-->(58)
      │    │    │    │    │    ├── ordering: +40
      │    │    │    │    │    ├── scan lineitem
      │    │    │    │    │    │    ├── save-table-name: q18_scan_10
      │    │    │    │    │    │    ├── columns: l_orderkey:40(int!null) l_quantity:44(float!null)
      │    │    │    │    │    │    ├── stats: [rows=6002293, distinct(40)=1.52727e+06, null(40)=0, avgsize(40)=4, distinct(44)=50, null(44)=0, avgsize(44)=4]
      │    │    │    │    │    │    │   histogram(40)=  0  600  29411   600   29411   600   29411   600   29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411   600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    29411    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600    30011    600
      │    │    │    │    │    │    │                 <--- 576 ------- 38535 ------- 66885 ------- 93380 ------- 127425 ------- 157218 ------- 184483 ------- 215330 ------- 252869 ------- 283878 ------- 313798 ------- 337056 ------- 372549 ------- 399591 ------- 426245 ------- 460578 ------- 498439 ------- 526049 ------- 554468 ------- 577921 ------- 609187 ------- 639524 ------- 665345 ------- 686180 ------- 721539 ------- 755680 ------- 782756 ------- 814496 ------- 845446 ------- 872130 ------- 910912 ------- 933697 ------- 965184 ------- 1000353 ------- 1038658 ------- 1073667 ------- 1097891 ------- 1131330 ------- 1157732 ------- 1179943 ------- 1206401 ------- 1230150 ------- 1261824 ------- 1293217 ------- 1326754 ------- 1357573 ------- 1390145 ------- 1429312 ------- 1460418 ------- 1491104 ------- 1523937 ------- 1559812 ------- 1591653 ------- 1615174 ------- 1646759 ------- 1670465 ------- 1696321 ------- 1724192 ------- 1748033 ------- 1777570 ------- 1807428 ------- 1836962 ------- 1872481 ------- 1902817 ------- 1928324 ------- 1960775 ------- 1985989 ------- 2019107 ------- 2044613 ------- 2071490 ------- 2101959 ------- 2135555 ------- 2164486 ------- 2186337 ------- 2213989 ------- 2246309 ------- 2276992 ------- 2306403 ------- 2329921 ------- 2354977 ------- 2380711 ------- 2410529 ------- 2437920 ------- 2462017 ------- 2483714 ------- 2513920 ------- 2542855 ------- 2574112 ------- 2596035 ------- 2625031 ------- 2658051 ------- 2695046 ------- 2725222 ------- 2754245 ------- 2777702 ------- 2804896 ------- 2844579 ------- 2873860 ------- 2903459 ------- 2933249 ------- 2965479 ------- 2996160 ------- 3022976 ------- 3053152 ------- 3083623 ------- 3111136 ------- 3144033 ------- 3180134 ------- 3209799 ------- 3239394 ------- 3270886 ------- 3297664 ------- 3329444 ------- 3357574 ------- 3380838 ------- 3412196 ------- 3438917 ------- 3462467 ------- 3498629 ------- 3530208 ------- 3562148 ------- 3589889 ------- 3621063 ------- 3655456 ------- 3686724 ------- 3709029 ------- 3738215 ------- 3767687 ------- 3804547 ------- 3831142 ------- 3875111 ------- 3905605 ------- 3933795 ------- 3966593 ------- 3995558 ------- 4020134 ------- 4052513 ------- 4078949 ------- 4114208 ------- 4149762 ------- 4176135 ------- 4207782 ------- 4241376 ------- 4270502 ------- 4304167 ------- 4333669 ------- 4362818 ------- 4393537 ------- 4423076 ------- 4452064 ------- 4491143 ------- 4522723 ------- 4550883 ------- 4581382 ------- 4616002 ------- 4649410 ------- 4680485 ------- 4715584 ------- 4740036 ------- 4771554 ------- 4799461 ------- 4826690 ------- 4855525 ------- 4887974 ------- 4917479 ------- 4950885 ------- 4984195 ------- 5010113 ------- 5033571 ------- 5065472 ------- 5100512 ------- 5129413 ------- 5160069 ------- 5186596 ------- 5221538 ------- 5252964 ------- 5284069 ------- 5314051 ------- 5353026 ------- 5388961 ------- 5424644 ------- 5452676 ------- 5483553 ------- 5516612 ------- 5551041 ------- 5579878 ------- 5612576 ------- 5643427 ------- 5673666 ------- 5709218 ------- 5737221 ------- 5766119 ------- 5795044 ------- 5826560 ------- 5855943 ------- 5889604 ------- 5917607 ------- 5942535 ------- 5969639 ------- 5999557
      │    │    │    │    │    │    │   histogram(44)=  0 1.1524e+05 5.7772e+06 1.0984e+05
      │    │    │    │    │    │    │                 <----- 1.0 ----------------- 50.0 --
      │    │    │    │    │    │    └── ordering: +40
      │    │    │    │    │    └── aggregations
      │    │    │    │    │         └── sum [as=sum:58, type=float, outer=(44)]
      │    │    │    │    │              └── l_quantity:44 [type=float]
      │    │    │    │    └── filters
      │    │    │    │         └── sum:58 > 300.0 [type=bool, outer=(58), constraints=(/58: [/300.00000000000006 - ]; tight)]
      │    │    │    └── filters (true)
      │    │    └── filters (true)
      │    ├── scan customer
      │    │    ├── save-table-name: q18_scan_11
      │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null)
      │    │    ├── stats: [rows=150000, distinct(1)=148813, null(1)=0, avgsize(1)=4, distinct(2)=150000, null(2)=0, avgsize(2)=4]
      │    │    │   histogram(1)=  0  5   769   5   765   5    732   5    744   5    731   5    754   5    772   5    757   5    713   5    741   5    808   5    744   5    739   5    687    5    820    5    761    5    782    5    632    5    711    5    692    5    648    5    770    5    765    5    702    5    751    5    807    5    794    5    735    5    807    5    719    5    773    5    781    5    684    5    748    5    682    5    703    5    794    5    718    5    807    5    674    5    747    5    677    5    813    5    666    5    766    5    822    5    703    5    676    5    765    5    693    5    723    5    780    5    793    5    770    5    696    5    775    5    764    5    884    5    696    5    688    5    637    5    789    5    702    5    732    5    697    5    769    5    739    5    744    5    861    5    791    5    726    5    793    5    730    5    763    5    789    5    797    5    775    5    862    5    780    5    746    5    783    5    743    5    822    5    806    5    775    5    727    5    724    5    799    5    707    5    757    5    614    5    747    5    704    5    740    5    749    5    735    5    741    5    807    5    827    5    816    5    702    5    699    5    803    5    793    5    672    5    831    5    694    5    746    5    731    5    686    5    685    5    695    5    828    5    756    5    722    5    749    5    790    5    758    5    750    5    782    5    733    5    778    5    762    5    758    5    731    5    778    5    663    5    696    5    684    5    796    5    770    5    656    5    690    5     747    5     782    5     785    5     751    5     697    5     663    5     766    5     695    5     866    5     813    5     765    5     901    5     747    5     683    5     706    5     689    5     734    5     715    5     752    5     855    5     771    5     717    5     794    5     760    5     827    5     747    5     757    5     767    5     726    5     690    5     787    5     783    5     744    5     761    5     746    5     793    5     696    5     749    5     745    5     755    5     800    5     778    5     814    5     826    5     700    5     740    5     773    5     713    5     824    5     792    5     702    5     734    5     751    5     716    5     718    5     722    5     784    5     778    5     700    5     714    5     739    5     748    5     697    5     751    5     663    5     740    5
      │    │    │                <--- 37 ----- 834 ----- 1623 ----- 2351 ----- 3101 ----- 3828 ----- 4598 ----- 5401 ----- 6176 ----- 6868 ----- 7613 ----- 8479 ----- 9230 ----- 9972 ----- 10613 ----- 11500 ----- 12282 ----- 13103 ----- 13624 ----- 14312 ----- 14962 ----- 15520 ----- 16319 ----- 17109 ----- 17780 ----- 18543 ----- 19408 ----- 20250 ----- 20984 ----- 21848 ----- 22551 ----- 23355 ----- 24174 ----- 24809 ----- 25567 ----- 26196 ----- 26868 ----- 27710 ----- 28412 ----- 29276 ----- 29889 ----- 30645 ----- 31264 ----- 32139 ----- 32736 ----- 33527 ----- 34418 ----- 35091 ----- 35709 ----- 36498 ----- 37150 ----- 37861 ----- 38677 ----- 39517 ----- 40316 ----- 40975 ----- 41782 ----- 42569 ----- 43565 ----- 44224 ----- 44867 ----- 45399 ----- 46231 ----- 46902 ----- 47630 ----- 48291 ----- 49087 ----- 49829 ----- 50580 ----- 51538 ----- 52375 ----- 53092 ----- 53932 ----- 54656 ----- 55442 ----- 56274 ----- 57121 ----- 57929 ----- 58888 ----- 59705 ----- 60460 ----- 61282 ----- 62031 ----- 62922 ----- 63785 ----- 64593 ----- 65311 ----- 66024 ----- 66875 ----- 67556 ----- 68331 ----- 68808 ----- 69564 ----- 70239 ----- 70983 ----- 71744 ----- 72478 ----- 73223 ----- 74088 ----- 74988 ----- 75868 ----- 76539 ----- 77203 ----- 78061 ----- 78901 ----- 79510 ----- 80417 ----- 81071 ----- 81826 ----- 82553 ----- 83191 ----- 83828 ----- 84485 ----- 85386 ----- 86159 ----- 86868 ----- 87628 ----- 88463 ----- 89240 ----- 90002 ----- 90822 ----- 91553 ----- 92367 ----- 93152 ----- 93929 ----- 94656 ----- 95470 ----- 96061 ----- 96720 ----- 97355 ----- 98200 ----- 98998 ----- 99573 ----- 100219 ----- 100975 ----- 101795 ----- 102620 ----- 103384 ----- 104044 ----- 104635 ----- 105426 ----- 106083 ----- 107049 ----- 107925 ----- 108715 ----- 109740 ----- 110496 ----- 111128 ----- 111807 ----- 112451 ----- 113184 ----- 113866 ----- 114619 ----- 115556 ----- 116344 ----- 117029 ----- 117859 ----- 118626 ----- 119515 ----- 120258 ----- 121021 ----- 121802 ----- 122505 ----- 123136 ----- 123953 ----- 124763 ----- 125501 ----- 126271 ----- 127012 ----- 127841 ----- 128483 ----- 129230 ----- 129970 ----- 130729 ----- 131569 ----- 132370 ----- 133235 ----- 134122 ----- 134773 ----- 135503 ----- 136294 ----- 136971 ----- 137854 ----- 138681 ----- 139336 ----- 140055 ----- 140806 ----- 141489 ----- 142177 ----- 142873 ----- 143685 ----- 144486 ----- 145138 ----- 145817 ----- 146545 ----- 147291 ----- 147936 ----- 148687 ----- 149260 ----- 149990
      │    │    │   histogram(2)=  0           1            1.5e+05           1
      │    │    │                <--- 'Customer#000000037' --------- 'Customer#000149990'
      │    │    ├── key: (1)
      │    │    └── fd: (1)-->(2)
      │    └── filters
      │         └── c_custkey:1 = o_custkey:12 [type=bool, outer=(1,12), constraints=(/1: (/NULL - ]; /12: (/NULL - ]), fd=(1)==(12), (12)==(1)]
      └── aggregations
           ├── sum [as=sum:59, type=float, outer=(26)]
           │    └── l_quantity:26 [type=float]
           ├── const-agg [as=c_custkey:1, type=int, outer=(1)]
           │    └── c_custkey:1 [type=int]
           ├── const-agg [as=c_name:2, type=varchar, outer=(2)]
           │    └── c_name:2 [type=varchar]
           ├── const-agg [as=o_totalprice:14, type=float, outer=(14)]
           │    └── o_totalprice:14 [type=float]
           └── const-agg [as=o_orderdate:15, type=date, outer=(15)]
                └── o_orderdate:15 [type=date]

----Stats for q18_top_k_1----
column_names    row_count  distinct_count  null_count
{c_custkey}     57         57              0
{c_name}        57         57              0
{o_orderdate}   57         57              0
{o_orderkey}    57         57              0
{o_totalprice}  57         57              0
{sum}           57         18              0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}     100.00         1.75           100.00              1.75                0.00            1.00
{c_name}        100.00         1.75           100.00              1.75                0.00            1.00
{o_orderdate}   100.00         1.75           100.00              1.75                0.00            1.00
{o_orderkey}    100.00         1.75           100.00              1.75                0.00            1.00
{o_totalprice}  100.00         1.75           100.00              1.75                0.00            1.00
{sum}           100.00         1.75           100.00              5.56 <==            0.00            1.00

----Stats for q18_group_by_2----
column_names    row_count  distinct_count  null_count
{c_custkey}     57         57              0
{c_name}        57         57              0
{o_orderdate}   57         57              0
{o_orderkey}    57         57              0
{o_totalprice}  57         57              0
{sum}           57         18              0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}     499399.00      8761.39 <==    499399.00           8761.39 <==         0.00            1.00
{c_name}        499399.00      8761.39 <==    499399.00           8761.39 <==         0.00            1.00
{o_orderdate}   499399.00      8761.39 <==    499399.00           8761.39 <==         0.00            1.00
{o_orderkey}    499399.00      8761.39 <==    499399.00           8761.39 <==         0.00            1.00
{o_totalprice}  499399.00      8761.39 <==    499399.00           8761.39 <==         0.00            1.00
{sum}           499399.00      8761.39 <==    499399.00           27744.39 <==        0.00            1.00

----Stats for q18_inner_join_3----
column_names    row_count  distinct_count  null_count
{c_custkey}     399        57              0
{c_name}        399        57              0
{l_orderkey}    399        57              0
{l_quantity}    399        27              0
{o_custkey}     399        57              0
{o_orderdate}   399        57              0
{o_orderkey}    399        57              0
{o_totalprice}  399        57              0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}     2016723.00     5054.44 <==    99656.00            1748.35 <==         0.00            1.00
{c_name}        2016723.00     5054.44 <==    150000.00           2631.58 <==         0.00            1.00
{l_orderkey}    2016723.00     5054.44 <==    499399.00           8761.39 <==         0.00            1.00
{l_quantity}    2016723.00     5054.44 <==    50.00               1.85                0.00            1.00
{o_custkey}     2016723.00     5054.44 <==    99656.00            1748.35 <==         0.00            1.00
{o_orderdate}   2016723.00     5054.44 <==    2406.00             42.21 <==           0.00            1.00
{o_orderkey}    2016723.00     5054.44 <==    499399.00           8761.39 <==         0.00            1.00
{o_totalprice}  2016723.00     5054.44 <==    488633.00           8572.51 <==         0.00            1.00

----Stats for q18_merge_join_4----
column_names    row_count  distinct_count  null_count
{l_orderkey}    399        57              0
{l_quantity}    399        27              0
{o_custkey}     399        57              0
{o_orderdate}   399        57              0
{o_orderkey}    399        57              0
{o_totalprice}  399        57              0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}    2000764.00     5014.45 <==    509090.00           8931.40 <==         0.00            1.00
{l_quantity}    2000764.00     5014.45 <==    50.00               1.85                0.00            1.00
{o_custkey}     2000764.00     5014.45 <==    99656.00            1748.35 <==         0.00            1.00
{o_orderdate}   2000764.00     5014.45 <==    2406.00             42.21 <==           0.00            1.00
{o_orderkey}    2000764.00     5014.45 <==    509090.00           8931.40 <==         0.00            1.00
{o_totalprice}  2000764.00     5014.45 <==    497246.00           8723.61 <==         0.00            1.00

----Stats for q18_scan_5----
column_names  row_count  distinct_count  null_count
{l_orderkey}  5986300    1523585         0
{l_quantity}  5986300    50              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}  6002293.00     1.00           1527270.00          1.00                0.00            1.00
{l_quantity}  6002293.00     1.00           50.00               1.00                0.00            1.00

----Stats for q18_merge_join_6----
column_names    row_count  distinct_count  null_count
{o_custkey}     57         57              0
{o_orderdate}   57         57              0
{o_orderkey}    57         57              0
{o_totalprice}  57         57              0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}     509090.00      8931.40 <==    99656.00            1748.35 <==         0.00            1.00
{o_orderdate}   509090.00      8931.40 <==    2406.00             42.21 <==           0.00            1.00
{o_orderkey}    509090.00      8931.40 <==    509090.00           8931.40 <==         0.00            1.00
{o_totalprice}  509090.00      8931.40 <==    507049.00           8895.60 <==         0.00            1.00

----Stats for q18_scan_7----
column_names    row_count  distinct_count  null_count
{o_custkey}     1497000    99846           0
{o_orderdate}   1497000    2406            0
{o_orderkey}    1497000    1497000         0
{o_totalprice}  1497000    1456760         0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}     1500000.00     1.00           99853.00            1.00                0.00            1.00
{o_orderdate}   1500000.00     1.00           2406.00             1.00                0.00            1.00
{o_orderkey}    1500000.00     1.00           1500000.00          1.00                0.00            1.00
{o_totalprice}  1500000.00     1.00           1469395.00          1.01                0.00            1.00

----Stats for q18_select_8----
column_names  row_count  distinct_count  null_count
{l_orderkey}  57         57              0
{sum}         57         18              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}  509090.00      8931.40 <==    509090.00           8931.40 <==         0.00            1.00
{sum}         509090.00      8931.40 <==    509090.00           28282.78 <==        0.00            1.00

----Stats for q18_group_by_9----
column_names  row_count  distinct_count  null_count
{l_orderkey}  1500000    1500000         0
{sum}         1500000    318             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}  1527270.00     1.02           1527270.00          1.02                0.00            1.00
{sum}         1527270.00     1.02           1527270.00          4802.74 <==         0.00            1.00

----Stats for q18_scan_10----
column_names  row_count  distinct_count  null_count
{l_orderkey}  6001215    1527270         0
{l_quantity}  6001215    50              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}  6002293.00     1.00           1527270.00          1.00                0.00            1.00
{l_quantity}  6002293.00     1.00           50.00               1.00                0.00            1.00

----Stats for q18_scan_11----
column_names  row_count  distinct_count  null_count
{c_custkey}   150000     148813          0
{c_name}      150000     150000          0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}   150000.00      1.00           148813.00           1.00                0.00            1.00
{c_name}      150000.00      1.00           150000.00           1.00                0.00            1.00
----
----
