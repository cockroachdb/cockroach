import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q15
# Top Supplier
# Determines the top supplier so it can be rewarded, given more business, or
# identified for special recognition.
#
# Finds the supplier who contributed the most to the overall revenue for parts
# shipped during a given quarter of a given year. In case of a tie, the query
# lists all suppliers whose contribution was equal to the maximum, presented in
# supplier number order.
# --------------------------------------------------
exec-ddl
CREATE VIEW revenue0 (supplier_no, total_revenue) AS
    SELECT
        l_suppkey,
        sum(l_extendedprice * (1 - l_discount))
    FROM
        lineitem
    WHERE
        l_shipdate >= DATE '1996-01-01'
        AND l_shipdate < DATE '1996-01-01' + INTERVAL '3' MONTH
    GROUP BY
        l_suppkey;
----

stats-quality database=tpch stats-quality-prefix=q15
SELECT
    s_suppkey,
    s_name,
    s_address,
    s_phone,
    total_revenue
FROM
    supplier,
    revenue0
WHERE
    s_suppkey = supplier_no
    AND total_revenue = (
        SELECT
            max(total_revenue)
        FROM
            revenue0
    )
ORDER BY
    s_suppkey;
----
----
project
 ├── save-table-name: q15_project_1
 ├── columns: s_suppkey:1(int!null) s_name:2(char!null) s_address:3(varchar!null) s_phone:5(char!null) total_revenue:29(float!null)
 ├── immutable
 ├── stats: [rows=3333.333, distinct(1)=3306.67, null(1)=0, avgsize(1)=3, distinct(2)=2834.36, null(2)=0, avgsize(2)=20, distinct(3)=2834.81, null(3)=0, avgsize(3)=27, distinct(5)=2834.81, null(5)=0, avgsize(5)=17, distinct(29)=2100.04, null(29)=0, avgsize(29)=4]
 ├── key: (1)
 ├── fd: (1)-->(2,3,5,29)
 ├── ordering: +1
 └── inner-join (merge)
      ├── save-table-name: q15_merge_join_2
      ├── columns: s_suppkey:1(int!null) s_name:2(char!null) s_address:3(varchar!null) s_phone:5(char!null) l_suppkey:12(int!null) sum:29(float!null)
      ├── left ordering: +1
      ├── right ordering: +12
      ├── immutable
      ├── stats: [rows=3333.333, distinct(1)=3306.67, null(1)=0, avgsize(1)=3, distinct(2)=2834.36, null(2)=0, avgsize(2)=20, distinct(3)=2834.81, null(3)=0, avgsize(3)=27, distinct(5)=2834.81, null(5)=0, avgsize(5)=17, distinct(12)=3306.67, null(12)=0, avgsize(12)=4, distinct(29)=2100.04, null(29)=0, avgsize(29)=4]
      ├── key: (12)
      ├── fd: (1)-->(2,3,5), (12)-->(29), (1)==(12), (12)==(1)
      ├── ordering: +(1|12) [actual: +1]
      ├── scan supplier
      │    ├── save-table-name: q15_scan_3
      │    ├── columns: s_suppkey:1(int!null) s_name:2(char!null) s_address:3(varchar!null) s_phone:5(char!null)
      │    ├── stats: [rows=10000, distinct(1)=9920, null(1)=0, avgsize(1)=3, distinct(2)=9990, null(2)=0, avgsize(2)=20, distinct(3)=10000, null(3)=0, avgsize(3)=27, distinct(5)=10000, null(5)=0, avgsize(5)=17]
      │    │   histogram(1)=  0           0            0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50    1    0           0
      │    │                <--- -9223372036854775808 --- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000 --- 9223372036854775807
      │    │   histogram(2)=  0           1            9998           1
      │    │                <--- 'Supplier#000000001' ------ 'Supplier#000010000'
      │    │   histogram(3)=  0                     1                     9998                1
      │    │                <--- '  9aW1wwnBJJPnCx,nox0MA48Y0zpI1IeVfYZ' ------ 'zzfDhdtZcvmVzA8rNFU,Yctj1zBN'
      │    │   histogram(5)=  0          1          9998          1
      │    │                <--- '10-102-116-6785' ------ '34-998-900-4911'
      │    ├── key: (1)
      │    ├── fd: (1)-->(2,3,5)
      │    └── ordering: +1
      ├── sort
      │    ├── save-table-name: q15_sort_4
      │    ├── columns: l_suppkey:12(int!null) sum:29(float!null)
      │    ├── immutable
      │    ├── stats: [rows=3306.667, distinct(12)=3306.67, null(12)=0, avgsize(12)=4, distinct(29)=3306.67, null(29)=0, avgsize(29)=4]
      │    ├── key: (12)
      │    ├── fd: (12)-->(29)
      │    ├── ordering: +12
      │    └── select
      │         ├── save-table-name: q15_select_5
      │         ├── columns: l_suppkey:12(int!null) sum:29(float!null)
      │         ├── immutable
      │         ├── stats: [rows=3306.667, distinct(12)=3306.67, null(12)=0, avgsize(12)=4, distinct(29)=3306.67, null(29)=0, avgsize(29)=4]
      │         ├── key: (12)
      │         ├── fd: (12)-->(29)
      │         ├── group-by (hash)
      │         │    ├── save-table-name: q15_group_by_6
      │         │    ├── columns: l_suppkey:12(int!null) sum:29(float!null)
      │         │    ├── grouping columns: l_suppkey:12(int!null)
      │         │    ├── immutable
      │         │    ├── stats: [rows=9920, distinct(12)=9920, null(12)=0, avgsize(12)=4, distinct(29)=9920, null(29)=0, avgsize(29)=4]
      │         │    ├── key: (12)
      │         │    ├── fd: (12)-->(29)
      │         │    ├── project
      │         │    │    ├── save-table-name: q15_project_7
      │         │    │    ├── columns: column28:28(float!null) l_suppkey:12(int!null)
      │         │    │    ├── immutable
      │         │    │    ├── stats: [rows=238668.4, distinct(12)=9920, null(12)=0, avgsize(12)=4, distinct(28)=238668, null(28)=0, avgsize(28)=18]
      │         │    │    ├── index-join lineitem
      │         │    │    │    ├── save-table-name: q15_index_join_8
      │         │    │    │    ├── columns: l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null)
      │         │    │    │    ├── stats: [rows=238668.4, distinct(12)=9920, null(12)=0, avgsize(12)=4, distinct(15)=214148, null(15)=0, avgsize(15)=9, distinct(16)=11, null(16)=0, avgsize(16)=9, distinct(20)=91, null(20)=0, avgsize(20)=4, distinct(15,16)=238668, null(15,16)=0, avgsize(15,16)=18]
      │         │    │    │    │   histogram(20)=  0       0        2820.6      1200      28206      600       27606      3601      25805      3001      25805      3001      27606      2400      26405      3001      25805      4801      24004     3000.6
      │         │    │    │    │                 <--- '1995-12-31' -------- '1996-01-02' ------- '1996-01-14' ------- '1996-01-25' ------- '1996-02-07' ------- '1996-02-18' ------- '1996-02-28' ------- '1996-03-12' ------- '1996-03-22' ------- '1996-03-31'
      │         │    │    │    └── scan lineitem@l_sd
      │         │    │    │         ├── save-table-name: q15_scan_9
      │         │    │    │         ├── columns: l_orderkey:10(int!null) l_linenumber:13(int!null) l_shipdate:20(date!null)
      │         │    │    │         ├── constraint: /20/10/13: [/'1996-01-01' - /'1996-03-31']
      │         │    │    │         ├── stats: [rows=238668.4, distinct(10)=225118, null(10)=0, avgsize(10)=4, distinct(13)=7, null(13)=0, avgsize(13)=1, distinct(20)=91, null(20)=0, avgsize(20)=4]
      │         │    │    │         │   histogram(10)=  0 23.862 1169.5 23.862  1169.5 23.862  1169.5 23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1145.6  47.724  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1145.6  47.724   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1145.6  47.724   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862
      │         │    │    │         │                 <--- 197 --------- 23686 -------- 53253 -------- 90435 -------- 121730 -------- 153280 -------- 175456 -------- 208548 -------- 242209 -------- 273057 -------- 296640 -------- 330307 -------- 360999 -------- 386307 -------- 420225 -------- 450050 -------- 477795 -------- 504711 -------- 533153 -------- 556672 -------- 582243 -------- 613729 -------- 646117 -------- 675840 -------- 706048 -------- 733063 -------- 769282 -------- 793922 -------- 820357 -------- 849536 -------- 875719 -------- 905028 -------- 940643 -------- 968355 -------- 998721 -------- 1023621 -------- 1059424 -------- 1084932 -------- 1115553 -------- 1139363 -------- 1167361 -------- 1194400 -------- 1225984 -------- 1253861 -------- 1281633 -------- 1304999 -------- 1336355 -------- 1370759 -------- 1400832 -------- 1434085 -------- 1458852 -------- 1491427 -------- 1525120 -------- 1555205 -------- 1591300 -------- 1619426 -------- 1651458 -------- 1682950 -------- 1711399 -------- 1747591 -------- 1787205 -------- 1822240 -------- 1856163 -------- 1886915 -------- 1910949 -------- 1947202 -------- 1974311 -------- 2009286 -------- 2044034 -------- 2079104 -------- 2103488 -------- 2134657 -------- 2164293 -------- 2204514 -------- 2230823 -------- 2265253 -------- 2289826 -------- 2329539 -------- 2364455 -------- 2393507 -------- 2414628 -------- 2440228 -------- 2465255 -------- 2489568 -------- 2520900 -------- 2554919 -------- 2583333 -------- 2612966 -------- 2644833 -------- 2667362 -------- 2702784 -------- 2727394 -------- 2759748 -------- 2794531 -------- 2822214 -------- 2846624 -------- 2883748 -------- 2919586 -------- 2951908 -------- 2980068 -------- 3014726 -------- 3050725 -------- 3081028 -------- 3113351 -------- 3150243 -------- 3185669 -------- 3214311 -------- 3241281 -------- 3275748 -------- 3303232 -------- 3339559 -------- 3370627 -------- 3393664 -------- 3435265 -------- 3464581 -------- 3489026 -------- 3516096 -------- 3548480 -------- 3587015 -------- 3611239 -------- 3638724 -------- 3668641 -------- 3695751 -------- 3729636 -------- 3751523 -------- 3784608 -------- 3815715 -------- 3848608 -------- 3881184 -------- 3908738 -------- 3940002 -------- 3966176 -------- 4001984 -------- 4035687 -------- 4065283 -------- 4092834 -------- 4133062 -------- 4160613 -------- 4196421 -------- 4223713 -------- 4254788 -------- 4291040 -------- 4313664 -------- 4342823 -------- 4369952 -------- 4391684 -------- 4419040 -------- 4449921 -------- 4471781 -------- 4506210 -------- 4538176 -------- 4571297 -------- 4601121 -------- 4630887 -------- 4657476 -------- 4684803 -------- 4714566 -------- 4744070 -------- 4776385 -------- 4807777 -------- 4839491 -------- 4873953 -------- 4902245 -------- 4936263 -------- 4970721 -------- 5003140 -------- 5029729 -------- 5059010 -------- 5087521 -------- 5121093 -------- 5150405 -------- 5178375 -------- 5203683 -------- 5234531 -------- 5268195 -------- 5300004 -------- 5331558 -------- 5362178 -------- 5385762 -------- 5418498 -------- 5445762 -------- 5483109 -------- 5514561 -------- 5542052 -------- 5569572 -------- 5596102 -------- 5622401 -------- 5652194 -------- 5671362 -------- 5699591 -------- 5727136 -------- 5753284 -------- 5780742 -------- 5809189 -------- 5836545 -------- 5864454 -------- 5894917 -------- 5933825 -------- 5968933 -------- 5999590
      │         │    │    │         │   histogram(13)=  0 59166 0 53247 0 41862 0 34273 0 25323 0 16516 0 8281.8
      │         │    │    │         │                 <---- 1 ----- 2 ----- 3 ----- 4 ----- 5 ----- 6 ----- 7 --
      │         │    │    │         │   histogram(20)=  0       0        2820.6      1200      28206      600       27606      3601      25805      3001      25805      3001      27606      2400      26405      3001      25805      4801      24004     3000.6
      │         │    │    │         │                 <--- '1995-12-31' -------- '1996-01-02' ------- '1996-01-14' ------- '1996-01-25' ------- '1996-02-07' ------- '1996-02-18' ------- '1996-02-28' ------- '1996-03-12' ------- '1996-03-22' ------- '1996-03-31'
      │         │    │    │         ├── key: (10,13)
      │         │    │    │         └── fd: (10,13)-->(20)
      │         │    │    └── projections
      │         │    │         └── l_extendedprice:15 * (1.0 - l_discount:16) [as=column28:28, type=float, outer=(15,16), immutable]
      │         │    └── aggregations
      │         │         └── sum [as=sum:29, type=float, outer=(28)]
      │         │              └── column28:28 [type=float]
      │         └── filters
      │              └── eq [type=bool, outer=(29), immutable, subquery, constraints=(/29: (/NULL - ])]
      │                   ├── sum:29 [type=float]
      │                   └── subquery [type=float]
      │                        └── scalar-group-by
      │                             ├── save-table-name: q15_scalar_group_by_10
      │                             ├── columns: max:50(float)
      │                             ├── cardinality: [1 - 1]
      │                             ├── immutable
      │                             ├── stats: [rows=1, distinct(50)=1, null(50)=0, avgsize(50)=4]
      │                             ├── key: ()
      │                             ├── fd: ()-->(50)
      │                             ├── group-by (hash)
      │                             │    ├── save-table-name: q15_group_by_11
      │                             │    ├── columns: l_suppkey:32(int!null) sum:49(float!null)
      │                             │    ├── grouping columns: l_suppkey:32(int!null)
      │                             │    ├── immutable
      │                             │    ├── stats: [rows=9920, distinct(32)=9920, null(32)=0, avgsize(32)=4, distinct(49)=9920, null(49)=0, avgsize(49)=4]
      │                             │    ├── key: (32)
      │                             │    ├── fd: (32)-->(49)
      │                             │    ├── project
      │                             │    │    ├── save-table-name: q15_project_12
      │                             │    │    ├── columns: column48:48(float!null) l_suppkey:32(int!null)
      │                             │    │    ├── immutable
      │                             │    │    ├── stats: [rows=238668.4, distinct(32)=9920, null(32)=0, avgsize(32)=4, distinct(48)=238668, null(48)=0, avgsize(48)=18]
      │                             │    │    ├── index-join lineitem
      │                             │    │    │    ├── save-table-name: q15_index_join_13
      │                             │    │    │    ├── columns: l_suppkey:32(int!null) l_extendedprice:35(float!null) l_discount:36(float!null) l_shipdate:40(date!null)
      │                             │    │    │    ├── stats: [rows=238668.4, distinct(32)=9920, null(32)=0, avgsize(32)=4, distinct(35)=214148, null(35)=0, avgsize(35)=9, distinct(36)=11, null(36)=0, avgsize(36)=9, distinct(40)=91, null(40)=0, avgsize(40)=4, distinct(35,36)=238668, null(35,36)=0, avgsize(35,36)=18]
      │                             │    │    │    │   histogram(40)=  0       0        2820.6      1200      28206      600       27606      3601      25805      3001      25805      3001      27606      2400      26405      3001      25805      4801      24004     3000.6
      │                             │    │    │    │                 <--- '1995-12-31' -------- '1996-01-02' ------- '1996-01-14' ------- '1996-01-25' ------- '1996-02-07' ------- '1996-02-18' ------- '1996-02-28' ------- '1996-03-12' ------- '1996-03-22' ------- '1996-03-31'
      │                             │    │    │    └── scan lineitem@l_sd
      │                             │    │    │         ├── save-table-name: q15_scan_14
      │                             │    │    │         ├── columns: l_orderkey:30(int!null) l_linenumber:33(int!null) l_shipdate:40(date!null)
      │                             │    │    │         ├── constraint: /40/30/33: [/'1996-01-01' - /'1996-03-31']
      │                             │    │    │         ├── stats: [rows=238668.4, distinct(30)=225118, null(30)=0, avgsize(30)=4, distinct(33)=7, null(33)=0, avgsize(33)=1, distinct(40)=91, null(40)=0, avgsize(40)=4]
      │                             │    │    │         │   histogram(30)=  0 23.862 1169.5 23.862  1169.5 23.862  1169.5 23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1145.6  47.724  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862  1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1145.6  47.724   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1145.6  47.724   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1169.5  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862   1193.3  23.862
      │                             │    │    │         │                 <--- 197 --------- 23686 -------- 53253 -------- 90435 -------- 121730 -------- 153280 -------- 175456 -------- 208548 -------- 242209 -------- 273057 -------- 296640 -------- 330307 -------- 360999 -------- 386307 -------- 420225 -------- 450050 -------- 477795 -------- 504711 -------- 533153 -------- 556672 -------- 582243 -------- 613729 -------- 646117 -------- 675840 -------- 706048 -------- 733063 -------- 769282 -------- 793922 -------- 820357 -------- 849536 -------- 875719 -------- 905028 -------- 940643 -------- 968355 -------- 998721 -------- 1023621 -------- 1059424 -------- 1084932 -------- 1115553 -------- 1139363 -------- 1167361 -------- 1194400 -------- 1225984 -------- 1253861 -------- 1281633 -------- 1304999 -------- 1336355 -------- 1370759 -------- 1400832 -------- 1434085 -------- 1458852 -------- 1491427 -------- 1525120 -------- 1555205 -------- 1591300 -------- 1619426 -------- 1651458 -------- 1682950 -------- 1711399 -------- 1747591 -------- 1787205 -------- 1822240 -------- 1856163 -------- 1886915 -------- 1910949 -------- 1947202 -------- 1974311 -------- 2009286 -------- 2044034 -------- 2079104 -------- 2103488 -------- 2134657 -------- 2164293 -------- 2204514 -------- 2230823 -------- 2265253 -------- 2289826 -------- 2329539 -------- 2364455 -------- 2393507 -------- 2414628 -------- 2440228 -------- 2465255 -------- 2489568 -------- 2520900 -------- 2554919 -------- 2583333 -------- 2612966 -------- 2644833 -------- 2667362 -------- 2702784 -------- 2727394 -------- 2759748 -------- 2794531 -------- 2822214 -------- 2846624 -------- 2883748 -------- 2919586 -------- 2951908 -------- 2980068 -------- 3014726 -------- 3050725 -------- 3081028 -------- 3113351 -------- 3150243 -------- 3185669 -------- 3214311 -------- 3241281 -------- 3275748 -------- 3303232 -------- 3339559 -------- 3370627 -------- 3393664 -------- 3435265 -------- 3464581 -------- 3489026 -------- 3516096 -------- 3548480 -------- 3587015 -------- 3611239 -------- 3638724 -------- 3668641 -------- 3695751 -------- 3729636 -------- 3751523 -------- 3784608 -------- 3815715 -------- 3848608 -------- 3881184 -------- 3908738 -------- 3940002 -------- 3966176 -------- 4001984 -------- 4035687 -------- 4065283 -------- 4092834 -------- 4133062 -------- 4160613 -------- 4196421 -------- 4223713 -------- 4254788 -------- 4291040 -------- 4313664 -------- 4342823 -------- 4369952 -------- 4391684 -------- 4419040 -------- 4449921 -------- 4471781 -------- 4506210 -------- 4538176 -------- 4571297 -------- 4601121 -------- 4630887 -------- 4657476 -------- 4684803 -------- 4714566 -------- 4744070 -------- 4776385 -------- 4807777 -------- 4839491 -------- 4873953 -------- 4902245 -------- 4936263 -------- 4970721 -------- 5003140 -------- 5029729 -------- 5059010 -------- 5087521 -------- 5121093 -------- 5150405 -------- 5178375 -------- 5203683 -------- 5234531 -------- 5268195 -------- 5300004 -------- 5331558 -------- 5362178 -------- 5385762 -------- 5418498 -------- 5445762 -------- 5483109 -------- 5514561 -------- 5542052 -------- 5569572 -------- 5596102 -------- 5622401 -------- 5652194 -------- 5671362 -------- 5699591 -------- 5727136 -------- 5753284 -------- 5780742 -------- 5809189 -------- 5836545 -------- 5864454 -------- 5894917 -------- 5933825 -------- 5968933 -------- 5999590
      │                             │    │    │         │   histogram(33)=  0 59166 0 53247 0 41862 0 34273 0 25323 0 16516 0 8281.8
      │                             │    │    │         │                 <---- 1 ----- 2 ----- 3 ----- 4 ----- 5 ----- 6 ----- 7 --
      │                             │    │    │         │   histogram(40)=  0       0        2820.6      1200      28206      600       27606      3601      25805      3001      25805      3001      27606      2400      26405      3001      25805      4801      24004     3000.6
      │                             │    │    │         │                 <--- '1995-12-31' -------- '1996-01-02' ------- '1996-01-14' ------- '1996-01-25' ------- '1996-02-07' ------- '1996-02-18' ------- '1996-02-28' ------- '1996-03-12' ------- '1996-03-22' ------- '1996-03-31'
      │                             │    │    │         ├── key: (30,33)
      │                             │    │    │         └── fd: (30,33)-->(40)
      │                             │    │    └── projections
      │                             │    │         └── l_extendedprice:35 * (1.0 - l_discount:36) [as=column48:48, type=float, outer=(35,36), immutable]
      │                             │    └── aggregations
      │                             │         └── sum [as=sum:49, type=float, outer=(48)]
      │                             │              └── column48:48 [type=float]
      │                             └── aggregations
      │                                  └── max [as=max:50, type=float, outer=(49)]
      │                                       └── sum:49 [type=float]
      └── filters (true)

----Stats for q15_project_1----
column_names     row_count  distinct_count  null_count
{s_address}      1          1               0
{s_name}         1          1               0
{s_phone}        1          1               0
{s_suppkey}      1          1               0
{total_revenue}  1          1               0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_address}      3333.00        3333.00 <==    2835.00             2835.00 <==         0.00            1.00
{s_name}         3333.00        3333.00 <==    2834.00             2834.00 <==         0.00            1.00
{s_phone}        3333.00        3333.00 <==    2835.00             2835.00 <==         0.00            1.00
{s_suppkey}      3333.00        3333.00 <==    3307.00             3307.00 <==         0.00            1.00
{total_revenue}  3333.00        3333.00 <==    2100.00             2100.00 <==         0.00            1.00

----Stats for q15_merge_join_2----
column_names  row_count  distinct_count  null_count
{l_suppkey}   1          1               0
{s_address}   1          1               0
{s_name}      1          1               0
{s_phone}     1          1               0
{s_suppkey}   1          1               0
{sum}         1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_suppkey}   3333.00        3333.00 <==    3307.00             3307.00 <==         0.00            1.00
{s_address}   3333.00        3333.00 <==    2835.00             2835.00 <==         0.00            1.00
{s_name}      3333.00        3333.00 <==    2834.00             2834.00 <==         0.00            1.00
{s_phone}     3333.00        3333.00 <==    2835.00             2835.00 <==         0.00            1.00
{s_suppkey}   3333.00        3333.00 <==    3307.00             3307.00 <==         0.00            1.00
{sum}         3333.00        3333.00 <==    2100.00             2100.00 <==         0.00            1.00

----Stats for q15_scan_3----
column_names  row_count  distinct_count  null_count
{s_address}   9200       9200            0
{s_name}      9200       9167            0
{s_phone}     9200       9200            0
{s_suppkey}   9200       9131            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_address}   10000.00       1.09           10000.00            1.09                0.00            1.00
{s_name}      10000.00       1.09           9990.00             1.09                0.00            1.00
{s_phone}     10000.00       1.09           10000.00            1.09                0.00            1.00
{s_suppkey}   10000.00       1.09           9920.00             1.09                0.00            1.00

----Stats for q15_sort_4----
column_names  row_count  distinct_count  null_count
{l_suppkey}   1          1               0
{sum}         1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_suppkey}   3307.00        3307.00 <==    3307.00             3307.00 <==         0.00            1.00
{sum}         3307.00        3307.00 <==    3307.00             3307.00 <==         0.00            1.00

----Stats for q15_select_5----
column_names  row_count  distinct_count  null_count
{l_suppkey}   1          1               0
{sum}         1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_suppkey}   3307.00        3307.00 <==    3307.00             3307.00 <==         0.00            1.00
{sum}         3307.00        3307.00 <==    3307.00             3307.00 <==         0.00            1.00

----Stats for q15_group_by_6----
column_names  row_count  distinct_count  null_count
{l_suppkey}   10000      9920            0
{sum}         10000      10000           0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_suppkey}   9920.00        1.01           9920.00             1.00                0.00            1.00
{sum}         9920.00        1.01           9920.00             1.01                0.00            1.00

----Stats for q15_project_7----
column_names  row_count  distinct_count  null_count
{column28}    225954     220864          0
{l_suppkey}   225954     9920            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{column28}    238668.00      1.06           238668.00           1.08                0.00            1.00
{l_suppkey}   238668.00      1.06           9920.00             1.00                0.00            1.00

----Stats for q15_index_join_8----
column_names       row_count  distinct_count  null_count
{l_discount}       225954     11              0
{l_extendedprice}  225954     196692          0
{l_shipdate}       225954     91              0
{l_suppkey}        225954     9920            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       238668.00      1.06           11.00               1.00                0.00            1.00
{l_extendedprice}  238668.00      1.06           214148.00           1.09                0.00            1.00
{l_shipdate}       238668.00      1.06           91.00               1.00                0.00            1.00
{l_suppkey}        238668.00      1.06           9920.00             1.00                0.00            1.00

----Stats for q15_scan_9----
column_names    row_count  distinct_count  null_count
{l_linenumber}  225954     7               0
{l_orderkey}    225954     95273           0
{l_shipdate}    225954     91              0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}  238668.00      1.06           7.00                1.00                0.00            1.00
{l_orderkey}    238668.00      1.06           225118.00           2.36 <==            0.00            1.00
{l_shipdate}    238668.00      1.06           91.00               1.00                0.00            1.00

----Stats for q15_scalar_group_by_10----
column_names  row_count  distinct_count  null_count
{max}         1          1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{max}         1.00           1.00           1.00                1.00                0.00            1.00

----Stats for q15_group_by_11----
column_names  row_count  distinct_count  null_count
{l_suppkey}   10000      9920            0
{sum}         10000      10000           0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_suppkey}   9920.00        1.01           9920.00             1.00                0.00            1.00
{sum}         9920.00        1.01           9920.00             1.01                0.00            1.00

----Stats for q15_project_12----
column_names  row_count  distinct_count  null_count
{column48}    225954     220864          0
{l_suppkey}   225954     9920            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{column48}    238668.00      1.06           238668.00           1.08                0.00            1.00
{l_suppkey}   238668.00      1.06           9920.00             1.00                0.00            1.00

----Stats for q15_index_join_13----
column_names       row_count  distinct_count  null_count
{l_discount}       225954     11              0
{l_extendedprice}  225954     196692          0
{l_shipdate}       225954     91              0
{l_suppkey}        225954     9920            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       238668.00      1.06           11.00               1.00                0.00            1.00
{l_extendedprice}  238668.00      1.06           214148.00           1.09                0.00            1.00
{l_shipdate}       238668.00      1.06           91.00               1.00                0.00            1.00
{l_suppkey}        238668.00      1.06           9920.00             1.00                0.00            1.00

----Stats for q15_scan_14----
column_names    row_count  distinct_count  null_count
{l_linenumber}  225954     7               0
{l_orderkey}    225954     95273           0
{l_shipdate}    225954     91              0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}  238668.00      1.06           7.00                1.00                0.00            1.00
{l_orderkey}    238668.00      1.06           225118.00           2.36 <==            0.00            1.00
{l_shipdate}    238668.00      1.06           91.00               1.00                0.00            1.00
----
----
