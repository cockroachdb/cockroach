import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q9
# Product Type Profit Measure
# Determines how much profit is made on a given line of parts, broken out by
# supplier nation and year.
#
# Finds, for each nation and each year, the profit for all parts ordered in that
# year that contain a specified substring in their names and that were filled by
# a supplier in that nation. The profit is defined as the sum of:
#
#   [(l_extendedprice*(1-l_discount)) - (ps_supplycost * l_quantity)]
#
# for all lineitems describing parts in the specified line. The query lists the
#  nations in ascending alphabetical order and, for each nation, the year and
#  profit in descending order by year (most recent first).
# --------------------------------------------------
save-tables database=tpch save-tables-prefix=q9
SELECT
    nation,
    o_year,
    sum(amount) AS sum_profit
FROM (
    SELECT
        n_name AS nation,
        extract(year FROM o_orderdate) AS o_year,
        l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount
    FROM
        part,
        supplier,
        lineitem,
        partsupp,
        orders,
        nation
    WHERE
        s_suppkey = l_suppkey
        AND ps_suppkey = l_suppkey
        AND ps_partkey = l_partkey
        AND p_partkey = l_partkey
        AND o_orderkey = l_orderkey
        AND s_nationkey = n_nationkey
        AND p_name LIKE '%green%'
    ) AS profit
GROUP BY
    nation,
    o_year
ORDER BY
    nation,
    o_year DESC;
----
sort
 ├── save-table-name: q9_sort_1
 ├── columns: nation:53(char!null) o_year:57(float) sum_profit:59(float!null)
 ├── immutable
 ├── stats: [rows=1548.49892, distinct(53)=25, null(53)=0, distinct(57)=957.145308, null(57)=0, distinct(59)=1548.49892, null(59)=0, distinct(53,57)=1548.49892, null(53,57)=0]
 ├── key: (53,57)
 ├── fd: (53,57)-->(59)
 ├── ordering: +53,-57
 └── group-by
      ├── save-table-name: q9_group_by_2
      ├── columns: n_name:53(char!null) o_year:57(float) sum:59(float!null)
      ├── grouping columns: n_name:53(char!null) o_year:57(float)
      ├── immutable
      ├── stats: [rows=1548.49892, distinct(53)=25, null(53)=0, distinct(57)=957.145308, null(57)=0, distinct(59)=1548.49892, null(59)=0, distinct(53,57)=1548.49892, null(53,57)=0]
      ├── key: (53,57)
      ├── fd: (53,57)-->(59)
      ├── project
      │    ├── save-table-name: q9_project_3
      │    ├── columns: o_year:57(float) amount:58(float!null) n_name:53(char!null)
      │    ├── immutable
      │    ├── stats: [rows=2450.41631, distinct(53)=25, null(53)=0, distinct(57)=957.145308, null(57)=0, distinct(58)=958.326364, null(58)=0, distinct(53,57)=1548.49892, null(53,57)=0]
      │    ├── inner-join (hash)
      │    │    ├── save-table-name: q9_inner_join_4
      │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) s_suppkey:11(int!null) s_nationkey:14(int!null) l_orderkey:19(int!null) l_partkey:20(int!null) l_suppkey:21(int!null) l_quantity:23(float!null) l_extendedprice:24(float!null) l_discount:25(float!null) ps_partkey:36(int!null) ps_suppkey:37(int!null) ps_supplycost:39(float!null) o_orderkey:42(int!null) o_orderdate:46(date!null) n_nationkey:52(int!null) n_name:53(char!null)
      │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
      │    │    ├── stats: [rows=2450.41631, distinct(1)=1065.01249, null(1)=0, distinct(2)=2405.94672, null(2)=0, distinct(11)=1064.52386, null(11)=0, distinct(14)=25, null(14)=0, distinct(19)=1066.4323, null(19)=0, distinct(20)=1065.01249, null(20)=0, distinct(21)=1064.52386, null(21)=0, distinct(23)=50, null(23)=0, distinct(24)=958.164832, null(24)=0, distinct(25)=11, null(25)=0, distinct(36)=958.326364, null(36)=0, distinct(37)=958.326364, null(37)=0, distinct(39)=956.829183, null(39)=0, distinct(42)=1066.4323, null(42)=0, distinct(46)=957.145308, null(46)=0, distinct(52)=25, null(52)=0, distinct(53)=25, null(53)=0, distinct(46,53)=1548.49892, null(46,53)=0, distinct(23-25,39)=958.326364, null(23-25,39)=0]
      │    │    ├── fd: (1)-->(2), (11)-->(14), (36,37)-->(39), (21)==(11,37), (37)==(11,21), (20)==(1,36), (36)==(1,20), (42)-->(46), (19)==(42), (42)==(19), (11)==(21,37), (52)-->(53), (14)==(52), (52)==(14), (1)==(20,36)
      │    │    ├── inner-join (hash)
      │    │    │    ├── save-table-name: q9_inner_join_5
      │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) s_suppkey:11(int!null) s_nationkey:14(int!null) l_orderkey:19(int!null) l_partkey:20(int!null) l_suppkey:21(int!null) l_quantity:23(float!null) l_extendedprice:24(float!null) l_discount:25(float!null) ps_partkey:36(int!null) ps_suppkey:37(int!null) ps_supplycost:39(float!null) o_orderkey:42(int!null) o_orderdate:46(date!null)
      │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
      │    │    │    ├── stats: [rows=2450.41631, distinct(1)=1223.84511, null(1)=0, distinct(2)=2405.94672, null(2)=0, distinct(11)=1224.18162, null(11)=0, distinct(14)=25, null(14)=0, distinct(19)=1227.35103, null(19)=0, distinct(20)=1223.84511, null(20)=0, distinct(21)=1224.18162, null(21)=0, distinct(23)=50, null(23)=0, distinct(24)=1058.34962, null(24)=0, distinct(25)=11, null(25)=0, distinct(36)=1058.5867, null(36)=0, distinct(37)=1058.5867, null(37)=0, distinct(39)=1056.39091, null(39)=0, distinct(42)=1227.35103, null(42)=0, distinct(46)=1056.85425, null(46)=0]
      │    │    │    ├── fd: (1)-->(2), (11)-->(14), (36,37)-->(39), (21)==(11,37), (37)==(11,21), (20)==(1,36), (36)==(1,20), (42)-->(46), (19)==(42), (42)==(19), (11)==(21,37), (1)==(20,36)
      │    │    │    ├── scan supplier@s_nk
      │    │    │    │    ├── save-table-name: q9_scan_6
      │    │    │    │    ├── columns: s_suppkey:11(int!null) s_nationkey:14(int!null)
      │    │    │    │    ├── stats: [rows=10000, distinct(11)=9920, null(11)=0, distinct(14)=25, null(14)=0]
      │    │    │    │    │   histogram(11)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50    1
      │    │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │    │    │    │    │   histogram(14)=  0 420 0 413 0 397 0 412 0 415 0 380 0 402 0 396 0 415 0 405 0 393  0 438  0 377  0 362  0 376  0 373  0 406  0 421  0 407  0 398  0 411  0 399  0 401  0 390  0 393
      │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    ├── key: (11)
      │    │    │    │    └── fd: (11)-->(14)
      │    │    │    ├── inner-join (lookup orders)
      │    │    │    │    ├── save-table-name: q9_lookup_join_7
      │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) l_orderkey:19(int!null) l_partkey:20(int!null) l_suppkey:21(int!null) l_quantity:23(float!null) l_extendedprice:24(float!null) l_discount:25(float!null) ps_partkey:36(int!null) ps_suppkey:37(int!null) ps_supplycost:39(float!null) o_orderkey:42(int!null) o_orderdate:46(date!null)
      │    │    │    │    ├── key columns: [19] = [42]
      │    │    │    │    ├── lookup columns are key
      │    │    │    │    ├── stats: [rows=2430.81298, distinct(1)=1535.46099, null(1)=0, distinct(2)=2387.04794, null(2)=0, distinct(19)=1535.60004, null(19)=0, distinct(20)=1535.46099, null(20)=0, distinct(21)=1220.18199, null(21)=0, distinct(23)=50, null(23)=0, distinct(24)=1219.78652, null(24)=0, distinct(25)=11, null(25)=0, distinct(36)=1220.18199, null(36)=0, distinct(37)=1220.18199, null(37)=0, distinct(39)=1216.52365, null(39)=0, distinct(42)=1535.60004, null(42)=0, distinct(46)=1217.29478, null(46)=0]
      │    │    │    │    ├── fd: (1)-->(2), (36,37)-->(39), (21)==(37), (37)==(21), (20)==(1,36), (36)==(1,20), (42)-->(46), (19)==(42), (42)==(19), (1)==(20,36)
      │    │    │    │    ├── inner-join (lookup lineitem)
      │    │    │    │    │    ├── save-table-name: q9_lookup_join_8
      │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) l_orderkey:19(int!null) l_partkey:20(int!null) l_suppkey:21(int!null) l_quantity:23(float!null) l_extendedprice:24(float!null) l_discount:25(float!null) ps_partkey:36(int!null) ps_suppkey:37(int!null) ps_supplycost:39(float!null)
      │    │    │    │    │    ├── key columns: [19 22] = [19 22]
      │    │    │    │    │    ├── lookup columns are key
      │    │    │    │    │    ├── stats: [rows=2430.81298, distinct(1)=2429.06305, null(1)=0, distinct(2)=2387.04794, null(2)=0, distinct(19)=1535.60004, null(19)=0, distinct(20)=2429.06305, null(20)=0, distinct(21)=1536.11093, null(21)=0, distinct(23)=50, null(23)=0, distinct(24)=1535.26821, null(24)=0, distinct(25)=11, null(25)=0, distinct(36)=1536.11093, null(36)=0, distinct(37)=1536.11093, null(37)=0, distinct(39)=1528.33438, null(39)=0]
      │    │    │    │    │    ├── fd: (1)-->(2), (36,37)-->(39), (21)==(37), (37)==(21), (20)==(1,36), (36)==(1,20), (1)==(20,36)
      │    │    │    │    │    ├── inner-join (lookup lineitem@l_pk_sk)
      │    │    │    │    │    │    ├── save-table-name: q9_lookup_join_9
      │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) l_orderkey:19(int!null) l_partkey:20(int!null) l_suppkey:21(int!null) l_linenumber:22(int!null) ps_partkey:36(int!null) ps_suppkey:37(int!null) ps_supplycost:39(float!null)
      │    │    │    │    │    │    ├── key columns: [36 37] = [20 21]
      │    │    │    │    │    │    ├── stats: [rows=812.772154, distinct(1)=807.83427, null(1)=0, distinct(2)=807.74754, null(2)=0, distinct(19)=812.555998, null(19)=0, distinct(20)=812.772154, null(20)=0, distinct(21)=812.772154, null(21)=0, distinct(22)=7, null(22)=0, distinct(36)=812.772154, null(36)=0, distinct(37)=812.772154, null(37)=0, distinct(39)=809.246246, null(39)=0]
      │    │    │    │    │    │    ├── key: (19,22)
      │    │    │    │    │    │    ├── fd: (1)-->(2), (36,37)-->(39), (1)==(20,36), (36)==(1,20), (19,22)-->(20,21), (20)==(1,36), (21)==(37), (37)==(21)
      │    │    │    │    │    │    ├── inner-join (merge)
      │    │    │    │    │    │    │    ├── save-table-name: q9_merge_join_10
      │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) ps_partkey:36(int!null) ps_suppkey:37(int!null) ps_supplycost:39(float!null)
      │    │    │    │    │    │    │    ├── left ordering: +1
      │    │    │    │    │    │    │    ├── right ordering: +36
      │    │    │    │    │    │    │    ├── stats: [rows=267682.522, distinct(1)=66618.6736, null(1)=0, distinct(2)=65464.1012, null(2)=0, distinct(36)=66618.6736, null(36)=0, distinct(37)=9920, null(37)=0, distinct(39)=93404.7278, null(39)=0]
      │    │    │    │    │    │    │    ├── key: (36,37)
      │    │    │    │    │    │    │    ├── fd: (1)-->(2), (36,37)-->(39), (1)==(36), (36)==(1)
      │    │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    │    ├── save-table-name: q9_select_11
      │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=66666.6667, distinct(1)=66618.6736, null(1)=0, distinct(2)=66666.6667, null(2)=0]
      │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    ├── fd: (1)-->(2)
      │    │    │    │    │    │    │    │    ├── ordering: +1
      │    │    │    │    │    │    │    │    ├── scan part
      │    │    │    │    │    │    │    │    │    ├── save-table-name: q9_scan_12
      │    │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null)
      │    │    │    │    │    │    │    │    │    ├── stats: [rows=200000, distinct(1)=199241, null(1)=0, distinct(2)=198131, null(2)=0]
      │    │    │    │    │    │    │    │    │    │   histogram(1)=  0  20  980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20
      │    │    │    │    │    │    │    │    │    │                <--- 27 ----- 1110 ----- 2241 ----- 3086 ----- 4134 ----- 5302 ----- 6222 ----- 7308 ----- 8249 ----- 9171 ----- 10049 ----- 10958 ----- 11832 ----- 13025 ----- 14063 ----- 14953 ----- 16249 ----- 17419 ----- 18363 ----- 19412 ----- 20257 ----- 21190 ----- 22110 ----- 23045 ----- 23956 ----- 24962 ----- 25942 ----- 26990 ----- 27934 ----- 28876 ----- 29513 ----- 30326 ----- 31259 ----- 32300 ----- 33577 ----- 34550 ----- 35562 ----- 36498 ----- 37475 ----- 38584 ----- 39641 ----- 40548 ----- 41605 ----- 42527 ----- 43612 ----- 44702 ----- 45701 ----- 46726 ----- 47795 ----- 48935 ----- 50152 ----- 51183 ----- 52001 ----- 52904 ----- 53868 ----- 54808 ----- 55986 ----- 57155 ----- 58516 ----- 59526 ----- 60557 ----- 61547 ----- 62369 ----- 63672 ----- 64583 ----- 65360 ----- 66147 ----- 67201 ----- 68142 ----- 69145 ----- 70209 ----- 71141 ----- 71923 ----- 73031 ----- 73987 ----- 74974 ----- 76170 ----- 77138 ----- 77849 ----- 78931 ----- 79832 ----- 80761 ----- 81843 ----- 82834 ----- 84032 ----- 85072 ----- 86287 ----- 87302 ----- 88422 ----- 89432 ----- 90550 ----- 91463 ----- 92249 ----- 93385 ----- 94789 ----- 96013 ----- 96893 ----- 98000 ----- 99008 ----- 100166 ----- 101263 ----- 102351 ----- 103236 ----- 104121 ----- 105363 ----- 106329 ----- 107325 ----- 108231 ----- 109054 ----- 110019 ----- 111185 ----- 112112 ----- 112908 ----- 113904 ----- 114785 ----- 115410 ----- 116526 ----- 117559 ----- 118310 ----- 119073 ----- 120034 ----- 120817 ----- 121744 ----- 122566 ----- 123720 ----- 124813 ----- 125835 ----- 126622 ----- 127651 ----- 128328 ----- 129315 ----- 130244 ----- 131450 ----- 132439 ----- 133288 ----- 134164 ----- 135298 ----- 136347 ----- 137243 ----- 138256 ----- 139427 ----- 140374 ----- 141371 ----- 142302 ----- 143322 ----- 144335 ----- 145333 ----- 146212 ----- 147321 ----- 148591 ----- 149594 ------ 150514 ------ 151361 ------ 152059 ------ 153070 ------ 154059 ------ 155259 ------ 156473 ------ 157690 ------ 158703 ------ 159675 ------ 160597 ------ 161668 ------ 162737 ------ 163955 ------ 164942 ------ 165924 ------ 167059 ------ 167866 ------ 169034 ------ 169935 ------ 170712 ------ 171806 ------ 172841 ------ 174078 ------ 175347 ------ 176430 ------ 177346 ------ 178566 ------ 179515 ------ 180677 ------ 181729 ------ 182983 ------ 183814 ------ 184892 ------ 185696 ------ 186611 ------ 187744 ------ 188974 ------ 189911 ------ 190671 ------ 191607 ------ 192820 ------ 193789 ------ 195057 ------ 196224 ------ 197231 ------ 198281 ------ 199119 ------ 199999
      │    │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    │    ├── fd: (1)-->(2)
      │    │    │    │    │    │    │    │    │    └── ordering: +1
      │    │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │    │         └── p_name:2 LIKE '%green%' [type=bool, outer=(2), constraints=(/2: (/NULL - ])]
      │    │    │    │    │    │    │    ├── scan partsupp
      │    │    │    │    │    │    │    │    ├── save-table-name: q9_scan_13
      │    │    │    │    │    │    │    │    ├── columns: ps_partkey:36(int!null) ps_suppkey:37(int!null) ps_supplycost:39(float!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=800000, distinct(36)=199241, null(36)=0, distinct(37)=9920, null(37)=0, distinct(39)=100379, null(39)=0]
      │    │    │    │    │    │    │    │    │   histogram(36)=  0 80  3920  80   3920   80   3920   80   3920   80   3840  160   3840  160   3920   80   3920   80   3920   80   3920   80   3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3840   160   3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3840   160   3920   80    3920   80    3920   160   3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    3920   160    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80
      │    │    │    │    │    │    │    │    │                 <--- 4 ------ 793 ------ 1856 ------ 2808 ------ 3809 ------ 4923 ------ 5975 ------ 6944 ------ 8085 ------ 8945 ------ 9831 ------ 10952 ------ 11932 ------ 12775 ------ 13849 ------ 14925 ------ 16016 ------ 16828 ------ 17768 ------ 18705 ------ 19631 ------ 20600 ------ 21491 ------ 22254 ------ 23327 ------ 24491 ------ 25470 ------ 26331 ------ 27327 ------ 28308 ------ 29359 ------ 30542 ------ 31592 ------ 32495 ------ 33408 ------ 34624 ------ 35726 ------ 36676 ------ 37637 ------ 38485 ------ 39368 ------ 40372 ------ 41034 ------ 42185 ------ 43333 ------ 44466 ------ 45440 ------ 46571 ------ 47469 ------ 48346 ------ 49379 ------ 50571 ------ 51830 ------ 52967 ------ 53673 ------ 54656 ------ 55504 ------ 56539 ------ 57393 ------ 58366 ------ 59577 ------ 60559 ------ 61676 ------ 62471 ------ 63421 ------ 64449 ------ 65409 ------ 66254 ------ 67127 ------ 68127 ------ 69177 ------ 70183 ------ 71209 ------ 72101 ------ 73102 ------ 73994 ------ 74899 ------ 76016 ------ 77098 ------ 77842 ------ 79137 ------ 80242 ------ 81364 ------ 82331 ------ 83158 ------ 84283 ------ 85282 ------ 86437 ------ 87450 ------ 88419 ------ 89493 ------ 90478 ------ 91468 ------ 92552 ------ 93200 ------ 94191 ------ 95067 ------ 96272 ------ 97228 ------ 98126 ------ 99198 ------ 100219 ------ 101057 ------ 102038 ------ 102775 ------ 103711 ------ 104623 ------ 105710 ------ 106734 ------ 107932 ------ 109255 ------ 110220 ------ 111235 ------ 112174 ------ 113260 ------ 114081 ------ 115103 ------ 115864 ------ 116794 ------ 117741 ------ 118712 ------ 119470 ------ 120528 ------ 121572 ------ 122536 ------ 123629 ------ 124404 ------ 125301 ------ 126257 ------ 127139 ------ 128267 ------ 129258 ------ 130442 ------ 131845 ------ 133164 ------ 134005 ------ 135076 ------ 135868 ------ 137297 ------ 138777 ------ 139806 ------ 140741 ------ 141896 ------ 142719 ------ 143727 ------ 144645 ------ 145510 ------ 146507 ------ 147449 ------ 148467 ------ 149635 ------ 150563 ------ 151751 ------ 152613 ------ 153416 ------ 154612 ------ 155853 ------ 156866 ------ 158311 ------ 159230 ------ 160390 ------ 161455 ------ 162555 ------ 163435 ------ 164549 ------ 165663 ------ 166891 ------ 167757 ------ 168732 ------ 169644 ------ 170532 ------ 171671 ------ 172778 ------ 173599 ------ 174321 ------ 175624 ------ 176663 ------ 177632 ------ 178555 ------ 179551 ------ 180510 ------ 181682 ------ 182648 ------ 183408 ------ 184543 ------ 185722 ------ 186713 ------ 187787 ------ 188730 ------ 189604 ------ 190711 ------ 191690 ------ 192692 ------ 193702 ------ 194685 ------ 195725 ------ 196730 ------ 197724 ------ 198701 ------ 199973
      │    │    │    │    │    │    │    │    │   histogram(37)=  0 80  3920 240  3920  80  3920  160  3920  80   3920  240  3920  80   3760  320  3680  320  3920  80   3920  160  3920  240  3920  80   3920  160  3840  160  3920  80   3920  80   3760  240  3840  160  3920  80   3840  160  3680  320   3920   80   3840  160   3840  160   3760  320   3840  160   3840  160   3920   80   3840  240   3920   80   3920   80   3840  160   3760  240   3920  160   3920   80   3920   80   3920   80   3920  320   3920   80   3920  160   3840  400   3760  240   3920  160   3920  160   3600  480   3920   80   3680  320   3840  160   3840  160   3920  240   3840  160   3920  160   3920   80   3920  160   3920   80   3760  240   3920   80   3920   80   3840  320   3840  160   3840  160   3920  240   3840  480   3920  160   3840  240   3920  160   3920  160   3920   80   3840  160   3920   80   3920   80   3920   80   3920   80   3840  240   3840  240   3920   80   3840  320   3920   80   3920   80   3920  240   3840  240   3920  160   3920   80   3840  160   3840  240   3920  240   3840   80   3680  320   3920  160   3840  160   3840   80   3920   80   3840  160   3840  160   3920   80   3920   80   3840  160   3920   80   3920  160   3840  240   3840   80   3840  160   3760  160   3920   80   3920   80   3840  240   3760  240   3840   80   3920  160   3840   80   3920   80   3920   80   3920   80   3920  160   3840   80   3920   80   3760  240   3920   80   3920  160   3760  160   3920  160   3840   80   3920  160   3840  160   3840  160   3600  320   3920  160   3840   80   3920   80   3680  320   3840  240   3760  160   3920   80   3920   80   3920   80   3920   80   3920   80   3680  320   3920  160   3840  160   3760  160   3920  240   3840  160   3840  240   3600  320   3840   80   3840   80   3920  160   3760  160   3840  160   3840  320   3840   80   3840  160   3760  240   3840   80   3840  240   3760  160   3840  160   3840  160   3920  240   3760  160   3840   80   3920  160   3680  240   3840  160   3840  160   3760  240   3920   80   3920  240   3760  160   3760  240   3840   80   3840  240   3840  240   3760  320   3760  240   3840   80   3840  160   3840  240   3760  320   3760  160   3840  160   3840  160   3840   80   3760  160   3840   80   3840  160   3920  160   3840   80   3920   80   3840  160   3920   80   3840  240   3840   80   3920   80   3760  240   3920  240   3840   80   3680   240
      │    │    │    │    │    │    │    │    │                 <--- 2 ------ 49 ------ 90 ------ 141 ------ 183 ------ 235 ------ 278 ------ 319 ------ 360 ------ 406 ------ 458 ------ 511 ------ 561 ------ 622 ------ 674 ------ 731 ------ 781 ------ 822 ------ 882 ------ 934 ------ 988 ------ 1026 ------ 1072 ------ 1114 ------ 1188 ------ 1245 ------ 1291 ------ 1335 ------ 1380 ------ 1433 ------ 1488 ------ 1537 ------ 1590 ------ 1642 ------ 1692 ------ 1751 ------ 1807 ------ 1846 ------ 1887 ------ 1939 ------ 1994 ------ 2045 ------ 2097 ------ 2139 ------ 2190 ------ 2240 ------ 2293 ------ 2344 ------ 2385 ------ 2427 ------ 2484 ------ 2538 ------ 2601 ------ 2651 ------ 2730 ------ 2781 ------ 2825 ------ 2874 ------ 2938 ------ 2978 ------ 3034 ------ 3086 ------ 3139 ------ 3179 ------ 3231 ------ 3274 ------ 3334 ------ 3387 ------ 3431 ------ 3477 ------ 3530 ------ 3581 ------ 3633 ------ 3680 ------ 3725 ------ 3775 ------ 3820 ------ 3876 ------ 3923 ------ 3982 ------ 4036 ------ 4078 ------ 4116 ------ 4183 ------ 4227 ------ 4275 ------ 4336 ------ 4376 ------ 4424 ------ 4481 ------ 4537 ------ 4582 ------ 4630 ------ 4680 ------ 4727 ------ 4779 ------ 4828 ------ 4881 ------ 4938 ------ 4986 ------ 5040 ------ 5087 ------ 5138 ------ 5188 ------ 5237 ------ 5280 ------ 5318 ------ 5358 ------ 5405 ------ 5459 ------ 5516 ------ 5561 ------ 5615 ------ 5681 ------ 5744 ------ 5790 ------ 5847 ------ 5885 ------ 5927 ------ 5991 ------ 6042 ------ 6111 ------ 6165 ------ 6207 ------ 6259 ------ 6313 ------ 6359 ------ 6418 ------ 6471 ------ 6530 ------ 6587 ------ 6626 ------ 6672 ------ 6739 ------ 6784 ------ 6837 ------ 6886 ------ 6952 ------ 6994 ------ 7040 ------ 7081 ------ 7134 ------ 7178 ------ 7232 ------ 7280 ------ 7330 ------ 7378 ------ 7435 ------ 7486 ------ 7537 ------ 7593 ------ 7636 ------ 7680 ------ 7737 ------ 7788 ------ 7836 ------ 7877 ------ 7928 ------ 7993 ------ 8036 ------ 8083 ------ 8135 ------ 8180 ------ 8221 ------ 8263 ------ 8313 ------ 8352 ------ 8399 ------ 8453 ------ 8517 ------ 8566 ------ 8612 ------ 8664 ------ 8716 ------ 8766 ------ 8821 ------ 8871 ------ 8922 ------ 8956 ------ 9007 ------ 9050 ------ 9100 ------ 9154 ------ 9203 ------ 9246 ------ 9311 ------ 9358 ------ 9407 ------ 9470 ------ 9525 ------ 9564 ------ 9633 ------ 9672 ------ 9730 ------ 9778 ------ 9824 ------ 9868 ------ 9919 ------ 9959 ------ 10000
      │    │    │    │    │    │    │    │    ├── key: (36,37)
      │    │    │    │    │    │    │    │    ├── fd: (36,37)-->(39)
      │    │    │    │    │    │    │    │    └── ordering: +36
      │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters (true)
      │    │    │    └── filters
      │    │    │         └── s_suppkey:11 = l_suppkey:21 [type=bool, outer=(11,21), constraints=(/11: (/NULL - ]; /21: (/NULL - ]), fd=(11)==(21), (21)==(11)]
      │    │    ├── scan nation
      │    │    │    ├── save-table-name: q9_scan_14
      │    │    │    ├── columns: n_nationkey:52(int!null) n_name:53(char!null)
      │    │    │    ├── stats: [rows=25, distinct(52)=25, null(52)=0, distinct(53)=25, null(53)=0]
      │    │    │    │   histogram(52)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    ├── key: (52)
      │    │    │    └── fd: (52)-->(53)
      │    │    └── filters
      │    │         └── s_nationkey:14 = n_nationkey:52 [type=bool, outer=(14,52), constraints=(/14: (/NULL - ]; /52: (/NULL - ]), fd=(14)==(52), (52)==(14)]
      │    └── projections
      │         ├── extract('year', o_orderdate:46) [as=o_year:57, type=float, outer=(46), immutable]
      │         └── (l_extendedprice:24 * (1.0 - l_discount:25)) - (ps_supplycost:39 * l_quantity:23) [as=amount:58, type=float, outer=(23-25,39), immutable]
      └── aggregations
           └── sum [as=sum:59, type=float, outer=(58)]
                └── amount:58 [type=float]

stats table=q9_sort_1
----
column_names  row_count  distinct_count  null_count
{nation}      175        25              0
{o_year}      175        7               0
{sum_profit}  175        175             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{nation}      1548.00        8.85 <==       25.00               1.00                0.00            1.00
{o_year}      1548.00        8.85 <==       957.00              136.71 <==          0.00            1.00
{sum_profit}  1548.00        8.85 <==       1548.00             8.85 <==            0.00            1.00

stats table=q9_group_by_2
----
column_names  row_count  distinct_count  null_count
{n_name}      175        25              0
{o_year}      175        7               0
{sum}         175        175             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      1548.00        8.85 <==       25.00               1.00                0.00            1.00
{o_year}      1548.00        8.85 <==       957.00              136.71 <==          0.00            1.00
{sum}         1548.00        8.85 <==       1548.00             8.85 <==            0.00            1.00

stats table=q9_project_3
----
column_names  row_count  distinct_count  null_count
{amount}      319404     315234          0
{n_name}      319404     25              0
{o_year}      319404     7               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{amount}      2450.00        130.37 <==     958.00              329.05 <==          0.00            1.00
{n_name}      2450.00        130.37 <==     25.00               1.00                0.00            1.00
{o_year}      2450.00        130.37 <==     957.00              136.71 <==          0.00            1.00

stats table=q9_inner_join_4
----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{n_name}           319404     25              0
{n_nationkey}      319404     25              0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
{s_nationkey}      319404     25              0
{s_suppkey}        319404     9799            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2450.00        130.37 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2450.00        130.37 <==     958.00              221.90 <==          0.00            1.00
{l_orderkey}       2450.00        130.37 <==     1066.00             270.71 <==          0.00            1.00
{l_partkey}        2450.00        130.37 <==     1065.00             9.98 <==            0.00            1.00
{l_quantity}       2450.00        130.37 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2450.00        130.37 <==     1065.00             9.20 <==            0.00            1.00
{n_name}           2450.00        130.37 <==     25.00               1.00                0.00            1.00
{n_nationkey}      2450.00        130.37 <==     25.00               1.00                0.00            1.00
{o_orderdate}      2450.00        130.37 <==     957.00              2.51 <==            0.00            1.00
{o_orderkey}       2450.00        130.37 <==     1066.00             270.71 <==          0.00            1.00
{p_name}           2450.00        130.37 <==     2406.00             4.44 <==            0.00            1.00
{p_partkey}        2450.00        130.37 <==     1065.00             9.98 <==            0.00            1.00
{ps_partkey}       2450.00        130.37 <==     958.00              11.10 <==           0.00            1.00
{ps_suppkey}       2450.00        130.37 <==     958.00              10.23 <==           0.00            1.00
{ps_supplycost}    2450.00        130.37 <==     957.00              36.40 <==           0.00            1.00
{s_nationkey}      2450.00        130.37 <==     25.00               1.00                0.00            1.00
{s_suppkey}        2450.00        130.37 <==     1065.00             9.20 <==            0.00            1.00

stats table=q9_inner_join_5
----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
{s_nationkey}      319404     25              0
{s_suppkey}        319404     9799            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2450.00        130.37 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2450.00        130.37 <==     1058.00             200.93 <==          0.00            1.00
{l_orderkey}       2450.00        130.37 <==     1227.00             235.19 <==          0.00            1.00
{l_partkey}        2450.00        130.37 <==     1224.00             8.69 <==            0.00            1.00
{l_quantity}       2450.00        130.37 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2450.00        130.37 <==     1224.00             8.01 <==            0.00            1.00
{o_orderdate}      2450.00        130.37 <==     1057.00             2.28 <==            0.00            1.00
{o_orderkey}       2450.00        130.37 <==     1227.00             235.19 <==          0.00            1.00
{p_name}           2450.00        130.37 <==     2406.00             4.44 <==            0.00            1.00
{p_partkey}        2450.00        130.37 <==     1224.00             8.69 <==            0.00            1.00
{ps_partkey}       2450.00        130.37 <==     1059.00             10.04 <==           0.00            1.00
{ps_suppkey}       2450.00        130.37 <==     1059.00             9.25 <==            0.00            1.00
{ps_supplycost}    2450.00        130.37 <==     1056.00             32.99 <==           0.00            1.00
{s_nationkey}      2450.00        130.37 <==     25.00               1.00                0.00            1.00
{s_suppkey}        2450.00        130.37 <==     1224.00             8.01 <==            0.00            1.00

stats table=q9_scan_6
----
column_names   row_count  distinct_count  null_count
{s_nationkey}  10000      25              0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00

stats table=q9_lookup_join_7
----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2431.00        131.39 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2431.00        131.39 <==     1220.00             174.25 <==          0.00            1.00
{l_orderkey}       2431.00        131.39 <==     1536.00             187.87 <==          0.00            1.00
{l_partkey}        2431.00        131.39 <==     1535.00             6.93 <==            0.00            1.00
{l_quantity}       2431.00        131.39 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2431.00        131.39 <==     1220.00             8.03 <==            0.00            1.00
{o_orderdate}      2431.00        131.39 <==     1217.00             1.98 <==            0.00            1.00
{o_orderkey}       2431.00        131.39 <==     1536.00             187.87 <==          0.00            1.00
{p_name}           2431.00        131.39 <==     2387.00             4.47 <==            0.00            1.00
{p_partkey}        2431.00        131.39 <==     1535.00             6.93 <==            0.00            1.00
{ps_partkey}       2431.00        131.39 <==     1220.00             8.71 <==            0.00            1.00
{ps_suppkey}       2431.00        131.39 <==     1220.00             8.03 <==            0.00            1.00
{ps_supplycost}    2431.00        131.39 <==     1217.00             28.63 <==           0.00            1.00

stats table=q9_lookup_join_8
----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2431.00        131.39 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2431.00        131.39 <==     1535.00             138.49 <==          0.00            1.00
{l_orderkey}       2431.00        131.39 <==     1536.00             187.87 <==          0.00            1.00
{l_partkey}        2431.00        131.39 <==     2429.00             4.38 <==            0.00            1.00
{l_quantity}       2431.00        131.39 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2431.00        131.39 <==     1536.00             6.38 <==            0.00            1.00
{p_name}           2431.00        131.39 <==     2387.00             4.47 <==            0.00            1.00
{p_partkey}        2431.00        131.39 <==     2429.00             4.38 <==            0.00            1.00
{ps_partkey}       2431.00        131.39 <==     1536.00             6.92 <==            0.00            1.00
{ps_suppkey}       2431.00        131.39 <==     1536.00             6.38 <==            0.00            1.00
{ps_supplycost}    2431.00        131.39 <==     1528.00             22.80 <==           0.00            1.00

stats table=q9_lookup_join_9
----
column_names     row_count  distinct_count  null_count
{l_linenumber}   319404     7               0
{l_orderkey}     319404     288573          0
{l_partkey}      319404     10632           0
{l_suppkey}      319404     9799            0
{p_name}         319404     10680           0
{p_partkey}      319404     10632           0
{ps_partkey}     319404     10632           0
{ps_suppkey}     319404     9799            0
{ps_supplycost}  319404     34839           0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}   813.00         392.87 <==     7.00                1.00                0.00            1.00
{l_orderkey}     813.00         392.87 <==     813.00              354.95 <==          0.00            1.00
{l_partkey}      813.00         392.87 <==     813.00              13.08 <==           0.00            1.00
{l_suppkey}      813.00         392.87 <==     813.00              12.05 <==           0.00            1.00
{p_name}         813.00         392.87 <==     808.00              13.22 <==           0.00            1.00
{p_partkey}      813.00         392.87 <==     808.00              13.16 <==           0.00            1.00
{ps_partkey}     813.00         392.87 <==     813.00              13.08 <==           0.00            1.00
{ps_suppkey}     813.00         392.87 <==     813.00              12.05 <==           0.00            1.00
{ps_supplycost}  813.00         392.87 <==     809.00              43.06 <==           0.00            1.00

stats table=q9_merge_join_10
----
column_names     row_count  distinct_count  null_count
{p_name}         42656      10680           0
{p_partkey}      42656      10632           0
{ps_partkey}     42656      10632           0
{ps_suppkey}     42656      9801            0
{ps_supplycost}  42656      34850           0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}         267683.00      6.28 <==       65464.00            6.13 <==            0.00            1.00
{p_partkey}      267683.00      6.28 <==       66619.00            6.27 <==            0.00            1.00
{ps_partkey}     267683.00      6.28 <==       66619.00            6.27 <==            0.00            1.00
{ps_suppkey}     267683.00      6.28 <==       9920.00             1.01                0.00            1.00
{ps_supplycost}  267683.00      6.28 <==       93405.00            2.68 <==            0.00            1.00

stats table=q9_select_11
----
column_names  row_count  distinct_count  null_count
{p_name}      10664      10680           0
{p_partkey}   10664      10632           0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}      66667.00       6.25 <==       66667.00            6.24 <==            0.00            1.00
{p_partkey}   66667.00       6.25 <==       66619.00            6.27 <==            0.00            1.00

stats table=q9_scan_12
----
column_names  row_count  distinct_count  null_count
{p_name}      200000     198131          0
{p_partkey}   200000     199241          0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}      200000.00      1.00           198131.00           1.00                0.00            1.00
{p_partkey}   200000.00      1.00           199241.00           1.00                0.00            1.00

stats table=q9_scan_13
----
column_names     row_count  distinct_count  null_count
{ps_partkey}     800000     199241          0
{ps_suppkey}     800000     9920            0
{ps_supplycost}  800000     100379          0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_partkey}     800000.00      1.00           199241.00           1.00                0.00            1.00
{ps_suppkey}     800000.00      1.00           9920.00             1.00                0.00            1.00
{ps_supplycost}  800000.00      1.00           100379.00           1.00                0.00            1.00

stats table=q9_scan_14
----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
