import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q9
# Product Type Profit Measure
# Determines how much profit is made on a given line of parts, broken out by
# supplier nation and year.
#
# Finds, for each nation and each year, the profit for all parts ordered in that
# year that contain a specified substring in their names and that were filled by
# a supplier in that nation. The profit is defined as the sum of:
#
#   [(l_extendedprice*(1-l_discount)) - (ps_supplycost * l_quantity)]
#
# for all lineitems describing parts in the specified line. The query lists the
#  nations in ascending alphabetical order and, for each nation, the year and
#  profit in descending order by year (most recent first).
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q9
SELECT
    nation,
    o_year,
    sum(amount) AS sum_profit
FROM (
    SELECT
        n_name AS nation,
        extract(year FROM o_orderdate) AS o_year,
        l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount
    FROM
        part,
        supplier,
        lineitem,
        partsupp,
        orders,
        nation
    WHERE
        s_suppkey = l_suppkey
        AND ps_suppkey = l_suppkey
        AND ps_partkey = l_partkey
        AND p_partkey = l_partkey
        AND o_orderkey = l_orderkey
        AND s_nationkey = n_nationkey
        AND p_name LIKE '%green%'
    ) AS profit
GROUP BY
    nation,
    o_year
ORDER BY
    nation,
    o_year DESC;
----
----
sort
 ├── save-table-name: q9_sort_1
 ├── columns: nation:58(char!null) o_year:63(float) sum_profit:65(float!null)
 ├── immutable
 ├── stats: [rows=1548.77708, distinct(58)=25, null(58)=0, distinct(63)=957.29487, null(63)=0, distinct(65)=1548.77708, null(65)=0, distinct(58,63)=1548.77708, null(58,63)=0]
 ├── key: (58,63)
 ├── fd: (58,63)-->(65)
 ├── ordering: +58,-63
 └── group-by
      ├── save-table-name: q9_group_by_2
      ├── columns: n_name:58(char!null) o_year:63(float) sum:65(float!null)
      ├── grouping columns: n_name:58(char!null) o_year:63(float)
      ├── immutable
      ├── stats: [rows=1548.77708, distinct(58)=25, null(58)=0, distinct(63)=957.29487, null(63)=0, distinct(65)=1548.77708, null(65)=0, distinct(58,63)=1548.77708, null(58,63)=0]
      ├── key: (58,63)
      ├── fd: (58,63)-->(65)
      ├── project
      │    ├── save-table-name: q9_project_3
      │    ├── columns: o_year:63(float) amount:64(float!null) n_name:58(char!null)
      │    ├── immutable
      │    ├── stats: [rows=2450.85648, distinct(58)=25, null(58)=0, distinct(63)=957.29487, null(63)=0, distinct(64)=958.498508, null(64)=0, distinct(58,63)=1548.77708, null(58,63)=0]
      │    ├── inner-join (hash)
      │    │    ├── save-table-name: q9_inner_join_4
      │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) s_suppkey:12(int!null) s_nationkey:15(int!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_quantity:25(float!null) l_extendedprice:26(float!null) l_discount:27(float!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null) o_orderkey:46(int!null) o_orderdate:50(date!null) n_nationkey:57(int!null) n_name:58(char!null)
      │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
      │    │    ├── stats: [rows=2450.85648, distinct(1)=1065.2038, null(1)=0, distinct(2)=120, null(2)=0, distinct(12)=1064.71508, null(12)=0, distinct(15)=25, null(15)=0, distinct(21)=1066.62384, null(21)=0, distinct(22)=1065.2038, null(22)=0, distinct(23)=1064.71508, null(23)=0, distinct(25)=50, null(25)=0, distinct(26)=958.344453, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=958.498508, null(39)=0, distinct(40)=958.498508, null(40)=0, distinct(42)=734.534203, null(42)=0, distinct(46)=1066.62384, null(46)=0, distinct(50)=957.29487, null(50)=0, distinct(57)=25, null(57)=0, distinct(58)=25, null(58)=0, distinct(50,58)=1548.77708, null(50,58)=0, distinct(25-27,42)=958.498508, null(25-27,42)=0]
      │    │    ├── fd: (1)-->(2), (12)-->(15), (39,40)-->(42), (23)==(12,40), (40)==(12,23), (22)==(1,39), (39)==(1,22), (46)-->(50), (21)==(46), (46)==(21), (12)==(23,40), (57)-->(58), (15)==(57), (57)==(15), (1)==(22,39)
      │    │    ├── inner-join (hash)
      │    │    │    ├── save-table-name: q9_inner_join_5
      │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) s_suppkey:12(int!null) s_nationkey:15(int!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_quantity:25(float!null) l_extendedprice:26(float!null) l_discount:27(float!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null) o_orderkey:46(int!null) o_orderdate:50(date!null)
      │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
      │    │    │    ├── stats: [rows=2450.85648, distinct(1)=1224.06495, null(1)=0, distinct(2)=120, null(2)=0, distinct(12)=1224.40152, null(12)=0, distinct(15)=25, null(15)=0, distinct(21)=1227.57145, null(21)=0, distinct(22)=1224.06495, null(22)=0, distinct(23)=1224.40152, null(23)=0, distinct(25)=50, null(25)=0, distinct(26)=1058.55075, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=1058.77685, null(39)=0, distinct(40)=1058.77685, null(40)=0, distinct(42)=763.514127, null(42)=0, distinct(46)=1227.57145, null(46)=0, distinct(50)=1057.0113, null(50)=0]
      │    │    │    ├── fd: (1)-->(2), (12)-->(15), (39,40)-->(42), (23)==(12,40), (40)==(12,23), (22)==(1,39), (39)==(1,22), (46)-->(50), (21)==(46), (46)==(21), (12)==(23,40), (1)==(22,39)
      │    │    │    ├── scan supplier@s_nk
      │    │    │    │    ├── save-table-name: q9_scan_6
      │    │    │    │    ├── columns: s_suppkey:12(int!null) s_nationkey:15(int!null)
      │    │    │    │    ├── stats: [rows=10000, distinct(12)=9920, null(12)=0, distinct(15)=25, null(15)=0]
      │    │    │    │    │   histogram(12)=  0           0            0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50    1    0           0
      │    │    │    │    │                 <--- -9223372036854775808 --- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000 --- 9223372036854775807
      │    │    │    │    │   histogram(15)=  0 403 0 384 0 391 0 396 0 406 0 396 0 393 0 399 0 406 0 393 0 383  0 398  0 394  0 414  0 422  0 387  0 435  0 403  0 441  0 357  0 394  0 390  0 421  0 411  0 383
      │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    ├── key: (12)
      │    │    │    │    └── fd: (12)-->(15)
      │    │    │    ├── inner-join (lookup orders)
      │    │    │    │    ├── save-table-name: q9_lookup_join_7
      │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_quantity:25(float!null) l_extendedprice:26(float!null) l_discount:27(float!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null) o_orderkey:46(int!null) o_orderdate:50(date!null)
      │    │    │    │    ├── key columns: [21] = [46]
      │    │    │    │    ├── lookup columns are key
      │    │    │    │    ├── stats: [rows=2431.24963, distinct(1)=1535.73681, null(1)=0, distinct(2)=120, null(2)=0, distinct(21)=1535.87578, null(21)=0, distinct(22)=1535.73681, null(22)=0, distinct(23)=1220.40117, null(23)=0, distinct(25)=50, null(25)=0, distinct(26)=1220.02401, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=1220.40117, null(39)=0, distinct(40)=1220.40117, null(40)=0, distinct(42)=800.087388, null(42)=0, distinct(46)=1535.87578, null(46)=0, distinct(50)=1217.45885, null(50)=0]
      │    │    │    │    ├── fd: (1)-->(2), (39,40)-->(42), (23)==(40), (40)==(23), (22)==(1,39), (39)==(1,22), (46)-->(50), (21)==(46), (46)==(21), (1)==(22,39)
      │    │    │    │    ├── inner-join (lookup lineitem)
      │    │    │    │    │    ├── save-table-name: q9_lookup_join_8
      │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_quantity:25(float!null) l_extendedprice:26(float!null) l_discount:27(float!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │    │    │    │    │    ├── key columns: [21 24] = [21 24]
      │    │    │    │    │    ├── lookup columns are key
      │    │    │    │    │    ├── stats: [rows=2431.24963, distinct(1)=2429.49939, null(1)=0, distinct(2)=120, null(2)=0, distinct(21)=1535.87578, null(21)=0, distinct(22)=2429.49939, null(22)=0, distinct(23)=1536.38686, null(23)=0, distinct(25)=50, null(25)=0, distinct(26)=1535.58313, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=1536.38686, null(39)=0, distinct(40)=1536.38686, null(40)=0, distinct(42)=848.519925, null(42)=0]
      │    │    │    │    │    ├── fd: (1)-->(2), (39,40)-->(42), (23)==(40), (40)==(23), (22)==(1,39), (39)==(1,22), (1)==(22,39)
      │    │    │    │    │    ├── inner-join (lookup lineitem@l_pk_sk)
      │    │    │    │    │    │    ├── save-table-name: q9_lookup_join_9
      │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_linenumber:24(int!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │    │    │    │    │    │    ├── key columns: [39 40] = [22 23]
      │    │    │    │    │    │    ├── stats: [rows=812.918153, distinct(1)=807.978498, null(1)=0, distinct(2)=119.86287, null(2)=0, distinct(21)=812.701919, null(21)=0, distinct(22)=812.918153, null(22)=0, distinct(23)=812.918153, null(23)=0, distinct(24)=7, null(24)=0, distinct(39)=812.918153, null(39)=0, distinct(40)=812.918153, null(40)=0, distinct(42)=556.438238, null(42)=0]
      │    │    │    │    │    │    ├── key: (21,24)
      │    │    │    │    │    │    ├── fd: (1)-->(2), (39,40)-->(42), (1)==(22,39), (39)==(1,22), (21,24)-->(22,23), (22)==(1,39), (23)==(40), (40)==(23)
      │    │    │    │    │    │    ├── inner-join (merge)
      │    │    │    │    │    │    │    ├── save-table-name: q9_merge_join_10
      │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │    │    │    │    │    │    │    ├── left ordering: +1
      │    │    │    │    │    │    │    ├── right ordering: +39
      │    │    │    │    │    │    │    ├── stats: [rows=267682.522, distinct(1)=66618.6736, null(1)=0, distinct(2)=120, null(2)=0, distinct(39)=66618.6736, null(39)=0, distinct(40)=9920, null(40)=0, distinct(42)=1000, null(42)=0]
      │    │    │    │    │    │    │    ├── key: (39,40)
      │    │    │    │    │    │    │    ├── fd: (1)-->(2), (39,40)-->(42), (1)==(39), (39)==(1)
      │    │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    │    ├── save-table-name: q9_select_11
      │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=66666.6667, distinct(1)=66618.6736, null(1)=0, distinct(2)=120, null(2)=0]
      │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    ├── fd: (1)-->(2)
      │    │    │    │    │    │    │    │    ├── ordering: +1
      │    │    │    │    │    │    │    │    ├── scan part
      │    │    │    │    │    │    │    │    │    ├── save-table-name: q9_scan_12
      │    │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null)
      │    │    │    │    │    │    │    │    │    ├── stats: [rows=200000, distinct(1)=199241, null(1)=0, distinct(2)=120, null(2)=0]
      │    │    │    │    │    │    │    │    │    │   histogram(1)=  0           0            0 3.9981 1014.5 3.9981 1043.5 3.9981 946.55 3.9981 1105.5 3.9981 1017.5 3.9981 1020.5 3.9981 880.58 3.9981 954.55 3.9981 883.58 3.9981 933.56 3.9981 891.58 3.9981  1085.5 3.9981  1045.5 3.9981  1134.5 3.9981  1008.5 3.9981  1099.5 3.9981  941.55 3.9981  988.53 3.9981  1003.5 3.9981  894.58 3.9981  975.54 3.9981  1141.5 3.9981  990.53 3.9981  1008.5 3.9981  1074.5 3.9981  966.54 3.9981  994.53 3.9981  906.57 3.9981  1089.5 3.9981  922.56 3.9981  1010.5 3.9981  882.58 3.9981  971.54 3.9981  862.59 3.9981  972.54 3.9981  925.56 3.9981  1156.5 3.9981  1097.5 3.9981  972.54 3.9981  983.53 3.9981  1005.5 3.9981  1048.5 3.9981  1084.5 3.9981  898.57 3.9981  900.57 3.9981  1289.4 3.9981  864.59 3.9981  940.55 3.9981  968.54 3.9981  949.55 3.9981  1023.5 3.9981  865.59 3.9981  1019.5 3.9981  1051.5 3.9981  945.55 3.9981  930.56 3.9981  1086.5 3.9981  1108.5 3.9981  1102.5 3.9981  981.53 3.9981  967.54 3.9981  968.54 3.9981  1045.5 3.9981  829.61 3.9981  1082.5 3.9981  1100.5 3.9981  1007.5 3.9981  1041.5 3.9981  1044.5 3.9981  874.58 3.9981  1075.5 3.9981  1091.5 3.9981  923.56 3.9981  1049.5 3.9981  1064.5 3.9981  1056.5 3.9981  864.59 3.9981  1094.5 3.9981  921.56 3.9981  941.55 3.9981  1055.5 3.9981  1044.5 3.9981  939.55 3.9981  918.56 3.9981  1042.5 3.9981  901.57 3.9981  1003.5 3.9981  1177.4 3.9981  928.56 3.9981  1067.5 3.9981  987.53 3.9981  874.58 3.9981  912.57 3.9981  832.6 3.9981  953.55 3.9981  1078.5 3.9981  886.58 3.9981  894.58 3.9981  938.55 3.9981  987.53 3.9981  985.53  3.9981  1002.5  3.9981  1042.5  3.9981  1274.4  3.9981  1056.5  3.9981  953.55  3.9981  970.54  3.9981  1032.5  3.9981  967.54  3.9981  968.54  3.9981  937.55  3.9981  1130.5  3.9981  918.56  3.9981  904.57  3.9981  957.55  3.9981  1235.4  3.9981  1105.5  3.9981  1009.5  3.9981  1047.5  3.9981  950.55  3.9981  1022.5  3.9981  1069.5  3.9981  1005.5  3.9981  1118.5  3.9981  828.61  3.9981  1119.5  3.9981  842.6  3.9981  995.53  3.9981  983.53  3.9981  921.56  3.9981  1135.5  3.9981  1136.5  3.9981  972.54  3.9981  1125.5  3.9981  887.58  3.9981  1000.5  3.9981  1009.5  3.9981  987.53  3.9981  1066.5  3.9981  947.55  3.9981  991.53  3.9981  1025.5  3.9981  1119.5  3.9981  1020.5  3.9981  1034.5  3.9981  980.53  3.9981  895.57  3.9981  921.56  3.9981  964.54  3.9981  1014.5  3.9981  946.55  3.9981  1039.5  3.9981  1014.5  3.9981  953.55  3.9981  961.54  3.9981  936.56  3.9981  925.56  3.9981  951.55  3.9981  1036.5  3.9981  1020.5  3.9981  1033.5  3.9981  1004.5  3.9981  1053.5  3.9981  1009.5  3.9981  1094.5  3.9981  976.54  3.9981  1012.5  3.9981  1021.5  3.9981  1015.5  3.9981  919.56  3.9981  1078.5  3.9981  1038.5  3.9981  991.53  3.9981  930.56  3.9981  1064.5  3.9981  960.54  3.9981  1011.5  3.9981  970.54  3.9981  1103.5  3.9981  999.53  3.9981  1038.5  3.9981  1108.5  3.9981  1007.5  3.9981  1263.4  3.9981  861.59  3.9981  1009.5  3.9981  917.56  3.9981  1099.5  3.9981  1027.5  3.9981  1008.5  3.9981  983.53  3.9981  1010.5  3.9981  1067.5  3.9981  931.56  3.9981  984.53  3.9981  874.58  3.9981  1002.5  3.9981  954.55  3.9981  1040.5  3.9981  0           0
      │    │    │    │    │    │    │    │    │    │                <--- -9223372036854775808 ---- 28 --------- 1067 -------- 2159 -------- 3071 -------- 4270 -------- 5315 -------- 6366 -------- 7145 -------- 8073 -------- 8858 -------- 9745 -------- 10547 -------- 11712 -------- 12807 -------- 14056 -------- 15084 -------- 16273 -------- 17176 -------- 18168 -------- 19188 -------- 19996 -------- 20964 -------- 22225 -------- 23220 -------- 24249 -------- 25395 -------- 26346 -------- 27348 -------- 28181 -------- 29353 -------- 30217 -------- 31249 -------- 32031 -------- 32991 -------- 33729 -------- 34691 -------- 35561 -------- 36846 -------- 38031 -------- 38993 -------- 39976 -------- 40999 -------- 42099 -------- 43263 -------- 44078 -------- 44899 -------- 46401 -------- 47145 -------- 48046 -------- 49001 -------- 49918 -------- 50973 -------- 51718 -------- 52766 -------- 53872 -------- 54782 -------- 55662 -------- 56828 -------- 58033 -------- 59228 -------- 60207 -------- 61159 -------- 62113 -------- 63208 -------- 63870 -------- 65030 -------- 66220 -------- 67247 -------- 68334 -------- 69427 -------- 70192 -------- 71340 -------- 72515 -------- 73382 -------- 74484 -------- 75612 -------- 76726 -------- 77468 -------- 78648 -------- 79510 -------- 80412 -------- 81524 -------- 82617 -------- 83516 -------- 84373 -------- 85462 -------- 86284 -------- 87304 -------- 88625 -------- 89501 -------- 90635 -------- 91625 -------- 92391 -------- 93235 ------- 93905 -------- 94831 -------- 95983 -------- 96773 -------- 97580 -------- 98477 -------- 99466 -------- 100452 -------- 101470 -------- 102560 -------- 104039 -------- 105153 -------- 106078 -------- 107035 -------- 108107 -------- 109059 -------- 110014 -------- 110909 -------- 112151 -------- 113007 -------- 113835 -------- 114769 -------- 116184 -------- 117384 -------- 118415 -------- 119514 -------- 120434 -------- 121488 -------- 122626 -------- 123649 -------- 124870 -------- 125529 -------- 126753 ------- 127446 -------- 128450 -------- 129432 -------- 130295 -------- 131545 -------- 132797 -------- 133758 -------- 134991 -------- 135784 -------- 136797 -------- 137828 -------- 138817 -------- 139949 -------- 140862 -------- 141860 -------- 142919 -------- 144143 -------- 145194 -------- 146269 -------- 147245 -------- 148054 -------- 148917 -------- 149863 -------- 150902 -------- 151794 -------- 152862 -------- 153885 -------- 154792 -------- 155714 -------- 156586 -------- 157436 -------- 158338 -------- 159401 -------- 160434 -------- 161492 -------- 162496 -------- 163589 -------- 164603 -------- 165768 -------- 166719 -------- 167738 -------- 168773 -------- 169798 -------- 170636 -------- 171773 -------- 172839 -------- 173818 -------- 174678 -------- 175791 -------- 176712 -------- 177729 -------- 178668 -------- 179849 -------- 180844 -------- 181911 -------- 183101 -------- 184110 -------- 185558 -------- 186269 -------- 187282 -------- 188116 -------- 189290 -------- 190336 -------- 191348 -------- 192312 -------- 193328 -------- 194446 -------- 195308 -------- 196274 -------- 197016 -------- 198016 -------- 198924 -------- 199994 --- 9223372036854775807
      │    │    │    │    │    │    │    │    │    │   histogram(2)=  0                   1520                    1.9714e+05                   1340
      │    │    │    │    │    │    │    │    │    │                <--- 'almond antique aquamarine azure beige' ------------ 'beige azure aquamarine antique almond'
      │    │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    │    ├── fd: (1)-->(2)
      │    │    │    │    │    │    │    │    │    └── ordering: +1
      │    │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │    │         └── p_name:2 LIKE '%green%' [type=bool, outer=(2), constraints=(/2: (/NULL - ])]
      │    │    │    │    │    │    │    ├── scan partsupp
      │    │    │    │    │    │    │    │    ├── save-table-name: q9_scan_13
      │    │    │    │    │    │    │    │    ├── columns: ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=800000, distinct(39)=199241, null(39)=0, distinct(40)=9920, null(40)=0, distinct(42)=1000, null(42)=0]
      │    │    │    │    │    │    │    │    │   histogram(39)=  0           0            0 79.993 3911.6 79.993 3941.6 79.993 3926.6 79.993 3926.6 79.993 3926.6 79.993 3916.6 79.993 3908.6 79.993 3912.6 79.993 3934.6 79.993 3934.6 79.993  3929.6 79.993  3923.6 79.993  3932.6 158.99  3918.6 79.993  3915.6 79.993  3907.6 79.993  3912.6 79.993  3914.6 79.993  3922.6 79.993  3914.6 79.993  3921.6 79.993  3909.6 79.993  3927.6 79.993  3913.6 79.993  3913.6 79.993  3904.6 79.993  3913.6 79.993  3920.6 79.993  3913.6 79.993  3904.6 79.993  3904.6 79.993  3908.6 79.993  3908.6 79.993  3944.6 79.993  3916.6 79.993  3930.6 79.993  3904.6 79.993  3927.6 79.993  3923.6 79.993  3911.6 79.993  3911.6 79.993  3914.6 79.993  3913.6 79.993  3913.6 79.993  3922.6 79.993  3901.6 79.993  3922.6 79.993  3924.6 79.993  3920.6 79.993  3921.6 79.993  3930.6 79.993  3925.6 79.993  3913.6 79.993  3924.6 79.993  3939.6 79.993  3928.6 79.993  3924.6 79.993  3918.6 79.993  3928.6 79.993  3916.6 79.993  3911.6 79.993  3936.6 79.993  3933.6 79.993  3831.6 158.99  3903.6 79.993  3911.6 79.993  3913.6 79.993  3911.6 79.993  3909.6 79.993  3913.6 79.993  3920.6 79.993  3910.6 79.993  3906.6 79.993  3918.6 79.993  3910.6 79.993  3908.6 79.993  3910.6 79.993  3911.6 79.993  3903.6 79.993  3903.6 79.993  3904.6 79.993  3923.6 79.993  3933.6 79.993  3928.6 79.993  3834.6 158.99  3928.6 79.993  3904.6 79.993  3943.6 79.993  3909.6 79.993  3943.6 79.993  3918.6 79.993  3919.6 79.993  3923.6 79.993  3916.6 79.993  3942.6 79.993  3934.6 79.993  3922.6 79.993  3908.6 79.993  3919.6 79.993  3910.6 79.993  3943.6  79.993  3912.6  79.993  3916.6  79.993  3951.6  79.993  3919.6  79.993  3906.6  79.993  3920.6  79.993  3941.6  79.993  3913.6  79.993  3905.6  79.993  3909.6  79.993  3909.6  79.993  3905.6  79.993  3913.6  79.993  3918.6  79.993  3934.6  79.993  3902.6  79.993  3907.6  79.993  3923.6  79.993  3922.6  79.993  3926.6  79.993  3917.6  79.993  3827.6  158.99  3911.6  79.993  3911.6  79.993  3937.6  79.993  3904.6  79.993  3975.6  79.993  3905.6  158.99  3917.6  79.993  3918.6  79.993  3906.6  79.993  3930.6  79.993  3917.6  79.993  3909.6  79.993  3916.6  79.993  3912.6  79.993  3922.6  79.993  3912.6  79.993  3907.6  79.993  3905.6  79.993  3912.6  79.993  3931.6  79.993  3913.6  79.993  3918.6  79.993  3920.6  79.993  3911.6  79.993  3902.6  79.993  3917.6  79.993  3920.6  79.993  3915.6  79.993  3904.6  79.993  4056.6  79.993  4020.6  79.993  4006.6  79.993  4046.6  79.993  4006.6  79.993  3998.6  79.993  4012.6  79.993  3985.6  79.993  3991.6  79.993  4009.6  79.993  3989.6  79.993  4032.6  79.993  3989.6  79.993  3990.6  79.993  3985.6  79.993  4024.6  79.993  3993.6  79.993  4000.6  79.993  4039.6  79.993  3987.6  79.993  4016.6  79.993  4017.6  79.993  3990.6  79.993  3998.6  79.993  4002.6  79.993  4005.6  79.993  4003.6  79.993  4000.6  79.993  4026.6  79.993  3995.6  79.993  3997.6  79.993  4014.6  79.993  4008.6  79.993  4002.6  79.993  3989.6  79.993  4017.6  79.993  4003.6  79.993  3988.6  79.993  4028.6  79.993  3997.6  79.993  4000.6  79.993  3998.6  158.99  3904.6  79.993  3990.6  79.993  3989.6  79.993  3997.6  79.993  3988.6  79.993  0           0
      │    │    │    │    │    │    │    │    │                 <--- -9223372036854775808 ---- 5 ---------- 925 --------- 2147 -------- 3243 -------- 4346 -------- 5444 -------- 6433 -------- 7290 -------- 8225 -------- 9393 -------- 10561 -------- 11687 -------- 12755 -------- 13905 -------- 14921 -------- 15897 -------- 16739 -------- 17675 -------- 18640 -------- 19705 -------- 20671 -------- 21719 -------- 22602 -------- 23714 -------- 24672 -------- 25620 -------- 26379 -------- 27327 -------- 28366 -------- 29320 -------- 30070 -------- 30837 -------- 31707 -------- 32567 -------- 33809 -------- 34795 -------- 35930 -------- 36688 -------- 37801 -------- 38874 -------- 39798 -------- 40717 -------- 41686 -------- 42635 -------- 43586 -------- 44647 -------- 45188 -------- 46250 -------- 47331 -------- 48366 -------- 49411 -------- 50547 -------- 51636 -------- 52588 -------- 53673 -------- 54877 -------- 55992 -------- 57071 -------- 58085 -------- 59202 -------- 60194 -------- 61109 -------- 62289 -------- 63452 -------- 64350 -------- 65061 -------- 65983 -------- 66930 -------- 67848 -------- 68740 -------- 69687 -------- 70729 -------- 71625 -------- 72441 -------- 73462 -------- 74357 -------- 75226 -------- 76123 -------- 77037 -------- 77774 -------- 78521 -------- 79269 -------- 80341 -------- 81504 -------- 82626 -------- 83571 -------- 84691 -------- 85448 -------- 86681 -------- 87565 -------- 88799 -------- 89810 -------- 90834 -------- 91901 -------- 92892 -------- 94119 -------- 95284 -------- 96346 -------- 97205 -------- 98231 -------- 99141 -------- 100372 -------- 101314 -------- 102304 -------- 103594 -------- 104620 -------- 105437 -------- 106475 -------- 107696 -------- 108646 -------- 109445 -------- 110330 -------- 111220 -------- 112020 -------- 112978 -------- 113996 -------- 115166 -------- 115838 -------- 116694 -------- 117766 -------- 118830 -------- 119934 -------- 120936 -------- 121757 -------- 122685 -------- 123602 -------- 124791 -------- 125549 -------- 126970 -------- 127770 -------- 128776 -------- 129788 -------- 130602 -------- 131740 -------- 132748 -------- 133632 -------- 134629 -------- 135564 -------- 136625 -------- 137559 -------- 138398 -------- 139204 -------- 140136 -------- 141281 -------- 142230 -------- 143246 -------- 144284 -------- 145212 -------- 145869 -------- 146873 -------- 147910 -------- 148889 -------- 149656 -------- 151106 -------- 152338 -------- 153457 -------- 154854 -------- 155973 -------- 157005 -------- 158178 -------- 159002 -------- 159939 -------- 161091 -------- 162000 -------- 163314 -------- 164230 -------- 165157 -------- 165980 -------- 167242 -------- 168207 -------- 169271 -------- 170628 -------- 171503 -------- 172711 -------- 173922 -------- 174853 -------- 175886 -------- 176965 -------- 178073 -------- 179166 -------- 180231 -------- 181505 -------- 182510 -------- 183541 -------- 184734 -------- 185872 -------- 186957 -------- 187866 -------- 189075 -------- 190166 -------- 191061 -------- 192354 -------- 193380 -------- 194445 -------- 195479 -------- 196243 -------- 197170 -------- 198076 -------- 199103 -------- 199994 --- 9223372036854775807
      │    │    │    │    │    │    │    │    │   histogram(40)=  0 240 3920 160  3840  160  3840  160  3920  80   3760  240  3920  80   3920  160  3920  80   3920  80   3920  160  3760  320  3920  80   3920  80   3840  160  3920  80   3760  240  3840  240  3920  80   3920  80   3840  160   3920   80   3920   80   3920   80   3920  240   3920  320   3920   80   3920   80   3920   80   3920   80   3920  160   3920  160   3920   80   3920  160   3680  320   3920  160   3840  240   3920   80   3920   80   3840  160   3920   80   3920   80   3840  160   3920   80   3920  320   3920   80   3920  160   3920   80   3920  160   3920  160   3920   80   3920   80   3840  320   3920   80   3680  320   3920  160   3680  400   3840  240   3840  160   3920  240   3920   80   3920  320   3920  320   3920  160   3760  320   3760  240   3920   80   3920   80   3840  160   3840  320   3840  160   3920  160   3920   80   3920   80   3920   80   3920   80   3920  160   3920   80   3840  240   3920   80   3840  160   3840  160   3840  240   3840  160   3920   80   3920  160   3920   80   3840  160   3920   80   3920  240   3920  160   3920  160   3840  160   3920  160   3840   80   3840  240   3840  160   3760  160   3920  160   3840   80   3840  160   3920   80   3920   80   3920   80   3920   80   3840  160   3920  240   3760  160   3840   80   3840  320   3760  160   3680  240   3840  160   3760  320   3840  240   3840  160   3840   80   3840  160   3840   80   3920   80   3920  240   3760  160   3840   80   3920  160   3600  320   3920  160   3840  240   3840   80   3840  160   3840  160   3680  320   3760  240   3840   80   3840  160   3760  400   3840  160   3840  160   3680  320   3840   80   3840   80   3920   80   3840  160   3920  160   3840   80   3920   80   3840  160   3920  320   3760  160   3840  160   3840   80   3840  160   3840   80   3680  320   3920   80   3920  160   3840   80   3840  240   3840   80   3920   80   3920   80   3760  240   3920  160   3840  160   3840  240   3840   80   3680  240   3920   80   3920   80   3680  320   3920   80   3920   80   3920  160   3840  240   3840  160   3840  160   3680  240   3760  160   3920   80   3920   80   3760  240   3840  240   3840   80   3840  160   3760  240   3920  160   3840  240   3680  320   3840  160   3840   80   3760  160   3920  240   3840   80   3840   80   3840  160   3920   80   3680  320   3920  160   3760  160   3840  160   3920   80
      │    │    │    │    │    │    │    │    │                 <--- 1 ------ 48 ------ 112 ------ 174 ------ 233 ------ 271 ------ 318 ------ 364 ------ 415 ------ 468 ------ 521 ------ 565 ------ 617 ------ 658 ------ 713 ------ 767 ------ 817 ------ 878 ------ 930 ------ 978 ------ 1034 ------ 1095 ------ 1150 ------ 1193 ------ 1243 ------ 1294 ------ 1348 ------ 1402 ------ 1468 ------ 1507 ------ 1552 ------ 1614 ------ 1673 ------ 1731 ------ 1780 ------ 1834 ------ 1881 ------ 1940 ------ 1994 ------ 2041 ------ 2096 ------ 2153 ------ 2199 ------ 2256 ------ 2304 ------ 2349 ------ 2401 ------ 2451 ------ 2498 ------ 2546 ------ 2599 ------ 2643 ------ 2683 ------ 2731 ------ 2772 ------ 2827 ------ 2869 ------ 2915 ------ 2973 ------ 3023 ------ 3078 ------ 3129 ------ 3184 ------ 3236 ------ 3296 ------ 3353 ------ 3413 ------ 3473 ------ 3521 ------ 3566 ------ 3607 ------ 3657 ------ 3718 ------ 3775 ------ 3813 ------ 3868 ------ 3924 ------ 3971 ------ 4008 ------ 4065 ------ 4123 ------ 4174 ------ 4231 ------ 4269 ------ 4332 ------ 4385 ------ 4436 ------ 4484 ------ 4537 ------ 4588 ------ 4633 ------ 4685 ------ 4733 ------ 4783 ------ 4834 ------ 4874 ------ 4918 ------ 4953 ------ 5008 ------ 5052 ------ 5096 ------ 5147 ------ 5197 ------ 5245 ------ 5292 ------ 5341 ------ 5396 ------ 5449 ------ 5498 ------ 5547 ------ 5602 ------ 5651 ------ 5703 ------ 5742 ------ 5786 ------ 5827 ------ 5865 ------ 5935 ------ 5980 ------ 6050 ------ 6096 ------ 6153 ------ 6208 ------ 6270 ------ 6309 ------ 6358 ------ 6412 ------ 6464 ------ 6518 ------ 6577 ------ 6640 ------ 6676 ------ 6735 ------ 6792 ------ 6835 ------ 6877 ------ 6916 ------ 6968 ------ 7025 ------ 7061 ------ 7107 ------ 7159 ------ 7221 ------ 7264 ------ 7300 ------ 7356 ------ 7390 ------ 7448 ------ 7495 ------ 7547 ------ 7605 ------ 7648 ------ 7707 ------ 7755 ------ 7818 ------ 7858 ------ 7904 ------ 7951 ------ 7992 ------ 8049 ------ 8098 ------ 8144 ------ 8194 ------ 8234 ------ 8282 ------ 8323 ------ 8376 ------ 8433 ------ 8474 ------ 8514 ------ 8564 ------ 8623 ------ 8676 ------ 8734 ------ 8784 ------ 8819 ------ 8857 ------ 8907 ------ 8955 ------ 9012 ------ 9060 ------ 9103 ------ 9157 ------ 9200 ------ 9249 ------ 9301 ------ 9339 ------ 9381 ------ 9430 ------ 9474 ------ 9529 ------ 9579 ------ 9631 ------ 9673 ------ 9732 ------ 9780 ------ 9832 ------ 9886 ------ 9941 ------ 9997
      │    │    │    │    │    │    │    │    │   histogram(42)=  0          1040          7.9808e+05  880
      │    │    │    │    │    │    │    │    │                 <--- 0.009999999776482582 ------------ 10.0
      │    │    │    │    │    │    │    │    ├── key: (39,40)
      │    │    │    │    │    │    │    │    ├── fd: (39,40)-->(42)
      │    │    │    │    │    │    │    │    └── ordering: +39
      │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters (true)
      │    │    │    └── filters
      │    │    │         └── s_suppkey:12 = l_suppkey:23 [type=bool, outer=(12,23), constraints=(/12: (/NULL - ]; /23: (/NULL - ]), fd=(12)==(23), (23)==(12)]
      │    │    ├── scan nation
      │    │    │    ├── save-table-name: q9_scan_14
      │    │    │    ├── columns: n_nationkey:57(int!null) n_name:58(char!null)
      │    │    │    ├── stats: [rows=25, distinct(57)=25, null(57)=0, distinct(58)=25, null(58)=0]
      │    │    │    │   histogram(57)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │   histogram(58)=  0      1      23      1
      │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    ├── key: (57)
      │    │    │    └── fd: (57)-->(58)
      │    │    └── filters
      │    │         └── s_nationkey:15 = n_nationkey:57 [type=bool, outer=(15,57), constraints=(/15: (/NULL - ]; /57: (/NULL - ]), fd=(15)==(57), (57)==(15)]
      │    └── projections
      │         ├── extract('year', o_orderdate:50) [as=o_year:63, type=float, outer=(50), immutable]
      │         └── (l_extendedprice:26 * (1.0 - l_discount:27)) - (ps_supplycost:42 * l_quantity:25) [as=amount:64, type=float, outer=(25-27,42), immutable]
      └── aggregations
           └── sum [as=sum:65, type=float, outer=(64)]
                └── amount:64 [type=float]

----Stats for q9_sort_1----
column_names  row_count  distinct_count  null_count
{nation}      175        25              0
{o_year}      175        7               0
{sum_profit}  175        175             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{nation}      1549.00        8.85 <==       25.00               1.00                0.00            1.00
{o_year}      1549.00        8.85 <==       957.00              136.71 <==          0.00            1.00
{sum_profit}  1549.00        8.85 <==       1549.00             8.85 <==            0.00            1.00

----Stats for q9_group_by_2----
column_names  row_count  distinct_count  null_count
{n_name}      175        25              0
{o_year}      175        7               0
{sum}         175        175             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      1549.00        8.85 <==       25.00               1.00                0.00            1.00
{o_year}      1549.00        8.85 <==       957.00              136.71 <==          0.00            1.00
{sum}         1549.00        8.85 <==       1549.00             8.85 <==            0.00            1.00

----Stats for q9_project_3----
column_names  row_count  distinct_count  null_count
{amount}      319404     315234          0
{n_name}      319404     25              0
{o_year}      319404     7               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{amount}      2451.00        130.32 <==     958.00              329.05 <==          0.00            1.00
{n_name}      2451.00        130.32 <==     25.00               1.00                0.00            1.00
{o_year}      2451.00        130.32 <==     957.00              136.71 <==          0.00            1.00

----Stats for q9_inner_join_4----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{n_name}           319404     25              0
{n_nationkey}      319404     25              0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
{s_nationkey}      319404     25              0
{s_suppkey}        319404     9799            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2451.00        130.32 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2451.00        130.32 <==     958.00              221.90 <==          0.00            1.00
{l_orderkey}       2451.00        130.32 <==     1067.00             270.45 <==          0.00            1.00
{l_partkey}        2451.00        130.32 <==     1065.00             9.98 <==            0.00            1.00
{l_quantity}       2451.00        130.32 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2451.00        130.32 <==     1065.00             9.20 <==            0.00            1.00
{n_name}           2451.00        130.32 <==     25.00               1.00                0.00            1.00
{n_nationkey}      2451.00        130.32 <==     25.00               1.00                0.00            1.00
{o_orderdate}      2451.00        130.32 <==     957.00              2.51 <==            0.00            1.00
{o_orderkey}       2451.00        130.32 <==     1067.00             270.45 <==          0.00            1.00
{p_name}           2451.00        130.32 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}        2451.00        130.32 <==     1065.00             9.98 <==            0.00            1.00
{ps_partkey}       2451.00        130.32 <==     958.00              11.10 <==           0.00            1.00
{ps_suppkey}       2451.00        130.32 <==     958.00              10.23 <==           0.00            1.00
{ps_supplycost}    2451.00        130.32 <==     735.00              47.40 <==           0.00            1.00
{s_nationkey}      2451.00        130.32 <==     25.00               1.00                0.00            1.00
{s_suppkey}        2451.00        130.32 <==     1065.00             9.20 <==            0.00            1.00

----Stats for q9_inner_join_5----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
{s_nationkey}      319404     25              0
{s_suppkey}        319404     9799            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2451.00        130.32 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2451.00        130.32 <==     1059.00             200.74 <==          0.00            1.00
{l_orderkey}       2451.00        130.32 <==     1228.00             234.99 <==          0.00            1.00
{l_partkey}        2451.00        130.32 <==     1224.00             8.69 <==            0.00            1.00
{l_quantity}       2451.00        130.32 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2451.00        130.32 <==     1224.00             8.01 <==            0.00            1.00
{o_orderdate}      2451.00        130.32 <==     1057.00             2.28 <==            0.00            1.00
{o_orderkey}       2451.00        130.32 <==     1228.00             234.99 <==          0.00            1.00
{p_name}           2451.00        130.32 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}        2451.00        130.32 <==     1224.00             8.69 <==            0.00            1.00
{ps_partkey}       2451.00        130.32 <==     1059.00             10.04 <==           0.00            1.00
{ps_suppkey}       2451.00        130.32 <==     1059.00             9.25 <==            0.00            1.00
{ps_supplycost}    2451.00        130.32 <==     764.00              45.60 <==           0.00            1.00
{s_nationkey}      2451.00        130.32 <==     25.00               1.00                0.00            1.00
{s_suppkey}        2451.00        130.32 <==     1224.00             8.01 <==            0.00            1.00

----Stats for q9_scan_6----
column_names   row_count  distinct_count  null_count
{s_nationkey}  10000      25              0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00

----Stats for q9_lookup_join_7----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2431.00        131.39 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2431.00        131.39 <==     1220.00             174.25 <==          0.00            1.00
{l_orderkey}       2431.00        131.39 <==     1536.00             187.87 <==          0.00            1.00
{l_partkey}        2431.00        131.39 <==     1536.00             6.92 <==            0.00            1.00
{l_quantity}       2431.00        131.39 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2431.00        131.39 <==     1220.00             8.03 <==            0.00            1.00
{o_orderdate}      2431.00        131.39 <==     1217.00             1.98 <==            0.00            1.00
{o_orderkey}       2431.00        131.39 <==     1536.00             187.87 <==          0.00            1.00
{p_name}           2431.00        131.39 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}        2431.00        131.39 <==     1536.00             6.92 <==            0.00            1.00
{ps_partkey}       2431.00        131.39 <==     1220.00             8.71 <==            0.00            1.00
{ps_suppkey}       2431.00        131.39 <==     1220.00             8.03 <==            0.00            1.00
{ps_supplycost}    2431.00        131.39 <==     800.00              43.55 <==           0.00            1.00

----Stats for q9_lookup_join_8----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2431.00        131.39 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2431.00        131.39 <==     1536.00             138.40 <==          0.00            1.00
{l_orderkey}       2431.00        131.39 <==     1536.00             187.87 <==          0.00            1.00
{l_partkey}        2431.00        131.39 <==     2429.00             4.38 <==            0.00            1.00
{l_quantity}       2431.00        131.39 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2431.00        131.39 <==     1536.00             6.38 <==            0.00            1.00
{p_name}           2431.00        131.39 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}        2431.00        131.39 <==     2429.00             4.38 <==            0.00            1.00
{ps_partkey}       2431.00        131.39 <==     1536.00             6.92 <==            0.00            1.00
{ps_suppkey}       2431.00        131.39 <==     1536.00             6.38 <==            0.00            1.00
{ps_supplycost}    2431.00        131.39 <==     849.00              41.04 <==           0.00            1.00

----Stats for q9_lookup_join_9----
column_names     row_count  distinct_count  null_count
{l_linenumber}   319404     7               0
{l_orderkey}     319404     288573          0
{l_partkey}      319404     10632           0
{l_suppkey}      319404     9799            0
{p_name}         319404     10680           0
{p_partkey}      319404     10632           0
{ps_partkey}     319404     10632           0
{ps_suppkey}     319404     9799            0
{ps_supplycost}  319404     34839           0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}   813.00         392.87 <==     7.00                1.00                0.00            1.00
{l_orderkey}     813.00         392.87 <==     813.00              354.95 <==          0.00            1.00
{l_partkey}      813.00         392.87 <==     813.00              13.08 <==           0.00            1.00
{l_suppkey}      813.00         392.87 <==     813.00              12.05 <==           0.00            1.00
{p_name}         813.00         392.87 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}      813.00         392.87 <==     808.00              13.16 <==           0.00            1.00
{ps_partkey}     813.00         392.87 <==     813.00              13.08 <==           0.00            1.00
{ps_suppkey}     813.00         392.87 <==     813.00              12.05 <==           0.00            1.00
{ps_supplycost}  813.00         392.87 <==     556.00              62.66 <==           0.00            1.00

----Stats for q9_merge_join_10----
column_names     row_count  distinct_count  null_count
{p_name}         42656      10680           0
{p_partkey}      42656      10632           0
{ps_partkey}     42656      10632           0
{ps_suppkey}     42656      9801            0
{ps_supplycost}  42656      34850           0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}         267683.00      6.28 <==       120.00              89.00 <==           0.00            1.00
{p_partkey}      267683.00      6.28 <==       66619.00            6.27 <==            0.00            1.00
{ps_partkey}     267683.00      6.28 <==       66619.00            6.27 <==            0.00            1.00
{ps_suppkey}     267683.00      6.28 <==       9920.00             1.01                0.00            1.00
{ps_supplycost}  267683.00      6.28 <==       1000.00             34.85 <==           0.00            1.00

----Stats for q9_select_11----
column_names  row_count  distinct_count  null_count
{p_name}      10664      10680           0
{p_partkey}   10664      10632           0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}      66667.00       6.25 <==       120.00              89.00 <==           0.00            1.00
{p_partkey}   66667.00       6.25 <==       66619.00            6.27 <==            0.00            1.00

----Stats for q9_scan_12----
column_names  row_count  distinct_count  null_count
{p_name}      200000     198131          0
{p_partkey}   200000     199241          0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}      200000.00      1.00           120.00              1651.09 <==         0.00            1.00
{p_partkey}   200000.00      1.00           199241.00           1.00                0.00            1.00

----Stats for q9_scan_13----
column_names     row_count  distinct_count  null_count
{ps_partkey}     800000     199241          0
{ps_suppkey}     800000     9920            0
{ps_supplycost}  800000     100379          0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_partkey}     800000.00      1.00           199241.00           1.00                0.00            1.00
{ps_suppkey}     800000.00      1.00           9920.00             1.00                0.00            1.00
{ps_supplycost}  800000.00      1.00           1000.00             100.38 <==          0.00            1.00

----Stats for q9_scan_14----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
----
----
