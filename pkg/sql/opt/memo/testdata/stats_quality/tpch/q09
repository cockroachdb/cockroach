import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q9
# Product Type Profit Measure
# Determines how much profit is made on a given line of parts, broken out by
# supplier nation and year.
#
# Finds, for each nation and each year, the profit for all parts ordered in that
# year that contain a specified substring in their names and that were filled by
# a supplier in that nation. The profit is defined as the sum of:
#
#   [(l_extendedprice*(1-l_discount)) - (ps_supplycost * l_quantity)]
#
# for all lineitems describing parts in the specified line. The query lists the
#  nations in ascending alphabetical order and, for each nation, the year and
#  profit in descending order by year (most recent first).
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q9
SELECT
    nation,
    o_year,
    sum(amount) AS sum_profit
FROM (
    SELECT
        n_name AS nation,
        extract(year FROM o_orderdate) AS o_year,
        l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount
    FROM
        part,
        supplier,
        lineitem,
        partsupp,
        orders,
        nation
    WHERE
        s_suppkey = l_suppkey
        AND ps_suppkey = l_suppkey
        AND ps_partkey = l_partkey
        AND p_partkey = l_partkey
        AND o_orderkey = l_orderkey
        AND s_nationkey = n_nationkey
        AND p_name LIKE '%green%'
    ) AS profit
GROUP BY
    nation,
    o_year
ORDER BY
    nation,
    o_year DESC;
----
----
sort
 ├── save-table-name: q9_sort_1
 ├── columns: nation:58(char!null) o_year:63(float) sum_profit:65(float!null)
 ├── immutable
 ├── stats: [rows=1548.77708, distinct(58)=25, null(58)=0, distinct(63)=957.29487, null(63)=0, distinct(65)=1548.77708, null(65)=0, distinct(58,63)=1548.77708, null(58,63)=0]
 ├── key: (58,63)
 ├── fd: (58,63)-->(65)
 ├── ordering: +58,-63
 └── group-by
      ├── save-table-name: q9_group_by_2
      ├── columns: n_name:58(char!null) o_year:63(float) sum:65(float!null)
      ├── grouping columns: n_name:58(char!null) o_year:63(float)
      ├── immutable
      ├── stats: [rows=1548.77708, distinct(58)=25, null(58)=0, distinct(63)=957.29487, null(63)=0, distinct(65)=1548.77708, null(65)=0, distinct(58,63)=1548.77708, null(58,63)=0]
      ├── key: (58,63)
      ├── fd: (58,63)-->(65)
      ├── project
      │    ├── save-table-name: q9_project_3
      │    ├── columns: o_year:63(float) amount:64(float!null) n_name:58(char!null)
      │    ├── immutable
      │    ├── stats: [rows=2450.85648, distinct(58)=25, null(58)=0, distinct(63)=957.29487, null(63)=0, distinct(64)=958.498508, null(64)=0, distinct(58,63)=1548.77708, null(58,63)=0]
      │    ├── inner-join (hash)
      │    │    ├── save-table-name: q9_inner_join_4
      │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) s_suppkey:12(int!null) s_nationkey:15(int!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_quantity:25(float!null) l_extendedprice:26(float!null) l_discount:27(float!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null) o_orderkey:46(int!null) o_orderdate:50(date!null) n_nationkey:57(int!null) n_name:58(char!null)
      │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
      │    │    ├── stats: [rows=2450.85648, distinct(1)=1065.2038, null(1)=0, distinct(2)=120, null(2)=0, distinct(12)=1064.71508, null(12)=0, distinct(15)=25, null(15)=0, distinct(21)=1066.62384, null(21)=0, distinct(22)=1065.2038, null(22)=0, distinct(23)=1064.71508, null(23)=0, distinct(25)=50, null(25)=0, distinct(26)=958.344453, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=958.498508, null(39)=0, distinct(40)=958.498508, null(40)=0, distinct(42)=734.534203, null(42)=0, distinct(46)=1066.62384, null(46)=0, distinct(50)=957.29487, null(50)=0, distinct(57)=25, null(57)=0, distinct(58)=25, null(58)=0, distinct(50,58)=1548.77708, null(50,58)=0, distinct(25-27,42)=958.498508, null(25-27,42)=0]
      │    │    ├── fd: (1)-->(2), (12)-->(15), (39,40)-->(42), (23)==(12,40), (40)==(12,23), (22)==(1,39), (39)==(1,22), (46)-->(50), (21)==(46), (46)==(21), (12)==(23,40), (57)-->(58), (15)==(57), (57)==(15), (1)==(22,39)
      │    │    ├── inner-join (hash)
      │    │    │    ├── save-table-name: q9_inner_join_5
      │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) s_suppkey:12(int!null) s_nationkey:15(int!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_quantity:25(float!null) l_extendedprice:26(float!null) l_discount:27(float!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null) o_orderkey:46(int!null) o_orderdate:50(date!null)
      │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
      │    │    │    ├── stats: [rows=2450.85648, distinct(1)=1224.06495, null(1)=0, distinct(2)=120, null(2)=0, distinct(12)=1224.40152, null(12)=0, distinct(15)=25, null(15)=0, distinct(21)=1227.57145, null(21)=0, distinct(22)=1224.06495, null(22)=0, distinct(23)=1224.40152, null(23)=0, distinct(25)=50, null(25)=0, distinct(26)=1058.55075, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=1058.77685, null(39)=0, distinct(40)=1058.77685, null(40)=0, distinct(42)=763.514127, null(42)=0, distinct(46)=1227.57145, null(46)=0, distinct(50)=1057.0113, null(50)=0]
      │    │    │    ├── fd: (1)-->(2), (12)-->(15), (39,40)-->(42), (23)==(12,40), (40)==(12,23), (22)==(1,39), (39)==(1,22), (46)-->(50), (21)==(46), (46)==(21), (12)==(23,40), (1)==(22,39)
      │    │    │    ├── scan supplier@s_nk
      │    │    │    │    ├── save-table-name: q9_scan_6
      │    │    │    │    ├── columns: s_suppkey:12(int!null) s_nationkey:15(int!null)
      │    │    │    │    ├── stats: [rows=10000, distinct(12)=9920, null(12)=0, distinct(15)=25, null(15)=0]
      │    │    │    │    │   histogram(12)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49    1
      │    │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │    │    │    │    │   histogram(15)=  0 403 0 384 0 391 0 396 0 406 0 396 0 393 0 399 0 406 0 393 0 383  0 398  0 394  0 414  0 422  0 387  0 435  0 403  0 441  0 357  0 394  0 390  0 421  0 411  0 383
      │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    ├── key: (12)
      │    │    │    │    └── fd: (12)-->(15)
      │    │    │    ├── inner-join (lookup orders)
      │    │    │    │    ├── save-table-name: q9_lookup_join_7
      │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_quantity:25(float!null) l_extendedprice:26(float!null) l_discount:27(float!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null) o_orderkey:46(int!null) o_orderdate:50(date!null)
      │    │    │    │    ├── key columns: [21] = [46]
      │    │    │    │    ├── lookup columns are key
      │    │    │    │    ├── stats: [rows=2431.24963, distinct(1)=1535.73681, null(1)=0, distinct(2)=120, null(2)=0, distinct(21)=1535.87578, null(21)=0, distinct(22)=1535.73681, null(22)=0, distinct(23)=1220.40117, null(23)=0, distinct(25)=50, null(25)=0, distinct(26)=1220.02401, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=1220.40117, null(39)=0, distinct(40)=1220.40117, null(40)=0, distinct(42)=800.087388, null(42)=0, distinct(46)=1535.87578, null(46)=0, distinct(50)=1217.45885, null(50)=0]
      │    │    │    │    ├── fd: (1)-->(2), (39,40)-->(42), (23)==(40), (40)==(23), (22)==(1,39), (39)==(1,22), (46)-->(50), (21)==(46), (46)==(21), (1)==(22,39)
      │    │    │    │    ├── inner-join (lookup lineitem)
      │    │    │    │    │    ├── save-table-name: q9_lookup_join_8
      │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_quantity:25(float!null) l_extendedprice:26(float!null) l_discount:27(float!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │    │    │    │    │    ├── key columns: [21 24] = [21 24]
      │    │    │    │    │    ├── lookup columns are key
      │    │    │    │    │    ├── stats: [rows=2431.24963, distinct(1)=2429.49939, null(1)=0, distinct(2)=120, null(2)=0, distinct(21)=1535.87578, null(21)=0, distinct(22)=2429.49939, null(22)=0, distinct(23)=1536.38686, null(23)=0, distinct(25)=50, null(25)=0, distinct(26)=1535.58313, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=1536.38686, null(39)=0, distinct(40)=1536.38686, null(40)=0, distinct(42)=848.519925, null(42)=0]
      │    │    │    │    │    ├── fd: (1)-->(2), (39,40)-->(42), (23)==(40), (40)==(23), (22)==(1,39), (39)==(1,22), (1)==(22,39)
      │    │    │    │    │    ├── inner-join (lookup lineitem@l_pk_sk)
      │    │    │    │    │    │    ├── save-table-name: q9_lookup_join_9
      │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_linenumber:24(int!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │    │    │    │    │    │    ├── key columns: [39 40] = [22 23]
      │    │    │    │    │    │    ├── stats: [rows=812.918153, distinct(1)=807.978498, null(1)=0, distinct(2)=119.86287, null(2)=0, distinct(21)=812.701919, null(21)=0, distinct(22)=812.918153, null(22)=0, distinct(23)=812.918153, null(23)=0, distinct(24)=7, null(24)=0, distinct(39)=812.918153, null(39)=0, distinct(40)=812.918153, null(40)=0, distinct(42)=556.438238, null(42)=0]
      │    │    │    │    │    │    ├── key: (21,24)
      │    │    │    │    │    │    ├── fd: (1)-->(2), (39,40)-->(42), (1)==(22,39), (39)==(1,22), (21,24)-->(22,23), (22)==(1,39), (23)==(40), (40)==(23)
      │    │    │    │    │    │    ├── inner-join (merge)
      │    │    │    │    │    │    │    ├── save-table-name: q9_merge_join_10
      │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │    │    │    │    │    │    │    ├── left ordering: +1
      │    │    │    │    │    │    │    ├── right ordering: +39
      │    │    │    │    │    │    │    ├── stats: [rows=267682.522, distinct(1)=66618.6736, null(1)=0, distinct(2)=120, null(2)=0, distinct(39)=66618.6736, null(39)=0, distinct(40)=9920, null(40)=0, distinct(42)=1000, null(42)=0]
      │    │    │    │    │    │    │    ├── key: (39,40)
      │    │    │    │    │    │    │    ├── fd: (1)-->(2), (39,40)-->(42), (1)==(39), (39)==(1)
      │    │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    │    ├── save-table-name: q9_select_11
      │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=66666.6667, distinct(1)=66618.6736, null(1)=0, distinct(2)=120, null(2)=0]
      │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    ├── fd: (1)-->(2)
      │    │    │    │    │    │    │    │    ├── ordering: +1
      │    │    │    │    │    │    │    │    ├── scan part
      │    │    │    │    │    │    │    │    │    ├── save-table-name: q9_scan_12
      │    │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null)
      │    │    │    │    │    │    │    │    │    ├── stats: [rows=200000, distinct(1)=199241, null(1)=0, distinct(2)=120, null(2)=0]
      │    │    │    │    │    │    │    │    │    │   histogram(1)=  0  4  988   4   1167   4    918   4    1031   4    909   4    1036   4    1047   4    1192   4    943   4    866    4    945    4    1046    4    923    4    1024    4    1113    4    922    4    997    4    1011    4    940    4    1118    4    984    4    1005    4    1257    4    877    4    871    4    1004    4    1005    4    1054    4    963    4    937    4    1008    4    919    4    1001    4    1024    4    896    4    1139    4    1005    4    952    4    834    4    999    4    1063    4    993    4    894    4    1064    4    1004    4    1019    4    952    4    930    4    876    4    926    4    1144    4    1008    4    1025    4    993    4    1097    4    957    4    1073    4    1036    4    1002    4    934    4    1006    4    984    4    972    4    963    4    1055    4    1042    4    1005    4    1075    4    916    4    992    4    884    4    1014    4    1020    4    1092    4    1107    4    873    4    949    4    1037    4    1045    4    903    4    1019    4    942    4    1009    4    970    4    945    4    888    4    948    4    940    4    1036    4    960    4    1025    4    951    4    957    4    1014    4    1004    4    1058    4    1032    4    1063    4    1017    4    1064    4     936    4     1053    4     945    4     933    4     877    4     1043    4     880    4     928    4     1072    4     967    4     985    4     1064    4     1088    4     1000    4     891    4     931    4     1059    4     998    4     886    4     1047    4     961    4     1065    4     1017    4     894    4     1134    4     931    4     857    4     985    4     1184    4     981    4     1034    4     1122    4     1098    4     980    4     1143    4     912    4     948    4     961    4     1072    4     959    4     956    4     883    4     886    4     969    4     887    4     980    4     1058    4     1026    4     850    4     946    4     932    4     1093    4     1047    4     937    4     968    4     1068    4     1097    4     1055    4     1012    4     1066    4     1014    4     981    4     1051    4     988    4     1027    4     978    4     861    4     999    4     1127    4     1102    4     1134    4     1246    4     1036    4     1162    4     970    4     1162    4     875    4     882    4     1029    4     1051    4     999    4     1063    4     903    4     961    4     1017    4     858    4     935    4     1053    4     1066    4     956    4     1037    4     1075    4     928    4     1011    4     1007    4     1010    4     981    4     1249    4     989    4
      │    │    │    │    │    │    │    │    │    │                <--- 5 ----- 998 ------ 2305 ----- 3162 ------ 4234 ----- 5073 ------ 6153 ------ 7254 ------ 8601 ----- 9507 ----- 10253 ----- 11164 ------ 12263 ----- 13131 ------ 14190 ------ 15405 ----- 16271 ----- 17280 ------ 18316 ----- 19217 ------ 20440 ----- 21425 ------ 22450 ------ 23904 ----- 24676 ----- 25433 ------ 26456 ------ 27481 ------ 28594 ----- 29540 ----- 30435 ------ 31465 ----- 32325 ------ 33342 ------ 34401 ----- 35212 ------ 36472 ------ 37497 ----- 38422 ----- 39095 ----- 40108 ------ 41236 ----- 42238 ----- 43046 ------ 44177 ------ 45200 ------ 46250 ----- 47174 ----- 48055 ----- 48824 ----- 49698 ------ 50966 ------ 51995 ------ 53055 ----- 54057 ------ 55245 ----- 56180 ------ 57326 ------ 58406 ------ 59424 ----- 60313 ------ 61340 ----- 62326 ----- 63288 ----- 64233 ------ 65347 ------ 66438 ------ 67463 ------ 68612 ----- 69464 ----- 70464 ----- 71251 ------ 72292 ------ 73343 ------ 74522 ------ 75727 ----- 76489 ----- 77407 ------ 78489 ------ 79585 ----- 80411 ------ 81460 ----- 82365 ------ 83397 ----- 84356 ----- 85266 ----- 86060 ----- 86976 ----- 87876 ------ 88957 ----- 89897 ------ 90958 ----- 91881 ----- 92816 ------ 93857 ------ 94879 ------ 95998 ------ 97071 ------ 98199 ------ 99245 ------ 100376 ----- 101270 ------ 102380 ----- 103290 ----- 104177 ----- 104949 ------ 106042 ----- 106819 ----- 107696 ------ 108841 ----- 109794 ----- 110781 ------ 111912 ------ 113085 ------ 114100 ----- 114901 ----- 115784 ------ 116905 ----- 117916 ----- 118707 ------ 119807 ----- 120748 ------ 121880 ------ 122926 ----- 123733 ------ 124984 ----- 125868 ----- 126594 ----- 127581 ------ 128915 ----- 129894 ------ 130971 ------ 132201 ------ 133390 ----- 134367 ------ 135633 ----- 136477 ----- 137393 ----- 138335 ------ 139479 ----- 140417 ----- 141350 ----- 142133 ----- 142924 ----- 143881 ----- 144673 ----- 145651 ------ 146771 ------ 147833 ----- 148543 ----- 149455 ----- 150320 ------ 151485 ------ 152569 ----- 153443 ----- 154379 ------ 155500 ------ 156673 ------ 157772 ------ 158792 ------ 159911 ------ 160934 ----- 161896 ------ 162988 ----- 163962 ------ 165009 ----- 165964 ----- 166674 ----- 167669 ------ 168893 ------ 170074 ------ 171310 ------ 172734 ------ 173799 ------ 175083 ----- 176024 ------ 177308 ----- 178050 ----- 178807 ------ 179859 ------ 180951 ----- 181946 ------ 183058 ----- 183863 ----- 184786 ------ 185816 ----- 186519 ----- 187389 ------ 188484 ------ 189602 ----- 190515 ------ 191581 ------ 192716 ----- 193573 ------ 194591 ------ 195602 ------ 196619 ----- 197581 ------ 199010 ----- 199986
      │    │    │    │    │    │    │    │    │    │   histogram(2)=  0                   1520                    1.968e+05                   1680
      │    │    │    │    │    │    │    │    │    │                <--- 'almond antique aquamarine azure beige' ----------- 'beige azure aquamarine antique almond'
      │    │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    │    ├── fd: (1)-->(2)
      │    │    │    │    │    │    │    │    │    └── ordering: +1
      │    │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │    │         └── p_name:2 LIKE '%green%' [type=bool, outer=(2), constraints=(/2: (/NULL - ])]
      │    │    │    │    │    │    │    ├── scan partsupp
      │    │    │    │    │    │    │    │    ├── save-table-name: q9_scan_13
      │    │    │    │    │    │    │    │    ├── columns: ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=800000, distinct(39)=199241, null(39)=0, distinct(40)=9920, null(40)=0, distinct(42)=1000, null(42)=0]
      │    │    │    │    │    │    │    │    │   histogram(39)=  0 80  3923   80   3928   80   3938   80   3933   80   3925   80   3914   80   3921   80   3919   80   3914   80   3937   80    3920   80    3928   80    3910   80    3929   80    3948   80    3914   80    3910   80    3927   80    3939   80    3921   80    3917   80    3914   80    3929   80    3920   80    3930   80    3910   80    3908   80    3916   80    3959   80    3914   80    3918   80    3928   80    3917   80    3922   80    3913   80    3956   160   3841   160   3921   80    3906   80    3916   80    3927   80    3931   80    3909   80    3910   80    3913   80    3917   80    3918   80    3909   80    3912   80    3936   80    3914   80    3920   80    3922   80    3920   80    3907   80    3913   80    3933   160   3912   80    3907   80    3921   80    3916   80    3913   80    3919   80    3905   80    3909   80    3911   80    3917   80    3909   80    3907   80    3927   80    3914   80    3921   80    3927   80    3935   80    3910   80    3933   80    3912   80    3918   80    3919   80    3920   80    3918   80    3940   80    3914   80    3906   160   3924   80    3921   80    3971   80    3933   80    3910   80    3923   80    3906   80    3932   80    3905   80    3946   80    3927   80    3934   80    3912   80    3916   80    3914    80    3912    80    3915    80    3907    80    3908    80    3913    80    3915    80    3913    80    3920    80    3920    80    3912    80    3912    80    3908    80    3912    80    3955    80    3910    80    3911    80    3949    80    3907    80    3909    80    3912    80    3920    80    3926    80    3912    80    3926    80    3919    80    3918    80    3911   160    3910    80    3921    80    3908    80    3922    80    3905    80    3904    80    3924    80    3919    80    3929    80    3934    80    3909    80    3910    80    3921    80    3921    80    3908    80    3908    80    3923    80    3924    80    3916    80    3915    80    3925    80    3940    80    3927    80    3937    80    3908    80    3916    80    3919    80    3938    80    4002    80    4016    80    3985    80    3989    80    4006    80    3995    80    4000    80    4002    80    4013    80    3986    80    4005    80    3988    80    3998    80    3993    80    3994    80    4007    80    4007    80    3995    80    4003    80    4003    80    3988    80    4012    80    3985    80    3995    80    3994    80    3988    80    4005    80    3909   160    4018    80    3992    80    3991    80    4010    80    4014    80    3998    80    3999    80    3987    80    4007    80    3989    80    3993    80    3989    80    3993    80    3990    80    3988    80    4013    80    3987    80
      │    │    │    │    │    │    │    │    │                 <--- 4 ------ 1075 ------ 2193 ------ 3395 ------ 4554 ------ 5642 ------ 6598 ------ 7647 ------ 8671 ------ 9629 ------ 10824 ------ 11863 ------ 12983 ------ 13869 ------ 14999 ------ 16276 ------ 17233 ------ 18118 ------ 19228 ------ 20442 ------ 21483 ------ 22478 ------ 23437 ------ 24567 ------ 25601 ------ 26740 ------ 27623 ------ 28466 ------ 29449 ------ 30794 ------ 31739 ------ 32753 ------ 33870 ------ 34865 ------ 35923 ------ 36861 ------ 38210 ------ 39252 ------ 40292 ------ 41082 ------ 42064 ------ 43174 ------ 44318 ------ 45170 ------ 46050 ------ 46986 ------ 47983 ------ 48991 ------ 49860 ------ 50781 ------ 51973 ------ 52921 ------ 53950 ------ 55008 ------ 56036 ------ 56828 ------ 57761 ------ 58943 ------ 59859 ------ 60661 ------ 61709 ------ 62686 ------ 63627 ------ 64644 ------ 65398 ------ 66264 ------ 67171 ------ 68167 ------ 69030 ------ 69846 ------ 70957 ------ 71901 ------ 72947 ------ 74057 ------ 75238 ------ 76120 ------ 77281 ------ 78194 ------ 79205 ------ 80232 ------ 81265 ------ 82271 ------ 83492 ------ 84447 ------ 85223 ------ 86300 ------ 87345 ------ 88757 ------ 89916 ------ 90792 ------ 91861 ------ 92641 ------ 93799 ------ 94551 ------ 95816 ------ 96926 ------ 98099 ------ 99012 ------ 99995 ------ 100942 ------ 101861 ------ 102829 ------ 103627 ------ 104458 ------ 105386 ------ 106347 ------ 107282 ------ 108318 ------ 109347 ------ 110259 ------ 111179 ------ 112020 ------ 112934 ------ 114258 ------ 115141 ------ 116042 ------ 117324 ------ 118118 ------ 118986 ------ 119911 ------ 120948 ------ 122047 ------ 122964 ------ 124063 ------ 125086 ------ 126093 ------ 127009 ------ 127890 ------ 128937 ------ 129774 ------ 130828 ------ 131573 ------ 132266 ------ 133346 ------ 134371 ------ 135496 ------ 136668 ------ 137535 ------ 138422 ------ 139464 ------ 140513 ------ 141339 ------ 142180 ------ 143249 ------ 144332 ------ 145311 ------ 146282 ------ 147367 ------ 148588 ------ 149692 ------ 150886 ------ 151707 ------ 152690 ------ 153715 ------ 154916 ------ 155992 ------ 157204 ------ 157983 ------ 158874 ------ 159994 ------ 160981 ------ 162034 ------ 163111 ------ 164294 ------ 165106 ------ 166214 ------ 167072 ------ 168103 ------ 169058 ------ 170034 ------ 171163 ------ 172290 ------ 173278 ------ 174363 ------ 175448 ------ 176294 ------ 177466 ------ 178235 ------ 179221 ------ 180188 ------ 181055 ------ 182160 ------ 183035 ------ 184258 ------ 185197 ------ 186126 ------ 187288 ------ 188478 ------ 189509 ------ 190552 ------ 191370 ------ 192500 ------ 193385 ------ 194340 ------ 195218 ------ 196178 ------ 197078 ------ 197942 ------ 199128 ------ 199971
      │    │    │    │    │    │    │    │    │   histogram(40)=  0 80  3920  80  3920 160  3840  160  3920  160  3840  160  3840  240  3920  160  3920  160  3840  160  3840  160  3840  240  3920  160  3920  160  3920  160  3840  160  3760  320  3680  320  3840  160  3840  240  3840  160  3920   80   3920  160   3920   80   3840  160   3920  160   3920   80   3920   80   3920  160   3760  240   3840  160   3840  320   3920  160   3920   80   3840  160   3920   80   3920   80   3920  160   3920  160   3920   80   3840  160   3920   80   3920  240   3760  320   3920   80   3920   80   3920   80   3840  240   3760  240   3920  240   3920   80   3920   80   3840  240   3920   80   3920   80   3760  240   3920   80   3920   80   3840  160   3920  160   3840  160   3920   80   3920  240   3920   80   3920   80   3840  160   3920   80   3920   80   3920   80   3760  240   3920  160   3920   80   3840  160   3840  320   3920  160   3840  240   3840  240   3760  320   3840  160   3920   80   3600  400   3920  160   3760  240   3840  160   3920   80   3920  160   3920   80   3920  320   3920  240   3840  160   3920   80   3920   80   3920   80   3920   80   3840  160   3920   80   3920   80   3920   80   3920   80   3760  240   3840  160   3680  320   3760  240   3920   80   3920  320   3760  240   3920   80   3920  160   3920   80   3920   80   3920   80   3840  240   3920   80   3840  160   3920   80   3920   80   3920  240   3760  160   3760  240   3920   80   3760  320   3760  240   3760  160   3680  320   3920   80   3920   80   3920  240   3760  160   3840   80   3920  160   3760  400   3840   80   3840   80   3840   80   3920   80   3840  160   3920   80   3760  240   3840  160   3840  160   3840  160   3840  160   3840  160   3920  400   3840   80   3840  240   3840   80   3840   80   3840   80   3840  160   3840  160   3840   80   3920  320   3760  240   3760  240   3680  320   3760  160   3760  160   3680  320   3840  240   3840  160   3680  240   3840  160   3840  160   3840  160   3760  240   3600  320   3840  160   3920  320   3840   80   3840   80   3600  320   3920  240   3760  160   3840  160   3840  240   3680  240   3840  240   3680  240   3840   80   3920  240   3840  240   3840   80   3840   80   3840   80   3920  160   3840   80   3920   80   3920  160   3680  240   3920  240   3840   80   3840  160   3840   80   3920   80   3760  240   3920   80   3680  320   3840  160   3920   80
      │    │    │    │    │    │    │    │    │                 <--- 4 ------ 45 ------ 99 ------ 142 ------ 195 ------ 240 ------ 294 ------ 345 ------ 397 ------ 450 ------ 495 ------ 548 ------ 594 ------ 645 ------ 701 ------ 749 ------ 795 ------ 856 ------ 902 ------ 946 ------ 991 ------ 1043 ------ 1087 ------ 1142 ------ 1198 ------ 1262 ------ 1309 ------ 1359 ------ 1423 ------ 1469 ------ 1517 ------ 1570 ------ 1623 ------ 1673 ------ 1713 ------ 1764 ------ 1804 ------ 1851 ------ 1890 ------ 1929 ------ 1971 ------ 2020 ------ 2070 ------ 2124 ------ 2170 ------ 2240 ------ 2279 ------ 2330 ------ 2372 ------ 2423 ------ 2486 ------ 2531 ------ 2585 ------ 2633 ------ 2676 ------ 2721 ------ 2778 ------ 2834 ------ 2884 ------ 2945 ------ 2996 ------ 3047 ------ 3095 ------ 3151 ------ 3217 ------ 3260 ------ 3302 ------ 3349 ------ 3404 ------ 3457 ------ 3507 ------ 3559 ------ 3596 ------ 3644 ------ 3690 ------ 3730 ------ 3774 ------ 3817 ------ 3881 ------ 3930 ------ 3989 ------ 4045 ------ 4099 ------ 4153 ------ 4208 ------ 4262 ------ 4317 ------ 4365 ------ 4405 ------ 4452 ------ 4502 ------ 4565 ------ 4613 ------ 4652 ------ 4708 ------ 4773 ------ 4825 ------ 4861 ------ 4913 ------ 4954 ------ 5015 ------ 5061 ------ 5102 ------ 5167 ------ 5217 ------ 5278 ------ 5327 ------ 5382 ------ 5435 ------ 5497 ------ 5537 ------ 5588 ------ 5651 ------ 5705 ------ 5760 ------ 5805 ------ 5845 ------ 5898 ------ 5942 ------ 5984 ------ 6027 ------ 6068 ------ 6121 ------ 6158 ------ 6203 ------ 6257 ------ 6311 ------ 6368 ------ 6421 ------ 6482 ------ 6520 ------ 6565 ------ 6608 ------ 6656 ------ 6713 ------ 6770 ------ 6834 ------ 6882 ------ 6935 ------ 6976 ------ 7026 ------ 7071 ------ 7116 ------ 7170 ------ 7218 ------ 7261 ------ 7298 ------ 7348 ------ 7391 ------ 7440 ------ 7487 ------ 7537 ------ 7581 ------ 7628 ------ 7677 ------ 7724 ------ 7765 ------ 7822 ------ 7861 ------ 7913 ------ 7961 ------ 8012 ------ 8065 ------ 8118 ------ 8181 ------ 8220 ------ 8261 ------ 8314 ------ 8365 ------ 8420 ------ 8475 ------ 8516 ------ 8574 ------ 8619 ------ 8658 ------ 8724 ------ 8771 ------ 8834 ------ 8885 ------ 8938 ------ 8990 ------ 9041 ------ 9102 ------ 9159 ------ 9212 ------ 9281 ------ 9326 ------ 9378 ------ 9424 ------ 9477 ------ 9535 ------ 9577 ------ 9632 ------ 9672 ------ 9731 ------ 9771 ------ 9831 ------ 9876 ------ 9926 ------ 9999
      │    │    │    │    │    │    │    │    │   histogram(42)=  0          800           7.9848e+05  720
      │    │    │    │    │    │    │    │    │                 <--- 0.009999999776482582 ------------ 10.0
      │    │    │    │    │    │    │    │    ├── key: (39,40)
      │    │    │    │    │    │    │    │    ├── fd: (39,40)-->(42)
      │    │    │    │    │    │    │    │    └── ordering: +39
      │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters (true)
      │    │    │    └── filters
      │    │    │         └── s_suppkey:12 = l_suppkey:23 [type=bool, outer=(12,23), constraints=(/12: (/NULL - ]; /23: (/NULL - ]), fd=(12)==(23), (23)==(12)]
      │    │    ├── scan nation
      │    │    │    ├── save-table-name: q9_scan_14
      │    │    │    ├── columns: n_nationkey:57(int!null) n_name:58(char!null)
      │    │    │    ├── stats: [rows=25, distinct(57)=25, null(57)=0, distinct(58)=25, null(58)=0]
      │    │    │    │   histogram(57)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │   histogram(58)=  0      1      23      1
      │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    ├── key: (57)
      │    │    │    └── fd: (57)-->(58)
      │    │    └── filters
      │    │         └── s_nationkey:15 = n_nationkey:57 [type=bool, outer=(15,57), constraints=(/15: (/NULL - ]; /57: (/NULL - ]), fd=(15)==(57), (57)==(15)]
      │    └── projections
      │         ├── extract('year', o_orderdate:50) [as=o_year:63, type=float, outer=(50), immutable]
      │         └── (l_extendedprice:26 * (1.0 - l_discount:27)) - (ps_supplycost:42 * l_quantity:25) [as=amount:64, type=float, outer=(25-27,42), immutable]
      └── aggregations
           └── sum [as=sum:65, type=float, outer=(64)]
                └── amount:64 [type=float]

----Stats for q9_sort_1----
column_names  row_count  distinct_count  null_count
{nation}      175        25              0
{o_year}      175        7               0
{sum_profit}  175        175             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{nation}      1549.00        8.85 <==       25.00               1.00                0.00            1.00
{o_year}      1549.00        8.85 <==       957.00              136.71 <==          0.00            1.00
{sum_profit}  1549.00        8.85 <==       1549.00             8.85 <==            0.00            1.00

----Stats for q9_group_by_2----
column_names  row_count  distinct_count  null_count
{n_name}      175        25              0
{o_year}      175        7               0
{sum}         175        175             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      1549.00        8.85 <==       25.00               1.00                0.00            1.00
{o_year}      1549.00        8.85 <==       957.00              136.71 <==          0.00            1.00
{sum}         1549.00        8.85 <==       1549.00             8.85 <==            0.00            1.00

----Stats for q9_project_3----
column_names  row_count  distinct_count  null_count
{amount}      319404     315234          0
{n_name}      319404     25              0
{o_year}      319404     7               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{amount}      2451.00        130.32 <==     958.00              329.05 <==          0.00            1.00
{n_name}      2451.00        130.32 <==     25.00               1.00                0.00            1.00
{o_year}      2451.00        130.32 <==     957.00              136.71 <==          0.00            1.00

----Stats for q9_inner_join_4----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{n_name}           319404     25              0
{n_nationkey}      319404     25              0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
{s_nationkey}      319404     25              0
{s_suppkey}        319404     9799            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2451.00        130.32 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2451.00        130.32 <==     958.00              221.90 <==          0.00            1.00
{l_orderkey}       2451.00        130.32 <==     1067.00             270.45 <==          0.00            1.00
{l_partkey}        2451.00        130.32 <==     1065.00             9.98 <==            0.00            1.00
{l_quantity}       2451.00        130.32 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2451.00        130.32 <==     1065.00             9.20 <==            0.00            1.00
{n_name}           2451.00        130.32 <==     25.00               1.00                0.00            1.00
{n_nationkey}      2451.00        130.32 <==     25.00               1.00                0.00            1.00
{o_orderdate}      2451.00        130.32 <==     957.00              2.51 <==            0.00            1.00
{o_orderkey}       2451.00        130.32 <==     1067.00             270.45 <==          0.00            1.00
{p_name}           2451.00        130.32 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}        2451.00        130.32 <==     1065.00             9.98 <==            0.00            1.00
{ps_partkey}       2451.00        130.32 <==     958.00              11.10 <==           0.00            1.00
{ps_suppkey}       2451.00        130.32 <==     958.00              10.23 <==           0.00            1.00
{ps_supplycost}    2451.00        130.32 <==     735.00              47.40 <==           0.00            1.00
{s_nationkey}      2451.00        130.32 <==     25.00               1.00                0.00            1.00
{s_suppkey}        2451.00        130.32 <==     1065.00             9.20 <==            0.00            1.00

----Stats for q9_inner_join_5----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
{s_nationkey}      319404     25              0
{s_suppkey}        319404     9799            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2451.00        130.32 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2451.00        130.32 <==     1059.00             200.74 <==          0.00            1.00
{l_orderkey}       2451.00        130.32 <==     1228.00             234.99 <==          0.00            1.00
{l_partkey}        2451.00        130.32 <==     1224.00             8.69 <==            0.00            1.00
{l_quantity}       2451.00        130.32 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2451.00        130.32 <==     1224.00             8.01 <==            0.00            1.00
{o_orderdate}      2451.00        130.32 <==     1057.00             2.28 <==            0.00            1.00
{o_orderkey}       2451.00        130.32 <==     1228.00             234.99 <==          0.00            1.00
{p_name}           2451.00        130.32 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}        2451.00        130.32 <==     1224.00             8.69 <==            0.00            1.00
{ps_partkey}       2451.00        130.32 <==     1059.00             10.04 <==           0.00            1.00
{ps_suppkey}       2451.00        130.32 <==     1059.00             9.25 <==            0.00            1.00
{ps_supplycost}    2451.00        130.32 <==     764.00              45.60 <==           0.00            1.00
{s_nationkey}      2451.00        130.32 <==     25.00               1.00                0.00            1.00
{s_suppkey}        2451.00        130.32 <==     1224.00             8.01 <==            0.00            1.00

----Stats for q9_scan_6----
column_names   row_count  distinct_count  null_count
{s_nationkey}  10000      25              0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00

----Stats for q9_lookup_join_7----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2431.00        131.39 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2431.00        131.39 <==     1220.00             174.25 <==          0.00            1.00
{l_orderkey}       2431.00        131.39 <==     1536.00             187.87 <==          0.00            1.00
{l_partkey}        2431.00        131.39 <==     1536.00             6.92 <==            0.00            1.00
{l_quantity}       2431.00        131.39 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2431.00        131.39 <==     1220.00             8.03 <==            0.00            1.00
{o_orderdate}      2431.00        131.39 <==     1217.00             1.98 <==            0.00            1.00
{o_orderkey}       2431.00        131.39 <==     1536.00             187.87 <==          0.00            1.00
{p_name}           2431.00        131.39 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}        2431.00        131.39 <==     1536.00             6.92 <==            0.00            1.00
{ps_partkey}       2431.00        131.39 <==     1220.00             8.71 <==            0.00            1.00
{ps_suppkey}       2431.00        131.39 <==     1220.00             8.03 <==            0.00            1.00
{ps_supplycost}    2431.00        131.39 <==     800.00              43.55 <==           0.00            1.00

----Stats for q9_lookup_join_8----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2431.00        131.39 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2431.00        131.39 <==     1536.00             138.40 <==          0.00            1.00
{l_orderkey}       2431.00        131.39 <==     1536.00             187.87 <==          0.00            1.00
{l_partkey}        2431.00        131.39 <==     2429.00             4.38 <==            0.00            1.00
{l_quantity}       2431.00        131.39 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2431.00        131.39 <==     1536.00             6.38 <==            0.00            1.00
{p_name}           2431.00        131.39 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}        2431.00        131.39 <==     2429.00             4.38 <==            0.00            1.00
{ps_partkey}       2431.00        131.39 <==     1536.00             6.92 <==            0.00            1.00
{ps_suppkey}       2431.00        131.39 <==     1536.00             6.38 <==            0.00            1.00
{ps_supplycost}    2431.00        131.39 <==     849.00              41.04 <==           0.00            1.00

----Stats for q9_lookup_join_9----
column_names     row_count  distinct_count  null_count
{l_linenumber}   319404     7               0
{l_orderkey}     319404     288573          0
{l_partkey}      319404     10632           0
{l_suppkey}      319404     9799            0
{p_name}         319404     10680           0
{p_partkey}      319404     10632           0
{ps_partkey}     319404     10632           0
{ps_suppkey}     319404     9799            0
{ps_supplycost}  319404     34839           0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}   813.00         392.87 <==     7.00                1.00                0.00            1.00
{l_orderkey}     813.00         392.87 <==     813.00              354.95 <==          0.00            1.00
{l_partkey}      813.00         392.87 <==     813.00              13.08 <==           0.00            1.00
{l_suppkey}      813.00         392.87 <==     813.00              12.05 <==           0.00            1.00
{p_name}         813.00         392.87 <==     120.00              89.00 <==           0.00            1.00
{p_partkey}      813.00         392.87 <==     808.00              13.16 <==           0.00            1.00
{ps_partkey}     813.00         392.87 <==     813.00              13.08 <==           0.00            1.00
{ps_suppkey}     813.00         392.87 <==     813.00              12.05 <==           0.00            1.00
{ps_supplycost}  813.00         392.87 <==     556.00              62.66 <==           0.00            1.00

----Stats for q9_merge_join_10----
column_names     row_count  distinct_count  null_count
{p_name}         42656      10680           0
{p_partkey}      42656      10632           0
{ps_partkey}     42656      10632           0
{ps_suppkey}     42656      9801            0
{ps_supplycost}  42656      34850           0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}         267683.00      6.28 <==       120.00              89.00 <==           0.00            1.00
{p_partkey}      267683.00      6.28 <==       66619.00            6.27 <==            0.00            1.00
{ps_partkey}     267683.00      6.28 <==       66619.00            6.27 <==            0.00            1.00
{ps_suppkey}     267683.00      6.28 <==       9920.00             1.01                0.00            1.00
{ps_supplycost}  267683.00      6.28 <==       1000.00             34.85 <==           0.00            1.00

----Stats for q9_select_11----
column_names  row_count  distinct_count  null_count
{p_name}      10664      10680           0
{p_partkey}   10664      10632           0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}      66667.00       6.25 <==       120.00              89.00 <==           0.00            1.00
{p_partkey}   66667.00       6.25 <==       66619.00            6.27 <==            0.00            1.00

----Stats for q9_scan_12----
column_names  row_count  distinct_count  null_count
{p_name}      200000     198131          0
{p_partkey}   200000     199241          0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}      200000.00      1.00           120.00              1651.09 <==         0.00            1.00
{p_partkey}   200000.00      1.00           199241.00           1.00                0.00            1.00

----Stats for q9_scan_13----
column_names     row_count  distinct_count  null_count
{ps_partkey}     800000     199241          0
{ps_suppkey}     800000     9920            0
{ps_supplycost}  800000     100379          0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_partkey}     800000.00      1.00           199241.00           1.00                0.00            1.00
{ps_suppkey}     800000.00      1.00           9920.00             1.00                0.00            1.00
{ps_supplycost}  800000.00      1.00           1000.00             100.38 <==          0.00            1.00

----Stats for q9_scan_14----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
----
----
