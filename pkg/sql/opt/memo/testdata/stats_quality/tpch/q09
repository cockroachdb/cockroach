import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q9
# Product Type Profit Measure
# Determines how much profit is made on a given line of parts, broken out by
# supplier nation and year.
#
# Finds, for each nation and each year, the profit for all parts ordered in that
# year that contain a specified substring in their names and that were filled by
# a supplier in that nation. The profit is defined as the sum of:
#
#   [(l_extendedprice*(1-l_discount)) - (ps_supplycost * l_quantity)]
#
# for all lineitems describing parts in the specified line. The query lists the
#  nations in ascending alphabetical order and, for each nation, the year and
#  profit in descending order by year (most recent first).
#
# TODO:
#   1. Join ordering
#   2. Push down equivalent column comparisons
# --------------------------------------------------
save-tables database=tpch save-tables-prefix=q9
SELECT
    nation,
    o_year,
    sum(amount) AS sum_profit
FROM (
    SELECT
        n_name AS nation,
        extract(year FROM o_orderdate) AS o_year,
        l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount
    FROM
        part,
        supplier,
        lineitem,
        partsupp,
        orders,
        nation
    WHERE
        s_suppkey = l_suppkey
        AND ps_suppkey = l_suppkey
        AND ps_partkey = l_partkey
        AND p_partkey = l_partkey
        AND o_orderkey = l_orderkey
        AND s_nationkey = n_nationkey
        AND p_name LIKE '%green%'
    ) AS profit
GROUP BY
    nation,
    o_year
ORDER BY
    nation,
    o_year DESC;
----
sort
 ├── save-table-name: q9_sort_1
 ├── columns: nation:48(char!null) o_year:51(float) sum_profit:53(float!null)
 ├── immutable
 ├── stats: [rows=1548.49892, distinct(48)=25, null(48)=0, distinct(51)=957.145308, null(51)=0, distinct(53)=1548.49892, null(53)=0, distinct(48,51)=1548.49892, null(48,51)=0]
 ├── key: (48,51)
 ├── fd: (48,51)-->(53)
 ├── ordering: +48,-51
 └── group-by
      ├── save-table-name: q9_group_by_2
      ├── columns: n_name:48(char!null) o_year:51(float) sum:53(float!null)
      ├── grouping columns: n_name:48(char!null) o_year:51(float)
      ├── immutable
      ├── stats: [rows=1548.49892, distinct(48)=25, null(48)=0, distinct(51)=957.145308, null(51)=0, distinct(53)=1548.49892, null(53)=0, distinct(48,51)=1548.49892, null(48,51)=0]
      ├── key: (48,51)
      ├── fd: (48,51)-->(53)
      ├── project
      │    ├── save-table-name: q9_project_3
      │    ├── columns: o_year:51(float) amount:52(float!null) n_name:48(char!null)
      │    ├── immutable
      │    ├── stats: [rows=2450.41631, distinct(48)=25, null(48)=0, distinct(51)=957.145308, null(51)=0, distinct(52)=958.326364, null(52)=0, distinct(48,51)=1548.49892, null(48,51)=0]
      │    ├── inner-join (lookup part)
      │    │    ├── save-table-name: q9_lookup_join_4
      │    │    ├── columns: p_partkey:1(int!null) p_name:2(varchar!null) s_suppkey:10(int!null) s_nationkey:13(int!null) l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_quantity:21(float!null) l_extendedprice:22(float!null) l_discount:23(float!null) ps_partkey:33(int!null) ps_suppkey:34(int!null) ps_supplycost:36(float!null) o_orderkey:38(int!null) o_orderdate:42(date!null) n_nationkey:47(int!null) n_name:48(char!null)
      │    │    ├── key columns: [18] = [1]
      │    │    ├── lookup columns are key
      │    │    ├── stats: [rows=2450.41631, distinct(1)=1065.01249, null(1)=0, distinct(2)=2405.94672, null(2)=0, distinct(10)=1064.52386, null(10)=0, distinct(13)=25, null(13)=0, distinct(17)=1066.4323, null(17)=0, distinct(18)=1065.01249, null(18)=0, distinct(19)=1064.52386, null(19)=0, distinct(21)=50, null(21)=0, distinct(22)=958.164832, null(22)=0, distinct(23)=11, null(23)=0, distinct(33)=958.326364, null(33)=0, distinct(34)=958.326364, null(34)=0, distinct(36)=956.829183, null(36)=0, distinct(38)=1066.4323, null(38)=0, distinct(42)=957.145308, null(42)=0, distinct(47)=25, null(47)=0, distinct(48)=25, null(48)=0, distinct(42,48)=1548.49892, null(42,48)=0, distinct(21-23,36)=958.326364, null(21-23,36)=0]
      │    │    ├── fd: (1)-->(2), (10)-->(13), (33,34)-->(36), (19)==(10,34), (34)==(10,19), (18)==(1,33), (33)==(1,18), (38)-->(42), (17)==(38), (38)==(17), (10)==(19,34), (47)-->(48), (13)==(47), (47)==(13), (1)==(18,33)
      │    │    ├── inner-join (hash)
      │    │    │    ├── save-table-name: q9_inner_join_5
      │    │    │    ├── columns: s_suppkey:10(int!null) s_nationkey:13(int!null) l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_quantity:21(float!null) l_extendedprice:22(float!null) l_discount:23(float!null) ps_partkey:33(int!null) ps_suppkey:34(int!null) ps_supplycost:36(float!null) o_orderkey:38(int!null) o_orderdate:42(date!null) n_nationkey:47(int!null) n_name:48(char!null)
      │    │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
      │    │    │    ├── stats: [rows=2448.65227, distinct(10)=1233.86749, null(10)=0, distinct(13)=25, null(13)=0, distinct(17)=1237.10502, null(17)=0, distinct(18)=1065.01249, null(18)=0, distinct(19)=1233.86749, null(19)=0, distinct(21)=50, null(21)=0, distinct(22)=1064.77118, null(22)=0, distinct(23)=11, null(23)=0, distinct(33)=1065.01249, null(33)=0, distinct(34)=1065.01249, null(34)=0, distinct(36)=1062.77755, null(36)=0, distinct(38)=1237.10502, null(38)=0, distinct(42)=1063.24915, null(42)=0, distinct(47)=25, null(47)=0, distinct(48)=25, null(48)=0, distinct(42,48)=2448.65227, null(42,48)=0, distinct(21-23,36)=1065.01249, null(21-23,36)=0]
      │    │    │    ├── fd: (10)-->(13), (33,34)-->(36), (19)==(10,34), (34)==(10,19), (18)==(33), (33)==(18), (38)-->(42), (17)==(38), (38)==(17), (10)==(19,34), (47)-->(48), (13)==(47), (47)==(13)
      │    │    │    ├── inner-join (hash)
      │    │    │    │    ├── save-table-name: q9_inner_join_6
      │    │    │    │    ├── columns: s_suppkey:10(int!null) s_nationkey:13(int!null) l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_quantity:21(float!null) l_extendedprice:22(float!null) l_discount:23(float!null) ps_partkey:33(int!null) ps_suppkey:34(int!null) ps_supplycost:36(float!null) o_orderkey:38(int!null) o_orderdate:42(date!null)
      │    │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
      │    │    │    │    ├── stats: [rows=2448.65227, distinct(10)=1535.46099, null(10)=0, distinct(13)=25, null(13)=0, distinct(17)=1542.16708, null(17)=0, distinct(18)=1223.84511, null(18)=0, distinct(19)=1535.46099, null(19)=0, distinct(21)=50, null(21)=0, distinct(22)=1223.44646, null(22)=0, distinct(23)=11, null(23)=0, distinct(33)=1223.84511, null(33)=0, distinct(34)=1223.84511, null(34)=0, distinct(36)=1220.1573, null(36)=0, distinct(38)=1542.16708, null(38)=0, distinct(42)=1220.93463, null(42)=0, distinct(21-23,36)=1223.84511, null(21-23,36)=0]
      │    │    │    │    ├── fd: (10)-->(13), (33,34)-->(36), (19)==(10,34), (34)==(10,19), (18)==(33), (33)==(18), (38)-->(42), (17)==(38), (38)==(17), (10)==(19,34)
      │    │    │    │    ├── scan supplier@s_nk
      │    │    │    │    │    ├── save-table-name: q9_scan_7
      │    │    │    │    │    ├── columns: s_suppkey:10(int!null) s_nationkey:13(int!null)
      │    │    │    │    │    ├── stats: [rows=10000, distinct(10)=9920, null(10)=0, distinct(13)=25, null(13)=0]
      │    │    │    │    │    │   histogram(10)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50    1
      │    │    │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │    │    │    │    │    │   histogram(13)=  0 420 0 413 0 397 0 412 0 415 0 380 0 402 0 396 0 415 0 405 0 393  0 438  0 377  0 362  0 376  0 373  0 406  0 421  0 407  0 398  0 411  0 399  0 401  0 390  0 393
      │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    ├── key: (10)
      │    │    │    │    │    └── fd: (10)-->(13)
      │    │    │    │    ├── inner-join (lookup orders)
      │    │    │    │    │    ├── save-table-name: q9_lookup_join_8
      │    │    │    │    │    ├── columns: l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_quantity:21(float!null) l_extendedprice:22(float!null) l_discount:23(float!null) ps_partkey:33(int!null) ps_suppkey:34(int!null) ps_supplycost:36(float!null) o_orderkey:38(int!null) o_orderdate:42(date!null)
      │    │    │    │    │    ├── key columns: [17] = [38]
      │    │    │    │    │    ├── lookup columns are key
      │    │    │    │    │    ├── stats: [rows=2429.06305, distinct(17)=2427.13263, null(17)=0, distinct(18)=1535.46099, null(18)=0, distinct(19)=1535.46099, null(19)=0, distinct(21)=50, null(21)=0, distinct(22)=1534.61912, null(22)=0, distinct(23)=11, null(23)=0, distinct(33)=1535.46099, null(33)=0, distinct(34)=1535.46099, null(34)=0, distinct(36)=1527.69229, null(36)=0, distinct(38)=2427.13263, null(38)=0, distinct(42)=1529.32625, null(42)=0, distinct(21-23,36)=1535.46099, null(21-23,36)=0]
      │    │    │    │    │    ├── fd: (33,34)-->(36), (19)==(34), (34)==(19), (18)==(33), (33)==(18), (38)-->(42), (17)==(38), (38)==(17)
      │    │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    │    ├── save-table-name: q9_inner_join_9
      │    │    │    │    │    │    ├── columns: l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_quantity:21(float!null) l_extendedprice:22(float!null) l_discount:23(float!null) ps_partkey:33(int!null) ps_suppkey:34(int!null) ps_supplycost:36(float!null)
      │    │    │    │    │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
      │    │    │    │    │    │    ├── stats: [rows=2429.06305, distinct(17)=2427.13263, null(17)=0, distinct(18)=2429.06305, null(18)=0, distinct(19)=2429.06305, null(19)=0, distinct(21)=50, null(21)=0, distinct(22)=2425.87997, null(22)=0, distinct(23)=11, null(23)=0, distinct(33)=2429.06305, null(33)=0, distinct(34)=2429.06305, null(34)=0, distinct(36)=2399.90856, null(36)=0, distinct(21-23,36)=2429.06305, null(21-23,36)=0]
      │    │    │    │    │    │    ├── fd: (33,34)-->(36), (19)==(34), (34)==(19), (18)==(33), (33)==(18)
      │    │    │    │    │    │    ├── scan lineitem
      │    │    │    │    │    │    │    ├── save-table-name: q9_scan_10
      │    │    │    │    │    │    │    ├── columns: l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_quantity:21(float!null) l_extendedprice:22(float!null) l_discount:23(float!null)
      │    │    │    │    │    │    │    └── stats: [rows=6001215, distinct(17)=1527270, null(17)=0, distinct(18)=199241, null(18)=0, distinct(19)=9920, null(19)=0, distinct(21)=50, null(21)=0, distinct(22)=925955, null(22)=0, distinct(23)=11, null(23)=0, distinct(21-23)=6001215, null(21-23)=0]
      │    │    │    │    │    │    │        histogram(17)=  0  600  29405   600   29405   600   29405   600   29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600
      │    │    │    │    │    │    │                      <--- 326 ------- 28929 ------- 50503 ------- 89793 ------- 115938 ------- 146944 ------- 176768 ------- 211201 ------- 237860 ------- 266885 ------- 297604 ------- 330021 ------- 365889 ------- 398951 ------- 426117 ------- 451328 ------- 472134 ------- 499590 ------- 529284 ------- 557254 ------- 589154 ------- 619394 ------- 642951 ------- 670113 ------- 692931 ------- 721157 ------- 751687 ------- 777766 ------- 804582 ------- 836740 ------- 868868 ------- 898912 ------- 922500 ------- 946403 ------- 984870 ------- 1007936 ------- 1030117 ------- 1062275 ------- 1093572 ------- 1120709 ------- 1150981 ------- 1182786 ------- 1206406 ------- 1234116 ------- 1260961 ------- 1290502 ------- 1329510 ------- 1355426 ------- 1381313 ------- 1409796 ------- 1445254 ------- 1479233 ------- 1504935 ------- 1531079 ------- 1559650 ------- 1583616 ------- 1617504 ------- 1655749 ------- 1685185 ------- 1718183 ------- 1747716 ------- 1772131 ------- 1802372 ------- 1833315 ------- 1862403 ------- 1897894 ------- 1922819 ------- 1954405 ------- 1979329 ------- 2009859 ------- 2041670 ------- 2070851 ------- 2093828 ------- 2127973 ------- 2167777 ------- 2194883 ------- 2227814 ------- 2262437 ------- 2296353 ------- 2321024 ------- 2346051 ------- 2376257 ------- 2404932 ------- 2446273 ------- 2474081 ------- 2504515 ------- 2535302 ------- 2561413 ------- 2592737 ------- 2616801 ------- 2646112 ------- 2676546 ------- 2702116 ------- 2732454 ------- 2765382 ------- 2799495 ------- 2828866 ------- 2868737 ------- 2910625 ------- 2938464 ------- 2963140 ------- 3003302 ------- 3043264 ------- 3069123 ------- 3095909 ------- 3126693 ------- 3160485 ------- 3196039 ------- 3229504 ------- 3259712 ------- 3286439 ------- 3318852 ------- 3346821 ------- 3370119 ------- 3395204 ------- 3425888 ------- 3448611 ------- 3476130 ------- 3502372 ------- 3529474 ------- 3556390 ------- 3583553 ------- 3612550 ------- 3647875 ------- 3679140 ------- 3702661 ------- 3738017 ------- 3778050 ------- 3806114 ------- 3839074 ------- 3872805 ------- 3905697 ------- 3926212 ------- 3959841 ------- 3997281 ------- 4033861 ------- 4063591 ------- 4097831 ------- 4124807 ------- 4158656 ------- 4195748 ------- 4234274 ------- 4269952 ------- 4298949 ------- 4332806 ------- 4364705 ------- 4398246 ------- 4430695 ------- 4466403 ------- 4494662 ------- 4524420 ------- 4558561 ------- 4601092 ------- 4632871 ------- 4658694 ------- 4690501 ------- 4728066 ------- 4758657 ------- 4788294 ------- 4818597 ------- 4855874 ------- 4890913 ------- 4915366 ------- 4940709 ------- 4972357 ------- 4995298 ------- 5019523 ------- 5043329 ------- 5077376 ------- 5109920 ------- 5136582 ------- 5161152 ------- 5191846 ------- 5219973 ------- 5251015 ------- 5282021 ------- 5312355 ------- 5343207 ------- 5381318 ------- 5416163 ------- 5445382 ------- 5476933 ------- 5509185 ------- 5539237 ------- 5566818 ------- 5588739 ------- 5620481 ------- 5644001 ------- 5667010 ------- 5689476 ------- 5724709 ------- 5755398 ------- 5790598 ------- 5819425 ------- 5846341 ------- 5874656 ------- 5908067 ------- 5933572 ------- 5962659 ------- 5999971
      │    │    │    │    │    │    │        histogram(18)=  0 600  29405  600  29405  600   29405  600   29405  600   29405  600   29405  1200  29405  600   29405  600   29405  600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405  1200   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   28805  1200   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   28805  1200   29405   600   29405   600   29405   600   29405   600   29405  1200   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600   29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   1200   29405   600    29405   600    29405   600    28805   1200   29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    28805   1200   29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    28805   1200   29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   1200   29405   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600    30006   600
      │    │    │    │    │    │    │                      <--- 29 ------- 959 ------- 1845 ------- 3339 ------- 4395 ------- 5525 ------- 6349 ------- 7298 ------- 8340 ------- 9659 ------- 10756 ------- 11642 ------- 12662 ------- 13609 ------- 14663 ------- 15886 ------- 16905 ------- 17902 ------- 18705 ------- 19722 ------- 20827 ------- 21789 ------- 23026 ------- 24201 ------- 25338 ------- 26224 ------- 27182 ------- 28202 ------- 29058 ------- 29919 ------- 31031 ------- 32058 ------- 33058 ------- 34089 ------- 34972 ------- 35929 ------- 36995 ------- 37901 ------- 38814 ------- 39884 ------- 41044 ------- 42034 ------- 43257 ------- 44224 ------- 45196 ------- 46284 ------- 47373 ------- 48352 ------- 49175 ------- 50212 ------- 51359 ------- 52449 ------- 53225 ------- 54295 ------- 55556 ------- 56736 ------- 57984 ------- 59102 ------- 60117 ------- 61111 ------- 62007 ------- 63054 ------- 63923 ------- 64971 ------- 66018 ------- 67114 ------- 67979 ------- 69163 ------- 70178 ------- 71421 ------- 72412 ------- 73432 ------- 74444 ------- 75421 ------- 76307 ------- 77194 ------- 78249 ------- 79229 ------- 80220 ------- 81103 ------- 81841 ------- 83133 ------- 84398 ------- 85526 ------- 86382 ------- 87333 ------- 88313 ------- 89185 ------- 90240 ------- 91121 ------- 91927 ------- 92840 ------- 93562 ------- 94443 ------- 95372 ------- 96282 ------- 97084 ------- 97969 ------- 99105 ------- 100036 ------- 100911 ------- 101928 ------- 102725 ------- 103625 ------- 104599 ------- 105568 ------- 106366 ------- 107318 ------- 108221 ------- 109084 ------- 110150 ------- 111130 ------- 112290 ------- 113258 ------- 114514 ------- 115361 ------- 116860 ------- 118141 ------- 119083 ------- 120205 ------- 121265 ------- 122280 ------- 123210 ------- 124316 ------- 125393 ------- 126419 ------- 127466 ------- 128467 ------- 129550 ------- 130729 ------- 131956 ------- 133065 ------- 134173 ------- 135106 ------- 136339 ------- 137237 ------- 138221 ------- 139139 ------- 140103 ------- 141250 ------- 142059 ------- 142984 ------- 144048 ------- 145243 ------- 146186 ------- 147153 ------- 148099 ------- 149103 ------- 149945 ------- 150918 ------- 151860 ------- 152830 ------- 153863 ------- 154681 ------- 156041 ------- 156862 ------- 157688 ------- 158743 ------- 159676 ------- 160684 ------- 161325 ------- 162394 ------- 163558 ------- 164576 ------- 165819 ------- 166748 ------- 167734 ------- 168986 ------- 170087 ------- 170931 ------- 171933 ------- 172836 ------- 174038 ------- 175011 ------- 175836 ------- 176680 ------- 177741 ------- 178899 ------- 179745 ------- 180631 ------- 181664 ------- 182624 ------- 183639 ------- 184414 ------- 185145 ------- 186261 ------- 187090 ------- 188033 ------- 189049 ------- 190063 ------- 191040 ------- 192115 ------- 193408 ------- 194360 ------- 195506 ------- 196582 ------- 197367 ------- 198465 ------- 199096 ------- 199970
      │    │    │    │    │    │    │        histogram(19)=  0 600 28805 3000 29405  600  29405  600  29405  600  29405  600  29405 1200  29405 1200  29405 1200  28805 1200  28805 1800  29405  600  29405 1200  29405  600  29405  600  28805 1200  29405 1200  28805 1200  28205 1800  29405 1200  29405  600   29405  1200  29405  1200  29405  600   29405  1200  29405  1200  28805  1800  29405  600   28805  1800  28805  1200  28805  1200  29405  1200  28805  1800  29405  600   28205  1800  29405  600   29405  600   28805  1200  29405  600   28805  1200  29405  600   29405  600   28805  1200  28805  1800  27605  2400  29405  600   28205  1800  29405  2400  29405  600   28805  1800  28205  1800  28805  1200  29405  3000  29405  1200  29405  1800  29405  600   29405  600   28205  1800  29405  600   29405  1800  29405  1800  29405  600   29405  600   28805  1200  28805  1200  29405  1200  28205  1800  29405  600   28805  1200  27605  2400  29405  600   29405  1200  29405  1200  29405  600   29405  1800  29405  1200  28205  1800  29405  600   29405  1200  29405  1200  28805  1200  28205  1800  29405  1800  28805  1200  29405  600   29405  1800  28205  2400  29405  600   28805  1200  28205  2400  28805  1200  27605  2400  28805  1200  29405  600   28805  1800  29405  1800  28805  600   28205  1800  28805  600   29405  600   29405  1200  28805  600   28805  1200  29405  1800  27605  1800  27605  2400  27605  1800  29405  1200  28805  600   28805  1200  29405  1200  28805  2400  28805  1200  28805  600   28205  1200  28205  1200  29405  600   28805  1200  29405  600   28205  2400  28205  1200  29405  600   29405  1800  28805  1200  28205  1200  27605  2400  27605  1800  28805  1200  29405  600   28805  1200  29405  600   29405  600   28805  1200  29405  600   29405  600   29405  600   28805  1200  29405  1200  28805  600   29405  1800  28205  1200  27605  1800  29405  600   29405  600   29405  1200  28805  1200  28805  1200  28205  1200  29405  1800  28205  1800  28805  600   28805  1200  28205  1200  29405  600   28805  1800  28205  1800  27605  2400  28805  600   29405  600   28805  1200  29405  600   28805  2400  28805  1200  28805  1200  28805  600   28205  1200  28805  1200  29405  600   29405  600   29405  1800  28805  600   28805  600   28805  2400  28805  600   28805  1800  28805  1200  28805  600   27005  2400  29405  600   28205  1800  29405  1200  27605  1800  28805  1200  28805  1200  29405  600   29405  600   29405  600   29405  1200  28805  600   29405  600   27605  2400  28805  1200  29405  600   28805  1800  28805  1800  28205  1200  28805  1200  28805  600   29405  1200  28205  1200
      │    │    │    │    │    │    │                      <--- 6 ------- 59 ------- 106 ------- 147 ------- 189 ------- 219 ------- 272 ------- 335 ------- 387 ------- 433 ------- 485 ------- 539 ------- 600 ------- 653 ------- 698 ------- 749 ------- 806 ------- 855 ------- 904 ------- 961 ------- 1008 ------- 1065 ------- 1115 ------- 1163 ------- 1212 ------- 1270 ------- 1329 ------- 1373 ------- 1417 ------- 1470 ------- 1514 ------- 1566 ------- 1616 ------- 1668 ------- 1719 ------- 1765 ------- 1819 ------- 1871 ------- 1926 ------- 1978 ------- 2030 ------- 2080 ------- 2128 ------- 2173 ------- 2223 ------- 2270 ------- 2318 ------- 2382 ------- 2444 ------- 2491 ------- 2534 ------- 2584 ------- 2632 ------- 2675 ------- 2736 ------- 2781 ------- 2841 ------- 2905 ------- 2940 ------- 2996 ------- 3045 ------- 3084 ------- 3124 ------- 3181 ------- 3224 ------- 3268 ------- 3318 ------- 3362 ------- 3419 ------- 3466 ------- 3515 ------- 3560 ------- 3615 ------- 3669 ------- 3725 ------- 3777 ------- 3825 ------- 3871 ------- 3923 ------- 3980 ------- 4035 ------- 4078 ------- 4135 ------- 4184 ------- 4244 ------- 4296 ------- 4346 ------- 4396 ------- 4444 ------- 4489 ------- 4540 ------- 4575 ------- 4627 ------- 4683 ------- 4731 ------- 4777 ------- 4831 ------- 4900 ------- 4953 ------- 5006 ------- 5061 ------- 5119 ------- 5161 ------- 5208 ------- 5260 ------- 5315 ------- 5361 ------- 5415 ------- 5474 ------- 5529 ------- 5572 ------- 5635 ------- 5689 ------- 5738 ------- 5792 ------- 5835 ------- 5890 ------- 5935 ------- 5997 ------- 6039 ------- 6094 ------- 6151 ------- 6201 ------- 6245 ------- 6291 ------- 6343 ------- 6387 ------- 6437 ------- 6480 ------- 6540 ------- 6580 ------- 6629 ------- 6673 ------- 6718 ------- 6771 ------- 6823 ------- 6878 ------- 6935 ------- 6974 ------- 7017 ------- 7060 ------- 7112 ------- 7170 ------- 7231 ------- 7279 ------- 7329 ------- 7373 ------- 7427 ------- 7477 ------- 7520 ------- 7564 ------- 7616 ------- 7671 ------- 7716 ------- 7760 ------- 7815 ------- 7861 ------- 7917 ------- 7969 ------- 8018 ------- 8063 ------- 8112 ------- 8180 ------- 8229 ------- 8268 ------- 8320 ------- 8376 ------- 8432 ------- 8474 ------- 8522 ------- 8569 ------- 8616 ------- 8664 ------- 8705 ------- 8765 ------- 8814 ------- 8868 ------- 8906 ------- 8948 ------- 8990 ------- 9035 ------- 9090 ------- 9137 ------- 9188 ------- 9241 ------- 9292 ------- 9354 ------- 9411 ------- 9472 ------- 9526 ------- 9569 ------- 9613 ------- 9658 ------- 9708 ------- 9737 ------- 9792 ------- 9838 ------- 9903 ------- 9952 ------- 10000
      │    │    │    │    │    │    ├── scan partsupp
      │    │    │    │    │    │    │    ├── save-table-name: q9_scan_11
      │    │    │    │    │    │    │    ├── columns: ps_partkey:33(int!null) ps_suppkey:34(int!null) ps_supplycost:36(float!null)
      │    │    │    │    │    │    │    ├── stats: [rows=800000, distinct(33)=199241, null(33)=0, distinct(34)=9920, null(34)=0, distinct(36)=100379, null(36)=0, distinct(33,34)=798302, null(33,34)=0]
      │    │    │    │    │    │    │    │   histogram(33)=  0 80  3920  80   3920   80   3920   80   3920   80   3840  160   3840  160   3920   80   3920   80   3920   80   3920   80   3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3840   160   3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3840   160   3920   80    3920   80    3920   160   3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    3920   160    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80
      │    │    │    │    │    │    │    │                 <--- 4 ------ 793 ------ 1856 ------ 2808 ------ 3809 ------ 4923 ------ 5975 ------ 6944 ------ 8085 ------ 8945 ------ 9831 ------ 10952 ------ 11932 ------ 12775 ------ 13849 ------ 14925 ------ 16016 ------ 16828 ------ 17768 ------ 18705 ------ 19631 ------ 20600 ------ 21491 ------ 22254 ------ 23327 ------ 24491 ------ 25470 ------ 26331 ------ 27327 ------ 28308 ------ 29359 ------ 30542 ------ 31592 ------ 32495 ------ 33408 ------ 34624 ------ 35726 ------ 36676 ------ 37637 ------ 38485 ------ 39368 ------ 40372 ------ 41034 ------ 42185 ------ 43333 ------ 44466 ------ 45440 ------ 46571 ------ 47469 ------ 48346 ------ 49379 ------ 50571 ------ 51830 ------ 52967 ------ 53673 ------ 54656 ------ 55504 ------ 56539 ------ 57393 ------ 58366 ------ 59577 ------ 60559 ------ 61676 ------ 62471 ------ 63421 ------ 64449 ------ 65409 ------ 66254 ------ 67127 ------ 68127 ------ 69177 ------ 70183 ------ 71209 ------ 72101 ------ 73102 ------ 73994 ------ 74899 ------ 76016 ------ 77098 ------ 77842 ------ 79137 ------ 80242 ------ 81364 ------ 82331 ------ 83158 ------ 84283 ------ 85282 ------ 86437 ------ 87450 ------ 88419 ------ 89493 ------ 90478 ------ 91468 ------ 92552 ------ 93200 ------ 94191 ------ 95067 ------ 96272 ------ 97228 ------ 98126 ------ 99198 ------ 100219 ------ 101057 ------ 102038 ------ 102775 ------ 103711 ------ 104623 ------ 105710 ------ 106734 ------ 107932 ------ 109255 ------ 110220 ------ 111235 ------ 112174 ------ 113260 ------ 114081 ------ 115103 ------ 115864 ------ 116794 ------ 117741 ------ 118712 ------ 119470 ------ 120528 ------ 121572 ------ 122536 ------ 123629 ------ 124404 ------ 125301 ------ 126257 ------ 127139 ------ 128267 ------ 129258 ------ 130442 ------ 131845 ------ 133164 ------ 134005 ------ 135076 ------ 135868 ------ 137297 ------ 138777 ------ 139806 ------ 140741 ------ 141896 ------ 142719 ------ 143727 ------ 144645 ------ 145510 ------ 146507 ------ 147449 ------ 148467 ------ 149635 ------ 150563 ------ 151751 ------ 152613 ------ 153416 ------ 154612 ------ 155853 ------ 156866 ------ 158311 ------ 159230 ------ 160390 ------ 161455 ------ 162555 ------ 163435 ------ 164549 ------ 165663 ------ 166891 ------ 167757 ------ 168732 ------ 169644 ------ 170532 ------ 171671 ------ 172778 ------ 173599 ------ 174321 ------ 175624 ------ 176663 ------ 177632 ------ 178555 ------ 179551 ------ 180510 ------ 181682 ------ 182648 ------ 183408 ------ 184543 ------ 185722 ------ 186713 ------ 187787 ------ 188730 ------ 189604 ------ 190711 ------ 191690 ------ 192692 ------ 193702 ------ 194685 ------ 195725 ------ 196730 ------ 197724 ------ 198701 ------ 199973
      │    │    │    │    │    │    │    │   histogram(34)=  0 80  3920 240  3920  80  3920  160  3920  80   3920  240  3920  80   3760  320  3680  320  3920  80   3920  160  3920  240  3920  80   3920  160  3840  160  3920  80   3920  80   3760  240  3840  160  3920  80   3840  160  3680  320   3920   80   3840  160   3840  160   3760  320   3840  160   3840  160   3920   80   3840  240   3920   80   3920   80   3840  160   3760  240   3920  160   3920   80   3920   80   3920   80   3920  320   3920   80   3920  160   3840  400   3760  240   3920  160   3920  160   3600  480   3920   80   3680  320   3840  160   3840  160   3920  240   3840  160   3920  160   3920   80   3920  160   3920   80   3760  240   3920   80   3920   80   3840  320   3840  160   3840  160   3920  240   3840  480   3920  160   3840  240   3920  160   3920  160   3920   80   3840  160   3920   80   3920   80   3920   80   3920   80   3840  240   3840  240   3920   80   3840  320   3920   80   3920   80   3920  240   3840  240   3920  160   3920   80   3840  160   3840  240   3920  240   3840   80   3680  320   3920  160   3840  160   3840   80   3920   80   3840  160   3840  160   3920   80   3920   80   3840  160   3920   80   3920  160   3840  240   3840   80   3840  160   3760  160   3920   80   3920   80   3840  240   3760  240   3840   80   3920  160   3840   80   3920   80   3920   80   3920   80   3920  160   3840   80   3920   80   3760  240   3920   80   3920  160   3760  160   3920  160   3840   80   3920  160   3840  160   3840  160   3600  320   3920  160   3840   80   3920   80   3680  320   3840  240   3760  160   3920   80   3920   80   3920   80   3920   80   3920   80   3680  320   3920  160   3840  160   3760  160   3920  240   3840  160   3840  240   3600  320   3840   80   3840   80   3920  160   3760  160   3840  160   3840  320   3840   80   3840  160   3760  240   3840   80   3840  240   3760  160   3840  160   3840  160   3920  240   3760  160   3840   80   3920  160   3680  240   3840  160   3840  160   3760  240   3920   80   3920  240   3760  160   3760  240   3840   80   3840  240   3840  240   3760  320   3760  240   3840   80   3840  160   3840  240   3760  320   3760  160   3840  160   3840  160   3840   80   3760  160   3840   80   3840  160   3920  160   3840   80   3920   80   3840  160   3920   80   3840  240   3840   80   3920   80   3760  240   3920  240   3840   80   3680   240
      │    │    │    │    │    │    │    │                 <--- 2 ------ 49 ------ 90 ------ 141 ------ 183 ------ 235 ------ 278 ------ 319 ------ 360 ------ 406 ------ 458 ------ 511 ------ 561 ------ 622 ------ 674 ------ 731 ------ 781 ------ 822 ------ 882 ------ 934 ------ 988 ------ 1026 ------ 1072 ------ 1114 ------ 1188 ------ 1245 ------ 1291 ------ 1335 ------ 1380 ------ 1433 ------ 1488 ------ 1537 ------ 1590 ------ 1642 ------ 1692 ------ 1751 ------ 1807 ------ 1846 ------ 1887 ------ 1939 ------ 1994 ------ 2045 ------ 2097 ------ 2139 ------ 2190 ------ 2240 ------ 2293 ------ 2344 ------ 2385 ------ 2427 ------ 2484 ------ 2538 ------ 2601 ------ 2651 ------ 2730 ------ 2781 ------ 2825 ------ 2874 ------ 2938 ------ 2978 ------ 3034 ------ 3086 ------ 3139 ------ 3179 ------ 3231 ------ 3274 ------ 3334 ------ 3387 ------ 3431 ------ 3477 ------ 3530 ------ 3581 ------ 3633 ------ 3680 ------ 3725 ------ 3775 ------ 3820 ------ 3876 ------ 3923 ------ 3982 ------ 4036 ------ 4078 ------ 4116 ------ 4183 ------ 4227 ------ 4275 ------ 4336 ------ 4376 ------ 4424 ------ 4481 ------ 4537 ------ 4582 ------ 4630 ------ 4680 ------ 4727 ------ 4779 ------ 4828 ------ 4881 ------ 4938 ------ 4986 ------ 5040 ------ 5087 ------ 5138 ------ 5188 ------ 5237 ------ 5280 ------ 5318 ------ 5358 ------ 5405 ------ 5459 ------ 5516 ------ 5561 ------ 5615 ------ 5681 ------ 5744 ------ 5790 ------ 5847 ------ 5885 ------ 5927 ------ 5991 ------ 6042 ------ 6111 ------ 6165 ------ 6207 ------ 6259 ------ 6313 ------ 6359 ------ 6418 ------ 6471 ------ 6530 ------ 6587 ------ 6626 ------ 6672 ------ 6739 ------ 6784 ------ 6837 ------ 6886 ------ 6952 ------ 6994 ------ 7040 ------ 7081 ------ 7134 ------ 7178 ------ 7232 ------ 7280 ------ 7330 ------ 7378 ------ 7435 ------ 7486 ------ 7537 ------ 7593 ------ 7636 ------ 7680 ------ 7737 ------ 7788 ------ 7836 ------ 7877 ------ 7928 ------ 7993 ------ 8036 ------ 8083 ------ 8135 ------ 8180 ------ 8221 ------ 8263 ------ 8313 ------ 8352 ------ 8399 ------ 8453 ------ 8517 ------ 8566 ------ 8612 ------ 8664 ------ 8716 ------ 8766 ------ 8821 ------ 8871 ------ 8922 ------ 8956 ------ 9007 ------ 9050 ------ 9100 ------ 9154 ------ 9203 ------ 9246 ------ 9311 ------ 9358 ------ 9407 ------ 9470 ------ 9525 ------ 9564 ------ 9633 ------ 9672 ------ 9730 ------ 9778 ------ 9824 ------ 9868 ------ 9919 ------ 9959 ------ 10000
      │    │    │    │    │    │    │    ├── key: (33,34)
      │    │    │    │    │    │    │    └── fd: (33,34)-->(36)
      │    │    │    │    │    │    └── filters
      │    │    │    │    │    │         ├── ps_suppkey:34 = l_suppkey:19 [type=bool, outer=(19,34), constraints=(/19: (/NULL - ]; /34: (/NULL - ]), fd=(19)==(34), (34)==(19)]
      │    │    │    │    │    │         └── ps_partkey:33 = l_partkey:18 [type=bool, outer=(18,33), constraints=(/18: (/NULL - ]; /33: (/NULL - ]), fd=(18)==(33), (33)==(18)]
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters
      │    │    │    │         └── s_suppkey:10 = l_suppkey:19 [type=bool, outer=(10,19), constraints=(/10: (/NULL - ]; /19: (/NULL - ]), fd=(10)==(19), (19)==(10)]
      │    │    │    ├── scan nation
      │    │    │    │    ├── save-table-name: q9_scan_12
      │    │    │    │    ├── columns: n_nationkey:47(int!null) n_name:48(char!null)
      │    │    │    │    ├── stats: [rows=25, distinct(47)=25, null(47)=0, distinct(48)=25, null(48)=0]
      │    │    │    │    │   histogram(47)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    ├── key: (47)
      │    │    │    │    └── fd: (47)-->(48)
      │    │    │    └── filters
      │    │    │         └── s_nationkey:13 = n_nationkey:47 [type=bool, outer=(13,47), constraints=(/13: (/NULL - ]; /47: (/NULL - ]), fd=(13)==(47), (47)==(13)]
      │    │    └── filters
      │    │         └── p_name:2 LIKE '%green%' [type=bool, outer=(2), constraints=(/2: (/NULL - ])]
      │    └── projections
      │         ├── extract('year', o_orderdate:42) [as=o_year:51, type=float, outer=(42), immutable]
      │         └── (l_extendedprice:22 * (1.0 - l_discount:23)) - (ps_supplycost:36 * l_quantity:21) [as=amount:52, type=float, outer=(21-23,36), immutable]
      └── aggregations
           └── sum [as=sum:53, type=float, outer=(52)]
                └── amount:52 [type=float]

stats table=q9_sort_1
----
column_names  row_count  distinct_count  null_count
{nation}      175        25              0
{o_year}      175        7               0
{sum_profit}  175        175             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{nation}      1548.00        8.85 <==       25.00               1.00                0.00            1.00
{o_year}      1548.00        8.85 <==       957.00              136.71 <==          0.00            1.00
{sum_profit}  1548.00        8.85 <==       1548.00             8.85 <==            0.00            1.00

stats table=q9_group_by_2
----
column_names  row_count  distinct_count  null_count
{n_name}      175        25              0
{o_year}      175        7               0
{sum}         175        175             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      1548.00        8.85 <==       25.00               1.00                0.00            1.00
{o_year}      1548.00        8.85 <==       957.00              136.71 <==          0.00            1.00
{sum}         1548.00        8.85 <==       1548.00             8.85 <==            0.00            1.00

stats table=q9_project_3
----
column_names  row_count  distinct_count  null_count
{amount}      319404     315234          0
{n_name}      319404     25              0
{o_year}      319404     7               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{amount}      2450.00        130.37 <==     958.00              329.05 <==          0.00            1.00
{n_name}      2450.00        130.37 <==     25.00               1.00                0.00            1.00
{o_year}      2450.00        130.37 <==     957.00              136.71 <==          0.00            1.00

stats table=q9_lookup_join_4
----
column_names       row_count  distinct_count  null_count
{l_discount}       319404     11              0
{l_extendedprice}  319404     212580          0
{l_orderkey}       319404     288573          0
{l_partkey}        319404     10632           0
{l_quantity}       319404     50              0
{l_suppkey}        319404     9799            0
{n_name}           319404     25              0
{n_nationkey}      319404     25              0
{o_orderdate}      319404     2406            0
{o_orderkey}       319404     288573          0
{p_name}           319404     10680           0
{p_partkey}        319404     10632           0
{ps_partkey}       319404     10632           0
{ps_suppkey}       319404     9799            0
{ps_supplycost}    319404     34839           0
{s_nationkey}      319404     25              0
{s_suppkey}        319404     9799            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2450.00        130.37 <==     11.00               1.00                0.00            1.00
{l_extendedprice}  2450.00        130.37 <==     958.00              221.90 <==          0.00            1.00
{l_orderkey}       2450.00        130.37 <==     1066.00             270.71 <==          0.00            1.00
{l_partkey}        2450.00        130.37 <==     1065.00             9.98 <==            0.00            1.00
{l_quantity}       2450.00        130.37 <==     50.00               1.00                0.00            1.00
{l_suppkey}        2450.00        130.37 <==     1065.00             9.20 <==            0.00            1.00
{n_name}           2450.00        130.37 <==     25.00               1.00                0.00            1.00
{n_nationkey}      2450.00        130.37 <==     25.00               1.00                0.00            1.00
{o_orderdate}      2450.00        130.37 <==     957.00              2.51 <==            0.00            1.00
{o_orderkey}       2450.00        130.37 <==     1066.00             270.71 <==          0.00            1.00
{p_name}           2450.00        130.37 <==     2406.00             4.44 <==            0.00            1.00
{p_partkey}        2450.00        130.37 <==     1065.00             9.98 <==            0.00            1.00
{ps_partkey}       2450.00        130.37 <==     958.00              11.10 <==           0.00            1.00
{ps_suppkey}       2450.00        130.37 <==     958.00              10.23 <==           0.00            1.00
{ps_supplycost}    2450.00        130.37 <==     957.00              36.40 <==           0.00            1.00
{s_nationkey}      2450.00        130.37 <==     25.00               1.00                0.00            1.00
{s_suppkey}        2450.00        130.37 <==     1065.00             9.20 <==            0.00            1.00

stats table=q9_inner_join_5
----
column_names       row_count  distinct_count  null_count
{l_discount}       6001215    11              0
{l_extendedprice}  6001215    925955          0
{l_orderkey}       6001215    1527270         0
{l_partkey}        6001215    199241          0
{l_quantity}       6001215    50              0
{l_suppkey}        6001215    9920            0
{n_name}           6001215    25              0
{n_nationkey}      6001215    25              0
{o_orderdate}      6001215    2406            0
{o_orderkey}       6001215    1527270         0
{ps_partkey}       6001215    199241          0
{ps_suppkey}       6001215    9920            0
{ps_supplycost}    6001215    100379          0
{s_nationkey}      6001215    25              0
{s_suppkey}        6001215    9920            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2449.00        2450.48 <==    11.00               1.00                0.00            1.00
{l_extendedprice}  2449.00        2450.48 <==    1065.00             869.44 <==          0.00            1.00
{l_orderkey}       2449.00        2450.48 <==    1237.00             1234.66 <==         0.00            1.00
{l_partkey}        2449.00        2450.48 <==    1065.00             187.08 <==          0.00            1.00
{l_quantity}       2449.00        2450.48 <==    50.00               1.00                0.00            1.00
{l_suppkey}        2449.00        2450.48 <==    1234.00             8.04 <==            0.00            1.00
{n_name}           2449.00        2450.48 <==    25.00               1.00                0.00            1.00
{n_nationkey}      2449.00        2450.48 <==    25.00               1.00                0.00            1.00
{o_orderdate}      2449.00        2450.48 <==    1063.00             2.26 <==            0.00            1.00
{o_orderkey}       2449.00        2450.48 <==    1237.00             1234.66 <==         0.00            1.00
{ps_partkey}       2449.00        2450.48 <==    1065.00             187.08 <==          0.00            1.00
{ps_suppkey}       2449.00        2450.48 <==    1065.00             9.31 <==            0.00            1.00
{ps_supplycost}    2449.00        2450.48 <==    1063.00             94.43 <==           0.00            1.00
{s_nationkey}      2449.00        2450.48 <==    25.00               1.00                0.00            1.00
{s_suppkey}        2449.00        2450.48 <==    1234.00             8.04 <==            0.00            1.00

stats table=q9_inner_join_6
----
column_names       row_count  distinct_count  null_count
{l_discount}       6001215    11              0
{l_extendedprice}  6001215    925955          0
{l_orderkey}       6001215    1527270         0
{l_partkey}        6001215    199241          0
{l_quantity}       6001215    50              0
{l_suppkey}        6001215    9920            0
{o_orderdate}      6001215    2406            0
{o_orderkey}       6001215    1527270         0
{ps_partkey}       6001215    199241          0
{ps_suppkey}       6001215    9920            0
{ps_supplycost}    6001215    100379          0
{s_nationkey}      6001215    25              0
{s_suppkey}        6001215    9920            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2449.00        2450.48 <==    11.00               1.00                0.00            1.00
{l_extendedprice}  2449.00        2450.48 <==    1223.00             757.12 <==          0.00            1.00
{l_orderkey}       2449.00        2450.48 <==    1542.00             990.45 <==          0.00            1.00
{l_partkey}        2449.00        2450.48 <==    1224.00             162.78 <==          0.00            1.00
{l_quantity}       2449.00        2450.48 <==    50.00               1.00                0.00            1.00
{l_suppkey}        2449.00        2450.48 <==    1535.00             6.46 <==            0.00            1.00
{o_orderdate}      2449.00        2450.48 <==    1221.00             1.97 <==            0.00            1.00
{o_orderkey}       2449.00        2450.48 <==    1542.00             990.45 <==          0.00            1.00
{ps_partkey}       2449.00        2450.48 <==    1224.00             162.78 <==          0.00            1.00
{ps_suppkey}       2449.00        2450.48 <==    1224.00             8.10 <==            0.00            1.00
{ps_supplycost}    2449.00        2450.48 <==    1220.00             82.28 <==           0.00            1.00
{s_nationkey}      2449.00        2450.48 <==    25.00               1.00                0.00            1.00
{s_suppkey}        2449.00        2450.48 <==    1535.00             6.46 <==            0.00            1.00

stats table=q9_scan_7
----
column_names   row_count  distinct_count  null_count
{s_nationkey}  10000      25              0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00

stats table=q9_lookup_join_8
----
column_names       row_count  distinct_count  null_count
{l_discount}       6001215    11              0
{l_extendedprice}  6001215    925955          0
{l_orderkey}       6001215    1527270         0
{l_partkey}        6001215    199241          0
{l_quantity}       6001215    50              0
{l_suppkey}        6001215    9920            0
{o_orderdate}      6001215    2406            0
{o_orderkey}       6001215    1527270         0
{ps_partkey}       6001215    199241          0
{ps_suppkey}       6001215    9920            0
{ps_supplycost}    6001215    100379          0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2429.00        2470.65 <==    11.00               1.00                0.00            1.00
{l_extendedprice}  2429.00        2470.65 <==    1535.00             603.23 <==          0.00            1.00
{l_orderkey}       2429.00        2470.65 <==    2427.00             629.28 <==          0.00            1.00
{l_partkey}        2429.00        2470.65 <==    1535.00             129.80 <==          0.00            1.00
{l_quantity}       2429.00        2470.65 <==    50.00               1.00                0.00            1.00
{l_suppkey}        2429.00        2470.65 <==    1535.00             6.46 <==            0.00            1.00
{o_orderdate}      2429.00        2470.65 <==    1529.00             1.57                0.00            1.00
{o_orderkey}       2429.00        2470.65 <==    2427.00             629.28 <==          0.00            1.00
{ps_partkey}       2429.00        2470.65 <==    1535.00             129.80 <==          0.00            1.00
{ps_suppkey}       2429.00        2470.65 <==    1535.00             6.46 <==            0.00            1.00
{ps_supplycost}    2429.00        2470.65 <==    1528.00             65.69 <==           0.00            1.00

stats table=q9_inner_join_9
----
column_names       row_count  distinct_count  null_count
{l_discount}       6001215    11              0
{l_extendedprice}  6001215    925955          0
{l_orderkey}       6001215    1527270         0
{l_partkey}        6001215    199241          0
{l_quantity}       6001215    50              0
{l_suppkey}        6001215    9920            0
{ps_partkey}       6001215    199241          0
{ps_suppkey}       6001215    9920            0
{ps_supplycost}    6001215    100379          0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       2429.00        2470.65 <==    11.00               1.00                0.00            1.00
{l_extendedprice}  2429.00        2470.65 <==    2426.00             381.68 <==          0.00            1.00
{l_orderkey}       2429.00        2470.65 <==    2427.00             629.28 <==          0.00            1.00
{l_partkey}        2429.00        2470.65 <==    2429.00             82.03 <==           0.00            1.00
{l_quantity}       2429.00        2470.65 <==    50.00               1.00                0.00            1.00
{l_suppkey}        2429.00        2470.65 <==    2429.00             4.08 <==            0.00            1.00
{ps_partkey}       2429.00        2470.65 <==    2429.00             82.03 <==           0.00            1.00
{ps_suppkey}       2429.00        2470.65 <==    2429.00             4.08 <==            0.00            1.00
{ps_supplycost}    2429.00        2470.65 <==    2400.00             41.82 <==           0.00            1.00

stats table=q9_scan_10
----
column_names       row_count  distinct_count  null_count
{l_discount}       6001215    11              0
{l_extendedprice}  6001215    925955          0
{l_orderkey}       6001215    1527270         0
{l_partkey}        6001215    199241          0
{l_quantity}       6001215    50              0
{l_suppkey}        6001215    9920            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       6001215.00     1.00           11.00               1.00                0.00            1.00
{l_extendedprice}  6001215.00     1.00           925955.00           1.00                0.00            1.00
{l_orderkey}       6001215.00     1.00           1527270.00          1.00                0.00            1.00
{l_partkey}        6001215.00     1.00           199241.00           1.00                0.00            1.00
{l_quantity}       6001215.00     1.00           50.00               1.00                0.00            1.00
{l_suppkey}        6001215.00     1.00           9920.00             1.00                0.00            1.00

stats table=q9_scan_11
----
column_names     row_count  distinct_count  null_count
{ps_partkey}     800000     199241          0
{ps_suppkey}     800000     9920            0
{ps_supplycost}  800000     100379          0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_partkey}     800000.00      1.00           199241.00           1.00                0.00            1.00
{ps_suppkey}     800000.00      1.00           9920.00             1.00                0.00            1.00
{ps_supplycost}  800000.00      1.00           100379.00           1.00                0.00            1.00

stats table=q9_scan_12
----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
