import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q2
# Minimum Cost Supplier
# Finds which supplier should be selected to place an order for a given part in
# a given region.
#
# Finds, in a given region, for each part of a certain type and size, the
# supplier who can supply it at minimum cost. If several suppliers in that
# region offer the desired part type and size at the same (minimum) cost, the
# query lists the parts from suppliers with the 100 highest account balances.
# For each supplier, the query lists the supplier's account balance, name and
# nation; the part's number and manufacturer; the supplier's address, phone
# number and comment information.
#
# TODO:
#   1. Allow Select to be pushed below Ordinality used to add key column
#   2. Add decorrelation rule for Ordinality/RowKey
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q2
SELECT
    s_acctbal,
    s_name,
    n_name,
    p_partkey,
    p_mfgr,
    s_address,
    s_phone,
    s_comment
FROM
    part,
    supplier,
    partsupp,
    nation,
    region
WHERE
    p_partkey = ps_partkey
    AND s_suppkey = ps_suppkey
    AND p_size = 15
    AND p_type LIKE '%BRASS'
    AND s_nationkey = n_nationkey
    AND n_regionkey = r_regionkey
    AND r_name = 'EUROPE'
    AND ps_supplycost = (
        SELECT
            min(ps_supplycost)
        FROM
            partsupp,
            supplier,
            nation,
            region
        WHERE
            p_partkey = ps_partkey
            AND s_suppkey = ps_suppkey
            AND s_nationkey = n_nationkey
            AND n_regionkey = r_regionkey
            AND r_name = 'EUROPE'
    )
ORDER BY
    s_acctbal DESC,
    n_name,
    s_name,
    p_partkey
LIMIT 100;
----
----
project
 ├── save-table-name: q2_project_1
 ├── columns: s_acctbal:17(float!null) s_name:13(char!null) n_name:29(char!null) p_partkey:1(int!null) p_mfgr:3(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_comment:18(varchar!null)
 ├── cardinality: [0 - 100]
 ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(29)=1, null(29)=0]
 ├── fd: (1)-->(3)
 ├── ordering: -17,+29,+13,+1
 └── limit
      ├── save-table-name: q2_limit_2
      ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      ├── internal-ordering: -17,+29,+13,+(1|21)
      ├── cardinality: [0 - 100]
      ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(21)=0.999912061, null(21)=0, distinct(22)=0.99998212, null(22)=0, distinct(24)=1, null(24)=0, distinct(29)=1, null(29)=0, distinct(66)=1, null(66)=0]
      ├── key: (21,22)
      ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29), (24)==(66), (66)==(24)
      ├── ordering: -17,+29,+13,+(1|21) [actual: -17,+29,+13,+1]
      ├── sort
      │    ├── save-table-name: q2_sort_3
      │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      │    ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(21)=0.999912061, null(21)=0, distinct(22)=0.99998212, null(22)=0, distinct(24)=1, null(24)=0, distinct(29)=1, null(29)=0, distinct(66)=1, null(66)=0]
      │    ├── key: (21,22)
      │    ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29), (24)==(66), (66)==(24)
      │    ├── ordering: -17,+29,+13,+(1|21) [actual: -17,+29,+13,+1]
      │    ├── limit hint: 100.00
      │    └── select
      │         ├── save-table-name: q2_select_4
      │         ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      │         ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(21)=0.999912061, null(21)=0, distinct(22)=0.99998212, null(22)=0, distinct(24)=1, null(24)=0, distinct(29)=1, null(29)=0, distinct(66)=1, null(66)=0]
      │         ├── key: (21,22)
      │         ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29), (24)==(66), (66)==(24)
      │         ├── group-by
      │         │    ├── save-table-name: q2_group_by_5
      │         │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      │         │    ├── grouping columns: ps_partkey:21(int!null) ps_suppkey:22(int!null)
      │         │    ├── stats: [rows=1478.18258, distinct(1)=1478.18258, null(1)=0, distinct(3)=1478.18258, null(3)=0, distinct(13)=1478.18258, null(13)=0, distinct(14)=1478.18258, null(14)=0, distinct(16)=1478.18258, null(16)=0, distinct(17)=1478.18258, null(17)=0, distinct(18)=1478.18258, null(18)=0, distinct(21)=1173.22131, null(21)=0, distinct(22)=1403.98268, null(22)=0, distinct(24)=1478.18258, null(24)=0, distinct(29)=1478.18258, null(29)=0, distinct(66)=1478.18258, null(66)=0, distinct(21,22)=1478.18258, null(21,22)=0]
      │         │    ├── key: (21,22)
      │         │    ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29)
      │         │    ├── inner-join (hash)
      │         │    │    ├── save-table-name: q2_inner_join_6
      │         │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null) s_suppkey:46(int!null) s_nationkey:49(int!null) n_nationkey:55(int!null) n_regionkey:57(int!null) r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │         │    │    ├── stats: [rows=2820.39796, distinct(1)=1334.42745, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=149.99962, null(5)=0, distinct(6)=1, null(6)=0, distinct(12)=1403.98268, null(12)=0, distinct(13)=1404.53617, null(13)=0, distinct(14)=1404.61462, null(14)=0, distinct(15)=5, null(15)=0, distinct(16)=1403.3406, null(16)=0, distinct(17)=1404.61462, null(17)=0, distinct(18)=1403.8471, null(18)=0, distinct(21)=1173.22131, null(21)=0, distinct(22)=1403.98268, null(22)=0, distinct(24)=823.721737, null(24)=0, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0, distinct(39)=1334.42745, null(39)=0, distinct(40)=1444.87549, null(40)=0, distinct(42)=940.418533, null(42)=0, distinct(46)=1444.87549, null(46)=0, distinct(49)=5, null(49)=0, distinct(55)=5, null(55)=0, distinct(57)=1, null(57)=0, distinct(61)=1, null(61)=0, distinct(62)=0.996222107, null(62)=0, distinct(21,22)=1478.18258, null(21,22)=0]
      │         │    │    ├── key: (22,39,46)
      │         │    │    ├── fd: ()-->(6,35,62), (1)-->(3,5), (12)-->(13-18), (21,22)-->(24), (12)==(22), (22)==(12), (28)-->(29,30), (30)==(34), (34)==(30), (15)==(28), (28)==(15), (1)==(21,39), (21)==(1,39), (39,40)-->(42), (46)-->(49), (55)-->(57), (57)==(61), (61)==(57), (49)==(55), (55)==(49), (40)==(46), (46)==(40), (39)==(1,21)
      │         │    │    ├── inner-join (lookup partsupp)
      │         │    │    │    ├── save-table-name: q2_lookup_join_7
      │         │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │         │    │    │    ├── key columns: [1] = [39]
      │         │    │    │    ├── stats: [rows=4456.08456, distinct(1)=1334.42745, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0, distinct(12)=3589.68695, null(12)=0, distinct(13)=3594.92008, null(13)=0, distinct(14)=3595.66255, null(14)=0, distinct(15)=25, null(15)=0, distinct(16)=3583.62827, null(16)=0, distinct(17)=3595.66255, null(17)=0, distinct(18)=3588.40649, null(18)=0, distinct(21)=1334.42745, null(21)=0, distinct(22)=3589.68695, null(22)=0, distinct(24)=988.39241, null(24)=0, distinct(28)=25, null(28)=0, distinct(29)=25, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=1, null(35)=0, distinct(39)=4405.29267, null(39)=0, distinct(40)=3589.68695, null(40)=0, distinct(42)=988.39241, null(42)=0]
      │         │    │    │    ├── key: (22,39,40)
      │         │    │    │    ├── fd: ()-->(6,35), (1)-->(3,5), (28)-->(29,30), (12)-->(13-18), (21,22)-->(24), (39,40)-->(42), (21)==(1,39), (39)==(1,21), (12)==(22), (22)==(12), (15)==(28), (28)==(15), (30)==(34), (34)==(30), (1)==(21,39)
      │         │    │    │    ├── inner-join (hash)
      │         │    │    │    │    ├── save-table-name: q2_inner_join_8
      │         │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │         │    │    │    │    ├── stats: [rows=1933.45126, distinct(1)=1334.42745, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=149.999621, null(5)=0, distinct(6)=1, null(6)=0, distinct(12)=1756.70663, null(12)=0, distinct(13)=1757.86778, null(13)=0, distinct(14)=1758.03241, null(14)=0, distinct(15)=5, null(15)=0, distinct(16)=1755.36068, null(16)=0, distinct(17)=1758.03241, null(17)=0, distinct(18)=1756.42232, null(18)=0, distinct(21)=1334.42745, null(21)=0, distinct(22)=1756.70663, null(22)=0, distinct(24)=855.353138, null(24)=0, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0, distinct(21,22)=1920.22501, null(21,22)=0]
      │         │    │    │    │    ├── key: (21,22)
      │         │    │    │    │    ├── fd: ()-->(6,35), (1)-->(3,5), (12)-->(13-18), (21,22)-->(24), (12)==(22), (22)==(12), (28)-->(29,30), (30)==(34), (34)==(30), (15)==(28), (28)==(15), (1)==(21), (21)==(1)
      │         │    │    │    │    ├── inner-join (lookup partsupp)
      │         │    │    │    │    │    ├── save-table-name: q2_lookup_join_9
      │         │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null)
      │         │    │    │    │    │    ├── key columns: [1] = [21]
      │         │    │    │    │    │    ├── stats: [rows=5358.11181, distinct(1)=1334.42745, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0, distinct(21)=1334.42745, null(21)=0, distinct(22)=4139.90958, null(22)=0, distinct(24)=995.290273, null(24)=0]
      │         │    │    │    │    │    ├── key: (21,22)
      │         │    │    │    │    │    ├── fd: ()-->(6), (1)-->(3,5), (21,22)-->(24), (1)==(21), (21)==(1)
      │         │    │    │    │    │    ├── select
      │         │    │    │    │    │    │    ├── save-table-name: q2_select_10
      │         │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null)
      │         │    │    │    │    │    │    ├── stats: [rows=1334.44444, distinct(1)=1334.42745, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0]
      │         │    │    │    │    │    │    │   histogram(6)=  0 1334.4
      │         │    │    │    │    │    │    │                <---- 15 -
      │         │    │    │    │    │    │    ├── key: (1)
      │         │    │    │    │    │    │    ├── fd: ()-->(6), (1)-->(3,5)
      │         │    │    │    │    │    │    ├── scan part
      │         │    │    │    │    │    │    │    ├── save-table-name: q2_scan_11
      │         │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null)
      │         │    │    │    │    │    │    │    ├── stats: [rows=200000, distinct(1)=199241, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=50, null(6)=0]
      │         │    │    │    │    │    │    │    │   histogram(1)=  0  4  988   4   1167   4    918   4    1031   4    909   4    1036   4    1047   4    1192   4    943   4    866    4    945    4    1046    4    923    4    1024    4    1113    4    922    4    997    4    1011    4    940    4    1118    4    984    4    1005    4    1257    4    877    4    871    4    1004    4    1005    4    1054    4    963    4    937    4    1008    4    919    4    1001    4    1024    4    896    4    1139    4    1005    4    952    4    834    4    999    4    1063    4    993    4    894    4    1064    4    1004    4    1019    4    952    4    930    4    876    4    926    4    1144    4    1008    4    1025    4    993    4    1097    4    957    4    1073    4    1036    4    1002    4    934    4    1006    4    984    4    972    4    963    4    1055    4    1042    4    1005    4    1075    4    916    4    992    4    884    4    1014    4    1020    4    1092    4    1107    4    873    4    949    4    1037    4    1045    4    903    4    1019    4    942    4    1009    4    970    4    945    4    888    4    948    4    940    4    1036    4    960    4    1025    4    951    4    957    4    1014    4    1004    4    1058    4    1032    4    1063    4    1017    4    1064    4     936    4     1053    4     945    4     933    4     877    4     1043    4     880    4     928    4     1072    4     967    4     985    4     1064    4     1088    4     1000    4     891    4     931    4     1059    4     998    4     886    4     1047    4     961    4     1065    4     1017    4     894    4     1134    4     931    4     857    4     985    4     1184    4     981    4     1034    4     1122    4     1098    4     980    4     1143    4     912    4     948    4     961    4     1072    4     959    4     956    4     883    4     886    4     969    4     887    4     980    4     1058    4     1026    4     850    4     946    4     932    4     1093    4     1047    4     937    4     968    4     1068    4     1097    4     1055    4     1012    4     1066    4     1014    4     981    4     1051    4     988    4     1027    4     978    4     861    4     999    4     1127    4     1102    4     1134    4     1246    4     1036    4     1162    4     970    4     1162    4     875    4     882    4     1029    4     1051    4     999    4     1063    4     903    4     961    4     1017    4     858    4     935    4     1053    4     1066    4     956    4     1037    4     1075    4     928    4     1011    4     1007    4     1010    4     981    4     1249    4     989    4
      │         │    │    │    │    │    │    │    │                <--- 5 ----- 998 ------ 2305 ----- 3162 ------ 4234 ----- 5073 ------ 6153 ------ 7254 ------ 8601 ----- 9507 ----- 10253 ----- 11164 ------ 12263 ----- 13131 ------ 14190 ------ 15405 ----- 16271 ----- 17280 ------ 18316 ----- 19217 ------ 20440 ----- 21425 ------ 22450 ------ 23904 ----- 24676 ----- 25433 ------ 26456 ------ 27481 ------ 28594 ----- 29540 ----- 30435 ------ 31465 ----- 32325 ------ 33342 ------ 34401 ----- 35212 ------ 36472 ------ 37497 ----- 38422 ----- 39095 ----- 40108 ------ 41236 ----- 42238 ----- 43046 ------ 44177 ------ 45200 ------ 46250 ----- 47174 ----- 48055 ----- 48824 ----- 49698 ------ 50966 ------ 51995 ------ 53055 ----- 54057 ------ 55245 ----- 56180 ------ 57326 ------ 58406 ------ 59424 ----- 60313 ------ 61340 ----- 62326 ----- 63288 ----- 64233 ------ 65347 ------ 66438 ------ 67463 ------ 68612 ----- 69464 ----- 70464 ----- 71251 ------ 72292 ------ 73343 ------ 74522 ------ 75727 ----- 76489 ----- 77407 ------ 78489 ------ 79585 ----- 80411 ------ 81460 ----- 82365 ------ 83397 ----- 84356 ----- 85266 ----- 86060 ----- 86976 ----- 87876 ------ 88957 ----- 89897 ------ 90958 ----- 91881 ----- 92816 ------ 93857 ------ 94879 ------ 95998 ------ 97071 ------ 98199 ------ 99245 ------ 100376 ----- 101270 ------ 102380 ----- 103290 ----- 104177 ----- 104949 ------ 106042 ----- 106819 ----- 107696 ------ 108841 ----- 109794 ----- 110781 ------ 111912 ------ 113085 ------ 114100 ----- 114901 ----- 115784 ------ 116905 ----- 117916 ----- 118707 ------ 119807 ----- 120748 ------ 121880 ------ 122926 ----- 123733 ------ 124984 ----- 125868 ----- 126594 ----- 127581 ------ 128915 ----- 129894 ------ 130971 ------ 132201 ------ 133390 ----- 134367 ------ 135633 ----- 136477 ----- 137393 ----- 138335 ------ 139479 ----- 140417 ----- 141350 ----- 142133 ----- 142924 ----- 143881 ----- 144673 ----- 145651 ------ 146771 ------ 147833 ----- 148543 ----- 149455 ----- 150320 ------ 151485 ------ 152569 ----- 153443 ----- 154379 ------ 155500 ------ 156673 ------ 157772 ------ 158792 ------ 159911 ------ 160934 ----- 161896 ------ 162988 ----- 163962 ------ 165009 ----- 165964 ----- 166674 ----- 167669 ------ 168893 ------ 170074 ------ 171310 ------ 172734 ------ 173799 ------ 175083 ----- 176024 ------ 177308 ----- 178050 ----- 178807 ------ 179859 ------ 180951 ----- 181946 ------ 183058 ----- 183863 ----- 184786 ------ 185816 ----- 186519 ----- 187389 ------ 188484 ------ 189602 ----- 190515 ------ 191581 ------ 192716 ----- 193573 ------ 194591 ------ 195602 ------ 196619 ----- 197581 ------ 199010 ----- 199986
      │         │    │    │    │    │    │    │    │   histogram(3)=  0       40420        1.2112e+05       38460
      │         │    │    │    │    │    │    │    │                <--- 'Manufacturer#1' ------------ 'Manufacturer#5'
      │         │    │    │    │    │    │    │    │   histogram(5)=  0            1580            1.9726e+05           1160
      │         │    │    │    │    │    │    │    │                <--- 'ECONOMY ANODIZED BRASS' ------------ 'STANDARD POLISHED TIN'
      │         │    │    │    │    │    │    │    │   histogram(6)=  0 4100 1.9216e+05 3740
      │         │    │    │    │    │    │    │    │                <--- 1 ------------- 50
      │         │    │    │    │    │    │    │    ├── key: (1)
      │         │    │    │    │    │    │    │    └── fd: (1)-->(3,5,6)
      │         │    │    │    │    │    │    └── filters
      │         │    │    │    │    │    │         ├── p_size:6 = 15 [type=bool, outer=(6), constraints=(/6: [/15 - /15]; tight), fd=()-->(6)]
      │         │    │    │    │    │    │         └── p_type:5 LIKE '%BRASS' [type=bool, outer=(5), constraints=(/5: (/NULL - ])]
      │         │    │    │    │    │    └── filters (true)
      │         │    │    │    │    ├── inner-join (hash)
      │         │    │    │    │    │    ├── save-table-name: q2_inner_join_12
      │         │    │    │    │    │    ├── columns: s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │         │    │    │    │    │    ├── stats: [rows=2000, distinct(12)=1844.80594, null(12)=0, distinct(13)=1846.09084, null(13)=0, distinct(14)=1846.27302, null(14)=0, distinct(15)=5, null(15)=0, distinct(16)=1843.31663, null(16)=0, distinct(17)=1846.27302, null(17)=0, distinct(18)=1844.49134, null(18)=0, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0]
      │         │    │    │    │    │    ├── key: (12)
      │         │    │    │    │    │    ├── fd: ()-->(35), (12)-->(13-18), (28)-->(29,30), (30)==(34), (34)==(30), (15)==(28), (28)==(15)
      │         │    │    │    │    │    ├── scan supplier
      │         │    │    │    │    │    │    ├── save-table-name: q2_scan_13
      │         │    │    │    │    │    │    ├── columns: s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null)
      │         │    │    │    │    │    │    ├── stats: [rows=10000, distinct(12)=9920, null(12)=0, distinct(13)=9990, null(13)=0, distinct(14)=10000, null(14)=0, distinct(15)=25, null(15)=0, distinct(16)=9840, null(16)=0, distinct(17)=10000, null(17)=0, distinct(18)=9903, null(18)=0]
      │         │    │    │    │    │    │    │   histogram(12)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49    1
      │         │    │    │    │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │         │    │    │    │    │    │    │   histogram(13)=  0           1            9998           1
      │         │    │    │    │    │    │    │                 <--- 'Supplier#000000001' ------ 'Supplier#000010000'
      │         │    │    │    │    │    │    │   histogram(14)=  0                      1                      9998       1
      │         │    │    │    │    │    │    │                 <--- '   7thzdOKLdVP yR7ZbOMnubI6,PrkxBX ZYw1' ------ 'zzvmS9DyfR'
      │         │    │    │    │    │    │    │   histogram(15)=  0 403 0 384 0 391 0 396 0 406 0 396 0 393 0 399 0 406 0 393 0 383  0 398  0 394  0 414  0 422  0 387  0 435  0 403  0 441  0 357  0 394  0 390  0 421  0 411  0 383
      │         │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │         │    │    │    │    │    │    │   histogram(16)=  0          1          9998          1
      │         │    │    │    │    │    │    │                 <--- '10-101-276-5805' ------ '34-997-188-3418'
      │         │    │    │    │    │    │    │   histogram(17)=  0         1          9998        1
      │         │    │    │    │    │    │    │                 <--- -999.72998046875 ------ 9999.509765625
      │         │    │    │    │    │    │    │   histogram(18)=  0                                       1                                       9998                         1
      │         │    │    │    │    │    │    │                 <--- ' A ability south main close despite clearly. Who hold sense everyone. Cou' ------ 'zine know whatever discuss. Realize brother co'
      │         │    │    │    │    │    │    ├── key: (12)
      │         │    │    │    │    │    │    └── fd: (12)-->(13-18)
      │         │    │    │    │    │    ├── inner-join (hash)
      │         │    │    │    │    │    │    ├── save-table-name: q2_inner_join_14
      │         │    │    │    │    │    │    ├── columns: n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │         │    │    │    │    │    │    ├── stats: [rows=5, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0]
      │         │    │    │    │    │    │    ├── key: (28)
      │         │    │    │    │    │    │    ├── fd: ()-->(35), (28)-->(29,30), (30)==(34), (34)==(30)
      │         │    │    │    │    │    │    ├── scan nation
      │         │    │    │    │    │    │    │    ├── save-table-name: q2_scan_15
      │         │    │    │    │    │    │    │    ├── columns: n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null)
      │         │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(28)=25, null(28)=0, distinct(29)=25, null(29)=0, distinct(30)=5, null(30)=0]
      │         │    │    │    │    │    │    │    │   histogram(28)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │         │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │         │    │    │    │    │    │    │    │   histogram(29)=  0      1      23      1
      │         │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │         │    │    │    │    │    │    │    │   histogram(30)=  0  5  0  5  0  5  0  5  0  5
      │         │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    │    ├── key: (28)
      │         │    │    │    │    │    │    │    └── fd: (28)-->(29,30)
      │         │    │    │    │    │    │    ├── select
      │         │    │    │    │    │    │    │    ├── save-table-name: q2_select_16
      │         │    │    │    │    │    │    │    ├── columns: r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    │    │    │    ├── stats: [rows=1, distinct(34)=1, null(34)=0, distinct(35)=1, null(35)=0]
      │         │    │    │    │    │    │    │    │   histogram(35)=  0     1
      │         │    │    │    │    │    │    │    │                 <--- 'EUROPE'
      │         │    │    │    │    │    │    │    ├── key: (34)
      │         │    │    │    │    │    │    │    ├── fd: ()-->(35)
      │         │    │    │    │    │    │    │    ├── scan region
      │         │    │    │    │    │    │    │    │    ├── save-table-name: q2_scan_17
      │         │    │    │    │    │    │    │    │    ├── columns: r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(34)=5, null(34)=0, distinct(35)=5, null(35)=0]
      │         │    │    │    │    │    │    │    │    │   histogram(34)=  0  1  0  1  0  1  0  1  0  1
      │         │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    │    │    │   histogram(35)=  0     1      3        1
      │         │    │    │    │    │    │    │    │    │                 <--- 'AFRICA' --- 'MIDDLE EAST'
      │         │    │    │    │    │    │    │    │    ├── key: (34)
      │         │    │    │    │    │    │    │    │    └── fd: (34)-->(35)
      │         │    │    │    │    │    │    │    └── filters
      │         │    │    │    │    │    │    │         └── r_name:35 = 'EUROPE' [type=bool, outer=(35), constraints=(/35: [/'EUROPE' - /'EUROPE']; tight), fd=()-->(35)]
      │         │    │    │    │    │    │    └── filters
      │         │    │    │    │    │    │         └── n_regionkey:30 = r_regionkey:34 [type=bool, outer=(30,34), constraints=(/30: (/NULL - ]; /34: (/NULL - ]), fd=(30)==(34), (34)==(30)]
      │         │    │    │    │    │    └── filters
      │         │    │    │    │    │         └── s_nationkey:15 = n_nationkey:28 [type=bool, outer=(15,28), constraints=(/15: (/NULL - ]; /28: (/NULL - ]), fd=(15)==(28), (28)==(15)]
      │         │    │    │    │    └── filters
      │         │    │    │    │         └── s_suppkey:12 = ps_suppkey:22 [type=bool, outer=(12,22), constraints=(/12: (/NULL - ]; /22: (/NULL - ]), fd=(12)==(22), (22)==(12)]
      │         │    │    │    └── filters (true)
      │         │    │    ├── inner-join (lookup supplier@s_nk)
      │         │    │    │    ├── save-table-name: q2_lookup_join_18
      │         │    │    │    ├── columns: s_suppkey:46(int!null) s_nationkey:49(int!null) n_nationkey:55(int!null) n_regionkey:57(int!null) r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    │    ├── key columns: [55] = [49]
      │         │    │    │    ├── stats: [rows=2000, distinct(46)=1844.80594, null(46)=0, distinct(49)=5, null(49)=0, distinct(55)=5, null(55)=0, distinct(57)=1, null(57)=0, distinct(61)=1, null(61)=0, distinct(62)=0.996222107, null(62)=0]
      │         │    │    │    ├── key: (46)
      │         │    │    │    ├── fd: ()-->(62), (46)-->(49), (55)-->(57), (57)==(61), (61)==(57), (49)==(55), (55)==(49)
      │         │    │    │    ├── inner-join (lookup nation@n_rk)
      │         │    │    │    │    ├── save-table-name: q2_lookup_join_19
      │         │    │    │    │    ├── columns: n_nationkey:55(int!null) n_regionkey:57(int!null) r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    │    │    ├── key columns: [61] = [57]
      │         │    │    │    │    ├── stats: [rows=5, distinct(55)=5, null(55)=0, distinct(57)=1, null(57)=0, distinct(61)=1, null(61)=0, distinct(62)=0.996222107, null(62)=0]
      │         │    │    │    │    ├── key: (55)
      │         │    │    │    │    ├── fd: ()-->(62), (55)-->(57), (57)==(61), (61)==(57)
      │         │    │    │    │    ├── select
      │         │    │    │    │    │    ├── save-table-name: q2_select_20
      │         │    │    │    │    │    ├── columns: r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    │    │    │    ├── stats: [rows=1, distinct(61)=1, null(61)=0, distinct(62)=1, null(62)=0]
      │         │    │    │    │    │    │   histogram(62)=  0     1
      │         │    │    │    │    │    │                 <--- 'EUROPE'
      │         │    │    │    │    │    ├── key: (61)
      │         │    │    │    │    │    ├── fd: ()-->(62)
      │         │    │    │    │    │    ├── scan region
      │         │    │    │    │    │    │    ├── save-table-name: q2_scan_21
      │         │    │    │    │    │    │    ├── columns: r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    │    │    │    │    ├── stats: [rows=5, distinct(61)=5, null(61)=0, distinct(62)=5, null(62)=0]
      │         │    │    │    │    │    │    │   histogram(61)=  0  1  0  1  0  1  0  1  0  1
      │         │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    │   histogram(62)=  0     1      3        1
      │         │    │    │    │    │    │    │                 <--- 'AFRICA' --- 'MIDDLE EAST'
      │         │    │    │    │    │    │    ├── key: (61)
      │         │    │    │    │    │    │    └── fd: (61)-->(62)
      │         │    │    │    │    │    └── filters
      │         │    │    │    │    │         └── r_name:62 = 'EUROPE' [type=bool, outer=(62), constraints=(/62: [/'EUROPE' - /'EUROPE']; tight), fd=()-->(62)]
      │         │    │    │    │    └── filters (true)
      │         │    │    │    └── filters (true)
      │         │    │    └── filters
      │         │    │         └── s_suppkey:46 = ps_suppkey:40 [type=bool, outer=(40,46), constraints=(/40: (/NULL - ]; /46: (/NULL - ]), fd=(40)==(46), (46)==(40)]
      │         │    └── aggregations
      │         │         ├── min [as=min:66, type=float, outer=(42)]
      │         │         │    └── ps_supplycost:42 [type=float]
      │         │         ├── const-agg [as=s_name:13, type=char, outer=(13)]
      │         │         │    └── s_name:13 [type=char]
      │         │         ├── const-agg [as=s_address:14, type=varchar, outer=(14)]
      │         │         │    └── s_address:14 [type=varchar]
      │         │         ├── const-agg [as=s_phone:16, type=char, outer=(16)]
      │         │         │    └── s_phone:16 [type=char]
      │         │         ├── const-agg [as=s_acctbal:17, type=float, outer=(17)]
      │         │         │    └── s_acctbal:17 [type=float]
      │         │         ├── const-agg [as=s_comment:18, type=varchar, outer=(18)]
      │         │         │    └── s_comment:18 [type=varchar]
      │         │         ├── const-agg [as=ps_supplycost:24, type=float, outer=(24)]
      │         │         │    └── ps_supplycost:24 [type=float]
      │         │         ├── const-agg [as=n_name:29, type=char, outer=(29)]
      │         │         │    └── n_name:29 [type=char]
      │         │         ├── const-agg [as=p_mfgr:3, type=char, outer=(3)]
      │         │         │    └── p_mfgr:3 [type=char]
      │         │         └── const-agg [as=p_partkey:1, type=int, outer=(1)]
      │         │              └── p_partkey:1 [type=int]
      │         └── filters
      │              └── ps_supplycost:24 = min:66 [type=bool, outer=(24,66), constraints=(/24: (/NULL - ]; /66: (/NULL - ]), fd=(24)==(66), (66)==(24)]
      └── 100 [type=int]

----Stats for q2_project_1----
column_names  row_count  distinct_count  null_count
{n_name}      100        5               0
{p_mfgr}      100        5               0
{p_partkey}   100        100             0
{s_acctbal}   100        89              0
{s_address}   100        89              0
{s_comment}   100        89              0
{s_name}      100        89              0
{s_phone}     100        89              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}      1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}   1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

----Stats for q2_limit_2----
column_names     row_count  distinct_count  null_count
{min}            100        100             0
{n_name}         100        5               0
{p_mfgr}         100        5               0
{p_partkey}      100        100             0
{ps_partkey}     100        100             0
{ps_suppkey}     100        89              0
{ps_supplycost}  100        100             0
{s_acctbal}      100        89              0
{s_address}      100        89              0
{s_comment}      100        89              0
{s_name}         100        89              0
{s_phone}        100        89              0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{n_name}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}      1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_partkey}     1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_suppkey}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{ps_supplycost}  1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}         1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}        1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

----Stats for q2_sort_3----
column_names     row_count  distinct_count  null_count
{min}            100        100             0
{n_name}         100        5               0
{p_mfgr}         100        5               0
{p_partkey}      100        100             0
{ps_partkey}     100        100             0
{ps_suppkey}     100        89              0
{ps_supplycost}  100        100             0
{s_acctbal}      100        89              0
{s_address}      100        89              0
{s_comment}      100        89              0
{s_name}         100        89              0
{s_phone}        100        89              0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{n_name}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}      1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_partkey}     1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_suppkey}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{ps_supplycost}  1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}         1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}        1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

----Stats for q2_select_4----
column_names     row_count  distinct_count  null_count
{min}            460        458             0
{n_name}         460        5               0
{p_mfgr}         460        5               0
{p_partkey}      460        460             0
{ps_partkey}     460        460             0
{ps_suppkey}     460        406             0
{ps_supplycost}  460        458             0
{s_acctbal}      460        406             0
{s_address}      460        406             0
{s_comment}      460        406             0
{s_name}         460        406             0
{s_phone}        460        406             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1.00           460.00 <==     1.00                458.00 <==          0.00            1.00
{n_name}         1.00           460.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}         1.00           460.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}      1.00           460.00 <==     1.00                460.00 <==          0.00            1.00
{ps_partkey}     1.00           460.00 <==     1.00                460.00 <==          0.00            1.00
{ps_suppkey}     1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{ps_supplycost}  1.00           460.00 <==     1.00                458.00 <==          0.00            1.00
{s_acctbal}      1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_address}      1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_comment}      1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_name}         1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_phone}        1.00           460.00 <==     1.00                406.00 <==          0.00            1.00

----Stats for q2_group_by_5----
column_names     row_count  distinct_count  null_count
{min}            642        458             0
{n_name}         642        5               0
{p_mfgr}         642        5               0
{p_partkey}      642        460             0
{ps_partkey}     642        460             0
{ps_suppkey}     642        548             0
{ps_supplycost}  642        640             0
{s_acctbal}      642        548             0
{s_address}      642        548             0
{s_comment}      642        548             0
{s_name}         642        548             0
{s_phone}        642        548             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1478.00        2.30 <==       1478.00             3.23 <==            0.00            1.00
{n_name}         1478.00        2.30 <==       1478.00             295.60 <==          0.00            1.00
{p_mfgr}         1478.00        2.30 <==       1478.00             295.60 <==          0.00            1.00
{p_partkey}      1478.00        2.30 <==       1478.00             3.21 <==            0.00            1.00
{ps_partkey}     1478.00        2.30 <==       1173.00             2.55 <==            0.00            1.00
{ps_suppkey}     1478.00        2.30 <==       1404.00             2.56 <==            0.00            1.00
{ps_supplycost}  1478.00        2.30 <==       1478.00             2.31 <==            0.00            1.00
{s_acctbal}      1478.00        2.30 <==       1478.00             2.70 <==            0.00            1.00
{s_address}      1478.00        2.30 <==       1478.00             2.70 <==            0.00            1.00
{s_comment}      1478.00        2.30 <==       1478.00             2.70 <==            0.00            1.00
{s_name}         1478.00        2.30 <==       1478.00             2.70 <==            0.00            1.00
{s_phone}        1478.00        2.30 <==       1478.00             2.70 <==            0.00            1.00

----Stats for q2_inner_join_6----
column_names       row_count  distinct_count  null_count
{n_name}           1070       5               0
{n_nationkey_1}    1070       5               0
{n_nationkey}      1070       5               0
{n_regionkey_1}    1070       1               0
{n_regionkey}      1070       1               0
{p_mfgr}           1070       5               0
{p_partkey}        1070       460             0
{p_size}           1070       1               0
{p_type}           1070       30              0
{ps_partkey_1}     1070       460             0
{ps_partkey}       1070       460             0
{ps_suppkey_1}     1070       548             0
{ps_suppkey}       1070       548             0
{ps_supplycost_1}  1070       640             0
{ps_supplycost}    1070       640             0
{r_name_1}         1070       1               0
{r_name}           1070       1               0
{r_regionkey_1}    1070       1               0
{r_regionkey}      1070       1               0
{s_acctbal}        1070       548             0
{s_address}        1070       548             0
{s_comment}        1070       548             0
{s_name}           1070       548             0
{s_nationkey_1}    1070       5               0
{s_nationkey}      1070       5               0
{s_phone}          1070       548             0
{s_suppkey_1}      1070       548             0
{s_suppkey}        1070       548             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}           2820.00        2.64 <==       5.00                1.00                0.00            1.00
{n_nationkey}      2820.00        2.64 <==       5.00                1.00                0.00            1.00
{n_nationkey_1}    2820.00        2.64 <==       5.00                1.00                0.00            1.00
{n_regionkey}      2820.00        2.64 <==       1.00                1.00                0.00            1.00
{n_regionkey_1}    2820.00        2.64 <==       1.00                1.00                0.00            1.00
{p_mfgr}           2820.00        2.64 <==       5.00                1.00                0.00            1.00
{p_partkey}        2820.00        2.64 <==       1334.00             2.90 <==            0.00            1.00
{p_size}           2820.00        2.64 <==       1.00                1.00                0.00            1.00
{p_type}           2820.00        2.64 <==       150.00              5.00 <==            0.00            1.00
{ps_partkey}       2820.00        2.64 <==       1173.00             2.55 <==            0.00            1.00
{ps_partkey_1}     2820.00        2.64 <==       1334.00             2.90 <==            0.00            1.00
{ps_suppkey}       2820.00        2.64 <==       1404.00             2.56 <==            0.00            1.00
{ps_suppkey_1}     2820.00        2.64 <==       1445.00             2.64 <==            0.00            1.00
{ps_supplycost}    2820.00        2.64 <==       824.00              1.29                0.00            1.00
{ps_supplycost_1}  2820.00        2.64 <==       940.00              1.47                0.00            1.00
{r_name}           2820.00        2.64 <==       1.00                1.00                0.00            1.00
{r_name_1}         2820.00        2.64 <==       1.00                1.00                0.00            1.00
{r_regionkey}      2820.00        2.64 <==       1.00                1.00                0.00            1.00
{r_regionkey_1}    2820.00        2.64 <==       1.00                1.00                0.00            1.00
{s_acctbal}        2820.00        2.64 <==       1405.00             2.56 <==            0.00            1.00
{s_address}        2820.00        2.64 <==       1405.00             2.56 <==            0.00            1.00
{s_comment}        2820.00        2.64 <==       1404.00             2.56 <==            0.00            1.00
{s_name}           2820.00        2.64 <==       1405.00             2.56 <==            0.00            1.00
{s_nationkey}      2820.00        2.64 <==       5.00                1.00                0.00            1.00
{s_nationkey_1}    2820.00        2.64 <==       5.00                1.00                0.00            1.00
{s_phone}          2820.00        2.64 <==       1403.00             2.56 <==            0.00            1.00
{s_suppkey}        2820.00        2.64 <==       1404.00             2.56 <==            0.00            1.00
{s_suppkey_1}      2820.00        2.64 <==       1445.00             2.64 <==            0.00            1.00

----Stats for q2_lookup_join_7----
column_names       row_count  distinct_count  null_count
{n_name}           2568       5               0
{n_nationkey}      2568       5               0
{n_regionkey}      2568       1               0
{p_mfgr}           2568       5               0
{p_partkey}        2568       460             0
{p_size}           2568       1               0
{p_type}           2568       30              0
{ps_partkey_1}     2568       460             0
{ps_partkey}       2568       460             0
{ps_suppkey_1}     2568       1661            0
{ps_suppkey}       2568       548             0
{ps_supplycost_1}  2568       1825            0
{ps_supplycost}    2568       640             0
{r_name}           2568       1               0
{r_regionkey}      2568       1               0
{s_acctbal}        2568       548             0
{s_address}        2568       548             0
{s_comment}        2568       548             0
{s_name}           2568       548             0
{s_nationkey}      2568       5               0
{s_phone}          2568       548             0
{s_suppkey}        2568       548             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}           4456.00        1.74           25.00               5.00 <==            0.00            1.00
{n_nationkey}      4456.00        1.74           25.00               5.00 <==            0.00            1.00
{n_regionkey}      4456.00        1.74           1.00                1.00                0.00            1.00
{p_mfgr}           4456.00        1.74           5.00                1.00                0.00            1.00
{p_partkey}        4456.00        1.74           1334.00             2.90 <==            0.00            1.00
{p_size}           4456.00        1.74           1.00                1.00                0.00            1.00
{p_type}           4456.00        1.74           150.00              5.00 <==            0.00            1.00
{ps_partkey}       4456.00        1.74           1334.00             2.90 <==            0.00            1.00
{ps_partkey_1}     4456.00        1.74           4405.00             9.58 <==            0.00            1.00
{ps_suppkey}       4456.00        1.74           3590.00             6.55 <==            0.00            1.00
{ps_suppkey_1}     4456.00        1.74           3590.00             2.16 <==            0.00            1.00
{ps_supplycost}    4456.00        1.74           988.00              1.54                0.00            1.00
{ps_supplycost_1}  4456.00        1.74           988.00              1.85                0.00            1.00
{r_name}           4456.00        1.74           1.00                1.00                0.00            1.00
{r_regionkey}      4456.00        1.74           1.00                1.00                0.00            1.00
{s_acctbal}        4456.00        1.74           3596.00             6.56 <==            0.00            1.00
{s_address}        4456.00        1.74           3596.00             6.56 <==            0.00            1.00
{s_comment}        4456.00        1.74           3588.00             6.55 <==            0.00            1.00
{s_name}           4456.00        1.74           3595.00             6.56 <==            0.00            1.00
{s_nationkey}      4456.00        1.74           25.00               5.00 <==            0.00            1.00
{s_phone}          4456.00        1.74           3584.00             6.54 <==            0.00            1.00
{s_suppkey}        4456.00        1.74           3590.00             6.55 <==            0.00            1.00

----Stats for q2_inner_join_8----
column_names     row_count  distinct_count  null_count
{n_name}         642        5               0
{n_nationkey}    642        5               0
{n_regionkey}    642        1               0
{p_mfgr}         642        5               0
{p_partkey}      642        460             0
{p_size}         642        1               0
{p_type}         642        30              0
{ps_partkey}     642        460             0
{ps_suppkey}     642        548             0
{ps_supplycost}  642        640             0
{r_name}         642        1               0
{r_regionkey}    642        1               0
{s_acctbal}      642        548             0
{s_address}      642        548             0
{s_comment}      642        548             0
{s_name}         642        548             0
{s_nationkey}    642        5               0
{s_phone}        642        548             0
{s_suppkey}      642        548             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         1933.00        3.01 <==       5.00                1.00                0.00            1.00
{n_nationkey}    1933.00        3.01 <==       5.00                1.00                0.00            1.00
{n_regionkey}    1933.00        3.01 <==       1.00                1.00                0.00            1.00
{p_mfgr}         1933.00        3.01 <==       5.00                1.00                0.00            1.00
{p_partkey}      1933.00        3.01 <==       1334.00             2.90 <==            0.00            1.00
{p_size}         1933.00        3.01 <==       1.00                1.00                0.00            1.00
{p_type}         1933.00        3.01 <==       150.00              5.00 <==            0.00            1.00
{ps_partkey}     1933.00        3.01 <==       1334.00             2.90 <==            0.00            1.00
{ps_suppkey}     1933.00        3.01 <==       1757.00             3.21 <==            0.00            1.00
{ps_supplycost}  1933.00        3.01 <==       855.00              1.34                0.00            1.00
{r_name}         1933.00        3.01 <==       1.00                1.00                0.00            1.00
{r_regionkey}    1933.00        3.01 <==       1.00                1.00                0.00            1.00
{s_acctbal}      1933.00        3.01 <==       1758.00             3.21 <==            0.00            1.00
{s_address}      1933.00        3.01 <==       1758.00             3.21 <==            0.00            1.00
{s_comment}      1933.00        3.01 <==       1756.00             3.20 <==            0.00            1.00
{s_name}         1933.00        3.01 <==       1758.00             3.21 <==            0.00            1.00
{s_nationkey}    1933.00        3.01 <==       5.00                1.00                0.00            1.00
{s_phone}        1933.00        3.01 <==       1755.00             3.20 <==            0.00            1.00
{s_suppkey}      1933.00        3.01 <==       1757.00             3.21 <==            0.00            1.00

----Stats for q2_lookup_join_9----
column_names     row_count  distinct_count  null_count
{p_mfgr}         2988       5               0
{p_partkey}      2988       747             0
{p_size}         2988       1               0
{p_type}         2988       30              0
{ps_partkey}     2988       747             0
{ps_suppkey}     2988       2570            0
{ps_supplycost}  2988       2948            0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_mfgr}         5358.00        1.79           5.00                1.00                0.00            1.00
{p_partkey}      5358.00        1.79           1334.00             1.79                0.00            1.00
{p_size}         5358.00        1.79           1.00                1.00                0.00            1.00
{p_type}         5358.00        1.79           150.00              5.00 <==            0.00            1.00
{ps_partkey}     5358.00        1.79           1334.00             1.79                0.00            1.00
{ps_suppkey}     5358.00        1.79           4140.00             1.61                0.00            1.00
{ps_supplycost}  5358.00        1.79           995.00              2.96 <==            0.00            1.00

----Stats for q2_select_10----
column_names  row_count  distinct_count  null_count
{p_mfgr}      747        5               0
{p_partkey}   747        747             0
{p_size}      747        1               0
{p_type}      747        30              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_mfgr}      1334.00        1.79           5.00                1.00                0.00            1.00
{p_partkey}   1334.00        1.79           1334.00             1.79                0.00            1.00
{p_size}      1334.00        1.79           1.00                1.00                0.00            1.00
{p_type}      1334.00        1.79           150.00              5.00 <==            0.00            1.00

----Stats for q2_scan_11----
column_names  row_count  distinct_count  null_count
{p_mfgr}      200000     5               0
{p_partkey}   200000     199241          0
{p_size}      200000     50              0
{p_type}      200000     150             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_mfgr}      200000.00      1.00           5.00                1.00                0.00            1.00
{p_partkey}   200000.00      1.00           199241.00           1.00                0.00            1.00
{p_size}      200000.00      1.00           50.00               1.00                0.00            1.00
{p_type}      200000.00      1.00           150.00              1.00                0.00            1.00

----Stats for q2_inner_join_12----
column_names   row_count  distinct_count  null_count
{n_name}       1987       5               0
{n_nationkey}  1987       5               0
{n_regionkey}  1987       1               0
{r_name}       1987       1               0
{r_regionkey}  1987       1               0
{s_acctbal}    1987       1983            0
{s_address}    1987       1986            0
{s_comment}    1987       1987            0
{s_name}       1987       1987            0
{s_nationkey}  1987       5               0
{s_phone}      1987       1987            0
{s_suppkey}    1987       1987            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       2000.00        1.01           5.00                1.00                0.00            1.00
{n_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{n_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{r_name}       2000.00        1.01           1.00                1.00                0.00            1.00
{r_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{s_acctbal}    2000.00        1.01           1846.00             1.07                0.00            1.00
{s_address}    2000.00        1.01           1846.00             1.08                0.00            1.00
{s_comment}    2000.00        1.01           1844.00             1.08                0.00            1.00
{s_name}       2000.00        1.01           1846.00             1.08                0.00            1.00
{s_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{s_phone}      2000.00        1.01           1843.00             1.08                0.00            1.00
{s_suppkey}    2000.00        1.01           1845.00             1.08                0.00            1.00

----Stats for q2_scan_13----
column_names   row_count  distinct_count  null_count
{s_acctbal}    10000      9967            0
{s_address}    10000      10027           0
{s_comment}    10000      9934            0
{s_name}       10000      9990            0
{s_nationkey}  10000      25              0
{s_phone}      10000      10021           0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_acctbal}    10000.00       1.00           10000.00            1.00                0.00            1.00
{s_address}    10000.00       1.00           10000.00            1.00                0.00            1.00
{s_comment}    10000.00       1.00           9903.00             1.00                0.00            1.00
{s_name}       10000.00       1.00           9990.00             1.00                0.00            1.00
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_phone}      10000.00       1.00           9840.00             1.02                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00

----Stats for q2_inner_join_14----
column_names   row_count  distinct_count  null_count
{n_name}       5          5               0
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       5.00           1.00           5.00                1.00                0.00            1.00
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

----Stats for q2_scan_15----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
{n_regionkey}  25         5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
{n_regionkey}  25.00          1.00           5.00                1.00                0.00            1.00

----Stats for q2_select_16----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

----Stats for q2_scan_17----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00

----Stats for q2_lookup_join_18----
column_names   row_count  distinct_count  null_count
{n_nationkey}  1987       5               0
{n_regionkey}  1987       1               0
{r_name}       1987       1               0
{r_regionkey}  1987       1               0
{s_nationkey}  1987       5               0
{s_suppkey}    1987       1987            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{n_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{r_name}       2000.00        1.01           1.00                1.00                0.00            1.00
{r_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{s_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{s_suppkey}    2000.00        1.01           1845.00             1.08                0.00            1.00

----Stats for q2_lookup_join_19----
column_names   row_count  distinct_count  null_count
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

----Stats for q2_select_20----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

----Stats for q2_scan_21----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00
----
----
