import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q2
# Minimum Cost Supplier
# Finds which supplier should be selected to place an order for a given part in
# a given region.
#
# Finds, in a given region, for each part of a certain type and size, the
# supplier who can supply it at minimum cost. If several suppliers in that
# region offer the desired part type and size at the same (minimum) cost, the
# query lists the parts from suppliers with the 100 highest account balances.
# For each supplier, the query lists the supplier's account balance, name and
# nation; the part's number and manufacturer; the supplier's address, phone
# number and comment information.
#
# TODO:
#   1. Allow Select to be pushed below Ordinality used to add key column
#   2. Add decorrelation rule for Ordinality/RowKey
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q2
SELECT
    s_acctbal,
    s_name,
    n_name,
    p_partkey,
    p_mfgr,
    s_address,
    s_phone,
    s_comment
FROM
    part,
    supplier,
    partsupp,
    nation,
    region
WHERE
    p_partkey = ps_partkey
    AND s_suppkey = ps_suppkey
    AND p_size = 15
    AND p_type LIKE '%BRASS'
    AND s_nationkey = n_nationkey
    AND n_regionkey = r_regionkey
    AND r_name = 'EUROPE'
    AND ps_supplycost = (
        SELECT
            min(ps_supplycost)
        FROM
            partsupp,
            supplier,
            nation,
            region
        WHERE
            p_partkey = ps_partkey
            AND s_suppkey = ps_suppkey
            AND s_nationkey = n_nationkey
            AND n_regionkey = r_regionkey
            AND r_name = 'EUROPE'
    )
ORDER BY
    s_acctbal DESC,
    n_name,
    s_name,
    p_partkey
LIMIT 100;
----
----
project
 ├── save-table-name: q2_project_1
 ├── columns: s_acctbal:17(float!null) s_name:13(char!null) n_name:29(char!null) p_partkey:1(int!null) p_mfgr:3(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_comment:18(varchar!null)
 ├── cardinality: [0 - 100]
 ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(29)=1, null(29)=0]
 ├── fd: (1)-->(3)
 ├── ordering: -17,+29,+13,+1
 └── top-k
      ├── save-table-name: q2_top_k_2
      ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      ├── ordering: -17,+29,+13,+(1|21)
      ├── cardinality: [0 - 100]
      ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(21)=0.999912219, null(21)=0, distinct(22)=0.999982118, null(22)=0, distinct(24)=1, null(24)=0, distinct(29)=1, null(29)=0, distinct(66)=1, null(66)=0]
      ├── key: (21,22)
      ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29), (24)==(66), (66)==(24)
      ├── ordering: -17,+29,+13,+(1|21) [actual: -17,+29,+13,+1]
      ├── select
      │    ├── save-table-name: q2_select_3
      │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      │    ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(21)=0.999912219, null(21)=0, distinct(22)=0.999982118, null(22)=0, distinct(24)=1, null(24)=0, distinct(29)=1, null(29)=0, distinct(66)=1, null(66)=0]
      │    ├── key: (21,22)
      │    ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29), (24)==(66), (66)==(24)
      │    ├── group-by
      │    │    ├── save-table-name: q2_group_by_4
      │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      │    │    ├── grouping columns: ps_partkey:21(int!null) ps_suppkey:22(int!null)
      │    │    ├── stats: [rows=1480.78794, distinct(1)=1480.78794, null(1)=0, distinct(3)=1480.78794, null(3)=0, distinct(13)=1480.78794, null(13)=0, distinct(14)=1480.78794, null(14)=0, distinct(16)=1480.78794, null(16)=0, distinct(17)=1480.78794, null(17)=0, distinct(18)=1480.78794, null(18)=0, distinct(21)=1175.29714, null(21)=0, distinct(22)=1406.32684, null(22)=0, distinct(24)=1480.78794, null(24)=0, distinct(29)=1480.78794, null(29)=0, distinct(66)=1480.78794, null(66)=0, distinct(21,22)=1480.78794, null(21,22)=0]
      │    │    ├── key: (21,22)
      │    │    ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29)
      │    │    ├── inner-join (hash)
      │    │    │    ├── save-table-name: q2_inner_join_5
      │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null) s_suppkey:46(int!null) s_nationkey:49(int!null) n_nationkey:55(int!null) n_regionkey:57(int!null) r_regionkey:61(int!null) r_name:62(char!null)
      │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    │    ├── stats: [rows=2825.38826, distinct(1)=1336.7885, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=149.999629, null(5)=0, distinct(6)=1, null(6)=0, distinct(12)=1406.32684, null(12)=0, distinct(13)=1406.88226, null(13)=0, distinct(14)=1406.96098, null(14)=0, distinct(15)=5, null(15)=0, distinct(16)=1406.96098, null(16)=0, distinct(17)=1406.70062, null(17)=0, distinct(18)=1406.43854, null(18)=0, distinct(21)=1175.29714, null(21)=0, distinct(22)=1406.32684, null(22)=0, distinct(24)=1476.57814, null(24)=0, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0, distinct(39)=1336.7885, null(39)=0, distinct(40)=1445.95586, null(40)=0, distinct(42)=2776.24326, null(42)=0, distinct(46)=1445.95586, null(46)=0, distinct(49)=5, null(49)=0, distinct(55)=5, null(55)=0, distinct(57)=1, null(57)=0, distinct(61)=1, null(61)=0, distinct(62)=0.996222107, null(62)=0, distinct(21,22)=1480.78794, null(21,22)=0]
      │    │    │    ├── key: (22,39,46)
      │    │    │    ├── fd: ()-->(6,35,62), (1)-->(3,5), (12)-->(13-18), (21,22)-->(24), (12)==(22), (22)==(12), (28)-->(29,30), (30)==(34), (34)==(30), (15)==(28), (28)==(15), (1)==(21,39), (21)==(1,39), (39,40)-->(42), (46)-->(49), (55)-->(57), (57)==(61), (61)==(57), (49)==(55), (55)==(49), (40)==(46), (46)==(40), (39)==(1,21)
      │    │    │    ├── inner-join (lookup partsupp)
      │    │    │    │    ├── save-table-name: q2_lookup_join_6
      │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │    │    │    │    ├── key columns: [1] = [39]
      │    │    │    │    ├── stats: [rows=4463.96897, distinct(1)=1336.7885, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0, distinct(12)=3594.71629, null(12)=0, distinct(13)=3599.9653, null(13)=0, distinct(14)=3600.71001, null(14)=0, distinct(15)=25, null(15)=0, distinct(16)=3600.71001, null(16)=0, distinct(17)=3598.24759, null(17)=0, distinct(18)=3595.77116, null(18)=0, distinct(21)=1336.7885, null(21)=0, distinct(22)=3594.71629, null(22)=0, distinct(24)=4366.10413, null(24)=0, distinct(28)=25, null(28)=0, distinct(29)=25, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=1, null(35)=0, distinct(39)=4412.99786, null(39)=0, distinct(40)=3594.71629, null(40)=0, distinct(42)=4366.10413, null(42)=0]
      │    │    │    │    ├── key: (22,39,40)
      │    │    │    │    ├── fd: ()-->(6,35), (1)-->(3,5), (28)-->(29,30), (12)-->(13-18), (21,22)-->(24), (39,40)-->(42), (21)==(1,39), (39)==(1,21), (12)==(22), (22)==(12), (15)==(28), (28)==(15), (30)==(34), (34)==(30), (1)==(21,39)
      │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    ├── save-table-name: q2_inner_join_7
      │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null)
      │    │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    │    │    │    ├── stats: [rows=1936.87223, distinct(1)=1336.7885, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=149.99963, null(5)=0, distinct(6)=1, null(6)=0, distinct(12)=1759.52132, null(12)=0, distinct(13)=1760.68631, null(13)=0, distinct(14)=1760.8515, null(14)=0, distinct(15)=5, null(15)=0, distinct(16)=1760.8515, null(16)=0, distinct(17)=1760.30522, null(17)=0, distinct(18)=1759.75555, null(18)=0, distinct(21)=1336.7885, null(21)=0, distinct(22)=1759.52132, null(22)=0, distinct(24)=1913.8755, null(24)=0, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0, distinct(21,22)=1923.59922, null(21,22)=0]
      │    │    │    │    │    ├── key: (21,22)
      │    │    │    │    │    ├── fd: ()-->(6,35), (1)-->(3,5), (12)-->(13-18), (21,22)-->(24), (12)==(22), (22)==(12), (28)-->(29,30), (30)==(34), (34)==(30), (15)==(28), (28)==(15), (1)==(21), (21)==(1)
      │    │    │    │    │    ├── inner-join (lookup partsupp)
      │    │    │    │    │    │    ├── save-table-name: q2_lookup_join_8
      │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null)
      │    │    │    │    │    │    ├── key columns: [1] = [21]
      │    │    │    │    │    │    ├── stats: [rows=5367.59223, distinct(1)=1336.7885, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0, distinct(21)=1336.7885, null(21)=0, distinct(22)=4145.43091, null(22)=0, distinct(24)=5226.61785, null(24)=0]
      │    │    │    │    │    │    ├── key: (21,22)
      │    │    │    │    │    │    ├── fd: ()-->(6), (1)-->(3,5), (21,22)-->(24), (1)==(21), (21)==(1)
      │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    ├── save-table-name: q2_select_9
      │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null)
      │    │    │    │    │    │    │    ├── stats: [rows=1336.80556, distinct(1)=1336.7885, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0]
      │    │    │    │    │    │    │    │   histogram(6)=  0 1336.8
      │    │    │    │    │    │    │    │                <---- 15 -
      │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    ├── fd: ()-->(6), (1)-->(3,5)
      │    │    │    │    │    │    │    ├── scan part
      │    │    │    │    │    │    │    │    ├── save-table-name: q2_scan_10
      │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=200000, distinct(1)=199241, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=50, null(6)=0]
      │    │    │    │    │    │    │    │    │   histogram(1)=  0  20  980  20   980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20
      │    │    │    │    │    │    │    │    │                <--- 11 ----- 728 ----- 1645 ----- 2631 ----- 3709 ----- 4776 ----- 5561 ----- 6561 ----- 7453 ----- 8507 ----- 9391 ----- 10246 ----- 11291 ----- 12247 ----- 13190 ----- 14162 ----- 15360 ----- 16279 ----- 17470 ----- 18268 ----- 19116 ----- 20021 ----- 20910 ----- 21722 ----- 22568 ----- 23525 ----- 24605 ----- 25518 ----- 26552 ----- 27774 ----- 28571 ----- 29469 ----- 30689 ----- 31727 ----- 32646 ----- 33512 ----- 34737 ----- 35503 ----- 36365 ----- 37320 ----- 38146 ----- 39374 ----- 40214 ----- 41258 ----- 42381 ----- 43414 ----- 44505 ----- 45498 ----- 46687 ----- 47357 ----- 48402 ----- 49289 ----- 50503 ----- 51267 ----- 52365 ----- 53360 ----- 54114 ----- 54992 ----- 56028 ----- 56976 ----- 57919 ----- 58684 ----- 59544 ----- 60362 ----- 61372 ----- 62402 ----- 63261 ----- 64284 ----- 65157 ----- 66431 ----- 67649 ----- 68642 ----- 69759 ----- 70717 ----- 71768 ----- 72812 ----- 73928 ----- 75069 ----- 76089 ----- 77188 ----- 78003 ----- 79079 ----- 79895 ----- 80931 ----- 81904 ----- 82866 ----- 83812 ----- 84882 ----- 85743 ----- 86558 ----- 87686 ----- 88864 ----- 89834 ----- 90952 ----- 91855 ----- 92815 ----- 93983 ----- 95122 ----- 96110 ----- 97232 ----- 98327 ----- 99529 ----- 100662 ----- 101582 ----- 102475 ----- 103543 ----- 104588 ----- 105673 ----- 106646 ----- 107885 ----- 108848 ----- 109913 ----- 111053 ----- 111992 ----- 112875 ----- 113729 ----- 114830 ----- 115985 ----- 117017 ----- 118197 ----- 119027 ----- 119897 ----- 120979 ----- 122225 ----- 123339 ----- 124326 ----- 125507 ----- 126742 ----- 127739 ----- 128929 ----- 129766 ----- 130824 ----- 131780 ----- 132832 ----- 133849 ----- 134968 ----- 135887 ----- 136981 ----- 138203 ----- 139167 ----- 140214 ----- 141310 ----- 142333 ----- 143119 ----- 144146 ----- 145323 ----- 146333 ----- 147232 ----- 148140 ----- 148972 ----- 150048 ------ 151418 ------ 152456 ------ 153742 ------ 154633 ------ 155602 ------ 156660 ------ 157544 ------ 158653 ------ 159749 ------ 160523 ------ 161563 ------ 162605 ------ 163645 ------ 164720 ------ 165585 ------ 166792 ------ 167795 ------ 168739 ------ 169589 ------ 170526 ------ 171884 ------ 172894 ------ 173761 ------ 174914 ------ 176104 ------ 177260 ------ 178143 ------ 179073 ------ 179850 ------ 180913 ------ 181781 ------ 182661 ------ 183485 ------ 184505 ------ 185790 ------ 187010 ------ 187993 ------ 188916 ------ 190000 ------ 190931 ------ 192079 ------ 193006 ------ 193932 ------ 195013 ------ 196008 ------ 196799 ------ 197766 ------ 198943 ------ 199965
      │    │    │    │    │    │    │    │    │   histogram(3)=  0       39420        1.2018e+05       40400
      │    │    │    │    │    │    │    │    │                <--- 'Manufacturer#1' ------------ 'Manufacturer#5'
      │    │    │    │    │    │    │    │    │   histogram(5)=  0            1340            1.9764e+05           1020
      │    │    │    │    │    │    │    │    │                <--- 'ECONOMY ANODIZED BRASS' ------------ 'STANDARD POLISHED TIN'
      │    │    │    │    │    │    │    │    │   histogram(6)=  0 3760 1.925e+05 3740
      │    │    │    │    │    │    │    │    │                <--- 1 ------------ 50
      │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    └── fd: (1)-->(3,5,6)
      │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │         ├── p_size:6 = 15 [type=bool, outer=(6), constraints=(/6: [/15 - /15]; tight), fd=()-->(6)]
      │    │    │    │    │    │    │         └── p_type:5 LIKE '%BRASS' [type=bool, outer=(5), constraints=(/5: (/NULL - ])]
      │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    │    ├── save-table-name: q2_inner_join_11
      │    │    │    │    │    │    ├── columns: s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null)
      │    │    │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    │    │    │    │    ├── stats: [rows=2000, distinct(12)=1844.80594, null(12)=0, distinct(13)=1846.09084, null(13)=0, distinct(14)=1846.27302, null(14)=0, distinct(15)=5, null(15)=0, distinct(16)=1846.27302, null(16)=0, distinct(17)=1845.67052, null(17)=0, distinct(18)=1845.06427, null(18)=0, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0]
      │    │    │    │    │    │    ├── key: (12)
      │    │    │    │    │    │    ├── fd: ()-->(35), (12)-->(13-18), (28)-->(29,30), (30)==(34), (34)==(30), (15)==(28), (28)==(15)
      │    │    │    │    │    │    ├── scan supplier
      │    │    │    │    │    │    │    ├── save-table-name: q2_scan_12
      │    │    │    │    │    │    │    ├── columns: s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null)
      │    │    │    │    │    │    │    ├── stats: [rows=10000, distinct(12)=9920, null(12)=0, distinct(13)=9990, null(13)=0, distinct(14)=10000, null(14)=0, distinct(15)=25, null(15)=0, distinct(16)=10000, null(16)=0, distinct(17)=9967, null(17)=0, distinct(18)=9934, null(18)=0]
      │    │    │    │    │    │    │    │   histogram(12)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50    1
      │    │    │    │    │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │    │    │    │    │    │    │    │   histogram(13)=  0           1            9998           1
      │    │    │    │    │    │    │    │                 <--- 'Supplier#000000001' ------ 'Supplier#000010000'
      │    │    │    │    │    │    │    │   histogram(14)=  0                     1                     9998                1
      │    │    │    │    │    │    │    │                 <--- '  9aW1wwnBJJPnCx,nox0MA48Y0zpI1IeVfYZ' ------ 'zzfDhdtZcvmVzA8rNFU,Yctj1zBN'
      │    │    │    │    │    │    │    │   histogram(15)=  0 420 0 413 0 397 0 412 0 415 0 380 0 402 0 396 0 415 0 405 0 393  0 438  0 377  0 362  0 376  0 373  0 406  0 421  0 407  0 398  0 411  0 399  0 401  0 390  0 393
      │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │   histogram(16)=  0          1          9998          1
      │    │    │    │    │    │    │    │                 <--- '10-102-116-6785' ------ '34-998-900-4911'
      │    │    │    │    │    │    │    │   histogram(17)=  0     1     9998     1
      │    │    │    │    │    │    │    │                 <--- -998.22 ------ 9999.72
      │    │    │    │    │    │    │    │   histogram(18)=  0                     1                      9998                                   1
      │    │    │    │    │    │    │    │                 <--- ' about the blithely express foxes. bli' ------ 'zzle furiously. bold accounts haggle furiously ironic excuses. fur'
      │    │    │    │    │    │    │    ├── key: (12)
      │    │    │    │    │    │    │    └── fd: (12)-->(13-18)
      │    │    │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    │    │    ├── save-table-name: q2_inner_join_13
      │    │    │    │    │    │    │    ├── columns: n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null)
      │    │    │    │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0]
      │    │    │    │    │    │    │    ├── key: (28)
      │    │    │    │    │    │    │    ├── fd: ()-->(35), (28)-->(29,30), (30)==(34), (34)==(30)
      │    │    │    │    │    │    │    ├── scan nation
      │    │    │    │    │    │    │    │    ├── save-table-name: q2_scan_14
      │    │    │    │    │    │    │    │    ├── columns: n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(28)=25, null(28)=0, distinct(29)=25, null(29)=0, distinct(30)=5, null(30)=0]
      │    │    │    │    │    │    │    │    │   histogram(28)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │    │   histogram(29)=  0      1      23      1
      │    │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    │    │    │    │   histogram(30)=  0  5  0  5  0  5  0  5  0  5
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    │    ├── key: (28)
      │    │    │    │    │    │    │    │    └── fd: (28)-->(29,30)
      │    │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    │    ├── save-table-name: q2_select_15
      │    │    │    │    │    │    │    │    ├── columns: r_regionkey:34(int!null) r_name:35(char!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=1, distinct(34)=1, null(34)=0, distinct(35)=1, null(35)=0]
      │    │    │    │    │    │    │    │    │   histogram(35)=  0     1
      │    │    │    │    │    │    │    │    │                 <--- 'EUROPE'
      │    │    │    │    │    │    │    │    ├── key: (34)
      │    │    │    │    │    │    │    │    ├── fd: ()-->(35)
      │    │    │    │    │    │    │    │    ├── scan region
      │    │    │    │    │    │    │    │    │    ├── save-table-name: q2_scan_16
      │    │    │    │    │    │    │    │    │    ├── columns: r_regionkey:34(int!null) r_name:35(char!null)
      │    │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(34)=5, null(34)=0, distinct(35)=5, null(35)=0]
      │    │    │    │    │    │    │    │    │    │   histogram(34)=  0  1  0  1  0  1  0  1  0  1
      │    │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    │    │    │   histogram(35)=  0     1      3        1
      │    │    │    │    │    │    │    │    │    │                 <--- 'AFRICA' --- 'MIDDLE EAST'
      │    │    │    │    │    │    │    │    │    ├── key: (34)
      │    │    │    │    │    │    │    │    │    └── fd: (34)-->(35)
      │    │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │    │         └── r_name:35 = 'EUROPE' [type=bool, outer=(35), constraints=(/35: [/'EUROPE' - /'EUROPE']; tight), fd=()-->(35)]
      │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │         └── n_regionkey:30 = r_regionkey:34 [type=bool, outer=(30,34), constraints=(/30: (/NULL - ]; /34: (/NULL - ]), fd=(30)==(34), (34)==(30)]
      │    │    │    │    │    │    └── filters
      │    │    │    │    │    │         └── s_nationkey:15 = n_nationkey:28 [type=bool, outer=(15,28), constraints=(/15: (/NULL - ]; /28: (/NULL - ]), fd=(15)==(28), (28)==(15)]
      │    │    │    │    │    └── filters
      │    │    │    │    │         └── s_suppkey:12 = ps_suppkey:22 [type=bool, outer=(12,22), constraints=(/12: (/NULL - ]; /22: (/NULL - ]), fd=(12)==(22), (22)==(12)]
      │    │    │    │    └── filters (true)
      │    │    │    ├── inner-join (lookup supplier@s_nk)
      │    │    │    │    ├── save-table-name: q2_lookup_join_17
      │    │    │    │    ├── columns: s_suppkey:46(int!null) s_nationkey:49(int!null) n_nationkey:55(int!null) n_regionkey:57(int!null) r_regionkey:61(int!null) r_name:62(char!null)
      │    │    │    │    ├── key columns: [55] = [49]
      │    │    │    │    ├── stats: [rows=2000, distinct(46)=1844.80594, null(46)=0, distinct(49)=5, null(49)=0, distinct(55)=5, null(55)=0, distinct(57)=1, null(57)=0, distinct(61)=1, null(61)=0, distinct(62)=0.996222107, null(62)=0]
      │    │    │    │    ├── key: (46)
      │    │    │    │    ├── fd: ()-->(62), (46)-->(49), (55)-->(57), (57)==(61), (61)==(57), (49)==(55), (55)==(49)
      │    │    │    │    ├── inner-join (lookup nation@n_rk)
      │    │    │    │    │    ├── save-table-name: q2_lookup_join_18
      │    │    │    │    │    ├── columns: n_nationkey:55(int!null) n_regionkey:57(int!null) r_regionkey:61(int!null) r_name:62(char!null)
      │    │    │    │    │    ├── key columns: [61] = [57]
      │    │    │    │    │    ├── stats: [rows=5, distinct(55)=5, null(55)=0, distinct(57)=1, null(57)=0, distinct(61)=1, null(61)=0, distinct(62)=0.996222107, null(62)=0]
      │    │    │    │    │    ├── key: (55)
      │    │    │    │    │    ├── fd: ()-->(62), (55)-->(57), (57)==(61), (61)==(57)
      │    │    │    │    │    ├── select
      │    │    │    │    │    │    ├── save-table-name: q2_select_19
      │    │    │    │    │    │    ├── columns: r_regionkey:61(int!null) r_name:62(char!null)
      │    │    │    │    │    │    ├── stats: [rows=1, distinct(61)=1, null(61)=0, distinct(62)=1, null(62)=0]
      │    │    │    │    │    │    │   histogram(62)=  0     1
      │    │    │    │    │    │    │                 <--- 'EUROPE'
      │    │    │    │    │    │    ├── key: (61)
      │    │    │    │    │    │    ├── fd: ()-->(62)
      │    │    │    │    │    │    ├── scan region
      │    │    │    │    │    │    │    ├── save-table-name: q2_scan_20
      │    │    │    │    │    │    │    ├── columns: r_regionkey:61(int!null) r_name:62(char!null)
      │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(61)=5, null(61)=0, distinct(62)=5, null(62)=0]
      │    │    │    │    │    │    │    │   histogram(61)=  0  1  0  1  0  1  0  1  0  1
      │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    │   histogram(62)=  0     1      3        1
      │    │    │    │    │    │    │    │                 <--- 'AFRICA' --- 'MIDDLE EAST'
      │    │    │    │    │    │    │    ├── key: (61)
      │    │    │    │    │    │    │    └── fd: (61)-->(62)
      │    │    │    │    │    │    └── filters
      │    │    │    │    │    │         └── r_name:62 = 'EUROPE' [type=bool, outer=(62), constraints=(/62: [/'EUROPE' - /'EUROPE']; tight), fd=()-->(62)]
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters (true)
      │    │    │    └── filters
      │    │    │         └── s_suppkey:46 = ps_suppkey:40 [type=bool, outer=(40,46), constraints=(/40: (/NULL - ]; /46: (/NULL - ]), fd=(40)==(46), (46)==(40)]
      │    │    └── aggregations
      │    │         ├── min [as=min:66, type=float, outer=(42)]
      │    │         │    └── ps_supplycost:42 [type=float]
      │    │         ├── const-agg [as=s_name:13, type=char, outer=(13)]
      │    │         │    └── s_name:13 [type=char]
      │    │         ├── const-agg [as=s_address:14, type=varchar, outer=(14)]
      │    │         │    └── s_address:14 [type=varchar]
      │    │         ├── const-agg [as=s_phone:16, type=char, outer=(16)]
      │    │         │    └── s_phone:16 [type=char]
      │    │         ├── const-agg [as=s_acctbal:17, type=float, outer=(17)]
      │    │         │    └── s_acctbal:17 [type=float]
      │    │         ├── const-agg [as=s_comment:18, type=varchar, outer=(18)]
      │    │         │    └── s_comment:18 [type=varchar]
      │    │         ├── const-agg [as=ps_supplycost:24, type=float, outer=(24)]
      │    │         │    └── ps_supplycost:24 [type=float]
      │    │         ├── const-agg [as=n_name:29, type=char, outer=(29)]
      │    │         │    └── n_name:29 [type=char]
      │    │         ├── const-agg [as=p_mfgr:3, type=char, outer=(3)]
      │    │         │    └── p_mfgr:3 [type=char]
      │    │         └── const-agg [as=p_partkey:1, type=int, outer=(1)]
      │    │              └── p_partkey:1 [type=int]
      │    └── filters
      │         └── ps_supplycost:24 = min:66 [type=bool, outer=(24,66), constraints=(/24: (/NULL - ]; /66: (/NULL - ]), fd=(24)==(66), (66)==(24)]
      └── 100 [type=int]

----Stats for q2_project_1----
column_names  row_count  distinct_count  null_count
{n_name}      100        5               0
{p_mfgr}      100        5               0
{p_partkey}   100        100             0
{s_acctbal}   100        89              0
{s_address}   100        89              0
{s_comment}   100        89              0
{s_name}      100        89              0
{s_phone}     100        89              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}      1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}   1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

----Stats for q2_top_k_2----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_select_3----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_group_by_4----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_inner_join_5----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_lookup_join_6----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_inner_join_7----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_lookup_join_8----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_select_9----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_scan_10----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_inner_join_11----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_scan_12----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_inner_join_13----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_scan_14----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_select_15----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_scan_16----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_lookup_join_17----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_lookup_join_18----
column_names   row_count  distinct_count  null_count
{n_nationkey}  1987       5               0
{n_regionkey}  1987       1               0
{r_name}       1987       1               0
{r_regionkey}  1987       1               0
{s_nationkey}  1987       5               0
{s_suppkey}    1987       1987            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  5.00           397.40 <==     5.00                1.00                0.00            1.00
{n_regionkey}  5.00           397.40 <==     1.00                1.00                0.00            1.00
{r_name}       5.00           397.40 <==     1.00                1.00                0.00            1.00
{r_regionkey}  5.00           397.40 <==     1.00                1.00                0.00            1.00

----Stats for q2_select_19----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.

----Stats for q2_scan_20----
WARNING: No previous statistics output was found. To collect actual statistics,
run with the rewrite-actual-stats flag set to true.
----
----
