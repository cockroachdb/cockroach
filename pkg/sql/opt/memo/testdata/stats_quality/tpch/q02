import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q2
# Minimum Cost Supplier
# Finds which supplier should be selected to place an order for a given part in
# a given region.
#
# Finds, in a given region, for each part of a certain type and size, the
# supplier who can supply it at minimum cost. If several suppliers in that
# region offer the desired part type and size at the same (minimum) cost, the
# query lists the parts from suppliers with the 100 highest account balances.
# For each supplier, the query lists the supplier's account balance, name and
# nation; the part's number and manufacturer; the supplier's address, phone
# number and comment information.
#
# TODO:
#   1. Allow Select to be pushed below Ordinality used to add key column
#   2. Add decorrelation rule for Ordinality/RowKey
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q2
SELECT
    s_acctbal,
    s_name,
    n_name,
    p_partkey,
    p_mfgr,
    s_address,
    s_phone,
    s_comment
FROM
    part,
    supplier,
    partsupp,
    nation,
    region
WHERE
    p_partkey = ps_partkey
    AND s_suppkey = ps_suppkey
    AND p_size = 15
    AND p_type LIKE '%BRASS'
    AND s_nationkey = n_nationkey
    AND n_regionkey = r_regionkey
    AND r_name = 'EUROPE'
    AND ps_supplycost = (
        SELECT
            min(ps_supplycost)
        FROM
            partsupp,
            supplier,
            nation,
            region
        WHERE
            p_partkey = ps_partkey
            AND s_suppkey = ps_suppkey
            AND s_nationkey = n_nationkey
            AND n_regionkey = r_regionkey
            AND r_name = 'EUROPE'
    )
ORDER BY
    s_acctbal DESC,
    n_name,
    s_name,
    p_partkey
LIMIT 100;
----
----
project
 ├── save-table-name: q2_project_1
 ├── columns: s_acctbal:17(float!null) s_name:13(char!null) n_name:29(char!null) p_partkey:1(int!null) p_mfgr:3(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_comment:18(varchar!null)
 ├── cardinality: [0 - 100]
 ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(29)=1, null(29)=0]
 ├── fd: (1)-->(3)
 ├── ordering: -17,+29,+13,+1
 └── limit
      ├── save-table-name: q2_limit_2
      ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      ├── internal-ordering: -17,+29,+13,+(1|21)
      ├── cardinality: [0 - 100]
      ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(21)=0.999911941, null(21)=0, distinct(22)=0.999982121, null(22)=0, distinct(24)=1, null(24)=0, distinct(29)=1, null(29)=0, distinct(66)=1, null(66)=0]
      ├── key: (21,22)
      ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29), (24)==(66), (66)==(24)
      ├── ordering: -17,+29,+13,+(1|21) [actual: -17,+29,+13,+1]
      ├── sort
      │    ├── save-table-name: q2_sort_3
      │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      │    ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(21)=0.999911941, null(21)=0, distinct(22)=0.999982121, null(22)=0, distinct(24)=1, null(24)=0, distinct(29)=1, null(29)=0, distinct(66)=1, null(66)=0]
      │    ├── key: (21,22)
      │    ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29), (24)==(66), (66)==(24)
      │    ├── ordering: -17,+29,+13,+(1|21) [actual: -17,+29,+13,+1]
      │    ├── limit hint: 100.00
      │    └── select
      │         ├── save-table-name: q2_select_4
      │         ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      │         ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(13)=1, null(13)=0, distinct(14)=1, null(14)=0, distinct(16)=1, null(16)=0, distinct(17)=1, null(17)=0, distinct(18)=1, null(18)=0, distinct(21)=0.999911941, null(21)=0, distinct(22)=0.999982121, null(22)=0, distinct(24)=1, null(24)=0, distinct(29)=1, null(29)=0, distinct(66)=1, null(66)=0]
      │         ├── key: (21,22)
      │         ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29), (24)==(66), (66)==(24)
      │         ├── group-by
      │         │    ├── save-table-name: q2_group_by_5
      │         │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:13(char!null) s_address:14(varchar!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_name:29(char!null) min:66(float!null)
      │         │    ├── grouping columns: ps_partkey:21(int!null) ps_suppkey:22(int!null)
      │         │    ├── stats: [rows=1476.19023, distinct(1)=1476.19023, null(1)=0, distinct(3)=1476.19023, null(3)=0, distinct(13)=1476.19023, null(13)=0, distinct(14)=1476.19023, null(14)=0, distinct(16)=1476.19023, null(16)=0, distinct(17)=1476.19023, null(17)=0, distinct(18)=1476.19023, null(18)=0, distinct(21)=1171.63391, null(21)=0, distinct(22)=1402.18977, null(22)=0, distinct(24)=1476.19023, null(24)=0, distinct(29)=1476.19023, null(29)=0, distinct(66)=1476.19023, null(66)=0, distinct(21,22)=1476.19023, null(21,22)=0]
      │         │    ├── key: (21,22)
      │         │    ├── fd: (1)-->(3), (21,22)-->(1,3,13,14,16-18,24,29,66), (1)==(21), (21)==(1), (22)-->(13,14,16-18,29)
      │         │    ├── inner-join (hash)
      │         │    │    ├── save-table-name: q2_inner_join_6
      │         │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null) s_suppkey:46(int!null) s_nationkey:49(int!null) n_nationkey:55(int!null) n_regionkey:57(int!null) r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │         │    │    ├── stats: [rows=2816.58185, distinct(1)=1332.62194, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=149.999614, null(5)=0, distinct(6)=1, null(6)=0, distinct(12)=1402.18977, null(12)=0, distinct(13)=1402.74178, null(13)=0, distinct(14)=1402.82002, null(14)=0, distinct(15)=5, null(15)=0, distinct(16)=1401.5494, null(16)=0, distinct(17)=1402.82002, null(17)=0, distinct(18)=1402.05454, null(18)=0, distinct(21)=1171.63391, null(21)=0, distinct(22)=1402.18977, null(22)=0, distinct(24)=823.261788, null(24)=0, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0, distinct(39)=1332.62194, null(39)=0, distinct(40)=1444.04734, null(40)=0, distinct(42)=940.190728, null(42)=0, distinct(46)=1444.04734, null(46)=0, distinct(49)=5, null(49)=0, distinct(55)=5, null(55)=0, distinct(57)=1, null(57)=0, distinct(61)=1, null(61)=0, distinct(62)=0.996222107, null(62)=0, distinct(21,22)=1476.19023, null(21,22)=0]
      │         │    │    ├── key: (22,39,46)
      │         │    │    ├── fd: ()-->(6,35,62), (1)-->(3,5), (12)-->(13-18), (21,22)-->(24), (12)==(22), (22)==(12), (28)-->(29,30), (30)==(34), (34)==(30), (15)==(28), (28)==(15), (1)==(21,39), (21)==(1,39), (39,40)-->(42), (46)-->(49), (55)-->(57), (57)==(61), (61)==(57), (49)==(55), (55)==(49), (40)==(46), (46)==(40), (39)==(1,21)
      │         │    │    ├── inner-join (lookup partsupp)
      │         │    │    │    ├── save-table-name: q2_lookup_join_7
      │         │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null) ps_partkey:39(int!null) ps_suppkey:40(int!null) ps_supplycost:42(float!null)
      │         │    │    │    ├── key columns: [1] = [39]
      │         │    │    │    ├── stats: [rows=4450.0553, distinct(1)=1332.62194, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0, distinct(12)=3585.83828, null(12)=0, distinct(13)=3591.05929, null(13)=0, distinct(14)=3591.80003, null(14)=0, distinct(15)=25, null(15)=0, distinct(16)=3579.79362, null(16)=0, distinct(17)=3591.80003, null(17)=0, distinct(18)=3584.56078, null(18)=0, distinct(21)=1332.62194, null(21)=0, distinct(22)=3585.83828, null(22)=0, distinct(24)=988.322213, null(24)=0, distinct(28)=25, null(28)=0, distinct(29)=25, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=1, null(35)=0, distinct(39)=4399.40026, null(39)=0, distinct(40)=3585.83828, null(40)=0, distinct(42)=988.322213, null(42)=0]
      │         │    │    │    ├── key: (22,39,40)
      │         │    │    │    ├── fd: ()-->(6,35), (1)-->(3,5), (28)-->(29,30), (12)-->(13-18), (21,22)-->(24), (39,40)-->(42), (21)==(1,39), (39)==(1,21), (12)==(22), (22)==(12), (15)==(28), (28)==(15), (30)==(34), (34)==(30), (1)==(21,39)
      │         │    │    │    ├── inner-join (hash)
      │         │    │    │    │    ├── save-table-name: q2_inner_join_8
      │         │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │         │    │    │    │    ├── stats: [rows=1930.83522, distinct(1)=1332.62194, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=149.999615, null(5)=0, distinct(6)=1, null(6)=0, distinct(12)=1754.55357, null(12)=0, distinct(13)=1755.71178, null(13)=0, distinct(14)=1755.87599, null(14)=0, distinct(15)=5, null(15)=0, distinct(16)=1753.21103, null(16)=0, distinct(17)=1755.87599, null(17)=0, distinct(18)=1754.26998, null(18)=0, distinct(21)=1332.62194, null(21)=0, distinct(22)=1754.55357, null(22)=0, distinct(24)=854.97424, null(24)=0, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0, distinct(21,22)=1917.64467, null(21,22)=0]
      │         │    │    │    │    ├── key: (21,22)
      │         │    │    │    │    ├── fd: ()-->(6,35), (1)-->(3,5), (12)-->(13-18), (21,22)-->(24), (12)==(22), (22)==(12), (28)-->(29,30), (30)==(34), (34)==(30), (15)==(28), (28)==(15), (1)==(21), (21)==(1)
      │         │    │    │    │    ├── inner-join (lookup partsupp)
      │         │    │    │    │    │    ├── save-table-name: q2_lookup_join_9
      │         │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) ps_partkey:21(int!null) ps_suppkey:22(int!null) ps_supplycost:24(float!null)
      │         │    │    │    │    │    ├── key columns: [1] = [21]
      │         │    │    │    │    │    ├── stats: [rows=5350.86208, distinct(1)=1332.62194, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0, distinct(21)=1332.62194, null(21)=0, distinct(22)=4135.68382, null(22)=0, distinct(24)=995.256004, null(24)=0]
      │         │    │    │    │    │    ├── key: (21,22)
      │         │    │    │    │    │    ├── fd: ()-->(6), (1)-->(3,5), (21,22)-->(24), (1)==(21), (21)==(1)
      │         │    │    │    │    │    ├── select
      │         │    │    │    │    │    │    ├── save-table-name: q2_select_10
      │         │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null)
      │         │    │    │    │    │    │    ├── stats: [rows=1332.63889, distinct(1)=1332.62194, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0]
      │         │    │    │    │    │    │    │   histogram(6)=  0 1332.6
      │         │    │    │    │    │    │    │                <---- 15 -
      │         │    │    │    │    │    │    ├── key: (1)
      │         │    │    │    │    │    │    ├── fd: ()-->(6), (1)-->(3,5)
      │         │    │    │    │    │    │    ├── scan part
      │         │    │    │    │    │    │    │    ├── save-table-name: q2_scan_11
      │         │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null)
      │         │    │    │    │    │    │    │    ├── stats: [rows=200000, distinct(1)=199241, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=50, null(6)=0]
      │         │    │    │    │    │    │    │    │   histogram(1)=  0  4   995   4    995   4    995   4    995   4    995   4    995   4    995   4    995   4    995   4    995   4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4    995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     995    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4     1015    4
      │         │    │    │    │    │    │    │    │                <--- 51 ----- 1335 ----- 2367 ----- 3558 ----- 4278 ----- 5314 ----- 6325 ----- 7176 ----- 7962 ----- 8784 ----- 9892 ----- 10810 ----- 11716 ----- 13130 ----- 14005 ----- 15148 ----- 16150 ----- 17087 ----- 18257 ----- 19342 ----- 20527 ----- 21590 ----- 22542 ----- 23384 ----- 24421 ----- 25315 ----- 26134 ----- 27000 ----- 28133 ----- 29410 ----- 30496 ----- 31588 ----- 32466 ----- 33679 ----- 34601 ----- 35492 ----- 36519 ----- 37442 ----- 38366 ----- 39443 ----- 40397 ----- 41264 ----- 42229 ----- 43451 ----- 44398 ----- 45392 ----- 46638 ----- 47995 ----- 48801 ----- 49889 ----- 50947 ----- 52085 ----- 53305 ----- 54604 ----- 55814 ----- 56756 ----- 58001 ----- 58959 ----- 59885 ----- 60693 ----- 61995 ----- 62937 ----- 63659 ----- 64554 ----- 65585 ----- 66520 ----- 67565 ----- 68432 ----- 69390 ----- 70467 ----- 71369 ----- 72478 ----- 73538 ----- 74665 ----- 75622 ----- 76704 ----- 77646 ----- 78630 ----- 79292 ----- 80356 ----- 81132 ----- 82072 ----- 83154 ----- 84167 ----- 85308 ----- 86150 ----- 87083 ----- 87986 ----- 88892 ----- 89757 ----- 90788 ----- 91954 ----- 93074 ----- 93996 ----- 95002 ----- 96042 ----- 97023 ----- 97824 ----- 98940 ----- 99965 ----- 101025 ----- 101781 ----- 102883 ----- 103902 ----- 105012 ----- 106090 ----- 107104 ----- 108064 ----- 109159 ----- 110038 ----- 110978 ----- 111895 ----- 112941 ----- 114007 ----- 114921 ----- 116235 ----- 117042 ----- 117939 ----- 118788 ----- 119802 ----- 120824 ----- 121804 ----- 123111 ----- 124376 ----- 125340 ----- 126355 ----- 127574 ----- 128587 ----- 129598 ----- 130612 ----- 131514 ----- 132614 ----- 133829 ----- 134751 ----- 135902 ----- 136794 ----- 137598 ----- 138467 ----- 139297 ----- 140102 ----- 141045 ----- 142268 ----- 143377 ----- 144156 ----- 144880 ----- 145801 ----- 146819 ----- 148041 ----- 149167 ----- 150061 ----- 151337 ------ 152411 ------ 153293 ------ 154410 ------ 155310 ------ 156386 ------ 157590 ------ 158468 ------ 159305 ------ 160408 ------ 161368 ------ 162405 ------ 163380 ------ 164575 ------ 165545 ------ 166336 ------ 167397 ------ 168178 ------ 169037 ------ 170049 ------ 170961 ------ 171903 ------ 172778 ------ 173659 ------ 174790 ------ 175942 ------ 176848 ------ 177923 ------ 178929 ------ 180020 ------ 181259 ------ 182189 ------ 183185 ------ 184259 ------ 185293 ------ 186324 ------ 187343 ------ 188406 ------ 189513 ------ 190329 ------ 191092 ------ 192180 ------ 193293 ------ 194190 ------ 195344 ------ 196415 ------ 197219 ------ 198051 ------ 199021 ------ 199996
      │         │    │    │    │    │    │    │    │   histogram(3)=  0       40280        1.1994e+05       39780
      │         │    │    │    │    │    │    │    │                <--- 'Manufacturer#1' ------------ 'Manufacturer#5'
      │         │    │    │    │    │    │    │    │   histogram(5)=  0            1160            1.9758e+05           1260
      │         │    │    │    │    │    │    │    │                <--- 'ECONOMY ANODIZED BRASS' ------------ 'STANDARD POLISHED TIN'
      │         │    │    │    │    │    │    │    │   histogram(6)=  0 3940 1.919e+05 4160
      │         │    │    │    │    │    │    │    │                <--- 1 ------------ 50
      │         │    │    │    │    │    │    │    ├── key: (1)
      │         │    │    │    │    │    │    │    └── fd: (1)-->(3,5,6)
      │         │    │    │    │    │    │    └── filters
      │         │    │    │    │    │    │         ├── p_size:6 = 15 [type=bool, outer=(6), constraints=(/6: [/15 - /15]; tight), fd=()-->(6)]
      │         │    │    │    │    │    │         └── p_type:5 LIKE '%BRASS' [type=bool, outer=(5), constraints=(/5: (/NULL - ])]
      │         │    │    │    │    │    └── filters (true)
      │         │    │    │    │    ├── inner-join (hash)
      │         │    │    │    │    │    ├── save-table-name: q2_inner_join_12
      │         │    │    │    │    │    ├── columns: s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null) n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │         │    │    │    │    │    ├── stats: [rows=2000, distinct(12)=1844.80594, null(12)=0, distinct(13)=1846.09084, null(13)=0, distinct(14)=1846.27302, null(14)=0, distinct(15)=5, null(15)=0, distinct(16)=1843.31663, null(16)=0, distinct(17)=1846.27302, null(17)=0, distinct(18)=1844.49134, null(18)=0, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0]
      │         │    │    │    │    │    ├── key: (12)
      │         │    │    │    │    │    ├── fd: ()-->(35), (12)-->(13-18), (28)-->(29,30), (30)==(34), (34)==(30), (15)==(28), (28)==(15)
      │         │    │    │    │    │    ├── scan supplier
      │         │    │    │    │    │    │    ├── save-table-name: q2_scan_13
      │         │    │    │    │    │    │    ├── columns: s_suppkey:12(int!null) s_name:13(char!null) s_address:14(varchar!null) s_nationkey:15(int!null) s_phone:16(char!null) s_acctbal:17(float!null) s_comment:18(varchar!null)
      │         │    │    │    │    │    │    ├── stats: [rows=10000, distinct(12)=9920, null(12)=0, distinct(13)=9990, null(13)=0, distinct(14)=10000, null(14)=0, distinct(15)=25, null(15)=0, distinct(16)=9840, null(16)=0, distinct(17)=10000, null(17)=0, distinct(18)=9903, null(18)=0]
      │         │    │    │    │    │    │    │   histogram(12)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50    1
      │         │    │    │    │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │         │    │    │    │    │    │    │   histogram(13)=  0           1            9998           1
      │         │    │    │    │    │    │    │                 <--- 'Supplier#000000001' ------ 'Supplier#000010000'
      │         │    │    │    │    │    │    │   histogram(14)=  0                      1                      9998       1
      │         │    │    │    │    │    │    │                 <--- '   7thzdOKLdVP yR7ZbOMnubI6,PrkxBX ZYw1' ------ 'zzvmS9DyfR'
      │         │    │    │    │    │    │    │   histogram(15)=  0 403 0 384 0 391 0 396 0 406 0 396 0 393 0 399 0 406 0 393 0 383  0 398  0 394  0 414  0 422  0 387  0 435  0 403  0 441  0 357  0 394  0 390  0 421  0 411  0 383
      │         │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │         │    │    │    │    │    │    │   histogram(16)=  0          1          9998          1
      │         │    │    │    │    │    │    │                 <--- '10-101-276-5805' ------ '34-997-188-3418'
      │         │    │    │    │    │    │    │   histogram(17)=  0         1          9998        1
      │         │    │    │    │    │    │    │                 <--- -999.72998046875 ------ 9999.509765625
      │         │    │    │    │    │    │    │   histogram(18)=  0                                       1                                       9998                         1
      │         │    │    │    │    │    │    │                 <--- ' A ability south main close despite clearly. Who hold sense everyone. Cou' ------ 'zine know whatever discuss. Realize brother co'
      │         │    │    │    │    │    │    ├── key: (12)
      │         │    │    │    │    │    │    └── fd: (12)-->(13-18)
      │         │    │    │    │    │    ├── inner-join (hash)
      │         │    │    │    │    │    │    ├── save-table-name: q2_inner_join_14
      │         │    │    │    │    │    │    ├── columns: n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null) r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │         │    │    │    │    │    │    ├── stats: [rows=5, distinct(28)=5, null(28)=0, distinct(29)=5, null(29)=0, distinct(30)=1, null(30)=0, distinct(34)=1, null(34)=0, distinct(35)=0.996222107, null(35)=0]
      │         │    │    │    │    │    │    ├── key: (28)
      │         │    │    │    │    │    │    ├── fd: ()-->(35), (28)-->(29,30), (30)==(34), (34)==(30)
      │         │    │    │    │    │    │    ├── scan nation
      │         │    │    │    │    │    │    │    ├── save-table-name: q2_scan_15
      │         │    │    │    │    │    │    │    ├── columns: n_nationkey:28(int!null) n_name:29(char!null) n_regionkey:30(int!null)
      │         │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(28)=25, null(28)=0, distinct(29)=25, null(29)=0, distinct(30)=5, null(30)=0]
      │         │    │    │    │    │    │    │    │   histogram(28)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │         │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │         │    │    │    │    │    │    │    │   histogram(29)=  0      1      23      1
      │         │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │         │    │    │    │    │    │    │    │   histogram(30)=  0  5  0  5  0  5  0  5  0  5
      │         │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    │    ├── key: (28)
      │         │    │    │    │    │    │    │    └── fd: (28)-->(29,30)
      │         │    │    │    │    │    │    ├── select
      │         │    │    │    │    │    │    │    ├── save-table-name: q2_select_16
      │         │    │    │    │    │    │    │    ├── columns: r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    │    │    │    ├── stats: [rows=1, distinct(34)=1, null(34)=0, distinct(35)=1, null(35)=0]
      │         │    │    │    │    │    │    │    │   histogram(35)=  0     1
      │         │    │    │    │    │    │    │    │                 <--- 'EUROPE'
      │         │    │    │    │    │    │    │    ├── key: (34)
      │         │    │    │    │    │    │    │    ├── fd: ()-->(35)
      │         │    │    │    │    │    │    │    ├── scan region
      │         │    │    │    │    │    │    │    │    ├── save-table-name: q2_scan_17
      │         │    │    │    │    │    │    │    │    ├── columns: r_regionkey:34(int!null) r_name:35(char!null)
      │         │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(34)=5, null(34)=0, distinct(35)=5, null(35)=0]
      │         │    │    │    │    │    │    │    │    │   histogram(34)=  0  1  0  1  0  1  0  1  0  1
      │         │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    │    │    │   histogram(35)=  0     1      3        1
      │         │    │    │    │    │    │    │    │    │                 <--- 'AFRICA' --- 'MIDDLE EAST'
      │         │    │    │    │    │    │    │    │    ├── key: (34)
      │         │    │    │    │    │    │    │    │    └── fd: (34)-->(35)
      │         │    │    │    │    │    │    │    └── filters
      │         │    │    │    │    │    │    │         └── r_name:35 = 'EUROPE' [type=bool, outer=(35), constraints=(/35: [/'EUROPE' - /'EUROPE']; tight), fd=()-->(35)]
      │         │    │    │    │    │    │    └── filters
      │         │    │    │    │    │    │         └── n_regionkey:30 = r_regionkey:34 [type=bool, outer=(30,34), constraints=(/30: (/NULL - ]; /34: (/NULL - ]), fd=(30)==(34), (34)==(30)]
      │         │    │    │    │    │    └── filters
      │         │    │    │    │    │         └── s_nationkey:15 = n_nationkey:28 [type=bool, outer=(15,28), constraints=(/15: (/NULL - ]; /28: (/NULL - ]), fd=(15)==(28), (28)==(15)]
      │         │    │    │    │    └── filters
      │         │    │    │    │         └── s_suppkey:12 = ps_suppkey:22 [type=bool, outer=(12,22), constraints=(/12: (/NULL - ]; /22: (/NULL - ]), fd=(12)==(22), (22)==(12)]
      │         │    │    │    └── filters (true)
      │         │    │    ├── inner-join (lookup supplier@s_nk)
      │         │    │    │    ├── save-table-name: q2_lookup_join_18
      │         │    │    │    ├── columns: s_suppkey:46(int!null) s_nationkey:49(int!null) n_nationkey:55(int!null) n_regionkey:57(int!null) r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    │    ├── key columns: [55] = [49]
      │         │    │    │    ├── stats: [rows=2000, distinct(46)=1844.80594, null(46)=0, distinct(49)=5, null(49)=0, distinct(55)=5, null(55)=0, distinct(57)=1, null(57)=0, distinct(61)=1, null(61)=0, distinct(62)=0.996222107, null(62)=0]
      │         │    │    │    ├── key: (46)
      │         │    │    │    ├── fd: ()-->(62), (46)-->(49), (55)-->(57), (57)==(61), (61)==(57), (49)==(55), (55)==(49)
      │         │    │    │    ├── inner-join (lookup nation@n_rk)
      │         │    │    │    │    ├── save-table-name: q2_lookup_join_19
      │         │    │    │    │    ├── columns: n_nationkey:55(int!null) n_regionkey:57(int!null) r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    │    │    ├── key columns: [61] = [57]
      │         │    │    │    │    ├── stats: [rows=5, distinct(55)=5, null(55)=0, distinct(57)=1, null(57)=0, distinct(61)=1, null(61)=0, distinct(62)=0.996222107, null(62)=0]
      │         │    │    │    │    ├── key: (55)
      │         │    │    │    │    ├── fd: ()-->(62), (55)-->(57), (57)==(61), (61)==(57)
      │         │    │    │    │    ├── select
      │         │    │    │    │    │    ├── save-table-name: q2_select_20
      │         │    │    │    │    │    ├── columns: r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    │    │    │    ├── stats: [rows=1, distinct(61)=1, null(61)=0, distinct(62)=1, null(62)=0]
      │         │    │    │    │    │    │   histogram(62)=  0     1
      │         │    │    │    │    │    │                 <--- 'EUROPE'
      │         │    │    │    │    │    ├── key: (61)
      │         │    │    │    │    │    ├── fd: ()-->(62)
      │         │    │    │    │    │    ├── scan region
      │         │    │    │    │    │    │    ├── save-table-name: q2_scan_21
      │         │    │    │    │    │    │    ├── columns: r_regionkey:61(int!null) r_name:62(char!null)
      │         │    │    │    │    │    │    ├── stats: [rows=5, distinct(61)=5, null(61)=0, distinct(62)=5, null(62)=0]
      │         │    │    │    │    │    │    │   histogram(61)=  0  1  0  1  0  1  0  1  0  1
      │         │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    │   histogram(62)=  0     1      3        1
      │         │    │    │    │    │    │    │                 <--- 'AFRICA' --- 'MIDDLE EAST'
      │         │    │    │    │    │    │    ├── key: (61)
      │         │    │    │    │    │    │    └── fd: (61)-->(62)
      │         │    │    │    │    │    └── filters
      │         │    │    │    │    │         └── r_name:62 = 'EUROPE' [type=bool, outer=(62), constraints=(/62: [/'EUROPE' - /'EUROPE']; tight), fd=()-->(62)]
      │         │    │    │    │    └── filters (true)
      │         │    │    │    └── filters (true)
      │         │    │    └── filters
      │         │    │         └── s_suppkey:46 = ps_suppkey:40 [type=bool, outer=(40,46), constraints=(/40: (/NULL - ]; /46: (/NULL - ]), fd=(40)==(46), (46)==(40)]
      │         │    └── aggregations
      │         │         ├── min [as=min:66, type=float, outer=(42)]
      │         │         │    └── ps_supplycost:42 [type=float]
      │         │         ├── const-agg [as=s_name:13, type=char, outer=(13)]
      │         │         │    └── s_name:13 [type=char]
      │         │         ├── const-agg [as=s_address:14, type=varchar, outer=(14)]
      │         │         │    └── s_address:14 [type=varchar]
      │         │         ├── const-agg [as=s_phone:16, type=char, outer=(16)]
      │         │         │    └── s_phone:16 [type=char]
      │         │         ├── const-agg [as=s_acctbal:17, type=float, outer=(17)]
      │         │         │    └── s_acctbal:17 [type=float]
      │         │         ├── const-agg [as=s_comment:18, type=varchar, outer=(18)]
      │         │         │    └── s_comment:18 [type=varchar]
      │         │         ├── const-agg [as=ps_supplycost:24, type=float, outer=(24)]
      │         │         │    └── ps_supplycost:24 [type=float]
      │         │         ├── const-agg [as=n_name:29, type=char, outer=(29)]
      │         │         │    └── n_name:29 [type=char]
      │         │         ├── const-agg [as=p_mfgr:3, type=char, outer=(3)]
      │         │         │    └── p_mfgr:3 [type=char]
      │         │         └── const-agg [as=p_partkey:1, type=int, outer=(1)]
      │         │              └── p_partkey:1 [type=int]
      │         └── filters
      │              └── ps_supplycost:24 = min:66 [type=bool, outer=(24,66), constraints=(/24: (/NULL - ]; /66: (/NULL - ]), fd=(24)==(66), (66)==(24)]
      └── 100 [type=int]

----Stats for q2_project_1----
column_names  row_count  distinct_count  null_count
{n_name}      100        5               0
{p_mfgr}      100        5               0
{p_partkey}   100        100             0
{s_acctbal}   100        89              0
{s_address}   100        89              0
{s_comment}   100        89              0
{s_name}      100        89              0
{s_phone}     100        89              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}      1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}   1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

----Stats for q2_limit_2----
column_names     row_count  distinct_count  null_count
{min}            100        100             0
{n_name}         100        5               0
{p_mfgr}         100        5               0
{p_partkey}      100        100             0
{ps_partkey}     100        100             0
{ps_suppkey}     100        89              0
{ps_supplycost}  100        100             0
{s_acctbal}      100        89              0
{s_address}      100        89              0
{s_comment}      100        89              0
{s_name}         100        89              0
{s_phone}        100        89              0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{n_name}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}      1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_partkey}     1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_suppkey}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{ps_supplycost}  1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}         1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}        1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

----Stats for q2_sort_3----
column_names     row_count  distinct_count  null_count
{min}            100        100             0
{n_name}         100        5               0
{p_mfgr}         100        5               0
{p_partkey}      100        100             0
{ps_partkey}     100        100             0
{ps_suppkey}     100        89              0
{ps_supplycost}  100        100             0
{s_acctbal}      100        89              0
{s_address}      100        89              0
{s_comment}      100        89              0
{s_name}         100        89              0
{s_phone}        100        89              0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{n_name}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}      1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_partkey}     1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_suppkey}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{ps_supplycost}  1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}         1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}        1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

----Stats for q2_select_4----
column_names     row_count  distinct_count  null_count
{min}            460        458             0
{n_name}         460        5               0
{p_mfgr}         460        5               0
{p_partkey}      460        460             0
{ps_partkey}     460        460             0
{ps_suppkey}     460        406             0
{ps_supplycost}  460        458             0
{s_acctbal}      460        406             0
{s_address}      460        406             0
{s_comment}      460        406             0
{s_name}         460        406             0
{s_phone}        460        406             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1.00           460.00 <==     1.00                458.00 <==          0.00            1.00
{n_name}         1.00           460.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}         1.00           460.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}      1.00           460.00 <==     1.00                460.00 <==          0.00            1.00
{ps_partkey}     1.00           460.00 <==     1.00                460.00 <==          0.00            1.00
{ps_suppkey}     1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{ps_supplycost}  1.00           460.00 <==     1.00                458.00 <==          0.00            1.00
{s_acctbal}      1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_address}      1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_comment}      1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_name}         1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_phone}        1.00           460.00 <==     1.00                406.00 <==          0.00            1.00

----Stats for q2_group_by_5----
column_names     row_count  distinct_count  null_count
{min}            642        458             0
{n_name}         642        5               0
{p_mfgr}         642        5               0
{p_partkey}      642        460             0
{ps_partkey}     642        460             0
{ps_suppkey}     642        548             0
{ps_supplycost}  642        640             0
{s_acctbal}      642        548             0
{s_address}      642        548             0
{s_comment}      642        548             0
{s_name}         642        548             0
{s_phone}        642        548             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1476.00        2.30 <==       1476.00             3.22 <==            0.00            1.00
{n_name}         1476.00        2.30 <==       1476.00             295.20 <==          0.00            1.00
{p_mfgr}         1476.00        2.30 <==       1476.00             295.20 <==          0.00            1.00
{p_partkey}      1476.00        2.30 <==       1476.00             3.21 <==            0.00            1.00
{ps_partkey}     1476.00        2.30 <==       1172.00             2.55 <==            0.00            1.00
{ps_suppkey}     1476.00        2.30 <==       1402.00             2.56 <==            0.00            1.00
{ps_supplycost}  1476.00        2.30 <==       1476.00             2.31 <==            0.00            1.00
{s_acctbal}      1476.00        2.30 <==       1476.00             2.69 <==            0.00            1.00
{s_address}      1476.00        2.30 <==       1476.00             2.69 <==            0.00            1.00
{s_comment}      1476.00        2.30 <==       1476.00             2.69 <==            0.00            1.00
{s_name}         1476.00        2.30 <==       1476.00             2.69 <==            0.00            1.00
{s_phone}        1476.00        2.30 <==       1476.00             2.69 <==            0.00            1.00

----Stats for q2_inner_join_6----
column_names       row_count  distinct_count  null_count
{n_name}           1070       5               0
{n_nationkey_1}    1070       5               0
{n_nationkey}      1070       5               0
{n_regionkey_1}    1070       1               0
{n_regionkey}      1070       1               0
{p_mfgr}           1070       5               0
{p_partkey}        1070       460             0
{p_size}           1070       1               0
{p_type}           1070       30              0
{ps_partkey_1}     1070       460             0
{ps_partkey}       1070       460             0
{ps_suppkey_1}     1070       548             0
{ps_suppkey}       1070       548             0
{ps_supplycost_1}  1070       640             0
{ps_supplycost}    1070       640             0
{r_name_1}         1070       1               0
{r_name}           1070       1               0
{r_regionkey_1}    1070       1               0
{r_regionkey}      1070       1               0
{s_acctbal}        1070       548             0
{s_address}        1070       548             0
{s_comment}        1070       548             0
{s_name}           1070       548             0
{s_nationkey_1}    1070       5               0
{s_nationkey}      1070       5               0
{s_phone}          1070       548             0
{s_suppkey_1}      1070       548             0
{s_suppkey}        1070       548             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}           2817.00        2.63 <==       5.00                1.00                0.00            1.00
{n_nationkey}      2817.00        2.63 <==       5.00                1.00                0.00            1.00
{n_nationkey_1}    2817.00        2.63 <==       5.00                1.00                0.00            1.00
{n_regionkey}      2817.00        2.63 <==       1.00                1.00                0.00            1.00
{n_regionkey_1}    2817.00        2.63 <==       1.00                1.00                0.00            1.00
{p_mfgr}           2817.00        2.63 <==       5.00                1.00                0.00            1.00
{p_partkey}        2817.00        2.63 <==       1333.00             2.90 <==            0.00            1.00
{p_size}           2817.00        2.63 <==       1.00                1.00                0.00            1.00
{p_type}           2817.00        2.63 <==       150.00              5.00 <==            0.00            1.00
{ps_partkey}       2817.00        2.63 <==       1172.00             2.55 <==            0.00            1.00
{ps_partkey_1}     2817.00        2.63 <==       1333.00             2.90 <==            0.00            1.00
{ps_suppkey}       2817.00        2.63 <==       1402.00             2.56 <==            0.00            1.00
{ps_suppkey_1}     2817.00        2.63 <==       1444.00             2.64 <==            0.00            1.00
{ps_supplycost}    2817.00        2.63 <==       823.00              1.29                0.00            1.00
{ps_supplycost_1}  2817.00        2.63 <==       940.00              1.47                0.00            1.00
{r_name}           2817.00        2.63 <==       1.00                1.00                0.00            1.00
{r_name_1}         2817.00        2.63 <==       1.00                1.00                0.00            1.00
{r_regionkey}      2817.00        2.63 <==       1.00                1.00                0.00            1.00
{r_regionkey_1}    2817.00        2.63 <==       1.00                1.00                0.00            1.00
{s_acctbal}        2817.00        2.63 <==       1403.00             2.56 <==            0.00            1.00
{s_address}        2817.00        2.63 <==       1403.00             2.56 <==            0.00            1.00
{s_comment}        2817.00        2.63 <==       1402.00             2.56 <==            0.00            1.00
{s_name}           2817.00        2.63 <==       1403.00             2.56 <==            0.00            1.00
{s_nationkey}      2817.00        2.63 <==       5.00                1.00                0.00            1.00
{s_nationkey_1}    2817.00        2.63 <==       5.00                1.00                0.00            1.00
{s_phone}          2817.00        2.63 <==       1402.00             2.56 <==            0.00            1.00
{s_suppkey}        2817.00        2.63 <==       1402.00             2.56 <==            0.00            1.00
{s_suppkey_1}      2817.00        2.63 <==       1444.00             2.64 <==            0.00            1.00

----Stats for q2_lookup_join_7----
column_names       row_count  distinct_count  null_count
{n_name}           2568       5               0
{n_nationkey}      2568       5               0
{n_regionkey}      2568       1               0
{p_mfgr}           2568       5               0
{p_partkey}        2568       460             0
{p_size}           2568       1               0
{p_type}           2568       30              0
{ps_partkey_1}     2568       460             0
{ps_partkey}       2568       460             0
{ps_suppkey_1}     2568       1661            0
{ps_suppkey}       2568       548             0
{ps_supplycost_1}  2568       1825            0
{ps_supplycost}    2568       640             0
{r_name}           2568       1               0
{r_regionkey}      2568       1               0
{s_acctbal}        2568       548             0
{s_address}        2568       548             0
{s_comment}        2568       548             0
{s_name}           2568       548             0
{s_nationkey}      2568       5               0
{s_phone}          2568       548             0
{s_suppkey}        2568       548             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}           4450.00        1.73           25.00               5.00 <==            0.00            1.00
{n_nationkey}      4450.00        1.73           25.00               5.00 <==            0.00            1.00
{n_regionkey}      4450.00        1.73           1.00                1.00                0.00            1.00
{p_mfgr}           4450.00        1.73           5.00                1.00                0.00            1.00
{p_partkey}        4450.00        1.73           1333.00             2.90 <==            0.00            1.00
{p_size}           4450.00        1.73           1.00                1.00                0.00            1.00
{p_type}           4450.00        1.73           150.00              5.00 <==            0.00            1.00
{ps_partkey}       4450.00        1.73           1333.00             2.90 <==            0.00            1.00
{ps_partkey_1}     4450.00        1.73           4399.00             9.56 <==            0.00            1.00
{ps_suppkey}       4450.00        1.73           3586.00             6.54 <==            0.00            1.00
{ps_suppkey_1}     4450.00        1.73           3586.00             2.16 <==            0.00            1.00
{ps_supplycost}    4450.00        1.73           988.00              1.54                0.00            1.00
{ps_supplycost_1}  4450.00        1.73           988.00              1.85                0.00            1.00
{r_name}           4450.00        1.73           1.00                1.00                0.00            1.00
{r_regionkey}      4450.00        1.73           1.00                1.00                0.00            1.00
{s_acctbal}        4450.00        1.73           3592.00             6.55 <==            0.00            1.00
{s_address}        4450.00        1.73           3592.00             6.55 <==            0.00            1.00
{s_comment}        4450.00        1.73           3585.00             6.54 <==            0.00            1.00
{s_name}           4450.00        1.73           3591.00             6.55 <==            0.00            1.00
{s_nationkey}      4450.00        1.73           25.00               5.00 <==            0.00            1.00
{s_phone}          4450.00        1.73           3580.00             6.53 <==            0.00            1.00
{s_suppkey}        4450.00        1.73           3586.00             6.54 <==            0.00            1.00

----Stats for q2_inner_join_8----
column_names     row_count  distinct_count  null_count
{n_name}         642        5               0
{n_nationkey}    642        5               0
{n_regionkey}    642        1               0
{p_mfgr}         642        5               0
{p_partkey}      642        460             0
{p_size}         642        1               0
{p_type}         642        30              0
{ps_partkey}     642        460             0
{ps_suppkey}     642        548             0
{ps_supplycost}  642        640             0
{r_name}         642        1               0
{r_regionkey}    642        1               0
{s_acctbal}      642        548             0
{s_address}      642        548             0
{s_comment}      642        548             0
{s_name}         642        548             0
{s_nationkey}    642        5               0
{s_phone}        642        548             0
{s_suppkey}      642        548             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         1931.00        3.01 <==       5.00                1.00                0.00            1.00
{n_nationkey}    1931.00        3.01 <==       5.00                1.00                0.00            1.00
{n_regionkey}    1931.00        3.01 <==       1.00                1.00                0.00            1.00
{p_mfgr}         1931.00        3.01 <==       5.00                1.00                0.00            1.00
{p_partkey}      1931.00        3.01 <==       1333.00             2.90 <==            0.00            1.00
{p_size}         1931.00        3.01 <==       1.00                1.00                0.00            1.00
{p_type}         1931.00        3.01 <==       150.00              5.00 <==            0.00            1.00
{ps_partkey}     1931.00        3.01 <==       1333.00             2.90 <==            0.00            1.00
{ps_suppkey}     1931.00        3.01 <==       1755.00             3.20 <==            0.00            1.00
{ps_supplycost}  1931.00        3.01 <==       855.00              1.34                0.00            1.00
{r_name}         1931.00        3.01 <==       1.00                1.00                0.00            1.00
{r_regionkey}    1931.00        3.01 <==       1.00                1.00                0.00            1.00
{s_acctbal}      1931.00        3.01 <==       1756.00             3.20 <==            0.00            1.00
{s_address}      1931.00        3.01 <==       1756.00             3.20 <==            0.00            1.00
{s_comment}      1931.00        3.01 <==       1754.00             3.20 <==            0.00            1.00
{s_name}         1931.00        3.01 <==       1756.00             3.20 <==            0.00            1.00
{s_nationkey}    1931.00        3.01 <==       5.00                1.00                0.00            1.00
{s_phone}        1931.00        3.01 <==       1753.00             3.20 <==            0.00            1.00
{s_suppkey}      1931.00        3.01 <==       1755.00             3.20 <==            0.00            1.00

----Stats for q2_lookup_join_9----
column_names     row_count  distinct_count  null_count
{p_mfgr}         2988       5               0
{p_partkey}      2988       747             0
{p_size}         2988       1               0
{p_type}         2988       30              0
{ps_partkey}     2988       747             0
{ps_suppkey}     2988       2570            0
{ps_supplycost}  2988       2948            0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_mfgr}         5351.00        1.79           5.00                1.00                0.00            1.00
{p_partkey}      5351.00        1.79           1333.00             1.78                0.00            1.00
{p_size}         5351.00        1.79           1.00                1.00                0.00            1.00
{p_type}         5351.00        1.79           150.00              5.00 <==            0.00            1.00
{ps_partkey}     5351.00        1.79           1333.00             1.78                0.00            1.00
{ps_suppkey}     5351.00        1.79           4136.00             1.61                0.00            1.00
{ps_supplycost}  5351.00        1.79           995.00              2.96 <==            0.00            1.00

----Stats for q2_select_10----
column_names  row_count  distinct_count  null_count
{p_mfgr}      747        5               0
{p_partkey}   747        747             0
{p_size}      747        1               0
{p_type}      747        30              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_mfgr}      1333.00        1.78           5.00                1.00                0.00            1.00
{p_partkey}   1333.00        1.78           1333.00             1.78                0.00            1.00
{p_size}      1333.00        1.78           1.00                1.00                0.00            1.00
{p_type}      1333.00        1.78           150.00              5.00 <==            0.00            1.00

----Stats for q2_scan_11----
column_names  row_count  distinct_count  null_count
{p_mfgr}      200000     5               0
{p_partkey}   200000     199241          0
{p_size}      200000     50              0
{p_type}      200000     150             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_mfgr}      200000.00      1.00           5.00                1.00                0.00            1.00
{p_partkey}   200000.00      1.00           199241.00           1.00                0.00            1.00
{p_size}      200000.00      1.00           50.00               1.00                0.00            1.00
{p_type}      200000.00      1.00           150.00              1.00                0.00            1.00

----Stats for q2_inner_join_12----
column_names   row_count  distinct_count  null_count
{n_name}       1987       5               0
{n_nationkey}  1987       5               0
{n_regionkey}  1987       1               0
{r_name}       1987       1               0
{r_regionkey}  1987       1               0
{s_acctbal}    1987       1983            0
{s_address}    1987       1986            0
{s_comment}    1987       1987            0
{s_name}       1987       1987            0
{s_nationkey}  1987       5               0
{s_phone}      1987       1987            0
{s_suppkey}    1987       1987            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       2000.00        1.01           5.00                1.00                0.00            1.00
{n_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{n_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{r_name}       2000.00        1.01           1.00                1.00                0.00            1.00
{r_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{s_acctbal}    2000.00        1.01           1846.00             1.07                0.00            1.00
{s_address}    2000.00        1.01           1846.00             1.08                0.00            1.00
{s_comment}    2000.00        1.01           1844.00             1.08                0.00            1.00
{s_name}       2000.00        1.01           1846.00             1.08                0.00            1.00
{s_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{s_phone}      2000.00        1.01           1843.00             1.08                0.00            1.00
{s_suppkey}    2000.00        1.01           1845.00             1.08                0.00            1.00

----Stats for q2_scan_13----
column_names   row_count  distinct_count  null_count
{s_acctbal}    10000      9967            0
{s_address}    10000      10027           0
{s_comment}    10000      9934            0
{s_name}       10000      9990            0
{s_nationkey}  10000      25              0
{s_phone}      10000      10021           0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_acctbal}    10000.00       1.00           10000.00            1.00                0.00            1.00
{s_address}    10000.00       1.00           10000.00            1.00                0.00            1.00
{s_comment}    10000.00       1.00           9903.00             1.00                0.00            1.00
{s_name}       10000.00       1.00           9990.00             1.00                0.00            1.00
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_phone}      10000.00       1.00           9840.00             1.02                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00

----Stats for q2_inner_join_14----
column_names   row_count  distinct_count  null_count
{n_name}       5          5               0
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       5.00           1.00           5.00                1.00                0.00            1.00
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

----Stats for q2_scan_15----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
{n_regionkey}  25         5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
{n_regionkey}  25.00          1.00           5.00                1.00                0.00            1.00

----Stats for q2_select_16----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

----Stats for q2_scan_17----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00

----Stats for q2_lookup_join_18----
column_names   row_count  distinct_count  null_count
{n_nationkey}  1987       5               0
{n_regionkey}  1987       1               0
{r_name}       1987       1               0
{r_regionkey}  1987       1               0
{s_nationkey}  1987       5               0
{s_suppkey}    1987       1987            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{n_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{r_name}       2000.00        1.01           1.00                1.00                0.00            1.00
{r_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{s_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{s_suppkey}    2000.00        1.01           1845.00             1.08                0.00            1.00

----Stats for q2_lookup_join_19----
column_names   row_count  distinct_count  null_count
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

----Stats for q2_select_20----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

----Stats for q2_scan_21----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00
----
----
