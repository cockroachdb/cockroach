import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q2
# Minimum Cost Supplier
# Finds which supplier should be selected to place an order for a given part in
# a given region.
#
# Finds, in a given region, for each part of a certain type and size, the
# supplier who can supply it at minimum cost. If several suppliers in that
# region offer the desired part type and size at the same (minimum) cost, the
# query lists the parts from suppliers with the 100 highest account balances.
# For each supplier, the query lists the supplier's account balance, name and
# nation; the part's number and manufacturer; the supplier's address, phone
# number and comment information.
#
# TODO:
#   1. Join ordering
#   2. Push down equivalent column comparisons
#   3. Allow Select to be pushed below Ordinality used to add key column
#   4. Add decorrelation rule for Ordinality/RowKey
# --------------------------------------------------
save-tables database=tpch save-tables-prefix=q2
SELECT
    s_acctbal,
    s_name,
    n_name,
    p_partkey,
    p_mfgr,
    s_address,
    s_phone,
    s_comment
FROM
    part,
    supplier,
    partsupp,
    nation,
    region
WHERE
    p_partkey = ps_partkey
    AND s_suppkey = ps_suppkey
    AND p_size = 15
    AND p_type LIKE '%BRASS'
    AND s_nationkey = n_nationkey
    AND n_regionkey = r_regionkey
    AND r_name = 'EUROPE'
    AND ps_supplycost = (
        SELECT
            min(ps_supplycost)
        FROM
            partsupp,
            supplier,
            nation,
            region
        WHERE
            p_partkey = ps_partkey
            AND s_suppkey = ps_suppkey
            AND s_nationkey = n_nationkey
            AND n_regionkey = r_regionkey
            AND r_name = 'EUROPE'
    )
ORDER BY
    s_acctbal DESC,
    n_name,
    s_name,
    p_partkey
LIMIT 100;
----
project
 ├── save-table-name: q2_project_1
 ├── columns: s_acctbal:15(float!null) s_name:11(char!null) n_name:23(char!null) p_partkey:1(int!null) p_mfgr:3(char!null) s_address:12(varchar!null) s_phone:14(char!null) s_comment:16(varchar!null)
 ├── cardinality: [0 - 100]
 ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(11)=1, null(11)=0, distinct(12)=1, null(12)=0, distinct(14)=1, null(14)=0, distinct(15)=1, null(15)=0, distinct(16)=1, null(16)=0, distinct(23)=1, null(23)=0]
 ├── fd: (1)-->(3)
 ├── ordering: -15,+23,+11,+1
 └── limit
      ├── save-table-name: q2_limit_2
      ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:11(char!null) s_address:12(varchar!null) s_phone:14(char!null) s_acctbal:15(float!null) s_comment:16(varchar!null) ps_partkey:17(int!null) ps_suppkey:18(int!null) ps_supplycost:20(float!null) n_name:23(char!null) min:48(float!null)
      ├── internal-ordering: -15,+23,+11,+(1|17)
      ├── cardinality: [0 - 100]
      ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(11)=1, null(11)=0, distinct(12)=1, null(12)=0, distinct(14)=1, null(14)=0, distinct(15)=1, null(15)=0, distinct(16)=1, null(16)=0, distinct(17)=0.999910488, null(17)=0, distinct(18)=0.999982066, null(18)=0, distinct(20)=1, null(20)=0, distinct(23)=1, null(23)=0, distinct(48)=1, null(48)=0]
      ├── key: (17,18)
      ├── fd: (1)-->(3), (17,18)-->(1,3,11,12,14-16,20,23,48), (1)==(17), (17)==(1), (18)-->(11,12,14-16,23), (20)==(48), (48)==(20)
      ├── ordering: -15,+23,+11,+(1|17) [actual: -15,+23,+11,+1]
      ├── sort
      │    ├── save-table-name: q2_sort_3
      │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:11(char!null) s_address:12(varchar!null) s_phone:14(char!null) s_acctbal:15(float!null) s_comment:16(varchar!null) ps_partkey:17(int!null) ps_suppkey:18(int!null) ps_supplycost:20(float!null) n_name:23(char!null) min:48(float!null)
      │    ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(11)=1, null(11)=0, distinct(12)=1, null(12)=0, distinct(14)=1, null(14)=0, distinct(15)=1, null(15)=0, distinct(16)=1, null(16)=0, distinct(17)=0.999910488, null(17)=0, distinct(18)=0.999982066, null(18)=0, distinct(20)=1, null(20)=0, distinct(23)=1, null(23)=0, distinct(48)=1, null(48)=0]
      │    ├── key: (17,18)
      │    ├── fd: (1)-->(3), (17,18)-->(1,3,11,12,14-16,20,23,48), (1)==(17), (17)==(1), (18)-->(11,12,14-16,23), (20)==(48), (48)==(20)
      │    ├── ordering: -15,+23,+11,+(1|17) [actual: -15,+23,+11,+1]
      │    ├── limit hint: 100.00
      │    └── select
      │         ├── save-table-name: q2_select_4
      │         ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:11(char!null) s_address:12(varchar!null) s_phone:14(char!null) s_acctbal:15(float!null) s_comment:16(varchar!null) ps_partkey:17(int!null) ps_suppkey:18(int!null) ps_supplycost:20(float!null) n_name:23(char!null) min:48(float!null)
      │         ├── stats: [rows=1, distinct(1)=1, null(1)=0, distinct(3)=1, null(3)=0, distinct(11)=1, null(11)=0, distinct(12)=1, null(12)=0, distinct(14)=1, null(14)=0, distinct(15)=1, null(15)=0, distinct(16)=1, null(16)=0, distinct(17)=0.999910488, null(17)=0, distinct(18)=0.999982066, null(18)=0, distinct(20)=1, null(20)=0, distinct(23)=1, null(23)=0, distinct(48)=1, null(48)=0]
      │         ├── key: (17,18)
      │         ├── fd: (1)-->(3), (17,18)-->(1,3,11,12,14-16,20,23,48), (1)==(17), (17)==(1), (18)-->(11,12,14-16,23), (20)==(48), (48)==(20)
      │         ├── group-by
      │         │    ├── save-table-name: q2_group_by_5
      │         │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) s_name:11(char!null) s_address:12(varchar!null) s_phone:14(char!null) s_acctbal:15(float!null) s_comment:16(varchar!null) ps_partkey:17(int!null) ps_suppkey:18(int!null) ps_supplycost:20(float!null) n_name:23(char!null) min:48(float!null)
      │         │    ├── grouping columns: ps_partkey:17(int!null) ps_suppkey:18(int!null)
      │         │    ├── stats: [rows=1487.22799, distinct(1)=1487.22799, null(1)=0, distinct(3)=1487.22799, null(3)=0, distinct(11)=1487.22799, null(11)=0, distinct(12)=1487.22799, null(12)=0, distinct(14)=1487.22799, null(14)=0, distinct(15)=1487.22799, null(15)=0, distinct(16)=1487.22799, null(16)=0, distinct(17)=1174.55443, null(17)=0, distinct(18)=1411.92479, null(18)=0, distinct(20)=1487.22799, null(20)=0, distinct(23)=1487.22799, null(23)=0, distinct(48)=1487.22799, null(48)=0, distinct(17,18)=1487.22799, null(17,18)=0]
      │         │    ├── key: (17,18)
      │         │    ├── fd: (1)-->(3), (17,18)-->(1,3,11,12,14-16,20,23,48), (1)==(17), (17)==(1), (18)-->(11,12,14-16,23)
      │         │    ├── inner-join (hash)
      │         │    │    ├── save-table-name: q2_inner_join_6
      │         │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:10(int!null) s_name:11(char!null) s_address:12(varchar!null) s_nationkey:13(int!null) s_phone:14(char!null) s_acctbal:15(float!null) s_comment:16(varchar!null) ps_partkey:17(int!null) ps_suppkey:18(int!null) ps_supplycost:20(float!null) n_nationkey:22(int!null) n_name:23(char!null) n_regionkey:24(int!null) r_regionkey:26(int!null) r_name:27(char!null) ps_partkey:29(int!null) ps_suppkey:30(int!null) ps_supplycost:32(float!null) s_suppkey:34(int!null) s_nationkey:37(int!null) n_nationkey:41(int!null) n_regionkey:43(int!null) r_regionkey:45(int!null) r_name:46(char!null)
      │         │    │    ├── stats: [rows=2837.30948, distinct(1)=1333.31636, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=149.999649, null(5)=0, distinct(6)=1, null(6)=0, distinct(10)=1411.92479, null(10)=0, distinct(11)=1412.48485, null(11)=0, distinct(12)=1412.56423, null(12)=0, distinct(13)=5, null(13)=0, distinct(14)=1412.56423, null(14)=0, distinct(15)=1412.30169, null(15)=0, distinct(16)=1412.03742, null(16)=0, distinct(17)=1174.55443, null(17)=0, distinct(18)=1411.92479, null(18)=0, distinct(20)=1482.68691, null(20)=0, distinct(22)=5, null(22)=0, distinct(23)=5, null(23)=0, distinct(24)=1, null(24)=0, distinct(26)=1, null(26)=0, distinct(27)=0.996222107, null(27)=0, distinct(29)=1333.31636, null(29)=0, distinct(30)=1448.52495, null(30)=0, distinct(32)=2787.75127, null(32)=0, distinct(34)=1448.52495, null(34)=0, distinct(37)=5, null(37)=0, distinct(41)=5, null(41)=0, distinct(43)=1, null(43)=0, distinct(45)=1, null(45)=0, distinct(46)=0.996222107, null(46)=0, distinct(17,18)=1487.22799, null(17,18)=0]
      │         │    │    ├── key: (18,29,34)
      │         │    │    ├── fd: ()-->(6,27,46), (1)-->(3,5), (10)-->(11-16), (17,18)-->(20), (22)-->(23,24), (24)==(26), (26)==(24), (10)==(18), (18)==(10), (13)==(22), (22)==(13), (1)==(17,29), (17)==(1,29), (29,30)-->(32), (34)-->(37), (41)-->(43), (43)==(45), (45)==(43), (37)==(41), (41)==(37), (30)==(34), (34)==(30), (29)==(1,17)
      │         │    │    ├── inner-join (hash)
      │         │    │    │    ├── save-table-name: q2_inner_join_7
      │         │    │    │    ├── columns: ps_partkey:29(int!null) ps_suppkey:30(int!null) ps_supplycost:32(float!null) s_suppkey:34(int!null) s_nationkey:37(int!null) n_nationkey:41(int!null) n_regionkey:43(int!null) r_regionkey:45(int!null) r_name:46(char!null)
      │         │    │    │    ├── stats: [rows=161290.323, distinct(29)=110568.431, null(29)=0, distinct(30)=1844.80594, null(30)=0, distinct(32)=80252.0719, null(32)=0, distinct(34)=1844.80594, null(34)=0, distinct(37)=5, null(37)=0, distinct(41)=5, null(41)=0, distinct(43)=1, null(43)=0, distinct(45)=1, null(45)=0, distinct(46)=0.996222107, null(46)=0]
      │         │    │    │    ├── key: (29,34)
      │         │    │    │    ├── fd: ()-->(46), (29,30)-->(32), (34)-->(37), (41)-->(43), (43)==(45), (45)==(43), (37)==(41), (41)==(37), (30)==(34), (34)==(30)
      │         │    │    │    ├── scan partsupp
      │         │    │    │    │    ├── save-table-name: q2_scan_8
      │         │    │    │    │    ├── columns: ps_partkey:29(int!null) ps_suppkey:30(int!null) ps_supplycost:32(float!null)
      │         │    │    │    │    ├── stats: [rows=800000, distinct(29)=199241, null(29)=0, distinct(30)=9920, null(30)=0, distinct(32)=100379, null(32)=0]
      │         │    │    │    │    │   histogram(29)=  0 80  3920  80   3920   80   3920   80   3920   80   3840  160   3840  160   3920   80   3920   80   3920   80   3920   80   3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3840   160   3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3840   160   3920   80    3920   80    3920   160   3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    3920   160    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80
      │         │    │    │    │    │                 <--- 4 ------ 793 ------ 1856 ------ 2808 ------ 3809 ------ 4923 ------ 5975 ------ 6944 ------ 8085 ------ 8945 ------ 9831 ------ 10952 ------ 11932 ------ 12775 ------ 13849 ------ 14925 ------ 16016 ------ 16828 ------ 17768 ------ 18705 ------ 19631 ------ 20600 ------ 21491 ------ 22254 ------ 23327 ------ 24491 ------ 25470 ------ 26331 ------ 27327 ------ 28308 ------ 29359 ------ 30542 ------ 31592 ------ 32495 ------ 33408 ------ 34624 ------ 35726 ------ 36676 ------ 37637 ------ 38485 ------ 39368 ------ 40372 ------ 41034 ------ 42185 ------ 43333 ------ 44466 ------ 45440 ------ 46571 ------ 47469 ------ 48346 ------ 49379 ------ 50571 ------ 51830 ------ 52967 ------ 53673 ------ 54656 ------ 55504 ------ 56539 ------ 57393 ------ 58366 ------ 59577 ------ 60559 ------ 61676 ------ 62471 ------ 63421 ------ 64449 ------ 65409 ------ 66254 ------ 67127 ------ 68127 ------ 69177 ------ 70183 ------ 71209 ------ 72101 ------ 73102 ------ 73994 ------ 74899 ------ 76016 ------ 77098 ------ 77842 ------ 79137 ------ 80242 ------ 81364 ------ 82331 ------ 83158 ------ 84283 ------ 85282 ------ 86437 ------ 87450 ------ 88419 ------ 89493 ------ 90478 ------ 91468 ------ 92552 ------ 93200 ------ 94191 ------ 95067 ------ 96272 ------ 97228 ------ 98126 ------ 99198 ------ 100219 ------ 101057 ------ 102038 ------ 102775 ------ 103711 ------ 104623 ------ 105710 ------ 106734 ------ 107932 ------ 109255 ------ 110220 ------ 111235 ------ 112174 ------ 113260 ------ 114081 ------ 115103 ------ 115864 ------ 116794 ------ 117741 ------ 118712 ------ 119470 ------ 120528 ------ 121572 ------ 122536 ------ 123629 ------ 124404 ------ 125301 ------ 126257 ------ 127139 ------ 128267 ------ 129258 ------ 130442 ------ 131845 ------ 133164 ------ 134005 ------ 135076 ------ 135868 ------ 137297 ------ 138777 ------ 139806 ------ 140741 ------ 141896 ------ 142719 ------ 143727 ------ 144645 ------ 145510 ------ 146507 ------ 147449 ------ 148467 ------ 149635 ------ 150563 ------ 151751 ------ 152613 ------ 153416 ------ 154612 ------ 155853 ------ 156866 ------ 158311 ------ 159230 ------ 160390 ------ 161455 ------ 162555 ------ 163435 ------ 164549 ------ 165663 ------ 166891 ------ 167757 ------ 168732 ------ 169644 ------ 170532 ------ 171671 ------ 172778 ------ 173599 ------ 174321 ------ 175624 ------ 176663 ------ 177632 ------ 178555 ------ 179551 ------ 180510 ------ 181682 ------ 182648 ------ 183408 ------ 184543 ------ 185722 ------ 186713 ------ 187787 ------ 188730 ------ 189604 ------ 190711 ------ 191690 ------ 192692 ------ 193702 ------ 194685 ------ 195725 ------ 196730 ------ 197724 ------ 198701 ------ 199973
      │         │    │    │    │    │   histogram(30)=  0 80  3920 240  3920  80  3920  160  3920  80   3920  240  3920  80   3760  320  3680  320  3920  80   3920  160  3920  240  3920  80   3920  160  3840  160  3920  80   3920  80   3760  240  3840  160  3920  80   3840  160  3680  320   3920   80   3840  160   3840  160   3760  320   3840  160   3840  160   3920   80   3840  240   3920   80   3920   80   3840  160   3760  240   3920  160   3920   80   3920   80   3920   80   3920  320   3920   80   3920  160   3840  400   3760  240   3920  160   3920  160   3600  480   3920   80   3680  320   3840  160   3840  160   3920  240   3840  160   3920  160   3920   80   3920  160   3920   80   3760  240   3920   80   3920   80   3840  320   3840  160   3840  160   3920  240   3840  480   3920  160   3840  240   3920  160   3920  160   3920   80   3840  160   3920   80   3920   80   3920   80   3920   80   3840  240   3840  240   3920   80   3840  320   3920   80   3920   80   3920  240   3840  240   3920  160   3920   80   3840  160   3840  240   3920  240   3840   80   3680  320   3920  160   3840  160   3840   80   3920   80   3840  160   3840  160   3920   80   3920   80   3840  160   3920   80   3920  160   3840  240   3840   80   3840  160   3760  160   3920   80   3920   80   3840  240   3760  240   3840   80   3920  160   3840   80   3920   80   3920   80   3920   80   3920  160   3840   80   3920   80   3760  240   3920   80   3920  160   3760  160   3920  160   3840   80   3920  160   3840  160   3840  160   3600  320   3920  160   3840   80   3920   80   3680  320   3840  240   3760  160   3920   80   3920   80   3920   80   3920   80   3920   80   3680  320   3920  160   3840  160   3760  160   3920  240   3840  160   3840  240   3600  320   3840   80   3840   80   3920  160   3760  160   3840  160   3840  320   3840   80   3840  160   3760  240   3840   80   3840  240   3760  160   3840  160   3840  160   3920  240   3760  160   3840   80   3920  160   3680  240   3840  160   3840  160   3760  240   3920   80   3920  240   3760  160   3760  240   3840   80   3840  240   3840  240   3760  320   3760  240   3840   80   3840  160   3840  240   3760  320   3760  160   3840  160   3840  160   3840   80   3760  160   3840   80   3840  160   3920  160   3840   80   3920   80   3840  160   3920   80   3840  240   3840   80   3920   80   3760  240   3920  240   3840   80   3680   240
      │         │    │    │    │    │                 <--- 2 ------ 49 ------ 90 ------ 141 ------ 183 ------ 235 ------ 278 ------ 319 ------ 360 ------ 406 ------ 458 ------ 511 ------ 561 ------ 622 ------ 674 ------ 731 ------ 781 ------ 822 ------ 882 ------ 934 ------ 988 ------ 1026 ------ 1072 ------ 1114 ------ 1188 ------ 1245 ------ 1291 ------ 1335 ------ 1380 ------ 1433 ------ 1488 ------ 1537 ------ 1590 ------ 1642 ------ 1692 ------ 1751 ------ 1807 ------ 1846 ------ 1887 ------ 1939 ------ 1994 ------ 2045 ------ 2097 ------ 2139 ------ 2190 ------ 2240 ------ 2293 ------ 2344 ------ 2385 ------ 2427 ------ 2484 ------ 2538 ------ 2601 ------ 2651 ------ 2730 ------ 2781 ------ 2825 ------ 2874 ------ 2938 ------ 2978 ------ 3034 ------ 3086 ------ 3139 ------ 3179 ------ 3231 ------ 3274 ------ 3334 ------ 3387 ------ 3431 ------ 3477 ------ 3530 ------ 3581 ------ 3633 ------ 3680 ------ 3725 ------ 3775 ------ 3820 ------ 3876 ------ 3923 ------ 3982 ------ 4036 ------ 4078 ------ 4116 ------ 4183 ------ 4227 ------ 4275 ------ 4336 ------ 4376 ------ 4424 ------ 4481 ------ 4537 ------ 4582 ------ 4630 ------ 4680 ------ 4727 ------ 4779 ------ 4828 ------ 4881 ------ 4938 ------ 4986 ------ 5040 ------ 5087 ------ 5138 ------ 5188 ------ 5237 ------ 5280 ------ 5318 ------ 5358 ------ 5405 ------ 5459 ------ 5516 ------ 5561 ------ 5615 ------ 5681 ------ 5744 ------ 5790 ------ 5847 ------ 5885 ------ 5927 ------ 5991 ------ 6042 ------ 6111 ------ 6165 ------ 6207 ------ 6259 ------ 6313 ------ 6359 ------ 6418 ------ 6471 ------ 6530 ------ 6587 ------ 6626 ------ 6672 ------ 6739 ------ 6784 ------ 6837 ------ 6886 ------ 6952 ------ 6994 ------ 7040 ------ 7081 ------ 7134 ------ 7178 ------ 7232 ------ 7280 ------ 7330 ------ 7378 ------ 7435 ------ 7486 ------ 7537 ------ 7593 ------ 7636 ------ 7680 ------ 7737 ------ 7788 ------ 7836 ------ 7877 ------ 7928 ------ 7993 ------ 8036 ------ 8083 ------ 8135 ------ 8180 ------ 8221 ------ 8263 ------ 8313 ------ 8352 ------ 8399 ------ 8453 ------ 8517 ------ 8566 ------ 8612 ------ 8664 ------ 8716 ------ 8766 ------ 8821 ------ 8871 ------ 8922 ------ 8956 ------ 9007 ------ 9050 ------ 9100 ------ 9154 ------ 9203 ------ 9246 ------ 9311 ------ 9358 ------ 9407 ------ 9470 ------ 9525 ------ 9564 ------ 9633 ------ 9672 ------ 9730 ------ 9778 ------ 9824 ------ 9868 ------ 9919 ------ 9959 ------ 10000
      │         │    │    │    │    ├── key: (29,30)
      │         │    │    │    │    └── fd: (29,30)-->(32)
      │         │    │    │    ├── inner-join (lookup supplier@s_nk)
      │         │    │    │    │    ├── save-table-name: q2_lookup_join_9
      │         │    │    │    │    ├── columns: s_suppkey:34(int!null) s_nationkey:37(int!null) n_nationkey:41(int!null) n_regionkey:43(int!null) r_regionkey:45(int!null) r_name:46(char!null)
      │         │    │    │    │    ├── key columns: [41] = [37]
      │         │    │    │    │    ├── stats: [rows=2000, distinct(34)=1844.80594, null(34)=0, distinct(37)=5, null(37)=0, distinct(41)=5, null(41)=0, distinct(43)=1, null(43)=0, distinct(45)=1, null(45)=0, distinct(46)=0.996222107, null(46)=0]
      │         │    │    │    │    ├── key: (34)
      │         │    │    │    │    ├── fd: ()-->(46), (34)-->(37), (41)-->(43), (43)==(45), (45)==(43), (37)==(41), (41)==(37)
      │         │    │    │    │    ├── inner-join (merge)
      │         │    │    │    │    │    ├── save-table-name: q2_merge_join_10
      │         │    │    │    │    │    ├── columns: n_nationkey:41(int!null) n_regionkey:43(int!null) r_regionkey:45(int!null) r_name:46(char!null)
      │         │    │    │    │    │    ├── left ordering: +43
      │         │    │    │    │    │    ├── right ordering: +45
      │         │    │    │    │    │    ├── stats: [rows=5, distinct(41)=5, null(41)=0, distinct(43)=1, null(43)=0, distinct(45)=1, null(45)=0, distinct(46)=0.996222107, null(46)=0]
      │         │    │    │    │    │    ├── key: (41)
      │         │    │    │    │    │    ├── fd: ()-->(46), (41)-->(43), (43)==(45), (45)==(43)
      │         │    │    │    │    │    ├── scan nation@n_rk
      │         │    │    │    │    │    │    ├── save-table-name: q2_scan_11
      │         │    │    │    │    │    │    ├── columns: n_nationkey:41(int!null) n_regionkey:43(int!null)
      │         │    │    │    │    │    │    ├── stats: [rows=25, distinct(41)=25, null(41)=0, distinct(43)=5, null(43)=0]
      │         │    │    │    │    │    │    │   histogram(41)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │         │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │         │    │    │    │    │    │    │   histogram(43)=  0  5  0  5  0  5  0  5  0  5
      │         │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    ├── key: (41)
      │         │    │    │    │    │    │    ├── fd: (41)-->(43)
      │         │    │    │    │    │    │    └── ordering: +43
      │         │    │    │    │    │    ├── select
      │         │    │    │    │    │    │    ├── save-table-name: q2_select_12
      │         │    │    │    │    │    │    ├── columns: r_regionkey:45(int!null) r_name:46(char!null)
      │         │    │    │    │    │    │    ├── stats: [rows=1, distinct(45)=1, null(45)=0, distinct(46)=1, null(46)=0]
      │         │    │    │    │    │    │    ├── key: (45)
      │         │    │    │    │    │    │    ├── fd: ()-->(46)
      │         │    │    │    │    │    │    ├── ordering: +45 opt(46) [actual: +45]
      │         │    │    │    │    │    │    ├── scan region
      │         │    │    │    │    │    │    │    ├── save-table-name: q2_scan_13
      │         │    │    │    │    │    │    │    ├── columns: r_regionkey:45(int!null) r_name:46(char!null)
      │         │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(45)=5, null(45)=0, distinct(46)=5, null(46)=0]
      │         │    │    │    │    │    │    │    │   histogram(45)=  0  1  0  1  0  1  0  1  0  1
      │         │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    │    ├── key: (45)
      │         │    │    │    │    │    │    │    ├── fd: (45)-->(46)
      │         │    │    │    │    │    │    │    └── ordering: +45 opt(46) [actual: +45]
      │         │    │    │    │    │    │    └── filters
      │         │    │    │    │    │    │         └── r_name:46 = 'EUROPE' [type=bool, outer=(46), constraints=(/46: [/'EUROPE' - /'EUROPE']; tight), fd=()-->(46)]
      │         │    │    │    │    │    └── filters (true)
      │         │    │    │    │    └── filters (true)
      │         │    │    │    └── filters
      │         │    │    │         └── s_suppkey:34 = ps_suppkey:30 [type=bool, outer=(30,34), constraints=(/30: (/NULL - ]; /34: (/NULL - ]), fd=(30)==(34), (34)==(30)]
      │         │    │    ├── inner-join (hash)
      │         │    │    │    ├── save-table-name: q2_inner_join_14
      │         │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null) s_suppkey:10(int!null) s_name:11(char!null) s_address:12(varchar!null) s_nationkey:13(int!null) s_phone:14(char!null) s_acctbal:15(float!null) s_comment:16(varchar!null) ps_partkey:17(int!null) ps_suppkey:18(int!null) ps_supplycost:20(float!null) n_nationkey:22(int!null) n_name:23(char!null) n_regionkey:24(int!null) r_regionkey:26(int!null) r_name:27(char!null)
      │         │    │    │    ├── stats: [rows=1945.04451, distinct(1)=1333.31636, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=149.99965, null(5)=0, distinct(6)=1, null(6)=0, distinct(10)=1766.2414, null(10)=0, distinct(11)=1767.4156, null(11)=0, distinct(12)=1767.58209, null(12)=0, distinct(13)=5, null(13)=0, distinct(14)=1767.58209, null(14)=0, distinct(15)=1767.03149, null(15)=0, distinct(16)=1766.47747, null(16)=0, distinct(17)=1333.31636, null(17)=0, distinct(18)=1766.2414, null(18)=0, distinct(20)=1921.6712, null(20)=0, distinct(22)=5, null(22)=0, distinct(23)=5, null(23)=0, distinct(24)=1, null(24)=0, distinct(26)=1, null(26)=0, distinct(27)=0.996222107, null(27)=0, distinct(17,18)=1932.16064, null(17,18)=0]
      │         │    │    │    ├── key: (17,18)
      │         │    │    │    ├── fd: ()-->(6,27), (1)-->(3,5), (10)-->(11-16), (17,18)-->(20), (22)-->(23,24), (24)==(26), (26)==(24), (10)==(18), (18)==(10), (13)==(22), (22)==(13), (1)==(17), (17)==(1)
      │         │    │    │    ├── inner-join (hash)
      │         │    │    │    │    ├── save-table-name: q2_inner_join_15
      │         │    │    │    │    ├── columns: s_suppkey:10(int!null) s_name:11(char!null) s_address:12(varchar!null) s_nationkey:13(int!null) s_phone:14(char!null) s_acctbal:15(float!null) s_comment:16(varchar!null) ps_partkey:17(int!null) ps_suppkey:18(int!null) ps_supplycost:20(float!null) n_nationkey:22(int!null) n_name:23(char!null) n_regionkey:24(int!null) r_regionkey:26(int!null) r_name:27(char!null)
      │         │    │    │    │    ├── stats: [rows=161290.323, distinct(10)=9920, null(10)=0, distinct(11)=9989.99903, null(11)=0, distinct(12)=9999.99901, null(12)=0, distinct(13)=5, null(13)=0, distinct(14)=9999.99901, null(14)=0, distinct(15)=9966.99907, null(15)=0, distinct(16)=9933.99912, null(16)=0, distinct(17)=110564.957, null(17)=0, distinct(18)=9920, null(18)=0, distinct(20)=80250.5069, null(20)=0, distinct(22)=5, null(22)=0, distinct(23)=5, null(23)=0, distinct(24)=1, null(24)=0, distinct(26)=1, null(26)=0, distinct(27)=0.996222107, null(27)=0, distinct(17,18)=146071.239, null(17,18)=0]
      │         │    │    │    │    ├── key: (17,18)
      │         │    │    │    │    ├── fd: ()-->(27), (10)-->(11-16), (17,18)-->(20), (22)-->(23,24), (24)==(26), (26)==(24), (10)==(18), (18)==(10), (13)==(22), (22)==(13)
      │         │    │    │    │    ├── scan partsupp
      │         │    │    │    │    │    ├── save-table-name: q2_scan_16
      │         │    │    │    │    │    ├── columns: ps_partkey:17(int!null) ps_suppkey:18(int!null) ps_supplycost:20(float!null)
      │         │    │    │    │    │    ├── stats: [rows=800000, distinct(17)=199241, null(17)=0, distinct(18)=9920, null(18)=0, distinct(20)=100379, null(20)=0, distinct(17,18)=800000, null(17,18)=0]
      │         │    │    │    │    │    │   histogram(17)=  0 80  3920  80   3920   80   3920   80   3920   80   3840  160   3840  160   3920   80   3920   80   3920   80   3920   80   3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3840   160   3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3840   160   3920   80    3920   80    3920   160   3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   160   3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920   80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    3920    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    3920   160    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80    4000    80
      │         │    │    │    │    │    │                 <--- 4 ------ 793 ------ 1856 ------ 2808 ------ 3809 ------ 4923 ------ 5975 ------ 6944 ------ 8085 ------ 8945 ------ 9831 ------ 10952 ------ 11932 ------ 12775 ------ 13849 ------ 14925 ------ 16016 ------ 16828 ------ 17768 ------ 18705 ------ 19631 ------ 20600 ------ 21491 ------ 22254 ------ 23327 ------ 24491 ------ 25470 ------ 26331 ------ 27327 ------ 28308 ------ 29359 ------ 30542 ------ 31592 ------ 32495 ------ 33408 ------ 34624 ------ 35726 ------ 36676 ------ 37637 ------ 38485 ------ 39368 ------ 40372 ------ 41034 ------ 42185 ------ 43333 ------ 44466 ------ 45440 ------ 46571 ------ 47469 ------ 48346 ------ 49379 ------ 50571 ------ 51830 ------ 52967 ------ 53673 ------ 54656 ------ 55504 ------ 56539 ------ 57393 ------ 58366 ------ 59577 ------ 60559 ------ 61676 ------ 62471 ------ 63421 ------ 64449 ------ 65409 ------ 66254 ------ 67127 ------ 68127 ------ 69177 ------ 70183 ------ 71209 ------ 72101 ------ 73102 ------ 73994 ------ 74899 ------ 76016 ------ 77098 ------ 77842 ------ 79137 ------ 80242 ------ 81364 ------ 82331 ------ 83158 ------ 84283 ------ 85282 ------ 86437 ------ 87450 ------ 88419 ------ 89493 ------ 90478 ------ 91468 ------ 92552 ------ 93200 ------ 94191 ------ 95067 ------ 96272 ------ 97228 ------ 98126 ------ 99198 ------ 100219 ------ 101057 ------ 102038 ------ 102775 ------ 103711 ------ 104623 ------ 105710 ------ 106734 ------ 107932 ------ 109255 ------ 110220 ------ 111235 ------ 112174 ------ 113260 ------ 114081 ------ 115103 ------ 115864 ------ 116794 ------ 117741 ------ 118712 ------ 119470 ------ 120528 ------ 121572 ------ 122536 ------ 123629 ------ 124404 ------ 125301 ------ 126257 ------ 127139 ------ 128267 ------ 129258 ------ 130442 ------ 131845 ------ 133164 ------ 134005 ------ 135076 ------ 135868 ------ 137297 ------ 138777 ------ 139806 ------ 140741 ------ 141896 ------ 142719 ------ 143727 ------ 144645 ------ 145510 ------ 146507 ------ 147449 ------ 148467 ------ 149635 ------ 150563 ------ 151751 ------ 152613 ------ 153416 ------ 154612 ------ 155853 ------ 156866 ------ 158311 ------ 159230 ------ 160390 ------ 161455 ------ 162555 ------ 163435 ------ 164549 ------ 165663 ------ 166891 ------ 167757 ------ 168732 ------ 169644 ------ 170532 ------ 171671 ------ 172778 ------ 173599 ------ 174321 ------ 175624 ------ 176663 ------ 177632 ------ 178555 ------ 179551 ------ 180510 ------ 181682 ------ 182648 ------ 183408 ------ 184543 ------ 185722 ------ 186713 ------ 187787 ------ 188730 ------ 189604 ------ 190711 ------ 191690 ------ 192692 ------ 193702 ------ 194685 ------ 195725 ------ 196730 ------ 197724 ------ 198701 ------ 199973
      │         │    │    │    │    │    │   histogram(18)=  0 80  3920 240  3920  80  3920  160  3920  80   3920  240  3920  80   3760  320  3680  320  3920  80   3920  160  3920  240  3920  80   3920  160  3840  160  3920  80   3920  80   3760  240  3840  160  3920  80   3840  160  3680  320   3920   80   3840  160   3840  160   3760  320   3840  160   3840  160   3920   80   3840  240   3920   80   3920   80   3840  160   3760  240   3920  160   3920   80   3920   80   3920   80   3920  320   3920   80   3920  160   3840  400   3760  240   3920  160   3920  160   3600  480   3920   80   3680  320   3840  160   3840  160   3920  240   3840  160   3920  160   3920   80   3920  160   3920   80   3760  240   3920   80   3920   80   3840  320   3840  160   3840  160   3920  240   3840  480   3920  160   3840  240   3920  160   3920  160   3920   80   3840  160   3920   80   3920   80   3920   80   3920   80   3840  240   3840  240   3920   80   3840  320   3920   80   3920   80   3920  240   3840  240   3920  160   3920   80   3840  160   3840  240   3920  240   3840   80   3680  320   3920  160   3840  160   3840   80   3920   80   3840  160   3840  160   3920   80   3920   80   3840  160   3920   80   3920  160   3840  240   3840   80   3840  160   3760  160   3920   80   3920   80   3840  240   3760  240   3840   80   3920  160   3840   80   3920   80   3920   80   3920   80   3920  160   3840   80   3920   80   3760  240   3920   80   3920  160   3760  160   3920  160   3840   80   3920  160   3840  160   3840  160   3600  320   3920  160   3840   80   3920   80   3680  320   3840  240   3760  160   3920   80   3920   80   3920   80   3920   80   3920   80   3680  320   3920  160   3840  160   3760  160   3920  240   3840  160   3840  240   3600  320   3840   80   3840   80   3920  160   3760  160   3840  160   3840  320   3840   80   3840  160   3760  240   3840   80   3840  240   3760  160   3840  160   3840  160   3920  240   3760  160   3840   80   3920  160   3680  240   3840  160   3840  160   3760  240   3920   80   3920  240   3760  160   3760  240   3840   80   3840  240   3840  240   3760  320   3760  240   3840   80   3840  160   3840  240   3760  320   3760  160   3840  160   3840  160   3840   80   3760  160   3840   80   3840  160   3920  160   3840   80   3920   80   3840  160   3920   80   3840  240   3840   80   3920   80   3760  240   3920  240   3840   80   3680   240
      │         │    │    │    │    │    │                 <--- 2 ------ 49 ------ 90 ------ 141 ------ 183 ------ 235 ------ 278 ------ 319 ------ 360 ------ 406 ------ 458 ------ 511 ------ 561 ------ 622 ------ 674 ------ 731 ------ 781 ------ 822 ------ 882 ------ 934 ------ 988 ------ 1026 ------ 1072 ------ 1114 ------ 1188 ------ 1245 ------ 1291 ------ 1335 ------ 1380 ------ 1433 ------ 1488 ------ 1537 ------ 1590 ------ 1642 ------ 1692 ------ 1751 ------ 1807 ------ 1846 ------ 1887 ------ 1939 ------ 1994 ------ 2045 ------ 2097 ------ 2139 ------ 2190 ------ 2240 ------ 2293 ------ 2344 ------ 2385 ------ 2427 ------ 2484 ------ 2538 ------ 2601 ------ 2651 ------ 2730 ------ 2781 ------ 2825 ------ 2874 ------ 2938 ------ 2978 ------ 3034 ------ 3086 ------ 3139 ------ 3179 ------ 3231 ------ 3274 ------ 3334 ------ 3387 ------ 3431 ------ 3477 ------ 3530 ------ 3581 ------ 3633 ------ 3680 ------ 3725 ------ 3775 ------ 3820 ------ 3876 ------ 3923 ------ 3982 ------ 4036 ------ 4078 ------ 4116 ------ 4183 ------ 4227 ------ 4275 ------ 4336 ------ 4376 ------ 4424 ------ 4481 ------ 4537 ------ 4582 ------ 4630 ------ 4680 ------ 4727 ------ 4779 ------ 4828 ------ 4881 ------ 4938 ------ 4986 ------ 5040 ------ 5087 ------ 5138 ------ 5188 ------ 5237 ------ 5280 ------ 5318 ------ 5358 ------ 5405 ------ 5459 ------ 5516 ------ 5561 ------ 5615 ------ 5681 ------ 5744 ------ 5790 ------ 5847 ------ 5885 ------ 5927 ------ 5991 ------ 6042 ------ 6111 ------ 6165 ------ 6207 ------ 6259 ------ 6313 ------ 6359 ------ 6418 ------ 6471 ------ 6530 ------ 6587 ------ 6626 ------ 6672 ------ 6739 ------ 6784 ------ 6837 ------ 6886 ------ 6952 ------ 6994 ------ 7040 ------ 7081 ------ 7134 ------ 7178 ------ 7232 ------ 7280 ------ 7330 ------ 7378 ------ 7435 ------ 7486 ------ 7537 ------ 7593 ------ 7636 ------ 7680 ------ 7737 ------ 7788 ------ 7836 ------ 7877 ------ 7928 ------ 7993 ------ 8036 ------ 8083 ------ 8135 ------ 8180 ------ 8221 ------ 8263 ------ 8313 ------ 8352 ------ 8399 ------ 8453 ------ 8517 ------ 8566 ------ 8612 ------ 8664 ------ 8716 ------ 8766 ------ 8821 ------ 8871 ------ 8922 ------ 8956 ------ 9007 ------ 9050 ------ 9100 ------ 9154 ------ 9203 ------ 9246 ------ 9311 ------ 9358 ------ 9407 ------ 9470 ------ 9525 ------ 9564 ------ 9633 ------ 9672 ------ 9730 ------ 9778 ------ 9824 ------ 9868 ------ 9919 ------ 9959 ------ 10000
      │         │    │    │    │    │    ├── key: (17,18)
      │         │    │    │    │    │    └── fd: (17,18)-->(20)
      │         │    │    │    │    ├── inner-join (hash)
      │         │    │    │    │    │    ├── save-table-name: q2_inner_join_17
      │         │    │    │    │    │    ├── columns: s_suppkey:10(int!null) s_name:11(char!null) s_address:12(varchar!null) s_nationkey:13(int!null) s_phone:14(char!null) s_acctbal:15(float!null) s_comment:16(varchar!null) n_nationkey:22(int!null) n_name:23(char!null) n_regionkey:24(int!null) r_regionkey:26(int!null) r_name:27(char!null)
      │         │    │    │    │    │    ├── stats: [rows=2000, distinct(10)=1844.80594, null(10)=0, distinct(11)=1846.09084, null(11)=0, distinct(12)=1846.27302, null(12)=0, distinct(13)=5, null(13)=0, distinct(14)=1846.27302, null(14)=0, distinct(15)=1845.67052, null(15)=0, distinct(16)=1845.06427, null(16)=0, distinct(22)=5, null(22)=0, distinct(23)=5, null(23)=0, distinct(24)=1, null(24)=0, distinct(26)=1, null(26)=0, distinct(27)=0.996222107, null(27)=0]
      │         │    │    │    │    │    ├── key: (10)
      │         │    │    │    │    │    ├── fd: ()-->(27), (22)-->(23,24), (24)==(26), (26)==(24), (10)-->(11-16), (13)==(22), (22)==(13)
      │         │    │    │    │    │    ├── scan supplier
      │         │    │    │    │    │    │    ├── save-table-name: q2_scan_18
      │         │    │    │    │    │    │    ├── columns: s_suppkey:10(int!null) s_name:11(char!null) s_address:12(varchar!null) s_nationkey:13(int!null) s_phone:14(char!null) s_acctbal:15(float!null) s_comment:16(varchar!null)
      │         │    │    │    │    │    │    ├── stats: [rows=10000, distinct(10)=9920, null(10)=0, distinct(11)=9990, null(11)=0, distinct(12)=10000, null(12)=0, distinct(13)=25, null(13)=0, distinct(14)=10000, null(14)=0, distinct(15)=9967, null(15)=0, distinct(16)=9934, null(16)=0]
      │         │    │    │    │    │    │    │   histogram(10)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50    1
      │         │    │    │    │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │         │    │    │    │    │    │    │   histogram(13)=  0 420 0 413 0 397 0 412 0 415 0 380 0 402 0 396 0 415 0 405 0 393  0 438  0 377  0 362  0 376  0 373  0 406  0 421  0 407  0 398  0 411  0 399  0 401  0 390  0 393
      │         │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │         │    │    │    │    │    │    ├── key: (10)
      │         │    │    │    │    │    │    └── fd: (10)-->(11-16)
      │         │    │    │    │    │    ├── inner-join (hash)
      │         │    │    │    │    │    │    ├── save-table-name: q2_inner_join_19
      │         │    │    │    │    │    │    ├── columns: n_nationkey:22(int!null) n_name:23(char!null) n_regionkey:24(int!null) r_regionkey:26(int!null) r_name:27(char!null)
      │         │    │    │    │    │    │    ├── stats: [rows=5, distinct(22)=5, null(22)=0, distinct(23)=5, null(23)=0, distinct(24)=1, null(24)=0, distinct(26)=1, null(26)=0, distinct(27)=0.996222107, null(27)=0]
      │         │    │    │    │    │    │    ├── key: (22)
      │         │    │    │    │    │    │    ├── fd: ()-->(27), (22)-->(23,24), (24)==(26), (26)==(24)
      │         │    │    │    │    │    │    ├── scan nation
      │         │    │    │    │    │    │    │    ├── save-table-name: q2_scan_20
      │         │    │    │    │    │    │    │    ├── columns: n_nationkey:22(int!null) n_name:23(char!null) n_regionkey:24(int!null)
      │         │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(22)=25, null(22)=0, distinct(23)=25, null(23)=0, distinct(24)=5, null(24)=0]
      │         │    │    │    │    │    │    │    │   histogram(22)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │         │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │         │    │    │    │    │    │    │    │   histogram(24)=  0  5  0  5  0  5  0  5  0  5
      │         │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    │    ├── key: (22)
      │         │    │    │    │    │    │    │    └── fd: (22)-->(23,24)
      │         │    │    │    │    │    │    ├── select
      │         │    │    │    │    │    │    │    ├── save-table-name: q2_select_21
      │         │    │    │    │    │    │    │    ├── columns: r_regionkey:26(int!null) r_name:27(char!null)
      │         │    │    │    │    │    │    │    ├── stats: [rows=1, distinct(26)=1, null(26)=0, distinct(27)=1, null(27)=0]
      │         │    │    │    │    │    │    │    ├── key: (26)
      │         │    │    │    │    │    │    │    ├── fd: ()-->(27)
      │         │    │    │    │    │    │    │    ├── scan region
      │         │    │    │    │    │    │    │    │    ├── save-table-name: q2_scan_22
      │         │    │    │    │    │    │    │    │    ├── columns: r_regionkey:26(int!null) r_name:27(char!null)
      │         │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(26)=5, null(26)=0, distinct(27)=5, null(27)=0]
      │         │    │    │    │    │    │    │    │    │   histogram(26)=  0  1  0  1  0  1  0  1  0  1
      │         │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │         │    │    │    │    │    │    │    │    ├── key: (26)
      │         │    │    │    │    │    │    │    │    └── fd: (26)-->(27)
      │         │    │    │    │    │    │    │    └── filters
      │         │    │    │    │    │    │    │         └── r_name:27 = 'EUROPE' [type=bool, outer=(27), constraints=(/27: [/'EUROPE' - /'EUROPE']; tight), fd=()-->(27)]
      │         │    │    │    │    │    │    └── filters
      │         │    │    │    │    │    │         └── n_regionkey:24 = r_regionkey:26 [type=bool, outer=(24,26), constraints=(/24: (/NULL - ]; /26: (/NULL - ]), fd=(24)==(26), (26)==(24)]
      │         │    │    │    │    │    └── filters
      │         │    │    │    │    │         └── s_nationkey:13 = n_nationkey:22 [type=bool, outer=(13,22), constraints=(/13: (/NULL - ]; /22: (/NULL - ]), fd=(13)==(22), (22)==(13)]
      │         │    │    │    │    └── filters
      │         │    │    │    │         └── s_suppkey:10 = ps_suppkey:18 [type=bool, outer=(10,18), constraints=(/10: (/NULL - ]; /18: (/NULL - ]), fd=(10)==(18), (18)==(10)]
      │         │    │    │    ├── select
      │         │    │    │    │    ├── save-table-name: q2_select_23
      │         │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null)
      │         │    │    │    │    ├── stats: [rows=1333.33333, distinct(1)=1333.31636, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=1, null(6)=0]
      │         │    │    │    │    ├── key: (1)
      │         │    │    │    │    ├── fd: ()-->(6), (1)-->(3,5)
      │         │    │    │    │    ├── scan part
      │         │    │    │    │    │    ├── save-table-name: q2_scan_24
      │         │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_mfgr:3(char!null) p_type:5(varchar!null) p_size:6(int!null)
      │         │    │    │    │    │    ├── stats: [rows=200000, distinct(1)=199241, null(1)=0, distinct(3)=5, null(3)=0, distinct(5)=150, null(5)=0, distinct(6)=50, null(6)=0]
      │         │    │    │    │    │    │   histogram(1)=  0  20  980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20
      │         │    │    │    │    │    │                <--- 27 ----- 1110 ----- 2241 ----- 3086 ----- 4134 ----- 5302 ----- 6222 ----- 7308 ----- 8249 ----- 9171 ----- 10049 ----- 10958 ----- 11832 ----- 13025 ----- 14063 ----- 14953 ----- 16249 ----- 17419 ----- 18363 ----- 19412 ----- 20257 ----- 21190 ----- 22110 ----- 23045 ----- 23956 ----- 24962 ----- 25942 ----- 26990 ----- 27934 ----- 28876 ----- 29513 ----- 30326 ----- 31259 ----- 32300 ----- 33577 ----- 34550 ----- 35562 ----- 36498 ----- 37475 ----- 38584 ----- 39641 ----- 40548 ----- 41605 ----- 42527 ----- 43612 ----- 44702 ----- 45701 ----- 46726 ----- 47795 ----- 48935 ----- 50152 ----- 51183 ----- 52001 ----- 52904 ----- 53868 ----- 54808 ----- 55986 ----- 57155 ----- 58516 ----- 59526 ----- 60557 ----- 61547 ----- 62369 ----- 63672 ----- 64583 ----- 65360 ----- 66147 ----- 67201 ----- 68142 ----- 69145 ----- 70209 ----- 71141 ----- 71923 ----- 73031 ----- 73987 ----- 74974 ----- 76170 ----- 77138 ----- 77849 ----- 78931 ----- 79832 ----- 80761 ----- 81843 ----- 82834 ----- 84032 ----- 85072 ----- 86287 ----- 87302 ----- 88422 ----- 89432 ----- 90550 ----- 91463 ----- 92249 ----- 93385 ----- 94789 ----- 96013 ----- 96893 ----- 98000 ----- 99008 ----- 100166 ----- 101263 ----- 102351 ----- 103236 ----- 104121 ----- 105363 ----- 106329 ----- 107325 ----- 108231 ----- 109054 ----- 110019 ----- 111185 ----- 112112 ----- 112908 ----- 113904 ----- 114785 ----- 115410 ----- 116526 ----- 117559 ----- 118310 ----- 119073 ----- 120034 ----- 120817 ----- 121744 ----- 122566 ----- 123720 ----- 124813 ----- 125835 ----- 126622 ----- 127651 ----- 128328 ----- 129315 ----- 130244 ----- 131450 ----- 132439 ----- 133288 ----- 134164 ----- 135298 ----- 136347 ----- 137243 ----- 138256 ----- 139427 ----- 140374 ----- 141371 ----- 142302 ----- 143322 ----- 144335 ----- 145333 ----- 146212 ----- 147321 ----- 148591 ----- 149594 ------ 150514 ------ 151361 ------ 152059 ------ 153070 ------ 154059 ------ 155259 ------ 156473 ------ 157690 ------ 158703 ------ 159675 ------ 160597 ------ 161668 ------ 162737 ------ 163955 ------ 164942 ------ 165924 ------ 167059 ------ 167866 ------ 169034 ------ 169935 ------ 170712 ------ 171806 ------ 172841 ------ 174078 ------ 175347 ------ 176430 ------ 177346 ------ 178566 ------ 179515 ------ 180677 ------ 181729 ------ 182983 ------ 183814 ------ 184892 ------ 185696 ------ 186611 ------ 187744 ------ 188974 ------ 189911 ------ 190671 ------ 191607 ------ 192820 ------ 193789 ------ 195057 ------ 196224 ------ 197231 ------ 198281 ------ 199119 ------ 199999
      │         │    │    │    │    │    ├── key: (1)
      │         │    │    │    │    │    └── fd: (1)-->(3,5,6)
      │         │    │    │    │    └── filters
      │         │    │    │    │         ├── p_size:6 = 15 [type=bool, outer=(6), constraints=(/6: [/15 - /15]; tight), fd=()-->(6)]
      │         │    │    │    │         └── p_type:5 LIKE '%BRASS' [type=bool, outer=(5), constraints=(/5: (/NULL - ])]
      │         │    │    │    └── filters
      │         │    │    │         └── p_partkey:1 = ps_partkey:17 [type=bool, outer=(1,17), constraints=(/1: (/NULL - ]; /17: (/NULL - ]), fd=(1)==(17), (17)==(1)]
      │         │    │    └── filters
      │         │    │         └── p_partkey:1 = ps_partkey:29 [type=bool, outer=(1,29), constraints=(/1: (/NULL - ]; /29: (/NULL - ]), fd=(1)==(29), (29)==(1)]
      │         │    └── aggregations
      │         │         ├── min [as=min:48, type=float, outer=(32)]
      │         │         │    └── ps_supplycost:32 [type=float]
      │         │         ├── const-agg [as=s_name:11, type=char, outer=(11)]
      │         │         │    └── s_name:11 [type=char]
      │         │         ├── const-agg [as=s_address:12, type=varchar, outer=(12)]
      │         │         │    └── s_address:12 [type=varchar]
      │         │         ├── const-agg [as=s_phone:14, type=char, outer=(14)]
      │         │         │    └── s_phone:14 [type=char]
      │         │         ├── const-agg [as=s_acctbal:15, type=float, outer=(15)]
      │         │         │    └── s_acctbal:15 [type=float]
      │         │         ├── const-agg [as=s_comment:16, type=varchar, outer=(16)]
      │         │         │    └── s_comment:16 [type=varchar]
      │         │         ├── const-agg [as=ps_supplycost:20, type=float, outer=(20)]
      │         │         │    └── ps_supplycost:20 [type=float]
      │         │         ├── const-agg [as=n_name:23, type=char, outer=(23)]
      │         │         │    └── n_name:23 [type=char]
      │         │         ├── const-agg [as=p_mfgr:3, type=char, outer=(3)]
      │         │         │    └── p_mfgr:3 [type=char]
      │         │         └── const-agg [as=p_partkey:1, type=int, outer=(1)]
      │         │              └── p_partkey:1 [type=int]
      │         └── filters
      │              └── ps_supplycost:20 = min:48 [type=bool, outer=(20,48), constraints=(/20: (/NULL - ]; /48: (/NULL - ]), fd=(20)==(48), (48)==(20)]
      └── 100 [type=int]

stats table=q2_project_1
----
column_names  row_count  distinct_count  null_count
{n_name}      100        5               0
{p_mfgr}      100        5               0
{p_partkey}   100        100             0
{s_acctbal}   100        89              0
{s_address}   100        89              0
{s_comment}   100        89              0
{s_name}      100        89              0
{s_phone}     100        89              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}      1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}   1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}   1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

stats table=q2_limit_2
----
column_names     row_count  distinct_count  null_count
{min}            100        100             0
{n_name}         100        5               0
{p_mfgr}         100        5               0
{p_partkey}      100        100             0
{ps_partkey}     100        100             0
{ps_suppkey}     100        89              0
{ps_supplycost}  100        100             0
{s_acctbal}      100        89              0
{s_address}      100        89              0
{s_comment}      100        89              0
{s_name}         100        89              0
{s_phone}        100        89              0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{n_name}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}      1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_partkey}     1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_suppkey}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{ps_supplycost}  1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}         1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}        1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

stats table=q2_sort_3
----
column_names     row_count  distinct_count  null_count
{min}            100        100             0
{n_name}         100        5               0
{p_mfgr}         100        5               0
{p_partkey}      100        100             0
{ps_partkey}     100        100             0
{ps_suppkey}     100        89              0
{ps_supplycost}  100        100             0
{s_acctbal}      100        89              0
{s_address}      100        89              0
{s_comment}      100        89              0
{s_name}         100        89              0
{s_phone}        100        89              0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{n_name}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}         1.00           100.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}      1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_partkey}     1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{ps_suppkey}     1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{ps_supplycost}  1.00           100.00 <==     1.00                100.00 <==          0.00            1.00
{s_acctbal}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_address}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_comment}      1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_name}         1.00           100.00 <==     1.00                89.00 <==           0.00            1.00
{s_phone}        1.00           100.00 <==     1.00                89.00 <==           0.00            1.00

stats table=q2_select_4
----
column_names     row_count  distinct_count  null_count
{min}            460        458             0
{n_name}         460        5               0
{p_mfgr}         460        5               0
{p_partkey}      460        460             0
{ps_partkey}     460        460             0
{ps_suppkey}     460        406             0
{ps_supplycost}  460        458             0
{s_acctbal}      460        406             0
{s_address}      460        406             0
{s_comment}      460        406             0
{s_name}         460        406             0
{s_phone}        460        406             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1.00           460.00 <==     1.00                458.00 <==          0.00            1.00
{n_name}         1.00           460.00 <==     1.00                5.00 <==            0.00            1.00
{p_mfgr}         1.00           460.00 <==     1.00                5.00 <==            0.00            1.00
{p_partkey}      1.00           460.00 <==     1.00                460.00 <==          0.00            1.00
{ps_partkey}     1.00           460.00 <==     1.00                460.00 <==          0.00            1.00
{ps_suppkey}     1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{ps_supplycost}  1.00           460.00 <==     1.00                458.00 <==          0.00            1.00
{s_acctbal}      1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_address}      1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_comment}      1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_name}         1.00           460.00 <==     1.00                406.00 <==          0.00            1.00
{s_phone}        1.00           460.00 <==     1.00                406.00 <==          0.00            1.00

stats table=q2_group_by_5
----
column_names     row_count  distinct_count  null_count
{min}            642        458             0
{n_name}         642        5               0
{p_mfgr}         642        5               0
{p_partkey}      642        460             0
{ps_partkey}     642        460             0
{ps_suppkey}     642        548             0
{ps_supplycost}  642        640             0
{s_acctbal}      642        548             0
{s_address}      642        548             0
{s_comment}      642        548             0
{s_name}         642        548             0
{s_phone}        642        548             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{min}            1487.00        2.32 <==       1487.00             3.25 <==            0.00            1.00
{n_name}         1487.00        2.32 <==       1487.00             297.40 <==          0.00            1.00
{p_mfgr}         1487.00        2.32 <==       1487.00             297.40 <==          0.00            1.00
{p_partkey}      1487.00        2.32 <==       1487.00             3.23 <==            0.00            1.00
{ps_partkey}     1487.00        2.32 <==       1175.00             2.55 <==            0.00            1.00
{ps_suppkey}     1487.00        2.32 <==       1412.00             2.58 <==            0.00            1.00
{ps_supplycost}  1487.00        2.32 <==       1487.00             2.32 <==            0.00            1.00
{s_acctbal}      1487.00        2.32 <==       1487.00             2.71 <==            0.00            1.00
{s_address}      1487.00        2.32 <==       1487.00             2.71 <==            0.00            1.00
{s_comment}      1487.00        2.32 <==       1487.00             2.71 <==            0.00            1.00
{s_name}         1487.00        2.32 <==       1487.00             2.71 <==            0.00            1.00
{s_phone}        1487.00        2.32 <==       1487.00             2.71 <==            0.00            1.00

stats table=q2_inner_join_6
----
column_names       row_count  distinct_count  null_count
{n_name}           1070       5               0
{n_nationkey_1}    1070       5               0
{n_nationkey}      1070       5               0
{n_regionkey_1}    1070       1               0
{n_regionkey}      1070       1               0
{p_mfgr}           1070       5               0
{p_partkey}        1070       460             0
{p_size}           1070       1               0
{p_type}           1070       30              0
{ps_partkey_1}     1070       460             0
{ps_partkey}       1070       460             0
{ps_suppkey_1}     1070       548             0
{ps_suppkey}       1070       548             0
{ps_supplycost_1}  1070       640             0
{ps_supplycost}    1070       640             0
{r_name_1}         1070       1               0
{r_name}           1070       1               0
{r_regionkey_1}    1070       1               0
{r_regionkey}      1070       1               0
{s_acctbal}        1070       548             0
{s_address}        1070       548             0
{s_comment}        1070       548             0
{s_name}           1070       548             0
{s_nationkey_1}    1070       5               0
{s_nationkey}      1070       5               0
{s_phone}          1070       548             0
{s_suppkey_1}      1070       548             0
{s_suppkey}        1070       548             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}           2837.00        2.65 <==       5.00                1.00                0.00            1.00
{n_nationkey}      2837.00        2.65 <==       5.00                1.00                0.00            1.00
{n_nationkey_1}    2837.00        2.65 <==       5.00                1.00                0.00            1.00
{n_regionkey}      2837.00        2.65 <==       1.00                1.00                0.00            1.00
{n_regionkey_1}    2837.00        2.65 <==       1.00                1.00                0.00            1.00
{p_mfgr}           2837.00        2.65 <==       5.00                1.00                0.00            1.00
{p_partkey}        2837.00        2.65 <==       1333.00             2.90 <==            0.00            1.00
{p_size}           2837.00        2.65 <==       1.00                1.00                0.00            1.00
{p_type}           2837.00        2.65 <==       150.00              5.00 <==            0.00            1.00
{ps_partkey}       2837.00        2.65 <==       1175.00             2.55 <==            0.00            1.00
{ps_partkey_1}     2837.00        2.65 <==       1333.00             2.90 <==            0.00            1.00
{ps_suppkey}       2837.00        2.65 <==       1412.00             2.58 <==            0.00            1.00
{ps_suppkey_1}     2837.00        2.65 <==       1449.00             2.64 <==            0.00            1.00
{ps_supplycost}    2837.00        2.65 <==       1483.00             2.32 <==            0.00            1.00
{ps_supplycost_1}  2837.00        2.65 <==       2788.00             4.36 <==            0.00            1.00
{r_name}           2837.00        2.65 <==       1.00                1.00                0.00            1.00
{r_name_1}         2837.00        2.65 <==       1.00                1.00                0.00            1.00
{r_regionkey}      2837.00        2.65 <==       1.00                1.00                0.00            1.00
{r_regionkey_1}    2837.00        2.65 <==       1.00                1.00                0.00            1.00
{s_acctbal}        2837.00        2.65 <==       1412.00             2.58 <==            0.00            1.00
{s_address}        2837.00        2.65 <==       1413.00             2.58 <==            0.00            1.00
{s_comment}        2837.00        2.65 <==       1412.00             2.58 <==            0.00            1.00
{s_name}           2837.00        2.65 <==       1412.00             2.58 <==            0.00            1.00
{s_nationkey}      2837.00        2.65 <==       5.00                1.00                0.00            1.00
{s_nationkey_1}    2837.00        2.65 <==       5.00                1.00                0.00            1.00
{s_phone}          2837.00        2.65 <==       1413.00             2.58 <==            0.00            1.00
{s_suppkey}        2837.00        2.65 <==       1412.00             2.58 <==            0.00            1.00
{s_suppkey_1}      2837.00        2.65 <==       1449.00             2.64 <==            0.00            1.00

stats table=q2_inner_join_7
----
column_names     row_count  distinct_count  null_count
{n_nationkey}    158960     5               0
{n_regionkey}    158960     1               0
{ps_partkey}     158960     117007          0
{ps_suppkey}     158960     1987            0
{ps_supplycost}  158960     79812           0
{r_name}         158960     1               0
{r_regionkey}    158960     1               0
{s_nationkey}    158960     5               0
{s_suppkey}      158960     1987            0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}    161290.00      1.01           5.00                1.00                0.00            1.00
{n_regionkey}    161290.00      1.01           1.00                1.00                0.00            1.00
{ps_partkey}     161290.00      1.01           110568.00           1.06                0.00            1.00
{ps_suppkey}     161290.00      1.01           1845.00             1.08                0.00            1.00
{ps_supplycost}  161290.00      1.01           80252.00            1.01                0.00            1.00
{r_name}         161290.00      1.01           1.00                1.00                0.00            1.00
{r_regionkey}    161290.00      1.01           1.00                1.00                0.00            1.00
{s_nationkey}    161290.00      1.01           5.00                1.00                0.00            1.00
{s_suppkey}      161290.00      1.01           1845.00             1.08                0.00            1.00

stats table=q2_scan_8
----
column_names     row_count  distinct_count  null_count
{ps_partkey}     800000     199241          0
{ps_suppkey}     800000     9920            0
{ps_supplycost}  800000     100379          0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_partkey}     800000.00      1.00           199241.00           1.00                0.00            1.00
{ps_suppkey}     800000.00      1.00           9920.00             1.00                0.00            1.00
{ps_supplycost}  800000.00      1.00           100379.00           1.00                0.00            1.00

stats table=q2_lookup_join_9
----
column_names   row_count  distinct_count  null_count
{n_nationkey}  1987       5               0
{n_regionkey}  1987       1               0
{r_name}       1987       1               0
{r_regionkey}  1987       1               0
{s_nationkey}  1987       5               0
{s_suppkey}    1987       1987            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{n_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{r_name}       2000.00        1.01           1.00                1.00                0.00            1.00
{r_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{s_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{s_suppkey}    2000.00        1.01           1845.00             1.08                0.00            1.00

stats table=q2_merge_join_10
----
column_names   row_count  distinct_count  null_count
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

stats table=q2_scan_11
----
column_names   row_count  distinct_count  null_count
{n_nationkey}  25         25              0
{n_regionkey}  25         5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
{n_regionkey}  25.00          1.00           5.00                1.00                0.00            1.00

stats table=q2_select_12
----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

stats table=q2_scan_13
----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00

stats table=q2_inner_join_14
----
column_names     row_count  distinct_count  null_count
{n_name}         642        5               0
{n_nationkey}    642        5               0
{n_regionkey}    642        1               0
{p_mfgr}         642        5               0
{p_partkey}      642        460             0
{p_size}         642        1               0
{p_type}         642        30              0
{ps_partkey}     642        460             0
{ps_suppkey}     642        548             0
{ps_supplycost}  642        640             0
{r_name}         642        1               0
{r_regionkey}    642        1               0
{s_acctbal}      642        548             0
{s_address}      642        548             0
{s_comment}      642        548             0
{s_name}         642        548             0
{s_nationkey}    642        5               0
{s_phone}        642        548             0
{s_suppkey}      642        548             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         1945.00        3.03 <==       5.00                1.00                0.00            1.00
{n_nationkey}    1945.00        3.03 <==       5.00                1.00                0.00            1.00
{n_regionkey}    1945.00        3.03 <==       1.00                1.00                0.00            1.00
{p_mfgr}         1945.00        3.03 <==       5.00                1.00                0.00            1.00
{p_partkey}      1945.00        3.03 <==       1333.00             2.90 <==            0.00            1.00
{p_size}         1945.00        3.03 <==       1.00                1.00                0.00            1.00
{p_type}         1945.00        3.03 <==       150.00              5.00 <==            0.00            1.00
{ps_partkey}     1945.00        3.03 <==       1333.00             2.90 <==            0.00            1.00
{ps_suppkey}     1945.00        3.03 <==       1766.00             3.22 <==            0.00            1.00
{ps_supplycost}  1945.00        3.03 <==       1922.00             3.00 <==            0.00            1.00
{r_name}         1945.00        3.03 <==       1.00                1.00                0.00            1.00
{r_regionkey}    1945.00        3.03 <==       1.00                1.00                0.00            1.00
{s_acctbal}      1945.00        3.03 <==       1767.00             3.22 <==            0.00            1.00
{s_address}      1945.00        3.03 <==       1768.00             3.23 <==            0.00            1.00
{s_comment}      1945.00        3.03 <==       1766.00             3.22 <==            0.00            1.00
{s_name}         1945.00        3.03 <==       1767.00             3.22 <==            0.00            1.00
{s_nationkey}    1945.00        3.03 <==       5.00                1.00                0.00            1.00
{s_phone}        1945.00        3.03 <==       1768.00             3.23 <==            0.00            1.00
{s_suppkey}      1945.00        3.03 <==       1766.00             3.22 <==            0.00            1.00

stats table=q2_inner_join_15
----
column_names     row_count  distinct_count  null_count
{n_name}         158960     5               0
{n_nationkey}    158960     5               0
{n_regionkey}    158960     1               0
{ps_partkey}     158960     117007          0
{ps_suppkey}     158960     1987            0
{ps_supplycost}  158960     79812           0
{r_name}         158960     1               0
{r_regionkey}    158960     1               0
{s_acctbal}      158960     1983            0
{s_address}      158960     1986            0
{s_comment}      158960     1987            0
{s_name}         158960     1987            0
{s_nationkey}    158960     5               0
{s_phone}        158960     1987            0
{s_suppkey}      158960     1987            0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         161290.00      1.01           5.00                1.00                0.00            1.00
{n_nationkey}    161290.00      1.01           5.00                1.00                0.00            1.00
{n_regionkey}    161290.00      1.01           1.00                1.00                0.00            1.00
{ps_partkey}     161290.00      1.01           110565.00           1.06                0.00            1.00
{ps_suppkey}     161290.00      1.01           9920.00             4.99 <==            0.00            1.00
{ps_supplycost}  161290.00      1.01           80251.00            1.01                0.00            1.00
{r_name}         161290.00      1.01           1.00                1.00                0.00            1.00
{r_regionkey}    161290.00      1.01           1.00                1.00                0.00            1.00
{s_acctbal}      161290.00      1.01           9967.00             5.03 <==            0.00            1.00
{s_address}      161290.00      1.01           10000.00            5.04 <==            0.00            1.00
{s_comment}      161290.00      1.01           9934.00             5.00 <==            0.00            1.00
{s_name}         161290.00      1.01           9990.00             5.03 <==            0.00            1.00
{s_nationkey}    161290.00      1.01           5.00                1.00                0.00            1.00
{s_phone}        161290.00      1.01           10000.00            5.03 <==            0.00            1.00
{s_suppkey}      161290.00      1.01           9920.00             4.99 <==            0.00            1.00

stats table=q2_scan_16
----
column_names     row_count  distinct_count  null_count
{ps_partkey}     800000     199241          0
{ps_suppkey}     800000     9920            0
{ps_supplycost}  800000     100379          0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_partkey}     800000.00      1.00           199241.00           1.00                0.00            1.00
{ps_suppkey}     800000.00      1.00           9920.00             1.00                0.00            1.00
{ps_supplycost}  800000.00      1.00           100379.00           1.00                0.00            1.00

stats table=q2_inner_join_17
----
column_names   row_count  distinct_count  null_count
{n_name}       1987       5               0
{n_nationkey}  1987       5               0
{n_regionkey}  1987       1               0
{r_name}       1987       1               0
{r_regionkey}  1987       1               0
{s_acctbal}    1987       1983            0
{s_address}    1987       1986            0
{s_comment}    1987       1987            0
{s_name}       1987       1987            0
{s_nationkey}  1987       5               0
{s_phone}      1987       1987            0
{s_suppkey}    1987       1987            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       2000.00        1.01           5.00                1.00                0.00            1.00
{n_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{n_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{r_name}       2000.00        1.01           1.00                1.00                0.00            1.00
{r_regionkey}  2000.00        1.01           1.00                1.00                0.00            1.00
{s_acctbal}    2000.00        1.01           1846.00             1.07                0.00            1.00
{s_address}    2000.00        1.01           1846.00             1.08                0.00            1.00
{s_comment}    2000.00        1.01           1845.00             1.08                0.00            1.00
{s_name}       2000.00        1.01           1846.00             1.08                0.00            1.00
{s_nationkey}  2000.00        1.01           5.00                1.00                0.00            1.00
{s_phone}      2000.00        1.01           1846.00             1.08                0.00            1.00
{s_suppkey}    2000.00        1.01           1845.00             1.08                0.00            1.00

stats table=q2_scan_18
----
column_names   row_count  distinct_count  null_count
{s_acctbal}    10000      9967            0
{s_address}    10000      10027           0
{s_comment}    10000      9934            0
{s_name}       10000      9990            0
{s_nationkey}  10000      25              0
{s_phone}      10000      10021           0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_acctbal}    10000.00       1.00           9967.00             1.00                0.00            1.00
{s_address}    10000.00       1.00           10000.00            1.00                0.00            1.00
{s_comment}    10000.00       1.00           9934.00             1.00                0.00            1.00
{s_name}       10000.00       1.00           9990.00             1.00                0.00            1.00
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_phone}      10000.00       1.00           10000.00            1.00                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00

stats table=q2_inner_join_19
----
column_names   row_count  distinct_count  null_count
{n_name}       5          5               0
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       5.00           1.00           5.00                1.00                0.00            1.00
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

stats table=q2_scan_20
----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
{n_regionkey}  25         5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
{n_regionkey}  25.00          1.00           5.00                1.00                0.00            1.00

stats table=q2_select_21
----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

stats table=q2_scan_22
----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00

stats table=q2_select_23
----
column_names  row_count  distinct_count  null_count
{p_mfgr}      747        5               0
{p_partkey}   747        747             0
{p_size}      747        1               0
{p_type}      747        30              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_mfgr}      1333.00        1.78           5.00                1.00                0.00            1.00
{p_partkey}   1333.00        1.78           1333.00             1.78                0.00            1.00
{p_size}      1333.00        1.78           1.00                1.00                0.00            1.00
{p_type}      1333.00        1.78           150.00              5.00 <==            0.00            1.00

stats table=q2_scan_24
----
column_names  row_count  distinct_count  null_count
{p_mfgr}      200000     5               0
{p_partkey}   200000     199241          0
{p_size}      200000     50              0
{p_type}      200000     150             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_mfgr}      200000.00      1.00           5.00                1.00                0.00            1.00
{p_partkey}   200000.00      1.00           199241.00           1.00                0.00            1.00
{p_size}      200000.00      1.00           50.00               1.00                0.00            1.00
{p_type}      200000.00      1.00           150.00              1.00                0.00            1.00
