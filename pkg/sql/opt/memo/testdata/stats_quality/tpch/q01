import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q1
# Pricing Summary Report
# Reports the amount of business that was billed, shipped, and returned.
#
# Provides a summary pricing report for all lineitems shipped as of a given
# date. The date is within 60 - 120 days of the greatest ship date contained in
# the database. The query lists totals for extended price, discounted extended
# price, discounted extended price plus tax, average quantity, average extended
# price, and average discount. These aggregates are grouped by RETURNFLAG and
# LINESTATUS, and listed in ascending order of RETURNFLAG and LINESTATUS. A
# count of the number of lineitems in each group is included.
# --------------------------------------------------
save-tables database=tpch save-tables-prefix=q1
SELECT
    l_returnflag,
    l_linestatus,
    sum(l_quantity) AS sum_qty,
    sum(l_extendedprice) AS sum_base_price,
    sum(l_extendedprice * (1 - l_discount)) AS sum_disc_price,
    sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge,
    avg(l_quantity) AS avg_qty,
    avg(l_extendedprice) AS avg_price,
    avg(l_discount) AS avg_disc,
    count(*) AS count_order
FROM
    lineitem
WHERE
    l_shipdate <= DATE '1998-12-01' - INTERVAL '90' DAY
GROUP BY
    l_returnflag,
    l_linestatus
ORDER BY
    l_returnflag,
    l_linestatus;
----
sort
 ├── save-table-name: q1_sort_1
 ├── columns: l_returnflag:9(char!null) l_linestatus:10(char!null) sum_qty:17(float!null) sum_base_price:18(float!null) sum_disc_price:20(float!null) sum_charge:22(float!null) avg_qty:23(float!null) avg_price:24(float!null) avg_disc:25(float!null) count_order:26(int!null)
 ├── immutable
 ├── stats: [rows=6, distinct(9)=3, null(9)=0, distinct(10)=2, null(10)=0, distinct(17)=6, null(17)=0, distinct(18)=6, null(18)=0, distinct(20)=6, null(20)=0, distinct(22)=6, null(22)=0, distinct(23)=6, null(23)=0, distinct(24)=6, null(24)=0, distinct(25)=6, null(25)=0, distinct(26)=6, null(26)=0, distinct(9,10)=6, null(9,10)=0]
 ├── key: (9,10)
 ├── fd: (9,10)-->(17,18,20,22-26)
 ├── ordering: +9,+10
 └── group-by
      ├── save-table-name: q1_group_by_2
      ├── columns: l_returnflag:9(char!null) l_linestatus:10(char!null) sum:17(float!null) sum:18(float!null) sum:20(float!null) sum:22(float!null) avg:23(float!null) avg:24(float!null) avg:25(float!null) count_rows:26(int!null)
      ├── grouping columns: l_returnflag:9(char!null) l_linestatus:10(char!null)
      ├── immutable
      ├── stats: [rows=6, distinct(9)=3, null(9)=0, distinct(10)=2, null(10)=0, distinct(17)=6, null(17)=0, distinct(18)=6, null(18)=0, distinct(20)=6, null(20)=0, distinct(22)=6, null(22)=0, distinct(23)=6, null(23)=0, distinct(24)=6, null(24)=0, distinct(25)=6, null(25)=0, distinct(26)=6, null(26)=0, distinct(9,10)=6, null(9,10)=0]
      ├── key: (9,10)
      ├── fd: (9,10)-->(17,18,20,22-26)
      ├── project
      │    ├── save-table-name: q1_project_3
      │    ├── columns: column19:19(float!null) column21:21(float!null) l_quantity:5(float!null) l_extendedprice:6(float!null) l_discount:7(float!null) l_returnflag:9(char!null) l_linestatus:10(char!null)
      │    ├── immutable
      │    ├── stats: [rows=5925056.21, distinct(5)=50, null(5)=0, distinct(6)=925955, null(6)=0, distinct(7)=11, null(7)=0, distinct(9)=3, null(9)=0, distinct(10)=2, null(10)=0, distinct(19)=5925056.21, null(19)=0, distinct(21)=5925056.21, null(21)=0, distinct(9,10)=6, null(9,10)=0]
      │    ├── select
      │    │    ├── save-table-name: q1_select_4
      │    │    ├── columns: l_quantity:5(float!null) l_extendedprice:6(float!null) l_discount:7(float!null) l_tax:8(float!null) l_returnflag:9(char!null) l_linestatus:10(char!null) l_shipdate:11(date!null)
      │    │    ├── stats: [rows=5925056.21, distinct(5)=50, null(5)=0, distinct(6)=925955, null(6)=0, distinct(7)=11, null(7)=0, distinct(8)=9, null(8)=0, distinct(9)=3, null(9)=0, distinct(10)=2, null(10)=0, distinct(11)=2435, null(11)=0, distinct(6,7)=5925056.21, null(6,7)=0, distinct(9,10)=6, null(9,10)=0, distinct(6-8)=5925056.21, null(6-8)=0]
      │    │    │   histogram(11)=  0      600       28805      2400      28205      1800      28805      2400      27605      3000      28805      1800      27605      3000      28805      1800      27605      2400      28205      4200      29405      1800      28205      2400      29405      2400      29405      4200      28205      4800      28805      1800      29405      1200      28805      1800      29405      5401      29405      3000      28805      2400      28205      1800      29405      3000      28205      1200      29405      2400      25205      6601      23404      7201      28205      3600      28205      3000      28205      2400      27605      3600      28205      3000      28805      2400      26405      4200      26405      3000      28805      2400      28205      1800      27605      1800      28805      600       28205      3000      27605      5401      27605      3600      28205      4800      25805      3600      27605      2400      28205      3600      25805      3600      27605      3000      26405      4200      28805      3000      28805      3000      28805      1200      25205      4200      25805      3600      25805      3600      26405      3600      28805      1200      27605      2400      27005      3600      28805      1200      27005      4800      28205      3000      25205      4800      28805      4800      28805      600       28205      1200      24604      6601      24604      4800      28205      3600      27605      3600      27005      4200      28205      2400      28205      4200      28805      1200      28205      1800      28205      1200      28205      3000      27005      4800      28805      600       27005      3600      25805      5401      27005      2400      28205      3000      27605      2400      24004      5401      28805      3600      27005      2400      28205      3000      27005      3600      28805      3600      28205      1800      28805      1800      28805      2400      25205      5401      27605      3600      28205      3000      27005      2400      28805      4800      27005      3000      28205      3600      28805      3000      26405      3000      27605      1800      28205      3600      28205      2400      28205      1200      28205      1200      27005      2400      25805      5401      27005      4800      24004      6001      27005      3000      28205      600       27005      3600      28205      2400      25805      3600      26405      4800      25805      3000      27005      3600      27005      3000      27605      3600      27005      5401      28205      2400      27005      3600      28205      600       24004      5401      28205      1200      27605      1800      26405      5401      28205      3600      26405      3600      28205      1200      27005      1800      27005      4800      28205      1200      26405      2400      26405      6601      26405      3000      27605      4200      26405      2400      28205      3000      27005      3600      27605      1200      26405      3600      25205      4800      27605      4200      25205      3000      27605      3000      26405      2400      24604      3600      26405      4800      26405      3600      24604      4200      26405      1800      27605      3600      27605      1800      27605      1200      26405      1800      26405      3000      25805      3000      25805      3000      24004      4200      27005      1800      27605      3000      25805      4200      26405      3600      25205      4200      25205      5401      26405      3600      27005      2400      26405      3000      24604      3000      26405      1800      25805      2400      24004      3600      25805      3000      25805      4200      25805      2400      24004      3600      25805      1800      26405      1800      27005      4200      26405      2400      26405      2400      25805      1800      26405      2400      25805      2400      25805      3000      26405      2400      25805      1200      23404      4200      25205      4200      25805      2400      24004      3000      25205      1800      26405      1800      25205      5401      0      1257
      │    │    │                 <--- '1992-01-03' ------- '1992-02-23' ------- '1992-03-18' ------- '1992-04-07' ------- '1992-04-22' ------- '1992-05-06' ------- '1992-05-19' ------- '1992-05-31' ------- '1992-06-15' ------- '1992-06-29' ------- '1992-07-11' ------- '1992-07-24' ------- '1992-08-05' ------- '1992-08-17' ------- '1992-08-29' ------- '1992-09-10' ------- '1992-09-24' ------- '1992-10-10' ------- '1992-10-22' ------- '1992-11-05' ------- '1992-11-17' ------- '1992-11-28' ------- '1992-12-10' ------- '1992-12-22' ------- '1993-01-02' ------- '1993-01-10' ------- '1993-01-24' ------- '1993-02-06' ------- '1993-02-20' ------- '1993-03-06' ------- '1993-03-19' ------- '1993-04-02' ------- '1993-04-17' ------- '1993-05-02' ------- '1993-05-13' ------- '1993-05-26' ------- '1993-06-07' ------- '1993-06-21' ------- '1993-07-06' ------- '1993-07-19' ------- '1993-08-02' ------- '1993-08-16' ------- '1993-08-30' ------- '1993-09-11' ------- '1993-09-21' ------- '1993-10-07' ------- '1993-10-19' ------- '1993-10-30' ------- '1993-11-11' ------- '1993-11-24' ------- '1993-12-09' ------- '1993-12-24' ------- '1994-01-02' ------- '1994-01-16' ------- '1994-01-30' ------- '1994-02-08' ------- '1994-02-18' ------- '1994-03-04' ------- '1994-03-15' ------- '1994-03-29' ------- '1994-04-10' ------- '1994-04-24' ------- '1994-05-03' ------- '1994-05-13' ------- '1994-05-24' ------- '1994-06-04' ------- '1994-06-13' ------- '1994-06-22' ------- '1994-07-05' ------- '1994-07-16' ------- '1994-07-29' ------- '1994-08-09' ------- '1994-08-22' ------- '1994-09-04' ------- '1994-09-15' ------- '1994-09-29' ------- '1994-10-10' ------- '1994-10-20' ------- '1994-11-03' ------- '1994-11-16' ------- '1994-11-29' ------- '1994-12-11' ------- '1994-12-25' ------- '1995-01-07' ------- '1995-01-18' ------- '1995-01-31' ------- '1995-02-12' ------- '1995-02-23' ------- '1995-03-04' ------- '1995-03-16' ------- '1995-03-29' ------- '1995-04-09' ------- '1995-04-22' ------- '1995-05-05' ------- '1995-05-20' ------- '1995-05-31' ------- '1995-06-13' ------- '1995-06-25' ------- '1995-07-07' ------- '1995-07-22' ------- '1995-08-04' ------- '1995-08-16' ------- '1995-08-29' ------- '1995-09-09' ------- '1995-09-20' ------- '1995-10-02' ------- '1995-10-16' ------- '1995-10-26' ------- '1995-11-03' ------- '1995-11-16' ------- '1995-11-28' ------- '1995-12-08' ------- '1995-12-19' ------- '1995-12-31' ------- '1996-01-12' ------- '1996-01-22' ------- '1996-02-01' ------- '1996-02-10' ------- '1996-02-21' ------- '1996-03-02' ------- '1996-03-13' ------- '1996-03-25' ------- '1996-04-06' ------- '1996-04-18' ------- '1996-04-29' ------- '1996-05-10' ------- '1996-05-21' ------- '1996-06-03' ------- '1996-06-15' ------- '1996-06-28' ------- '1996-07-08' ------- '1996-07-23' ------- '1996-08-05' ------- '1996-08-17' ------- '1996-08-29' ------- '1996-09-10' ------- '1996-09-20' ------- '1996-10-03' ------- '1996-10-15' ------- '1996-10-28' ------- '1996-11-10' ------- '1996-11-22' ------- '1996-12-02' ------- '1996-12-17' ------- '1996-12-26' ------- '1997-01-07' ------- '1997-01-19' ------- '1997-01-29' ------- '1997-02-11' ------- '1997-02-23' ------- '1997-03-07' ------- '1997-03-18' ------- '1997-03-28' ------- '1997-04-11' ------- '1997-04-24' ------- '1997-05-05' ------- '1997-05-15' ------- '1997-05-31' ------- '1997-06-10' ------- '1997-06-23' ------- '1997-07-07' ------- '1997-07-19' ------- '1997-07-30' ------- '1997-08-13' ------- '1997-08-23' ------- '1997-09-07' ------- '1997-09-15' ------- '1997-09-26' ------- '1997-10-06' ------- '1997-10-19' ------- '1997-10-30' ------- '1997-11-10' ------- '1997-11-22' ------- '1997-12-02' ------- '1997-12-14' ------- '1997-12-27' ------- '1998-01-06' ------- '1998-01-18' ------- '1998-01-29' ------- '1998-02-10' ------- '1998-02-24' ------- '1998-03-08' ------- '1998-03-19' ------- '1998-04-01' ------- '1998-04-14' ------- '1998-04-25' ------- '1998-05-06' ------- '1998-05-17' ------- '1998-05-29' ------- '1998-06-10' ------- '1998-06-22' ------- '1998-07-04' ------- '1998-07-15' ------- '1998-07-25' ------- '1998-08-05' ------- '1998-08-18' ------- '1998-09-01' --- '1998-09-02'
      │    │    ├── scan lineitem
      │    │    │    ├── save-table-name: q1_scan_5
      │    │    │    ├── columns: l_quantity:5(float!null) l_extendedprice:6(float!null) l_discount:7(float!null) l_tax:8(float!null) l_returnflag:9(char!null) l_linestatus:10(char!null) l_shipdate:11(date!null)
      │    │    │    └── stats: [rows=6001215, distinct(5)=50, null(5)=0, distinct(6)=925955, null(6)=0, distinct(7)=11, null(7)=0, distinct(8)=9, null(8)=0, distinct(9)=3, null(9)=0, distinct(10)=2, null(10)=0, distinct(11)=2526, null(11)=0, distinct(6,7)=6001215, null(6,7)=0, distinct(9,10)=6, null(9,10)=0, distinct(6-8)=6001215, null(6-8)=0]
      │    │    │        histogram(11)=  0      600       28805      2400      28205      1800      28805      2400      27605      3000      28805      1800      27605      3000      28805      1800      27605      2400      28205      4200      29405      1800      28205      2400      29405      2400      29405      4200      28205      4800      28805      1800      29405      1200      28805      1800      29405      5401      29405      3000      28805      2400      28205      1800      29405      3000      28205      1200      29405      2400      25205      6601      23404      7201      28205      3600      28205      3000      28205      2400      27605      3600      28205      3000      28805      2400      26405      4200      26405      3000      28805      2400      28205      1800      27605      1800      28805      600       28205      3000      27605      5401      27605      3600      28205      4800      25805      3600      27605      2400      28205      3600      25805      3600      27605      3000      26405      4200      28805      3000      28805      3000      28805      1200      25205      4200      25805      3600      25805      3600      26405      3600      28805      1200      27605      2400      27005      3600      28805      1200      27005      4800      28205      3000      25205      4800      28805      4800      28805      600       28205      1200      24604      6601      24604      4800      28205      3600      27605      3600      27005      4200      28205      2400      28205      4200      28805      1200      28205      1800      28205      1200      28205      3000      27005      4800      28805      600       27005      3600      25805      5401      27005      2400      28205      3000      27605      2400      24004      5401      28805      3600      27005      2400      28205      3000      27005      3600      28805      3600      28205      1800      28805      1800      28805      2400      25205      5401      27605      3600      28205      3000      27005      2400      28805      4800      27005      3000      28205      3600      28805      3000      26405      3000      27605      1800      28205      3600      28205      2400      28205      1200      28205      1200      27005      2400      25805      5401      27005      4800      24004      6001      27005      3000      28205      600       27005      3600      28205      2400      25805      3600      26405      4800      25805      3000      27005      3600      27005      3000      27605      3600      27005      5401      28205      2400      27005      3600      28205      600       24004      5401      28205      1200      27605      1800      26405      5401      28205      3600      26405      3600      28205      1200      27005      1800      27005      4800      28205      1200      26405      2400      26405      6601      26405      3000      27605      4200      26405      2400      28205      3000      27005      3600      27605      1200      26405      3600      25205      4800      27605      4200      25205      3000      27605      3000      26405      2400      24604      3600      26405      4800      26405      3600      24604      4200      26405      1800      27605      3600      27605      1800      27605      1200      26405      1800      26405      3000      25805      3000      25805      3000      24004      4200      27005      1800      27605      3000      25805      4200      26405      3600      25205      4200      25205      5401      26405      3600      27005      2400      26405      3000      24604      3000      26405      1800      25805      2400      24004      3600      25805      3000      25805      4200      25805      2400      24004      3600      25805      1800      26405      1800      27005      4200      26405      2400      26405      2400      25805      1800      26405      2400      25805      2400      25805      3000      26405      2400      25805      1200      23404      4200      25205      4200      25805      2400      24004      3000      25205      1800      26405      1800      25205      5401      25205      1800      23404      1800      24604      600
      │    │    │                      <--- '1992-01-03' ------- '1992-02-23' ------- '1992-03-18' ------- '1992-04-07' ------- '1992-04-22' ------- '1992-05-06' ------- '1992-05-19' ------- '1992-05-31' ------- '1992-06-15' ------- '1992-06-29' ------- '1992-07-11' ------- '1992-07-24' ------- '1992-08-05' ------- '1992-08-17' ------- '1992-08-29' ------- '1992-09-10' ------- '1992-09-24' ------- '1992-10-10' ------- '1992-10-22' ------- '1992-11-05' ------- '1992-11-17' ------- '1992-11-28' ------- '1992-12-10' ------- '1992-12-22' ------- '1993-01-02' ------- '1993-01-10' ------- '1993-01-24' ------- '1993-02-06' ------- '1993-02-20' ------- '1993-03-06' ------- '1993-03-19' ------- '1993-04-02' ------- '1993-04-17' ------- '1993-05-02' ------- '1993-05-13' ------- '1993-05-26' ------- '1993-06-07' ------- '1993-06-21' ------- '1993-07-06' ------- '1993-07-19' ------- '1993-08-02' ------- '1993-08-16' ------- '1993-08-30' ------- '1993-09-11' ------- '1993-09-21' ------- '1993-10-07' ------- '1993-10-19' ------- '1993-10-30' ------- '1993-11-11' ------- '1993-11-24' ------- '1993-12-09' ------- '1993-12-24' ------- '1994-01-02' ------- '1994-01-16' ------- '1994-01-30' ------- '1994-02-08' ------- '1994-02-18' ------- '1994-03-04' ------- '1994-03-15' ------- '1994-03-29' ------- '1994-04-10' ------- '1994-04-24' ------- '1994-05-03' ------- '1994-05-13' ------- '1994-05-24' ------- '1994-06-04' ------- '1994-06-13' ------- '1994-06-22' ------- '1994-07-05' ------- '1994-07-16' ------- '1994-07-29' ------- '1994-08-09' ------- '1994-08-22' ------- '1994-09-04' ------- '1994-09-15' ------- '1994-09-29' ------- '1994-10-10' ------- '1994-10-20' ------- '1994-11-03' ------- '1994-11-16' ------- '1994-11-29' ------- '1994-12-11' ------- '1994-12-25' ------- '1995-01-07' ------- '1995-01-18' ------- '1995-01-31' ------- '1995-02-12' ------- '1995-02-23' ------- '1995-03-04' ------- '1995-03-16' ------- '1995-03-29' ------- '1995-04-09' ------- '1995-04-22' ------- '1995-05-05' ------- '1995-05-20' ------- '1995-05-31' ------- '1995-06-13' ------- '1995-06-25' ------- '1995-07-07' ------- '1995-07-22' ------- '1995-08-04' ------- '1995-08-16' ------- '1995-08-29' ------- '1995-09-09' ------- '1995-09-20' ------- '1995-10-02' ------- '1995-10-16' ------- '1995-10-26' ------- '1995-11-03' ------- '1995-11-16' ------- '1995-11-28' ------- '1995-12-08' ------- '1995-12-19' ------- '1995-12-31' ------- '1996-01-12' ------- '1996-01-22' ------- '1996-02-01' ------- '1996-02-10' ------- '1996-02-21' ------- '1996-03-02' ------- '1996-03-13' ------- '1996-03-25' ------- '1996-04-06' ------- '1996-04-18' ------- '1996-04-29' ------- '1996-05-10' ------- '1996-05-21' ------- '1996-06-03' ------- '1996-06-15' ------- '1996-06-28' ------- '1996-07-08' ------- '1996-07-23' ------- '1996-08-05' ------- '1996-08-17' ------- '1996-08-29' ------- '1996-09-10' ------- '1996-09-20' ------- '1996-10-03' ------- '1996-10-15' ------- '1996-10-28' ------- '1996-11-10' ------- '1996-11-22' ------- '1996-12-02' ------- '1996-12-17' ------- '1996-12-26' ------- '1997-01-07' ------- '1997-01-19' ------- '1997-01-29' ------- '1997-02-11' ------- '1997-02-23' ------- '1997-03-07' ------- '1997-03-18' ------- '1997-03-28' ------- '1997-04-11' ------- '1997-04-24' ------- '1997-05-05' ------- '1997-05-15' ------- '1997-05-31' ------- '1997-06-10' ------- '1997-06-23' ------- '1997-07-07' ------- '1997-07-19' ------- '1997-07-30' ------- '1997-08-13' ------- '1997-08-23' ------- '1997-09-07' ------- '1997-09-15' ------- '1997-09-26' ------- '1997-10-06' ------- '1997-10-19' ------- '1997-10-30' ------- '1997-11-10' ------- '1997-11-22' ------- '1997-12-02' ------- '1997-12-14' ------- '1997-12-27' ------- '1998-01-06' ------- '1998-01-18' ------- '1998-01-29' ------- '1998-02-10' ------- '1998-02-24' ------- '1998-03-08' ------- '1998-03-19' ------- '1998-04-01' ------- '1998-04-14' ------- '1998-04-25' ------- '1998-05-06' ------- '1998-05-17' ------- '1998-05-29' ------- '1998-06-10' ------- '1998-06-22' ------- '1998-07-04' ------- '1998-07-15' ------- '1998-07-25' ------- '1998-08-05' ------- '1998-08-18' ------- '1998-09-01' ------- '1998-09-22' ------- '1998-10-13' ------- '1998-11-26'
      │    │    └── filters
      │    │         └── l_shipdate:11 <= '1998-09-02' [type=bool, outer=(11), constraints=(/11: (/NULL - /'1998-09-02']; tight)]
      │    └── projections
      │         ├── l_extendedprice:6 * (1.0 - l_discount:7) [as=column19:19, type=float, outer=(6,7), immutable]
      │         └── (l_extendedprice:6 * (1.0 - l_discount:7)) * (l_tax:8 + 1.0) [as=column21:21, type=float, outer=(6-8), immutable]
      └── aggregations
           ├── sum [as=sum:17, type=float, outer=(5)]
           │    └── l_quantity:5 [type=float]
           ├── sum [as=sum:18, type=float, outer=(6)]
           │    └── l_extendedprice:6 [type=float]
           ├── sum [as=sum:20, type=float, outer=(19)]
           │    └── column19:19 [type=float]
           ├── sum [as=sum:22, type=float, outer=(21)]
           │    └── column21:21 [type=float]
           ├── avg [as=avg:23, type=float, outer=(5)]
           │    └── l_quantity:5 [type=float]
           ├── avg [as=avg:24, type=float, outer=(6)]
           │    └── l_extendedprice:6 [type=float]
           ├── avg [as=avg:25, type=float, outer=(7)]
           │    └── l_discount:7 [type=float]
           └── count-rows [as=count_rows:26, type=int]

stats table=q1_sort_1
----
column_names      row_count  distinct_count  null_count
{avg_disc}        4          4               0
{avg_price}       4          4               0
{avg_qty}         4          4               0
{count_order}     4          4               0
{l_linestatus}    4          2               0
{l_returnflag}    4          3               0
{sum_base_price}  4          4               0
{sum_charge}      4          4               0
{sum_disc_price}  4          4               0
{sum_qty}         4          4               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{avg_disc}        6.00           1.50           6.00                1.50                0.00            1.00
{avg_price}       6.00           1.50           6.00                1.50                0.00            1.00
{avg_qty}         6.00           1.50           6.00                1.50                0.00            1.00
{count_order}     6.00           1.50           6.00                1.50                0.00            1.00
{l_linestatus}    6.00           1.50           2.00                1.00                0.00            1.00
{l_returnflag}    6.00           1.50           3.00                1.00                0.00            1.00
{sum_base_price}  6.00           1.50           6.00                1.50                0.00            1.00
{sum_charge}      6.00           1.50           6.00                1.50                0.00            1.00
{sum_disc_price}  6.00           1.50           6.00                1.50                0.00            1.00
{sum_qty}         6.00           1.50           6.00                1.50                0.00            1.00

stats table=q1_group_by_2
----
column_names    row_count  distinct_count  null_count
{avg_1}         4          4               0
{avg_2}         4          4               0
{avg}           4          4               0
{count_rows}    4          4               0
{l_linestatus}  4          2               0
{l_returnflag}  4          3               0
{sum_1}         4          4               0
{sum_2}         4          4               0
{sum_3}         4          4               0
{sum}           4          4               0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{avg}           6.00           1.50           6.00                1.50                0.00            1.00
{avg_1}         6.00           1.50           6.00                1.50                0.00            1.00
{avg_2}         6.00           1.50           6.00                1.50                0.00            1.00
{count_rows}    6.00           1.50           6.00                1.50                0.00            1.00
{l_linestatus}  6.00           1.50           2.00                1.00                0.00            1.00
{l_returnflag}  6.00           1.50           3.00                1.00                0.00            1.00
{sum}           6.00           1.50           6.00                1.50                0.00            1.00
{sum_1}         6.00           1.50           6.00                1.50                0.00            1.00
{sum_2}         6.00           1.50           6.00                1.50                0.00            1.00
{sum_3}         6.00           1.50           6.00                1.50                0.00            1.00

stats table=q1_project_3
----
column_names       row_count  distinct_count  null_count
{column19}         5916591    4150364         0
{column21}         5916591    5661182         0
{l_discount}       5916591    11              0
{l_extendedprice}  5916591    925955          0
{l_linestatus}     5916591    2               0
{l_quantity}       5916591    50              0
{l_returnflag}     5916591    3               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{column19}         5925056.00     1.00           5925056.00          1.43                0.00            1.00
{column21}         5925056.00     1.00           5925056.00          1.05                0.00            1.00
{l_discount}       5925056.00     1.00           11.00               1.00                0.00            1.00
{l_extendedprice}  5925056.00     1.00           925955.00           1.00                0.00            1.00
{l_linestatus}     5925056.00     1.00           2.00                1.00                0.00            1.00
{l_quantity}       5925056.00     1.00           50.00               1.00                0.00            1.00
{l_returnflag}     5925056.00     1.00           3.00                1.00                0.00            1.00

stats table=q1_select_4
----
column_names       row_count  distinct_count  null_count
{l_discount}       5916591    11              0
{l_extendedprice}  5916591    925955          0
{l_linestatus}     5916591    2               0
{l_quantity}       5916591    50              0
{l_returnflag}     5916591    3               0
{l_shipdate}       5916591    2436            0
{l_tax}            5916591    9               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       5925056.00     1.00           11.00               1.00                0.00            1.00
{l_extendedprice}  5925056.00     1.00           925955.00           1.00                0.00            1.00
{l_linestatus}     5925056.00     1.00           2.00                1.00                0.00            1.00
{l_quantity}       5925056.00     1.00           50.00               1.00                0.00            1.00
{l_returnflag}     5925056.00     1.00           3.00                1.00                0.00            1.00
{l_shipdate}       5925056.00     1.00           2435.00             1.00                0.00            1.00
{l_tax}            5925056.00     1.00           9.00                1.00                0.00            1.00

stats table=q1_scan_5
----
column_names       row_count  distinct_count  null_count
{l_discount}       6001215    11              0
{l_extendedprice}  6001215    925955          0
{l_linestatus}     6001215    2               0
{l_quantity}       6001215    50              0
{l_returnflag}     6001215    3               0
{l_shipdate}       6001215    2526            0
{l_tax}            6001215    9               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       6001215.00     1.00           11.00               1.00                0.00            1.00
{l_extendedprice}  6001215.00     1.00           925955.00           1.00                0.00            1.00
{l_linestatus}     6001215.00     1.00           2.00                1.00                0.00            1.00
{l_quantity}       6001215.00     1.00           50.00               1.00                0.00            1.00
{l_returnflag}     6001215.00     1.00           3.00                1.00                0.00            1.00
{l_shipdate}       6001215.00     1.00           2526.00             1.00                0.00            1.00
{l_tax}            6001215.00     1.00           9.00                1.00                0.00            1.00
