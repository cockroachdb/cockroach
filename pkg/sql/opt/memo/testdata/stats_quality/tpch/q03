import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q3
# Shipping Priority
# Retrieves the 10 unshipped orders with the highest value.
#
# Retrieves the shipping priority and potential revenue, defined as the sum of
# l_extendedprice * (1-l_discount), of the orders having the largest revenue
# among those that had not been shipped as of a given date. Orders are listed in
# decreasing order of revenue. If more than 10 unshipped orders exist, only the
# 10 orders with the largest revenue are listed.
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q3
SELECT
    l_orderkey,
    sum(l_extendedprice * (1 - l_discount)) AS revenue,
    o_orderdate,
    o_shippriority
FROM
    customer,
    orders,
    lineitem
WHERE
    c_mktsegment = 'BUILDING'
    AND c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND o_orderDATE < DATE '1995-03-15'
    AND l_shipdate > DATE '1995-03-15'
GROUP BY
    l_orderkey,
    o_orderdate,
    o_shippriority
ORDER BY
    revenue DESC,
    o_orderdate
LIMIT 10;
----
----
top-k
 ├── save-table-name: q3_top_k_1
 ├── columns: l_orderkey:22(int!null) revenue:41(float!null) o_orderdate:15(date!null) o_shippriority:18(int!null)
 ├── internal-ordering: -41,+15
 ├── k: 10
 ├── cardinality: [0 - 10]
 ├── immutable
 ├── stats: [rows=10, distinct(15)=10, null(15)=0, avgsize(15)=4, distinct(18)=10, null(18)=0, avgsize(18)=4, distinct(22)=10, null(22)=0, avgsize(22)=4, distinct(41)=10, null(41)=0, avgsize(41)=4]
 ├── key: (22)
 ├── fd: (22)-->(15,18,41)
 ├── ordering: -41,+15
 └── group-by (hash)
      ├── save-table-name: q3_group_by_2
      ├── columns: o_orderdate:15(date!null) o_shippriority:18(int!null) l_orderkey:22(int!null) sum:41(float!null)
      ├── grouping columns: l_orderkey:22(int!null)
      ├── immutable
      ├── stats: [rows=358456.7, distinct(15)=358457, null(15)=0, avgsize(15)=4, distinct(18)=358457, null(18)=0, avgsize(18)=4, distinct(22)=358457, null(22)=0, avgsize(22)=4, distinct(41)=358457, null(41)=0, avgsize(41)=4]
      ├── key: (22)
      ├── fd: (22)-->(15,18,41)
      ├── project
      │    ├── save-table-name: q3_project_3
      │    ├── columns: column40:40(float!null) o_orderdate:15(date!null) o_shippriority:18(int!null) l_orderkey:22(int!null)
      │    ├── immutable
      │    ├── stats: [rows=493436.5, distinct(15)=1169, null(15)=0, avgsize(15)=4, distinct(18)=1, null(18)=0, avgsize(18)=2, distinct(22)=358457, null(22)=0, avgsize(22)=4, distinct(40)=408763, null(40)=0, avgsize(40)=18]
      │    ├── fd: (22)-->(15,18)
      │    ├── inner-join (lookup lineitem)
      │    │    ├── save-table-name: q3_lookup_join_4
      │    │    ├── columns: c_custkey:1(int!null) c_mktsegment:7(char!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) o_shippriority:18(int!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_shipdate:32(date!null)
      │    │    ├── key columns: [11] = [22]
      │    │    ├── stats: [rows=493436.5, distinct(1)=30523.3, null(1)=0, avgsize(1)=4, distinct(7)=1, null(7)=0, avgsize(7)=11, distinct(11)=358457, null(11)=0, avgsize(11)=4, distinct(12)=30523.3, null(12)=0, avgsize(12)=4, distinct(15)=1169, null(15)=0, avgsize(15)=4, distinct(18)=1, null(18)=0, avgsize(18)=2, distinct(22)=358457, null(22)=0, avgsize(22)=4, distinct(27)=362999, null(27)=0, avgsize(27)=9, distinct(28)=11, null(28)=0, avgsize(28)=9, distinct(32)=1355, null(32)=0, avgsize(32)=4, distinct(27,28)=408763, null(27,28)=0, avgsize(27,28)=18]
      │    │    ├── fd: ()-->(7), (11)-->(12,15,18), (11)==(22), (22)==(11), (1)==(12), (12)==(1)
      │    │    ├── inner-join (hash)
      │    │    │    ├── save-table-name: q3_inner_join_5
      │    │    │    ├── columns: c_custkey:1(int!null) c_mktsegment:7(char!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) o_shippriority:18(int!null)
      │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    │    ├── stats: [rows=222934.7, distinct(1)=30523.3, null(1)=0, avgsize(1)=4, distinct(7)=1, null(7)=0, avgsize(7)=11, distinct(11)=192056, null(11)=0, avgsize(11)=4, distinct(12)=30523.3, null(12)=0, avgsize(12)=4, distinct(15)=1169, null(15)=0, avgsize(15)=4, distinct(18)=1, null(18)=0, avgsize(18)=2]
      │    │    │    ├── key: (11)
      │    │    │    ├── fd: ()-->(7), (11)-->(12,15,18), (1)==(12), (12)==(1)
      │    │    │    ├── select
      │    │    │    │    ├── save-table-name: q3_select_6
      │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) o_shippriority:18(int!null)
      │    │    │    │    ├── stats: [rows=728580, distinct(11)=728580, null(11)=0, avgsize(11)=4, distinct(12)=99841.4, null(12)=0, avgsize(12)=4, distinct(15)=1169, null(15)=0, avgsize(15)=4, distinct(18)=1, null(18)=0, avgsize(18)=2]
      │    │    │    │    │   histogram(15)=  0      450       6900      600       7350      600       6750      900       7050      1350      7350      1350      6750      900       6600      900       7350      600       7200      600       7350      1050      6900      750       6900      750       7350      450       7350      600       7200      750       7350      450       7200      750       7350      750       6150      1200      7050      300       7200      600       7200      300       6600      1350      7050      450       6750      600       7200      750       7050      450       6750      600       7200      900       7050      900       7050      750       7050      600       7200      750       6150      1200      7200      1200      6000      1350      6300      1200      7200      750       6750      1200      6600      900       7050      750       7050      450       7050      900       7200      450       7200      1050      6900      900       6300      1200      6750      600       7050      900       7050      450       6900      1200      6750      600       7050      750       6750      1350      7050      600       7050      300       7200      450       7050      600       6900      450       6900      450       7200      600       6600      900       6900      750       5700      1800      6900      750       6300      1050      7050      900       7200      300       7050      450       6600      750       6450      1200      6900      600       7050      1050      7050      450       6600      750       7050      600       6450      900       7050      600       7200      900       6750      900       7200      750       7200      1050      6750      600       6900      600       6900      1050      7050      450       7050      750       6000      1350      6750      900       6900      900       6900      900       7050      1050      6750      600       7050      900       1935      645
      │    │    │    │    │                 <--- '1992-01-01' ------ '1992-01-13' ------ '1992-01-25' ------ '1992-02-05' ------ '1992-02-18' ------ '1992-02-29' ------ '1992-03-12' ------ '1992-03-23' ------ '1992-04-05' ------ '1992-04-17' ------ '1992-04-30' ------ '1992-05-16' ------ '1992-05-28' ------ '1992-06-09' ------ '1992-06-22' ------ '1992-07-04' ------ '1992-07-15' ------ '1992-07-26' ------ '1992-08-09' ------ '1992-08-19' ------ '1992-09-01' ------ '1992-09-12' ------ '1992-09-23' ------ '1992-10-04' ------ '1992-10-17' ------ '1992-10-27' ------ '1992-11-06' ------ '1992-11-19' ------ '1992-11-30' ------ '1992-12-12' ------ '1992-12-23' ------ '1993-01-06' ------ '1993-01-18' ------ '1993-01-31' ------ '1993-02-08' ------ '1993-02-21' ------ '1993-03-01' ------ '1993-03-16' ------ '1993-03-27' ------ '1993-04-07' ------ '1993-04-21' ------ '1993-05-02' ------ '1993-05-14' ------ '1993-05-28' ------ '1993-06-08' ------ '1993-06-20' ------ '1993-07-02' ------ '1993-07-16' ------ '1993-07-29' ------ '1993-08-12' ------ '1993-08-25' ------ '1993-09-07' ------ '1993-09-22' ------ '1993-10-05' ------ '1993-10-18' ------ '1993-10-31' ------ '1993-11-14' ------ '1993-11-25' ------ '1993-12-06' ------ '1993-12-20' ------ '1994-01-03' ------ '1994-01-15' ------ '1994-01-23' ------ '1994-02-04' ------ '1994-02-15' ------ '1994-02-27' ------ '1994-03-09' ------ '1994-03-19' ------ '1994-04-05' ------ '1994-04-16' ------ '1994-04-29' ------ '1994-05-10' ------ '1994-05-24' ------ '1994-06-04' ------ '1994-06-16' ------ '1994-06-30' ------ '1994-07-16' ------ '1994-07-31' ------ '1994-08-13' ------ '1994-08-27' ------ '1994-09-08' ------ '1994-09-23' ------ '1994-10-06' ------ '1994-10-17' ------ '1994-10-28' ------ '1994-11-11' ------ '1994-11-25' ------ '1994-12-11' ------ '1994-12-22' ------ '1995-01-03' ------ '1995-01-17' ------ '1995-01-30' ------ '1995-02-09' ------ '1995-02-23' ------ '1995-03-10' ------ '1995-03-14'
      │    │    │    │    ├── key: (11)
      │    │    │    │    ├── fd: (11)-->(12,15,18)
      │    │    │    │    ├── scan orders
      │    │    │    │    │    ├── save-table-name: q3_scan_7
      │    │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) o_shippriority:18(int!null)
      │    │    │    │    │    ├── stats: [rows=1500000, distinct(11)=1.5e+06, null(11)=0, avgsize(11)=4, distinct(12)=99846, null(12)=0, avgsize(12)=4, distinct(15)=2406, null(15)=0, avgsize(15)=4, distinct(18)=1, null(18)=0, avgsize(18)=2]
      │    │    │    │    │    │   histogram(11)=  0           0            0 0.99998 7406.9 0.99998 7327.9 0.99998 7748.9 0.99998 7433.9 0.99998  8029.9 0.99998  7265.9 0.99998  7439.9 0.99998  7823.9 0.99998  7526.9 0.99998  7553.9 0.99998  7426.9 0.99998  7490.9 0.99998  7595.9 0.99998  7527.9 0.99998  7640.9 0.99998  7593.9 0.99998  7384.9 0.99998  7713.9 0.99998  7409.9 0.99998  7249.9 0.99998  7518.9 0.99998  7434.9 0.99998  7575.9 0.99998  7471.9 0.99998  7302.9 0.99998  7109.9 0.99998  7646.9 0.99998  7619.9 0.99998  7579.9 0.99998  7489.9 0.99998  7409.9 0.99998  7619.9 0.99998  7805.9  0.99998  7418.9  0.99998  7454.9  0.99998  7651.9  0.99998  7407.9  0.99998  7278.9  0.99998  7402.9  0.99998  7375.9  0.99998  7375.9  0.99998  7517.9  0.99998  7626.9  0.99998  7675.9  0.99998  7470.9  0.99998  7352.9  0.99998  7597.9  0.99998  7649.9  0.99998  7509.9  0.99998  7320.9  0.99998  7287.9  0.99998  7365.9  0.99998  7381.9  0.99998  7478.9  0.99998  7526.9  0.99998  7233.9  0.99998  7676.9  0.99998  7400.9  0.99998  7739.9  0.99998  7638.9  0.99998  7515.9  0.99998  7211.9  0.99998  7231.9  0.99998  7194.9  0.99998  7187.9  0.99998  7885.9  0.99998  7359.9  0.99998  7301.9  0.99998  7493.9  0.99998  7529.9  0.99998  7558.9  0.99998  7148.9  0.99998  7437.9  0.99998  7337.9  0.99998  7299.9  0.99998  7683.9  0.99998  7430.9  0.99998  7252.9  0.99998  7440.9  0.99998  7467.9  0.99998  7694.9  0.99998  7528.9  0.99998  7441.9  0.99998  7694.9  0.99998  7737.9  0.99998  7523.9  0.99998  7400.9  0.99998  7523.9  0.99998  7700.9  0.99998  7156.9  0.99998  7352.9  0.99998  7359.9  0.99998  7334.9  0.99998  7444.9  0.99998  7766.9  0.99998  7675.9  0.99998  7511.9  0.99998  7616.9  0.99998  7308.9  0.99998  7593.9  0.99998  7296.9  0.99998  7557.9  0.99998  7416.9  0.99998  7613.9  0.99998  7421.9  0.99998  7322.9  0.99998  7584.9  0.99998  7726.9  0.99998  7495.9  0.99998  7434.9  0.99998  7337.9  0.99998  7450.9  0.99998  7576.9  0.99998  7245.9  0.99998  7625.9  0.99998  7748.9  0.99998  7417.9  0.99998  7701.9  0.99998  7437.9  0.99998  7345.9  0.99998  7517.9  0.99998  7621.9  0.99998  7359.9  0.99998  7393.9  0.99998  7632.9  0.99998  7715.9  0.99998  7558.9  0.99998  7350.9  0.99998  7557.9  0.99998  7400.9  0.99998  7297.9  0.99998  7875.9  0.99998  7364.9  0.99998  7332.9  0.99998  7458.9  0.99998  7471.9  0.99998  7564.9  0.99998  7523.9  0.99998  7270.9  0.99998  7309.9  0.99998  7418.9  0.99998  7959.9  0.99998  7382.9  0.99998  7507.9  0.99998  7524.9  0.99998  7566.9  0.99998  7705.9  0.99998  7841.9  0.99998  7483.9  0.99998  7685.9  0.99998  7605.9  0.99998  7677.9  0.99998  7647.9  0.99998  7985.9  0.99998  7859.9  0.99998  7673.9  0.99998  7732.9  0.99998  7501.9  0.99998  7498.9  0.99998  7596.9  0.99998  7572.9  0.99998  7848.9  0.99998  7567.9  0.99998  7549.9  0.99998  7493.9  0.99998  7869.9  0.99998  7508.9  0.99998  7626.9  0.99998  7774.9  0.99998  7908.9  0.99998  7501.9  0.99998  7841.9  0.99998  7542.9  0.99998  7623.9  0.99998  7523.9  0.99998  7548.9  0.99998  7977.9  0.99998  7569.9  0.99998  7916.9  0.99998  7613.9  0.99998  7883.9  0.99998  7579.9  0.99998  8076.9  0.99998  7698.9  0.99998  7635.9  0.99998  7530.9  0.99998  7515.9  0.99998  7673.9  0.99998  7781.9  0.99998  7698.9  0.99998  7482.9  0.99998  7805.9  0.99998  7774.9  0.99998  7657.9  0.99998  7655.9  0.99998  7579.9  0.99998  7506.9  0.99998  7736.9  0.99998  7584.9  0.99998  0           0
      │    │    │    │    │    │                 <--- -9223372036854775808 --- 1505 --------- 29025 -------- 54400 -------- 91106 -------- 119366 -------- 163554 -------- 187236 -------- 215651 -------- 254373 -------- 285123 -------- 316614 -------- 344678 -------- 374465 -------- 407078 -------- 437861 -------- 471683 -------- 504230 -------- 531168 -------- 566951 -------- 594561 -------- 617825 -------- 648358 -------- 676640 -------- 708706 -------- 737986 -------- 762690 -------- 782081 -------- 816064 -------- 849318 -------- 881511 -------- 911271 -------- 938885 -------- 972135 -------- 1010370 -------- 1038212 -------- 1067041 -------- 1101158 -------- 1128704 -------- 1152742 -------- 1180165 -------- 1206852 -------- 1233537 -------- 1264064 -------- 1297504 -------- 1332260 -------- 1361504 -------- 1387553 -------- 1420224 -------- 1454275 -------- 1484580 -------- 1509766 -------- 1534050 -------- 1560452 -------- 1587299 -------- 1616771 -------- 1647526 -------- 1670343 -------- 1705121 -------- 1732486 -------- 1768967 -------- 1802725 -------- 1833189 -------- 1855398 -------- 1878146 -------- 1899877 -------- 1921414 -------- 1961765 -------- 1988000 -------- 2012672 -------- 2042529 -------- 2073381 -------- 2104999 -------- 2125477 -------- 2153825 -------- 2179462 -------- 2204065 -------- 2239044 -------- 2267205 -------- 2290530 -------- 2318977 -------- 2348134 -------- 2383399 -------- 2414215 -------- 2442695 -------- 2477955 -------- 2514372 -------- 2545062 -------- 2572418 -------- 2603108 -------- 2638534 -------- 2659232 -------- 2685286 -------- 2711527 -------- 2737088 -------- 2765639 -------- 2802818 -------- 2837570 -------- 2867911 -------- 2901088 -------- 2925954 -------- 2958501 -------- 2983042 -------- 3014626 -------- 3042406 -------- 3075489 -------- 3103425 -------- 3128673 -------- 3160994 -------- 3197125 -------- 3227043 -------- 3255328 -------- 3280965 -------- 3309669 -------- 3341767 -------- 3364898 -------- 3398305 -------- 3435008 -------- 3462818 -------- 3498272 -------- 3526631 -------- 3552485 -------- 3583014 -------- 3616322 -------- 3642566 -------- 3669732 -------- 3703330 -------- 3739170 -------- 3770791 -------- 3796804 -------- 3828387 -------- 3855751 -------- 3880321 -------- 3920422 -------- 3946818 -------- 3972322 -------- 4001250 -------- 4030533 -------- 4062306 -------- 4092992 -------- 4116803 -------- 4141697 -------- 4169536 -------- 4211878 -------- 4238753 -------- 4268994 -------- 4299686 -------- 4331525 -------- 4367079 -------- 4406277 -------- 4435878 -------- 4470914 -------- 4500294 -------- 4531617 -------- 4562114 -------- 4601666 -------- 4637856 -------- 4669060 -------- 4701861 -------- 4728416 -------- 4754881 -------- 4784001 -------- 4812482 -------- 4848389 -------- 4876741 -------- 4904612 -------- 4930945 -------- 4967397 -------- 4994146 -------- 5024099 -------- 5058023 -------- 5095527 -------- 5122081 -------- 5157798 -------- 5185472 -------- 5215332 -------- 5242497 -------- 5270338 -------- 5309699 -------- 5338112 -------- 5375843 -------- 5405441 -------- 5442277 -------- 5470945 -------- 5512930 -------- 5544807 -------- 5574980 -------- 5602340 -------- 5629280 -------- 5660482 -------- 5694599 -------- 5726466 -------- 5752519 -------- 5787268 -------- 5821185 -------- 5851973 -------- 5882689 -------- 5911363 -------- 5938052 -------- 5970949 -------- 5999748 --- 9223372036854775807
      │    │    │    │    │    │   histogram(12)=  0 150 7350  150  7350  150   7350  150   7350  150   7200  300   7350  150   7200  450   7350  150   7350  150   7350  150   7350  150   7350  150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   300   7350   150   7350   150   7350   300   7350   300   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150    7200   300    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7500   150    7500   300    7350   150    7500   300    7350   150    7500   300    7350   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   300    7350   300    7350   300    7350   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   300    7350   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7350   300    7500   150    7500   150
      │    │    │    │    │    │                 <--- 4 ------ 959 ------ 1858 ------ 2773 ------ 3466 ------ 4333 ------ 5026 ------ 5872 ------ 6571 ------ 7069 ------ 7897 ------ 8611 ------ 9514 ------ 10309 ------ 11038 ------ 11893 ------ 12632 ------ 13450 ------ 14104 ------ 14923 ------ 15719 ------ 16382 ------ 17119 ------ 17882 ------ 18701 ------ 19576 ------ 20314 ------ 20950 ------ 21727 ------ 22261 ------ 23059 ------ 23692 ------ 24488 ------ 25144 ------ 25895 ------ 26747 ------ 27650 ------ 28408 ------ 29140 ------ 29920 ------ 30511 ------ 31261 ------ 31999 ------ 32920 ------ 33688 ------ 34525 ------ 35197 ------ 35876 ------ 36580 ------ 37313 ------ 37924 ------ 38768 ------ 39440 ------ 40127 ------ 41005 ------ 41810 ------ 42422 ------ 43310 ------ 44095 ------ 44644 ------ 45347 ------ 45970 ------ 46634 ------ 47284 ------ 48055 ------ 48850 ------ 49712 ------ 50356 ------ 51268 ------ 52048 ------ 52571 ------ 53125 ------ 54088 ------ 54913 ------ 55771 ------ 56386 ------ 57085 ------ 57877 ------ 58729 ------ 59353 ------ 60133 ------ 60947 ------ 61672 ------ 62411 ------ 63296 ------ 64000 ------ 64586 ------ 65251 ------ 65914 ------ 66403 ------ 66991 ------ 67798 ------ 68494 ------ 69406 ------ 70106 ------ 70921 ------ 71770 ------ 72482 ------ 73256 ------ 74083 ------ 74681 ------ 75412 ------ 76201 ------ 76876 ------ 77684 ------ 78421 ------ 79058 ------ 79909 ------ 80591 ------ 81247 ------ 81964 ------ 82835 ------ 83731 ------ 84467 ------ 85012 ------ 85874 ------ 86647 ------ 87151 ------ 87853 ------ 88543 ------ 89425 ------ 90046 ------ 90640 ------ 91544 ------ 92257 ------ 93107 ------ 93835 ------ 94424 ------ 95383 ------ 96313 ------ 96938 ------ 97808 ------ 98689 ------ 99505 ------ 100144 ------ 100981 ------ 101797 ------ 102556 ------ 103504 ------ 104113 ------ 104980 ------ 105622 ------ 106241 ------ 106988 ------ 107578 ------ 108302 ------ 108905 ------ 109765 ------ 110663 ------ 111409 ------ 112093 ------ 113033 ------ 113683 ------ 114346 ------ 115006 ------ 115798 ------ 116261 ------ 116908 ------ 117610 ------ 118319 ------ 119203 ------ 120058 ------ 120922 ------ 121702 ------ 122486 ------ 123253 ------ 124142 ------ 124795 ------ 125689 ------ 126277 ------ 126904 ------ 127684 ------ 128251 ------ 129032 ------ 129916 ------ 130717 ------ 131554 ------ 132482 ------ 133408 ------ 134272 ------ 135073 ------ 135869 ------ 136963 ------ 137806 ------ 138412 ------ 139103 ------ 139982 ------ 140794 ------ 141455 ------ 142396 ------ 143047 ------ 143788 ------ 144620 ------ 145336 ------ 146170 ------ 147014 ------ 147769 ------ 148508 ------ 149234 ------ 149995
      │    │    │    │    │    │   histogram(15)=  0      450       6900      600       7350      600       6750      900       7050      1350      7350      1350      6750      900       6600      900       7350      600       7200      600       7350      1050      6900      750       6900      750       7350      450       7350      600       7200      750       7350      450       7200      750       7350      750       6150      1200      7050      300       7200      600       7200      300       6600      1350      7050      450       6750      600       7200      750       7050      450       6750      600       7200      900       7050      900       7050      750       7050      600       7200      750       6150      1200      7200      1200      6000      1350      6300      1200      7200      750       6750      1200      6600      900       7050      750       7050      450       7050      900       7200      450       7200      1050      6900      900       6300      1200      6750      600       7050      900       7050      450       6900      1200      6750      600       7050      750       6750      1350      7050      600       7050      300       7200      450       7050      600       6900      450       6900      450       7200      600       6600      900       6900      750       5700      1800      6900      750       6300      1050      7050      900       7200      300       7050      450       6600      750       6450      1200      6900      600       7050      1050      7050      450       6600      750       7050      600       6450      900       7050      600       7200      900       6750      900       7200      750       7200      1050      6750      600       6900      600       6900      1050      7050      450       7050      750       6000      1350      6750      900       6900      900       6900      900       7050      1050      6750      600       7050      900       6450      900       7050      300       6600      750       7050      1350      7200      450       7200      750       7200      600       6300      900       7050      750       6450      900       6900      900       6600      600       6600      600       6900      750       7050      600       6150      1050      6750      600       6600      600       7050      900       7050      1650      6750      600       6750      600       6750      450       7050      1050      6900      1350      6600      600       6300      900       6600      600       6300      1050      6750      900       6300      900       7050      1200      6600      1200      6750      750       6900      900       6750      600       6750      600       6150      1200      6450      1050      7050      750       6300      1050      7050      450       6750      600       6750      600       7050      600       7050      900       6900      600       6900      900       6900      600       6450      1200      6600      450       6900      450       6750      600       6750      750       6750      1350      6750      450       6600      750       6600      450       6450      750       6450      600       6750      600       6900      900       6300      750       6450      1200      6000      1500      6900      900       6000      1200      6300      750       6450      600       6900      1050      6600      600       6900      1650      5850      1050      6600      750       6600      450       6300      900       6600      300       6600      600       6750      900       6750      450       6600      750       6600      300       6150      900       6750      600       5850      1050      6750      450       6750      750       6600      900       6150      600       6600      450       6150      750       6600      1350      6600      450       6000      1200      5550      1350      6150      450       6300      450       6450      900       6450      750       6000      1650      5850      750       6000      450       5250      900       5400      1050      5400      600
      │    │    │    │    │    │                 <--- '1992-01-01' ------ '1992-01-13' ------ '1992-01-25' ------ '1992-02-05' ------ '1992-02-18' ------ '1992-02-29' ------ '1992-03-12' ------ '1992-03-23' ------ '1992-04-05' ------ '1992-04-17' ------ '1992-04-30' ------ '1992-05-16' ------ '1992-05-28' ------ '1992-06-09' ------ '1992-06-22' ------ '1992-07-04' ------ '1992-07-15' ------ '1992-07-26' ------ '1992-08-09' ------ '1992-08-19' ------ '1992-09-01' ------ '1992-09-12' ------ '1992-09-23' ------ '1992-10-04' ------ '1992-10-17' ------ '1992-10-27' ------ '1992-11-06' ------ '1992-11-19' ------ '1992-11-30' ------ '1992-12-12' ------ '1992-12-23' ------ '1993-01-06' ------ '1993-01-18' ------ '1993-01-31' ------ '1993-02-08' ------ '1993-02-21' ------ '1993-03-01' ------ '1993-03-16' ------ '1993-03-27' ------ '1993-04-07' ------ '1993-04-21' ------ '1993-05-02' ------ '1993-05-14' ------ '1993-05-28' ------ '1993-06-08' ------ '1993-06-20' ------ '1993-07-02' ------ '1993-07-16' ------ '1993-07-29' ------ '1993-08-12' ------ '1993-08-25' ------ '1993-09-07' ------ '1993-09-22' ------ '1993-10-05' ------ '1993-10-18' ------ '1993-10-31' ------ '1993-11-14' ------ '1993-11-25' ------ '1993-12-06' ------ '1993-12-20' ------ '1994-01-03' ------ '1994-01-15' ------ '1994-01-23' ------ '1994-02-04' ------ '1994-02-15' ------ '1994-02-27' ------ '1994-03-09' ------ '1994-03-19' ------ '1994-04-05' ------ '1994-04-16' ------ '1994-04-29' ------ '1994-05-10' ------ '1994-05-24' ------ '1994-06-04' ------ '1994-06-16' ------ '1994-06-30' ------ '1994-07-16' ------ '1994-07-31' ------ '1994-08-13' ------ '1994-08-27' ------ '1994-09-08' ------ '1994-09-23' ------ '1994-10-06' ------ '1994-10-17' ------ '1994-10-28' ------ '1994-11-11' ------ '1994-11-25' ------ '1994-12-11' ------ '1994-12-22' ------ '1995-01-03' ------ '1995-01-17' ------ '1995-01-30' ------ '1995-02-09' ------ '1995-02-23' ------ '1995-03-10' ------ '1995-03-21' ------ '1995-04-04' ------ '1995-04-15' ------ '1995-04-27' ------ '1995-05-12' ------ '1995-05-26' ------ '1995-06-04' ------ '1995-06-13' ------ '1995-06-26' ------ '1995-07-08' ------ '1995-07-19' ------ '1995-07-31' ------ '1995-08-12' ------ '1995-08-21' ------ '1995-09-04' ------ '1995-09-13' ------ '1995-09-25' ------ '1995-10-06' ------ '1995-10-22' ------ '1995-10-30' ------ '1995-11-11' ------ '1995-11-23' ------ '1995-12-06' ------ '1995-12-19' ------ '1996-01-01' ------ '1996-01-13' ------ '1996-01-23' ------ '1996-02-03' ------ '1996-02-14' ------ '1996-02-24' ------ '1996-03-05' ------ '1996-03-17' ------ '1996-03-26' ------ '1996-04-09' ------ '1996-04-21' ------ '1996-05-03' ------ '1996-05-15' ------ '1996-05-28' ------ '1996-06-06' ------ '1996-06-16' ------ '1996-06-27' ------ '1996-07-11' ------ '1996-07-24' ------ '1996-08-07' ------ '1996-08-20' ------ '1996-09-04' ------ '1996-09-17' ------ '1996-10-05' ------ '1996-10-18' ------ '1996-10-29' ------ '1996-11-07' ------ '1996-11-20' ------ '1996-11-30' ------ '1996-12-15' ------ '1996-12-30' ------ '1997-01-13' ------ '1997-01-25' ------ '1997-02-05' ------ '1997-02-15' ------ '1997-02-24' ------ '1997-03-06' ------ '1997-03-18' ------ '1997-03-30' ------ '1997-04-09' ------ '1997-04-21' ------ '1997-05-01' ------ '1997-05-12' ------ '1997-05-24' ------ '1997-06-04' ------ '1997-06-15' ------ '1997-06-28' ------ '1997-07-10' ------ '1997-07-20' ------ '1997-07-30' ------ '1997-08-13' ------ '1997-08-24' ------ '1997-09-04' ------ '1997-09-16' ------ '1997-09-29' ------ '1997-10-15' ------ '1997-10-30' ------ '1997-11-13' ------ '1997-11-25' ------ '1997-12-06' ------ '1997-12-18' ------ '1997-12-30' ------ '1998-01-10' ------ '1998-01-23' ------ '1998-02-02' ------ '1998-02-15' ------ '1998-02-28' ------ '1998-03-11' ------ '1998-03-24' ------ '1998-04-03' ------ '1998-04-12' ------ '1998-04-24' ------ '1998-05-05' ------ '1998-05-18' ------ '1998-05-31' ------ '1998-06-11' ------ '1998-06-20' ------ '1998-06-30' ------ '1998-07-12' ------ '1998-07-23' ------ '1998-08-02'
      │    │    │    │    │    │   histogram(18)=  0 1.5e+06
      │    │    │    │    │    │                 <----- 0 --
      │    │    │    │    │    ├── key: (11)
      │    │    │    │    │    └── fd: (11)-->(12,15,18)
      │    │    │    │    └── filters
      │    │    │    │         └── o_orderdate:15 < '1995-03-15' [type=bool, outer=(15), constraints=(/15: (/NULL - /'1995-03-14']; tight)]
      │    │    │    ├── select
      │    │    │    │    ├── save-table-name: q3_select_8
      │    │    │    │    ├── columns: c_custkey:1(int!null) c_mktsegment:7(char!null)
      │    │    │    │    ├── stats: [rows=30550, distinct(1)=30523.3, null(1)=0, avgsize(1)=4, distinct(7)=1, null(7)=0, avgsize(7)=11]
      │    │    │    │    │   histogram(7)=  0    30550
      │    │    │    │    │                <--- 'BUILDING'
      │    │    │    │    ├── key: (1)
      │    │    │    │    ├── fd: ()-->(7)
      │    │    │    │    ├── scan customer
      │    │    │    │    │    ├── save-table-name: q3_scan_9
      │    │    │    │    │    ├── columns: c_custkey:1(int!null) c_mktsegment:7(char!null)
      │    │    │    │    │    ├── stats: [rows=150000, distinct(1)=148813, null(1)=0, avgsize(1)=4, distinct(7)=5, null(7)=0, avgsize(7)=11]
      │    │    │    │    │    │   histogram(1)=  0           0            0  5   745   5   746   5    711   5    780   5    738   5    835   5    697   5    757   5    704   5    696   5    753   5    678   5    813   5    873    5    736    5    840    5    703    5    745    5    710    5    763    5    742    5    673    5    702    5    793    5    732    5    752    5    707    5    751    5    722    5    814    5    789    5    671    5    643    5    706    5    723    5    757    5    713    5    760    5    766    5    711    5    858    5    702    5    695    5    697    5    823    5    857    5    712    5    808    5    754    5    739    5    694    5    782    5    792    5    751    5    758    5    749    5    798    5    685    5    692    5    792    5    710    5    771    5    724    5    853    5    713    5    823    5    772    5    656    5    763    5    672    5    735    5    810    5    786    5    709    5    731    5    702    5    708    5    669    5    733    5    744    5    758    5    800    5    682    5    716    5    716    5    729    5    778    5    721    5    766    5    820    5    757    5    739    5    799    5    780    5    710    5    749    5    754    5    750    5    699    5    821    5    759    5    818    5    763    5    854    5    779    5    810    5    783    5    686    5    703    5    776    5    675    5    812    5    745    5    759    5    793    5    751    5    761    5    798    5    794    5    729    5    696    5    699    5    831    5    709    5    747    5    722    5    768    5    729    5    702    5    729    5    698    5    767    5    792    5     726    5     737    5     671    5     721    5     842    5     701    5     704    5     708    5     726    5     695    5     665    5     688    5     653    5     690    5     734    5     789    5     659    5     785    5     733    5     740    5     826    5     745    5     929    5     899    5     743    5     790    5     825    5     779    5     677    5     697    5     756    5     693    5     862    5     772    5     783    5     757    5     799    5     778    5     752    5     715    5     709    5     790    5     789    5     865    5     808    5     772    5     743    5     751    5     742    5     676    5     684    5     744    5     709    5     679    5     817    5     755    5     754    5     797    5     709    5     748    5     679    5     751    5     775    5     736    5     790    5     714    5     0           0
      │    │    │    │    │    │                <--- -9223372036854775808 --- 59 ----- 811 ----- 1565 ----- 2252 ----- 3068 ----- 3807 ----- 4720 ----- 5381 ----- 6155 ----- 6829 ----- 7487 ----- 8254 ----- 8876 ----- 9751 ----- 10728 ----- 11463 ----- 12385 ----- 13057 ----- 13810 ----- 14495 ----- 15281 ----- 16028 ----- 16640 ----- 17311 ----- 18151 ----- 18880 ----- 19645 ----- 20325 ----- 21088 ----- 21798 ----- 22674 ----- 23507 ----- 24115 ----- 24661 ----- 25340 ----- 26052 ----- 26827 ----- 27518 ----- 28298 ----- 29089 ----- 29777 ----- 30730 ----- 31401 ----- 32057 ----- 32718 ----- 33611 ----- 34562 ----- 35251 ----- 36117 ----- 36887 ----- 37629 ----- 38283 ----- 39104 ----- 39942 ----- 40705 ----- 41481 ----- 42241 ----- 43089 ----- 43725 ----- 44376 ----- 45214 ----- 45899 ----- 46700 ----- 47413 ----- 48356 ----- 49047 ----- 49939 ----- 50742 ----- 51316 ----- 52101 ----- 52710 ----- 53444 ----- 54313 ----- 55140 ----- 55823 ----- 56549 ----- 57219 ----- 57901 ----- 58503 ----- 59234 ----- 59984 ----- 60760 ----- 61613 ----- 62243 ----- 62941 ----- 63638 ----- 64360 ----- 65173 ----- 65880 ----- 66672 ----- 67560 ----- 68334 ----- 69075 ----- 69925 ----- 70742 ----- 71428 ----- 72189 ----- 72958 ----- 73720 ----- 74385 ----- 75274 ----- 76053 ----- 76936 ----- 77721 ----- 78666 ----- 79480 ----- 80349 ----- 81171 ----- 81810 ----- 82482 ----- 83292 ----- 83907 ----- 84780 ----- 85532 ----- 86310 ----- 87149 ----- 87912 ----- 88694 ----- 89543 ----- 90384 ----- 91106 ----- 91764 ----- 92428 ----- 93335 ----- 94018 ----- 94775 ----- 95484 ----- 96279 ----- 97001 ----- 97672 ----- 98394 ----- 99056 ----- 99850 ----- 100688 ----- 101405 ----- 102143 ----- 102751 ----- 103459 ----- 104384 ----- 105052 ----- 105727 ----- 106409 ----- 107125 ----- 107782 ----- 108377 ----- 109020 ----- 109588 ----- 110235 ----- 110967 ----- 111800 ----- 112382 ----- 113196 ----- 113913 ----- 114643 ----- 115529 ----- 116268 ----- 117329 ----- 118341 ----- 119076 ----- 119898 ----- 120782 ----- 121584 ----- 122186 ----- 122830 ----- 123591 ----- 124227 ----- 125175 ----- 125964 ----- 126773 ----- 127535 ----- 128374 ----- 129175 ----- 129928 ----- 130609 ----- 131279 ----- 132102 ----- 132923 ----- 133877 ----- 134732 ----- 135521 ----- 136257 ----- 137007 ----- 137740 ----- 138341 ----- 138958 ----- 139695 ----- 140364 ----- 140971 ----- 141841 ----- 142600 ----- 143356 ----- 144192 ----- 144861 ----- 145607 ----- 146214 ----- 146965 ----- 147761 ----- 148483 ----- 149306 ----- 149986 --- 9223372036854775807
      │    │    │    │    │    │   histogram(7)=  0     29085      91650     29265
      │    │    │    │    │    │                <--- 'AUTOMOBILE' ------- 'MACHINERY'
      │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    └── fd: (1)-->(7)
      │    │    │    │    └── filters
      │    │    │    │         └── c_mktsegment:7 = 'BUILDING' [type=bool, outer=(7), constraints=(/7: [/'BUILDING' - /'BUILDING']; tight), fd=()-->(7)]
      │    │    │    └── filters
      │    │    │         └── c_custkey:1 = o_custkey:12 [type=bool, outer=(1,12), constraints=(/1: (/NULL - ]; /12: (/NULL - ]), fd=(1)==(12), (12)==(1)]
      │    │    └── filters
      │    │         └── l_shipdate:32 > '1995-03-15' [type=bool, outer=(32), constraints=(/32: [/'1995-03-16' - ]; tight)]
      │    └── projections
      │         └── l_extendedprice:27 * (1.0 - l_discount:28) [as=column40:40, type=float, outer=(27,28), immutable]
      └── aggregations
           ├── sum [as=sum:41, type=float, outer=(40)]
           │    └── column40:40 [type=float]
           ├── const-agg [as=o_orderdate:15, type=date, outer=(15)]
           │    └── o_orderdate:15 [type=date]
           └── const-agg [as=o_shippriority:18, type=int, outer=(18)]
                └── o_shippriority:18 [type=int]

----Stats for q3_top_k_1----
column_names      row_count  distinct_count  null_count
{l_orderkey}      10         10              0
{o_orderdate}     10         8               0
{o_shippriority}  10         1               0
{revenue}         10         10              0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}      10.00          1.00           10.00               1.00                0.00            1.00
{o_orderdate}     10.00          1.00           10.00               1.25                0.00            1.00
{o_shippriority}  10.00          1.00           10.00               10.00 <==           0.00            1.00
{revenue}         10.00          1.00           10.00               1.00                0.00            1.00

----Stats for q3_group_by_2----
column_names      row_count  distinct_count  null_count
{l_orderkey}      11620      11611           0
{o_orderdate}     11620      120             0
{o_shippriority}  11620      1               0
{sum}             11620      11601           0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}      358457.00      30.85 <==      358457.00           30.87 <==           0.00            1.00
{o_orderdate}     358457.00      30.85 <==      358457.00           2987.14 <==         0.00            1.00
{o_shippriority}  358457.00      30.85 <==      358457.00           358457.00 <==       0.00            1.00
{sum}             358457.00      30.85 <==      358457.00           30.90 <==           0.00            1.00

----Stats for q3_project_3----
column_names      row_count  distinct_count  null_count
{column40}        30519      30424           0
{l_orderkey}      30519      11611           0
{o_orderdate}     30519      120             0
{o_shippriority}  30519      1               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{column40}        493436.00      16.17 <==      408763.00           13.44 <==           0.00            1.00
{l_orderkey}      493436.00      16.17 <==      358457.00           30.87 <==           0.00            1.00
{o_orderdate}     493436.00      16.17 <==      1169.00             9.74 <==            0.00            1.00
{o_shippriority}  493436.00      16.17 <==      1.00                1.00                0.00            1.00

----Stats for q3_lookup_join_4----
column_names       row_count  distinct_count  null_count
{c_custkey}        30519      8643            0
{c_mktsegment}     30519      1               0
{l_discount}       30519      11              0
{l_extendedprice}  30519      30042           0
{l_orderkey}       30519      11611           0
{l_shipdate}       30519      120             0
{o_custkey}        30519      8643            0
{o_orderdate}      30519      120             0
{o_orderkey}       30519      11611           0
{o_shippriority}   30519      1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        493436.00      16.17 <==      30523.00            3.53 <==            0.00            1.00
{c_mktsegment}     493436.00      16.17 <==      1.00                1.00                0.00            1.00
{l_discount}       493436.00      16.17 <==      11.00               1.00                0.00            1.00
{l_extendedprice}  493436.00      16.17 <==      362999.00           12.08 <==           0.00            1.00
{l_orderkey}       493436.00      16.17 <==      358457.00           30.87 <==           0.00            1.00
{l_shipdate}       493436.00      16.17 <==      1355.00             11.29 <==           0.00            1.00
{o_custkey}        493436.00      16.17 <==      30523.00            3.53 <==            0.00            1.00
{o_orderdate}      493436.00      16.17 <==      1169.00             9.74 <==            0.00            1.00
{o_orderkey}       493436.00      16.17 <==      358457.00           30.87 <==           0.00            1.00
{o_shippriority}   493436.00      16.17 <==      1.00                1.00                0.00            1.00

----Stats for q3_inner_join_5----
column_names      row_count  distinct_count  null_count
{c_custkey}       147126     20129           0
{c_mktsegment}    147126     1               0
{o_custkey}       147126     20129           0
{o_orderdate}     147126     1169            0
{o_orderkey}      147126     145236          0
{o_shippriority}  147126     1               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}       222935.00      1.52           30523.00            1.52                0.00            1.00
{c_mktsegment}    222935.00      1.52           1.00                1.00                0.00            1.00
{o_custkey}       222935.00      1.52           30523.00            1.52                0.00            1.00
{o_orderdate}     222935.00      1.52           1169.00             1.00                0.00            1.00
{o_orderkey}      222935.00      1.52           192056.00           1.32                0.00            1.00
{o_shippriority}  222935.00      1.52           1.00                1.00                0.00            1.00

----Stats for q3_select_6----
column_names      row_count  distinct_count  null_count
{o_custkey}       727305     99492           0
{o_orderdate}     727305     1169            0
{o_orderkey}      727305     727305          0
{o_shippriority}  727305     1               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}       728580.00      1.00           99841.00            1.00                0.00            1.00
{o_orderdate}     728580.00      1.00           1169.00             1.00                0.00            1.00
{o_orderkey}      728580.00      1.00           728580.00           1.00                0.00            1.00
{o_shippriority}  728580.00      1.00           1.00                1.00                0.00            1.00

----Stats for q3_scan_7----
column_names      row_count  distinct_count  null_count
{o_custkey}       1500000    99846           0
{o_orderdate}     1500000    2406            0
{o_orderkey}      1500000    1500000         0
{o_shippriority}  1500000    1               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}       1500000.00     1.00           99846.00            1.00                0.00            1.00
{o_orderdate}     1500000.00     1.00           2406.00             1.00                0.00            1.00
{o_orderkey}      1500000.00     1.00           1500000.00          1.00                0.00            1.00
{o_shippriority}  1500000.00     1.00           1.00                1.00                0.00            1.00

----Stats for q3_select_8----
column_names    row_count  distinct_count  null_count
{c_custkey}     30142      30101           0
{c_mktsegment}  30142      1               0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}     30550.00       1.01           30523.00            1.01                0.00            1.00
{c_mktsegment}  30550.00       1.01           1.00                1.00                0.00            1.00

----Stats for q3_scan_9----
column_names    row_count  distinct_count  null_count
{c_custkey}     150000     148813          0
{c_mktsegment}  150000     5               0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}     150000.00      1.00           148813.00           1.00                0.00            1.00
{c_mktsegment}  150000.00      1.00           5.00                1.00                0.00            1.00
----
----
