import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q3
# Shipping Priority
# Retrieves the 10 unshipped orders with the highest value.
#
# Retrieves the shipping priority and potential revenue, defined as the sum of
# l_extendedprice * (1-l_discount), of the orders having the largest revenue
# among those that had not been shipped as of a given date. Orders are listed in
# decreasing order of revenue. If more than 10 unshipped orders exist, only the
# 10 orders with the largest revenue are listed.
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q3
SELECT
    l_orderkey,
    sum(l_extendedprice * (1 - l_discount)) AS revenue,
    o_orderdate,
    o_shippriority
FROM
    customer,
    orders,
    lineitem
WHERE
    c_mktsegment = 'BUILDING'
    AND c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND o_orderDATE < DATE '1995-03-15'
    AND l_shipdate > DATE '1995-03-15'
GROUP BY
    l_orderkey,
    o_orderdate,
    o_shippriority
ORDER BY
    revenue DESC,
    o_orderdate
LIMIT 10;
----
----
limit
 ├── save-table-name: q3_limit_1
 ├── columns: l_orderkey:22(int!null) revenue:41(float!null) o_orderdate:15(date!null) o_shippriority:18(int!null)
 ├── internal-ordering: -41,+15
 ├── cardinality: [0 - 10]
 ├── immutable
 ├── stats: [rows=10, distinct(15)=10, null(15)=0, distinct(18)=10, null(18)=0, distinct(22)=10, null(22)=0, distinct(41)=10, null(41)=0]
 ├── key: (22)
 ├── fd: (22)-->(15,18,41)
 ├── ordering: -41,+15
 ├── sort
 │    ├── save-table-name: q3_sort_2
 │    ├── columns: o_orderdate:15(date!null) o_shippriority:18(int!null) l_orderkey:22(int!null) sum:41(float!null)
 │    ├── immutable
 │    ├── stats: [rows=358055.383, distinct(15)=358055.383, null(15)=0, distinct(18)=358055.383, null(18)=0, distinct(22)=358055.383, null(22)=0, distinct(41)=358055.383, null(41)=0]
 │    ├── key: (22)
 │    ├── fd: (22)-->(15,18,41)
 │    ├── ordering: -41,+15
 │    ├── limit hint: 10.00
 │    └── group-by
 │         ├── save-table-name: q3_group_by_3
 │         ├── columns: o_orderdate:15(date!null) o_shippriority:18(int!null) l_orderkey:22(int!null) sum:41(float!null)
 │         ├── grouping columns: l_orderkey:22(int!null)
 │         ├── immutable
 │         ├── stats: [rows=358055.383, distinct(15)=358055.383, null(15)=0, distinct(18)=358055.383, null(18)=0, distinct(22)=358055.383, null(22)=0, distinct(41)=358055.383, null(41)=0]
 │         ├── key: (22)
 │         ├── fd: (22)-->(15,18,41)
 │         ├── project
 │         │    ├── save-table-name: q3_project_4
 │         │    ├── columns: column40:40(float!null) o_orderdate:15(date!null) o_shippriority:18(int!null) l_orderkey:22(int!null)
 │         │    ├── immutable
 │         │    ├── stats: [rows=491642.25, distinct(15)=1169, null(15)=0, distinct(18)=1, null(18)=0, distinct(22)=358055.383, null(22)=0, distinct(40)=407585.615, null(40)=0]
 │         │    ├── fd: (22)-->(15,18)
 │         │    ├── inner-join (lookup lineitem)
 │         │    │    ├── save-table-name: q3_lookup_join_5
 │         │    │    ├── columns: c_custkey:1(int!null) c_mktsegment:7(char!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) o_shippriority:18(int!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_shipdate:32(date!null)
 │         │    │    ├── key columns: [11] = [22]
 │         │    │    ├── stats: [rows=491642.25, distinct(1)=30358.6191, null(1)=0, distinct(7)=1, null(7)=0, distinct(11)=358055.383, null(11)=0, distinct(12)=30358.6191, null(12)=0, distinct(15)=1169, null(15)=0, distinct(18)=1, null(18)=0, distinct(22)=358055.383, null(22)=0, distinct(27)=365083.134, null(27)=0, distinct(28)=11, null(28)=0, distinct(32)=1356, null(32)=0, distinct(27,28)=407585.615, null(27,28)=0]
 │         │    │    ├── fd: ()-->(7), (11)-->(12,15,18), (11)==(22), (22)==(11), (1)==(12), (12)==(1)
 │         │    │    ├── inner-join (hash)
 │         │    │    │    ├── save-table-name: q3_inner_join_6
 │         │    │    │    ├── columns: c_custkey:1(int!null) c_mktsegment:7(char!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) o_shippriority:18(int!null)
 │         │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
 │         │    │    │    ├── stats: [rows=222776.251, distinct(1)=30358.6191, null(1)=0, distinct(7)=1, null(7)=0, distinct(11)=192072.436, null(11)=0, distinct(12)=30358.6191, null(12)=0, distinct(15)=1169, null(15)=0, distinct(18)=1, null(18)=0]
 │         │    │    │    ├── key: (11)
 │         │    │    │    ├── fd: ()-->(7), (11)-->(12,15,18), (1)==(12), (12)==(1)
 │         │    │    │    ├── select
 │         │    │    │    │    ├── save-table-name: q3_select_7
 │         │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) o_shippriority:18(int!null)
 │         │    │    │    │    ├── stats: [rows=732069.231, distinct(11)=732069.231, null(11)=0, distinct(12)=99848.7204, null(12)=0, distinct(15)=1169, null(15)=0, distinct(18)=1, null(18)=0]
 │         │    │    │    │    │   histogram(15)=  0      600       7350      900       7200      1200      7350      900       7200      900       7200      600       6000      1800      7350      300       7350      600       7200      450       7050      1050      7050      900       7350      750       7050      1050      7200      750       7200      1200      7050      450       6900      750       6600      1200      7200      150       6600      900       6900      900       7200      450       7200      1050      7200      300       6300      1050      7200      1050      7200      600       6600      1350      6750      900       6900      750       7050      450       6900      450       7200      750       6900      1200      7050      300       6900      450       6900      900       6900      900       7200      600       6750      750       6750      900       6900      1050      6900      750       6750      1200      7200      1200      7050      450       6900      1200      6750      600       6900      750       6900      750       7200      300       6150      1350      7050      1200      6450      900       6750      1200      6750      1350      7050      900       7050      900       7050      600       5850      1650      6900      1200      6750      1200      7050      600       7200      750       7200      450       6150      1350      6750      1050      6900      600       7200      300       6900      600       7050      300       6600      900       7200      600       7200      900       6750      1050      7200      900       6750      900       6750      900       6300      1350      6750      600       6300      1350      7050      300       6300      1050      6750      1050      6900      900       7200      750       7050      750       6600      750       6900      900       6900      900       6900      900       6450      1050      7050      600       7050      450       1626.9     542.31
 │         │    │    │    │    │                 <--- '1992-01-01' ------ '1992-01-13' ------ '1992-01-25' ------ '1992-02-13' ------ '1992-02-22' ------ '1992-03-05' ------ '1992-03-16' ------ '1992-03-29' ------ '1992-04-13' ------ '1992-04-25' ------ '1992-05-07' ------ '1992-05-18' ------ '1992-06-04' ------ '1992-06-18' ------ '1992-07-01' ------ '1992-07-13' ------ '1992-07-25' ------ '1992-08-08' ------ '1992-08-19' ------ '1992-09-01' ------ '1992-09-10' ------ '1992-09-22' ------ '1992-10-06' ------ '1992-10-20' ------ '1992-11-01' ------ '1992-11-11' ------ '1992-11-22' ------ '1992-12-06' ------ '1992-12-19' ------ '1992-12-30' ------ '1993-01-12' ------ '1993-01-25' ------ '1993-02-08' ------ '1993-02-22' ------ '1993-03-04' ------ '1993-03-19' ------ '1993-03-30' ------ '1993-04-11' ------ '1993-04-26' ------ '1993-05-08' ------ '1993-05-19' ------ '1993-05-31' ------ '1993-06-13' ------ '1993-06-27' ------ '1993-07-08' ------ '1993-07-25' ------ '1993-08-06' ------ '1993-08-19' ------ '1993-09-01' ------ '1993-09-13' ------ '1993-09-23' ------ '1993-10-07' ------ '1993-10-18' ------ '1993-10-29' ------ '1993-11-07' ------ '1993-11-20' ------ '1993-12-02' ------ '1993-12-13' ------ '1993-12-24' ------ '1994-01-06' ------ '1994-01-17' ------ '1994-01-28' ------ '1994-02-10' ------ '1994-02-24' ------ '1994-03-08' ------ '1994-03-22' ------ '1994-04-01' ------ '1994-04-14' ------ '1994-04-26' ------ '1994-05-06' ------ '1994-05-19' ------ '1994-06-02' ------ '1994-06-17' ------ '1994-06-29' ------ '1994-07-13' ------ '1994-07-24' ------ '1994-08-05' ------ '1994-08-15' ------ '1994-08-28' ------ '1994-09-10' ------ '1994-09-24' ------ '1994-10-08' ------ '1994-10-19' ------ '1994-10-30' ------ '1994-11-11' ------ '1994-11-22' ------ '1994-12-05' ------ '1994-12-16' ------ '1994-12-27' ------ '1995-01-09' ------ '1995-01-18' ------ '1995-01-31' ------ '1995-02-14' ------ '1995-02-25' ------ '1995-03-10' -------- '1995-03-14'
 │         │    │    │    │    ├── key: (11)
 │         │    │    │    │    ├── fd: (11)-->(12,15,18)
 │         │    │    │    │    ├── scan orders
 │         │    │    │    │    │    ├── save-table-name: q3_scan_8
 │         │    │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) o_shippriority:18(int!null)
 │         │    │    │    │    │    ├── stats: [rows=1500000, distinct(11)=1500000, null(11)=0, distinct(12)=99853, null(12)=0, distinct(15)=2406, null(15)=0, distinct(18)=1, null(18)=0]
 │         │    │    │    │    │    │   histogram(11)=  0           0            0   1   7467    1    7588    1    7536    1    7704    1     7459    1     7582    1     7312    1     7646    1     7340    1     7473    1     7450    1     7280    1     7621    1     7455    1     7522    1     7437    1     7502    1     7613    1     7242    1     7481    1     7519    1     7572    1     7498    1     7519    1     7534    1     7573    1     7520    1     7333    1     7605    1     7618    1     7403    1     7232    1     7556    1     7339     1     7586     1     7577     1     7543     1     7303     1     7478     1     7698     1     7524     1     7382     1     7358     1     7664     1     7502     1     7350     1     7774     1     7467     1     7388     1     7618     1     7469     1     7354     1     7386     1     7586     1     7380     1     7509     1     7567     1     7695     1     7596     1     7493     1     7769     1     7469     1     7709     1     7584     1     7467     1     7599     1     7321     1     7368     1     7560     1     7514     1     7434     1     7805     1     7380     1     7432     1     7664     1     7746     1     7631     1     7476     1     7385     1     7593     1     7640     1     7593     1     7725     1     7647     1     7465     1     7514     1     7217     1     7340     1     7649     1     7524     1     7484     1     7359     1     7573     1     7350     1     7492     1     7498     1     7510     1     7331     1     7549     1     7512     1     7484     1     7633     1     7517     1     7467     1     7397     1     7585     1     7498     1     7896     1     7505     1     7420     1     7678     1     7793     1     7385     1     7385     1     7426     1     7609     1     7462     1     7345     1     7393     1     7537     1     7375     1     7303     1     7298     1     7531     1     7334     1     7437     1     7510     1     7548     1     7440     1     7320     1     7458     1     7727     1     7373     1     7517     1     7257     1     7400     1     7495     1     7471     1     7726     1     7454     1     7559     1     7369     1     7490     1     7563     1     7627     1     7433     1     7373     1     7514     1     7670     1     7503     1     7650     1     7496     1     7552     1     7439     1     7641     1     7502     1     7512     1     7499     1     7616     1     7470     1     7778     1     7703     1     7752     1     7547     1     7646     1     7622     1     7656     1     7495     1     7676     1     7840     1     7651     1     7757     1     7761     1     7781     1     7701     1     7492     1     7603     1     7504     1     7855     1     7841     1     7501     1     7755     1     7408     1     7513     1     7733     1     7401     1     7679     1     7451     1     7630     1     7574     1     7705     1     7673     1     8053     1     7847     1     7699     1     7651     1     7740     1     7840     1     7667     1     0           0
 │         │    │    │    │    │    │                 <--- -9223372036854775808 --- 101 ------ 29157 ------ 61863 ------ 92999 ------ 129156 ------ 157991 ------ 190502 ------ 214884 ------ 249314 ------ 274532 ------ 303776 ------ 332320 ------ 355714 ------ 389377 ------ 418086 ------ 448803 ------ 476966 ------ 507076 ------ 540513 ------ 562754 ------ 592226 ------ 622853 ------ 655073 ------ 685059 ------ 715683 ------ 746757 ------ 779008 ------ 809670 ------ 834690 ------ 867879 ------ 901479 ------ 928615 ------ 950533 ------ 982278 ------ 1007489 ------ 1040134 ------ 1072484 ------ 1103842 ------ 1127938 ------ 1157319 ------ 1193281 ------ 1224068 ------ 1250567 ------ 1276354 ------ 1311328 ------ 1341440 ------ 1366977 ------ 1405216 ------ 1434274 ------ 1460965 ------ 1494564 ------ 1523686 ------ 1549351 ------ 1575968 ------ 1608611 ------ 1635047 ------ 1665378 ------ 1697440 ------ 1733315 ------ 1766247 ------ 1796096 ------ 1834183 ------ 1863302 ------ 1899591 ------ 1932163 ------ 1961216 ------ 1994246 ------ 2018885 ------ 2044965 ------ 2076805 ------ 2107271 ------ 2135332 ------ 2174497 ------ 2200929 ------ 2228928 ------ 2263876 ------ 2301283 ------ 2335268 ------ 2364615 ------ 2391201 ------ 2424034 ------ 2458275 ------ 2491110 ------ 2527878 ------ 2562343 ------ 2591331 ------ 2621792 ------ 2643264 ------ 2668485 ------ 2703013 ------ 2733795 ------ 2763365 ------ 2789154 ------ 2821410 ------ 2846946 ------ 2876774 ------ 2906755 ------ 2937121 ------ 2962086 ------ 2993602 ------ 3024004 ------ 3053568 ------ 3087618 ------ 3118176 ------ 3147237 ------ 3174180 ------ 3206791 ------ 3236775 ------ 3278628 ------ 3308834 ------ 3336486 ------ 3371879 ------ 3410690 ------ 3437284 ------ 3463873 ------ 3491715 ------ 3525026 ------ 3553926 ------ 3579297 ------ 3606117 ------ 3637285 ------ 3663559 ------ 3687650 ------ 3711588 ------ 3742565 ------ 3767622 ------ 3795781 ------ 3826148 ------ 3857635 ------ 3885890 ------ 3910499 ------ 3939297 ------ 3976133 ------ 4002372 ------ 4032928 ------ 4055618 ------ 4082657 ------ 4112550 ------ 4141734 ------ 4178532 ------ 4207203 ------ 4239013 ------ 4265127 ------ 4294885 ------ 4326821 ------ 4360679 ------ 4388710 ------ 4414947 ------ 4445413 ------ 4480550 ------ 4510688 ------ 4541253 ------ 4567175 ------ 4594788 ------ 4618983 ------ 4649284 ------ 4675396 ------ 4701797 ------ 4727808 ------ 4757344 ------ 4782470 ------ 4816867 ------ 4849026 ------ 4882661 ------ 4910144 ------ 4940582 ------ 4970307 ------ 5001057 ------ 5026949 ------ 5058309 ------ 5094560 ------ 5125156 ------ 5158945 ------ 5192832 ------ 5227332 ------ 5259426 ------ 5285222 ------ 5314368 ------ 5340545 ------ 5377254 ------ 5413540 ------ 5439617 ------ 5473345 ------ 5496579 ------ 5523009 ------ 5556065 ------ 5579106 ------ 5610562 ------ 5635110 ------ 5665088 ------ 5693382 ------ 5725604 ------ 5756865 ------ 5799463 ------ 5835940 ------ 5867972 ------ 5898564 ------ 5931842 ------ 5968099 ------ 5999174 --- 9223372036854775807
 │         │    │    │    │    │    │   histogram(12)=  0 150  7350  150  7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350  150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   300   7350   150   7200   300   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   300   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7200   300   7350   150   7350   150   7350   150   7350   300   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150   7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7350   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7350   300    7500   150    7500   150    7500   150    7500   150    7350   300    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7350   300    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   150    7500   450    7350   150    7350   150    7500   150    7350   300    7500   150
 │         │    │    │    │    │    │                 <--- 55 ------ 790 ------ 1459 ------ 2269 ------ 2942 ------ 3716 ------ 4582 ------ 5348 ------ 6293 ------ 7075 ------ 7786 ------ 8321 ------ 9109 ------ 9818 ------ 10513 ------ 11303 ------ 12200 ------ 12751 ------ 13376 ------ 14149 ------ 15037 ------ 15745 ------ 16669 ------ 17477 ------ 18280 ------ 19087 ------ 19733 ------ 20521 ------ 21415 ------ 22000 ------ 22862 ------ 23635 ------ 24373 ------ 25108 ------ 25792 ------ 26567 ------ 27310 ------ 27872 ------ 28472 ------ 29326 ------ 30151 ------ 30941 ------ 31582 ------ 32254 ------ 33014 ------ 33710 ------ 34435 ------ 35279 ------ 35993 ------ 36554 ------ 37285 ------ 37954 ------ 38672 ------ 39487 ------ 40202 ------ 41179 ------ 41819 ------ 42982 ------ 43816 ------ 44593 ------ 45305 ------ 46042 ------ 46984 ------ 47666 ------ 48290 ------ 49043 ------ 49771 ------ 50648 ------ 51256 ------ 51952 ------ 52664 ------ 53557 ------ 54316 ------ 54944 ------ 55568 ------ 56216 ------ 57046 ------ 57790 ------ 58669 ------ 59422 ------ 60140 ------ 60866 ------ 61751 ------ 62389 ------ 63025 ------ 63938 ------ 64714 ------ 65590 ------ 66287 ------ 66971 ------ 67606 ------ 68362 ------ 69067 ------ 69734 ------ 70337 ------ 71044 ------ 71819 ------ 72409 ------ 73184 ------ 73882 ------ 74738 ------ 75400 ------ 76231 ------ 77012 ------ 77644 ------ 78257 ------ 79096 ------ 79825 ------ 80666 ------ 81274 ------ 82141 ------ 82897 ------ 83573 ------ 84382 ------ 85079 ------ 86012 ------ 86723 ------ 87550 ------ 88408 ------ 89281 ------ 89923 ------ 90535 ------ 91391 ------ 92074 ------ 92834 ------ 93662 ------ 94226 ------ 94789 ------ 95557 ------ 96380 ------ 97286 ------ 98120 ------ 98845 ------ 99701 ------ 100490 ------ 101245 ------ 102049 ------ 102842 ------ 103529 ------ 104257 ------ 104921 ------ 105884 ------ 106564 ------ 107359 ------ 108074 ------ 108649 ------ 109279 ------ 110113 ------ 110851 ------ 111673 ------ 112613 ------ 113420 ------ 114133 ------ 114799 ------ 115594 ------ 116143 ------ 116828 ------ 117557 ------ 118388 ------ 118996 ------ 119759 ------ 120392 ------ 121109 ------ 121955 ------ 122657 ------ 123398 ------ 124151 ------ 125182 ------ 126043 ------ 126797 ------ 127508 ------ 128479 ------ 129296 ------ 130061 ------ 130889 ------ 131720 ------ 132667 ------ 133645 ------ 134407 ------ 135337 ------ 136195 ------ 137005 ------ 137843 ------ 138577 ------ 139199 ------ 140053 ------ 140933 ------ 141712 ------ 142391 ------ 143194 ------ 144019 ------ 144740 ------ 145505 ------ 146173 ------ 146758 ------ 147472 ------ 148079 ------ 148774 ------ 149287 ------ 149993
 │         │    │    │    │    │    │   histogram(15)=  0      600       7350      900       7200      1200      7350      900       7200      900       7200      600       6000      1800      7350      300       7350      600       7200      450       7050      1050      7050      900       7350      750       7050      1050      7200      750       7200      1200      7050      450       6900      750       6600      1200      7200      150       6600      900       6900      900       7200      450       7200      1050      7200      300       6300      1050      7200      1050      7200      600       6600      1350      6750      900       6900      750       7050      450       6900      450       7200      750       6900      1200      7050      300       6900      450       6900      900       6900      900       7200      600       6750      750       6750      900       6900      1050      6900      750       6750      1200      7200      1200      7050      450       6900      1200      6750      600       6900      750       6900      750       7200      300       6150      1350      7050      1200      6450      900       6750      1200      6750      1350      7050      900       7050      900       7050      600       5850      1650      6900      1200      6750      1200      7050      600       7200      750       7200      450       6150      1350      6750      1050      6900      600       7200      300       6900      600       7050      300       6600      900       7200      600       7200      900       6750      1050      7200      900       6750      900       6750      900       6300      1350      6750      600       6300      1350      7050      300       6300      1050      6750      1050      6900      900       7200      750       7050      750       6600      750       6900      900       6900      900       6900      900       6450      1050      7050      600       7050      450       7050      1650      7050      1050      6150      1050      6900      750       6450      750       6750      600       7050      600       6600      750       6450      1200      7050      150       6450      900       7050      300       7050      1050      6900      750       6900      300       7050      750       6750      1050      7050      600       6750      750       6900      1050      7050      600       6900      450       6450      900       6900      1200      6600      1350      7050      1050      6900      300       6600      1050      6900      600       6450      1200      6150      1050      7050      600       7050      450       6900      300       6600      1050      7050      600       6150      900       6300      1050      6300      750       6750      1050      6750      1050      6300      900       6600      900       6450      750       6750      1350      6900      900       6600      600       6900      600       6750      1500      6150      1050      6750      600       6750      600       6000      1050      6750      300       6750      450       5700      1350      6900      150       6900      300       6600      600       6900      750       6900      1200      6750      750       6150      900       6750      600       6450      600       6600      600       6750      600       6000      900       6300      600       6600      750       6300      750       6600      300       6600      750       6450      450       6150      1200      6600      450       6750      600       6600      450       6750      750       6600      450       5700      1200      6150      900       6600      600       5850      1800      5850      1350      6450      750       6750      450       6750      300       6600      450       6600      1050      6300      750       6000      750       6300      750       6300      750       6000      900       6000      750       6150      1050      6600      600       6300      750       6450      150       6150      750       6000      450       5700      1050      6000      900       5700      450
 │         │    │    │    │    │    │                 <--- '1992-01-01' ------ '1992-01-13' ------ '1992-01-25' ------ '1992-02-13' ------ '1992-02-22' ------ '1992-03-05' ------ '1992-03-16' ------ '1992-03-29' ------ '1992-04-13' ------ '1992-04-25' ------ '1992-05-07' ------ '1992-05-18' ------ '1992-06-04' ------ '1992-06-18' ------ '1992-07-01' ------ '1992-07-13' ------ '1992-07-25' ------ '1992-08-08' ------ '1992-08-19' ------ '1992-09-01' ------ '1992-09-10' ------ '1992-09-22' ------ '1992-10-06' ------ '1992-10-20' ------ '1992-11-01' ------ '1992-11-11' ------ '1992-11-22' ------ '1992-12-06' ------ '1992-12-19' ------ '1992-12-30' ------ '1993-01-12' ------ '1993-01-25' ------ '1993-02-08' ------ '1993-02-22' ------ '1993-03-04' ------ '1993-03-19' ------ '1993-03-30' ------ '1993-04-11' ------ '1993-04-26' ------ '1993-05-08' ------ '1993-05-19' ------ '1993-05-31' ------ '1993-06-13' ------ '1993-06-27' ------ '1993-07-08' ------ '1993-07-25' ------ '1993-08-06' ------ '1993-08-19' ------ '1993-09-01' ------ '1993-09-13' ------ '1993-09-23' ------ '1993-10-07' ------ '1993-10-18' ------ '1993-10-29' ------ '1993-11-07' ------ '1993-11-20' ------ '1993-12-02' ------ '1993-12-13' ------ '1993-12-24' ------ '1994-01-06' ------ '1994-01-17' ------ '1994-01-28' ------ '1994-02-10' ------ '1994-02-24' ------ '1994-03-08' ------ '1994-03-22' ------ '1994-04-01' ------ '1994-04-14' ------ '1994-04-26' ------ '1994-05-06' ------ '1994-05-19' ------ '1994-06-02' ------ '1994-06-17' ------ '1994-06-29' ------ '1994-07-13' ------ '1994-07-24' ------ '1994-08-05' ------ '1994-08-15' ------ '1994-08-28' ------ '1994-09-10' ------ '1994-09-24' ------ '1994-10-08' ------ '1994-10-19' ------ '1994-10-30' ------ '1994-11-11' ------ '1994-11-22' ------ '1994-12-05' ------ '1994-12-16' ------ '1994-12-27' ------ '1995-01-09' ------ '1995-01-18' ------ '1995-01-31' ------ '1995-02-14' ------ '1995-02-25' ------ '1995-03-10' ------ '1995-03-24' ------ '1995-04-07' ------ '1995-04-16' ------ '1995-04-30' ------ '1995-05-11' ------ '1995-05-26' ------ '1995-06-10' ------ '1995-06-20' ------ '1995-07-03' ------ '1995-07-17' ------ '1995-07-29' ------ '1995-08-11' ------ '1995-08-23' ------ '1995-09-02' ------ '1995-09-14' ------ '1995-09-28' ------ '1995-10-10' ------ '1995-10-22' ------ '1995-11-04' ------ '1995-11-16' ------ '1995-11-30' ------ '1995-12-12' ------ '1995-12-24' ------ '1996-01-05' ------ '1996-01-15' ------ '1996-01-28' ------ '1996-02-10' ------ '1996-02-22' ------ '1996-03-07' ------ '1996-03-18' ------ '1996-03-27' ------ '1996-04-09' ------ '1996-04-23' ------ '1996-05-06' ------ '1996-05-17' ------ '1996-05-28' ------ '1996-06-09' ------ '1996-06-19' ------ '1996-06-30' ------ '1996-07-10' ------ '1996-07-24' ------ '1996-08-06' ------ '1996-08-16' ------ '1996-08-27' ------ '1996-09-09' ------ '1996-09-21' ------ '1996-10-04' ------ '1996-10-16' ------ '1996-10-26' ------ '1996-11-07' ------ '1996-11-20' ------ '1996-12-02' ------ '1996-12-13' ------ '1996-12-28' ------ '1997-01-09' ------ '1997-01-18' ------ '1997-01-30' ------ '1997-02-08' ------ '1997-02-21' ------ '1997-03-08' ------ '1997-03-18' ------ '1997-04-01' ------ '1997-04-10' ------ '1997-04-22' ------ '1997-05-03' ------ '1997-05-13' ------ '1997-05-22' ------ '1997-06-01' ------ '1997-06-13' ------ '1997-06-28' ------ '1997-07-10' ------ '1997-07-19' ------ '1997-08-01' ------ '1997-08-12' ------ '1997-08-22' ------ '1997-09-04' ------ '1997-09-18' ------ '1997-10-03' ------ '1997-10-17' ------ '1997-10-29' ------ '1997-11-11' ------ '1997-11-23' ------ '1997-12-08' ------ '1997-12-19' ------ '1997-12-31' ------ '1998-01-14' ------ '1998-01-25' ------ '1998-02-07' ------ '1998-02-16' ------ '1998-02-26' ------ '1998-03-07' ------ '1998-03-18' ------ '1998-03-28' ------ '1998-04-09' ------ '1998-04-19' ------ '1998-04-28' ------ '1998-05-07' ------ '1998-05-18' ------ '1998-05-28' ------ '1998-06-09' ------ '1998-06-19' ------ '1998-07-01' ------ '1998-07-12' ------ '1998-07-23' ------ '1998-08-02'
 │         │    │    │    │    │    │   histogram(18)=  0 1.5e+06
 │         │    │    │    │    │    │                 <----- 0 --
 │         │    │    │    │    │    ├── key: (11)
 │         │    │    │    │    │    └── fd: (11)-->(12,15,18)
 │         │    │    │    │    └── filters
 │         │    │    │    │         └── o_orderdate:15 < '1995-03-15' [type=bool, outer=(15), constraints=(/15: (/NULL - /'1995-03-14']; tight)]
 │         │    │    │    ├── select
 │         │    │    │    │    ├── save-table-name: q3_select_9
 │         │    │    │    │    ├── columns: c_custkey:1(int!null) c_mktsegment:7(char!null)
 │         │    │    │    │    ├── stats: [rows=30385, distinct(1)=30358.6191, null(1)=0, distinct(7)=1, null(7)=0]
 │         │    │    │    │    │   histogram(7)=  0    30385
 │         │    │    │    │    │                <--- 'BUILDING'
 │         │    │    │    │    ├── key: (1)
 │         │    │    │    │    ├── fd: ()-->(7)
 │         │    │    │    │    ├── scan customer
 │         │    │    │    │    │    ├── save-table-name: q3_scan_10
 │         │    │    │    │    │    ├── columns: c_custkey:1(int!null) c_mktsegment:7(char!null)
 │         │    │    │    │    │    ├── stats: [rows=150000, distinct(1)=148813, null(1)=0, distinct(7)=5, null(7)=0]
 │         │    │    │    │    │    │   histogram(1)=  0  6   772   6   839   6    793   6    666   6    657   6    737   6    787   6    755   6    621   6    752   6    707   6    714   6    756   6    727    6    859    6    729    6    664    6    754    6    751    6    650    6    797    6    718    6    729    6    729    6    807    6    830    6    793    6    673    6    733    6    762    6    690    6    706    6    889    6    728    6    768    6    743    6    734    6    754    6    744    6    753    6    805    6    679    6    757    6    706    6    802    6    687    6    787    6    778    6    780    6    829    6    748    6    718    6    838    6    746    6    700    6    783    6    792    6    698    6    770    6    771    6    713    6    692    6    803    6    680    6    684    6    677    6    693    6    700    6    766    6    749    6    664    6    783    6    699    6    787    6    698    6    702    6    726    6    704    6    662    6    754    6    832    6    646    6    748    6    760    6    689    6    725    6    690    6    758    6    719    6    691    6    650    6    741    6    725    6    703    6    741    6    773    6    773    6    662    6    717    6    748    6    956    6    761    6    726    6    649    6    712    6    768    6    695    6    717    6    736    6    721    6    748    6    690    6    728    6    790    6    633    6    778    6    935    6    664    6    688    6    683    6    693    6    741    6    729    6    731    6    798    6    689    6    677    6    774    6    817    6    821    6    773    6    724    6    714    6    687    6    716    6     857    6     804    6     822    6     875    6     645    6     787    6     718    6     801    6     762    6     757    6     747    6     635    6     688    6     822    6     675    6     726    6     809    6     784    6     681    6     777    6     704    6     901    6     805    6     818    6     656    6     731    6     719    6     721    6     833    6     798    6     779    6     814    6     745    6     773    6     783    6     790    6     876    6     746    6     728    6     774    6     802    6     709    6     694    6     805    6     771    6     731    6     702    6     683    6     835    6     718    6     716    6     732    6     756    6     795    6     697    6     736    6     817    6     825    6     797    6     808    6     856    6     715    6     797    6     715    6
 │         │    │    │    │    │    │                <--- 24 ----- 831 ----- 1757 ----- 2603 ----- 3203 ----- 3785 ----- 4528 ----- 5363 ----- 6140 ----- 6637 ----- 7408 ----- 8093 ----- 8791 ----- 9570 ----- 10294 ----- 11255 ----- 11983 ----- 12580 ----- 13354 ----- 14124 ----- 14691 ----- 15543 ----- 16249 ----- 16977 ----- 17705 ----- 18576 ----- 19486 ----- 20332 ----- 20948 ----- 21684 ----- 22474 ----- 23126 ----- 23810 ----- 24820 ----- 25546 ----- 26346 ----- 27101 ----- 27839 ----- 28613 ----- 29370 ----- 30143 ----- 31009 ----- 31638 ----- 32418 ----- 33101 ----- 33962 ----- 34607 ----- 35441 ----- 36260 ----- 37083 ----- 37992 ----- 38756 ----- 39463 ----- 40388 ----- 41148 ----- 41819 ----- 42646 ----- 43490 ----- 44157 ----- 44961 ----- 45767 ----- 46464 ----- 47120 ----- 47983 ----- 48614 ----- 49253 ----- 49877 ----- 50534 ----- 51206 ----- 52003 ----- 52768 ----- 53364 ----- 54191 ----- 54861 ----- 55696 ----- 56364 ----- 57039 ----- 57761 ----- 58441 ----- 59034 ----- 59809 ----- 60723 ----- 61281 ----- 62045 ----- 62830 ----- 63479 ----- 64200 ----- 64852 ----- 65634 ----- 66342 ----- 66995 ----- 67560 ----- 68311 ----- 69032 ----- 69710 ----- 70461 ----- 71270 ----- 72079 ----- 72672 ----- 73377 ----- 74140 ----- 75260 ----- 76048 ----- 76770 ----- 77334 ----- 78029 ----- 78829 ----- 79490 ----- 80195 ----- 80937 ----- 81649 ----- 82413 ----- 83064 ----- 83790 ----- 84631 ----- 85157 ----- 85975 ----- 87062 ----- 87659 ----- 88305 ----- 88942 ----- 89599 ----- 90349 ----- 91076 ----- 91807 ----- 92661 ----- 93310 ----- 93934 ----- 94746 ----- 95634 ----- 96529 ----- 97339 ----- 98058 ----- 98757 ----- 99401 ----- 100103 ----- 101060 ----- 101925 ----- 102821 ----- 103809 ----- 104364 ----- 105198 ----- 105905 ----- 106764 ----- 107554 ----- 108335 ----- 109096 ----- 109627 ----- 110274 ----- 111171 ----- 111792 ----- 112499 ----- 113362 ----- 114180 ----- 114796 ----- 115600 ----- 116264 ----- 117284 ----- 118139 ----- 119017 ----- 119578 ----- 120295 ----- 120990 ----- 121688 ----- 122593 ----- 123435 ----- 124244 ----- 125116 ----- 125861 ----- 126659 ----- 127474 ----- 128302 ----- 129281 ----- 130028 ----- 130739 ----- 131538 ----- 132388 ----- 133062 ----- 133705 ----- 134560 ----- 135353 ----- 136070 ----- 136729 ----- 137349 ----- 138257 ----- 138949 ----- 139638 ----- 140358 ----- 141124 ----- 141961 ----- 142611 ----- 143338 ----- 144215 ----- 145106 ----- 145947 ----- 146808 ----- 147752 ----- 148439 ----- 149280 ----- 149967
 │         │    │    │    │    │    │   histogram(7)=  0     28770      91155     30075
 │         │    │    │    │    │    │                <--- 'AUTOMOBILE' ------- 'MACHINERY'
 │         │    │    │    │    │    ├── key: (1)
 │         │    │    │    │    │    └── fd: (1)-->(7)
 │         │    │    │    │    └── filters
 │         │    │    │    │         └── c_mktsegment:7 = 'BUILDING' [type=bool, outer=(7), constraints=(/7: [/'BUILDING' - /'BUILDING']; tight), fd=()-->(7)]
 │         │    │    │    └── filters
 │         │    │    │         └── c_custkey:1 = o_custkey:12 [type=bool, outer=(1,12), constraints=(/1: (/NULL - ]; /12: (/NULL - ]), fd=(1)==(12), (12)==(1)]
 │         │    │    └── filters
 │         │    │         └── l_shipdate:32 > '1995-03-15' [type=bool, outer=(32), constraints=(/32: [/'1995-03-16' - ]; tight)]
 │         │    └── projections
 │         │         └── l_extendedprice:27 * (1.0 - l_discount:28) [as=column40:40, type=float, outer=(27,28), immutable]
 │         └── aggregations
 │              ├── sum [as=sum:41, type=float, outer=(40)]
 │              │    └── column40:40 [type=float]
 │              ├── const-agg [as=o_orderdate:15, type=date, outer=(15)]
 │              │    └── o_orderdate:15 [type=date]
 │              └── const-agg [as=o_shippriority:18, type=int, outer=(18)]
 │                   └── o_shippriority:18 [type=int]
 └── 10 [type=int]

----Stats for q3_limit_1----
column_names      row_count  distinct_count  null_count
{l_orderkey}      10         10              0
{o_orderdate}     10         8               0
{o_shippriority}  10         1               0
{revenue}         10         10              0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}      10.00          1.00           10.00               1.00                0.00            1.00
{o_orderdate}     10.00          1.00           10.00               1.25                0.00            1.00
{o_shippriority}  10.00          1.00           10.00               10.00 <==           0.00            1.00
{revenue}         10.00          1.00           10.00               1.00                0.00            1.00

----Stats for q3_sort_2----
column_names      row_count  distinct_count  null_count
{l_orderkey}      0          0               0
{o_orderdate}     0          0               0
{o_shippriority}  0          0               0
{sum}             0          0               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}      358055.00      +Inf <==       358055.00           +Inf <==            0.00            1.00
{o_orderdate}     358055.00      +Inf <==       358055.00           +Inf <==            0.00            1.00
{o_shippriority}  358055.00      +Inf <==       358055.00           +Inf <==            0.00            1.00
{sum}             358055.00      +Inf <==       358055.00           +Inf <==            0.00            1.00

----Stats for q3_group_by_3----
column_names      row_count  distinct_count  null_count
{l_orderkey}      11620      11611           0
{o_orderdate}     11620      120             0
{o_shippriority}  11620      1               0
{sum}             11620      11601           0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_orderkey}      358055.00      30.81 <==      358055.00           30.84 <==           0.00            1.00
{o_orderdate}     358055.00      30.81 <==      358055.00           2983.79 <==         0.00            1.00
{o_shippriority}  358055.00      30.81 <==      358055.00           358055.00 <==       0.00            1.00
{sum}             358055.00      30.81 <==      358055.00           30.86 <==           0.00            1.00

----Stats for q3_project_4----
column_names      row_count  distinct_count  null_count
{column40}        30519      30424           0
{l_orderkey}      30519      11611           0
{o_orderdate}     30519      120             0
{o_shippriority}  30519      1               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{column40}        491642.00      16.11 <==      407586.00           13.40 <==           0.00            1.00
{l_orderkey}      491642.00      16.11 <==      358055.00           30.84 <==           0.00            1.00
{o_orderdate}     491642.00      16.11 <==      1169.00             9.74 <==            0.00            1.00
{o_shippriority}  491642.00      16.11 <==      1.00                1.00                0.00            1.00

----Stats for q3_lookup_join_5----
column_names       row_count  distinct_count  null_count
{c_custkey}        30519      8643            0
{c_mktsegment}     30519      1               0
{l_discount}       30519      11              0
{l_extendedprice}  30519      30042           0
{l_orderkey}       30519      11611           0
{l_shipdate}       30519      120             0
{o_custkey}        30519      8643            0
{o_orderdate}      30519      120             0
{o_orderkey}       30519      11611           0
{o_shippriority}   30519      1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        491642.00      16.11 <==      30359.00            3.51 <==            0.00            1.00
{c_mktsegment}     491642.00      16.11 <==      1.00                1.00                0.00            1.00
{l_discount}       491642.00      16.11 <==      11.00               1.00                0.00            1.00
{l_extendedprice}  491642.00      16.11 <==      365083.00           12.15 <==           0.00            1.00
{l_orderkey}       491642.00      16.11 <==      358055.00           30.84 <==           0.00            1.00
{l_shipdate}       491642.00      16.11 <==      1356.00             11.30 <==           0.00            1.00
{o_custkey}        491642.00      16.11 <==      30359.00            3.51 <==            0.00            1.00
{o_orderdate}      491642.00      16.11 <==      1169.00             9.74 <==            0.00            1.00
{o_orderkey}       491642.00      16.11 <==      358055.00           30.84 <==           0.00            1.00
{o_shippriority}   491642.00      16.11 <==      1.00                1.00                0.00            1.00

----Stats for q3_inner_join_6----
column_names      row_count  distinct_count  null_count
{c_custkey}       147126     20129           0
{c_mktsegment}    147126     1               0
{o_custkey}       147126     20129           0
{o_orderdate}     147126     1169            0
{o_orderkey}      147126     145236          0
{o_shippriority}  147126     1               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}       222776.00      1.51           30359.00            1.51                0.00            1.00
{c_mktsegment}    222776.00      1.51           1.00                1.00                0.00            1.00
{o_custkey}       222776.00      1.51           30359.00            1.51                0.00            1.00
{o_orderdate}     222776.00      1.51           1169.00             1.00                0.00            1.00
{o_orderkey}      222776.00      1.51           192072.00           1.32                0.00            1.00
{o_shippriority}  222776.00      1.51           1.00                1.00                0.00            1.00

----Stats for q3_select_7----
column_names      row_count  distinct_count  null_count
{o_custkey}       727305     99492           0
{o_orderdate}     727305     1169            0
{o_orderkey}      727305     730170          0
{o_shippriority}  727305     1               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}       732069.00      1.01           99849.00            1.00                0.00            1.00
{o_orderdate}     732069.00      1.01           1169.00             1.00                0.00            1.00
{o_orderkey}      732069.00      1.01           732069.00           1.00                0.00            1.00
{o_shippriority}  732069.00      1.01           1.00                1.00                0.00            1.00

----Stats for q3_scan_8----
column_names      row_count  distinct_count  null_count
{o_custkey}       1500000    99846           0
{o_orderdate}     1500000    2406            0
{o_orderkey}      1500000    1527270         0
{o_shippriority}  1500000    1               0
~~~~
column_names      row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}       1500000.00     1.00           99853.00            1.00                0.00            1.00
{o_orderdate}     1500000.00     1.00           2406.00             1.00                0.00            1.00
{o_orderkey}      1500000.00     1.00           1500000.00          1.02                0.00            1.00
{o_shippriority}  1500000.00     1.00           1.00                1.00                0.00            1.00

----Stats for q3_select_9----
column_names    row_count  distinct_count  null_count
{c_custkey}     30142      30101           0
{c_mktsegment}  30142      1               0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}     30385.00       1.01           30359.00            1.01                0.00            1.00
{c_mktsegment}  30385.00       1.01           1.00                1.00                0.00            1.00

----Stats for q3_scan_10----
column_names    row_count  distinct_count  null_count
{c_custkey}     150000     148813          0
{c_mktsegment}  150000     5               0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}     150000.00      1.00           148813.00           1.00                0.00            1.00
{c_mktsegment}  150000.00      1.00           5.00                1.00                0.00            1.00
----
----
