import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q8
# National Market Share
# Determines how the market share of a given nation within a given region has
# changed over two years for a given part type.
#
# The market share for a given nation within a given region is defined as the
# fraction of the revenue, the sum of [l_extendedprice * (1-l_discount)], from
# the products of a specified type in that region that was supplied by suppliers
# from the given nation. The query determines this for the years 1995 and 1996
# presented in this order.
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q8
SELECT
    o_year,
    sum(CASE
        WHEN nation = 'BRAZIL'
            THEN volume
        ELSE 0
    END) / sum(volume) AS mkt_share
FROM (
    SELECT
        extract(year FROM o_orderdate) AS o_year,
        l_extendedprice * (1 - l_discount) AS volume,
        n2.n_name AS nation
    FROM
        part,
        supplier,
        lineitem,
        orders,
        customer,
        nation n1,
        nation n2,
        region
    WHERE
        p_partkey = l_partkey
        AND s_suppkey = l_suppkey
        AND l_orderkey = o_orderkey
        AND o_custkey = c_custkey
        AND c_nationkey = n1.n_nationkey
        AND n1.n_regionkey = r_regionkey
        AND r_name = 'AMERICA'
        AND s_nationkey = n2.n_nationkey
        AND o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31'
        AND p_type = 'ECONOMY ANODIZED STEEL'
    ) AS all_nations
GROUP BY
    o_year
ORDER BY
    o_year;
----
----
sort
 ├── save-table-name: q8_sort_1
 ├── columns: o_year:77(float) mkt_share:82(float!null)
 ├── immutable
 ├── stats: [rows=728.943562, distinct(77)=728.943562, null(77)=0, distinct(82)=728.943562, null(82)=0]
 ├── key: (77)
 ├── fd: (77)-->(82)
 ├── ordering: +77
 └── project
      ├── save-table-name: q8_project_2
      ├── columns: mkt_share:82(float!null) o_year:77(float)
      ├── immutable
      ├── stats: [rows=728.943562, distinct(77)=728.943562, null(77)=0, distinct(82)=728.943562, null(82)=0]
      ├── key: (77)
      ├── fd: (77)-->(82)
      ├── group-by
      │    ├── save-table-name: q8_group_by_3
      │    ├── columns: o_year:77(float) sum:80(float!null) sum:81(float!null)
      │    ├── grouping columns: o_year:77(float)
      │    ├── immutable
      │    ├── stats: [rows=728.943562, distinct(77)=728.943562, null(77)=0, distinct(80)=728.943562, null(80)=0, distinct(81)=728.943562, null(81)=0, distinct(80,81)=728.943562, null(80,81)=0]
      │    ├── key: (77)
      │    ├── fd: (77)-->(80,81)
      │    ├── project
      │    │    ├── save-table-name: q8_project_4
      │    │    ├── columns: column79:79(float!null) o_year:77(float) volume:78(float!null)
      │    │    ├── immutable
      │    │    ├── stats: [rows=4293.47042, distinct(77)=728.943562, null(77)=0, distinct(78)=4259.60805, null(78)=0, distinct(79)=4276.51639, null(79)=0]
      │    │    ├── project
      │    │    │    ├── save-table-name: q8_project_5
      │    │    │    ├── columns: o_year:77(float) volume:78(float!null) n2.n_name:67(char!null)
      │    │    │    ├── immutable
      │    │    │    ├── stats: [rows=4293.47042, distinct(67)=25, null(67)=0, distinct(77)=728.943562, null(77)=0, distinct(78)=4259.60805, null(78)=0, distinct(67,78)=4276.51639, null(67,78)=0]
      │    │    │    ├── inner-join (hash)
      │    │    │    │    ├── save-table-name: q8_inner_join_6
      │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) s_suppkey:12(int!null) s_nationkey:15(int!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_extendedprice:26(float!null) l_discount:27(float!null) o_orderkey:39(int!null) o_custkey:40(int!null) o_orderdate:43(date!null) c_custkey:50(int!null) c_nationkey:53(int!null) n1.n_nationkey:60(int!null) n1.n_regionkey:62(int!null) n2.n_nationkey:66(int!null) n2.n_name:67(char!null) r_regionkey:72(int!null) r_name:73(char!null)
      │    │    │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
      │    │    │    │    ├── stats: [rows=4293.47042, distinct(1)=1332.82088, null(1)=0, distinct(5)=1, null(5)=0, distinct(12)=3485.06258, null(12)=0, distinct(15)=25, null(15)=0, distinct(21)=4214.87861, null(21)=0, distinct(22)=1332.82088, null(22)=0, distinct(23)=3485.06258, null(23)=0, distinct(26)=4257.31918, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=4214.87861, null(39)=0, distinct(40)=3976.98494, null(40)=0, distinct(43)=728.943562, null(43)=0, distinct(50)=3976.98494, null(50)=0, distinct(53)=5, null(53)=0, distinct(60)=5, null(60)=0, distinct(62)=1, null(62)=0, distinct(66)=25, null(66)=0, distinct(67)=25, null(67)=0, distinct(72)=1, null(72)=0, distinct(73)=0.996222107, null(73)=0, distinct(26,27)=4259.60805, null(26,27)=0, distinct(26,27,67)=4276.51639, null(26,27,67)=0]
      │    │    │    │    ├── fd: ()-->(5,73), (12)-->(15), (39)-->(40,43), (50)-->(53), (60)-->(62), (62)==(72), (72)==(62), (53)==(60), (60)==(53), (40)==(50), (50)==(40), (21)==(39), (39)==(21), (12)==(23), (23)==(12), (66)-->(67), (15)==(66), (66)==(15), (1)==(22), (22)==(1)
      │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    ├── save-table-name: q8_inner_join_7
      │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) s_suppkey:12(int!null) s_nationkey:15(int!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_extendedprice:26(float!null) l_discount:27(float!null) o_orderkey:39(int!null) o_custkey:40(int!null) o_orderdate:43(date!null) c_custkey:50(int!null) c_nationkey:53(int!null) n1.n_nationkey:60(int!null) n1.n_regionkey:62(int!null) r_regionkey:72(int!null) r_name:73(char!null)
      │    │    │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
      │    │    │    │    │    ├── stats: [rows=4108.76079, distinct(1)=1332.82088, null(1)=0, distinct(5)=1, null(5)=0, distinct(12)=3364.12137, null(12)=0, distinct(15)=25, null(15)=0, distinct(21)=4037.37477, null(21)=0, distinct(22)=1332.82088, null(22)=0, distinct(23)=3364.12137, null(23)=0, distinct(26)=4080.9205, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=4037.37477, null(39)=0, distinct(40)=3818.29126, null(40)=0, distinct(43)=728.352389, null(43)=0, distinct(50)=3818.29126, null(50)=0, distinct(53)=5, null(53)=0, distinct(60)=5, null(60)=0, distinct(62)=1, null(62)=0, distinct(72)=1, null(72)=0, distinct(73)=0.996222107, null(73)=0]
      │    │    │    │    │    ├── fd: ()-->(5,73), (12)-->(15), (39)-->(40,43), (50)-->(53), (60)-->(62), (62)==(72), (72)==(62), (53)==(60), (60)==(53), (40)==(50), (50)==(40), (21)==(39), (39)==(21), (12)==(23), (23)==(12), (1)==(22), (22)==(1)
      │    │    │    │    │    ├── scan supplier@s_nk
      │    │    │    │    │    │    ├── save-table-name: q8_scan_8
      │    │    │    │    │    │    ├── columns: s_suppkey:12(int!null) s_nationkey:15(int!null)
      │    │    │    │    │    │    ├── stats: [rows=10000, distinct(12)=9920, null(12)=0, distinct(15)=25, null(15)=0]
      │    │    │    │    │    │    │   histogram(12)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49    1
      │    │    │    │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │    │    │    │    │    │    │   histogram(15)=  0 403 0 384 0 391 0 396 0 406 0 396 0 393 0 399 0 406 0 393 0 383  0 398  0 394  0 414  0 422  0 387  0 435  0 403  0 441  0 357  0 394  0 390  0 421  0 411  0 383
      │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    ├── key: (12)
      │    │    │    │    │    │    └── fd: (12)-->(15)
      │    │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    │    ├── save-table-name: q8_inner_join_9
      │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_extendedprice:26(float!null) l_discount:27(float!null) o_orderkey:39(int!null) o_custkey:40(int!null) o_orderdate:43(date!null) c_custkey:50(int!null) c_nationkey:53(int!null) n1.n_nationkey:60(int!null) n1.n_regionkey:62(int!null) r_regionkey:72(int!null) r_name:73(char!null)
      │    │    │    │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(zero-or-one)
      │    │    │    │    │    │    ├── stats: [rows=3855.16447, distinct(1)=1332.82088, null(1)=0, distinct(5)=1, null(5)=0, distinct(21)=3792.90521, null(21)=0, distinct(22)=1332.82088, null(22)=0, distinct(23)=3194.36446, null(23)=0, distinct(26)=3837.22775, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=3792.90521, null(39)=0, distinct(40)=3598.68086, null(40)=0, distinct(43)=727.25442, null(43)=0, distinct(50)=3598.68086, null(50)=0, distinct(53)=5, null(53)=0, distinct(60)=5, null(60)=0, distinct(62)=1, null(62)=0, distinct(72)=1, null(72)=0, distinct(73)=0.996222107, null(73)=0]
      │    │    │    │    │    │    ├── fd: ()-->(5,73), (39)-->(40,43), (50)-->(53), (60)-->(62), (62)==(72), (72)==(62), (53)==(60), (60)==(53), (40)==(50), (50)==(40), (21)==(39), (39)==(21), (1)==(22), (22)==(1)
      │    │    │    │    │    │    ├── inner-join (lookup customer@c_nk)
      │    │    │    │    │    │    │    ├── save-table-name: q8_lookup_join_10
      │    │    │    │    │    │    │    ├── columns: c_custkey:50(int!null) c_nationkey:53(int!null) n1.n_nationkey:60(int!null) n1.n_regionkey:62(int!null) r_regionkey:72(int!null) r_name:73(char!null)
      │    │    │    │    │    │    │    ├── key columns: [60] = [53]
      │    │    │    │    │    │    │    ├── stats: [rows=30000, distinct(50)=27672.3293, null(50)=0, distinct(53)=5, null(53)=0, distinct(60)=5, null(60)=0, distinct(62)=1, null(62)=0, distinct(72)=1, null(72)=0, distinct(73)=0.996222107, null(73)=0]
      │    │    │    │    │    │    │    ├── key: (50)
      │    │    │    │    │    │    │    ├── fd: ()-->(73), (50)-->(53), (60)-->(62), (62)==(72), (72)==(62), (53)==(60), (60)==(53)
      │    │    │    │    │    │    │    ├── inner-join (lookup nation@n_rk [as=n1])
      │    │    │    │    │    │    │    │    ├── save-table-name: q8_lookup_join_11
      │    │    │    │    │    │    │    │    ├── columns: n1.n_nationkey:60(int!null) n1.n_regionkey:62(int!null) r_regionkey:72(int!null) r_name:73(char!null)
      │    │    │    │    │    │    │    │    ├── key columns: [72] = [62]
      │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(60)=5, null(60)=0, distinct(62)=1, null(62)=0, distinct(72)=1, null(72)=0, distinct(73)=0.996222107, null(73)=0]
      │    │    │    │    │    │    │    │    ├── key: (60)
      │    │    │    │    │    │    │    │    ├── fd: ()-->(73), (60)-->(62), (62)==(72), (72)==(62)
      │    │    │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_select_12
      │    │    │    │    │    │    │    │    │    ├── columns: r_regionkey:72(int!null) r_name:73(char!null)
      │    │    │    │    │    │    │    │    │    ├── stats: [rows=1, distinct(72)=1, null(72)=0, distinct(73)=1, null(73)=0]
      │    │    │    │    │    │    │    │    │    │   histogram(73)=  0      1
      │    │    │    │    │    │    │    │    │    │                 <--- 'AMERICA'
      │    │    │    │    │    │    │    │    │    ├── key: (72)
      │    │    │    │    │    │    │    │    │    ├── fd: ()-->(73)
      │    │    │    │    │    │    │    │    │    ├── scan region
      │    │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_scan_13
      │    │    │    │    │    │    │    │    │    │    ├── columns: r_regionkey:72(int!null) r_name:73(char!null)
      │    │    │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(72)=5, null(72)=0, distinct(73)=5, null(73)=0]
      │    │    │    │    │    │    │    │    │    │    │   histogram(72)=  0  1  0  1  0  1  0  1  0  1
      │    │    │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    │    │    │    │   histogram(73)=  0     1      3        1
      │    │    │    │    │    │    │    │    │    │    │                 <--- 'AFRICA' --- 'MIDDLE EAST'
      │    │    │    │    │    │    │    │    │    │    ├── key: (72)
      │    │    │    │    │    │    │    │    │    │    └── fd: (72)-->(73)
      │    │    │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │    │    │         └── r_name:73 = 'AMERICA' [type=bool, outer=(73), constraints=(/73: [/'AMERICA' - /'AMERICA']; tight), fd=()-->(73)]
      │    │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    ├── inner-join (lookup orders)
      │    │    │    │    │    │    │    ├── save-table-name: q8_lookup_join_14
      │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_extendedprice:26(float!null) l_discount:27(float!null) o_orderkey:39(int!null) o_custkey:40(int!null) o_orderdate:43(date!null)
      │    │    │    │    │    │    │    ├── key columns: [21] = [39]
      │    │    │    │    │    │    │    ├── lookup columns are key
      │    │    │    │    │    │    │    ├── stats: [rows=11914.8959, distinct(1)=1332.82088, null(1)=0, distinct(5)=1, null(5)=0, distinct(21)=11759.6437, null(21)=0, distinct(22)=1332.82088, null(22)=0, distinct(23)=6935.4424, null(23)=0, distinct(26)=11828.3576, null(26)=0, distinct(27)=11, null(27)=0, distinct(39)=11759.6437, null(39)=0, distinct(40)=11228.5343, null(40)=0, distinct(43)=730.999939, null(43)=0]
      │    │    │    │    │    │    │    ├── fd: ()-->(5), (39)-->(40,43), (21)==(39), (39)==(21), (1)==(22), (22)==(1)
      │    │    │    │    │    │    │    ├── inner-join (lookup lineitem)
      │    │    │    │    │    │    │    │    ├── save-table-name: q8_lookup_join_15
      │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_suppkey:23(int!null) l_extendedprice:26(float!null) l_discount:27(float!null)
      │    │    │    │    │    │    │    │    ├── key columns: [21 24] = [21 24]
      │    │    │    │    │    │    │    │    ├── lookup columns are key
      │    │    │    │    │    │    │    │    ├── stats: [rows=40152.796, distinct(1)=1332.82088, null(1)=0, distinct(5)=1, null(5)=0, distinct(21)=39629.6695, null(21)=0, distinct(22)=1332.82088, null(22)=0, distinct(23)=9746.76706, null(23)=0, distinct(26)=39334.195, null(26)=0, distinct(27)=11, null(27)=0]
      │    │    │    │    │    │    │    │    ├── fd: ()-->(5), (1)==(22), (22)==(1)
      │    │    │    │    │    │    │    │    ├── inner-join (lookup lineitem@l_pk)
      │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_lookup_join_16
      │    │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) l_orderkey:21(int!null) l_partkey:22(int!null) l_linenumber:24(int!null)
      │    │    │    │    │    │    │    │    │    ├── key columns: [1] = [22]
      │    │    │    │    │    │    │    │    │    ├── stats: [rows=40152.796, distinct(1)=1332.82088, null(1)=0, distinct(5)=1, null(5)=0, distinct(21)=39629.6695, null(21)=0, distinct(22)=1332.82088, null(22)=0, distinct(24)=7, null(24)=0]
      │    │    │    │    │    │    │    │    │    ├── key: (21,24)
      │    │    │    │    │    │    │    │    │    ├── fd: ()-->(5), (21,24)-->(22), (1)==(22), (22)==(1)
      │    │    │    │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_select_17
      │    │    │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null)
      │    │    │    │    │    │    │    │    │    │    ├── stats: [rows=1332.83784, distinct(1)=1332.82088, null(1)=0, distinct(5)=1, null(5)=0]
      │    │    │    │    │    │    │    │    │    │    │   histogram(5)=  0           1332.8
      │    │    │    │    │    │    │    │    │    │    │                <--- 'ECONOMY ANODIZED STEEL'
      │    │    │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    │    │    ├── fd: ()-->(5)
      │    │    │    │    │    │    │    │    │    │    ├── scan part
      │    │    │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_scan_18
      │    │    │    │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null)
      │    │    │    │    │    │    │    │    │    │    │    ├── stats: [rows=200000, distinct(1)=199241, null(1)=0, distinct(5)=150, null(5)=0]
      │    │    │    │    │    │    │    │    │    │    │    │   histogram(1)=  0  4  988   4   1167   4    918   4    1031   4    909   4    1036   4    1047   4    1192   4    943   4    866    4    945    4    1046    4    923    4    1024    4    1113    4    922    4    997    4    1011    4    940    4    1118    4    984    4    1005    4    1257    4    877    4    871    4    1004    4    1005    4    1054    4    963    4    937    4    1008    4    919    4    1001    4    1024    4    896    4    1139    4    1005    4    952    4    834    4    999    4    1063    4    993    4    894    4    1064    4    1004    4    1019    4    952    4    930    4    876    4    926    4    1144    4    1008    4    1025    4    993    4    1097    4    957    4    1073    4    1036    4    1002    4    934    4    1006    4    984    4    972    4    963    4    1055    4    1042    4    1005    4    1075    4    916    4    992    4    884    4    1014    4    1020    4    1092    4    1107    4    873    4    949    4    1037    4    1045    4    903    4    1019    4    942    4    1009    4    970    4    945    4    888    4    948    4    940    4    1036    4    960    4    1025    4    951    4    957    4    1014    4    1004    4    1058    4    1032    4    1063    4    1017    4    1064    4     936    4     1053    4     945    4     933    4     877    4     1043    4     880    4     928    4     1072    4     967    4     985    4     1064    4     1088    4     1000    4     891    4     931    4     1059    4     998    4     886    4     1047    4     961    4     1065    4     1017    4     894    4     1134    4     931    4     857    4     985    4     1184    4     981    4     1034    4     1122    4     1098    4     980    4     1143    4     912    4     948    4     961    4     1072    4     959    4     956    4     883    4     886    4     969    4     887    4     980    4     1058    4     1026    4     850    4     946    4     932    4     1093    4     1047    4     937    4     968    4     1068    4     1097    4     1055    4     1012    4     1066    4     1014    4     981    4     1051    4     988    4     1027    4     978    4     861    4     999    4     1127    4     1102    4     1134    4     1246    4     1036    4     1162    4     970    4     1162    4     875    4     882    4     1029    4     1051    4     999    4     1063    4     903    4     961    4     1017    4     858    4     935    4     1053    4     1066    4     956    4     1037    4     1075    4     928    4     1011    4     1007    4     1010    4     981    4     1249    4     989    4
      │    │    │    │    │    │    │    │    │    │    │    │                <--- 5 ----- 998 ------ 2305 ----- 3162 ------ 4234 ----- 5073 ------ 6153 ------ 7254 ------ 8601 ----- 9507 ----- 10253 ----- 11164 ------ 12263 ----- 13131 ------ 14190 ------ 15405 ----- 16271 ----- 17280 ------ 18316 ----- 19217 ------ 20440 ----- 21425 ------ 22450 ------ 23904 ----- 24676 ----- 25433 ------ 26456 ------ 27481 ------ 28594 ----- 29540 ----- 30435 ------ 31465 ----- 32325 ------ 33342 ------ 34401 ----- 35212 ------ 36472 ------ 37497 ----- 38422 ----- 39095 ----- 40108 ------ 41236 ----- 42238 ----- 43046 ------ 44177 ------ 45200 ------ 46250 ----- 47174 ----- 48055 ----- 48824 ----- 49698 ------ 50966 ------ 51995 ------ 53055 ----- 54057 ------ 55245 ----- 56180 ------ 57326 ------ 58406 ------ 59424 ----- 60313 ------ 61340 ----- 62326 ----- 63288 ----- 64233 ------ 65347 ------ 66438 ------ 67463 ------ 68612 ----- 69464 ----- 70464 ----- 71251 ------ 72292 ------ 73343 ------ 74522 ------ 75727 ----- 76489 ----- 77407 ------ 78489 ------ 79585 ----- 80411 ------ 81460 ----- 82365 ------ 83397 ----- 84356 ----- 85266 ----- 86060 ----- 86976 ----- 87876 ------ 88957 ----- 89897 ------ 90958 ----- 91881 ----- 92816 ------ 93857 ------ 94879 ------ 95998 ------ 97071 ------ 98199 ------ 99245 ------ 100376 ----- 101270 ------ 102380 ----- 103290 ----- 104177 ----- 104949 ------ 106042 ----- 106819 ----- 107696 ------ 108841 ----- 109794 ----- 110781 ------ 111912 ------ 113085 ------ 114100 ----- 114901 ----- 115784 ------ 116905 ----- 117916 ----- 118707 ------ 119807 ----- 120748 ------ 121880 ------ 122926 ----- 123733 ------ 124984 ----- 125868 ----- 126594 ----- 127581 ------ 128915 ----- 129894 ------ 130971 ------ 132201 ------ 133390 ----- 134367 ------ 135633 ----- 136477 ----- 137393 ----- 138335 ------ 139479 ----- 140417 ----- 141350 ----- 142133 ----- 142924 ----- 143881 ----- 144673 ----- 145651 ------ 146771 ------ 147833 ----- 148543 ----- 149455 ----- 150320 ------ 151485 ------ 152569 ----- 153443 ----- 154379 ------ 155500 ------ 156673 ------ 157772 ------ 158792 ------ 159911 ------ 160934 ----- 161896 ------ 162988 ----- 163962 ------ 165009 ----- 165964 ----- 166674 ----- 167669 ------ 168893 ------ 170074 ------ 171310 ------ 172734 ------ 173799 ------ 175083 ----- 176024 ------ 177308 ----- 178050 ----- 178807 ------ 179859 ------ 180951 ----- 181946 ------ 183058 ----- 183863 ----- 184786 ------ 185816 ----- 186519 ----- 187389 ------ 188484 ------ 189602 ----- 190515 ------ 191581 ------ 192716 ----- 193573 ------ 194591 ------ 195602 ------ 196619 ----- 197581 ------ 199010 ----- 199986
      │    │    │    │    │    │    │    │    │    │    │    │   histogram(5)=  0            1580            1.9726e+05           1160
      │    │    │    │    │    │    │    │    │    │    │    │                <--- 'ECONOMY ANODIZED BRASS' ------------ 'STANDARD POLISHED TIN'
      │    │    │    │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    │    │    │    └── fd: (1)-->(5)
      │    │    │    │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │    │    │    │         └── p_type:5 = 'ECONOMY ANODIZED STEEL' [type=bool, outer=(5), constraints=(/5: [/'ECONOMY ANODIZED STEEL' - /'ECONOMY ANODIZED STEEL']; tight), fd=()-->(5)]
      │    │    │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │         └── (o_orderdate:43 >= '1995-01-01') AND (o_orderdate:43 <= '1996-12-31') [type=bool, outer=(43), constraints=(/43: [/'1995-01-01' - /'1996-12-31']; tight)]
      │    │    │    │    │    │    └── filters
      │    │    │    │    │    │         └── o_custkey:40 = c_custkey:50 [type=bool, outer=(40,50), constraints=(/40: (/NULL - ]; /50: (/NULL - ]), fd=(40)==(50), (50)==(40)]
      │    │    │    │    │    └── filters
      │    │    │    │    │         └── s_suppkey:12 = l_suppkey:23 [type=bool, outer=(12,23), constraints=(/12: (/NULL - ]; /23: (/NULL - ]), fd=(12)==(23), (23)==(12)]
      │    │    │    │    ├── scan nation [as=n2]
      │    │    │    │    │    ├── save-table-name: q8_scan_19
      │    │    │    │    │    ├── columns: n2.n_nationkey:66(int!null) n2.n_name:67(char!null)
      │    │    │    │    │    ├── stats: [rows=25, distinct(66)=25, null(66)=0, distinct(67)=25, null(67)=0]
      │    │    │    │    │    │   histogram(66)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │   histogram(67)=  0      1      23      1
      │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    ├── key: (66)
      │    │    │    │    │    └── fd: (66)-->(67)
      │    │    │    │    └── filters
      │    │    │    │         └── s_nationkey:15 = n2.n_nationkey:66 [type=bool, outer=(15,66), constraints=(/15: (/NULL - ]; /66: (/NULL - ]), fd=(15)==(66), (66)==(15)]
      │    │    │    └── projections
      │    │    │         ├── extract('year', o_orderdate:43) [as=o_year:77, type=float, outer=(43), immutable]
      │    │    │         └── l_extendedprice:26 * (1.0 - l_discount:27) [as=volume:78, type=float, outer=(26,27), immutable]
      │    │    └── projections
      │    │         └── CASE WHEN n2.n_name:67 = 'BRAZIL' THEN volume:78 ELSE 0.0 END [as=column79:79, type=float, outer=(67,78)]
      │    └── aggregations
      │         ├── sum [as=sum:80, type=float, outer=(79)]
      │         │    └── column79:79 [type=float]
      │         └── sum [as=sum:81, type=float, outer=(78)]
      │              └── volume:78 [type=float]
      └── projections
           └── sum:80 / sum:81 [as=mkt_share:82, type=float, outer=(80,81), immutable]

----Stats for q8_sort_1----
column_names  row_count  distinct_count  null_count
{mkt_share}   2          2               0
{o_year}      2          2               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{mkt_share}   729.00         364.50 <==     729.00              364.50 <==          0.00            1.00
{o_year}      729.00         364.50 <==     729.00              364.50 <==          0.00            1.00

----Stats for q8_project_2----
column_names  row_count  distinct_count  null_count
{mkt_share}   2          2               0
{o_year}      2          2               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{mkt_share}   729.00         364.50 <==     729.00              364.50 <==          0.00            1.00
{o_year}      729.00         364.50 <==     729.00              364.50 <==          0.00            1.00

----Stats for q8_group_by_3----
column_names  row_count  distinct_count  null_count
{o_year}      2          2               0
{sum_1}       2          2               0
{sum}         2          2               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_year}      729.00         364.50 <==     729.00              364.50 <==          0.00            1.00
{sum}         729.00         364.50 <==     729.00              364.50 <==          0.00            1.00
{sum_1}       729.00         364.50 <==     729.00              364.50 <==          0.00            1.00

----Stats for q8_project_4----
column_names  row_count  distinct_count  null_count
{column79}    2603       108             0
{o_year}      2603       2               0
{volume}      2603       2599            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{column79}    4293.00        1.65           4277.00             39.60 <==           0.00            1.00
{o_year}      4293.00        1.65           729.00              364.50 <==          0.00            1.00
{volume}      4293.00        1.65           4260.00             1.64                0.00            1.00

----Stats for q8_project_5----
column_names  row_count  distinct_count  null_count
{n_name}      2603       25              0
{o_year}      2603       2               0
{volume}      2603       2599            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      4293.00        1.65           25.00               1.00                0.00            1.00
{o_year}      4293.00        1.65           729.00              364.50 <==          0.00            1.00
{volume}      4293.00        1.65           4260.00             1.64                0.00            1.00

----Stats for q8_inner_join_6----
column_names       row_count  distinct_count  null_count
{c_custkey}        2603       2385            0
{c_nationkey}      2603       5               0
{l_discount}       2603       11              0
{l_extendedprice}  2603       2540            0
{l_orderkey}       2603       2567            0
{l_partkey}        2603       1221            0
{l_suppkey}        2603       1895            0
{n_name}           2603       25              0
{n_nationkey_1}    2603       25              0
{n_nationkey}      2603       5               0
{n_regionkey}      2603       1               0
{o_custkey}        2603       2385            0
{o_orderdate}      2603       708             0
{o_orderkey}       2603       2567            0
{p_partkey}        2603       1221            0
{p_type}           2603       1               0
{r_name}           2603       1               0
{r_regionkey}      2603       1               0
{s_nationkey}      2603       25              0
{s_suppkey}        2603       1895            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        4293.00        1.65           3977.00             1.67                0.00            1.00
{c_nationkey}      4293.00        1.65           5.00                1.00                0.00            1.00
{l_discount}       4293.00        1.65           11.00               1.00                0.00            1.00
{l_extendedprice}  4293.00        1.65           4257.00             1.68                0.00            1.00
{l_orderkey}       4293.00        1.65           4215.00             1.64                0.00            1.00
{l_partkey}        4293.00        1.65           1333.00             1.09                0.00            1.00
{l_suppkey}        4293.00        1.65           3485.00             1.84                0.00            1.00
{n_name}           4293.00        1.65           25.00               1.00                0.00            1.00
{n_nationkey}      4293.00        1.65           5.00                1.00                0.00            1.00
{n_nationkey_1}    4293.00        1.65           25.00               1.00                0.00            1.00
{n_regionkey}      4293.00        1.65           1.00                1.00                0.00            1.00
{o_custkey}        4293.00        1.65           3977.00             1.67                0.00            1.00
{o_orderdate}      4293.00        1.65           729.00              1.03                0.00            1.00
{o_orderkey}       4293.00        1.65           4215.00             1.64                0.00            1.00
{p_partkey}        4293.00        1.65           1333.00             1.09                0.00            1.00
{p_type}           4293.00        1.65           1.00                1.00                0.00            1.00
{r_name}           4293.00        1.65           1.00                1.00                0.00            1.00
{r_regionkey}      4293.00        1.65           1.00                1.00                0.00            1.00
{s_nationkey}      4293.00        1.65           25.00               1.00                0.00            1.00
{s_suppkey}        4293.00        1.65           3485.00             1.84                0.00            1.00

----Stats for q8_inner_join_7----
column_names       row_count  distinct_count  null_count
{c_custkey}        2603       2385            0
{c_nationkey}      2603       5               0
{l_discount}       2603       11              0
{l_extendedprice}  2603       2540            0
{l_orderkey}       2603       2567            0
{l_partkey}        2603       1221            0
{l_suppkey}        2603       1895            0
{n_nationkey}      2603       5               0
{n_regionkey}      2603       1               0
{o_custkey}        2603       2385            0
{o_orderdate}      2603       708             0
{o_orderkey}       2603       2567            0
{p_partkey}        2603       1221            0
{p_type}           2603       1               0
{r_name}           2603       1               0
{r_regionkey}      2603       1               0
{s_nationkey}      2603       25              0
{s_suppkey}        2603       1895            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        4109.00        1.58           3818.00             1.60                0.00            1.00
{c_nationkey}      4109.00        1.58           5.00                1.00                0.00            1.00
{l_discount}       4109.00        1.58           11.00               1.00                0.00            1.00
{l_extendedprice}  4109.00        1.58           4081.00             1.61                0.00            1.00
{l_orderkey}       4109.00        1.58           4037.00             1.57                0.00            1.00
{l_partkey}        4109.00        1.58           1333.00             1.09                0.00            1.00
{l_suppkey}        4109.00        1.58           3364.00             1.78                0.00            1.00
{n_nationkey}      4109.00        1.58           5.00                1.00                0.00            1.00
{n_regionkey}      4109.00        1.58           1.00                1.00                0.00            1.00
{o_custkey}        4109.00        1.58           3818.00             1.60                0.00            1.00
{o_orderdate}      4109.00        1.58           728.00              1.03                0.00            1.00
{o_orderkey}       4109.00        1.58           4037.00             1.57                0.00            1.00
{p_partkey}        4109.00        1.58           1333.00             1.09                0.00            1.00
{p_type}           4109.00        1.58           1.00                1.00                0.00            1.00
{r_name}           4109.00        1.58           1.00                1.00                0.00            1.00
{r_regionkey}      4109.00        1.58           1.00                1.00                0.00            1.00
{s_nationkey}      4109.00        1.58           25.00               1.00                0.00            1.00
{s_suppkey}        4109.00        1.58           3364.00             1.78                0.00            1.00

----Stats for q8_scan_8----
column_names   row_count  distinct_count  null_count
{s_nationkey}  10000      25              0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00

----Stats for q8_inner_join_9----
column_names       row_count  distinct_count  null_count
{c_custkey}        2603       2385            0
{c_nationkey}      2603       5               0
{l_discount}       2603       11              0
{l_extendedprice}  2603       2540            0
{l_orderkey}       2603       2567            0
{l_partkey}        2603       1221            0
{l_suppkey}        2603       1895            0
{n_nationkey}      2603       5               0
{n_regionkey}      2603       1               0
{o_custkey}        2603       2385            0
{o_orderdate}      2603       708             0
{o_orderkey}       2603       2567            0
{p_partkey}        2603       1221            0
{p_type}           2603       1               0
{r_name}           2603       1               0
{r_regionkey}      2603       1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        3855.00        1.48           3599.00             1.51                0.00            1.00
{c_nationkey}      3855.00        1.48           5.00                1.00                0.00            1.00
{l_discount}       3855.00        1.48           11.00               1.00                0.00            1.00
{l_extendedprice}  3855.00        1.48           3837.00             1.51                0.00            1.00
{l_orderkey}       3855.00        1.48           3793.00             1.48                0.00            1.00
{l_partkey}        3855.00        1.48           1333.00             1.09                0.00            1.00
{l_suppkey}        3855.00        1.48           3194.00             1.69                0.00            1.00
{n_nationkey}      3855.00        1.48           5.00                1.00                0.00            1.00
{n_regionkey}      3855.00        1.48           1.00                1.00                0.00            1.00
{o_custkey}        3855.00        1.48           3599.00             1.51                0.00            1.00
{o_orderdate}      3855.00        1.48           727.00              1.03                0.00            1.00
{o_orderkey}       3855.00        1.48           3793.00             1.48                0.00            1.00
{p_partkey}        3855.00        1.48           1333.00             1.09                0.00            1.00
{p_type}           3855.00        1.48           1.00                1.00                0.00            1.00
{r_name}           3855.00        1.48           1.00                1.00                0.00            1.00
{r_regionkey}      3855.00        1.48           1.00                1.00                0.00            1.00

----Stats for q8_lookup_join_10----
column_names   row_count  distinct_count  null_count
{c_custkey}    29952      30253           0
{c_nationkey}  29952      5               0
{n_nationkey}  29952      5               0
{n_regionkey}  29952      1               0
{r_name}       29952      1               0
{r_regionkey}  29952      1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}    30000.00       1.00           27672.00            1.09                0.00            1.00
{c_nationkey}  30000.00       1.00           5.00                1.00                0.00            1.00
{n_nationkey}  30000.00       1.00           5.00                1.00                0.00            1.00
{n_regionkey}  30000.00       1.00           1.00                1.00                0.00            1.00
{r_name}       30000.00       1.00           1.00                1.00                0.00            1.00
{r_regionkey}  30000.00       1.00           1.00                1.00                0.00            1.00

----Stats for q8_lookup_join_11----
column_names   row_count  distinct_count  null_count
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

----Stats for q8_select_12----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

----Stats for q8_scan_13----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00

----Stats for q8_lookup_join_14----
column_names       row_count  distinct_count  null_count
{l_discount}       13389      11              0
{l_extendedprice}  13389      12076           0
{l_orderkey}       13389      13400           0
{l_partkey}        13389      1451            0
{l_suppkey}        13389      4044            0
{o_custkey}        13389      12274           0
{o_orderdate}      13389      731             0
{o_orderkey}       13389      13400           0
{p_partkey}        13389      1451            0
{p_type}           13389      1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       11915.00       1.12           11.00               1.00                0.00            1.00
{l_extendedprice}  11915.00       1.12           11828.00            1.02                0.00            1.00
{l_orderkey}       11915.00       1.12           11760.00            1.14                0.00            1.00
{l_partkey}        11915.00       1.12           1333.00             1.09                0.00            1.00
{l_suppkey}        11915.00       1.12           6935.00             1.71                0.00            1.00
{o_custkey}        11915.00       1.12           11229.00            1.09                0.00            1.00
{o_orderdate}      11915.00       1.12           731.00              1.00                0.00            1.00
{o_orderkey}       11915.00       1.12           11760.00            1.14                0.00            1.00
{p_partkey}        11915.00       1.12           1333.00             1.09                0.00            1.00
{p_type}           11915.00       1.12           1.00                1.00                0.00            1.00

----Stats for q8_lookup_join_15----
column_names       row_count  distinct_count  null_count
{l_discount}       43693      11              0
{l_extendedprice}  43693      32247           0
{l_orderkey}       43693      43349           0
{l_partkey}        43693      1451            0
{l_suppkey}        43693      4358            0
{p_partkey}        43693      1451            0
{p_type}           43693      1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       40153.00       1.09           11.00               1.00                0.00            1.00
{l_extendedprice}  40153.00       1.09           39334.00            1.22                0.00            1.00
{l_orderkey}       40153.00       1.09           39630.00            1.09                0.00            1.00
{l_partkey}        40153.00       1.09           1333.00             1.09                0.00            1.00
{l_suppkey}        40153.00       1.09           9747.00             2.24 <==            0.00            1.00
{p_partkey}        40153.00       1.09           1333.00             1.09                0.00            1.00
{p_type}           40153.00       1.09           1.00                1.00                0.00            1.00

----Stats for q8_lookup_join_16----
column_names    row_count  distinct_count  null_count
{l_linenumber}  43693      7               0
{l_orderkey}    43693      43349           0
{l_partkey}     43693      1451            0
{p_partkey}     43693      1451            0
{p_type}        43693      1               0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}  40153.00       1.09           7.00                1.00                0.00            1.00
{l_orderkey}    40153.00       1.09           39630.00            1.09                0.00            1.00
{l_partkey}     40153.00       1.09           1333.00             1.09                0.00            1.00
{p_partkey}     40153.00       1.09           1333.00             1.09                0.00            1.00
{p_type}        40153.00       1.09           1.00                1.00                0.00            1.00

----Stats for q8_select_17----
column_names  row_count  distinct_count  null_count
{p_partkey}   1451       1451            0
{p_type}      1451       1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_partkey}   1333.00        1.09           1333.00             1.09                0.00            1.00
{p_type}      1333.00        1.09           1.00                1.00                0.00            1.00

----Stats for q8_scan_18----
column_names  row_count  distinct_count  null_count
{p_partkey}   200000     199241          0
{p_type}      200000     150             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_partkey}   200000.00      1.00           199241.00           1.00                0.00            1.00
{p_type}      200000.00      1.00           150.00              1.00                0.00            1.00

----Stats for q8_scan_19----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
----
----
