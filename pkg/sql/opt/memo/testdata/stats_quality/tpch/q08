import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q8
# National Market Share
# Determines how the market share of a given nation within a given region has
# changed over two years for a given part type.
#
# The market share for a given nation within a given region is defined as the
# fraction of the revenue, the sum of [l_extendedprice * (1-l_discount)], from
# the products of a specified type in that region that was supplied by suppliers
# from the given nation. The query determines this for the years 1995 and 1996
# presented in this order.
#
# TODO:
#   1. Join ordering
#   2. Push down equivalent column comparisons
# --------------------------------------------------
save-tables database=tpch save-tables-prefix=q8
SELECT
    o_year,
    sum(CASE
        WHEN nation = 'BRAZIL'
            THEN volume
        ELSE 0
    END) / sum(volume) AS mkt_share
FROM (
    SELECT
        extract(year FROM o_orderdate) AS o_year,
        l_extendedprice * (1 - l_discount) AS volume,
        n2.n_name AS nation
    FROM
        part,
        supplier,
        lineitem,
        orders,
        customer,
        nation n1,
        nation n2,
        region
    WHERE
        p_partkey = l_partkey
        AND s_suppkey = l_suppkey
        AND l_orderkey = o_orderkey
        AND o_custkey = c_custkey
        AND c_nationkey = n1.n_nationkey
        AND n1.n_regionkey = r_regionkey
        AND r_name = 'AMERICA'
        AND s_nationkey = n2.n_nationkey
        AND o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31'
        AND p_type = 'ECONOMY ANODIZED STEEL'
    ) AS all_nations
GROUP BY
    o_year
ORDER BY
    o_year;
----
sort
 ├── save-table-name: q8_sort_1
 ├── columns: o_year:61(float) mkt_share:66(float!null)
 ├── immutable
 ├── stats: [rows=728.968264, distinct(61)=728.968264, null(61)=0, distinct(66)=728.968264, null(66)=0]
 ├── key: (61)
 ├── fd: (61)-->(66)
 ├── ordering: +61
 └── project
      ├── save-table-name: q8_project_2
      ├── columns: mkt_share:66(float!null) o_year:61(float)
      ├── immutable
      ├── stats: [rows=728.968264, distinct(61)=728.968264, null(61)=0, distinct(66)=728.968264, null(66)=0]
      ├── key: (61)
      ├── fd: (61)-->(66)
      ├── group-by
      │    ├── save-table-name: q8_group_by_3
      │    ├── columns: o_year:61(float) sum:64(float!null) sum:65(float!null)
      │    ├── grouping columns: o_year:61(float)
      │    ├── immutable
      │    ├── stats: [rows=728.968264, distinct(61)=728.968264, null(61)=0, distinct(64)=728.968264, null(64)=0, distinct(65)=728.968264, null(65)=0, distinct(64,65)=728.968264, null(64,65)=0]
      │    ├── key: (61)
      │    ├── fd: (61)-->(64,65)
      │    ├── project
      │    │    ├── save-table-name: q8_project_4
      │    │    ├── columns: column63:63(float!null) o_year:61(float) volume:62(float!null)
      │    │    ├── immutable
      │    │    ├── stats: [rows=4302.3045, distinct(61)=728.968264, null(61)=0, distinct(62)=4268.40037, null(62)=0, distinct(63)=4285.33021, null(63)=0]
      │    │    ├── project
      │    │    │    ├── save-table-name: q8_project_5
      │    │    │    ├── columns: o_year:61(float) volume:62(float!null) n2.n_name:55(char!null)
      │    │    │    ├── immutable
      │    │    │    ├── stats: [rows=4302.3045, distinct(55)=25, null(55)=0, distinct(61)=728.968264, null(61)=0, distinct(62)=4268.40037, null(62)=0, distinct(55,62)=4285.33021, null(55,62)=0]
      │    │    │    ├── inner-join (hash)
      │    │    │    │    ├── save-table-name: q8_inner_join_6
      │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) s_suppkey:10(int!null) s_nationkey:13(int!null) l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_extendedprice:22(float!null) l_discount:23(float!null) o_orderkey:33(int!null) o_custkey:34(int!null) o_orderdate:37(date!null) c_custkey:42(int!null) c_nationkey:45(int!null) n1.n_nationkey:50(int!null) n1.n_regionkey:52(int!null) n2.n_nationkey:54(int!null) n2.n_name:55(char!null) r_regionkey:58(int!null) r_name:59(char!null)
      │    │    │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
      │    │    │    │    ├── stats: [rows=4302.3045, distinct(1)=1333.31636, null(1)=0, distinct(5)=1, null(5)=0, distinct(10)=3490.79055, null(10)=0, distinct(13)=25, null(13)=0, distinct(17)=4223.63113, null(17)=0, distinct(18)=1333.31636, null(18)=0, distinct(19)=3490.79055, null(19)=0, distinct(22)=4265.95085, null(22)=0, distinct(23)=11, null(23)=0, distinct(33)=4223.63113, null(33)=0, distinct(34)=3984.54821, null(34)=0, distinct(37)=728.968264, null(37)=0, distinct(42)=3984.54821, null(42)=0, distinct(45)=5, null(45)=0, distinct(50)=5, null(50)=0, distinct(52)=1, null(52)=0, distinct(54)=25, null(54)=0, distinct(55)=25, null(55)=0, distinct(58)=1, null(58)=0, distinct(59)=0.996222107, null(59)=0, distinct(22,23)=4268.40037, null(22,23)=0, distinct(22,23,55)=4285.33021, null(22,23,55)=0]
      │    │    │    │    ├── fd: ()-->(5,59), (10)-->(13), (33)-->(34,37), (42)-->(45), (50)-->(52), (52)==(58), (58)==(52), (45)==(50), (50)==(45), (34)==(42), (42)==(34), (17)==(33), (33)==(17), (10)==(19), (19)==(10), (54)-->(55), (13)==(54), (54)==(13), (1)==(18), (18)==(1)
      │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    ├── save-table-name: q8_inner_join_7
      │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) s_suppkey:10(int!null) s_nationkey:13(int!null) l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_extendedprice:22(float!null) l_discount:23(float!null) o_orderkey:33(int!null) o_custkey:34(int!null) o_orderdate:37(date!null) c_custkey:42(int!null) c_nationkey:45(int!null) n1.n_nationkey:50(int!null) n1.n_regionkey:52(int!null) r_regionkey:58(int!null) r_name:59(char!null)
      │    │    │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
      │    │    │    │    │    ├── stats: [rows=4118.35396, distinct(1)=1333.31636, null(1)=0, distinct(5)=1, null(5)=0, distinct(10)=3370.45821, null(10)=0, distinct(13)=25, null(13)=0, distinct(17)=4046.85511, null(17)=0, distinct(18)=1333.31636, null(18)=0, distinct(19)=3370.45821, null(19)=0, distinct(22)=4090.27659, null(22)=0, distinct(23)=11, null(23)=0, distinct(33)=4046.85511, null(33)=0, distinct(34)=3826.55932, null(34)=0, distinct(37)=728.386908, null(37)=0, distinct(42)=3826.55932, null(42)=0, distinct(45)=5, null(45)=0, distinct(50)=5, null(50)=0, distinct(52)=1, null(52)=0, distinct(58)=1, null(58)=0, distinct(59)=0.996222107, null(59)=0]
      │    │    │    │    │    ├── fd: ()-->(5,59), (10)-->(13), (33)-->(34,37), (42)-->(45), (50)-->(52), (52)==(58), (58)==(52), (45)==(50), (50)==(45), (34)==(42), (42)==(34), (17)==(33), (33)==(17), (10)==(19), (19)==(10), (1)==(18), (18)==(1)
      │    │    │    │    │    ├── scan supplier@s_nk
      │    │    │    │    │    │    ├── save-table-name: q8_scan_8
      │    │    │    │    │    │    ├── columns: s_suppkey:10(int!null) s_nationkey:13(int!null)
      │    │    │    │    │    │    ├── stats: [rows=10000, distinct(10)=9920, null(10)=0, distinct(13)=25, null(13)=0]
      │    │    │    │    │    │    │   histogram(10)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50    1
      │    │    │    │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │    │    │    │    │    │    │   histogram(13)=  0 420 0 413 0 397 0 412 0 415 0 380 0 402 0 396 0 415 0 405 0 393  0 438  0 377  0 362  0 376  0 373  0 406  0 421  0 407  0 398  0 411  0 399  0 401  0 390  0 393
      │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    ├── key: (10)
      │    │    │    │    │    │    └── fd: (10)-->(13)
      │    │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    │    ├── save-table-name: q8_inner_join_9
      │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_extendedprice:22(float!null) l_discount:23(float!null) o_orderkey:33(int!null) o_custkey:34(int!null) o_orderdate:37(date!null) c_custkey:42(int!null) c_nationkey:45(int!null) n1.n_nationkey:50(int!null) n1.n_regionkey:52(int!null) r_regionkey:58(int!null) r_name:59(char!null)
      │    │    │    │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(zero-or-one)
      │    │    │    │    │    │    ├── stats: [rows=3865.67953, distinct(1)=1333.31636, null(1)=0, distinct(5)=1, null(5)=0, distinct(17)=3803.27383, null(17)=0, distinct(18)=1333.31636, null(18)=0, distinct(19)=3201.48978, null(19)=0, distinct(22)=3847.46234, null(22)=0, distinct(23)=11, null(23)=0, distinct(33)=3803.27383, null(33)=0, distinct(34)=3607.82676, null(34)=0, distinct(37)=727.307913, null(37)=0, distinct(42)=3607.82676, null(42)=0, distinct(45)=5, null(45)=0, distinct(50)=5, null(50)=0, distinct(52)=1, null(52)=0, distinct(58)=1, null(58)=0, distinct(59)=0.996222107, null(59)=0]
      │    │    │    │    │    │    ├── fd: ()-->(5,59), (33)-->(34,37), (42)-->(45), (50)-->(52), (52)==(58), (58)==(52), (45)==(50), (50)==(45), (34)==(42), (42)==(34), (17)==(33), (33)==(17), (1)==(18), (18)==(1)
      │    │    │    │    │    │    ├── inner-join (lookup customer@c_nk)
      │    │    │    │    │    │    │    ├── save-table-name: q8_lookup_join_10
      │    │    │    │    │    │    │    ├── columns: c_custkey:42(int!null) c_nationkey:45(int!null) n1.n_nationkey:50(int!null) n1.n_regionkey:52(int!null) r_regionkey:58(int!null) r_name:59(char!null)
      │    │    │    │    │    │    │    ├── key columns: [50] = [45]
      │    │    │    │    │    │    │    ├── stats: [rows=30000, distinct(42)=27672.3293, null(42)=0, distinct(45)=5, null(45)=0, distinct(50)=5, null(50)=0, distinct(52)=1, null(52)=0, distinct(58)=1, null(58)=0, distinct(59)=0.996222107, null(59)=0]
      │    │    │    │    │    │    │    ├── key: (42)
      │    │    │    │    │    │    │    ├── fd: ()-->(59), (42)-->(45), (50)-->(52), (52)==(58), (58)==(52), (45)==(50), (50)==(45)
      │    │    │    │    │    │    │    ├── inner-join (merge)
      │    │    │    │    │    │    │    │    ├── save-table-name: q8_merge_join_11
      │    │    │    │    │    │    │    │    ├── columns: n1.n_nationkey:50(int!null) n1.n_regionkey:52(int!null) r_regionkey:58(int!null) r_name:59(char!null)
      │    │    │    │    │    │    │    │    ├── left ordering: +52
      │    │    │    │    │    │    │    │    ├── right ordering: +58
      │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(50)=5, null(50)=0, distinct(52)=1, null(52)=0, distinct(58)=1, null(58)=0, distinct(59)=0.996222107, null(59)=0]
      │    │    │    │    │    │    │    │    ├── key: (50)
      │    │    │    │    │    │    │    │    ├── fd: ()-->(59), (50)-->(52), (52)==(58), (58)==(52)
      │    │    │    │    │    │    │    │    ├── scan n1@n_rk
      │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_scan_12
      │    │    │    │    │    │    │    │    │    ├── columns: n1.n_nationkey:50(int!null) n1.n_regionkey:52(int!null)
      │    │    │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(50)=25, null(50)=0, distinct(52)=5, null(52)=0]
      │    │    │    │    │    │    │    │    │    │   histogram(50)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │    │    │   histogram(52)=  0  5  0  5  0  5  0  5  0  5
      │    │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    │    │    ├── key: (50)
      │    │    │    │    │    │    │    │    │    ├── fd: (50)-->(52)
      │    │    │    │    │    │    │    │    │    └── ordering: +52
      │    │    │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_select_13
      │    │    │    │    │    │    │    │    │    ├── columns: r_regionkey:58(int!null) r_name:59(char!null)
      │    │    │    │    │    │    │    │    │    ├── stats: [rows=1, distinct(58)=1, null(58)=0, distinct(59)=1, null(59)=0]
      │    │    │    │    │    │    │    │    │    ├── key: (58)
      │    │    │    │    │    │    │    │    │    ├── fd: ()-->(59)
      │    │    │    │    │    │    │    │    │    ├── ordering: +58 opt(59) [actual: +58]
      │    │    │    │    │    │    │    │    │    ├── scan region
      │    │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_scan_14
      │    │    │    │    │    │    │    │    │    │    ├── columns: r_regionkey:58(int!null) r_name:59(char!null)
      │    │    │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(58)=5, null(58)=0, distinct(59)=5, null(59)=0]
      │    │    │    │    │    │    │    │    │    │    │   histogram(58)=  0  1  0  1  0  1  0  1  0  1
      │    │    │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    │    │    │    ├── key: (58)
      │    │    │    │    │    │    │    │    │    │    ├── fd: (58)-->(59)
      │    │    │    │    │    │    │    │    │    │    └── ordering: +58 opt(59) [actual: +58]
      │    │    │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │    │    │         └── r_name:59 = 'AMERICA' [type=bool, outer=(59), constraints=(/59: [/'AMERICA' - /'AMERICA']; tight), fd=()-->(59)]
      │    │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    ├── inner-join (lookup orders)
      │    │    │    │    │    │    │    ├── save-table-name: q8_lookup_join_15
      │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_extendedprice:22(float!null) l_discount:23(float!null) o_orderkey:33(int!null) o_custkey:34(int!null) o_orderdate:37(date!null)
      │    │    │    │    │    │    │    ├── key columns: [17] = [33]
      │    │    │    │    │    │    │    ├── lookup columns are key
      │    │    │    │    │    │    │    ├── stats: [rows=11954.404, distinct(1)=1333.31636, null(1)=0, distinct(5)=1, null(5)=0, distinct(17)=11798.6079, null(17)=0, distinct(18)=1333.31636, null(18)=0, distinct(19)=6947.30529, null(19)=0, distinct(22)=11864.6001, null(22)=0, distinct(23)=11, null(23)=0, distinct(33)=11798.6079, null(33)=0, distinct(34)=11263.5878, null(34)=0, distinct(37)=730.999942, null(37)=0]
      │    │    │    │    │    │    │    ├── fd: ()-->(5), (33)-->(34,37), (17)==(33), (33)==(17), (1)==(18), (18)==(1)
      │    │    │    │    │    │    │    ├── inner-join (lookup lineitem)
      │    │    │    │    │    │    │    │    ├── save-table-name: q8_lookup_join_16
      │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) l_orderkey:17(int!null) l_partkey:18(int!null) l_suppkey:19(int!null) l_extendedprice:22(float!null) l_discount:23(float!null)
      │    │    │    │    │    │    │    │    ├── key columns: [17 20] = [17 20]
      │    │    │    │    │    │    │    │    ├── lookup columns are key
      │    │    │    │    │    │    │    │    ├── stats: [rows=40160.5091, distinct(1)=1333.31636, null(1)=0, distinct(5)=1, null(5)=0, distinct(17)=39637.1826, null(17)=0, distinct(18)=1333.31636, null(18)=0, distinct(19)=9746.9017, null(19)=0, distinct(22)=39302.1409, null(22)=0, distinct(23)=11, null(23)=0]
      │    │    │    │    │    │    │    │    ├── fd: ()-->(5), (1)==(18), (18)==(1)
      │    │    │    │    │    │    │    │    ├── inner-join (lookup lineitem@l_pk)
      │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_lookup_join_17
      │    │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null) l_orderkey:17(int!null) l_partkey:18(int!null) l_linenumber:20(int!null)
      │    │    │    │    │    │    │    │    │    ├── key columns: [1] = [18]
      │    │    │    │    │    │    │    │    │    ├── stats: [rows=40160.5091, distinct(1)=1333.31636, null(1)=0, distinct(5)=1, null(5)=0, distinct(17)=39637.1826, null(17)=0, distinct(18)=1333.31636, null(18)=0, distinct(20)=7, null(20)=0]
      │    │    │    │    │    │    │    │    │    ├── key: (17,20)
      │    │    │    │    │    │    │    │    │    ├── fd: ()-->(5), (17,20)-->(18), (1)==(18), (18)==(1)
      │    │    │    │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_select_18
      │    │    │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null)
      │    │    │    │    │    │    │    │    │    │    ├── stats: [rows=1333.33333, distinct(1)=1333.31636, null(1)=0, distinct(5)=1, null(5)=0]
      │    │    │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    │    │    ├── fd: ()-->(5)
      │    │    │    │    │    │    │    │    │    │    ├── scan part
      │    │    │    │    │    │    │    │    │    │    │    ├── save-table-name: q8_scan_19
      │    │    │    │    │    │    │    │    │    │    │    ├── columns: p_partkey:1(int!null) p_type:5(varchar!null)
      │    │    │    │    │    │    │    │    │    │    │    ├── stats: [rows=200000, distinct(1)=199241, null(1)=0, distinct(5)=150, null(5)=0]
      │    │    │    │    │    │    │    │    │    │    │    │   histogram(1)=  0  20  980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20   980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980   20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    980    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20    1000    20
      │    │    │    │    │    │    │    │    │    │    │    │                <--- 27 ----- 1110 ----- 2241 ----- 3086 ----- 4134 ----- 5302 ----- 6222 ----- 7308 ----- 8249 ----- 9171 ----- 10049 ----- 10958 ----- 11832 ----- 13025 ----- 14063 ----- 14953 ----- 16249 ----- 17419 ----- 18363 ----- 19412 ----- 20257 ----- 21190 ----- 22110 ----- 23045 ----- 23956 ----- 24962 ----- 25942 ----- 26990 ----- 27934 ----- 28876 ----- 29513 ----- 30326 ----- 31259 ----- 32300 ----- 33577 ----- 34550 ----- 35562 ----- 36498 ----- 37475 ----- 38584 ----- 39641 ----- 40548 ----- 41605 ----- 42527 ----- 43612 ----- 44702 ----- 45701 ----- 46726 ----- 47795 ----- 48935 ----- 50152 ----- 51183 ----- 52001 ----- 52904 ----- 53868 ----- 54808 ----- 55986 ----- 57155 ----- 58516 ----- 59526 ----- 60557 ----- 61547 ----- 62369 ----- 63672 ----- 64583 ----- 65360 ----- 66147 ----- 67201 ----- 68142 ----- 69145 ----- 70209 ----- 71141 ----- 71923 ----- 73031 ----- 73987 ----- 74974 ----- 76170 ----- 77138 ----- 77849 ----- 78931 ----- 79832 ----- 80761 ----- 81843 ----- 82834 ----- 84032 ----- 85072 ----- 86287 ----- 87302 ----- 88422 ----- 89432 ----- 90550 ----- 91463 ----- 92249 ----- 93385 ----- 94789 ----- 96013 ----- 96893 ----- 98000 ----- 99008 ----- 100166 ----- 101263 ----- 102351 ----- 103236 ----- 104121 ----- 105363 ----- 106329 ----- 107325 ----- 108231 ----- 109054 ----- 110019 ----- 111185 ----- 112112 ----- 112908 ----- 113904 ----- 114785 ----- 115410 ----- 116526 ----- 117559 ----- 118310 ----- 119073 ----- 120034 ----- 120817 ----- 121744 ----- 122566 ----- 123720 ----- 124813 ----- 125835 ----- 126622 ----- 127651 ----- 128328 ----- 129315 ----- 130244 ----- 131450 ----- 132439 ----- 133288 ----- 134164 ----- 135298 ----- 136347 ----- 137243 ----- 138256 ----- 139427 ----- 140374 ----- 141371 ----- 142302 ----- 143322 ----- 144335 ----- 145333 ----- 146212 ----- 147321 ----- 148591 ----- 149594 ------ 150514 ------ 151361 ------ 152059 ------ 153070 ------ 154059 ------ 155259 ------ 156473 ------ 157690 ------ 158703 ------ 159675 ------ 160597 ------ 161668 ------ 162737 ------ 163955 ------ 164942 ------ 165924 ------ 167059 ------ 167866 ------ 169034 ------ 169935 ------ 170712 ------ 171806 ------ 172841 ------ 174078 ------ 175347 ------ 176430 ------ 177346 ------ 178566 ------ 179515 ------ 180677 ------ 181729 ------ 182983 ------ 183814 ------ 184892 ------ 185696 ------ 186611 ------ 187744 ------ 188974 ------ 189911 ------ 190671 ------ 191607 ------ 192820 ------ 193789 ------ 195057 ------ 196224 ------ 197231 ------ 198281 ------ 199119 ------ 199999
      │    │    │    │    │    │    │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    │    │    │    │    │    │    └── fd: (1)-->(5)
      │    │    │    │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │    │    │    │         └── p_type:5 = 'ECONOMY ANODIZED STEEL' [type=bool, outer=(5), constraints=(/5: [/'ECONOMY ANODIZED STEEL' - /'ECONOMY ANODIZED STEEL']; tight), fd=()-->(5)]
      │    │    │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │         └── (o_orderdate:37 >= '1995-01-01') AND (o_orderdate:37 <= '1996-12-31') [type=bool, outer=(37), constraints=(/37: [/'1995-01-01' - /'1996-12-31']; tight)]
      │    │    │    │    │    │    └── filters
      │    │    │    │    │    │         └── o_custkey:34 = c_custkey:42 [type=bool, outer=(34,42), constraints=(/34: (/NULL - ]; /42: (/NULL - ]), fd=(34)==(42), (42)==(34)]
      │    │    │    │    │    └── filters
      │    │    │    │    │         └── s_suppkey:10 = l_suppkey:19 [type=bool, outer=(10,19), constraints=(/10: (/NULL - ]; /19: (/NULL - ]), fd=(10)==(19), (19)==(10)]
      │    │    │    │    ├── scan n2
      │    │    │    │    │    ├── save-table-name: q8_scan_20
      │    │    │    │    │    ├── columns: n2.n_nationkey:54(int!null) n2.n_name:55(char!null)
      │    │    │    │    │    ├── stats: [rows=25, distinct(54)=25, null(54)=0, distinct(55)=25, null(55)=0]
      │    │    │    │    │    │   histogram(54)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    ├── key: (54)
      │    │    │    │    │    └── fd: (54)-->(55)
      │    │    │    │    └── filters
      │    │    │    │         └── s_nationkey:13 = n2.n_nationkey:54 [type=bool, outer=(13,54), constraints=(/13: (/NULL - ]; /54: (/NULL - ]), fd=(13)==(54), (54)==(13)]
      │    │    │    └── projections
      │    │    │         ├── extract('year', o_orderdate:37) [as=o_year:61, type=float, outer=(37), immutable]
      │    │    │         └── l_extendedprice:22 * (1.0 - l_discount:23) [as=volume:62, type=float, outer=(22,23), immutable]
      │    │    └── projections
      │    │         └── CASE WHEN n2.n_name:55 = 'BRAZIL' THEN volume:62 ELSE 0.0 END [as=column63:63, type=float, outer=(55,62)]
      │    └── aggregations
      │         ├── sum [as=sum:64, type=float, outer=(63)]
      │         │    └── column63:63 [type=float]
      │         └── sum [as=sum:65, type=float, outer=(62)]
      │              └── volume:62 [type=float]
      └── projections
           └── sum:64 / sum:65 [as=mkt_share:66, type=float, outer=(64,65), immutable]

stats table=q8_sort_1
----
column_names  row_count  distinct_count  null_count
{mkt_share}   2          2               0
{o_year}      2          2               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{mkt_share}   729.00         364.50 <==     729.00              364.50 <==          0.00            1.00
{o_year}      729.00         364.50 <==     729.00              364.50 <==          0.00            1.00

stats table=q8_project_2
----
column_names  row_count  distinct_count  null_count
{mkt_share}   2          2               0
{o_year}      2          2               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{mkt_share}   729.00         364.50 <==     729.00              364.50 <==          0.00            1.00
{o_year}      729.00         364.50 <==     729.00              364.50 <==          0.00            1.00

stats table=q8_group_by_3
----
column_names  row_count  distinct_count  null_count
{o_year}      2          2               0
{sum_1}       2          2               0
{sum}         2          2               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_year}      729.00         364.50 <==     729.00              364.50 <==          0.00            1.00
{sum}         729.00         364.50 <==     729.00              364.50 <==          0.00            1.00
{sum_1}       729.00         364.50 <==     729.00              364.50 <==          0.00            1.00

stats table=q8_project_4
----
column_names  row_count  distinct_count  null_count
{column63}    2603       108             0
{o_year}      2603       2               0
{volume}      2603       2599            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{column63}    4302.00        1.65           4285.00             39.68 <==           0.00            1.00
{o_year}      4302.00        1.65           729.00              364.50 <==          0.00            1.00
{volume}      4302.00        1.65           4268.00             1.64                0.00            1.00

stats table=q8_project_5
----
column_names  row_count  distinct_count  null_count
{n_name}      2603       25              0
{o_year}      2603       2               0
{volume}      2603       2599            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      4302.00        1.65           25.00               1.00                0.00            1.00
{o_year}      4302.00        1.65           729.00              364.50 <==          0.00            1.00
{volume}      4302.00        1.65           4268.00             1.64                0.00            1.00

stats table=q8_inner_join_6
----
column_names       row_count  distinct_count  null_count
{c_custkey}        2603       2385            0
{c_nationkey}      2603       5               0
{l_discount}       2603       11              0
{l_extendedprice}  2603       2540            0
{l_orderkey}       2603       2567            0
{l_partkey}        2603       1221            0
{l_suppkey}        2603       1895            0
{n_name}           2603       25              0
{n_nationkey_1}    2603       25              0
{n_nationkey}      2603       5               0
{n_regionkey}      2603       1               0
{o_custkey}        2603       2385            0
{o_orderdate}      2603       708             0
{o_orderkey}       2603       2567            0
{p_partkey}        2603       1221            0
{p_type}           2603       1               0
{r_name}           2603       1               0
{r_regionkey}      2603       1               0
{s_nationkey}      2603       25              0
{s_suppkey}        2603       1895            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        4302.00        1.65           3985.00             1.67                0.00            1.00
{c_nationkey}      4302.00        1.65           5.00                1.00                0.00            1.00
{l_discount}       4302.00        1.65           11.00               1.00                0.00            1.00
{l_extendedprice}  4302.00        1.65           4266.00             1.68                0.00            1.00
{l_orderkey}       4302.00        1.65           4224.00             1.65                0.00            1.00
{l_partkey}        4302.00        1.65           1333.00             1.09                0.00            1.00
{l_suppkey}        4302.00        1.65           3491.00             1.84                0.00            1.00
{n_name}           4302.00        1.65           25.00               1.00                0.00            1.00
{n_nationkey}      4302.00        1.65           5.00                1.00                0.00            1.00
{n_nationkey_1}    4302.00        1.65           25.00               1.00                0.00            1.00
{n_regionkey}      4302.00        1.65           1.00                1.00                0.00            1.00
{o_custkey}        4302.00        1.65           3985.00             1.67                0.00            1.00
{o_orderdate}      4302.00        1.65           729.00              1.03                0.00            1.00
{o_orderkey}       4302.00        1.65           4224.00             1.65                0.00            1.00
{p_partkey}        4302.00        1.65           1333.00             1.09                0.00            1.00
{p_type}           4302.00        1.65           1.00                1.00                0.00            1.00
{r_name}           4302.00        1.65           1.00                1.00                0.00            1.00
{r_regionkey}      4302.00        1.65           1.00                1.00                0.00            1.00
{s_nationkey}      4302.00        1.65           25.00               1.00                0.00            1.00
{s_suppkey}        4302.00        1.65           3491.00             1.84                0.00            1.00

stats table=q8_inner_join_7
----
column_names       row_count  distinct_count  null_count
{c_custkey}        2603       2385            0
{c_nationkey}      2603       5               0
{l_discount}       2603       11              0
{l_extendedprice}  2603       2540            0
{l_orderkey}       2603       2567            0
{l_partkey}        2603       1221            0
{l_suppkey}        2603       1895            0
{n_nationkey}      2603       5               0
{n_regionkey}      2603       1               0
{o_custkey}        2603       2385            0
{o_orderdate}      2603       708             0
{o_orderkey}       2603       2567            0
{p_partkey}        2603       1221            0
{p_type}           2603       1               0
{r_name}           2603       1               0
{r_regionkey}      2603       1               0
{s_nationkey}      2603       25              0
{s_suppkey}        2603       1895            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        4118.00        1.58           3827.00             1.60                0.00            1.00
{c_nationkey}      4118.00        1.58           5.00                1.00                0.00            1.00
{l_discount}       4118.00        1.58           11.00               1.00                0.00            1.00
{l_extendedprice}  4118.00        1.58           4090.00             1.61                0.00            1.00
{l_orderkey}       4118.00        1.58           4047.00             1.58                0.00            1.00
{l_partkey}        4118.00        1.58           1333.00             1.09                0.00            1.00
{l_suppkey}        4118.00        1.58           3370.00             1.78                0.00            1.00
{n_nationkey}      4118.00        1.58           5.00                1.00                0.00            1.00
{n_regionkey}      4118.00        1.58           1.00                1.00                0.00            1.00
{o_custkey}        4118.00        1.58           3827.00             1.60                0.00            1.00
{o_orderdate}      4118.00        1.58           728.00              1.03                0.00            1.00
{o_orderkey}       4118.00        1.58           4047.00             1.58                0.00            1.00
{p_partkey}        4118.00        1.58           1333.00             1.09                0.00            1.00
{p_type}           4118.00        1.58           1.00                1.00                0.00            1.00
{r_name}           4118.00        1.58           1.00                1.00                0.00            1.00
{r_regionkey}      4118.00        1.58           1.00                1.00                0.00            1.00
{s_nationkey}      4118.00        1.58           25.00               1.00                0.00            1.00
{s_suppkey}        4118.00        1.58           3370.00             1.78                0.00            1.00

stats table=q8_scan_8
----
column_names   row_count  distinct_count  null_count
{s_nationkey}  10000      25              0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00

stats table=q8_inner_join_9
----
column_names       row_count  distinct_count  null_count
{c_custkey}        2603       2385            0
{c_nationkey}      2603       5               0
{l_discount}       2603       11              0
{l_extendedprice}  2603       2540            0
{l_orderkey}       2603       2567            0
{l_partkey}        2603       1221            0
{l_suppkey}        2603       1895            0
{n_nationkey}      2603       5               0
{n_regionkey}      2603       1               0
{o_custkey}        2603       2385            0
{o_orderdate}      2603       708             0
{o_orderkey}       2603       2567            0
{p_partkey}        2603       1221            0
{p_type}           2603       1               0
{r_name}           2603       1               0
{r_regionkey}      2603       1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        3866.00        1.49           3608.00             1.51                0.00            1.00
{c_nationkey}      3866.00        1.49           5.00                1.00                0.00            1.00
{l_discount}       3866.00        1.49           11.00               1.00                0.00            1.00
{l_extendedprice}  3866.00        1.49           3847.00             1.51                0.00            1.00
{l_orderkey}       3866.00        1.49           3803.00             1.48                0.00            1.00
{l_partkey}        3866.00        1.49           1333.00             1.09                0.00            1.00
{l_suppkey}        3866.00        1.49           3201.00             1.69                0.00            1.00
{n_nationkey}      3866.00        1.49           5.00                1.00                0.00            1.00
{n_regionkey}      3866.00        1.49           1.00                1.00                0.00            1.00
{o_custkey}        3866.00        1.49           3608.00             1.51                0.00            1.00
{o_orderdate}      3866.00        1.49           727.00              1.03                0.00            1.00
{o_orderkey}       3866.00        1.49           3803.00             1.48                0.00            1.00
{p_partkey}        3866.00        1.49           1333.00             1.09                0.00            1.00
{p_type}           3866.00        1.49           1.00                1.00                0.00            1.00
{r_name}           3866.00        1.49           1.00                1.00                0.00            1.00
{r_regionkey}      3866.00        1.49           1.00                1.00                0.00            1.00

stats table=q8_lookup_join_10
----
column_names   row_count  distinct_count  null_count
{c_custkey}    29952      30253           0
{c_nationkey}  29952      5               0
{n_nationkey}  29952      5               0
{n_regionkey}  29952      1               0
{r_name}       29952      1               0
{r_regionkey}  29952      1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}    30000.00       1.00           27672.00            1.09                0.00            1.00
{c_nationkey}  30000.00       1.00           5.00                1.00                0.00            1.00
{n_nationkey}  30000.00       1.00           5.00                1.00                0.00            1.00
{n_regionkey}  30000.00       1.00           1.00                1.00                0.00            1.00
{r_name}       30000.00       1.00           1.00                1.00                0.00            1.00
{r_regionkey}  30000.00       1.00           1.00                1.00                0.00            1.00

stats table=q8_merge_join_11
----
column_names   row_count  distinct_count  null_count
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

stats table=q8_scan_12
----
column_names   row_count  distinct_count  null_count
{n_nationkey}  25         25              0
{n_regionkey}  25         5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
{n_regionkey}  25.00          1.00           5.00                1.00                0.00            1.00

stats table=q8_select_13
----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

stats table=q8_scan_14
----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00

stats table=q8_lookup_join_15
----
column_names       row_count  distinct_count  null_count
{l_discount}       13389      11              0
{l_extendedprice}  13389      12076           0
{l_orderkey}       13389      13400           0
{l_partkey}        13389      1451            0
{l_suppkey}        13389      4044            0
{o_custkey}        13389      12274           0
{o_orderdate}      13389      731             0
{o_orderkey}       13389      13400           0
{p_partkey}        13389      1451            0
{p_type}           13389      1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       11954.00       1.12           11.00               1.00                0.00            1.00
{l_extendedprice}  11954.00       1.12           11865.00            1.02                0.00            1.00
{l_orderkey}       11954.00       1.12           11799.00            1.14                0.00            1.00
{l_partkey}        11954.00       1.12           1333.00             1.09                0.00            1.00
{l_suppkey}        11954.00       1.12           6947.00             1.72                0.00            1.00
{o_custkey}        11954.00       1.12           11264.00            1.09                0.00            1.00
{o_orderdate}      11954.00       1.12           731.00              1.00                0.00            1.00
{o_orderkey}       11954.00       1.12           11799.00            1.14                0.00            1.00
{p_partkey}        11954.00       1.12           1333.00             1.09                0.00            1.00
{p_type}           11954.00       1.12           1.00                1.00                0.00            1.00

stats table=q8_lookup_join_16
----
column_names       row_count  distinct_count  null_count
{l_discount}       43693      11              0
{l_extendedprice}  43693      32247           0
{l_orderkey}       43693      43349           0
{l_partkey}        43693      1451            0
{l_suppkey}        43693      4358            0
{p_partkey}        43693      1451            0
{p_type}           43693      1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       40161.00       1.09           11.00               1.00                0.00            1.00
{l_extendedprice}  40161.00       1.09           39302.00            1.22                0.00            1.00
{l_orderkey}       40161.00       1.09           39637.00            1.09                0.00            1.00
{l_partkey}        40161.00       1.09           1333.00             1.09                0.00            1.00
{l_suppkey}        40161.00       1.09           9747.00             2.24 <==            0.00            1.00
{p_partkey}        40161.00       1.09           1333.00             1.09                0.00            1.00
{p_type}           40161.00       1.09           1.00                1.00                0.00            1.00

stats table=q8_lookup_join_17
----
column_names    row_count  distinct_count  null_count
{l_linenumber}  43693      7               0
{l_orderkey}    43693      43349           0
{l_partkey}     43693      1451            0
{p_partkey}     43693      1451            0
{p_type}        43693      1               0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}  40161.00       1.09           7.00                1.00                0.00            1.00
{l_orderkey}    40161.00       1.09           39637.00            1.09                0.00            1.00
{l_partkey}     40161.00       1.09           1333.00             1.09                0.00            1.00
{p_partkey}     40161.00       1.09           1333.00             1.09                0.00            1.00
{p_type}        40161.00       1.09           1.00                1.00                0.00            1.00

stats table=q8_select_18
----
column_names  row_count  distinct_count  null_count
{p_partkey}   1451       1451            0
{p_type}      1451       1               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_partkey}   1333.00        1.09           1333.00             1.09                0.00            1.00
{p_type}      1333.00        1.09           1.00                1.00                0.00            1.00

stats table=q8_scan_19
----
column_names  row_count  distinct_count  null_count
{p_partkey}   200000     199241          0
{p_type}      200000     150             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_partkey}   200000.00      1.00           199241.00           1.00                0.00            1.00
{p_type}      200000.00      1.00           150.00              1.00                0.00            1.00

stats table=q8_scan_20
----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
