import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q7
# Volume Shipping
# Determines the value of goods shipped between certain nations to help in the
# re-negotiation of shipping contracts.
#
# Finds, for two given nations, the gross discounted revenues derived from
# lineitems in which parts were shipped from a supplier in either nation to a
# customer in the other nation during 1995 and 1996. The query lists the
# supplier nation, the customer nation, the year, and the revenue from shipments
# that took place in that year. The query orders the answer by Supplier nation,
# Customer nation, and year (all ascending).
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q7
SELECT
    supp_nation,
    cust_nation,
    l_year, sum(volume) AS revenue
FROM (
    SELECT
        n1.n_name AS supp_nation,
        n2.n_name AS cust_nation,
        extract(year FROM l_shipdate) AS l_year,
        l_extendedprice * (1 - l_discount) AS volume
    FROM
        supplier,
        lineitem,
        orders,
        customer,
        nation n1,
        nation n2
    WHERE
        s_suppkey = l_suppkey
        AND o_orderkey = l_orderkey
        AND c_custkey = o_custkey
        AND s_nationkey = n1.n_nationkey
        AND c_nationkey = n2.n_nationkey
        AND (
            (n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY')
            or (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')
        )
        AND l_shipdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31'
    ) AS shipping
GROUP BY
    supp_nation,
    cust_nation,
    l_year
ORDER BY
    supp_nation,
    cust_nation,
    l_year;
----
----
sort
 ├── save-table-name: q7_sort_1
 ├── columns: supp_nation:50(char!null) cust_nation:56(char!null) l_year:61(float) revenue:63(float!null)
 ├── immutable
 ├── stats: [rows=974.275795, distinct(50)=1.33333333, null(50)=0, distinct(56)=1.33333333, null(56)=0, distinct(61)=730.978382, null(61)=0, distinct(63)=974.275795, null(63)=0, distinct(50,56,61)=974.275795, null(50,56,61)=0]
 ├── key: (50,56,61)
 ├── fd: (50,56,61)-->(63)
 ├── ordering: +50,+56,+61
 └── group-by
      ├── save-table-name: q7_group_by_2
      ├── columns: n1.n_name:50(char!null) n2.n_name:56(char!null) l_year:61(float) sum:63(float!null)
      ├── grouping columns: n1.n_name:50(char!null) n2.n_name:56(char!null) l_year:61(float)
      ├── immutable
      ├── stats: [rows=974.275795, distinct(50)=1.33333333, null(50)=0, distinct(56)=1.33333333, null(56)=0, distinct(61)=730.978382, null(61)=0, distinct(63)=974.275795, null(63)=0, distinct(50,56,61)=974.275795, null(50,56,61)=0]
      ├── key: (50,56,61)
      ├── fd: (50,56,61)-->(63)
      ├── project
      │    ├── save-table-name: q7_project_3
      │    ├── columns: l_year:61(float) volume:62(float!null) n1.n_name:50(char!null) n2.n_name:56(char!null)
      │    ├── immutable
      │    ├── stats: [rows=7623.31119, distinct(50)=1.33333333, null(50)=0, distinct(56)=1.33333333, null(56)=0, distinct(61)=730.978382, null(61)=0, distinct(62)=7463.79259, null(62)=0, distinct(50,56,61)=974.275795, null(50,56,61)=0]
      │    ├── inner-join (hash)
      │    │    ├── save-table-name: q7_inner_join_4
      │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null) o_orderkey:28(int!null) o_custkey:29(int!null) c_custkey:39(int!null) c_nationkey:42(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(zero-or-one)
      │    │    ├── stats: [rows=7623.31119, distinct(1)=7623.31119, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=7377.16816, null(10)=0, distinct(12)=7623.31119, null(12)=0, distinct(15)=7454.80847, null(15)=0, distinct(16)=11, null(16)=0, distinct(20)=730.978382, null(20)=0, distinct(28)=7377.16816, null(28)=0, distinct(29)=4901.30175, null(29)=0, distinct(39)=4901.30175, null(39)=0, distinct(42)=1.29975178, null(42)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0, distinct(15,16)=7463.79259, null(15,16)=0, distinct(20,50,56)=974.275795, null(20,50,56)=0]
      │    │    ├── fd: (1)-->(4), (28)-->(29), (39)-->(42), (49)-->(50), (55)-->(56), (42)==(55), (55)==(42), (29)==(39), (39)==(29), (10)==(28), (28)==(10), (1)==(12), (12)==(1), (4)==(49), (49)==(4)
      │    │    ├── scan customer@c_nk
      │    │    │    ├── save-table-name: q7_scan_5
      │    │    │    ├── columns: c_custkey:39(int!null) c_nationkey:42(int!null)
      │    │    │    ├── stats: [rows=150000, distinct(39)=148813, null(39)=0, distinct(42)=25, null(42)=0]
      │    │    │    │   histogram(39)=  0  1   749   1   749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1
      │    │    │    │                 <--- 21 ----- 889 ----- 1630 ----- 2510 ----- 3288 ----- 4048 ----- 4613 ----- 5309 ----- 6185 ----- 6839 ----- 7585 ----- 8433 ----- 9072 ----- 9951 ----- 10688 ----- 11318 ----- 12082 ----- 12756 ----- 13494 ----- 14223 ----- 14991 ----- 15850 ----- 16649 ----- 17293 ----- 17965 ----- 18629 ----- 19252 ----- 20030 ----- 20720 ----- 21419 ----- 22133 ----- 22839 ----- 23554 ----- 24273 ----- 25014 ----- 25797 ----- 26521 ----- 27255 ----- 27922 ----- 28610 ----- 29259 ----- 30040 ----- 30631 ----- 31284 ----- 32108 ----- 32900 ----- 33862 ----- 34575 ----- 35158 ----- 36006 ----- 36817 ----- 37506 ----- 38438 ----- 39238 ----- 39968 ----- 40620 ----- 41362 ----- 41985 ----- 42901 ----- 43767 ----- 44513 ----- 45300 ----- 46014 ----- 46785 ----- 47667 ----- 48418 ----- 49060 ----- 49946 ----- 50941 ----- 51695 ----- 52415 ----- 53135 ----- 54031 ----- 54677 ----- 55406 ----- 56349 ----- 57141 ----- 57866 ----- 58667 ----- 59497 ----- 60304 ----- 61048 ----- 61949 ----- 62597 ----- 63500 ----- 64280 ----- 65202 ----- 66108 ----- 66739 ----- 67441 ----- 68383 ----- 69152 ----- 69887 ----- 70590 ----- 71256 ----- 71760 ----- 72246 ----- 72886 ----- 73551 ----- 74412 ----- 75012 ----- 75804 ----- 76485 ----- 77394 ----- 77956 ----- 78641 ----- 79336 ----- 80066 ----- 80849 ----- 81688 ----- 82479 ----- 83170 ----- 83946 ----- 84719 ----- 85620 ----- 86382 ----- 86888 ----- 87542 ----- 88231 ----- 88994 ----- 89678 ----- 90411 ----- 91126 ----- 91842 ----- 92775 ----- 93418 ----- 94042 ----- 94911 ----- 95744 ----- 96582 ----- 97441 ----- 98273 ----- 99071 ----- 99916 ----- 100516 ----- 101399 ----- 102218 ----- 102998 ----- 103731 ----- 104602 ----- 105321 ----- 105975 ----- 106678 ----- 107601 ----- 108304 ----- 109019 ----- 109626 ----- 110410 ----- 110921 ----- 111682 ----- 112462 ----- 112993 ----- 113756 ----- 114505 ----- 115291 ----- 115958 ----- 116844 ----- 117612 ----- 118464 ----- 119146 ----- 120047 ----- 120664 ----- 121344 ----- 122348 ----- 123048 ----- 124034 ----- 124830 ----- 125463 ----- 126302 ----- 126936 ----- 127692 ----- 128413 ----- 129269 ----- 130158 ----- 130992 ----- 131611 ----- 132522 ----- 133328 ----- 134147 ----- 134977 ----- 135823 ----- 136525 ----- 137144 ----- 138055 ----- 138666 ----- 139457 ----- 140262 ----- 141024 ----- 141730 ----- 142362 ----- 143136 ----- 144012 ----- 144747 ----- 145540 ----- 146393 ----- 147010 ----- 147728 ----- 148522 ----- 149204 ----- 149995
      │    │    │    │   histogram(42)=  0 5925 0 5805 0 6090 0 5820 0 5820 0 5610 0 6210 0 5520 0 6390 0 5880 0 5850 0 6105 0 6060 0 6195 0 6345 0 6165 0 5625 0 5985 0 6120 0 5775 0 6315 0 6015 0 6555 0 6165 0 5655
      │    │    │    │                 <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 ---- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    ├── key: (39)
      │    │    │    └── fd: (39)-->(42)
      │    │    ├── inner-join (lookup orders)
      │    │    │    ├── save-table-name: q7_lookup_join_6
      │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null) o_orderkey:28(int!null) o_custkey:29(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    ├── key columns: [10] = [28]
      │    │    │    ├── lookup columns are key
      │    │    │    ├── stats: [rows=98064.6001, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=94036.5303, null(10)=0, distinct(12)=529.630441, null(12)=0, distinct(15)=60523.7854, null(15)=0, distinct(16)=11, null(16)=0, distinct(20)=731, null(20)=0, distinct(28)=94036.5303, null(28)=0, distinct(29)=62455.3038, null(29)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    ├── fd: (28)-->(29), (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4), (1)==(12), (12)==(1), (10)==(28), (28)==(10)
      │    │    │    ├── inner-join (lookup lineitem)
      │    │    │    │    ├── save-table-name: q7_lookup_join_7
      │    │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    ├── key columns: [10 13] = [10 13]
      │    │    │    │    ├── lookup columns are key
      │    │    │    │    ├── stats: [rows=98064.6001, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=94036.5303, null(10)=0, distinct(12)=529.630441, null(12)=0, distinct(15)=92730.4457, null(15)=0, distinct(16)=11, null(16)=0, distinct(20)=731, null(20)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    │    ├── fd: (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4), (1)==(12), (12)==(1)
      │    │    │    │    ├── inner-join (lookup lineitem@l_sk)
      │    │    │    │    │    ├── save-table-name: q7_lookup_join_8
      │    │    │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_linenumber:13(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    ├── key columns: [1] = [12]
      │    │    │    │    │    ├── stats: [rows=322703.925, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=290903.837, null(10)=0, distinct(12)=529.630441, null(12)=0, distinct(13)=7, null(13)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    │    │    ├── key: (10,13,55)
      │    │    │    │    │    ├── fd: (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4), (10,13)-->(12), (1)==(12), (12)==(1)
      │    │    │    │    │    ├── inner-join (lookup supplier@s_nk)
      │    │    │    │    │    │    ├── save-table-name: q7_lookup_join_9
      │    │    │    │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    │    ├── key columns: [49] = [4]
      │    │    │    │    │    │    ├── stats: [rows=533.333333, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    │    │    │    ├── key: (1,55)
      │    │    │    │    │    │    ├── fd: (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4)
      │    │    │    │    │    │    ├── inner-join (cross)
      │    │    │    │    │    │    │    ├── save-table-name: q7_inner_join_10
      │    │    │    │    │    │    │    ├── columns: n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    │    │    ├── stats: [rows=1.33333333, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0, distinct(50,56)=1.33333333, null(50,56)=0]
      │    │    │    │    │    │    │    ├── key: (49,55)
      │    │    │    │    │    │    │    ├── fd: (49)-->(50), (55)-->(56)
      │    │    │    │    │    │    │    ├── scan nation [as=n1]
      │    │    │    │    │    │    │    │    ├── save-table-name: q7_scan_11
      │    │    │    │    │    │    │    │    ├── columns: n1.n_nationkey:49(int!null) n1.n_name:50(char!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(49)=25, null(49)=0, distinct(50)=25, null(50)=0]
      │    │    │    │    │    │    │    │    │   histogram(49)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │    │   histogram(50)=  0      1      23      1
      │    │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    │    │    │    ├── key: (49)
      │    │    │    │    │    │    │    │    └── fd: (49)-->(50)
      │    │    │    │    │    │    │    ├── scan nation [as=n2]
      │    │    │    │    │    │    │    │    ├── save-table-name: q7_scan_12
      │    │    │    │    │    │    │    │    ├── columns: n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(55)=25, null(55)=0, distinct(56)=25, null(56)=0]
      │    │    │    │    │    │    │    │    │   histogram(55)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │    │   histogram(56)=  0      1      23      1
      │    │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    │    │    │    ├── key: (55)
      │    │    │    │    │    │    │    │    └── fd: (55)-->(56)
      │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │         └── ((n1.n_name:50 = 'FRANCE') AND (n2.n_name:56 = 'GERMANY')) OR ((n1.n_name:50 = 'GERMANY') AND (n2.n_name:56 = 'FRANCE')) [type=bool, outer=(50,56), constraints=(/50: [/'FRANCE' - /'FRANCE'] [/'GERMANY' - /'GERMANY']; /56: [/'FRANCE' - /'FRANCE'] [/'GERMANY' - /'GERMANY'])]
      │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters
      │    │    │    │         └── (l_shipdate:20 >= '1995-01-01') AND (l_shipdate:20 <= '1996-12-31') [type=bool, outer=(20), constraints=(/20: [/'1995-01-01' - /'1996-12-31']; tight)]
      │    │    │    └── filters (true)
      │    │    └── filters
      │    │         ├── c_nationkey:42 = n2.n_nationkey:55 [type=bool, outer=(42,55), constraints=(/42: (/NULL - ]; /55: (/NULL - ]), fd=(42)==(55), (55)==(42)]
      │    │         └── c_custkey:39 = o_custkey:29 [type=bool, outer=(29,39), constraints=(/29: (/NULL - ]; /39: (/NULL - ]), fd=(29)==(39), (39)==(29)]
      │    └── projections
      │         ├── extract('year', l_shipdate:20) [as=l_year:61, type=float, outer=(20), immutable]
      │         └── l_extendedprice:15 * (1.0 - l_discount:16) [as=volume:62, type=float, outer=(15,16), immutable]
      └── aggregations
           └── sum [as=sum:63, type=float, outer=(62)]
                └── volume:62 [type=float]

----Stats for q7_sort_1----
column_names   row_count  distinct_count  null_count
{cust_nation}  4          2               0
{l_year}       4          2               0
{revenue}      4          4               0
{supp_nation}  4          2               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{cust_nation}  974.00         243.50 <==     1.00                2.00 <==            0.00            1.00
{l_year}       974.00         243.50 <==     731.00              365.50 <==          0.00            1.00
{revenue}      974.00         243.50 <==     974.00              243.50 <==          0.00            1.00
{supp_nation}  974.00         243.50 <==     1.00                2.00 <==            0.00            1.00

----Stats for q7_group_by_2----
column_names  row_count  distinct_count  null_count
{l_year}      4          2               0
{n_name_1}    4          2               0
{n_name}      4          2               0
{sum}         4          4               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_year}      974.00         243.50 <==     731.00              365.50 <==          0.00            1.00
{n_name}      974.00         243.50 <==     1.00                2.00 <==            0.00            1.00
{n_name_1}    974.00         243.50 <==     1.00                2.00 <==            0.00            1.00
{sum}         974.00         243.50 <==     974.00              243.50 <==          0.00            1.00

----Stats for q7_project_3----
column_names  row_count  distinct_count  null_count
{l_year}      5924       2               0
{n_name_1}    5924       2               0
{n_name}      5924       2               0
{volume}      5924       5904            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_year}      7623.00        1.29           731.00              365.50 <==          0.00            1.00
{n_name}      7623.00        1.29           1.00                2.00 <==            0.00            1.00
{n_name_1}    7623.00        1.29           1.00                2.00 <==            0.00            1.00
{volume}      7623.00        1.29           7464.00             1.26                0.00            1.00

----Stats for q7_inner_join_4----
column_names       row_count  distinct_count  null_count
{c_custkey}        5924       3902            0
{c_nationkey}      5924       2               0
{l_discount}       5924       11              0
{l_extendedprice}  5924       5876            0
{l_orderkey}       5924       5445            0
{l_shipdate}       5924       731             0
{l_suppkey}        5924       796             0
{n_name_1}         5924       2               0
{n_name}           5924       2               0
{n_nationkey_1}    5924       2               0
{n_nationkey}      5924       2               0
{o_custkey}        5924       3902            0
{o_orderkey}       5924       5445            0
{s_nationkey}      5924       2               0
{s_suppkey}        5924       796             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        7623.00        1.29           4901.00             1.26                0.00            1.00
{c_nationkey}      7623.00        1.29           1.00                2.00 <==            0.00            1.00
{l_discount}       7623.00        1.29           11.00               1.00                0.00            1.00
{l_extendedprice}  7623.00        1.29           7455.00             1.27                0.00            1.00
{l_orderkey}       7623.00        1.29           7377.00             1.35                0.00            1.00
{l_shipdate}       7623.00        1.29           731.00              1.00                0.00            1.00
{l_suppkey}        7623.00        1.29           7623.00             9.58 <==            0.00            1.00
{n_name}           7623.00        1.29           1.00                2.00 <==            0.00            1.00
{n_name_1}         7623.00        1.29           1.00                2.00 <==            0.00            1.00
{n_nationkey}      7623.00        1.29           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}    7623.00        1.29           1.00                2.00 <==            0.00            1.00
{o_custkey}        7623.00        1.29           4901.00             1.26                0.00            1.00
{o_orderkey}       7623.00        1.29           7377.00             1.35                0.00            1.00
{s_nationkey}      7623.00        1.29           1.00                2.00 <==            0.00            1.00
{s_suppkey}        7623.00        1.29           7623.00             9.58 <==            0.00            1.00

----Stats for q7_scan_5----
column_names   row_count  distinct_count  null_count
{c_custkey}    150000     148813          0
{c_nationkey}  150000     25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}    150000.00      1.00           148813.00           1.00                0.00            1.00
{c_nationkey}  150000.00      1.00           25.00               1.00                0.00            1.00

----Stats for q7_lookup_join_6----
column_names       row_count  distinct_count  null_count
{l_discount}       145703     11              0
{l_extendedprice}  145703     130516          0
{l_orderkey}       145703     126329          0
{l_shipdate}       145703     731             0
{l_suppkey}        145703     798             0
{n_name_1}         145703     2               0
{n_name}           145703     2               0
{n_nationkey_1}    145703     2               0
{n_nationkey}      145703     2               0
{o_custkey}        145703     68151           0
{o_orderkey}       145703     126329          0
{s_nationkey}      145703     2               0
{s_suppkey}        145703     798             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       98065.00       1.49           11.00               1.00                0.00            1.00
{l_extendedprice}  98065.00       1.49           60524.00            2.16 <==            0.00            1.00
{l_orderkey}       98065.00       1.49           94037.00            1.34                0.00            1.00
{l_shipdate}       98065.00       1.49           731.00              1.00                0.00            1.00
{l_suppkey}        98065.00       1.49           530.00              1.51                0.00            1.00
{n_name}           98065.00       1.49           1.00                2.00 <==            0.00            1.00
{n_name_1}         98065.00       1.49           1.00                2.00 <==            0.00            1.00
{n_nationkey}      98065.00       1.49           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}    98065.00       1.49           1.00                2.00 <==            0.00            1.00
{o_custkey}        98065.00       1.49           62455.00            1.09                0.00            1.00
{o_orderkey}       98065.00       1.49           94037.00            1.34                0.00            1.00
{s_nationkey}      98065.00       1.49           1.00                2.00 <==            0.00            1.00
{s_suppkey}        98065.00       1.49           530.00              1.51                0.00            1.00

----Stats for q7_lookup_join_7----
column_names       row_count  distinct_count  null_count
{l_discount}       145703     11              0
{l_extendedprice}  145703     130516          0
{l_orderkey}       145703     126329          0
{l_shipdate}       145703     731             0
{l_suppkey}        145703     798             0
{n_name_1}         145703     2               0
{n_name}           145703     2               0
{n_nationkey_1}    145703     2               0
{n_nationkey}      145703     2               0
{s_nationkey}      145703     2               0
{s_suppkey}        145703     798             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       98065.00       1.49           11.00               1.00                0.00            1.00
{l_extendedprice}  98065.00       1.49           92730.00            1.41                0.00            1.00
{l_orderkey}       98065.00       1.49           94037.00            1.34                0.00            1.00
{l_shipdate}       98065.00       1.49           731.00              1.00                0.00            1.00
{l_suppkey}        98065.00       1.49           530.00              1.51                0.00            1.00
{n_name}           98065.00       1.49           1.00                2.00 <==            0.00            1.00
{n_name_1}         98065.00       1.49           1.00                2.00 <==            0.00            1.00
{n_nationkey}      98065.00       1.49           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}    98065.00       1.49           1.00                2.00 <==            0.00            1.00
{s_nationkey}      98065.00       1.49           1.00                2.00 <==            0.00            1.00
{s_suppkey}        98065.00       1.49           530.00              1.51                0.00            1.00

----Stats for q7_lookup_join_8----
column_names     row_count  distinct_count  null_count
{l_linenumber}   478523     7               0
{l_orderkey}     478523     411655          0
{l_suppkey}      478523     798             0
{n_name_1}       478523     2               0
{n_name}         478523     2               0
{n_nationkey_1}  478523     2               0
{n_nationkey}    478523     2               0
{s_nationkey}    478523     2               0
{s_suppkey}      478523     798             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}   322704.00      1.48           7.00                1.00                0.00            1.00
{l_orderkey}     322704.00      1.48           290904.00           1.42                0.00            1.00
{l_suppkey}      322704.00      1.48           530.00              1.51                0.00            1.00
{n_name}         322704.00      1.48           1.00                2.00 <==            0.00            1.00
{n_name_1}       322704.00      1.48           1.00                2.00 <==            0.00            1.00
{n_nationkey}    322704.00      1.48           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}  322704.00      1.48           1.00                2.00 <==            0.00            1.00
{s_nationkey}    322704.00      1.48           1.00                2.00 <==            0.00            1.00
{s_suppkey}      322704.00      1.48           530.00              1.51                0.00            1.00

----Stats for q7_lookup_join_9----
column_names     row_count  distinct_count  null_count
{n_name_1}       798        2               0
{n_name}         798        2               0
{n_nationkey_1}  798        2               0
{n_nationkey}    798        2               0
{s_nationkey}    798        2               0
{s_suppkey}      798        798             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         533.00         1.50           1.00                2.00 <==            0.00            1.00
{n_name_1}       533.00         1.50           1.00                2.00 <==            0.00            1.00
{n_nationkey}    533.00         1.50           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}  533.00         1.50           1.00                2.00 <==            0.00            1.00
{s_nationkey}    533.00         1.50           1.00                2.00 <==            0.00            1.00
{s_suppkey}      533.00         1.50           530.00              1.51                0.00            1.00

----Stats for q7_inner_join_10----
column_names     row_count  distinct_count  null_count
{n_name_1}       2          2               0
{n_name}         2          2               0
{n_nationkey_1}  2          2               0
{n_nationkey}    2          2               0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         1.00           2.00 <==       1.00                2.00 <==            0.00            1.00
{n_name_1}       1.00           2.00 <==       1.00                2.00 <==            0.00            1.00
{n_nationkey}    1.00           2.00 <==       1.00                2.00 <==            0.00            1.00
{n_nationkey_1}  1.00           2.00 <==       1.00                2.00 <==            0.00            1.00

----Stats for q7_scan_11----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00

----Stats for q7_scan_12----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
----
----
