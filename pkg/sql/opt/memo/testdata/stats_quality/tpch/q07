import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q7
# Volume Shipping
# Determines the value of goods shipped between certain nations to help in the
# re-negotiation of shipping contracts.
#
# Finds, for two given nations, the gross discounted revenues derived from
# lineitems in which parts were shipped from a supplier in either nation to a
# customer in the other nation during 1995 and 1996. The query lists the
# supplier nation, the customer nation, the year, and the revenue from shipments
# that took place in that year. The query orders the answer by Supplier nation,
# Customer nation, and year (all ascending).
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q7
SELECT
    supp_nation,
    cust_nation,
    l_year, sum(volume) AS revenue
FROM (
    SELECT
        n1.n_name AS supp_nation,
        n2.n_name AS cust_nation,
        extract(year FROM l_shipdate) AS l_year,
        l_extendedprice * (1 - l_discount) AS volume
    FROM
        supplier,
        lineitem,
        orders,
        customer,
        nation n1,
        nation n2
    WHERE
        s_suppkey = l_suppkey
        AND o_orderkey = l_orderkey
        AND c_custkey = o_custkey
        AND s_nationkey = n1.n_nationkey
        AND c_nationkey = n2.n_nationkey
        AND (
            (n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY')
            or (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')
        )
        AND l_shipdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31'
    ) AS shipping
GROUP BY
    supp_nation,
    cust_nation,
    l_year
ORDER BY
    supp_nation,
    cust_nation,
    l_year;
----
----
sort
 ├── save-table-name: q7_sort_1
 ├── columns: supp_nation:50(char!null) cust_nation:56(char!null) l_year:61(float) revenue:63(float!null)
 ├── immutable
 ├── stats: [rows=974.235267, distinct(50)=1.33333333, null(50)=0, distinct(56)=1.33333333, null(56)=0, distinct(61)=730.975343, null(61)=0, distinct(63)=974.235267, null(63)=0, distinct(50,56,61)=974.235267, null(50,56,61)=0]
 ├── key: (50,56,61)
 ├── fd: (50,56,61)-->(63)
 ├── ordering: +50,+56,+61
 └── group-by
      ├── save-table-name: q7_group_by_2
      ├── columns: n1.n_name:50(char!null) n2.n_name:56(char!null) l_year:61(float) sum:63(float!null)
      ├── grouping columns: n1.n_name:50(char!null) n2.n_name:56(char!null) l_year:61(float)
      ├── immutable
      ├── stats: [rows=974.235267, distinct(50)=1.33333333, null(50)=0, distinct(56)=1.33333333, null(56)=0, distinct(61)=730.975343, null(61)=0, distinct(63)=974.235267, null(63)=0, distinct(50,56,61)=974.235267, null(50,56,61)=0]
      ├── key: (50,56,61)
      ├── fd: (50,56,61)-->(63)
      ├── project
      │    ├── save-table-name: q7_project_3
      │    ├── columns: l_year:61(float) volume:62(float!null) n1.n_name:50(char!null) n2.n_name:56(char!null)
      │    ├── immutable
      │    ├── stats: [rows=7527.15613, distinct(50)=1.33333333, null(50)=0, distinct(56)=1.33333333, null(56)=0, distinct(61)=730.975343, null(61)=0, distinct(62)=7369.52561, null(62)=0, distinct(50,56,61)=974.235267, null(50,56,61)=0]
      │    ├── inner-join (hash)
      │    │    ├── save-table-name: q7_inner_join_4
      │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null) o_orderkey:28(int!null) o_custkey:29(int!null) c_custkey:39(int!null) c_nationkey:42(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(zero-or-one)
      │    │    ├── stats: [rows=7527.15613, distinct(1)=7527.15613, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=7287.11759, null(10)=0, distinct(12)=7527.15613, null(12)=0, distinct(15)=7360.83718, null(15)=0, distinct(16)=11, null(16)=0, distinct(20)=730.975343, null(20)=0, distinct(28)=7287.11759, null(28)=0, distinct(29)=4864.24517, null(29)=0, distinct(39)=4864.24517, null(39)=0, distinct(42)=1.29975178, null(42)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0, distinct(15,16)=7369.52561, null(15,16)=0, distinct(20,50,56)=974.235267, null(20,50,56)=0]
      │    │    ├── fd: (1)-->(4), (28)-->(29), (39)-->(42), (49)-->(50), (55)-->(56), (42)==(55), (55)==(42), (29)==(39), (39)==(29), (10)==(28), (28)==(10), (1)==(12), (12)==(1), (4)==(49), (49)==(4)
      │    │    ├── scan customer@c_nk
      │    │    │    ├── save-table-name: q7_scan_5
      │    │    │    ├── columns: c_custkey:39(int!null) c_nationkey:42(int!null)
      │    │    │    ├── stats: [rows=150000, distinct(39)=148813, null(39)=0, distinct(42)=25, null(42)=0]
      │    │    │    │   histogram(39)=  0  6   743   6    743   6    743   6    743   6    743   6    743   6    743   6    743   6    743   6    743   6    743   6    743   6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6    743    6     743    6     743    6     743    6     743    6     743    6     743    6     743    6     743    6     743    6     743    6     743    6     743    6     743    6     743    6     743    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6     758    6
      │    │    │    │                 <--- 15 ----- 1000 ----- 1729 ----- 2456 ----- 3206 ----- 3920 ----- 4786 ----- 5439 ----- 6291 ----- 7153 ----- 7946 ----- 8660 ----- 9407 ----- 10188 ----- 11057 ----- 11883 ----- 12613 ----- 13079 ----- 13746 ----- 14565 ----- 15339 ----- 16039 ----- 16761 ----- 17642 ----- 18228 ----- 18900 ----- 19615 ----- 20428 ----- 21262 ----- 22140 ----- 22748 ----- 23463 ----- 24009 ----- 24652 ----- 25302 ----- 26104 ----- 26765 ----- 27632 ----- 28315 ----- 29087 ----- 29832 ----- 30513 ----- 31325 ----- 32135 ----- 32780 ----- 33619 ----- 34517 ----- 35256 ----- 35884 ----- 36581 ----- 37332 ----- 37966 ----- 38867 ----- 39590 ----- 40299 ----- 40935 ----- 41822 ----- 42673 ----- 43542 ----- 44177 ----- 44748 ----- 45436 ----- 46119 ----- 46815 ----- 47432 ----- 48154 ----- 48925 ----- 49891 ----- 50759 ----- 51597 ----- 52433 ----- 53280 ----- 54047 ----- 54845 ----- 55557 ----- 56166 ----- 56919 ----- 57534 ----- 58172 ----- 58810 ----- 59539 ----- 60361 ----- 61113 ----- 61801 ----- 62654 ----- 63290 ----- 64097 ----- 64856 ----- 65647 ----- 66558 ----- 67105 ----- 67872 ----- 68765 ----- 69488 ----- 70125 ----- 70859 ----- 71803 ----- 72392 ----- 73075 ----- 73708 ----- 74531 ----- 75218 ----- 76001 ----- 76750 ----- 77579 ----- 78392 ----- 79144 ----- 80008 ----- 80802 ----- 81583 ----- 82244 ----- 83003 ----- 83797 ----- 84571 ----- 85408 ----- 86133 ----- 86910 ----- 87596 ----- 88237 ----- 89097 ----- 89779 ----- 90398 ----- 91294 ----- 91983 ----- 92821 ----- 93398 ----- 94052 ----- 94745 ----- 95391 ----- 96113 ----- 96654 ----- 97610 ----- 98380 ----- 99120 ----- 99849 ----- 100559 ----- 101056 ----- 101854 ----- 102563 ----- 103156 ----- 103983 ----- 104812 ----- 105543 ----- 106316 ----- 107084 ----- 107798 ----- 108503 ----- 109323 ----- 109960 ----- 110801 ----- 111693 ----- 112407 ----- 113054 ----- 113889 ----- 114649 ----- 115417 ----- 116107 ----- 117012 ----- 117996 ----- 118854 ----- 119571 ----- 120354 ----- 121179 ----- 122060 ----- 122991 ----- 123722 ----- 124487 ----- 125120 ----- 125792 ----- 126373 ----- 127168 ----- 128022 ----- 128657 ----- 129416 ----- 130387 ----- 131238 ----- 131869 ----- 132550 ----- 133313 ----- 134243 ----- 135005 ----- 135781 ----- 136463 ----- 137180 ----- 138038 ----- 138725 ----- 139607 ----- 140320 ----- 141036 ----- 141805 ----- 142350 ----- 143293 ----- 144060 ----- 144806 ----- 145783 ----- 146789 ----- 147534 ----- 148356 ----- 149188 ----- 149969
      │    │    │    │   histogram(42)=  0 5805 0 6150 0 6075 0 5850 0 6180 0 6420 0 5820 0 6375 0 5700 0 5745 0 5565 0 6060 0 5655 0 6330 0 6225 0 5955 0 6000 0 5685 0 5490 0 6090 0 5925 0 5850 0 6345 0 6480 0 6225
      │    │    │    │                 <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 ---- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    ├── key: (39)
      │    │    │    └── fd: (39)-->(42)
      │    │    ├── inner-join (lookup orders)
      │    │    │    ├── save-table-name: q7_lookup_join_6
      │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null) o_orderkey:28(int!null) o_custkey:29(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    ├── key columns: [10] = [28]
      │    │    │    ├── lookup columns are key
      │    │    │    ├── stats: [rows=95333.7502, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=91465.9471, null(10)=0, distinct(12)=529.630441, null(12)=0, distinct(15)=58865.1276, null(15)=0, distinct(16)=11, null(16)=0, distinct(20)=731, null(20)=0, distinct(28)=91465.9471, null(28)=0, distinct(29)=61418.4108, null(29)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    ├── fd: (28)-->(29), (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4), (1)==(12), (12)==(1), (10)==(28), (28)==(10)
      │    │    │    ├── inner-join (lookup lineitem)
      │    │    │    │    ├── save-table-name: q7_lookup_join_7
      │    │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    ├── key columns: [10 13] = [10 13]
      │    │    │    │    ├── lookup columns are key
      │    │    │    │    ├── stats: [rows=95333.7502, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=91465.9471, null(10)=0, distinct(12)=529.630441, null(12)=0, distinct(15)=90242.0263, null(15)=0, distinct(16)=11, null(16)=0, distinct(20)=731, null(20)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    │    ├── fd: (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4), (1)==(12), (12)==(1)
      │    │    │    │    ├── inner-join (lookup lineitem@l_sk)
      │    │    │    │    │    ├── save-table-name: q7_lookup_join_8
      │    │    │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_linenumber:13(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    ├── key columns: [1] = [12]
      │    │    │    │    │    ├── stats: [rows=322703.925, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=290903.837, null(10)=0, distinct(12)=529.630441, null(12)=0, distinct(13)=7, null(13)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    │    │    ├── key: (10,13,55)
      │    │    │    │    │    ├── fd: (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4), (10,13)-->(12), (1)==(12), (12)==(1)
      │    │    │    │    │    ├── inner-join (lookup supplier@s_nk)
      │    │    │    │    │    │    ├── save-table-name: q7_lookup_join_9
      │    │    │    │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    │    ├── key columns: [49] = [4]
      │    │    │    │    │    │    ├── stats: [rows=533.333333, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    │    │    │    ├── key: (1,55)
      │    │    │    │    │    │    ├── fd: (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4)
      │    │    │    │    │    │    ├── inner-join (cross)
      │    │    │    │    │    │    │    ├── save-table-name: q7_inner_join_10
      │    │    │    │    │    │    │    ├── columns: n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    │    │    ├── stats: [rows=1.33333333, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0, distinct(50,56)=1.33333333, null(50,56)=0]
      │    │    │    │    │    │    │    ├── key: (49,55)
      │    │    │    │    │    │    │    ├── fd: (49)-->(50), (55)-->(56)
      │    │    │    │    │    │    │    ├── scan nation [as=n1]
      │    │    │    │    │    │    │    │    ├── save-table-name: q7_scan_11
      │    │    │    │    │    │    │    │    ├── columns: n1.n_nationkey:49(int!null) n1.n_name:50(char!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(49)=25, null(49)=0, distinct(50)=25, null(50)=0]
      │    │    │    │    │    │    │    │    │   histogram(49)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │    │   histogram(50)=  0      1      23      1
      │    │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    │    │    │    ├── key: (49)
      │    │    │    │    │    │    │    │    └── fd: (49)-->(50)
      │    │    │    │    │    │    │    ├── scan nation [as=n2]
      │    │    │    │    │    │    │    │    ├── save-table-name: q7_scan_12
      │    │    │    │    │    │    │    │    ├── columns: n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(55)=25, null(55)=0, distinct(56)=25, null(56)=0]
      │    │    │    │    │    │    │    │    │   histogram(55)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │    │   histogram(56)=  0      1      23      1
      │    │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    │    │    │    ├── key: (55)
      │    │    │    │    │    │    │    │    └── fd: (55)-->(56)
      │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │         └── ((n1.n_name:50 = 'FRANCE') AND (n2.n_name:56 = 'GERMANY')) OR ((n1.n_name:50 = 'GERMANY') AND (n2.n_name:56 = 'FRANCE')) [type=bool, outer=(50,56), constraints=(/50: [/'FRANCE' - /'FRANCE'] [/'GERMANY' - /'GERMANY']; /56: [/'FRANCE' - /'FRANCE'] [/'GERMANY' - /'GERMANY'])]
      │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters
      │    │    │    │         └── (l_shipdate:20 >= '1995-01-01') AND (l_shipdate:20 <= '1996-12-31') [type=bool, outer=(20), constraints=(/20: [/'1995-01-01' - /'1996-12-31']; tight)]
      │    │    │    └── filters (true)
      │    │    └── filters
      │    │         ├── c_nationkey:42 = n2.n_nationkey:55 [type=bool, outer=(42,55), constraints=(/42: (/NULL - ]; /55: (/NULL - ]), fd=(42)==(55), (55)==(42)]
      │    │         └── c_custkey:39 = o_custkey:29 [type=bool, outer=(29,39), constraints=(/29: (/NULL - ]; /39: (/NULL - ]), fd=(29)==(39), (39)==(29)]
      │    └── projections
      │         ├── extract('year', l_shipdate:20) [as=l_year:61, type=float, outer=(20), immutable]
      │         └── l_extendedprice:15 * (1.0 - l_discount:16) [as=volume:62, type=float, outer=(15,16), immutable]
      └── aggregations
           └── sum [as=sum:63, type=float, outer=(62)]
                └── volume:62 [type=float]

----Stats for q7_sort_1----
column_names   row_count  distinct_count  null_count
{cust_nation}  4          2               0
{l_year}       4          2               0
{revenue}      4          4               0
{supp_nation}  4          2               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{cust_nation}  974.00         243.50 <==     1.00                2.00 <==            0.00            1.00
{l_year}       974.00         243.50 <==     731.00              365.50 <==          0.00            1.00
{revenue}      974.00         243.50 <==     974.00              243.50 <==          0.00            1.00
{supp_nation}  974.00         243.50 <==     1.00                2.00 <==            0.00            1.00

----Stats for q7_group_by_2----
column_names  row_count  distinct_count  null_count
{l_year}      4          2               0
{n_name_1}    4          2               0
{n_name}      4          2               0
{sum}         4          4               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_year}      974.00         243.50 <==     731.00              365.50 <==          0.00            1.00
{n_name}      974.00         243.50 <==     1.00                2.00 <==            0.00            1.00
{n_name_1}    974.00         243.50 <==     1.00                2.00 <==            0.00            1.00
{sum}         974.00         243.50 <==     974.00              243.50 <==          0.00            1.00

----Stats for q7_project_3----
column_names  row_count  distinct_count  null_count
{l_year}      5924       2               0
{n_name_1}    5924       2               0
{n_name}      5924       2               0
{volume}      5924       5904            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_year}      7527.00        1.27           731.00              365.50 <==          0.00            1.00
{n_name}      7527.00        1.27           1.00                2.00 <==            0.00            1.00
{n_name_1}    7527.00        1.27           1.00                2.00 <==            0.00            1.00
{volume}      7527.00        1.27           7370.00             1.25                0.00            1.00

----Stats for q7_inner_join_4----
column_names       row_count  distinct_count  null_count
{c_custkey}        5924       3902            0
{c_nationkey}      5924       2               0
{l_discount}       5924       11              0
{l_extendedprice}  5924       5876            0
{l_orderkey}       5924       5445            0
{l_shipdate}       5924       731             0
{l_suppkey}        5924       796             0
{n_name_1}         5924       2               0
{n_name}           5924       2               0
{n_nationkey_1}    5924       2               0
{n_nationkey}      5924       2               0
{o_custkey}        5924       3902            0
{o_orderkey}       5924       5445            0
{s_nationkey}      5924       2               0
{s_suppkey}        5924       796             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        7527.00        1.27           4864.00             1.25                0.00            1.00
{c_nationkey}      7527.00        1.27           1.00                2.00 <==            0.00            1.00
{l_discount}       7527.00        1.27           11.00               1.00                0.00            1.00
{l_extendedprice}  7527.00        1.27           7361.00             1.25                0.00            1.00
{l_orderkey}       7527.00        1.27           7287.00             1.34                0.00            1.00
{l_shipdate}       7527.00        1.27           731.00              1.00                0.00            1.00
{l_suppkey}        7527.00        1.27           7527.00             9.46 <==            0.00            1.00
{n_name}           7527.00        1.27           1.00                2.00 <==            0.00            1.00
{n_name_1}         7527.00        1.27           1.00                2.00 <==            0.00            1.00
{n_nationkey}      7527.00        1.27           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}    7527.00        1.27           1.00                2.00 <==            0.00            1.00
{o_custkey}        7527.00        1.27           4864.00             1.25                0.00            1.00
{o_orderkey}       7527.00        1.27           7287.00             1.34                0.00            1.00
{s_nationkey}      7527.00        1.27           1.00                2.00 <==            0.00            1.00
{s_suppkey}        7527.00        1.27           7527.00             9.46 <==            0.00            1.00

----Stats for q7_scan_5----
column_names   row_count  distinct_count  null_count
{c_custkey}    150000     148813          0
{c_nationkey}  150000     25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}    150000.00      1.00           148813.00           1.00                0.00            1.00
{c_nationkey}  150000.00      1.00           25.00               1.00                0.00            1.00

----Stats for q7_lookup_join_6----
column_names       row_count  distinct_count  null_count
{l_discount}       145703     11              0
{l_extendedprice}  145703     130516          0
{l_orderkey}       145703     126329          0
{l_shipdate}       145703     731             0
{l_suppkey}        145703     798             0
{n_name_1}         145703     2               0
{n_name}           145703     2               0
{n_nationkey_1}    145703     2               0
{n_nationkey}      145703     2               0
{o_custkey}        145703     68151           0
{o_orderkey}       145703     126329          0
{s_nationkey}      145703     2               0
{s_suppkey}        145703     798             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       95334.00       1.53           11.00               1.00                0.00            1.00
{l_extendedprice}  95334.00       1.53           58865.00            2.22 <==            0.00            1.00
{l_orderkey}       95334.00       1.53           91466.00            1.38                0.00            1.00
{l_shipdate}       95334.00       1.53           731.00              1.00                0.00            1.00
{l_suppkey}        95334.00       1.53           530.00              1.51                0.00            1.00
{n_name}           95334.00       1.53           1.00                2.00 <==            0.00            1.00
{n_name_1}         95334.00       1.53           1.00                2.00 <==            0.00            1.00
{n_nationkey}      95334.00       1.53           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}    95334.00       1.53           1.00                2.00 <==            0.00            1.00
{o_custkey}        95334.00       1.53           61418.00            1.11                0.00            1.00
{o_orderkey}       95334.00       1.53           91466.00            1.38                0.00            1.00
{s_nationkey}      95334.00       1.53           1.00                2.00 <==            0.00            1.00
{s_suppkey}        95334.00       1.53           530.00              1.51                0.00            1.00

----Stats for q7_lookup_join_7----
column_names       row_count  distinct_count  null_count
{l_discount}       145703     11              0
{l_extendedprice}  145703     130516          0
{l_orderkey}       145703     126329          0
{l_shipdate}       145703     731             0
{l_suppkey}        145703     798             0
{n_name_1}         145703     2               0
{n_name}           145703     2               0
{n_nationkey_1}    145703     2               0
{n_nationkey}      145703     2               0
{s_nationkey}      145703     2               0
{s_suppkey}        145703     798             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       95334.00       1.53           11.00               1.00                0.00            1.00
{l_extendedprice}  95334.00       1.53           90242.00            1.45                0.00            1.00
{l_orderkey}       95334.00       1.53           91466.00            1.38                0.00            1.00
{l_shipdate}       95334.00       1.53           731.00              1.00                0.00            1.00
{l_suppkey}        95334.00       1.53           530.00              1.51                0.00            1.00
{n_name}           95334.00       1.53           1.00                2.00 <==            0.00            1.00
{n_name_1}         95334.00       1.53           1.00                2.00 <==            0.00            1.00
{n_nationkey}      95334.00       1.53           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}    95334.00       1.53           1.00                2.00 <==            0.00            1.00
{s_nationkey}      95334.00       1.53           1.00                2.00 <==            0.00            1.00
{s_suppkey}        95334.00       1.53           530.00              1.51                0.00            1.00

----Stats for q7_lookup_join_8----
column_names     row_count  distinct_count  null_count
{l_linenumber}   478523     7               0
{l_orderkey}     478523     411655          0
{l_suppkey}      478523     798             0
{n_name_1}       478523     2               0
{n_name}         478523     2               0
{n_nationkey_1}  478523     2               0
{n_nationkey}    478523     2               0
{s_nationkey}    478523     2               0
{s_suppkey}      478523     798             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}   322704.00      1.48           7.00                1.00                0.00            1.00
{l_orderkey}     322704.00      1.48           290904.00           1.42                0.00            1.00
{l_suppkey}      322704.00      1.48           530.00              1.51                0.00            1.00
{n_name}         322704.00      1.48           1.00                2.00 <==            0.00            1.00
{n_name_1}       322704.00      1.48           1.00                2.00 <==            0.00            1.00
{n_nationkey}    322704.00      1.48           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}  322704.00      1.48           1.00                2.00 <==            0.00            1.00
{s_nationkey}    322704.00      1.48           1.00                2.00 <==            0.00            1.00
{s_suppkey}      322704.00      1.48           530.00              1.51                0.00            1.00

----Stats for q7_lookup_join_9----
column_names     row_count  distinct_count  null_count
{n_name_1}       798        2               0
{n_name}         798        2               0
{n_nationkey_1}  798        2               0
{n_nationkey}    798        2               0
{s_nationkey}    798        2               0
{s_suppkey}      798        798             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         533.00         1.50           1.00                2.00 <==            0.00            1.00
{n_name_1}       533.00         1.50           1.00                2.00 <==            0.00            1.00
{n_nationkey}    533.00         1.50           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}  533.00         1.50           1.00                2.00 <==            0.00            1.00
{s_nationkey}    533.00         1.50           1.00                2.00 <==            0.00            1.00
{s_suppkey}      533.00         1.50           530.00              1.51                0.00            1.00

----Stats for q7_inner_join_10----
column_names     row_count  distinct_count  null_count
{n_name_1}       2          2               0
{n_name}         2          2               0
{n_nationkey_1}  2          2               0
{n_nationkey}    2          2               0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         1.00           2.00 <==       1.00                2.00 <==            0.00            1.00
{n_name_1}       1.00           2.00 <==       1.00                2.00 <==            0.00            1.00
{n_nationkey}    1.00           2.00 <==       1.00                2.00 <==            0.00            1.00
{n_nationkey_1}  1.00           2.00 <==       1.00                2.00 <==            0.00            1.00

----Stats for q7_scan_11----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00

----Stats for q7_scan_12----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
----
----
