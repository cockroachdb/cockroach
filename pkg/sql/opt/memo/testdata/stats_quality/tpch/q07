import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q7
# Volume Shipping
# Determines the value of goods shipped between certain nations to help in the
# re-negotiation of shipping contracts.
#
# Finds, for two given nations, the gross discounted revenues derived from
# lineitems in which parts were shipped from a supplier in either nation to a
# customer in the other nation during 1995 and 1996. The query lists the
# supplier nation, the customer nation, the year, and the revenue from shipments
# that took place in that year. The query orders the answer by Supplier nation,
# Customer nation, and year (all ascending).
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q7
SELECT
    supp_nation,
    cust_nation,
    l_year, sum(volume) AS revenue
FROM (
    SELECT
        n1.n_name AS supp_nation,
        n2.n_name AS cust_nation,
        extract(year FROM l_shipdate) AS l_year,
        l_extendedprice * (1 - l_discount) AS volume
    FROM
        supplier,
        lineitem,
        orders,
        customer,
        nation n1,
        nation n2
    WHERE
        s_suppkey = l_suppkey
        AND o_orderkey = l_orderkey
        AND c_custkey = o_custkey
        AND s_nationkey = n1.n_nationkey
        AND c_nationkey = n2.n_nationkey
        AND (
            (n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY')
            or (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE')
        )
        AND l_shipdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31'
    ) AS shipping
GROUP BY
    supp_nation,
    cust_nation,
    l_year
ORDER BY
    supp_nation,
    cust_nation,
    l_year;
----
----
sort
 ├── save-table-name: q7_sort_1
 ├── columns: supp_nation:50(char!null) cust_nation:56(char!null) l_year:61(float) revenue:63(float!null)
 ├── immutable
 ├── stats: [rows=974.295995, distinct(50)=1.33333333, null(50)=0, distinct(56)=1.33333333, null(56)=0, distinct(61)=730.979858, null(61)=0, distinct(63)=974.295995, null(63)=0, distinct(50,56,61)=974.295995, null(50,56,61)=0]
 ├── key: (50,56,61)
 ├── fd: (50,56,61)-->(63)
 ├── ordering: +50,+56,+61
 └── group-by
      ├── save-table-name: q7_group_by_2
      ├── columns: n1.n_name:50(char!null) n2.n_name:56(char!null) l_year:61(float) sum:63(float!null)
      ├── grouping columns: n1.n_name:50(char!null) n2.n_name:56(char!null) l_year:61(float)
      ├── immutable
      ├── stats: [rows=974.295995, distinct(50)=1.33333333, null(50)=0, distinct(56)=1.33333333, null(56)=0, distinct(61)=730.979858, null(61)=0, distinct(63)=974.295995, null(63)=0, distinct(50,56,61)=974.295995, null(50,56,61)=0]
      ├── key: (50,56,61)
      ├── fd: (50,56,61)-->(63)
      ├── project
      │    ├── save-table-name: q7_project_3
      │    ├── columns: l_year:61(float) volume:62(float!null) n1.n_name:50(char!null) n2.n_name:56(char!null)
      │    ├── immutable
      │    ├── stats: [rows=7675.03028, distinct(50)=1.33333333, null(50)=0, distinct(56)=1.33333333, null(56)=0, distinct(61)=730.979858, null(61)=0, distinct(62)=7514.49346, null(62)=0, distinct(50,56,61)=974.295995, null(50,56,61)=0]
      │    ├── inner-join (hash)
      │    │    ├── save-table-name: q7_inner_join_4
      │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null) o_orderkey:28(int!null) o_custkey:29(int!null) c_custkey:39(int!null) c_nationkey:42(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(zero-or-one)
      │    │    ├── stats: [rows=7675.03028, distinct(1)=7675.03028, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=7425.57282, null(10)=0, distinct(12)=7675.03028, null(12)=0, distinct(15)=7505.34793, null(15)=0, distinct(16)=11, null(16)=0, distinct(20)=730.979858, null(20)=0, distinct(28)=7425.57282, null(28)=0, distinct(29)=4921.04872, null(29)=0, distinct(39)=4921.04872, null(39)=0, distinct(42)=1.29975178, null(42)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0, distinct(15,16)=7514.49346, null(15,16)=0, distinct(20,50,56)=974.295995, null(20,50,56)=0]
      │    │    ├── fd: (1)-->(4), (28)-->(29), (39)-->(42), (49)-->(50), (55)-->(56), (42)==(55), (55)==(42), (29)==(39), (39)==(29), (10)==(28), (28)==(10), (1)==(12), (12)==(1), (4)==(49), (49)==(4)
      │    │    ├── scan customer@c_nk
      │    │    │    ├── save-table-name: q7_scan_5
      │    │    │    ├── columns: c_custkey:39(int!null) c_nationkey:42(int!null)
      │    │    │    ├── stats: [rows=150000, distinct(39)=148813, null(39)=0, distinct(42)=25, null(42)=0]
      │    │    │    │   histogram(39)=  0  1  749   1   749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749   1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1    749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     749    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1     764    1
      │    │    │    │                 <--- 4 ----- 643 ----- 1385 ----- 2088 ----- 2755 ----- 3419 ----- 4178 ----- 4992 ----- 5745 ----- 6599 ----- 7332 ----- 8247 ----- 8901 ----- 9672 ----- 10395 ----- 11191 ----- 11923 ----- 12599 ----- 13338 ----- 14119 ----- 14978 ----- 15849 ----- 16568 ----- 17278 ----- 18070 ----- 18866 ----- 19610 ----- 20242 ----- 21140 ----- 21928 ----- 22687 ----- 23646 ----- 24501 ----- 25271 ----- 26113 ----- 26738 ----- 27469 ----- 28146 ----- 28969 ----- 29776 ----- 30682 ----- 31321 ----- 32131 ----- 32672 ----- 33462 ----- 34050 ----- 34689 ----- 35441 ----- 36096 ----- 36982 ----- 37870 ----- 38495 ----- 39235 ----- 39885 ----- 40599 ----- 41310 ----- 42114 ----- 42715 ----- 43750 ----- 44474 ----- 45262 ----- 46056 ----- 46778 ----- 47441 ----- 47946 ----- 48676 ----- 49295 ----- 50123 ----- 51002 ----- 51671 ----- 52593 ----- 53288 ----- 53903 ----- 54637 ----- 55470 ----- 56111 ----- 56618 ----- 57328 ----- 58039 ----- 58716 ----- 59457 ----- 60282 ----- 61137 ----- 61856 ----- 62665 ----- 63540 ----- 64267 ----- 65010 ----- 65750 ----- 66446 ----- 66991 ----- 67626 ----- 68342 ----- 69277 ----- 70264 ----- 71123 ----- 71744 ----- 72422 ----- 73463 ----- 74357 ----- 75147 ----- 75829 ----- 76505 ----- 77197 ----- 77921 ----- 78595 ----- 79357 ----- 80258 ----- 80879 ----- 81740 ----- 82456 ----- 83226 ----- 83919 ----- 84720 ----- 85265 ----- 85943 ----- 86895 ----- 87865 ----- 88449 ----- 89276 ----- 90016 ----- 90903 ----- 91551 ----- 92451 ----- 93475 ----- 94050 ----- 94813 ----- 95592 ----- 96289 ----- 97125 ----- 97851 ----- 98685 ----- 99240 ----- 99824 ----- 100544 ----- 101102 ----- 101783 ----- 102455 ----- 103322 ----- 104253 ----- 104972 ----- 105709 ----- 106317 ----- 107120 ----- 107929 ----- 108467 ----- 109178 ----- 109970 ----- 110696 ----- 111410 ----- 112270 ----- 113068 ----- 114071 ----- 114898 ----- 115856 ----- 116760 ----- 117578 ----- 118335 ----- 119159 ----- 119866 ----- 120653 ----- 121364 ----- 122174 ----- 122710 ----- 123576 ----- 124101 ----- 124918 ----- 125707 ----- 126446 ----- 127337 ----- 128131 ----- 128919 ----- 129537 ----- 130233 ----- 131098 ----- 131835 ----- 132509 ----- 133299 ----- 134044 ----- 134822 ----- 135568 ----- 136390 ----- 137179 ----- 137999 ----- 138803 ----- 139465 ----- 140233 ----- 140928 ----- 141661 ----- 142426 ----- 143348 ----- 144282 ----- 145011 ----- 145725 ----- 146450 ----- 147238 ----- 147724 ----- 148434 ----- 149197 ----- 149998
      │    │    │    │   histogram(42)=  0 5910 0 6060 0 6030 0 6030 0 5685 0 5730 0 6000 0 5940 0 6000 0 5775 0 5760 0 6015 0 6210 0 6000 0 6075 0 6030 0 6240 0 6270 0 6195 0 6105 0 5805 0 6030 0 6015 0 6150 0 5940
      │    │    │    │                 <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 ---- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    ├── key: (39)
      │    │    │    └── fd: (39)-->(42)
      │    │    ├── inner-join (lookup orders)
      │    │    │    ├── save-table-name: q7_lookup_join_6
      │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null) o_orderkey:28(int!null) o_custkey:29(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    ├── key columns: [10] = [28]
      │    │    │    ├── lookup columns are key
      │    │    │    ├── stats: [rows=99519.7381, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=95404.9072, null(10)=0, distinct(12)=529.630441, null(12)=0, distinct(15)=61406.8397, null(15)=0, distinct(16)=11, null(16)=0, distinct(20)=731, null(20)=0, distinct(28)=95404.9072, null(28)=0, distinct(29)=62996.3414, null(29)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    ├── fd: (28)-->(29), (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4), (1)==(12), (12)==(1), (10)==(28), (28)==(10)
      │    │    │    ├── inner-join (lookup lineitem)
      │    │    │    │    ├── save-table-name: q7_lookup_join_7
      │    │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_extendedprice:15(float!null) l_discount:16(float!null) l_shipdate:20(date!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    ├── key columns: [10 13] = [10 13]
      │    │    │    │    ├── lookup columns are key
      │    │    │    │    ├── stats: [rows=99519.7381, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=95404.9072, null(10)=0, distinct(12)=529.630441, null(12)=0, distinct(15)=94053.7816, null(15)=0, distinct(16)=11, null(16)=0, distinct(20)=731, null(20)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    │    ├── fd: (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4), (1)==(12), (12)==(1)
      │    │    │    │    ├── inner-join (lookup lineitem@l_sk)
      │    │    │    │    │    ├── save-table-name: q7_lookup_join_8
      │    │    │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) l_orderkey:10(int!null) l_suppkey:12(int!null) l_linenumber:13(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    ├── key columns: [1] = [12]
      │    │    │    │    │    ├── stats: [rows=322703.925, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(10)=290903.837, null(10)=0, distinct(12)=529.630441, null(12)=0, distinct(13)=7, null(13)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    │    │    ├── key: (10,13,55)
      │    │    │    │    │    ├── fd: (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4), (10,13)-->(12), (1)==(12), (12)==(1)
      │    │    │    │    │    ├── inner-join (lookup supplier@s_nk)
      │    │    │    │    │    │    ├── save-table-name: q7_lookup_join_9
      │    │    │    │    │    │    ├── columns: s_suppkey:1(int!null) s_nationkey:4(int!null) n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    │    ├── key columns: [49] = [4]
      │    │    │    │    │    │    ├── stats: [rows=533.333333, distinct(1)=529.630441, null(1)=0, distinct(4)=1.29975178, null(4)=0, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0]
      │    │    │    │    │    │    ├── key: (1,55)
      │    │    │    │    │    │    ├── fd: (1)-->(4), (49)-->(50), (55)-->(56), (4)==(49), (49)==(4)
      │    │    │    │    │    │    ├── inner-join (cross)
      │    │    │    │    │    │    │    ├── save-table-name: q7_inner_join_10
      │    │    │    │    │    │    │    ├── columns: n1.n_nationkey:49(int!null) n1.n_name:50(char!null) n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    │    │    ├── stats: [rows=1.33333333, distinct(49)=1.29975178, null(49)=0, distinct(50)=1.33333333, null(50)=0, distinct(55)=1.29975178, null(55)=0, distinct(56)=1.33333333, null(56)=0, distinct(50,56)=1.33333333, null(50,56)=0]
      │    │    │    │    │    │    │    ├── key: (49,55)
      │    │    │    │    │    │    │    ├── fd: (49)-->(50), (55)-->(56)
      │    │    │    │    │    │    │    ├── scan nation [as=n1]
      │    │    │    │    │    │    │    │    ├── save-table-name: q7_scan_11
      │    │    │    │    │    │    │    │    ├── columns: n1.n_nationkey:49(int!null) n1.n_name:50(char!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(49)=25, null(49)=0, distinct(50)=25, null(50)=0]
      │    │    │    │    │    │    │    │    │   histogram(49)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │    │   histogram(50)=  0      1      23      1
      │    │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    │    │    │    ├── key: (49)
      │    │    │    │    │    │    │    │    └── fd: (49)-->(50)
      │    │    │    │    │    │    │    ├── scan nation [as=n2]
      │    │    │    │    │    │    │    │    ├── save-table-name: q7_scan_12
      │    │    │    │    │    │    │    │    ├── columns: n2.n_nationkey:55(int!null) n2.n_name:56(char!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(55)=25, null(55)=0, distinct(56)=25, null(56)=0]
      │    │    │    │    │    │    │    │    │   histogram(55)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │    │   histogram(56)=  0      1      23      1
      │    │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    │    │    │    ├── key: (55)
      │    │    │    │    │    │    │    │    └── fd: (55)-->(56)
      │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │         └── ((n1.n_name:50 = 'FRANCE') AND (n2.n_name:56 = 'GERMANY')) OR ((n1.n_name:50 = 'GERMANY') AND (n2.n_name:56 = 'FRANCE')) [type=bool, outer=(50,56), constraints=(/50: [/'FRANCE' - /'FRANCE'] [/'GERMANY' - /'GERMANY']; /56: [/'FRANCE' - /'FRANCE'] [/'GERMANY' - /'GERMANY'])]
      │    │    │    │    │    │    └── filters (true)
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters
      │    │    │    │         └── (l_shipdate:20 >= '1995-01-01') AND (l_shipdate:20 <= '1996-12-31') [type=bool, outer=(20), constraints=(/20: [/'1995-01-01' - /'1996-12-31']; tight)]
      │    │    │    └── filters (true)
      │    │    └── filters
      │    │         ├── c_nationkey:42 = n2.n_nationkey:55 [type=bool, outer=(42,55), constraints=(/42: (/NULL - ]; /55: (/NULL - ]), fd=(42)==(55), (55)==(42)]
      │    │         └── c_custkey:39 = o_custkey:29 [type=bool, outer=(29,39), constraints=(/29: (/NULL - ]; /39: (/NULL - ]), fd=(29)==(39), (39)==(29)]
      │    └── projections
      │         ├── extract('year', l_shipdate:20) [as=l_year:61, type=float, outer=(20), immutable]
      │         └── l_extendedprice:15 * (1.0 - l_discount:16) [as=volume:62, type=float, outer=(15,16), immutable]
      └── aggregations
           └── sum [as=sum:63, type=float, outer=(62)]
                └── volume:62 [type=float]

----Stats for q7_sort_1----
column_names   row_count  distinct_count  null_count
{cust_nation}  4          2               0
{l_year}       4          2               0
{revenue}      4          4               0
{supp_nation}  4          2               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{cust_nation}  974.00         243.50 <==     1.00                2.00 <==            0.00            1.00
{l_year}       974.00         243.50 <==     731.00              365.50 <==          0.00            1.00
{revenue}      974.00         243.50 <==     974.00              243.50 <==          0.00            1.00
{supp_nation}  974.00         243.50 <==     1.00                2.00 <==            0.00            1.00

----Stats for q7_group_by_2----
column_names  row_count  distinct_count  null_count
{l_year}      4          2               0
{n_name_1}    4          2               0
{n_name}      4          2               0
{sum}         4          4               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_year}      974.00         243.50 <==     731.00              365.50 <==          0.00            1.00
{n_name}      974.00         243.50 <==     1.00                2.00 <==            0.00            1.00
{n_name_1}    974.00         243.50 <==     1.00                2.00 <==            0.00            1.00
{sum}         974.00         243.50 <==     974.00              243.50 <==          0.00            1.00

----Stats for q7_project_3----
column_names  row_count  distinct_count  null_count
{l_year}      5924       2               0
{n_name_1}    5924       2               0
{n_name}      5924       2               0
{volume}      5924       5904            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_year}      7675.00        1.30           731.00              365.50 <==          0.00            1.00
{n_name}      7675.00        1.30           1.00                2.00 <==            0.00            1.00
{n_name_1}    7675.00        1.30           1.00                2.00 <==            0.00            1.00
{volume}      7675.00        1.30           7514.00             1.27                0.00            1.00

----Stats for q7_inner_join_4----
column_names       row_count  distinct_count  null_count
{c_custkey}        5924       3902            0
{c_nationkey}      5924       2               0
{l_discount}       5924       11              0
{l_extendedprice}  5924       5876            0
{l_orderkey}       5924       5445            0
{l_shipdate}       5924       731             0
{l_suppkey}        5924       796             0
{n_name_1}         5924       2               0
{n_name}           5924       2               0
{n_nationkey_1}    5924       2               0
{n_nationkey}      5924       2               0
{o_custkey}        5924       3902            0
{o_orderkey}       5924       5445            0
{s_nationkey}      5924       2               0
{s_suppkey}        5924       796             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        7675.00        1.30           4921.00             1.26                0.00            1.00
{c_nationkey}      7675.00        1.30           1.00                2.00 <==            0.00            1.00
{l_discount}       7675.00        1.30           11.00               1.00                0.00            1.00
{l_extendedprice}  7675.00        1.30           7505.00             1.28                0.00            1.00
{l_orderkey}       7675.00        1.30           7426.00             1.36                0.00            1.00
{l_shipdate}       7675.00        1.30           731.00              1.00                0.00            1.00
{l_suppkey}        7675.00        1.30           7675.00             9.64 <==            0.00            1.00
{n_name}           7675.00        1.30           1.00                2.00 <==            0.00            1.00
{n_name_1}         7675.00        1.30           1.00                2.00 <==            0.00            1.00
{n_nationkey}      7675.00        1.30           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}    7675.00        1.30           1.00                2.00 <==            0.00            1.00
{o_custkey}        7675.00        1.30           4921.00             1.26                0.00            1.00
{o_orderkey}       7675.00        1.30           7426.00             1.36                0.00            1.00
{s_nationkey}      7675.00        1.30           1.00                2.00 <==            0.00            1.00
{s_suppkey}        7675.00        1.30           7675.00             9.64 <==            0.00            1.00

----Stats for q7_scan_5----
column_names   row_count  distinct_count  null_count
{c_custkey}    150000     148813          0
{c_nationkey}  150000     25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}    150000.00      1.00           148813.00           1.00                0.00            1.00
{c_nationkey}  150000.00      1.00           25.00               1.00                0.00            1.00

----Stats for q7_lookup_join_6----
column_names       row_count  distinct_count  null_count
{l_discount}       145703     11              0
{l_extendedprice}  145703     130516          0
{l_orderkey}       145703     126329          0
{l_shipdate}       145703     731             0
{l_suppkey}        145703     798             0
{n_name_1}         145703     2               0
{n_name}           145703     2               0
{n_nationkey_1}    145703     2               0
{n_nationkey}      145703     2               0
{o_custkey}        145703     68151           0
{o_orderkey}       145703     126329          0
{s_nationkey}      145703     2               0
{s_suppkey}        145703     798             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       99520.00       1.46           11.00               1.00                0.00            1.00
{l_extendedprice}  99520.00       1.46           61407.00            2.13 <==            0.00            1.00
{l_orderkey}       99520.00       1.46           95405.00            1.32                0.00            1.00
{l_shipdate}       99520.00       1.46           731.00              1.00                0.00            1.00
{l_suppkey}        99520.00       1.46           530.00              1.51                0.00            1.00
{n_name}           99520.00       1.46           1.00                2.00 <==            0.00            1.00
{n_name_1}         99520.00       1.46           1.00                2.00 <==            0.00            1.00
{n_nationkey}      99520.00       1.46           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}    99520.00       1.46           1.00                2.00 <==            0.00            1.00
{o_custkey}        99520.00       1.46           62996.00            1.08                0.00            1.00
{o_orderkey}       99520.00       1.46           95405.00            1.32                0.00            1.00
{s_nationkey}      99520.00       1.46           1.00                2.00 <==            0.00            1.00
{s_suppkey}        99520.00       1.46           530.00              1.51                0.00            1.00

----Stats for q7_lookup_join_7----
column_names       row_count  distinct_count  null_count
{l_discount}       145703     11              0
{l_extendedprice}  145703     130516          0
{l_orderkey}       145703     126329          0
{l_shipdate}       145703     731             0
{l_suppkey}        145703     798             0
{n_name_1}         145703     2               0
{n_name}           145703     2               0
{n_nationkey_1}    145703     2               0
{n_nationkey}      145703     2               0
{s_nationkey}      145703     2               0
{s_suppkey}        145703     798             0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       99520.00       1.46           11.00               1.00                0.00            1.00
{l_extendedprice}  99520.00       1.46           94054.00            1.39                0.00            1.00
{l_orderkey}       99520.00       1.46           95405.00            1.32                0.00            1.00
{l_shipdate}       99520.00       1.46           731.00              1.00                0.00            1.00
{l_suppkey}        99520.00       1.46           530.00              1.51                0.00            1.00
{n_name}           99520.00       1.46           1.00                2.00 <==            0.00            1.00
{n_name_1}         99520.00       1.46           1.00                2.00 <==            0.00            1.00
{n_nationkey}      99520.00       1.46           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}    99520.00       1.46           1.00                2.00 <==            0.00            1.00
{s_nationkey}      99520.00       1.46           1.00                2.00 <==            0.00            1.00
{s_suppkey}        99520.00       1.46           530.00              1.51                0.00            1.00

----Stats for q7_lookup_join_8----
column_names     row_count  distinct_count  null_count
{l_linenumber}   478523     7               0
{l_orderkey}     478523     411655          0
{l_suppkey}      478523     798             0
{n_name_1}       478523     2               0
{n_name}         478523     2               0
{n_nationkey_1}  478523     2               0
{n_nationkey}    478523     2               0
{s_nationkey}    478523     2               0
{s_suppkey}      478523     798             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}   322704.00      1.48           7.00                1.00                0.00            1.00
{l_orderkey}     322704.00      1.48           290904.00           1.42                0.00            1.00
{l_suppkey}      322704.00      1.48           530.00              1.51                0.00            1.00
{n_name}         322704.00      1.48           1.00                2.00 <==            0.00            1.00
{n_name_1}       322704.00      1.48           1.00                2.00 <==            0.00            1.00
{n_nationkey}    322704.00      1.48           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}  322704.00      1.48           1.00                2.00 <==            0.00            1.00
{s_nationkey}    322704.00      1.48           1.00                2.00 <==            0.00            1.00
{s_suppkey}      322704.00      1.48           530.00              1.51                0.00            1.00

----Stats for q7_lookup_join_9----
column_names     row_count  distinct_count  null_count
{n_name_1}       798        2               0
{n_name}         798        2               0
{n_nationkey_1}  798        2               0
{n_nationkey}    798        2               0
{s_nationkey}    798        2               0
{s_suppkey}      798        798             0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         533.00         1.50           1.00                2.00 <==            0.00            1.00
{n_name_1}       533.00         1.50           1.00                2.00 <==            0.00            1.00
{n_nationkey}    533.00         1.50           1.00                2.00 <==            0.00            1.00
{n_nationkey_1}  533.00         1.50           1.00                2.00 <==            0.00            1.00
{s_nationkey}    533.00         1.50           1.00                2.00 <==            0.00            1.00
{s_suppkey}      533.00         1.50           530.00              1.51                0.00            1.00

----Stats for q7_inner_join_10----
column_names     row_count  distinct_count  null_count
{n_name_1}       2          2               0
{n_name}         2          2               0
{n_nationkey_1}  2          2               0
{n_nationkey}    2          2               0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}         1.00           2.00 <==       1.00                2.00 <==            0.00            1.00
{n_name_1}       1.00           2.00 <==       1.00                2.00 <==            0.00            1.00
{n_nationkey}    1.00           2.00 <==       1.00                2.00 <==            0.00            1.00
{n_nationkey_1}  1.00           2.00 <==       1.00                2.00 <==            0.00            1.00

----Stats for q7_scan_11----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00

----Stats for q7_scan_12----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
----
----
