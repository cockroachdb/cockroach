import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q4
# Order Priority Checking
# Determines how well the order priority system is working and gives an
# assessment of customer satisfaction.
#
# Counts the number of orders ordered in a given quarter of a given year in
# which at least one lineitem was received by the customer later than its
# committed date. The query lists the count of such orders for each order
# priority sorted in ascending priority order.
# --------------------------------------------------
save-tables database=tpch save-tables-prefix=q4
SELECT
    o_orderpriority,
    count(*) AS order_count
FROM
    orders
WHERE
    o_orderdate >= DATE '1993-07-01'
    AND o_orderdate < DATE '1993-07-01' + INTERVAL '3' MONTH
    AND EXISTS (
        SELECT
            *
        FROM
            lineitem
        WHERE
            l_orderkey = o_orderkey
            AND l_commitDATE < l_receiptdate
    )
GROUP BY
    o_orderpriority
ORDER BY
    o_orderpriority;
----
sort
 ├── save-table-name: q4_sort_1
 ├── columns: o_orderpriority:6(char!null) order_count:26(int!null)
 ├── stats: [rows=5, distinct(6)=5, null(6)=0, distinct(26)=5, null(26)=0]
 ├── key: (6)
 ├── fd: (6)-->(26)
 ├── ordering: +6
 └── group-by
      ├── save-table-name: q4_group_by_2
      ├── columns: o_orderpriority:6(char!null) count_rows:26(int!null)
      ├── grouping columns: o_orderpriority:6(char!null)
      ├── stats: [rows=5, distinct(6)=5, null(6)=0, distinct(26)=5, null(26)=0]
      ├── key: (6)
      ├── fd: (6)-->(26)
      ├── semi-join (hash)
      │    ├── save-table-name: q4_semi_join_3
      │    ├── columns: o_orderkey:1(int!null) o_orderdate:5(date!null) o_orderpriority:6(char!null)
      │    ├── stats: [rows=61200, distinct(1)=61200, null(1)=0, distinct(5)=92, null(5)=0, distinct(6)=5, null(6)=0]
      │    ├── key: (1)
      │    ├── fd: (1)-->(5,6)
      │    ├── index-join orders
      │    │    ├── save-table-name: q4_index_join_4
      │    │    ├── columns: o_orderkey:1(int!null) o_orderdate:5(date!null) o_orderpriority:6(char!null)
      │    │    ├── stats: [rows=61200, distinct(1)=61200, null(1)=0, distinct(5)=92, null(5)=0, distinct(6)=5, null(6)=0]
      │    │    │   histogram(5)=  0      450       6750      600       6600      900       7050      1200      6600      1200      7050      750       6600      900       6750      600       6545.5     654.55
      │    │    │                <--- '1993-07-01' ------ '1993-07-12' ------ '1993-07-24' ------ '1993-08-05' ------ '1993-08-16' ------ '1993-08-29' ------ '1993-09-08' ------ '1993-09-19' -------- '1993-09-30'
      │    │    ├── key: (1)
      │    │    ├── fd: (1)-->(5,6)
      │    │    └── scan orders@o_od
      │    │         ├── save-table-name: q4_scan_5
      │    │         ├── columns: o_orderkey:1(int!null) o_orderdate:5(date!null)
      │    │         ├── constraint: /5/1: [/'1993-07-01' - /'1993-09-30']
      │    │         ├── stats: [rows=61200, distinct(1)=61200, null(1)=0, distinct(5)=92, null(5)=0]
      │    │         │   histogram(1)=  0 6.12  299.88  6.12   299.88  6.12   299.88  6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12   299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    299.88   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12    306   6.12
      │    │         │                <--- 998 -------- 26593 -------- 56613 -------- 85827 -------- 115587 -------- 140512 -------- 167076 -------- 198882 -------- 228580 -------- 262243 -------- 292064 -------- 316161 -------- 344194 -------- 368550 -------- 402722 -------- 434529 -------- 468807 -------- 495107 -------- 526338 -------- 563239 -------- 597733 -------- 641894 -------- 665730 -------- 688742 -------- 721767 -------- 750050 -------- 787879 -------- 814565 -------- 837381 -------- 866657 -------- 902855 -------- 927172 -------- 952772 -------- 975840 -------- 1008646 -------- 1032066 -------- 1074656 -------- 1104896 -------- 1138369 -------- 1166689 -------- 1194912 -------- 1225222 -------- 1253284 -------- 1284803 -------- 1318499 -------- 1348609 -------- 1376609 -------- 1404933 -------- 1435745 -------- 1460325 -------- 1491648 -------- 1518852 -------- 1542567 -------- 1574277 -------- 1597958 -------- 1624964 -------- 1647555 -------- 1683651 -------- 1717189 -------- 1750563 -------- 1784775 -------- 1812449 -------- 1838850 -------- 1867751 -------- 1891783 -------- 1918790 -------- 1949827 -------- 1986021 -------- 2020134 -------- 2045829 -------- 2077894 -------- 2118912 -------- 2143264 -------- 2176486 -------- 2204838 -------- 2234146 -------- 2260484 -------- 2288512 -------- 2317121 -------- 2344321 -------- 2362567 -------- 2396133 -------- 2423623 -------- 2454884 -------- 2483879 -------- 2520162 -------- 2545574 -------- 2571874 -------- 2608417 -------- 2637477 -------- 2665607 -------- 2692231 -------- 2724261 -------- 2764451 -------- 2798656 -------- 2824775 -------- 2858690 -------- 2881990 -------- 2911814 -------- 2945056 -------- 2981315 -------- 3010306 -------- 3032320 -------- 3064389 -------- 3084166 -------- 3108832 -------- 3136032 -------- 3168484 -------- 3204039 -------- 3229922 -------- 3256549 -------- 3283169 -------- 3315236 -------- 3346756 -------- 3375879 -------- 3408007 -------- 3441827 -------- 3471204 -------- 3505414 -------- 3527938 -------- 3562561 -------- 3598630 -------- 3627270 -------- 3659266 -------- 3686468 -------- 3713505 -------- 3750817 -------- 3777696 -------- 3808129 -------- 3834533 -------- 3871968 -------- 3904931 -------- 3934215 -------- 3960643 -------- 3990336 -------- 4023203 -------- 4057826 -------- 4090691 -------- 4121216 -------- 4159681 -------- 4190726 -------- 4222624 -------- 4246567 -------- 4283653 -------- 4314339 -------- 4342592 -------- 4373829 -------- 4402372 -------- 4431332 -------- 4464452 -------- 4496327 ----- 4526789 ----- 4551109 ----- 4582401 ----- 4615974 ----- 4648482 ----- 4669601 ----- 4705891 ----- 4732869 ----- 4766145 ----- 4805862 ----- 4840677 ----- 4866787 ----- 4895332 ----- 4928100 ----- 4956323 ----- 4992161 ----- 5027008 ----- 5065797 ----- 5099011 ----- 5130592 ----- 5163463 ----- 5197314 ----- 5224994 ----- 5253892 ----- 5277638 ----- 5307105 ----- 5335750 ----- 5369828 ----- 5402528 ----- 5434183 ----- 5464227 ----- 5491072 ----- 5520679 ----- 5543047 ----- 5576708 ----- 5614951 ----- 5646055 ----- 5674721 ----- 5700295 ----- 5732066 ----- 5761255 ----- 5791233 ----- 5819651 ----- 5852291 ----- 5880258 ----- 5909062 ----- 5943111 ----- 5973926 ----- 5998752
      │    │         │   histogram(5)=  0      450       6750      600       6600      900       7050      1200      6600      1200      7050      750       6600      900       6750      600       6545.5     654.55
      │    │         │                <--- '1993-07-01' ------ '1993-07-12' ------ '1993-07-24' ------ '1993-08-05' ------ '1993-08-16' ------ '1993-08-29' ------ '1993-09-08' ------ '1993-09-19' -------- '1993-09-30'
      │    │         ├── key: (1)
      │    │         └── fd: (1)-->(5)
      │    ├── select
      │    │    ├── save-table-name: q4_select_6
      │    │    ├── columns: l_orderkey:10(int!null) l_commitdate:21(date!null) l_receiptdate:22(date!null)
      │    │    ├── stats: [rows=2000405, distinct(10)=1216823.04, null(10)=0, distinct(21)=2466, null(21)=0, distinct(22)=2554, null(22)=0]
      │    │    ├── scan lineitem
      │    │    │    ├── save-table-name: q4_scan_7
      │    │    │    ├── columns: l_orderkey:10(int!null) l_commitdate:21(date!null) l_receiptdate:22(date!null)
      │    │    │    └── stats: [rows=6001215, distinct(10)=1527270, null(10)=0, distinct(21)=2466, null(21)=0, distinct(22)=2554, null(22)=0]
      │    │    │        histogram(10)=  0  600  29405   600   29405   600   29405   600   29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405   600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    29405    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600    30006    600
      │    │    │                      <--- 326 ------- 28929 ------- 50503 ------- 89793 ------- 115938 ------- 146944 ------- 176768 ------- 211201 ------- 237860 ------- 266885 ------- 297604 ------- 330021 ------- 365889 ------- 398951 ------- 426117 ------- 451328 ------- 472134 ------- 499590 ------- 529284 ------- 557254 ------- 589154 ------- 619394 ------- 642951 ------- 670113 ------- 692931 ------- 721157 ------- 751687 ------- 777766 ------- 804582 ------- 836740 ------- 868868 ------- 898912 ------- 922500 ------- 946403 ------- 984870 ------- 1007936 ------- 1030117 ------- 1062275 ------- 1093572 ------- 1120709 ------- 1150981 ------- 1182786 ------- 1206406 ------- 1234116 ------- 1260961 ------- 1290502 ------- 1329510 ------- 1355426 ------- 1381313 ------- 1409796 ------- 1445254 ------- 1479233 ------- 1504935 ------- 1531079 ------- 1559650 ------- 1583616 ------- 1617504 ------- 1655749 ------- 1685185 ------- 1718183 ------- 1747716 ------- 1772131 ------- 1802372 ------- 1833315 ------- 1862403 ------- 1897894 ------- 1922819 ------- 1954405 ------- 1979329 ------- 2009859 ------- 2041670 ------- 2070851 ------- 2093828 ------- 2127973 ------- 2167777 ------- 2194883 ------- 2227814 ------- 2262437 ------- 2296353 ------- 2321024 ------- 2346051 ------- 2376257 ------- 2404932 ------- 2446273 ------- 2474081 ------- 2504515 ------- 2535302 ------- 2561413 ------- 2592737 ------- 2616801 ------- 2646112 ------- 2676546 ------- 2702116 ------- 2732454 ------- 2765382 ------- 2799495 ------- 2828866 ------- 2868737 ------- 2910625 ------- 2938464 ------- 2963140 ------- 3003302 ------- 3043264 ------- 3069123 ------- 3095909 ------- 3126693 ------- 3160485 ------- 3196039 ------- 3229504 ------- 3259712 ------- 3286439 ------- 3318852 ------- 3346821 ------- 3370119 ------- 3395204 ------- 3425888 ------- 3448611 ------- 3476130 ------- 3502372 ------- 3529474 ------- 3556390 ------- 3583553 ------- 3612550 ------- 3647875 ------- 3679140 ------- 3702661 ------- 3738017 ------- 3778050 ------- 3806114 ------- 3839074 ------- 3872805 ------- 3905697 ------- 3926212 ------- 3959841 ------- 3997281 ------- 4033861 ------- 4063591 ------- 4097831 ------- 4124807 ------- 4158656 ------- 4195748 ------- 4234274 ------- 4269952 ------- 4298949 ------- 4332806 ------- 4364705 ------- 4398246 ------- 4430695 ------- 4466403 ------- 4494662 ------- 4524420 ------- 4558561 ------- 4601092 ------- 4632871 ------- 4658694 ------- 4690501 ------- 4728066 ------- 4758657 ------- 4788294 ------- 4818597 ------- 4855874 ------- 4890913 ------- 4915366 ------- 4940709 ------- 4972357 ------- 4995298 ------- 5019523 ------- 5043329 ------- 5077376 ------- 5109920 ------- 5136582 ------- 5161152 ------- 5191846 ------- 5219973 ------- 5251015 ------- 5282021 ------- 5312355 ------- 5343207 ------- 5381318 ------- 5416163 ------- 5445382 ------- 5476933 ------- 5509185 ------- 5539237 ------- 5566818 ------- 5588739 ------- 5620481 ------- 5644001 ------- 5667010 ------- 5689476 ------- 5724709 ------- 5755398 ------- 5790598 ------- 5819425 ------- 5846341 ------- 5874656 ------- 5908067 ------- 5933572 ------- 5962659 ------- 5999971
      │    │    │        histogram(21)=  0      600       28805      1200      29405      3600      29405      1200      29405      1800      28205      1800      28805      4200      28205      3600      27005      4800      29405      3600      29405      1800      26405      3600      29405      600       27005      3000      29405      2400      28805      3000      29405      600       25805      4800      28805      3000      27605      2400      27605      5401      28805      3600      28805      2400      27605      3600      28805      6001      28805      3600      27005      3000      25205      4800      28805      4200      28205      1200      28805      3600      28205      4200      27605      3000      28205      3600      28805      1200      27605      3000      28205      1200      27005      3000      28805      1200      28205      1800      28205      1800      27605      1800      27605      3600      27605      3600      25805      5401      28805      4200      28205      1200      28805      3000      28805      4800      28805      1200      28805      4200      28205      2400      26405      3000      28205      3000      28805      2400      28805      2400      27605      5401      28805      1800      28805      2400      28805      1200      28805      3600      27605      5401      25805      5401      28205      3600      27005      3600      28205      3000      28805      1200      28805      4800      28205      2400      24604      5401      28805      3000      27605      2400      28205      4200      27005      3000      28805      3000      28805      600       26405      5401      27605      4800      27005      2400      26405      4200      28805      2400      27605      3000      28205      3000      27005      2400      26405      3600      28205      1200      27605      4200      27605      3000      28205      1800      25805      3000      28205      2400      28205      1200      27005      2400      27605      1800      25805      3600      27005      6601      27005      1800      24004      6001      27605      1800      28205      3000      27605      2400      27605      2400      27605      3000      27605      2400      28205      3000      26405      2400      26405      2400      26405      2400      26405      3600      28205      1800      28205      2400      27605      1200      27605      3000      27605      4800      24604      4200      28205      3000      24604      6001      25805      4200      25205      4200      26405      3000      28205      3000      27605      3000      28205      600       27605      3600      25805      4200      27005      3600      28205      600       28205      3000      28205      1200      25805      3000      28205      1200      27005      3000      28205      1200      24604      4200      27605      1800      28205      4200      27605      2400      26405      4200      27005      2400      27005      1800      27605      3600      25205      4800      27605      2400      28205      1800      27005      3000      27605      3000      25205      4200      25805      3000      27605      3600      25805      3600      27605      1800      24604      4200      25805      3600      26405      1800      27005      3000      27005      1200      27005      3000      24004      5401      26405      1800      25805      2400      27605      1200      27605      600       27005      2400      27605      1200      23404      7201      25205      3600      26405      3000      27605      3600      27605      2400      24604      3600      27605      4200      27605      3600      27005      1200      26405      1200      25805      1800      25205      3600      22804      4800      24604      3000      24004      3600      26405      2400      24604      4800      26405      3000      22204      5401      25805      2400      25205      2400      27005      2400      24604      4200      25205      3000      24004      4800      25205      3000      26405      1200      27005      2400      26405      2400      26405      4800      25205      3000      25805      1800      24004      4800      24604      3000      23404      600       24004      600
      │    │    │                      <--- '1992-02-06' ------- '1992-03-13' ------- '1992-03-29' ------- '1992-04-12' ------- '1992-04-24' ------- '1992-05-07' ------- '1992-05-18' ------- '1992-05-30' ------- '1992-06-15' ------- '1992-06-28' ------- '1992-07-10' ------- '1992-07-20' ------- '1992-08-04' ------- '1992-08-17' ------- '1992-08-30' ------- '1992-09-11' ------- '1992-09-25' ------- '1992-10-05' ------- '1992-10-16' ------- '1992-10-29' ------- '1992-11-10' ------- '1992-11-24' ------- '1992-12-05' ------- '1992-12-16' ------- '1992-12-31' ------- '1993-01-15' ------- '1993-01-28' ------- '1993-02-09' ------- '1993-02-21' ------- '1993-03-07' ------- '1993-03-17' ------- '1993-04-03' ------- '1993-04-17' ------- '1993-04-30' ------- '1993-05-12' ------- '1993-05-25' ------- '1993-06-08' ------- '1993-06-23' ------- '1993-07-04' ------- '1993-07-18' ------- '1993-08-02' ------- '1993-08-13' ------- '1993-08-24' ------- '1993-09-08' ------- '1993-09-20' ------- '1993-10-06' ------- '1993-10-22' ------- '1993-11-01' ------- '1993-11-14' ------- '1993-11-24' ------- '1993-12-07' ------- '1993-12-20' ------- '1994-01-01' ------- '1994-01-14' ------- '1994-01-31' ------- '1994-02-14' ------- '1994-02-26' ------- '1994-03-09' ------- '1994-03-22' ------- '1994-04-03' ------- '1994-04-14' ------- '1994-04-23' ------- '1994-05-07' ------- '1994-05-19' ------- '1994-05-31' ------- '1994-06-12' ------- '1994-06-22' ------- '1994-07-03' ------- '1994-07-14' ------- '1994-07-24' ------- '1994-08-04' ------- '1994-08-16' ------- '1994-08-29' ------- '1994-09-08' ------- '1994-09-23' ------- '1994-10-05' ------- '1994-10-16' ------- '1994-10-28' ------- '1994-11-08' ------- '1994-11-19' ------- '1994-12-05' ------- '1994-12-18' ------- '1994-12-29' ------- '1995-01-11' ------- '1995-01-23' ------- '1995-02-05' ------- '1995-02-15' ------- '1995-03-02' ------- '1995-03-14' ------- '1995-03-25' ------- '1995-04-05' ------- '1995-04-17' ------- '1995-04-30' ------- '1995-05-11' ------- '1995-05-23' ------- '1995-06-06' ------- '1995-06-20' ------- '1995-06-30' ------- '1995-07-12' ------- '1995-07-26' ------- '1995-08-07' ------- '1995-08-17' ------- '1995-08-28' ------- '1995-09-09' ------- '1995-09-21' ------- '1995-10-04' ------- '1995-10-14' ------- '1995-10-28' ------- '1995-11-07' ------- '1995-11-18' ------- '1995-11-29' ------- '1995-12-11' ------- '1995-12-21' ------- '1995-12-31' ------- '1996-01-11' ------- '1996-01-21' ------- '1996-01-31' ------- '1996-02-10' ------- '1996-02-24' ------- '1996-03-04' ------- '1996-03-13' ------- '1996-03-25' ------- '1996-04-07' ------- '1996-04-17' ------- '1996-04-28' ------- '1996-05-10' ------- '1996-05-22' ------- '1996-06-02' ------- '1996-06-15' ------- '1996-06-26' ------- '1996-07-09' ------- '1996-07-20' ------- '1996-07-31' ------- '1996-08-11' ------- '1996-08-25' ------- '1996-09-07' ------- '1996-09-21' ------- '1996-10-04' ------- '1996-10-15' ------- '1996-10-27' ------- '1996-11-07' ------- '1996-11-19' ------- '1996-11-30' ------- '1996-12-13' ------- '1996-12-27' ------- '1997-01-06' ------- '1997-01-18' ------- '1997-01-30' ------- '1997-02-12' ------- '1997-02-23' ------- '1997-03-07' ------- '1997-03-19' ------- '1997-03-31' ------- '1997-04-10' ------- '1997-04-23' ------- '1997-05-04' ------- '1997-05-17' ------- '1997-05-29' ------- '1997-06-12' ------- '1997-06-23' ------- '1997-07-04' ------- '1997-07-16' ------- '1997-07-28' ------- '1997-08-07' ------- '1997-08-19' ------- '1997-08-29' ------- '1997-09-10' ------- '1997-09-20' ------- '1997-10-03' ------- '1997-10-13' ------- '1997-10-25' ------- '1997-11-05' ------- '1997-11-17' ------- '1997-12-02' ------- '1997-12-15' ------- '1997-12-26' ------- '1998-01-07' ------- '1998-01-16' ------- '1998-01-25' ------- '1998-02-07' ------- '1998-02-20' ------- '1998-03-06' ------- '1998-03-14' ------- '1998-03-30' ------- '1998-04-08' ------- '1998-04-21' ------- '1998-05-03' ------- '1998-05-15' ------- '1998-05-27' ------- '1998-06-07' ------- '1998-06-19' ------- '1998-07-03' ------- '1998-07-15' ------- '1998-07-26' ------- '1998-08-07' ------- '1998-08-18' ------- '1998-08-30' ------- '1998-09-12' ------- '1998-10-01' ------- '1998-10-30'
      │    │    │        histogram(22)=  0      1200      29405      1200      29405      1200      29405      1200      27605      2400      24004      6001      27605      5401      28205      4200      29405      2400      29405      1200      28205      4200      27005      3000      27005      3000      29405      4800      27605      3000      28205      1800      27605      2400      26405      3600      27605      4800      27605      3600      28805      3000      28205      6001      28205      1800      26405      3600      27005      4200      29405      4200      27605      2400      27605      1800      27005      3600      24604      4800      27605      3000      27605      1800      28205      2400      28205      3000      28805      1800      28805      600       28205      1200      27005      2400      27605      1800      26405      3000      26405      4800      28205      2400      28805      1200      28805      3600      28205      3000      28205      1200      28205      1200      25805      4200      28205      4800      26405      6001      28205      1800      27005      3000      28205      1800      27605      3000      28205      1200      28205      2400      27605      3000      28805      1800      26405      4200      28805      1800      24604      4800      28805      1200      27005      3000      26405      7201      25805      4800      28805      4200      28805      3600      25205      4200      27005      4800      27605      3600      28205      4200      28805      1800      27005      2400      28805      1800      27005      3000      28205      2400      28205      2400      27005      2400      25805      3600      26405      3600      28805      3600      25805      4200      28805      4200      28205      2400      26405      3600      27005      2400      27605      3600      28805      600       27005      4800      28205      1800      26405      4800      26405      3600      26405      3000      27005      3000      27605      2400      28205      4200      28805      1800      28205      2400      26405      4200      28805      4200      28205      1800      25205      4200      28805      4800      27605      4200      27605      3000      28805      1200      28805      3000      28205      2400      26405      4200      28805      4200      27605      1200      27605      2400      24604      4800      27605      3000      28205      3000      24604      5401      27605      4200      26405      3600      25805      4200      25805      4200      22804      6001      27605      3000      28205      2400      27005      4800      27605      1200      25205      4200      27605      2400      28205      3600      26405      2400      27005      3600      27005      1800      27605      1800      27005      2400      23404      5401      27605      3600      27605      3600      27605      4200      26405      3000      27605      1200      28205      3000      25205      4800      27605      3600      28205      3600      26405      2400      22204      6601      27005      2400      28205      4800      25805      3000      25805      3600      28205      4200      27605      3000      25205      4800      26405      2400      27005      1200      27605      2400      26405      2400      27605      3000      25205      3000      27005      1200      26405      3000      25805      4800      27605      1800      26405      4200      26405      1800      27005      2400      24604      4200      25205      3600      25205      4200      25805      4200      25805      3600      25805      4200      27005      3000      22204      6001      27605      3000      25805      1800      27005      1200      25205      4200      27005      4200      27005      3000      27005      1800      25805      3000      25805      2400      25805      1800      25805      3600      25805      1800      25205      4200      24004      3600      23404      6601      26405      1800      25205      3600      26405      3600      22804      4200      24604      2400      22204      4200      24604      1800      24004      2400      26405      600       26405      600       25805      1200      26405      600
      │    │    │                      <--- '1992-01-19' ------- '1992-03-11' ------- '1992-04-04' ------- '1992-04-23' ------- '1992-05-09' ------- '1992-05-21' ------- '1992-06-06' ------- '1992-06-17' ------- '1992-07-02' ------- '1992-07-17' ------- '1992-07-28' ------- '1992-08-09' ------- '1992-08-21' ------- '1992-09-01' ------- '1992-09-13' ------- '1992-09-23' ------- '1992-10-08' ------- '1992-10-25' ------- '1992-11-06' ------- '1992-11-18' ------- '1992-12-01' ------- '1992-12-12' ------- '1992-12-24' ------- '1993-01-04' ------- '1993-01-15' ------- '1993-01-27' ------- '1993-02-09' ------- '1993-02-20' ------- '1993-03-05' ------- '1993-03-18' ------- '1993-04-01' ------- '1993-04-13' ------- '1993-04-29' ------- '1993-05-13' ------- '1993-05-27' ------- '1993-06-08' ------- '1993-06-20' ------- '1993-07-03' ------- '1993-07-15' ------- '1993-07-29' ------- '1993-08-11' ------- '1993-08-25' ------- '1993-09-08' ------- '1993-09-21' ------- '1993-10-02' ------- '1993-10-15' ------- '1993-10-29' ------- '1993-11-08' ------- '1993-11-20' ------- '1993-12-05' ------- '1993-12-17' ------- '1993-12-30' ------- '1994-01-13' ------- '1994-01-26' ------- '1994-02-08' ------- '1994-02-19' ------- '1994-03-04' ------- '1994-03-14' ------- '1994-03-26' ------- '1994-04-08' ------- '1994-04-21' ------- '1994-05-03' ------- '1994-05-14' ------- '1994-05-24' ------- '1994-06-03' ------- '1994-06-15' ------- '1994-06-27' ------- '1994-07-07' ------- '1994-07-16' ------- '1994-07-26' ------- '1994-08-10' ------- '1994-08-22' ------- '1994-09-03' ------- '1994-09-15' ------- '1994-09-27' ------- '1994-10-11' ------- '1994-10-22' ------- '1994-11-02' ------- '1994-11-14' ------- '1994-11-26' ------- '1994-12-10' ------- '1994-12-22' ------- '1995-01-04' ------- '1995-01-19' ------- '1995-01-30' ------- '1995-02-13' ------- '1995-02-23' ------- '1995-03-07' ------- '1995-03-17' ------- '1995-03-28' ------- '1995-04-11' ------- '1995-04-22' ------- '1995-05-03' ------- '1995-05-17' ------- '1995-05-29' ------- '1995-06-11' ------- '1995-06-26' ------- '1995-07-06' ------- '1995-07-18' ------- '1995-08-01' ------- '1995-08-14' ------- '1995-08-27' ------- '1995-09-09' ------- '1995-09-22' ------- '1995-10-03' ------- '1995-10-14' ------- '1995-10-26' ------- '1995-11-07' ------- '1995-11-19' ------- '1995-11-30' ------- '1995-12-12' ------- '1995-12-25' ------- '1996-01-03' ------- '1996-01-12' ------- '1996-01-24' ------- '1996-02-03' ------- '1996-02-13' ------- '1996-02-25' ------- '1996-03-06' ------- '1996-03-15' ------- '1996-03-25' ------- '1996-04-08' ------- '1996-04-21' ------- '1996-05-01' ------- '1996-05-13' ------- '1996-05-24' ------- '1996-06-03' ------- '1996-06-17' ------- '1996-06-29' ------- '1996-07-09' ------- '1996-07-22' ------- '1996-08-04' ------- '1996-08-17' ------- '1996-08-29' ------- '1996-09-09' ------- '1996-09-21' ------- '1996-10-02' ------- '1996-10-13' ------- '1996-10-27' ------- '1996-11-10' ------- '1996-11-23' ------- '1996-12-03' ------- '1996-12-17' ------- '1996-12-28' ------- '1997-01-08' ------- '1997-01-18' ------- '1997-01-30' ------- '1997-02-11' ------- '1997-02-23' ------- '1997-03-10' ------- '1997-03-20' ------- '1997-03-31' ------- '1997-04-10' ------- '1997-04-23' ------- '1997-05-06' ------- '1997-05-18' ------- '1997-05-30' ------- '1997-06-12' ------- '1997-06-24' ------- '1997-07-07' ------- '1997-07-20' ------- '1997-08-03' ------- '1997-08-16' ------- '1997-08-27' ------- '1997-09-08' ------- '1997-09-18' ------- '1997-10-01' ------- '1997-10-10' ------- '1997-10-20' ------- '1997-11-01' ------- '1997-11-13' ------- '1997-11-27' ------- '1997-12-06' ------- '1997-12-19' ------- '1997-12-29' ------- '1998-01-10' ------- '1998-01-20' ------- '1998-02-03' ------- '1998-02-17' ------- '1998-02-28' ------- '1998-03-11' ------- '1998-03-24' ------- '1998-04-05' ------- '1998-04-17' ------- '1998-05-01' ------- '1998-05-11' ------- '1998-05-22' ------- '1998-06-03' ------- '1998-06-13' ------- '1998-06-27' ------- '1998-07-12' ------- '1998-07-21' ------- '1998-07-31' ------- '1998-08-08' ------- '1998-08-22' ------- '1998-09-03' ------- '1998-09-16' ------- '1998-10-03' ------- '1998-10-26' ------- '1998-12-16'
      │    │    └── filters
      │    │         └── l_commitdate:21 < l_receiptdate:22 [type=bool, outer=(21,22), constraints=(/21: (/NULL - ]; /22: (/NULL - ])]
      │    └── filters
      │         └── l_orderkey:10 = o_orderkey:1 [type=bool, outer=(1,10), constraints=(/1: (/NULL - ]; /10: (/NULL - ]), fd=(1)==(10), (10)==(1)]
      └── aggregations
           └── count-rows [as=count_rows:26, type=int]

stats table=q4_sort_1
----
column_names       row_count  distinct_count  null_count
{o_orderpriority}  5          5               0
{order_count}      5          5               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_orderpriority}  5.00           1.00           5.00                1.00                0.00            1.00
{order_count}      5.00           1.00           5.00                1.00                0.00            1.00

stats table=q4_group_by_2
----
column_names       row_count  distinct_count  null_count
{count_rows}       5          5               0
{o_orderpriority}  5          5               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{count_rows}       5.00           1.00           5.00                1.00                0.00            1.00
{o_orderpriority}  5.00           1.00           5.00                1.00                0.00            1.00

stats table=q4_semi_join_3
----
column_names       row_count  distinct_count  null_count
{o_orderdate}      52523      92              0
{o_orderkey}       52523      52442           0
{o_orderpriority}  52523      5               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_orderdate}      61200.00       1.17           92.00               1.00                0.00            1.00
{o_orderkey}       61200.00       1.17           61200.00            1.17                0.00            1.00
{o_orderpriority}  61200.00       1.17           5.00                1.00                0.00            1.00

stats table=q4_index_join_4
----
column_names       row_count  distinct_count  null_count
{o_orderdate}      57218      92              0
{o_orderkey}       57218      57392           0
{o_orderpriority}  57218      5               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_orderdate}      61200.00       1.07           92.00               1.00                0.00            1.00
{o_orderkey}       61200.00       1.07           61200.00            1.07                0.00            1.00
{o_orderpriority}  61200.00       1.07           5.00                1.00                0.00            1.00

stats table=q4_select_6
----
column_names     row_count  distinct_count  null_count
{l_commitdate}   3793296    2466            0
{l_orderkey}     3793296    1405723         0
{l_receiptdate}  3793296    2525            0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_commitdate}   2000405.00     1.90           2466.00             1.00                0.00            1.00
{l_orderkey}     2000405.00     1.90           1216823.00          1.16                0.00            1.00
{l_receiptdate}  2000405.00     1.90           2554.00             1.01                0.00            1.00

stats table=q4_scan_7
----
column_names     row_count  distinct_count  null_count
{l_commitdate}   6001215    2466            0
{l_orderkey}     6001215    1527270         0
{l_receiptdate}  6001215    2554            0
~~~~
column_names     row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_commitdate}   6001215.00     1.00           2466.00             1.00                0.00            1.00
{l_orderkey}     6001215.00     1.00           1527270.00          1.00                0.00            1.00
{l_receiptdate}  6001215.00     1.00           2554.00             1.00                0.00            1.00
