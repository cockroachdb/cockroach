import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q5
# Local Supplier Volume
# Lists the revenue volume done through local suppliers.
#
# Lists for each nation in a region the revenue volume that resulted from
# lineitem transactions in which the customer ordering parts and the supplier
# filling them were both within that nation. The query is run in order to
# determine whether to institute local distribution centers in a given region.
# The query considers only parts ordered in a given year. The query displays the
# nations and revenue volume in descending order by revenue. Revenue volume for
# all qualifying lineitems in a particular nation is defined as
# sum(l_extendedprice * (1 - l_discount)).
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q5
SELECT
    n_name,
    sum(l_extendedprice * (1 - l_discount)) AS revenue
FROM
    customer,
    orders,
    lineitem,
    supplier,
    nation,
    region
WHERE
    c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND l_suppkey = s_suppkey
    AND c_nationkey = s_nationkey
    AND s_nationkey = n_nationkey
    AND n_regionkey = r_regionkey
    AND r_name = 'ASIA'
    AND o_orderDATE >= DATE '1994-01-01'
    AND o_orderDATE < DATE '1994-01-01' + INTERVAL '1' YEAR
GROUP BY
    n_name
ORDER BY
    revenue DESC;
----
----
sort
 ├── save-table-name: q5_sort_1
 ├── columns: n_name:50(char!null) revenue:61(float!null)
 ├── immutable
 ├── stats: [rows=5, distinct(50)=5, null(50)=0, distinct(61)=5, null(61)=0]
 ├── key: (50)
 ├── fd: (50)-->(61)
 ├── ordering: -61
 └── group-by
      ├── save-table-name: q5_group_by_2
      ├── columns: n_name:50(char!null) sum:61(float!null)
      ├── grouping columns: n_name:50(char!null)
      ├── immutable
      ├── stats: [rows=5, distinct(50)=5, null(50)=0, distinct(61)=5, null(61)=0]
      ├── key: (50)
      ├── fd: (50)-->(61)
      ├── project
      │    ├── save-table-name: q5_project_3
      │    ├── columns: column60:60(float!null) n_name:50(char!null)
      │    ├── immutable
      │    ├── stats: [rows=13335.7991, distinct(50)=5, null(50)=0, distinct(60)=13029.1468, null(60)=0]
      │    ├── inner-join (hash)
      │    │    ├── save-table-name: q5_inner_join_4
      │    │    ├── columns: c_custkey:1(int!null) c_nationkey:4(int!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_suppkey:24(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) s_suppkey:40(int!null) s_nationkey:43(int!null) n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    ├── stats: [rows=13335.7991, distinct(1)=13335.7991, null(1)=0, distinct(4)=5, null(4)=0, distinct(11)=12954.0055, null(11)=0, distinct(12)=13335.7991, null(12)=0, distinct(15)=365, null(15)=0, distinct(22)=12954.0055, null(22)=0, distinct(24)=1843.46779, null(24)=0, distinct(27)=13003.2401, null(27)=0, distinct(28)=11, null(28)=0, distinct(40)=1843.46779, null(40)=0, distinct(43)=5, null(43)=0, distinct(49)=5, null(49)=0, distinct(50)=5, null(50)=0, distinct(51)=1, null(51)=0, distinct(55)=1, null(55)=0, distinct(56)=0.996222107, null(56)=0, distinct(27,28)=13029.1468, null(27,28)=0]
      │    │    ├── fd: ()-->(56), (1)-->(4), (11)-->(12,15), (40)-->(43), (49)-->(50,51), (51)==(55), (55)==(51), (43)==(4,49), (49)==(4,43), (24)==(40), (40)==(24), (11)==(22), (22)==(11), (1)==(12), (12)==(1), (4)==(43,49)
      │    │    ├── inner-join (lookup lineitem)
      │    │    │    ├── save-table-name: q5_lookup_join_5
      │    │    │    ├── columns: c_custkey:1(int!null) c_nationkey:4(int!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_suppkey:24(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    ├── key columns: [11] = [22]
      │    │    │    ├── stats: [rows=294330.49, distinct(1)=27671.6644, null(1)=0, distinct(4)=5, null(4)=0, distinct(11)=63854.1005, null(11)=0, distinct(12)=27671.6644, null(12)=0, distinct(15)=365, null(15)=0, distinct(22)=63854.1005, null(22)=0, distinct(24)=9920, null(24)=0, distinct(27)=253915.06, null(27)=0, distinct(28)=11, null(28)=0, distinct(49)=5, null(49)=0, distinct(50)=5, null(50)=0, distinct(51)=1, null(51)=0, distinct(55)=1, null(55)=0, distinct(56)=0.996222107, null(56)=0]
      │    │    │    ├── fd: ()-->(56), (11)-->(12,15), (1)-->(4), (49)-->(50,51), (51)==(55), (55)==(51), (4)==(49), (49)==(4), (1)==(12), (12)==(1), (11)==(22), (22)==(11)
      │    │    │    ├── inner-join (hash)
      │    │    │    │    ├── save-table-name: q5_inner_join_6
      │    │    │    │    ├── columns: c_custkey:1(int!null) c_nationkey:4(int!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    │    │    ├── stats: [rows=74891.7334, distinct(1)=27672.3293, null(1)=0, distinct(4)=5, null(4)=0, distinct(11)=63854.1005, null(11)=0, distinct(12)=27672.3293, null(12)=0, distinct(15)=365, null(15)=0, distinct(49)=5, null(49)=0, distinct(50)=5, null(50)=0, distinct(51)=1, null(51)=0, distinct(55)=1, null(55)=0, distinct(56)=0.996222107, null(56)=0]
      │    │    │    │    ├── key: (11)
      │    │    │    │    ├── fd: ()-->(56), (11)-->(12,15), (1)-->(4), (49)-->(50,51), (51)==(55), (55)==(51), (4)==(49), (49)==(4), (1)==(12), (12)==(1)
      │    │    │    │    ├── index-join orders
      │    │    │    │    │    ├── save-table-name: q5_index_join_7
      │    │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null)
      │    │    │    │    │    ├── stats: [rows=228437.5, distinct(11)=228437.5, null(11)=0, distinct(12)=91507.0955, null(12)=0, distinct(15)=365, null(15)=0]
      │    │    │    │    │    │   histogram(15)=  0       0        2937.5      600       5850      1650      6900      1200      6750      1200      7050      600       7200      750       7200      450       6150      1350      6750      1050      6900      600       7200      300       6900      600       7050      300       6600      900       7200      600       7200      900       6750      1050      7200      900       6750      900       6750      900       6300      1350      6750      600       6300      1350      7050      300       6300      1050      6750      1050      6900      900       7200      750       7050      750       6600      750       1725      575
      │    │    │    │    │    │                 <--- '1993-12-31' -------- '1994-01-06' ------ '1994-01-17' ------ '1994-01-28' ------ '1994-02-10' ------ '1994-02-24' ------ '1994-03-08' ------ '1994-03-22' ------ '1994-04-01' ------ '1994-04-14' ------ '1994-04-26' ------ '1994-05-06' ------ '1994-05-19' ------ '1994-06-02' ------ '1994-06-17' ------ '1994-06-29' ------ '1994-07-13' ------ '1994-07-24' ------ '1994-08-05' ------ '1994-08-15' ------ '1994-08-28' ------ '1994-09-10' ------ '1994-09-24' ------ '1994-10-08' ------ '1994-10-19' ------ '1994-10-30' ------ '1994-11-11' ------ '1994-11-22' ------ '1994-12-05' ------ '1994-12-16' ------ '1994-12-27' ------ '1994-12-31'
      │    │    │    │    │    ├── key: (11)
      │    │    │    │    │    ├── fd: (11)-->(12,15)
      │    │    │    │    │    └── scan orders@o_od
      │    │    │    │    │         ├── save-table-name: q5_scan_8
      │    │    │    │    │         ├── columns: o_orderkey:11(int!null) o_orderdate:15(date!null)
      │    │    │    │    │         ├── constraint: /15/11: [/'1994-01-01' - /'1994-12-31']
      │    │    │    │    │         ├── stats: [rows=228437.5, distinct(11)=228437.5, null(11)=0, distinct(15)=365, null(15)=0]
      │    │    │    │    │         │   histogram(11)=  0           0            0 0.15229 1137.2 0.15229 1155.6 0.15229 1147.7 0.15229 1173.3 0.15229  1135.9 0.15229  1154.7 0.15229  1113.6 0.15229  1164.4 0.15229  1117.8 0.15229  1138.1 0.15229  1134.6 0.15229  1108.7 0.15229  1160.6 0.15229  1135.3 0.15229  1145.5 0.15229  1132.6 0.15229  1142.5 0.15229  1159.4 0.15229  1102.9 0.15229  1139.3 0.15229  1145.1 0.15229  1153.2 0.15229  1141.9 0.15229  1145.1 0.15229  1147.4 0.15229  1153.3 0.15229  1145.2 0.15229  1116.8 0.15229  1158.2 0.15229  1160.2 0.15229  1127.4 0.15229  1101.4 0.15229  1150.7 0.15229  1117.7  0.15229  1155.3  0.15229  1153.9  0.15229  1148.7  0.15229  1112.2  0.15229  1138.8  0.15229  1172.3  0.15229  1145.8  0.15229  1124.2  0.15229  1120.6  0.15229  1167.2  0.15229  1142.5  0.15229  1119.3  0.15229  1183.9  0.15229  1137.2  0.15229  1125.1  0.15229  1160.2  0.15229  1137.5  0.15229  1120  0.15229  1124.8  0.15229  1155.3  0.15229  1123.9  0.15229  1143.6  0.15229  1152.4  0.15229  1171.9  0.15229  1156.8  0.15229  1141.1  0.15229  1183.2  0.15229  1137.5  0.15229  1174  0.15229  1155  0.15229  1137.2  0.15229  1157.3  0.15229  1114.9  0.15229  1122.1  0.15229  1151.3  0.15229  1144.3  0.15229  1132.1  0.15229  1188.6  0.15229  1123.9  0.15229  1131.8  0.15229  1167.2  0.15229  1179.7  0.15229  1162.1  0.15229  1138.5  0.15229  1124.7  0.15229  1156.4  0.15229  1163.5  0.15229  1156.4  0.15229  1176.5  0.15229  1164.6  0.15229  1136.9  0.15229  1144.3  0.15229  1099.1  0.15229  1117.8  0.15229  1164.9  0.15229  1145.8  0.15229  1139.8  0.15229  1120.7  0.15229  1153.3  0.15229  1119.3  0.15229  1141  0.15229  1141.9  0.15229  1143.7  0.15229  1116.5  0.15229  1149.6  0.15229  1144  0.15229  1139.8  0.15229  1162.4  0.15229  1144.8  0.15229  1137.2  0.15229  1126.5  0.15229  1155.1  0.15229  1141.9  0.15229  1202.5  0.15229  1142.9  0.15229  1130  0.15229  1169.3  0.15229  1186.8  0.15229  1124.7  0.15229  1124.7  0.15229  1130.9  0.15229  1158.8  0.15229  1136.4  0.15229  1118.6  0.15229  1125.9  0.15229  1147.8  0.15229  1123.2  0.15229  1112.2  0.15229  1111.4  0.15229  1146.9  0.15229  1116.9  0.15229  1132.6  0.15229  1143.7  0.15229  1149.5  0.15229  1133  0.15229  1114.8  0.15229  1135.8  0.15229  1176.8  0.15229  1122.8  0.15229  1144.8  0.15229  1105.2  0.15229  1127  0.15229  1141.4  0.15229  1137.8  0.15229  1176.6  0.15229  1135.2  0.15229  1151.2  0.15229  1122.2  0.15229  1140.7  0.15229  1151.8  0.15229  1161.5  0.15229  1132  0.15229  1122.8  0.15229  1144.3  0.15229  1168.1  0.15229  1142.6  0.15229  1165  0.15229  1141.6  0.15229  1150.1  0.15229  1132.9  0.15229  1163.7  0.15229  1142.5  0.15229  1144  0.15229  1142  0.15229  1159.9  0.15229  1137.6  0.15229  1184.5  0.15229  1173.1  0.15229  1180.6  0.15229  1149.3  0.15229  1164.4  0.15229  1160.8  0.15229  1165.9  0.15229  1141.4  0.15229  1169  0.15229  1194  0.15229  1165.2  0.15229  1181.3  0.15229  1181.9  0.15229  1185  0.15229  1172.8  0.15229  1141  0.15229  1157.9  0.15229  1142.8  0.15229  1196.3  0.15229  1194.1  0.15229  1142.3  0.15229  1181  0.15229  1128.2  0.15229  1144.2  0.15229  1177.7  0.15229  1127.1  0.15229  1169.4  0.15229  1134.7  0.15229  1162  0.15229  1153.5  0.15229  1173.4  0.15229  1168.5  0.15229  1226.4  0.15229  1195  0.15229  1172.5  0.15229  1165.2  0.15229  1178.7  0.15229  1194  0.15229  1167.6  0.15229  0           0
      │    │    │    │    │         │                 <--- -9223372036854775808 ---- 101 --------- 29157 -------- 61863 -------- 92999 -------- 129156 -------- 157991 -------- 190502 -------- 214884 -------- 249314 -------- 274532 -------- 303776 -------- 332320 -------- 355714 -------- 389377 -------- 418086 -------- 448803 -------- 476966 -------- 507076 -------- 540513 -------- 562754 -------- 592226 -------- 622853 -------- 655073 -------- 685059 -------- 715683 -------- 746757 -------- 779008 -------- 809670 -------- 834690 -------- 867879 -------- 901479 -------- 928615 -------- 950533 -------- 982278 -------- 1007489 -------- 1040134 -------- 1072484 -------- 1103842 -------- 1127938 -------- 1157319 -------- 1193281 -------- 1224068 -------- 1250567 -------- 1276354 -------- 1311328 -------- 1341440 -------- 1366977 -------- 1405216 -------- 1434274 -------- 1460965 -------- 1494564 -------- 1523686 ------ 1549351 -------- 1575968 -------- 1608611 -------- 1635047 -------- 1665378 -------- 1697440 -------- 1733315 -------- 1766247 -------- 1796096 -------- 1834183 -------- 1863302 ------ 1899591 ------ 1932163 -------- 1961216 -------- 1994246 -------- 2018885 -------- 2044965 -------- 2076805 -------- 2107271 -------- 2135332 -------- 2174497 -------- 2200929 -------- 2228928 -------- 2263876 -------- 2301283 -------- 2335268 -------- 2364615 -------- 2391201 -------- 2424034 -------- 2458275 -------- 2491110 -------- 2527878 -------- 2562343 -------- 2591331 -------- 2621792 -------- 2643264 -------- 2668485 -------- 2703013 -------- 2733795 -------- 2763365 -------- 2789154 -------- 2821410 -------- 2846946 ------ 2876774 -------- 2906755 -------- 2937121 -------- 2962086 -------- 2993602 ------ 3024004 -------- 3053568 -------- 3087618 -------- 3118176 -------- 3147237 -------- 3174180 -------- 3206791 -------- 3236775 -------- 3278628 -------- 3308834 ------ 3336486 -------- 3371879 -------- 3410690 -------- 3437284 -------- 3463873 -------- 3491715 -------- 3525026 -------- 3553926 -------- 3579297 -------- 3606117 -------- 3637285 -------- 3663559 -------- 3687650 -------- 3711588 -------- 3742565 -------- 3767622 -------- 3795781 -------- 3826148 -------- 3857635 ------ 3885890 -------- 3910499 -------- 3939297 -------- 3976133 -------- 4002372 -------- 4032928 -------- 4055618 ------ 4082657 -------- 4112550 -------- 4141734 -------- 4178532 -------- 4207203 -------- 4239013 -------- 4265127 -------- 4294885 -------- 4326821 -------- 4360679 ------ 4388710 -------- 4414947 -------- 4445413 -------- 4480550 -------- 4510688 ------ 4541253 -------- 4567175 -------- 4594788 -------- 4618983 -------- 4649284 -------- 4675396 ------ 4701797 ------ 4727808 -------- 4757344 -------- 4782470 -------- 4816867 -------- 4849026 -------- 4882661 -------- 4910144 -------- 4940582 -------- 4970307 -------- 5001057 -------- 5026949 ------ 5058309 ------ 5094560 -------- 5125156 -------- 5158945 -------- 5192832 ------ 5227332 -------- 5259426 ------ 5285222 -------- 5314368 -------- 5340545 -------- 5377254 -------- 5413540 -------- 5439617 ------ 5473345 -------- 5496579 -------- 5523009 -------- 5556065 -------- 5579106 -------- 5610562 -------- 5635110 ------ 5665088 -------- 5693382 -------- 5725604 -------- 5756865 -------- 5799463 ------ 5835940 -------- 5867972 -------- 5898564 -------- 5931842 ------ 5968099 -------- 5999174 --- 9223372036854775807
      │    │    │    │    │         │   histogram(15)=  0       0        2937.5      600       5850      1650      6900      1200      6750      1200      7050      600       7200      750       7200      450       6150      1350      6750      1050      6900      600       7200      300       6900      600       7050      300       6600      900       7200      600       7200      900       6750      1050      7200      900       6750      900       6750      900       6300      1350      6750      600       6300      1350      7050      300       6300      1050      6750      1050      6900      900       7200      750       7050      750       6600      750       1725      575
      │    │    │    │    │         │                 <--- '1993-12-31' -------- '1994-01-06' ------ '1994-01-17' ------ '1994-01-28' ------ '1994-02-10' ------ '1994-02-24' ------ '1994-03-08' ------ '1994-03-22' ------ '1994-04-01' ------ '1994-04-14' ------ '1994-04-26' ------ '1994-05-06' ------ '1994-05-19' ------ '1994-06-02' ------ '1994-06-17' ------ '1994-06-29' ------ '1994-07-13' ------ '1994-07-24' ------ '1994-08-05' ------ '1994-08-15' ------ '1994-08-28' ------ '1994-09-10' ------ '1994-09-24' ------ '1994-10-08' ------ '1994-10-19' ------ '1994-10-30' ------ '1994-11-11' ------ '1994-11-22' ------ '1994-12-05' ------ '1994-12-16' ------ '1994-12-27' ------ '1994-12-31'
      │    │    │    │    │         ├── key: (11)
      │    │    │    │    │         └── fd: (11)-->(15)
      │    │    │    │    ├── inner-join (lookup customer@c_nk)
      │    │    │    │    │    ├── save-table-name: q5_lookup_join_9
      │    │    │    │    │    ├── columns: c_custkey:1(int!null) c_nationkey:4(int!null) n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    │    ├── key columns: [49] = [4]
      │    │    │    │    │    ├── stats: [rows=30000, distinct(1)=27672.3293, null(1)=0, distinct(4)=5, null(4)=0, distinct(49)=5, null(49)=0, distinct(50)=5, null(50)=0, distinct(51)=1, null(51)=0, distinct(55)=1, null(55)=0, distinct(56)=0.996222107, null(56)=0, distinct(4,49)=25, null(4,49)=0]
      │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    ├── fd: ()-->(56), (1)-->(4), (49)-->(50,51), (51)==(55), (55)==(51), (4)==(49), (49)==(4)
      │    │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    │    ├── save-table-name: q5_inner_join_10
      │    │    │    │    │    │    ├── columns: n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    │    │    │    │    ├── stats: [rows=5, distinct(49)=5, null(49)=0, distinct(50)=5, null(50)=0, distinct(51)=1, null(51)=0, distinct(55)=1, null(55)=0, distinct(56)=0.996222107, null(56)=0]
      │    │    │    │    │    │    ├── key: (49)
      │    │    │    │    │    │    ├── fd: ()-->(56), (49)-->(50,51), (51)==(55), (55)==(51)
      │    │    │    │    │    │    ├── scan nation
      │    │    │    │    │    │    │    ├── save-table-name: q5_scan_11
      │    │    │    │    │    │    │    ├── columns: n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null)
      │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(49)=25, null(49)=0, distinct(50)=25, null(50)=0, distinct(51)=5, null(51)=0]
      │    │    │    │    │    │    │    │   histogram(49)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │   histogram(50)=  0      1      23      1
      │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    │    │    │   histogram(51)=  0  5  0  5  0  5  0  5  0  5
      │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    ├── key: (49)
      │    │    │    │    │    │    │    └── fd: (49)-->(50,51)
      │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    ├── save-table-name: q5_select_12
      │    │    │    │    │    │    │    ├── columns: r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    │    │    │    ├── stats: [rows=1, distinct(55)=1, null(55)=0, distinct(56)=1, null(56)=0]
      │    │    │    │    │    │    │    │   histogram(56)=  0    1
      │    │    │    │    │    │    │    │                 <--- 'ASIA'
      │    │    │    │    │    │    │    ├── key: (55)
      │    │    │    │    │    │    │    ├── fd: ()-->(56)
      │    │    │    │    │    │    │    ├── scan region
      │    │    │    │    │    │    │    │    ├── save-table-name: q5_scan_13
      │    │    │    │    │    │    │    │    ├── columns: r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(55)=5, null(55)=0, distinct(56)=5, null(56)=0]
      │    │    │    │    │    │    │    │    │   histogram(55)=  0  1  0  1  0  1  0  1  0  1
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    │    │   histogram(56)=  0     1      3        1
      │    │    │    │    │    │    │    │    │                 <--- 'AFRICA' --- 'MIDDLE EAST'
      │    │    │    │    │    │    │    │    ├── key: (55)
      │    │    │    │    │    │    │    │    └── fd: (55)-->(56)
      │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │         └── r_name:56 = 'ASIA' [type=bool, outer=(56), constraints=(/56: [/'ASIA' - /'ASIA']; tight), fd=()-->(56)]
      │    │    │    │    │    │    └── filters
      │    │    │    │    │    │         └── n_regionkey:51 = r_regionkey:55 [type=bool, outer=(51,55), constraints=(/51: (/NULL - ]; /55: (/NULL - ]), fd=(51)==(55), (55)==(51)]
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters
      │    │    │    │         └── c_custkey:1 = o_custkey:12 [type=bool, outer=(1,12), constraints=(/1: (/NULL - ]; /12: (/NULL - ]), fd=(1)==(12), (12)==(1)]
      │    │    │    └── filters (true)
      │    │    ├── scan supplier@s_nk
      │    │    │    ├── save-table-name: q5_scan_14
      │    │    │    ├── columns: s_suppkey:40(int!null) s_nationkey:43(int!null)
      │    │    │    ├── stats: [rows=10000, distinct(40)=9920, null(40)=0, distinct(43)=25, null(43)=0]
      │    │    │    │   histogram(40)=  0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49    1
      │    │    │    │                 <--- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000
      │    │    │    │   histogram(43)=  0 403 0 384 0 391 0 396 0 406 0 396 0 393 0 399 0 406 0 393 0 383  0 398  0 394  0 414  0 422  0 387  0 435  0 403  0 441  0 357  0 394  0 390  0 421  0 411  0 383
      │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    ├── key: (40)
      │    │    │    └── fd: (40)-->(43)
      │    │    └── filters
      │    │         ├── s_nationkey:43 = n_nationkey:49 [type=bool, outer=(43,49), constraints=(/43: (/NULL - ]; /49: (/NULL - ]), fd=(43)==(49), (49)==(43)]
      │    │         └── l_suppkey:24 = s_suppkey:40 [type=bool, outer=(24,40), constraints=(/24: (/NULL - ]; /40: (/NULL - ]), fd=(24)==(40), (40)==(24)]
      │    └── projections
      │         └── l_extendedprice:27 * (1.0 - l_discount:28) [as=column60:60, type=float, outer=(27,28), immutable]
      └── aggregations
           └── sum [as=sum:61, type=float, outer=(60)]
                └── column60:60 [type=float]

----Stats for q5_sort_1----
column_names  row_count  distinct_count  null_count
{n_name}      5          5               0
{revenue}     5          5               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      5.00           1.00           5.00                1.00                0.00            1.00
{revenue}     5.00           1.00           5.00                1.00                0.00            1.00

----Stats for q5_group_by_2----
column_names  row_count  distinct_count  null_count
{n_name}      5          5               0
{sum}         5          5               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      5.00           1.00           5.00                1.00                0.00            1.00
{sum}         5.00           1.00           5.00                1.00                0.00            1.00

----Stats for q5_project_3----
column_names  row_count  distinct_count  null_count
{column60}    7243       7245            0
{n_name}      7243       5               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{column60}    13336.00       1.84           13029.00            1.80                0.00            1.00
{n_name}      13336.00       1.84           5.00                1.00                0.00            1.00

----Stats for q5_inner_join_4----
column_names       row_count  distinct_count  null_count
{c_custkey}        7243       5557            0
{c_nationkey}      7243       5               0
{l_discount}       7243       11              0
{l_extendedprice}  7243       7208            0
{l_orderkey}       7243       6640            0
{l_suppkey}        7243       1944            0
{n_name}           7243       5               0
{n_nationkey}      7243       5               0
{n_regionkey}      7243       1               0
{o_custkey}        7243       5557            0
{o_orderdate}      7243       365             0
{o_orderkey}       7243       6640            0
{r_name}           7243       1               0
{r_regionkey}      7243       1               0
{s_nationkey}      7243       5               0
{s_suppkey}        7243       1944            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        13336.00       1.84           13336.00            2.40 <==            0.00            1.00
{c_nationkey}      13336.00       1.84           5.00                1.00                0.00            1.00
{l_discount}       13336.00       1.84           11.00               1.00                0.00            1.00
{l_extendedprice}  13336.00       1.84           13003.00            1.80                0.00            1.00
{l_orderkey}       13336.00       1.84           12954.00            1.95 <==            0.00            1.00
{l_suppkey}        13336.00       1.84           1843.00             1.05                0.00            1.00
{n_name}           13336.00       1.84           5.00                1.00                0.00            1.00
{n_nationkey}      13336.00       1.84           5.00                1.00                0.00            1.00
{n_regionkey}      13336.00       1.84           1.00                1.00                0.00            1.00
{o_custkey}        13336.00       1.84           13336.00            2.40 <==            0.00            1.00
{o_orderdate}      13336.00       1.84           365.00              1.00                0.00            1.00
{o_orderkey}       13336.00       1.84           12954.00            1.95 <==            0.00            1.00
{r_name}           13336.00       1.84           1.00                1.00                0.00            1.00
{r_regionkey}      13336.00       1.84           1.00                1.00                0.00            1.00
{s_nationkey}      13336.00       1.84           5.00                1.00                0.00            1.00
{s_suppkey}        13336.00       1.84           1843.00             1.05                0.00            1.00

----Stats for q5_lookup_join_5----
column_names       row_count  distinct_count  null_count
{c_custkey}        184082     17300           0
{c_nationkey}      184082     5               0
{l_discount}       184082     11              0
{l_extendedprice}  184082     165216          0
{l_orderkey}       184082     45968           0
{l_suppkey}        184082     9920            0
{n_name}           184082     5               0
{n_nationkey}      184082     5               0
{n_regionkey}      184082     1               0
{o_custkey}        184082     17300           0
{o_orderdate}      184082     365             0
{o_orderkey}       184082     45968           0
{r_name}           184082     1               0
{r_regionkey}      184082     1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        294330.00      1.60           27672.00            1.60                0.00            1.00
{c_nationkey}      294330.00      1.60           5.00                1.00                0.00            1.00
{l_discount}       294330.00      1.60           11.00               1.00                0.00            1.00
{l_extendedprice}  294330.00      1.60           253915.00           1.54                0.00            1.00
{l_orderkey}       294330.00      1.60           63854.00            1.39                0.00            1.00
{l_suppkey}        294330.00      1.60           9920.00             1.00                0.00            1.00
{n_name}           294330.00      1.60           5.00                1.00                0.00            1.00
{n_nationkey}      294330.00      1.60           5.00                1.00                0.00            1.00
{n_regionkey}      294330.00      1.60           1.00                1.00                0.00            1.00
{o_custkey}        294330.00      1.60           27672.00            1.60                0.00            1.00
{o_orderdate}      294330.00      1.60           365.00              1.00                0.00            1.00
{o_orderkey}       294330.00      1.60           63854.00            1.39                0.00            1.00
{r_name}           294330.00      1.60           1.00                1.00                0.00            1.00
{r_regionkey}      294330.00      1.60           1.00                1.00                0.00            1.00

----Stats for q5_inner_join_6----
column_names   row_count  distinct_count  null_count
{c_custkey}    46008      17300           0
{c_nationkey}  46008      5               0
{n_name}       46008      5               0
{n_nationkey}  46008      5               0
{n_regionkey}  46008      1               0
{o_custkey}    46008      17300           0
{o_orderdate}  46008      365             0
{o_orderkey}   46008      45968           0
{r_name}       46008      1               0
{r_regionkey}  46008      1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}    74892.00       1.63           27672.00            1.60                0.00            1.00
{c_nationkey}  74892.00       1.63           5.00                1.00                0.00            1.00
{n_name}       74892.00       1.63           5.00                1.00                0.00            1.00
{n_nationkey}  74892.00       1.63           5.00                1.00                0.00            1.00
{n_regionkey}  74892.00       1.63           1.00                1.00                0.00            1.00
{o_custkey}    74892.00       1.63           27672.00            1.60                0.00            1.00
{o_orderdate}  74892.00       1.63           365.00              1.00                0.00            1.00
{o_orderkey}   74892.00       1.63           63854.00            1.39                0.00            1.00
{r_name}       74892.00       1.63           1.00                1.00                0.00            1.00
{r_regionkey}  74892.00       1.63           1.00                1.00                0.00            1.00

----Stats for q5_index_join_7----
column_names   row_count  distinct_count  null_count
{o_custkey}    227597     86427           0
{o_orderdate}  227597     365             0
{o_orderkey}   227597     229152          0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}    228438.00      1.00           91507.00            1.06                0.00            1.00
{o_orderdate}  228438.00      1.00           365.00              1.00                0.00            1.00
{o_orderkey}   228438.00      1.00           228438.00           1.00                0.00            1.00

----Stats for q5_scan_8----
column_names   row_count  distinct_count  null_count
{o_orderdate}  227597     365             0
{o_orderkey}   227597     229152          0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_orderdate}  228438.00      1.00           365.00              1.00                0.00            1.00
{o_orderkey}   228438.00      1.00           228438.00           1.00                0.00            1.00

----Stats for q5_lookup_join_9----
column_names   row_count  distinct_count  null_count
{c_custkey}    30183      29993           0
{c_nationkey}  30183      5               0
{n_name}       30183      5               0
{n_nationkey}  30183      5               0
{n_regionkey}  30183      1               0
{r_name}       30183      1               0
{r_regionkey}  30183      1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}    30000.00       1.01           27672.00            1.08                0.00            1.00
{c_nationkey}  30000.00       1.01           5.00                1.00                0.00            1.00
{n_name}       30000.00       1.01           5.00                1.00                0.00            1.00
{n_nationkey}  30000.00       1.01           5.00                1.00                0.00            1.00
{n_regionkey}  30000.00       1.01           1.00                1.00                0.00            1.00
{r_name}       30000.00       1.01           1.00                1.00                0.00            1.00
{r_regionkey}  30000.00       1.01           1.00                1.00                0.00            1.00

----Stats for q5_inner_join_10----
column_names   row_count  distinct_count  null_count
{n_name}       5          5               0
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       5.00           1.00           5.00                1.00                0.00            1.00
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

----Stats for q5_scan_11----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
{n_regionkey}  25         5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
{n_regionkey}  25.00          1.00           5.00                1.00                0.00            1.00

----Stats for q5_select_12----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

----Stats for q5_scan_13----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00

----Stats for q5_scan_14----
column_names   row_count  distinct_count  null_count
{s_nationkey}  10000      25              0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00
----
----
