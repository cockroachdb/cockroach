import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q5
# Local Supplier Volume
# Lists the revenue volume done through local suppliers.
#
# Lists for each nation in a region the revenue volume that resulted from
# lineitem transactions in which the customer ordering parts and the supplier
# filling them were both within that nation. The query is run in order to
# determine whether to institute local distribution centers in a given region.
# The query considers only parts ordered in a given year. The query displays the
# nations and revenue volume in descending order by revenue. Revenue volume for
# all qualifying lineitems in a particular nation is defined as
# sum(l_extendedprice * (1 - l_discount)).
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q5
SELECT
    n_name,
    sum(l_extendedprice * (1 - l_discount)) AS revenue
FROM
    customer,
    orders,
    lineitem,
    supplier,
    nation,
    region
WHERE
    c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND l_suppkey = s_suppkey
    AND c_nationkey = s_nationkey
    AND s_nationkey = n_nationkey
    AND n_regionkey = r_regionkey
    AND r_name = 'ASIA'
    AND o_orderDATE >= DATE '1994-01-01'
    AND o_orderDATE < DATE '1994-01-01' + INTERVAL '1' YEAR
GROUP BY
    n_name
ORDER BY
    revenue DESC;
----
----
sort
 ├── save-table-name: q5_sort_1
 ├── columns: n_name:50(char!null) revenue:61(float!null)
 ├── immutable
 ├── stats: [rows=5, distinct(50)=5, null(50)=0, avgsize(50)=4, distinct(61)=5, null(61)=0, avgsize(61)=4]
 ├── key: (50)
 ├── fd: (50)-->(61)
 ├── ordering: -61
 └── group-by (hash)
      ├── save-table-name: q5_group_by_2
      ├── columns: n_name:50(char!null) sum:61(float!null)
      ├── grouping columns: n_name:50(char!null)
      ├── immutable
      ├── stats: [rows=5, distinct(50)=5, null(50)=0, avgsize(50)=4, distinct(61)=5, null(61)=0, avgsize(61)=4]
      ├── key: (50)
      ├── fd: (50)-->(61)
      ├── project
      │    ├── save-table-name: q5_project_3
      │    ├── columns: column60:60(float!null) n_name:50(char!null)
      │    ├── immutable
      │    ├── stats: [rows=13472.1, distinct(50)=5, null(50)=0, avgsize(50)=4, distinct(60)=13161.9, null(60)=0, avgsize(60)=8]
      │    ├── inner-join (hash)
      │    │    ├── save-table-name: q5_inner_join_4
      │    │    ├── columns: c_custkey:1(int!null) c_nationkey:4(int!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_suppkey:24(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) s_suppkey:40(int!null) s_nationkey:43(int!null) n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    ├── stats: [rows=13472.1, distinct(1)=13472.1, null(1)=0, avgsize(1)=4, distinct(4)=5, null(4)=0, avgsize(4)=4, distinct(11)=13086.4, null(11)=0, avgsize(11)=4, distinct(12)=13472.1, null(12)=0, avgsize(12)=4, distinct(15)=365, null(15)=0, avgsize(15)=4, distinct(22)=13086.4, null(22)=0, avgsize(22)=4, distinct(24)=1843.56, null(24)=0, avgsize(24)=4, distinct(27)=13135.4, null(27)=0, avgsize(27)=4, distinct(28)=11, null(28)=0, avgsize(28)=4, distinct(40)=1843.56, null(40)=0, avgsize(40)=4, distinct(43)=5, null(43)=0, avgsize(43)=4, distinct(49)=5, null(49)=0, avgsize(49)=4, distinct(50)=5, null(50)=0, avgsize(50)=4, distinct(51)=1, null(51)=0, avgsize(51)=4, distinct(55)=1, null(55)=0, avgsize(55)=4, distinct(56)=0.996222, null(56)=0, avgsize(56)=4, distinct(27,28)=13161.9, null(27,28)=0, avgsize(27,28)=8]
      │    │    ├── fd: ()-->(56), (1)-->(4), (11)-->(12,15), (40)-->(43), (49)-->(50,51), (51)==(55), (55)==(51), (43)==(4,49), (49)==(4,43), (24)==(40), (40)==(24), (11)==(22), (22)==(11), (1)==(12), (12)==(1), (4)==(43,49)
      │    │    ├── inner-join (lookup lineitem)
      │    │    │    ├── save-table-name: q5_lookup_join_5
      │    │    │    ├── columns: c_custkey:1(int!null) c_nationkey:4(int!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_suppkey:24(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    ├── key columns: [11] = [22]
      │    │    │    ├── stats: [rows=296602.1, distinct(1)=27671.7, null(1)=0, avgsize(1)=4, distinct(4)=5, null(4)=0, avgsize(4)=4, distinct(11)=64371.6, null(11)=0, avgsize(11)=4, distinct(12)=27671.7, null(12)=0, avgsize(12)=4, distinct(15)=365, null(15)=0, avgsize(15)=4, distinct(22)=64371.6, null(22)=0, avgsize(22)=4, distinct(24)=9920, null(24)=0, avgsize(24)=4, distinct(27)=255591, null(27)=0, avgsize(27)=4, distinct(28)=11, null(28)=0, avgsize(28)=4, distinct(49)=5, null(49)=0, avgsize(49)=4, distinct(50)=5, null(50)=0, avgsize(50)=4, distinct(51)=1, null(51)=0, avgsize(51)=4, distinct(55)=1, null(55)=0, avgsize(55)=4, distinct(56)=0.996222, null(56)=0, avgsize(56)=4]
      │    │    │    ├── fd: ()-->(56), (11)-->(12,15), (1)-->(4), (49)-->(50,51), (51)==(55), (55)==(51), (4)==(49), (49)==(4), (1)==(12), (12)==(1), (11)==(22), (22)==(11)
      │    │    │    ├── inner-join (hash)
      │    │    │    │    ├── save-table-name: q5_inner_join_6
      │    │    │    │    ├── columns: c_custkey:1(int!null) c_nationkey:4(int!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    │    │    ├── stats: [rows=75469.74, distinct(1)=27672.3, null(1)=0, avgsize(1)=4, distinct(4)=5, null(4)=0, avgsize(4)=4, distinct(11)=64371.6, null(11)=0, avgsize(11)=4, distinct(12)=27672.3, null(12)=0, avgsize(12)=4, distinct(15)=365, null(15)=0, avgsize(15)=4, distinct(49)=5, null(49)=0, avgsize(49)=4, distinct(50)=5, null(50)=0, avgsize(50)=4, distinct(51)=1, null(51)=0, avgsize(51)=4, distinct(55)=1, null(55)=0, avgsize(55)=4, distinct(56)=0.996222, null(56)=0, avgsize(56)=4]
      │    │    │    │    ├── key: (11)
      │    │    │    │    ├── fd: ()-->(56), (11)-->(12,15), (1)-->(4), (49)-->(50,51), (51)==(55), (55)==(51), (4)==(49), (49)==(4), (1)==(12), (12)==(1)
      │    │    │    │    ├── index-join orders
      │    │    │    │    │    ├── save-table-name: q5_index_join_7
      │    │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null)
      │    │    │    │    │    ├── stats: [rows=230772.3, distinct(11)=230772, null(11)=0, avgsize(11)=4, distinct(12)=91734.4, null(12)=0, avgsize(12)=4, distinct(15)=365, null(15)=0, avgsize(15)=4]
      │    │    │    │    │    │   histogram(15)=  0       0        3744     443.81     6953.1     887.63     7101     739.69     6361.3     1183.5     6805.2     1035.6     6509.3     887.63     6953.1     739.69     6657.2     887.63     6805.2     591.75     7101     443.81     6805.2     591.75     6953.1     887.63     6509.3     1035.6     6805.2     591.75     6953.1     1331.4     7101     443.81     6361.3     887.63     6953.1     1331.4     7101     147.94     6953.1     739.69     6805.2     1035.6     6953.1     887.63     6657.2     591.75     6953.1     1775.3     6509.3     739.69     6213.4     1331.4     7101     591.75     7101     443.81     6509.3     887.63     6805.2     443.81     4608.8     512.09
      │    │    │    │    │    │                 <--- '1993-12-31' ------ '1994-01-08' -------- '1994-01-19' ------ '1994-01-30' -------- '1994-02-12' -------- '1994-02-25' -------- '1994-03-06' -------- '1994-03-19' -------- '1994-03-31' -------- '1994-04-12' ------ '1994-04-22' -------- '1994-05-05' -------- '1994-05-19' -------- '1994-05-30' -------- '1994-06-10' -------- '1994-06-23' ------ '1994-07-05' -------- '1994-07-16' -------- '1994-07-25' ------ '1994-08-06' -------- '1994-08-18' -------- '1994-08-31' -------- '1994-09-10' -------- '1994-09-25' -------- '1994-10-06' -------- '1994-10-21' -------- '1994-11-01' ------ '1994-11-12' ------ '1994-11-27' -------- '1994-12-08' -------- '1994-12-21' -------- '1994-12-31'
      │    │    │    │    │    ├── key: (11)
      │    │    │    │    │    ├── fd: (11)-->(12,15)
      │    │    │    │    │    └── scan orders@o_od
      │    │    │    │    │         ├── save-table-name: q5_scan_8
      │    │    │    │    │         ├── columns: o_orderkey:11(int!null) o_orderdate:15(date!null)
      │    │    │    │    │         ├── constraint: /15/11: [/'1994-01-01' - /'1994-12-31']
      │    │    │    │    │         ├── stats: [rows=230772.3, distinct(11)=230772, null(11)=0, avgsize(11)=4, distinct(15)=365, null(15)=0, avgsize(15)=4]
      │    │    │    │    │         │   histogram(11)=  0           0            0 0.15385 1148 0.15385 1120.9 0.15385 1160.8 0.15385 1167.7 0.15385  1111.2 0.15385  1126.9 0.15385  1154.9 0.15385  1131.1 0.15385  1196.6 0.15385  1165.7 0.15385  1189.5 0.15385  1183.8 0.15385  1167.2 0.15385  1164.6 0.15385  1193.5 0.15385  1173.1 0.15385  1154.9 0.15385  1114.8 0.15385  1203.2 0.15385  1160 0.15385  1147.1 0.15385  1167.7 0.15385  1190.9 0.15385  1170 0.15385  1186.3 0.15385  1186.1 0.15385  1186 0.15385  1152.5 0.15385  1158.1 0.15385  1128 0.15385  1124.9 0.15385  1165.7  0.15385  1160.9  0.15385  1119.7  0.15385  1137.4  0.15385  1155.2  0.15385  1172.8  0.15385  1166.5  0.15385  1196.3  0.15385  1157.5  0.15385  1164.5  0.15385  1151.4  0.15385  1178.9  0.15385  1133.7  0.15385  1149.4  0.15385  1135.5  0.15385  1176.6  0.15385  1135.7  0.15385  1174.8  0.15385  1152.5  0.15385  1145.7  0.15385  1158  0.15385  1144.9  0.15385  1117.8  0.15385  1224.8  0.15385  1115.7  0.15385  1156.1  0.15385  1122.3  0.15385  1154.3  0.15385  1120.9  0.15385  1126.3  0.15385  1113.2  0.15385  1146.5  0.15385  1201.7  0.15385  1135.2  0.15385  1141.4  0.15385  1178.8  0.15385  1139.2  0.15385  1143.5  0.15385  1166.1  0.15385  1205.7  0.15385  1145.5  0.15385  1131.7  0.15385  1172  0.15385  1094  0.15385  1138.3  0.15385  1172.8  0.15385  1177.8  0.15385  1143.7  0.15385  1178  0.15385  1139.2  0.15385  1150  0.15385  1165.1  0.15385  1182.9  0.15385  1163.1  0.15385  1140.8  0.15385  1157.5  0.15385  1162.9  0.15385  1127.8  0.15385  1167.4  0.15385  1136.8  0.15385  1127.4  0.15385  1180.3  0.15385  1157.5  0.15385  1182.8  0.15385  1157.7  0.15385  1171.5  0.15385  1148.3  0.15385  1168.5  0.15385  1134.3  0.15385  1180.1  0.15385  1124.8  0.15385  1118.6  0.15385  1138.5  0.15385  1182.9  0.15385  1152  0.15385  1162.6  0.15385  1133.2  0.15385  1157.2  0.15385  1194.3  0.15385  1136.5  0.15385  1138.5  0.15385  1163.5  0.15385  1154.3  0.15385  1108  0.15385  1168.6  0.15385  1157.8  0.15385  1146.5  0.15385  1120.1  0.15385  1124.3  0.15385  1136.5  0.15385  1130.1  0.15385  1136  0.15385  1158.6  0.15385  1185.7  0.15385  1166.5  0.15385  1155.8  0.15385  1159.5  0.15385  1109.4  0.15385  1183.1  0.15385  1178.3  0.15385  1132.1  0.15385  1176.5  0.15385  1115.8  0.15385  1127.4  0.15385  1157.8  0.15385  1163.8  0.15385  1157.7  0.15385  1144.5  0.15385  1152.9  0.15385  1141.5  0.15385  1155.4  0.15385  1168.6  0.15385  1138  0.15385  1135.2  0.15385  1127.8  0.15385  1136.6  0.15385  1162  0.15385  1127.8  0.15385  1143.4  0.15385  1196  0.15385  1208.3  0.15385  1163.5  0.15385  1161.4  0.15385  1207.4  0.15385  1220.6  0.15385  1195.2  0.15385  1190.6  0.15385  1150.9  0.15385  1181.5  0.15385  1179.1  0.15385  1167.4  0.15385  1158.1  0.15385  1148.8  0.15385  1145.4  0.15385  1156.9  0.15385  1204.8  0.15385  1164.5  0.15385  1180.3  0.15385  1175.1  0.15385  1148.1  0.15385  1208  0.15385  1151.4  0.15385  1194.8  0.15385  1146.5  0.15385  1238.6  0.15385  1176.1  0.15385  1188.5  0.15385  1149.5  0.15385  1156.6  0.15385  1204.8  0.15385  1136.6  0.15385  1192.3  0.15385  1160.9  0.15385  1187.5  0.15385  1136.1  0.15385  1148.5  0.15385  1148.9  0.15385  1201.5  0.15385  1194.9  0.15385  1155.7  0.15385  1175.7  0.15385  1186.5  0.15385  1189.2  0.15385  1174.1  0.15385  1190  0.15385  1220.3  0.15385  1167.2  0.15385  1225.4  0.15385  0           0
      │    │    │    │    │         │                 <--- -9223372036854775808 --- 1472 ------- 30469 -------- 54689 -------- 85922 -------- 118369 -------- 140867 -------- 166146 -------- 196357 -------- 222375 -------- 259877 -------- 291970 -------- 328227 -------- 363490 -------- 395873 -------- 427783 -------- 464741 -------- 498146 -------- 528358 -------- 551493 -------- 590144 ------ 621254 -------- 650083 -------- 682531 -------- 719041 ------ 751906 -------- 787617 -------- 823298 ------ 858944 -------- 888739 -------- 919527 ------ 944996 -------- 969922 -------- 1002020 -------- 1033280 -------- 1057284 -------- 1084416 -------- 1114693 -------- 1148034 -------- 1180262 -------- 1217697 -------- 1248386 -------- 1280261 -------- 1309862 -------- 1344263 -------- 1370759 -------- 1400003 -------- 1426822 -------- 1460837 -------- 1487680 -------- 1521376 -------- 1551174 -------- 1579779 ------ 1610532 -------- 1638983 -------- 1662660 -------- 1705024 -------- 1728321 -------- 1758757 -------- 1783239 -------- 1813344 -------- 1837573 -------- 1862757 -------- 1885607 -------- 1914340 -------- 1952706 -------- 1979458 -------- 2007302 -------- 2041697 -------- 2069157 -------- 2097383 -------- 2129571 -------- 2168643 -------- 2197223 -------- 2223363 ------ 2256577 ------ 2275975 -------- 2303264 -------- 2336608 -------- 2370823 -------- 2399074 ------ 2433315 -------- 2460771 ------ 2490114 -------- 2522119 -------- 2557218 -------- 2588866 -------- 2616610 -------- 2647296 -------- 2678913 -------- 2704354 -------- 2736743 -------- 2763779 -------- 2789157 -------- 2823812 -------- 2854502 -------- 2889572 -------- 2920263 -------- 2953378 -------- 2982439 -------- 3015013 -------- 3041603 -------- 3076227 -------- 3101125 -------- 3124930 -------- 3152260 -------- 3187366 ------ 3217059 -------- 3248611 -------- 3275008 -------- 3305634 -------- 3342721 -------- 3369702 -------- 3397031 -------- 3428771 -------- 3458885 ------ 3480806 -------- 3513408 -------- 3544129 -------- 3572866 -------- 3596965 -------- 3621794 -------- 3648771 -------- 3674624 ------ 3701510 -------- 3732387 -------- 3767974 -------- 3800224 -------- 3830599 -------- 3861635 -------- 3883808 -------- 3918949 -------- 3953249 -------- 3979456 -------- 4013443 -------- 4036775 -------- 4062148 -------- 4092867 -------- 4124641 -------- 4155333 -------- 4183718 -------- 4213574 -------- 4241445 -------- 4271751 -------- 4304354 ------ 4331590 -------- 4358338 -------- 4383782 -------- 4410791 ------ 4442244 -------- 4467687 -------- 4495876 ------ 4529761 -------- 4565792 -------- 4593991 -------- 4621829 -------- 4657703 -------- 4695878 -------- 4729632 -------- 4762593 -------- 4788581 -------- 4819943 -------- 4850885 -------- 4879777 -------- 4907042 -------- 4932640 -------- 4957638 -------- 4984675 -------- 5020100 -------- 5048481 -------- 5079622 -------- 5109862 -------- 5135363 ------ 5171364 -------- 5197414 -------- 5231104 -------- 5256289 -------- 5297604 -------- 5328038 -------- 5360608 -------- 5386337 -------- 5413315 -------- 5448743 -------- 5472197 -------- 5505440 -------- 5533184 -------- 5565603 -------- 5588963 -------- 5614503 -------- 5640135 -------- 5675008 -------- 5708709 -------- 5735522 -------- 5765862 -------- 5798085 -------- 5830787 -------- 5860867 ------ 5893703 -------- 5931844 -------- 5960706 -------- 5999719 --- 9223372036854775807
      │    │    │    │    │         │   histogram(15)=  0       0        3744     443.81     6953.1     887.63     7101     739.69     6361.3     1183.5     6805.2     1035.6     6509.3     887.63     6953.1     739.69     6657.2     887.63     6805.2     591.75     7101     443.81     6805.2     591.75     6953.1     887.63     6509.3     1035.6     6805.2     591.75     6953.1     1331.4     7101     443.81     6361.3     887.63     6953.1     1331.4     7101     147.94     6953.1     739.69     6805.2     1035.6     6953.1     887.63     6657.2     591.75     6953.1     1775.3     6509.3     739.69     6213.4     1331.4     7101     591.75     7101     443.81     6509.3     887.63     6805.2     443.81     4608.8     512.09
      │    │    │    │    │         │                 <--- '1993-12-31' ------ '1994-01-08' -------- '1994-01-19' ------ '1994-01-30' -------- '1994-02-12' -------- '1994-02-25' -------- '1994-03-06' -------- '1994-03-19' -------- '1994-03-31' -------- '1994-04-12' ------ '1994-04-22' -------- '1994-05-05' -------- '1994-05-19' -------- '1994-05-30' -------- '1994-06-10' -------- '1994-06-23' ------ '1994-07-05' -------- '1994-07-16' -------- '1994-07-25' ------ '1994-08-06' -------- '1994-08-18' -------- '1994-08-31' -------- '1994-09-10' -------- '1994-09-25' -------- '1994-10-06' -------- '1994-10-21' -------- '1994-11-01' ------ '1994-11-12' ------ '1994-11-27' -------- '1994-12-08' -------- '1994-12-21' -------- '1994-12-31'
      │    │    │    │    │         ├── key: (11)
      │    │    │    │    │         └── fd: (11)-->(15)
      │    │    │    │    ├── inner-join (lookup customer@c_nk)
      │    │    │    │    │    ├── save-table-name: q5_lookup_join_9
      │    │    │    │    │    ├── columns: c_custkey:1(int!null) c_nationkey:4(int!null) n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    │    ├── key columns: [49] = [4]
      │    │    │    │    │    ├── stats: [rows=30000, distinct(1)=27672.3, null(1)=0, avgsize(1)=4, distinct(4)=5, null(4)=0, avgsize(4)=4, distinct(49)=5, null(49)=0, avgsize(49)=4, distinct(50)=5, null(50)=0, avgsize(50)=4, distinct(51)=1, null(51)=0, avgsize(51)=4, distinct(55)=1, null(55)=0, avgsize(55)=4, distinct(56)=0.996222, null(56)=0, avgsize(56)=4, distinct(4,49)=25, null(4,49)=0, avgsize(4,49)=8]
      │    │    │    │    │    ├── key: (1)
      │    │    │    │    │    ├── fd: ()-->(56), (1)-->(4), (49)-->(50,51), (51)==(55), (55)==(51), (4)==(49), (49)==(4)
      │    │    │    │    │    ├── inner-join (hash)
      │    │    │    │    │    │    ├── save-table-name: q5_inner_join_10
      │    │    │    │    │    │    ├── columns: n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null) r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    │    │    ├── multiplicity: left-rows(zero-or-one), right-rows(zero-or-more)
      │    │    │    │    │    │    ├── stats: [rows=5, distinct(49)=5, null(49)=0, avgsize(49)=4, distinct(50)=5, null(50)=0, avgsize(50)=4, distinct(51)=1, null(51)=0, avgsize(51)=4, distinct(55)=1, null(55)=0, avgsize(55)=4, distinct(56)=0.996222, null(56)=0, avgsize(56)=4]
      │    │    │    │    │    │    ├── key: (49)
      │    │    │    │    │    │    ├── fd: ()-->(56), (49)-->(50,51), (51)==(55), (55)==(51)
      │    │    │    │    │    │    ├── scan nation
      │    │    │    │    │    │    │    ├── save-table-name: q5_scan_11
      │    │    │    │    │    │    │    ├── columns: n_nationkey:49(int!null) n_name:50(char!null) n_regionkey:51(int!null)
      │    │    │    │    │    │    │    ├── stats: [rows=25, distinct(49)=25, null(49)=0, avgsize(49)=4, distinct(50)=25, null(50)=0, avgsize(50)=4, distinct(51)=5, null(51)=0, avgsize(51)=4]
      │    │    │    │    │    │    │    │   histogram(49)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │    │    │    │   histogram(50)=  0      1      23      1
      │    │    │    │    │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    │    │    │    │    │   histogram(51)=  0  5  0  5  0  5  0  5  0  5
      │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    ├── key: (49)
      │    │    │    │    │    │    │    └── fd: (49)-->(50,51)
      │    │    │    │    │    │    ├── select
      │    │    │    │    │    │    │    ├── save-table-name: q5_select_12
      │    │    │    │    │    │    │    ├── columns: r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    │    │    │    ├── stats: [rows=1, distinct(55)=1, null(55)=0, avgsize(55)=4, distinct(56)=1, null(56)=0, avgsize(56)=4]
      │    │    │    │    │    │    │    │   histogram(56)=  0    1
      │    │    │    │    │    │    │    │                 <--- 'ASIA'
      │    │    │    │    │    │    │    ├── key: (55)
      │    │    │    │    │    │    │    ├── fd: ()-->(56)
      │    │    │    │    │    │    │    ├── scan region
      │    │    │    │    │    │    │    │    ├── save-table-name: q5_scan_13
      │    │    │    │    │    │    │    │    ├── columns: r_regionkey:55(int!null) r_name:56(char!null)
      │    │    │    │    │    │    │    │    ├── stats: [rows=5, distinct(55)=5, null(55)=0, avgsize(55)=4, distinct(56)=5, null(56)=0, avgsize(56)=4]
      │    │    │    │    │    │    │    │    │   histogram(55)=  0  1  0  1  0  1  0  1  0  1
      │    │    │    │    │    │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4
      │    │    │    │    │    │    │    │    │   histogram(56)=  0     1      3        1
      │    │    │    │    │    │    │    │    │                 <--- 'AFRICA' --- 'MIDDLE EAST'
      │    │    │    │    │    │    │    │    ├── key: (55)
      │    │    │    │    │    │    │    │    └── fd: (55)-->(56)
      │    │    │    │    │    │    │    └── filters
      │    │    │    │    │    │    │         └── r_name:56 = 'ASIA' [type=bool, outer=(56), constraints=(/56: [/'ASIA' - /'ASIA']; tight), fd=()-->(56)]
      │    │    │    │    │    │    └── filters
      │    │    │    │    │    │         └── n_regionkey:51 = r_regionkey:55 [type=bool, outer=(51,55), constraints=(/51: (/NULL - ]; /55: (/NULL - ]), fd=(51)==(55), (55)==(51)]
      │    │    │    │    │    └── filters (true)
      │    │    │    │    └── filters
      │    │    │    │         └── c_custkey:1 = o_custkey:12 [type=bool, outer=(1,12), constraints=(/1: (/NULL - ]; /12: (/NULL - ]), fd=(1)==(12), (12)==(1)]
      │    │    │    └── filters (true)
      │    │    ├── scan supplier@s_nk
      │    │    │    ├── save-table-name: q5_scan_14
      │    │    │    ├── columns: s_suppkey:40(int!null) s_nationkey:43(int!null)
      │    │    │    ├── stats: [rows=10000, distinct(40)=9920, null(40)=0, avgsize(40)=4, distinct(43)=25, null(43)=0, avgsize(43)=4]
      │    │    │    │   histogram(40)=  0           0            0  1  49  1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1   49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    49   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50   1    50    1    0           0
      │    │    │    │                 <--- -9223372036854775808 --- 1 ---- 51 ---- 101 ---- 151 ---- 201 ---- 251 ---- 301 ---- 351 ---- 401 ---- 451 ---- 501 ---- 551 ---- 601 ---- 651 ---- 701 ---- 751 ---- 801 ---- 851 ---- 901 ---- 951 ---- 1001 ---- 1051 ---- 1101 ---- 1151 ---- 1201 ---- 1251 ---- 1301 ---- 1351 ---- 1401 ---- 1451 ---- 1501 ---- 1551 ---- 1601 ---- 1651 ---- 1701 ---- 1751 ---- 1801 ---- 1851 ---- 1901 ---- 1951 ---- 2001 ---- 2051 ---- 2101 ---- 2151 ---- 2201 ---- 2251 ---- 2301 ---- 2351 ---- 2401 ---- 2451 ---- 2501 ---- 2551 ---- 2601 ---- 2651 ---- 2701 ---- 2751 ---- 2801 ---- 2851 ---- 2901 ---- 2951 ---- 3001 ---- 3051 ---- 3101 ---- 3151 ---- 3201 ---- 3251 ---- 3301 ---- 3351 ---- 3401 ---- 3451 ---- 3501 ---- 3551 ---- 3601 ---- 3651 ---- 3701 ---- 3751 ---- 3801 ---- 3851 ---- 3901 ---- 3951 ---- 4001 ---- 4051 ---- 4101 ---- 4151 ---- 4201 ---- 4251 ---- 4301 ---- 4351 ---- 4401 ---- 4451 ---- 4501 ---- 4551 ---- 4601 ---- 4651 ---- 4701 ---- 4751 ---- 4801 ---- 4851 ---- 4901 ---- 4951 ---- 5001 ---- 5051 ---- 5101 ---- 5151 ---- 5201 ---- 5251 ---- 5301 ---- 5351 ---- 5401 ---- 5451 ---- 5501 ---- 5551 ---- 5601 ---- 5651 ---- 5701 ---- 5751 ---- 5801 ---- 5851 ---- 5901 ---- 5951 ---- 6001 ---- 6051 ---- 6101 ---- 6151 ---- 6201 ---- 6251 ---- 6301 ---- 6351 ---- 6401 ---- 6451 ---- 6501 ---- 6551 ---- 6601 ---- 6651 ---- 6701 ---- 6751 ---- 6801 ---- 6851 ---- 6901 ---- 6951 ---- 7001 ---- 7051 ---- 7101 ---- 7151 ---- 7201 ---- 7251 ---- 7301 ---- 7351 ---- 7401 ---- 7451 ---- 7501 ---- 7552 ---- 7603 ---- 7654 ---- 7705 ---- 7756 ---- 7807 ---- 7858 ---- 7909 ---- 7960 ---- 8011 ---- 8062 ---- 8113 ---- 8164 ---- 8215 ---- 8266 ---- 8317 ---- 8368 ---- 8419 ---- 8470 ---- 8521 ---- 8572 ---- 8623 ---- 8674 ---- 8725 ---- 8776 ---- 8827 ---- 8878 ---- 8929 ---- 8980 ---- 9031 ---- 9082 ---- 9133 ---- 9184 ---- 9235 ---- 9286 ---- 9337 ---- 9388 ---- 9439 ---- 9490 ---- 9541 ---- 9592 ---- 9643 ---- 9694 ---- 9745 ---- 9796 ---- 9847 ---- 9898 ---- 9949 ---- 10000 --- 9223372036854775807
      │    │    │    │   histogram(43)=  0 403 0 384 0 391 0 396 0 406 0 396 0 393 0 399 0 406 0 393 0 383  0 398  0 394  0 414  0 422  0 387  0 435  0 403  0 441  0 357  0 394  0 390  0 421  0 411  0 383
      │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    ├── key: (40)
      │    │    │    └── fd: (40)-->(43)
      │    │    └── filters
      │    │         ├── s_nationkey:43 = n_nationkey:49 [type=bool, outer=(43,49), constraints=(/43: (/NULL - ]; /49: (/NULL - ]), fd=(43)==(49), (49)==(43)]
      │    │         └── l_suppkey:24 = s_suppkey:40 [type=bool, outer=(24,40), constraints=(/24: (/NULL - ]; /40: (/NULL - ]), fd=(24)==(40), (40)==(24)]
      │    └── projections
      │         └── l_extendedprice:27 * (1.0 - l_discount:28) [as=column60:60, type=float, outer=(27,28), immutable]
      └── aggregations
           └── sum [as=sum:61, type=float, outer=(60)]
                └── column60:60 [type=float]

----Stats for q5_sort_1----
column_names  row_count  distinct_count  null_count
{n_name}      5          5               0
{revenue}     5          5               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      5.00           1.00           5.00                1.00                0.00            1.00
{revenue}     5.00           1.00           5.00                1.00                0.00            1.00

----Stats for q5_group_by_2----
column_names  row_count  distinct_count  null_count
{n_name}      5          5               0
{sum}         5          5               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}      5.00           1.00           5.00                1.00                0.00            1.00
{sum}         5.00           1.00           5.00                1.00                0.00            1.00

----Stats for q5_project_3----
column_names  row_count  distinct_count  null_count
{column60}    7243       7243            0
{n_name}      7243       5               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{column60}    13472.00       1.86           13162.00            1.82                0.00            1.00
{n_name}      13472.00       1.86           5.00                1.00                0.00            1.00

----Stats for q5_inner_join_4----
column_names       row_count  distinct_count  null_count
{c_custkey}        7243       5557            0
{c_nationkey}      7243       5               0
{l_discount}       7243       11              0
{l_extendedprice}  7243       7208            0
{l_orderkey}       7243       6640            0
{l_suppkey}        7243       1944            0
{n_name}           7243       5               0
{n_nationkey}      7243       5               0
{n_regionkey}      7243       1               0
{o_custkey}        7243       5557            0
{o_orderdate}      7243       365             0
{o_orderkey}       7243       6640            0
{r_name}           7243       1               0
{r_regionkey}      7243       1               0
{s_nationkey}      7243       5               0
{s_suppkey}        7243       1944            0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        13472.00       1.86           13472.00            2.42 <==            0.00            1.00
{c_nationkey}      13472.00       1.86           5.00                1.00                0.00            1.00
{l_discount}       13472.00       1.86           11.00               1.00                0.00            1.00
{l_extendedprice}  13472.00       1.86           13135.00            1.82                0.00            1.00
{l_orderkey}       13472.00       1.86           13086.00            1.97 <==            0.00            1.00
{l_suppkey}        13472.00       1.86           1844.00             1.05                0.00            1.00
{n_name}           13472.00       1.86           5.00                1.00                0.00            1.00
{n_nationkey}      13472.00       1.86           5.00                1.00                0.00            1.00
{n_regionkey}      13472.00       1.86           1.00                1.00                0.00            1.00
{o_custkey}        13472.00       1.86           13472.00            2.42 <==            0.00            1.00
{o_orderdate}      13472.00       1.86           365.00              1.00                0.00            1.00
{o_orderkey}       13472.00       1.86           13086.00            1.97 <==            0.00            1.00
{r_name}           13472.00       1.86           1.00                1.00                0.00            1.00
{r_regionkey}      13472.00       1.86           1.00                1.00                0.00            1.00
{s_nationkey}      13472.00       1.86           5.00                1.00                0.00            1.00
{s_suppkey}        13472.00       1.86           1844.00             1.05                0.00            1.00

----Stats for q5_lookup_join_5----
column_names       row_count  distinct_count  null_count
{c_custkey}        184082     17300           0
{c_nationkey}      184082     5               0
{l_discount}       184082     11              0
{l_extendedprice}  184082     165216          0
{l_orderkey}       184082     45968           0
{l_suppkey}        184082     9920            0
{n_name}           184082     5               0
{n_nationkey}      184082     5               0
{n_regionkey}      184082     1               0
{o_custkey}        184082     17300           0
{o_orderdate}      184082     365             0
{o_orderkey}       184082     45968           0
{r_name}           184082     1               0
{r_regionkey}      184082     1               0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}        296602.00      1.61           27672.00            1.60                0.00            1.00
{c_nationkey}      296602.00      1.61           5.00                1.00                0.00            1.00
{l_discount}       296602.00      1.61           11.00               1.00                0.00            1.00
{l_extendedprice}  296602.00      1.61           255591.00           1.55                0.00            1.00
{l_orderkey}       296602.00      1.61           64372.00            1.40                0.00            1.00
{l_suppkey}        296602.00      1.61           9920.00             1.00                0.00            1.00
{n_name}           296602.00      1.61           5.00                1.00                0.00            1.00
{n_nationkey}      296602.00      1.61           5.00                1.00                0.00            1.00
{n_regionkey}      296602.00      1.61           1.00                1.00                0.00            1.00
{o_custkey}        296602.00      1.61           27672.00            1.60                0.00            1.00
{o_orderdate}      296602.00      1.61           365.00              1.00                0.00            1.00
{o_orderkey}       296602.00      1.61           64372.00            1.40                0.00            1.00
{r_name}           296602.00      1.61           1.00                1.00                0.00            1.00
{r_regionkey}      296602.00      1.61           1.00                1.00                0.00            1.00

----Stats for q5_inner_join_6----
column_names   row_count  distinct_count  null_count
{c_custkey}    46008      17300           0
{c_nationkey}  46008      5               0
{n_name}       46008      5               0
{n_nationkey}  46008      5               0
{n_regionkey}  46008      1               0
{o_custkey}    46008      17300           0
{o_orderdate}  46008      365             0
{o_orderkey}   46008      45968           0
{r_name}       46008      1               0
{r_regionkey}  46008      1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}    75470.00       1.64           27672.00            1.60                0.00            1.00
{c_nationkey}  75470.00       1.64           5.00                1.00                0.00            1.00
{n_name}       75470.00       1.64           5.00                1.00                0.00            1.00
{n_nationkey}  75470.00       1.64           5.00                1.00                0.00            1.00
{n_regionkey}  75470.00       1.64           1.00                1.00                0.00            1.00
{o_custkey}    75470.00       1.64           27672.00            1.60                0.00            1.00
{o_orderdate}  75470.00       1.64           365.00              1.00                0.00            1.00
{o_orderkey}   75470.00       1.64           64372.00            1.40                0.00            1.00
{r_name}       75470.00       1.64           1.00                1.00                0.00            1.00
{r_regionkey}  75470.00       1.64           1.00                1.00                0.00            1.00

----Stats for q5_index_join_7----
column_names   row_count  distinct_count  null_count
{o_custkey}    227597     86427           0
{o_orderdate}  227597     365             0
{o_orderkey}   227597     227597          0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}    230772.00      1.01           91734.00            1.06                0.00            1.00
{o_orderdate}  230772.00      1.01           365.00              1.00                0.00            1.00
{o_orderkey}   230772.00      1.01           230772.00           1.01                0.00            1.00

----Stats for q5_scan_8----
column_names   row_count  distinct_count  null_count
{o_orderdate}  227597     365             0
{o_orderkey}   227597     227597          0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_orderdate}  230772.00      1.01           365.00              1.00                0.00            1.00
{o_orderkey}   230772.00      1.01           230772.00           1.01                0.00            1.00

----Stats for q5_lookup_join_9----
column_names   row_count  distinct_count  null_count
{c_custkey}    30183      29993           0
{c_nationkey}  30183      5               0
{n_name}       30183      5               0
{n_nationkey}  30183      5               0
{n_regionkey}  30183      1               0
{r_name}       30183      1               0
{r_regionkey}  30183      1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_custkey}    30000.00       1.01           27672.00            1.08                0.00            1.00
{c_nationkey}  30000.00       1.01           5.00                1.00                0.00            1.00
{n_name}       30000.00       1.01           5.00                1.00                0.00            1.00
{n_nationkey}  30000.00       1.01           5.00                1.00                0.00            1.00
{n_regionkey}  30000.00       1.01           1.00                1.00                0.00            1.00
{r_name}       30000.00       1.01           1.00                1.00                0.00            1.00
{r_regionkey}  30000.00       1.01           1.00                1.00                0.00            1.00

----Stats for q5_inner_join_10----
column_names   row_count  distinct_count  null_count
{n_name}       5          5               0
{n_nationkey}  5          5               0
{n_regionkey}  5          1               0
{r_name}       5          1               0
{r_regionkey}  5          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       5.00           1.00           5.00                1.00                0.00            1.00
{n_nationkey}  5.00           1.00           5.00                1.00                0.00            1.00
{n_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00
{r_name}       5.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           1.00                1.00                0.00            1.00

----Stats for q5_scan_11----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
{n_regionkey}  25         5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
{n_regionkey}  25.00          1.00           5.00                1.00                0.00            1.00

----Stats for q5_select_12----
column_names   row_count  distinct_count  null_count
{r_name}       1          1               0
{r_regionkey}  1          1               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       1.00           1.00           1.00                1.00                0.00            1.00
{r_regionkey}  1.00           1.00           1.00                1.00                0.00            1.00

----Stats for q5_scan_13----
column_names   row_count  distinct_count  null_count
{r_name}       5          5               0
{r_regionkey}  5          5               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{r_name}       5.00           1.00           5.00                1.00                0.00            1.00
{r_regionkey}  5.00           1.00           5.00                1.00                0.00            1.00

----Stats for q5_scan_14----
column_names   row_count  distinct_count  null_count
{s_nationkey}  10000      25              0
{s_suppkey}    10000      9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_nationkey}  10000.00       1.00           25.00               1.00                0.00            1.00
{s_suppkey}    10000.00       1.00           9920.00             1.00                0.00            1.00
----
----
