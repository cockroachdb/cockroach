import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q10
# Returned Item Reporting
# Identifies customers who might be having problems with the parts that are
# shipped to them.
#
# Finds the top 20 customers, in terms of their effect on lost revenue for a
# given quarter, who have returned parts. The query considers only parts that
# were ordered in the specified quarter. The query lists the customer's name,
# address, nation, phone number, account balance, comment information and
# revenue lost. The customers are listed in descending order of lost revenue.
# Revenue lost is defined as sum(l_extendedprice*(1-l_discount)) for all
# qualifying lineitems.
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q10
SELECT
    c_custkey,
    c_name,
    sum(l_extendedprice * (1 - l_discount)) AS revenue,
    c_acctbal,
    n_name,
    c_address,
    c_phone,
    c_comment
FROM
    customer,
    orders,
    lineitem,
    nation
WHERE
    c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND o_orderDATE >= DATE '1993-10-01'
    AND o_orderDATE < DATE '1993-10-01' + INTERVAL '3' MONTH
    AND l_returnflag = 'R'
    AND c_nationkey = n_nationkey
GROUP BY
    c_custkey,
    c_name,
    c_acctbal,
    c_phone,
    n_name,
    c_address,
    c_comment
ORDER BY
    revenue DESC
LIMIT 20;
----
----
top-k
 ├── save-table-name: q10_top_k_1
 ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) revenue:47(float!null) c_acctbal:6(float!null) n_name:41(char!null) c_address:3(varchar!null) c_phone:5(char!null) c_comment:8(varchar!null)
 ├── internal-ordering: -47
 ├── k: 20
 ├── cardinality: [0 - 20]
 ├── immutable
 ├── stats: [rows=20, distinct(1)=20, null(1)=0, avgsize(1)=4, distinct(2)=20, null(2)=0, avgsize(2)=4, distinct(3)=20, null(3)=0, avgsize(3)=4, distinct(5)=20, null(5)=0, avgsize(5)=4, distinct(6)=20, null(6)=0, avgsize(6)=4, distinct(8)=20, null(8)=0, avgsize(8)=4, distinct(41)=20, null(41)=0, avgsize(41)=4, distinct(47)=20, null(47)=0, avgsize(47)=4]
 ├── key: (1)
 ├── fd: (1)-->(2,3,5,6,8,41,47)
 ├── ordering: -47
 └── group-by (hash)
      ├── save-table-name: q10_group_by_2
      ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:41(char!null) sum:47(float!null)
      ├── grouping columns: c_custkey:1(int!null)
      ├── immutable
      ├── stats: [rows=32163.1, distinct(1)=32163.1, null(1)=0, avgsize(1)=4, distinct(2)=32163.1, null(2)=0, avgsize(2)=4, distinct(3)=32163.1, null(3)=0, avgsize(3)=4, distinct(5)=32163.1, null(5)=0, avgsize(5)=4, distinct(6)=32163.1, null(6)=0, avgsize(6)=4, distinct(8)=32163.1, null(8)=0, avgsize(8)=4, distinct(41)=32163.1, null(41)=0, avgsize(41)=4, distinct(47)=32163.1, null(47)=0, avgsize(47)=4]
      ├── key: (1)
      ├── fd: (1)-->(2,3,5,6,8,41,47)
      ├── project
      │    ├── save-table-name: q10_project_3
      │    ├── columns: column46:46(float!null) c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:41(char!null)
      │    ├── immutable
      │    ├── stats: [rows=79341.61, distinct(1)=32163.1, null(1)=0, avgsize(1)=4, distinct(2)=45059.5, null(2)=0, avgsize(2)=20, distinct(3)=45057.1, null(3)=0, avgsize(3)=28, distinct(5)=45059.5, null(5)=0, avgsize(5)=17, distinct(6)=44685.4, null(6)=0, avgsize(6)=9, distinct(8)=45034, null(8)=0, avgsize(8)=75, distinct(41)=25, null(41)=0, avgsize(41)=10, distinct(46)=39820, null(46)=0, avgsize(46)=18]
      │    ├── fd: (1)-->(2,3,5,6,8,41)
      │    ├── inner-join (hash)
      │    │    ├── save-table-name: q10_inner_join_4
      │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_returnflag:30(char!null) n_nationkey:40(int!null) n_name:41(char!null)
      │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
      │    │    ├── stats: [rows=79341.61, distinct(1)=32163.1, null(1)=0, avgsize(1)=4, distinct(2)=45059.5, null(2)=0, avgsize(2)=20, distinct(3)=45057.1, null(3)=0, avgsize(3)=28, distinct(4)=25, null(4)=0, avgsize(4)=2, distinct(5)=45059.5, null(5)=0, avgsize(5)=17, distinct(6)=44685.4, null(6)=0, avgsize(6)=9, distinct(8)=45034, null(8)=0, avgsize(8)=75, distinct(11)=35816.5, null(11)=0, avgsize(11)=4, distinct(12)=32163.1, null(12)=0, avgsize(12)=4, distinct(15)=92, null(15)=0, avgsize(15)=4, distinct(22)=35816.5, null(22)=0, avgsize(22)=4, distinct(27)=39572.9, null(27)=0, avgsize(27)=9, distinct(28)=11, null(28)=0, avgsize(28)=9, distinct(30)=1, null(30)=0, avgsize(30)=3, distinct(40)=25, null(40)=0, avgsize(40)=1, distinct(41)=25, null(41)=0, avgsize(41)=10, distinct(27,28)=39820, null(27,28)=0, avgsize(27,28)=18]
      │    │    ├── fd: ()-->(30), (1)-->(2-6,8), (11)-->(12,15), (11)==(22), (22)==(11), (1)==(12), (12)==(1), (40)-->(41), (4)==(40), (40)==(4)
      │    │    ├── inner-join (hash)
      │    │    │    ├── save-table-name: q10_inner_join_5
      │    │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_returnflag:30(char!null)
      │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
      │    │    │    ├── stats: [rows=79341.61, distinct(1)=35939.8, null(1)=0, avgsize(1)=4, distinct(2)=61616.1, null(2)=0, avgsize(2)=20, distinct(3)=61609.9, null(3)=0, avgsize(3)=28, distinct(4)=25, null(4)=0, avgsize(4)=2, distinct(5)=61616.1, null(5)=0, avgsize(5)=17, distinct(6)=60636.4, null(6)=0, avgsize(6)=9, distinct(8)=61548.8, null(8)=0, avgsize(8)=75, distinct(11)=41870.4, null(11)=0, avgsize(11)=4, distinct(12)=35939.8, null(12)=0, avgsize(12)=4, distinct(15)=92, null(15)=0, avgsize(15)=4, distinct(22)=41870.4, null(22)=0, avgsize(22)=4, distinct(27)=48918.7, null(27)=0, avgsize(27)=9, distinct(28)=11, null(28)=0, avgsize(28)=9, distinct(30)=1, null(30)=0, avgsize(30)=3, distinct(27,28)=49422.8, null(27,28)=0, avgsize(27,28)=18]
      │    │    │    ├── fd: ()-->(30), (1)-->(2-6,8), (11)-->(12,15), (11)==(22), (22)==(11), (1)==(12), (12)==(1)
      │    │    │    ├── scan customer
      │    │    │    │    ├── save-table-name: q10_scan_6
      │    │    │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null)
      │    │    │    │    ├── stats: [rows=150000, distinct(1)=148813, null(1)=0, avgsize(1)=4, distinct(2)=150000, null(2)=0, avgsize(2)=20, distinct(3)=149937, null(3)=0, avgsize(3)=28, distinct(4)=25, null(4)=0, avgsize(4)=2, distinct(5)=150000, null(5)=0, avgsize(5)=17, distinct(6)=140628, null(6)=0, avgsize(6)=9, distinct(8)=149323, null(8)=0, avgsize(8)=75]
      │    │    │    │    │   histogram(1)=  0           0            0  5   745   5   746   5    711   5    780   5    738   5    835   5    697   5    757   5    704   5    696   5    753   5    678   5    813   5    873    5    736    5    840    5    703    5    745    5    710    5    763    5    742    5    673    5    702    5    793    5    732    5    752    5    707    5    751    5    722    5    814    5    789    5    671    5    643    5    706    5    723    5    757    5    713    5    760    5    766    5    711    5    858    5    702    5    695    5    697    5    823    5    857    5    712    5    808    5    754    5    739    5    694    5    782    5    792    5    751    5    758    5    749    5    798    5    685    5    692    5    792    5    710    5    771    5    724    5    853    5    713    5    823    5    772    5    656    5    763    5    672    5    735    5    810    5    786    5    709    5    731    5    702    5    708    5    669    5    733    5    744    5    758    5    800    5    682    5    716    5    716    5    729    5    778    5    721    5    766    5    820    5    757    5    739    5    799    5    780    5    710    5    749    5    754    5    750    5    699    5    821    5    759    5    818    5    763    5    854    5    779    5    810    5    783    5    686    5    703    5    776    5    675    5    812    5    745    5    759    5    793    5    751    5    761    5    798    5    794    5    729    5    696    5    699    5    831    5    709    5    747    5    722    5    768    5    729    5    702    5    729    5    698    5    767    5    792    5     726    5     737    5     671    5     721    5     842    5     701    5     704    5     708    5     726    5     695    5     665    5     688    5     653    5     690    5     734    5     789    5     659    5     785    5     733    5     740    5     826    5     745    5     929    5     899    5     743    5     790    5     825    5     779    5     677    5     697    5     756    5     693    5     862    5     772    5     783    5     757    5     799    5     778    5     752    5     715    5     709    5     790    5     789    5     865    5     808    5     772    5     743    5     751    5     742    5     676    5     684    5     744    5     709    5     679    5     817    5     755    5     754    5     797    5     709    5     748    5     679    5     751    5     775    5     736    5     790    5     714    5     0           0
      │    │    │    │    │                <--- -9223372036854775808 --- 59 ----- 811 ----- 1565 ----- 2252 ----- 3068 ----- 3807 ----- 4720 ----- 5381 ----- 6155 ----- 6829 ----- 7487 ----- 8254 ----- 8876 ----- 9751 ----- 10728 ----- 11463 ----- 12385 ----- 13057 ----- 13810 ----- 14495 ----- 15281 ----- 16028 ----- 16640 ----- 17311 ----- 18151 ----- 18880 ----- 19645 ----- 20325 ----- 21088 ----- 21798 ----- 22674 ----- 23507 ----- 24115 ----- 24661 ----- 25340 ----- 26052 ----- 26827 ----- 27518 ----- 28298 ----- 29089 ----- 29777 ----- 30730 ----- 31401 ----- 32057 ----- 32718 ----- 33611 ----- 34562 ----- 35251 ----- 36117 ----- 36887 ----- 37629 ----- 38283 ----- 39104 ----- 39942 ----- 40705 ----- 41481 ----- 42241 ----- 43089 ----- 43725 ----- 44376 ----- 45214 ----- 45899 ----- 46700 ----- 47413 ----- 48356 ----- 49047 ----- 49939 ----- 50742 ----- 51316 ----- 52101 ----- 52710 ----- 53444 ----- 54313 ----- 55140 ----- 55823 ----- 56549 ----- 57219 ----- 57901 ----- 58503 ----- 59234 ----- 59984 ----- 60760 ----- 61613 ----- 62243 ----- 62941 ----- 63638 ----- 64360 ----- 65173 ----- 65880 ----- 66672 ----- 67560 ----- 68334 ----- 69075 ----- 69925 ----- 70742 ----- 71428 ----- 72189 ----- 72958 ----- 73720 ----- 74385 ----- 75274 ----- 76053 ----- 76936 ----- 77721 ----- 78666 ----- 79480 ----- 80349 ----- 81171 ----- 81810 ----- 82482 ----- 83292 ----- 83907 ----- 84780 ----- 85532 ----- 86310 ----- 87149 ----- 87912 ----- 88694 ----- 89543 ----- 90384 ----- 91106 ----- 91764 ----- 92428 ----- 93335 ----- 94018 ----- 94775 ----- 95484 ----- 96279 ----- 97001 ----- 97672 ----- 98394 ----- 99056 ----- 99850 ----- 100688 ----- 101405 ----- 102143 ----- 102751 ----- 103459 ----- 104384 ----- 105052 ----- 105727 ----- 106409 ----- 107125 ----- 107782 ----- 108377 ----- 109020 ----- 109588 ----- 110235 ----- 110967 ----- 111800 ----- 112382 ----- 113196 ----- 113913 ----- 114643 ----- 115529 ----- 116268 ----- 117329 ----- 118341 ----- 119076 ----- 119898 ----- 120782 ----- 121584 ----- 122186 ----- 122830 ----- 123591 ----- 124227 ----- 125175 ----- 125964 ----- 126773 ----- 127535 ----- 128374 ----- 129175 ----- 129928 ----- 130609 ----- 131279 ----- 132102 ----- 132923 ----- 133877 ----- 134732 ----- 135521 ----- 136257 ----- 137007 ----- 137740 ----- 138341 ----- 138958 ----- 139695 ----- 140364 ----- 140971 ----- 141841 ----- 142600 ----- 143356 ----- 144192 ----- 144861 ----- 145607 ----- 146214 ----- 146965 ----- 147761 ----- 148483 ----- 149306 ----- 149986 --- 9223372036854775807
      │    │    │    │    │   histogram(2)=  0           1            1.5e+05           1
      │    │    │    │    │                <--- 'Customer#000000059' --------- 'Customer#000149986'
      │    │    │    │    │   histogram(3)=  0                 15                 1.4997e+05             15
      │    │    │    │    │                <--- '  BAEZWaPhKP6 rBk,WBsgRMjmelv7' ------------ 'zzxGktzXTMKS1BxZlgQ9nqQ'
      │    │    │    │    │   histogram(4)=  0 5475 0 5910 0 5925 0 6075 0 5910 0 5895 0 6765 0 6090 0 6000 0 6735 0 5730 0 6015 0 5895 0 6180 0 5565 0 5760 0 6390 0 6135 0 5940 0 6105 0 6150 0 5700 0 6225 0 6075 0 5355
      │    │    │    │    │                <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 ---- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │    │   histogram(5)=  0          1          1.5e+05          1
      │    │    │    │    │                <--- '10-100-106-1617' --------- '34-999-618-6881'
      │    │    │    │    │   histogram(6)=  0    15     1.4997e+05    15
      │    │    │    │    │                <--- -997.51 ------------ 9998.32
      │    │    │    │    │   histogram(8)=  0                                                15                                                1.4997e+05                                          15
      │    │    │    │    │                <--- ' Tiresias. carefully even accounts boost carefully quickly ironic requests. bold, ironic pin' ------------ 'zle carefully at the carefully final foxes. slyly ironic theodolites wake careful'
      │    │    │    │    ├── key: (1)
      │    │    │    │    └── fd: (1)-->(2-6,8)
      │    │    │    ├── inner-join (lookup lineitem)
      │    │    │    │    ├── save-table-name: q10_lookup_join_7
      │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_returnflag:30(char!null)
      │    │    │    │    ├── key columns: [11] = [22]
      │    │    │    │    ├── stats: [rows=78713.75, distinct(11)=54688.5, null(11)=0, avgsize(11)=4, distinct(12)=35939.8, null(12)=0, avgsize(12)=4, distinct(15)=92, null(15)=0, avgsize(15)=4, distinct(22)=54688.5, null(22)=0, avgsize(22)=4, distinct(27)=74852.1, null(27)=0, avgsize(27)=9, distinct(28)=11, null(28)=0, avgsize(28)=9, distinct(30)=1, null(30)=0, avgsize(30)=3, distinct(27,28)=76641.4, null(27,28)=0, avgsize(27,28)=18]
      │    │    │    │    ├── fd: ()-->(30), (11)-->(12,15), (11)==(22), (22)==(11)
      │    │    │    │    ├── index-join orders
      │    │    │    │    │    ├── save-table-name: q10_index_join_8
      │    │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null)
      │    │    │    │    │    ├── stats: [rows=54688.46, distinct(11)=54688.5, null(11)=0, avgsize(11)=4, distinct(12)=42696.7, null(12)=0, avgsize(12)=4, distinct(15)=92, null(15)=0, avgsize(15)=4]
      │    │    │    │    │    │   histogram(15)=  0       0        2350      750       6750      1350      7050      600       7050      300       7200      450       7050      600       6900      450       5307.7     530.77
      │    │    │    │    │    │                 <--- '1993-09-30' ------ '1993-10-05' ------ '1993-10-18' ------ '1993-10-31' ------ '1993-11-14' ------ '1993-11-25' ------ '1993-12-06' ------ '1993-12-20' -------- '1993-12-31'
      │    │    │    │    │    ├── key: (11)
      │    │    │    │    │    ├── fd: (11)-->(12,15)
      │    │    │    │    │    └── scan orders@o_od
      │    │    │    │    │         ├── save-table-name: q10_scan_9
      │    │    │    │    │         ├── columns: o_orderkey:11(int!null) o_orderdate:15(date!null)
      │    │    │    │    │         ├── constraint: /15/11: [/'1993-10-01' - /'1993-12-31']
      │    │    │    │    │         ├── stats: [rows=54688.46, distinct(11)=54688.5, null(11)=0, avgsize(11)=4, distinct(15)=92, null(15)=0, avgsize(15)=4]
      │    │    │    │    │         │   histogram(11)=  0           0            0 0.036458 270.05 0.036458 267.17 0.036458 282.52 0.036458 271.03 0.036458 292.76 0.036458 264.91 0.036458 271.25 0.036458 285.25 0.036458 274.42 0.036458 275.41 0.036458 270.78 0.036458 273.11 0.036458 276.94 0.036458 274.46 0.036458 278.58 0.036458 276.87 0.036458 269.25 0.036458 281.24 0.036458 270.16 0.036458 264.32 0.036458 274.13 0.036458 271.07 0.036458 276.21 0.036458 272.42 0.036458 266.26 0.036458 259.22 0.036458 278.8 0.036458 277.81 0.036458 276.35 0.036458 273.07 0.036458 270.16 0.036458 277.81 0.036458 284.59 0.036458  270.48 0.036458  271.8 0.036458  278.98 0.036458  270.08 0.036458  265.38 0.036458  269.9 0.036458  268.92 0.036458  268.92 0.036458  274.09 0.036458  278.07 0.036458  279.85 0.036458  272.38 0.036458  268.08 0.036458  277.01 0.036458  278.91 0.036458  273.8 0.036458  266.91 0.036458  265.71 0.036458  268.55 0.036458  269.14 0.036458  272.67 0.036458  274.42 0.036458  263.74 0.036458  279.89 0.036458  269.83 0.036458  282.19 0.036458  278.51 0.036458  274.02 0.036458  262.94 0.036458  263.67 0.036458  262.32 0.036458  262.06 0.036458  287.51 0.036458  268.33 0.036458  266.22 0.036458  273.22 0.036458  274.53 0.036458  275.59 0.036458  260.64 0.036458  271.18 0.036458  267.53 0.036458  266.15 0.036458  280.15 0.036458  270.92 0.036458  264.43 0.036458  271.29 0.036458  272.27 0.036458  280.55 0.036458  274.5 0.036458  271.32 0.036458  280.55 0.036458  282.12 0.036458  274.31 0.036458  269.83 0.036458  274.31 0.036458  280.77 0.036458  260.93 0.036458  268.08 0.036458  268.33 0.036458  267.42 0.036458  271.43 0.036458  283.17 0.036458  279.85 0.036458  273.88 0.036458  277.7 0.036458  266.47 0.036458  276.87 0.036458  266.04 0.036458  275.55 0.036458  270.41 0.036458  277.59 0.036458  270.59 0.036458  266.98 0.036458  276.54 0.036458  281.71 0.036458  273.29 0.036458  271.07 0.036458  267.53 0.036458  271.65 0.036458  276.25 0.036458  264.18 0.036458  278.03 0.036458  282.52 0.036458  270.45 0.036458  280.8 0.036458  271.18 0.036458  267.82 0.036458  274.09 0.036458  277.89 0.036458  268.33 0.036458  269.57 0.036458  278.29 0.036458  281.31 0.036458  275.59 0.036458  268.01 0.036458  275.55 0.036458  269.83 0.036458  266.07 0.036458  287.15 0.036458  268.52 0.036458  267.35 0.036458  271.94 0.036458  272.42 0.036458  275.81 0.036458  274.31 0.036458  265.09 0.036458  266.51 0.036458  270.48 0.036458  290.21 0.036458  269.17 0.036458  273.73 0.036458  274.35 0.036458  275.88 0.036458  280.95 0.036458  285.91 0.036458  272.85 0.036458  280.22 0.036458  277.3 0.036458  279.93 0.036458  278.83 0.036458  291.16 0.036458  286.56 0.036458  279.78 0.036458  281.93 0.036458  273.51 0.036458  273.4 0.036458  276.97 0.036458  276.1 0.036458  286.16 0.036458  275.92 0.036458  275.26 0.036458  273.22 0.036458  286.93 0.036458  273.77 0.036458  278.07 0.036458  283.46 0.036458  288.35 0.036458  273.51 0.036458  285.91 0.036458  275.01 0.036458  277.96 0.036458  274.31 0.036458  275.22 0.036458  290.87 0.036458  275.99 0.036458  288.64 0.036458  277.59 0.036458  287.44 0.036458  276.35 0.036458  294.47 0.036458  280.69 0.036458  278.4 0.036458  274.57 0.036458  274.02 0.036458  279.78 0.036458  283.72 0.036458  280.69 0.036458  272.82 0.036458  284.59 0.036458  283.46 0.036458  279.2 0.036458  279.13 0.036458  276.35 0.036458  273.69 0.036458  282.08 0.036458  276.54 0.036458  0           0
      │    │    │    │    │         │                 <--- -9223372036854775808 ---- 1505 --------- 29025 --------- 54400 --------- 91106 --------- 119366 -------- 163554 -------- 187236 -------- 215651 -------- 254373 -------- 285123 -------- 316614 -------- 344678 -------- 374465 -------- 407078 -------- 437861 -------- 471683 -------- 504230 -------- 531168 -------- 566951 -------- 594561 -------- 617825 -------- 648358 -------- 676640 -------- 708706 -------- 737986 -------- 762690 -------- 782081 ------- 816064 -------- 849318 -------- 881511 -------- 911271 -------- 938885 -------- 972135 -------- 1010370 -------- 1038212 ------- 1067041 -------- 1101158 -------- 1128704 -------- 1152742 ------- 1180165 -------- 1206852 -------- 1233537 -------- 1264064 -------- 1297504 -------- 1332260 -------- 1361504 -------- 1387553 -------- 1420224 -------- 1454275 ------- 1484580 -------- 1509766 -------- 1534050 -------- 1560452 -------- 1587299 -------- 1616771 -------- 1647526 -------- 1670343 -------- 1705121 -------- 1732486 -------- 1768967 -------- 1802725 -------- 1833189 -------- 1855398 -------- 1878146 -------- 1899877 -------- 1921414 -------- 1961765 -------- 1988000 -------- 2012672 -------- 2042529 -------- 2073381 -------- 2104999 -------- 2125477 -------- 2153825 -------- 2179462 -------- 2204065 -------- 2239044 -------- 2267205 -------- 2290530 -------- 2318977 -------- 2348134 -------- 2383399 ------- 2414215 -------- 2442695 -------- 2477955 -------- 2514372 -------- 2545062 -------- 2572418 -------- 2603108 -------- 2638534 -------- 2659232 -------- 2685286 -------- 2711527 -------- 2737088 -------- 2765639 -------- 2802818 -------- 2837570 -------- 2867911 ------- 2901088 -------- 2925954 -------- 2958501 -------- 2983042 -------- 3014626 -------- 3042406 -------- 3075489 -------- 3103425 -------- 3128673 -------- 3160994 -------- 3197125 -------- 3227043 -------- 3255328 -------- 3280965 -------- 3309669 -------- 3341767 -------- 3364898 -------- 3398305 -------- 3435008 -------- 3462818 ------- 3498272 -------- 3526631 -------- 3552485 -------- 3583014 -------- 3616322 -------- 3642566 -------- 3669732 -------- 3703330 -------- 3739170 -------- 3770791 -------- 3796804 -------- 3828387 -------- 3855751 -------- 3880321 -------- 3920422 -------- 3946818 -------- 3972322 -------- 4001250 -------- 4030533 -------- 4062306 -------- 4092992 -------- 4116803 -------- 4141697 -------- 4169536 -------- 4211878 -------- 4238753 -------- 4268994 -------- 4299686 -------- 4331525 -------- 4367079 -------- 4406277 -------- 4435878 -------- 4470914 ------- 4500294 -------- 4531617 -------- 4562114 -------- 4601666 -------- 4637856 -------- 4669060 -------- 4701861 -------- 4728416 ------- 4754881 -------- 4784001 ------- 4812482 -------- 4848389 -------- 4876741 -------- 4904612 -------- 4930945 -------- 4967397 -------- 4994146 -------- 5024099 -------- 5058023 -------- 5095527 -------- 5122081 -------- 5157798 -------- 5185472 -------- 5215332 -------- 5242497 -------- 5270338 -------- 5309699 -------- 5338112 -------- 5375843 -------- 5405441 -------- 5442277 -------- 5470945 -------- 5512930 -------- 5544807 ------- 5574980 -------- 5602340 -------- 5629280 -------- 5660482 -------- 5694599 -------- 5726466 -------- 5752519 -------- 5787268 -------- 5821185 ------- 5851973 -------- 5882689 -------- 5911363 -------- 5938052 -------- 5970949 -------- 5999748 --- 9223372036854775807
      │    │    │    │    │         │   histogram(15)=  0       0        2350      750       6750      1350      7050      600       7050      300       7200      450       7050      600       6900      450       5307.7     530.77
      │    │    │    │    │         │                 <--- '1993-09-30' ------ '1993-10-05' ------ '1993-10-18' ------ '1993-10-31' ------ '1993-11-14' ------ '1993-11-25' ------ '1993-12-06' ------ '1993-12-20' -------- '1993-12-31'
      │    │    │    │    │         ├── key: (11)
      │    │    │    │    │         └── fd: (11)-->(15)
      │    │    │    │    └── filters
      │    │    │    │         └── l_returnflag:30 = 'R' [type=bool, outer=(30), constraints=(/30: [/'R' - /'R']; tight), fd=()-->(30)]
      │    │    │    └── filters
      │    │    │         └── c_custkey:1 = o_custkey:12 [type=bool, outer=(1,12), constraints=(/1: (/NULL - ]; /12: (/NULL - ]), fd=(1)==(12), (12)==(1)]
      │    │    ├── scan nation
      │    │    │    ├── save-table-name: q10_scan_10
      │    │    │    ├── columns: n_nationkey:40(int!null) n_name:41(char!null)
      │    │    │    ├── stats: [rows=25, distinct(40)=25, null(40)=0, avgsize(40)=1, distinct(41)=25, null(41)=0, avgsize(41)=10]
      │    │    │    │   histogram(40)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
      │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
      │    │    │    │   histogram(41)=  0      1      23      1
      │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
      │    │    │    ├── key: (40)
      │    │    │    └── fd: (40)-->(41)
      │    │    └── filters
      │    │         └── c_nationkey:4 = n_nationkey:40 [type=bool, outer=(4,40), constraints=(/4: (/NULL - ]; /40: (/NULL - ]), fd=(4)==(40), (40)==(4)]
      │    └── projections
      │         └── l_extendedprice:27 * (1.0 - l_discount:28) [as=column46:46, type=float, outer=(27,28), immutable]
      └── aggregations
           ├── sum [as=sum:47, type=float, outer=(46)]
           │    └── column46:46 [type=float]
           ├── const-agg [as=c_name:2, type=varchar, outer=(2)]
           │    └── c_name:2 [type=varchar]
           ├── const-agg [as=c_address:3, type=varchar, outer=(3)]
           │    └── c_address:3 [type=varchar]
           ├── const-agg [as=c_phone:5, type=char, outer=(5)]
           │    └── c_phone:5 [type=char]
           ├── const-agg [as=c_acctbal:6, type=float, outer=(6)]
           │    └── c_acctbal:6 [type=float]
           ├── const-agg [as=c_comment:8, type=varchar, outer=(8)]
           │    └── c_comment:8 [type=varchar]
           └── const-agg [as=n_name:41, type=char, outer=(41)]
                └── n_name:41 [type=char]

----Stats for q10_top_k_1----
column_names  row_count  distinct_count  null_count
{c_acctbal}   20         20              0
{c_address}   20         20              0
{c_comment}   20         20              0
{c_custkey}   20         20              0
{c_name}      20         20              0
{c_phone}     20         20              0
{n_name}      20         13              0
{revenue}     20         20              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   20.00          1.00           20.00               1.00                0.00            1.00
{c_address}   20.00          1.00           20.00               1.00                0.00            1.00
{c_comment}   20.00          1.00           20.00               1.00                0.00            1.00
{c_custkey}   20.00          1.00           20.00               1.00                0.00            1.00
{c_name}      20.00          1.00           20.00               1.00                0.00            1.00
{c_phone}     20.00          1.00           20.00               1.00                0.00            1.00
{n_name}      20.00          1.00           20.00               1.54                0.00            1.00
{revenue}     20.00          1.00           20.00               1.00                0.00            1.00

----Stats for q10_group_by_2----
column_names  row_count  distinct_count  null_count
{c_acctbal}   37967      37658           0
{c_address}   37967      37967           0
{c_comment}   37967      37967           0
{c_custkey}   37967      37904           0
{c_name}      37967      37859           0
{c_phone}     37967      37967           0
{n_name}      37967      25              0
{sum}         37967      37685           0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   32163.00       1.18           32163.00            1.17                0.00            1.00
{c_address}   32163.00       1.18           32163.00            1.18                0.00            1.00
{c_comment}   32163.00       1.18           32163.00            1.18                0.00            1.00
{c_custkey}   32163.00       1.18           32163.00            1.18                0.00            1.00
{c_name}      32163.00       1.18           32163.00            1.18                0.00            1.00
{c_phone}     32163.00       1.18           32163.00            1.18                0.00            1.00
{n_name}      32163.00       1.18           32163.00            1286.52 <==         0.00            1.00
{sum}         32163.00       1.18           32163.00            1.17                0.00            1.00

----Stats for q10_project_3----
column_names  row_count  distinct_count  null_count
{c_acctbal}   114705     37658           0
{c_address}   114705     38065           0
{c_comment}   114705     38086           0
{c_custkey}   114705     37904           0
{c_name}      114705     37859           0
{c_phone}     114705     38026           0
{column46}    114705     114608          0
{n_name}      114705     25              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   79342.00       1.45           44685.00            1.19                0.00            1.00
{c_address}   79342.00       1.45           45057.00            1.18                0.00            1.00
{c_comment}   79342.00       1.45           45034.00            1.18                0.00            1.00
{c_custkey}   79342.00       1.45           32163.00            1.18                0.00            1.00
{c_name}      79342.00       1.45           45060.00            1.19                0.00            1.00
{c_phone}     79342.00       1.45           45060.00            1.18                0.00            1.00
{column46}    79342.00       1.45           39820.00            2.88 <==            0.00            1.00
{n_name}      79342.00       1.45           25.00               1.00                0.00            1.00

----Stats for q10_inner_join_4----
column_names       row_count  distinct_count  null_count
{c_acctbal}        114705     37658           0
{c_address}        114705     38065           0
{c_comment}        114705     38086           0
{c_custkey}        114705     37904           0
{c_name}           114705     37859           0
{c_nationkey}      114705     25              0
{c_phone}          114705     38026           0
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{n_name}           114705     25              0
{n_nationkey}      114705     25              0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}        79342.00       1.45           44685.00            1.19                0.00            1.00
{c_address}        79342.00       1.45           45057.00            1.18                0.00            1.00
{c_comment}        79342.00       1.45           45034.00            1.18                0.00            1.00
{c_custkey}        79342.00       1.45           32163.00            1.18                0.00            1.00
{c_name}           79342.00       1.45           45060.00            1.19                0.00            1.00
{c_nationkey}      79342.00       1.45           25.00               1.00                0.00            1.00
{c_phone}          79342.00       1.45           45060.00            1.18                0.00            1.00
{l_discount}       79342.00       1.45           11.00               1.00                0.00            1.00
{l_extendedprice}  79342.00       1.45           39573.00            2.68 <==            0.00            1.00
{l_orderkey}       79342.00       1.45           35816.00            1.35                0.00            1.00
{l_returnflag}     79342.00       1.45           1.00                1.00                0.00            1.00
{n_name}           79342.00       1.45           25.00               1.00                0.00            1.00
{n_nationkey}      79342.00       1.45           25.00               1.00                0.00            1.00
{o_custkey}        79342.00       1.45           32163.00            1.18                0.00            1.00
{o_orderdate}      79342.00       1.45           92.00               1.00                0.00            1.00
{o_orderkey}       79342.00       1.45           35816.00            1.35                0.00            1.00

----Stats for q10_inner_join_5----
column_names       row_count  distinct_count  null_count
{c_acctbal}        114705     37658           0
{c_address}        114705     38065           0
{c_comment}        114705     38086           0
{c_custkey}        114705     37904           0
{c_name}           114705     37859           0
{c_nationkey}      114705     25              0
{c_phone}          114705     38026           0
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}        79342.00       1.45           60636.00            1.61                0.00            1.00
{c_address}        79342.00       1.45           61610.00            1.62                0.00            1.00
{c_comment}        79342.00       1.45           61549.00            1.62                0.00            1.00
{c_custkey}        79342.00       1.45           35940.00            1.05                0.00            1.00
{c_name}           79342.00       1.45           61616.00            1.63                0.00            1.00
{c_nationkey}      79342.00       1.45           25.00               1.00                0.00            1.00
{c_phone}          79342.00       1.45           61616.00            1.62                0.00            1.00
{l_discount}       79342.00       1.45           11.00               1.00                0.00            1.00
{l_extendedprice}  79342.00       1.45           48919.00            2.17 <==            0.00            1.00
{l_orderkey}       79342.00       1.45           41870.00            1.16                0.00            1.00
{l_returnflag}     79342.00       1.45           1.00                1.00                0.00            1.00
{o_custkey}        79342.00       1.45           35940.00            1.05                0.00            1.00
{o_orderdate}      79342.00       1.45           92.00               1.00                0.00            1.00
{o_orderkey}       79342.00       1.45           41870.00            1.16                0.00            1.00

----Stats for q10_scan_6----
column_names   row_count  distinct_count  null_count
{c_acctbal}    150000     140628          0
{c_address}    150000     149937          0
{c_comment}    150000     149323          0
{c_custkey}    150000     148813          0
{c_name}       150000     150000          0
{c_nationkey}  150000     25              0
{c_phone}      150000     150000          0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}    150000.00      1.00           140628.00           1.00                0.00            1.00
{c_address}    150000.00      1.00           149937.00           1.00                0.00            1.00
{c_comment}    150000.00      1.00           149323.00           1.00                0.00            1.00
{c_custkey}    150000.00      1.00           148813.00           1.00                0.00            1.00
{c_name}       150000.00      1.00           150000.00           1.00                0.00            1.00
{c_nationkey}  150000.00      1.00           25.00               1.00                0.00            1.00
{c_phone}      150000.00      1.00           150000.00           1.00                0.00            1.00

----Stats for q10_lookup_join_7----
column_names       row_count  distinct_count  null_count
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       78714.00       1.46           11.00               1.00                0.00            1.00
{l_extendedprice}  78714.00       1.46           74852.00            1.42                0.00            1.00
{l_orderkey}       78714.00       1.46           54688.00            1.13                0.00            1.00
{l_returnflag}     78714.00       1.46           1.00                1.00                0.00            1.00
{o_custkey}        78714.00       1.46           35940.00            1.05                0.00            1.00
{o_orderdate}      78714.00       1.46           92.00               1.00                0.00            1.00
{o_orderkey}       78714.00       1.46           54688.00            1.13                0.00            1.00

----Stats for q10_index_join_8----
column_names   row_count  distinct_count  null_count
{o_custkey}    57069      42598           0
{o_orderdate}  57069      92              0
{o_orderkey}   57069      56240           0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}    54688.00       1.04           42697.00            1.00                0.00            1.00
{o_orderdate}  54688.00       1.04           92.00               1.00                0.00            1.00
{o_orderkey}   54688.00       1.04           54688.00            1.03                0.00            1.00

----Stats for q10_scan_9----
column_names   row_count  distinct_count  null_count
{o_orderdate}  57069      92              0
{o_orderkey}   57069      56240           0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_orderdate}  54688.00       1.04           92.00               1.00                0.00            1.00
{o_orderkey}   54688.00       1.04           54688.00            1.03                0.00            1.00

----Stats for q10_scan_10----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
----
----
