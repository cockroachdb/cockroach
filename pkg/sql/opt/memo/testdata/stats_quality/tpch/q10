import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q10
# Returned Item Reporting
# Identifies customers who might be having problems with the parts that are
# shipped to them.
#
# Finds the top 20 customers, in terms of their effect on lost revenue for a
# given quarter, who have returned parts. The query considers only parts that
# were ordered in the specified quarter. The query lists the customer's name,
# address, nation, phone number, account balance, comment information and
# revenue lost. The customers are listed in descending order of lost revenue.
# Revenue lost is defined as sum(l_extendedprice*(1-l_discount)) for all
# qualifying lineitems.
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q10
SELECT
    c_custkey,
    c_name,
    sum(l_extendedprice * (1 - l_discount)) AS revenue,
    c_acctbal,
    n_name,
    c_address,
    c_phone,
    c_comment
FROM
    customer,
    orders,
    lineitem,
    nation
WHERE
    c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND o_orderDATE >= DATE '1993-10-01'
    AND o_orderDATE < DATE '1993-10-01' + INTERVAL '3' MONTH
    AND l_returnflag = 'R'
    AND c_nationkey = n_nationkey
GROUP BY
    c_custkey,
    c_name,
    c_acctbal,
    c_phone,
    n_name,
    c_address,
    c_comment
ORDER BY
    revenue DESC
LIMIT 20;
----
----
limit
 ├── save-table-name: q10_limit_1
 ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) revenue:47(float!null) c_acctbal:6(float!null) n_name:41(char!null) c_address:3(varchar!null) c_phone:5(char!null) c_comment:8(varchar!null)
 ├── internal-ordering: -47
 ├── cardinality: [0 - 20]
 ├── immutable
 ├── stats: [rows=20, distinct(1)=20, null(1)=0, distinct(2)=20, null(2)=0, distinct(3)=20, null(3)=0, distinct(5)=20, null(5)=0, distinct(6)=20, null(6)=0, distinct(8)=20, null(8)=0, distinct(41)=20, null(41)=0, distinct(47)=20, null(47)=0]
 ├── key: (1)
 ├── fd: (1)-->(2,3,5,6,8,41,47)
 ├── ordering: -47
 ├── sort
 │    ├── save-table-name: q10_sort_2
 │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:41(char!null) sum:47(float!null)
 │    ├── immutable
 │    ├── stats: [rows=33172.4448, distinct(1)=33172.4448, null(1)=0, distinct(2)=33172.4448, null(2)=0, distinct(3)=33172.4448, null(3)=0, distinct(5)=33172.4448, null(5)=0, distinct(6)=33172.4448, null(6)=0, distinct(8)=33172.4448, null(8)=0, distinct(41)=33172.4448, null(41)=0, distinct(47)=33172.4448, null(47)=0]
 │    ├── key: (1)
 │    ├── fd: (1)-->(2,3,5,6,8,41,47)
 │    ├── ordering: -47
 │    ├── limit hint: 20.00
 │    └── group-by
 │         ├── save-table-name: q10_group_by_3
 │         ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:41(char!null) sum:47(float!null)
 │         ├── grouping columns: c_custkey:1(int!null)
 │         ├── immutable
 │         ├── stats: [rows=33172.4448, distinct(1)=33172.4448, null(1)=0, distinct(2)=33172.4448, null(2)=0, distinct(3)=33172.4448, null(3)=0, distinct(5)=33172.4448, null(5)=0, distinct(6)=33172.4448, null(6)=0, distinct(8)=33172.4448, null(8)=0, distinct(41)=33172.4448, null(41)=0, distinct(47)=33172.4448, null(47)=0]
 │         ├── key: (1)
 │         ├── fd: (1)-->(2,3,5,6,8,41,47)
 │         ├── project
 │         │    ├── save-table-name: q10_project_4
 │         │    ├── columns: column46:46(float!null) c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:41(char!null)
 │         │    ├── immutable
 │         │    ├── stats: [rows=82076.3181, distinct(1)=33172.4448, null(1)=0, distinct(2)=46412.2874, null(2)=0, distinct(3)=46409.7632, null(3)=0, distinct(5)=46412.2874, null(5)=0, distinct(6)=46012.5171, null(6)=0, distinct(8)=46385.053, null(8)=0, distinct(41)=25, null(41)=0, distinct(46)=41180.4573, null(46)=0]
 │         │    ├── fd: (1)-->(2,3,5,6,8,41)
 │         │    ├── inner-join (hash)
 │         │    │    ├── save-table-name: q10_inner_join_5
 │         │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_returnflag:30(char!null) n_nationkey:40(int!null) n_name:41(char!null)
 │         │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
 │         │    │    ├── stats: [rows=82076.3181, distinct(1)=33172.4448, null(1)=0, distinct(2)=46412.2874, null(2)=0, distinct(3)=46409.7632, null(3)=0, distinct(4)=25, null(4)=0, distinct(5)=46412.2874, null(5)=0, distinct(6)=46012.5171, null(6)=0, distinct(8)=46385.053, null(8)=0, distinct(11)=37088.4198, null(11)=0, distinct(12)=33172.4448, null(12)=0, distinct(15)=92, null(15)=0, distinct(22)=37088.4198, null(22)=0, distinct(27)=40916.4266, null(27)=0, distinct(28)=11, null(28)=0, distinct(30)=1, null(30)=0, distinct(40)=25, null(40)=0, distinct(41)=25, null(41)=0, distinct(27,28)=41180.4573, null(27,28)=0]
 │         │    │    ├── fd: ()-->(30), (1)-->(2-6,8), (11)-->(12,15), (11)==(22), (22)==(11), (1)==(12), (12)==(1), (40)-->(41), (4)==(40), (40)==(4)
 │         │    │    ├── inner-join (hash)
 │         │    │    │    ├── save-table-name: q10_inner_join_6
 │         │    │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_returnflag:30(char!null)
 │         │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
 │         │    │    │    ├── stats: [rows=82076.3181, distinct(1)=37028.0412, null(1)=0, distinct(2)=63212.8993, null(2)=0, distinct(3)=63206.2925, null(3)=0, distinct(4)=25, null(4)=0, distinct(5)=63212.8993, null(5)=0, distinct(6)=62176.9567, null(6)=0, distinct(8)=63141.6616, null(8)=0, distinct(11)=43378.6208, null(11)=0, distinct(12)=37028.0412, null(12)=0, distinct(15)=92, null(15)=0, distinct(22)=43378.6208, null(22)=0, distinct(27)=50563.2192, null(27)=0, distinct(28)=11, null(28)=0, distinct(30)=1, null(30)=0, distinct(27,28)=51101.6377, null(27,28)=0]
 │         │    │    │    ├── fd: ()-->(30), (1)-->(2-6,8), (11)-->(12,15), (11)==(22), (22)==(11), (1)==(12), (12)==(1)
 │         │    │    │    ├── scan customer
 │         │    │    │    │    ├── save-table-name: q10_scan_7
 │         │    │    │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null)
 │         │    │    │    │    ├── stats: [rows=150000, distinct(1)=148813, null(1)=0, distinct(2)=150000, null(2)=0, distinct(3)=149937, null(3)=0, distinct(4)=25, null(4)=0, distinct(5)=150000, null(5)=0, distinct(6)=140628, null(6)=0, distinct(8)=149323, null(8)=0]
 │         │    │    │    │    │   histogram(1)=  0 15  735  15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15
 │         │    │    │    │    │                <--- 1 ----- 678 ----- 1399 ----- 2177 ----- 2911 ----- 3572 ----- 4383 ----- 5241 ----- 5963 ----- 6700 ----- 7514 ----- 8344 ----- 9262 ----- 10104 ----- 10682 ----- 11364 ----- 12228 ----- 13177 ----- 13867 ----- 14583 ----- 15392 ----- 16096 ----- 16929 ----- 17806 ----- 18523 ----- 19324 ----- 20101 ----- 20834 ----- 21481 ----- 22224 ----- 22897 ----- 23567 ----- 24127 ----- 24922 ----- 25671 ----- 26462 ----- 27283 ----- 28113 ----- 29030 ----- 29757 ----- 30510 ----- 31314 ----- 32132 ----- 32680 ----- 33455 ----- 34261 ----- 34980 ----- 35774 ----- 36466 ----- 37134 ----- 37753 ----- 38356 ----- 39098 ----- 39899 ----- 40801 ----- 41530 ----- 42349 ----- 43109 ----- 43777 ----- 44565 ----- 45327 ----- 46082 ----- 46847 ----- 47502 ----- 48096 ----- 48800 ----- 49720 ----- 50395 ----- 51207 ----- 51923 ----- 52628 ----- 53503 ----- 54317 ----- 54913 ----- 55581 ----- 56301 ----- 57027 ----- 57998 ----- 58543 ----- 59210 ----- 59952 ----- 60898 ----- 61636 ----- 62298 ----- 63222 ----- 64020 ----- 64628 ----- 65392 ----- 66121 ----- 66723 ----- 67433 ----- 68143 ----- 69022 ----- 69788 ----- 70674 ----- 71340 ----- 72161 ----- 72916 ----- 73561 ----- 74205 ----- 74835 ----- 75597 ----- 76228 ----- 76938 ----- 77562 ----- 78167 ----- 79086 ----- 79799 ----- 80542 ----- 81131 ----- 81884 ----- 82434 ----- 83129 ----- 83845 ----- 84613 ----- 85415 ----- 86299 ----- 87176 ----- 87819 ----- 88666 ----- 89473 ----- 90086 ----- 90772 ----- 91425 ----- 92283 ----- 93145 ----- 93792 ----- 94518 ----- 95307 ----- 96022 ----- 96756 ----- 97509 ----- 98329 ----- 98995 ----- 99642 ----- 100371 ----- 100968 ----- 101625 ----- 102360 ----- 103082 ----- 103924 ----- 104743 ----- 105637 ----- 106457 ----- 107406 ----- 108239 ----- 108939 ----- 109660 ----- 110707 ----- 111410 ----- 112088 ----- 112798 ----- 113545 ----- 114386 ----- 115217 ----- 116078 ----- 116981 ----- 117633 ----- 118389 ----- 119372 ----- 120184 ----- 121112 ----- 121890 ----- 122519 ----- 123317 ----- 124065 ----- 124931 ----- 125675 ----- 126329 ----- 127204 ----- 127838 ----- 128541 ----- 129280 ----- 130005 ----- 130776 ----- 131531 ----- 132367 ----- 133306 ----- 133892 ----- 134638 ----- 135458 ----- 136117 ----- 136915 ----- 137541 ----- 138481 ----- 139129 ----- 139859 ----- 140804 ----- 141608 ----- 142370 ----- 143284 ----- 143910 ----- 144465 ----- 145200 ----- 146007 ----- 146764 ----- 147489 ----- 148465 ----- 149291 ----- 149999
 │         │    │    │    │    │   histogram(2)=  0           15           1.4997e+05           15
 │         │    │    │    │    │                <--- 'Customer#000000001' ------------ 'Customer#000149999'
 │         │    │    │    │    │   histogram(3)=  0                   15                   1.4997e+05             15
 │         │    │    │    │    │                <--- '  65SEnG0td8cYs26YW8g6UDTF4oFVmzHn' ------------ 'zzxGktzXTMKS1BxZlgQ9nqQ'
 │         │    │    │    │    │   histogram(4)=  0 6135 0 6285 0 6330 0 5940 0 6285 0 6000 0 5355 0 5790 0 6150 0 6015 0 5880 0 6255 0 5670 0 6930 0 5775 0 5955 0 6045 0 6030 0 6045 0 5820 0 6180 0 6000 0 5865 0 5880 0 5385
 │         │    │    │    │    │                <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 ---- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
 │         │    │    │    │    │   histogram(5)=  0         15          1.4997e+05         15
 │         │    │    │    │    │                <--- '10-100-106-1617' ------------ '34-999-404-9770'
 │         │    │    │    │    │   histogram(6)=  0    15     1.4997e+05    15
 │         │    │    │    │    │                <--- -999.99 ------------ 9999.96
 │         │    │    │    │    │   histogram(8)=  0                 15                 1.4997e+05                                   15
 │         │    │    │    │    │                <--- ' Tiresias use carefully. entic' ------------ 'zle carefully. furiously pending packages use carefully along the '
 │         │    │    │    │    ├── key: (1)
 │         │    │    │    │    └── fd: (1)-->(2-6,8)
 │         │    │    │    ├── inner-join (lookup lineitem)
 │         │    │    │    │    ├── save-table-name: q10_lookup_join_8
 │         │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_returnflag:30(char!null)
 │         │    │    │    │    ├── key columns: [11] = [22]
 │         │    │    │    │    ├── stats: [rows=81426.8208, distinct(11)=56726.5385, null(11)=0, distinct(12)=37028.0412, null(12)=0, distinct(15)=92, null(15)=0, distinct(22)=56726.5385, null(22)=0, distinct(27)=77287.0368, null(27)=0, distinct(28)=11, null(28)=0, distinct(30)=1, null(30)=0, distinct(27,28)=79194.3703, null(27,28)=0]
 │         │    │    │    │    ├── fd: ()-->(30), (11)-->(12,15), (11)==(22), (22)==(11)
 │         │    │    │    │    ├── index-join orders
 │         │    │    │    │    │    ├── save-table-name: q10_index_join_9
 │         │    │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null)
 │         │    │    │    │    │    ├── stats: [rows=56726.5385, distinct(11)=56726.5385, null(11)=0, distinct(12)=43895.519, null(12)=0, distinct(15)=92, null(15)=0]
 │         │    │    │    │    │    │   histogram(15)=  0       0        4061.5      900       6600      1050      6900      1500      7050      600       6750      1350      7050      900       6900      600       3870      645
 │         │    │    │    │    │    │                 <--- '1993-09-30' -------- '1993-10-09' ------ '1993-10-21' ------ '1993-11-03' ------ '1993-11-16' ------ '1993-11-28' ------ '1993-12-11' ------ '1993-12-24' ------ '1993-12-31'
 │         │    │    │    │    │    ├── key: (11)
 │         │    │    │    │    │    ├── fd: (11)-->(12,15)
 │         │    │    │    │    │    └── scan orders@o_od
 │         │    │    │    │    │         ├── save-table-name: q10_scan_10
 │         │    │    │    │    │         ├── columns: o_orderkey:11(int!null) o_orderdate:15(date!null)
 │         │    │    │    │    │         ├── constraint: /15/11: [/'1993-10-01' - /'1993-12-31']
 │         │    │    │    │    │         ├── stats: [rows=56726.5385, distinct(11)=56726.5385, null(11)=0, distinct(15)=92, null(15)=0]
 │         │    │    │    │    │         │   histogram(11)=  0 5.6727 277.96 5.6727  277.96 5.6727  277.96 5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727  277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   277.96  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727   283.63  5.6727
 │         │    │    │    │    │         │                 <--- 1798 -------- 34818 -------- 60035 -------- 85447 -------- 110436 -------- 140133 -------- 176546 -------- 205254 -------- 232320 -------- 255841 -------- 285283 -------- 314534 -------- 348485 -------- 383777 -------- 411974 -------- 441189 -------- 475653 -------- 513921 -------- 545927 -------- 580354 -------- 608481 -------- 635717 -------- 664416 -------- 701571 -------- 728865 -------- 758849 -------- 785826 -------- 811910 -------- 837892 -------- 863297 -------- 890883 -------- 928609 -------- 958881 -------- 987460 -------- 1014243 -------- 1039939 -------- 1065281 -------- 1095524 -------- 1124835 -------- 1150822 -------- 1175363 -------- 1205153 -------- 1240487 -------- 1277152 -------- 1302848 -------- 1333542 -------- 1369505 -------- 1392032 -------- 1417376 -------- 1446084 -------- 1479713 -------- 1510310 -------- 1542404 -------- 1575269 -------- 1601697 -------- 1632966 -------- 1663143 -------- 1691715 -------- 1726470 -------- 1749605 -------- 1785254 -------- 1808775 -------- 1834150 -------- 1867814 -------- 1895911 -------- 1925989 -------- 1961186 -------- 1986211 -------- 2015079 -------- 2042850 -------- 2077824 -------- 2105985 -------- 2136355 -------- 2166469 -------- 2204545 -------- 2232582 -------- 2265858 -------- 2296513 -------- 2318339 -------- 2347335 -------- 2378500 -------- 2415107 -------- 2438466 -------- 2470179 -------- 2499428 -------- 2524900 -------- 2551555 -------- 2581635 -------- 2606691 -------- 2638342 -------- 2667748 -------- 2698213 -------- 2723649 -------- 2752481 -------- 2788743 -------- 2826436 -------- 2861958 -------- 2894561 -------- 2921888 -------- 2959847 -------- 2994080 -------- 3020545 -------- 3052897 -------- 3082913 -------- 3110882 -------- 3139590 -------- 3163617 -------- 3194565 -------- 3225603 -------- 3255297 -------- 3277735 -------- 3302049 -------- 3329542 -------- 3355270 -------- 3382595 -------- 3413763 -------- 3447334 -------- 3480548 -------- 3513281 -------- 3537412 -------- 3564582 -------- 3591584 -------- 3621796 -------- 3655300 -------- 3690048 -------- 3718432 -------- 3753699 -------- 3786272 -------- 3812423 -------- 3839750 -------- 3864163 -------- 3897538 -------- 3925410 -------- 3954662 -------- 3989540 -------- 4016260 -------- 4042469 -------- 4077058 -------- 4104035 -------- 4142149 -------- 4168481 -------- 4210498 -------- 4246883 -------- 4282432 -------- 4316738 -------- 4345286 -------- 4379076 -------- 4408256 -------- 4435559 -------- 4467232 -------- 4500807 -------- 4531301 -------- 4571298 -------- 4602052 -------- 4633218 -------- 4667524 -------- 4701856 -------- 4730690 -------- 4759105 -------- 4794535 -------- 4824256 -------- 4863490 -------- 4904513 -------- 4937191 -------- 4965060 -------- 4990145 -------- 5025287 -------- 5053670 -------- 5082465 -------- 5113761 -------- 5143232 -------- 5170595 -------- 5205155 -------- 5239492 -------- 5269346 -------- 5298279 -------- 5333060 -------- 5362311 -------- 5390500 -------- 5414816 -------- 5445958 -------- 5471557 -------- 5505380 -------- 5534242 -------- 5564999 -------- 5591718 -------- 5623556 -------- 5648356 -------- 5674567 -------- 5698208 -------- 5727555 -------- 5762662 -------- 5796934 -------- 5820742 -------- 5843814 -------- 5870785 -------- 5901286 -------- 5931648 -------- 5964738 -------- 5999491
 │         │    │    │    │    │         │   histogram(15)=  0       0        4061.5      900       6600      1050      6900      1500      7050      600       6750      1350      7050      900       6900      600       3870      645
 │         │    │    │    │    │         │                 <--- '1993-09-30' -------- '1993-10-09' ------ '1993-10-21' ------ '1993-11-03' ------ '1993-11-16' ------ '1993-11-28' ------ '1993-12-11' ------ '1993-12-24' ------ '1993-12-31'
 │         │    │    │    │    │         ├── key: (11)
 │         │    │    │    │    │         └── fd: (11)-->(15)
 │         │    │    │    │    └── filters
 │         │    │    │    │         └── l_returnflag:30 = 'R' [type=bool, outer=(30), constraints=(/30: [/'R' - /'R']; tight), fd=()-->(30)]
 │         │    │    │    └── filters
 │         │    │    │         └── c_custkey:1 = o_custkey:12 [type=bool, outer=(1,12), constraints=(/1: (/NULL - ]; /12: (/NULL - ]), fd=(1)==(12), (12)==(1)]
 │         │    │    ├── scan nation
 │         │    │    │    ├── save-table-name: q10_scan_11
 │         │    │    │    ├── columns: n_nationkey:40(int!null) n_name:41(char!null)
 │         │    │    │    ├── stats: [rows=25, distinct(40)=25, null(40)=0, distinct(41)=25, null(41)=0]
 │         │    │    │    │   histogram(40)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
 │         │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
 │         │    │    │    │   histogram(41)=  0      1      23      1
 │         │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
 │         │    │    │    ├── key: (40)
 │         │    │    │    └── fd: (40)-->(41)
 │         │    │    └── filters
 │         │    │         └── c_nationkey:4 = n_nationkey:40 [type=bool, outer=(4,40), constraints=(/4: (/NULL - ]; /40: (/NULL - ]), fd=(4)==(40), (40)==(4)]
 │         │    └── projections
 │         │         └── l_extendedprice:27 * (1.0 - l_discount:28) [as=column46:46, type=float, outer=(27,28), immutable]
 │         └── aggregations
 │              ├── sum [as=sum:47, type=float, outer=(46)]
 │              │    └── column46:46 [type=float]
 │              ├── const-agg [as=c_name:2, type=varchar, outer=(2)]
 │              │    └── c_name:2 [type=varchar]
 │              ├── const-agg [as=c_address:3, type=varchar, outer=(3)]
 │              │    └── c_address:3 [type=varchar]
 │              ├── const-agg [as=c_phone:5, type=char, outer=(5)]
 │              │    └── c_phone:5 [type=char]
 │              ├── const-agg [as=c_acctbal:6, type=float, outer=(6)]
 │              │    └── c_acctbal:6 [type=float]
 │              ├── const-agg [as=c_comment:8, type=varchar, outer=(8)]
 │              │    └── c_comment:8 [type=varchar]
 │              └── const-agg [as=n_name:41, type=char, outer=(41)]
 │                   └── n_name:41 [type=char]
 └── 20 [type=int]

----Stats for q10_limit_1----
column_names  row_count  distinct_count  null_count
{c_acctbal}   20         20              0
{c_address}   20         20              0
{c_comment}   20         20              0
{c_custkey}   20         20              0
{c_name}      20         20              0
{c_phone}     20         20              0
{n_name}      20         13              0
{revenue}     20         20              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   20.00          1.00           20.00               1.00                0.00            1.00
{c_address}   20.00          1.00           20.00               1.00                0.00            1.00
{c_comment}   20.00          1.00           20.00               1.00                0.00            1.00
{c_custkey}   20.00          1.00           20.00               1.00                0.00            1.00
{c_name}      20.00          1.00           20.00               1.00                0.00            1.00
{c_phone}     20.00          1.00           20.00               1.00                0.00            1.00
{n_name}      20.00          1.00           20.00               1.54                0.00            1.00
{revenue}     20.00          1.00           20.00               1.00                0.00            1.00

----Stats for q10_sort_2----
column_names  row_count  distinct_count  null_count
{c_acctbal}   0          0               0
{c_address}   0          0               0
{c_comment}   0          0               0
{c_custkey}   0          0               0
{c_name}      0          0               0
{c_phone}     0          0               0
{n_name}      0          0               0
{sum}         0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   33172.00       +Inf <==       33172.00            +Inf <==            0.00            1.00
{c_address}   33172.00       +Inf <==       33172.00            +Inf <==            0.00            1.00
{c_comment}   33172.00       +Inf <==       33172.00            +Inf <==            0.00            1.00
{c_custkey}   33172.00       +Inf <==       33172.00            +Inf <==            0.00            1.00
{c_name}      33172.00       +Inf <==       33172.00            +Inf <==            0.00            1.00
{c_phone}     33172.00       +Inf <==       33172.00            +Inf <==            0.00            1.00
{n_name}      33172.00       +Inf <==       33172.00            +Inf <==            0.00            1.00
{sum}         33172.00       +Inf <==       33172.00            +Inf <==            0.00            1.00

----Stats for q10_group_by_3----
column_names  row_count  distinct_count  null_count
{c_acctbal}   37967      37658           0
{c_address}   37967      38065           0
{c_comment}   37967      38086           0
{c_custkey}   37967      37904           0
{c_name}      37967      37859           0
{c_phone}     37967      38026           0
{n_name}      37967      25              0
{sum}         37967      37881           0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   33172.00       1.14           33172.00            1.14                0.00            1.00
{c_address}   33172.00       1.14           33172.00            1.15                0.00            1.00
{c_comment}   33172.00       1.14           33172.00            1.15                0.00            1.00
{c_custkey}   33172.00       1.14           33172.00            1.14                0.00            1.00
{c_name}      33172.00       1.14           33172.00            1.14                0.00            1.00
{c_phone}     33172.00       1.14           33172.00            1.15                0.00            1.00
{n_name}      33172.00       1.14           33172.00            1326.88 <==         0.00            1.00
{sum}         33172.00       1.14           33172.00            1.14                0.00            1.00

----Stats for q10_project_4----
column_names  row_count  distinct_count  null_count
{c_acctbal}   114705     37658           0
{c_address}   114705     38065           0
{c_comment}   114705     38086           0
{c_custkey}   114705     37904           0
{c_name}      114705     37859           0
{c_phone}     114705     38026           0
{column46}    114705     114608          0
{n_name}      114705     25              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   82076.00       1.40           46013.00            1.22                0.00            1.00
{c_address}   82076.00       1.40           46410.00            1.22                0.00            1.00
{c_comment}   82076.00       1.40           46385.00            1.22                0.00            1.00
{c_custkey}   82076.00       1.40           33172.00            1.14                0.00            1.00
{c_name}      82076.00       1.40           46412.00            1.23                0.00            1.00
{c_phone}     82076.00       1.40           46412.00            1.22                0.00            1.00
{column46}    82076.00       1.40           41180.00            2.78 <==            0.00            1.00
{n_name}      82076.00       1.40           25.00               1.00                0.00            1.00

----Stats for q10_inner_join_5----
column_names       row_count  distinct_count  null_count
{c_acctbal}        114705     37658           0
{c_address}        114705     38065           0
{c_comment}        114705     38086           0
{c_custkey}        114705     37904           0
{c_name}           114705     37859           0
{c_nationkey}      114705     25              0
{c_phone}          114705     38026           0
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{n_name}           114705     25              0
{n_nationkey}      114705     25              0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}        82076.00       1.40           46013.00            1.22                0.00            1.00
{c_address}        82076.00       1.40           46410.00            1.22                0.00            1.00
{c_comment}        82076.00       1.40           46385.00            1.22                0.00            1.00
{c_custkey}        82076.00       1.40           33172.00            1.14                0.00            1.00
{c_name}           82076.00       1.40           46412.00            1.23                0.00            1.00
{c_nationkey}      82076.00       1.40           25.00               1.00                0.00            1.00
{c_phone}          82076.00       1.40           46412.00            1.22                0.00            1.00
{l_discount}       82076.00       1.40           11.00               1.00                0.00            1.00
{l_extendedprice}  82076.00       1.40           40916.00            2.60 <==            0.00            1.00
{l_orderkey}       82076.00       1.40           37088.00            1.31                0.00            1.00
{l_returnflag}     82076.00       1.40           1.00                1.00                0.00            1.00
{n_name}           82076.00       1.40           25.00               1.00                0.00            1.00
{n_nationkey}      82076.00       1.40           25.00               1.00                0.00            1.00
{o_custkey}        82076.00       1.40           33172.00            1.14                0.00            1.00
{o_orderdate}      82076.00       1.40           92.00               1.00                0.00            1.00
{o_orderkey}       82076.00       1.40           37088.00            1.31                0.00            1.00

----Stats for q10_inner_join_6----
column_names       row_count  distinct_count  null_count
{c_acctbal}        114705     37658           0
{c_address}        114705     38065           0
{c_comment}        114705     38086           0
{c_custkey}        114705     37904           0
{c_name}           114705     37859           0
{c_nationkey}      114705     25              0
{c_phone}          114705     38026           0
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}        82076.00       1.40           62177.00            1.65                0.00            1.00
{c_address}        82076.00       1.40           63206.00            1.66                0.00            1.00
{c_comment}        82076.00       1.40           63142.00            1.66                0.00            1.00
{c_custkey}        82076.00       1.40           37028.00            1.02                0.00            1.00
{c_name}           82076.00       1.40           63213.00            1.67                0.00            1.00
{c_nationkey}      82076.00       1.40           25.00               1.00                0.00            1.00
{c_phone}          82076.00       1.40           63213.00            1.66                0.00            1.00
{l_discount}       82076.00       1.40           11.00               1.00                0.00            1.00
{l_extendedprice}  82076.00       1.40           50563.00            2.10 <==            0.00            1.00
{l_orderkey}       82076.00       1.40           43379.00            1.12                0.00            1.00
{l_returnflag}     82076.00       1.40           1.00                1.00                0.00            1.00
{o_custkey}        82076.00       1.40           37028.00            1.02                0.00            1.00
{o_orderdate}      82076.00       1.40           92.00               1.00                0.00            1.00
{o_orderkey}       82076.00       1.40           43379.00            1.12                0.00            1.00

----Stats for q10_scan_7----
column_names   row_count  distinct_count  null_count
{c_acctbal}    150000     140628          0
{c_address}    150000     149937          0
{c_comment}    150000     149323          0
{c_custkey}    150000     148813          0
{c_name}       150000     151126          0
{c_nationkey}  150000     25              0
{c_phone}      150000     150872          0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}    150000.00      1.00           140628.00           1.00                0.00            1.00
{c_address}    150000.00      1.00           149937.00           1.00                0.00            1.00
{c_comment}    150000.00      1.00           149323.00           1.00                0.00            1.00
{c_custkey}    150000.00      1.00           148813.00           1.00                0.00            1.00
{c_name}       150000.00      1.00           150000.00           1.01                0.00            1.00
{c_nationkey}  150000.00      1.00           25.00               1.00                0.00            1.00
{c_phone}      150000.00      1.00           150000.00           1.01                0.00            1.00

----Stats for q10_lookup_join_8----
column_names       row_count  distinct_count  null_count
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       81427.00       1.41           11.00               1.00                0.00            1.00
{l_extendedprice}  81427.00       1.41           77287.00            1.37                0.00            1.00
{l_orderkey}       81427.00       1.41           56727.00            1.17                0.00            1.00
{l_returnflag}     81427.00       1.41           1.00                1.00                0.00            1.00
{o_custkey}        81427.00       1.41           37028.00            1.02                0.00            1.00
{o_orderdate}      81427.00       1.41           92.00               1.00                0.00            1.00
{o_orderkey}       81427.00       1.41           56727.00            1.17                0.00            1.00

----Stats for q10_index_join_9----
column_names   row_count  distinct_count  null_count
{o_custkey}    57069      42598           0
{o_orderdate}  57069      92              0
{o_orderkey}   57069      56240           0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}    56727.00       1.01           43896.00            1.03                0.00            1.00
{o_orderdate}  56727.00       1.01           92.00               1.00                0.00            1.00
{o_orderkey}   56727.00       1.01           56727.00            1.01                0.00            1.00

----Stats for q10_scan_10----
column_names   row_count  distinct_count  null_count
{o_orderdate}  57069      92              0
{o_orderkey}   57069      56240           0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_orderdate}  56727.00       1.01           92.00               1.00                0.00            1.00
{o_orderkey}   56727.00       1.01           56727.00            1.01                0.00            1.00

----Stats for q10_scan_11----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
----
----
