import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q10
# Returned Item Reporting
# Identifies customers who might be having problems with the parts that are
# shipped to them.
#
# Finds the top 20 customers, in terms of their effect on lost revenue for a
# given quarter, who have returned parts. The query considers only parts that
# were ordered in the specified quarter. The query lists the customer's name,
# address, nation, phone number, account balance, comment information and
# revenue lost. The customers are listed in descending order of lost revenue.
# Revenue lost is defined as sum(l_extendedprice*(1-l_discount)) for all
# qualifying lineitems.
# --------------------------------------------------
save-tables database=tpch save-tables-prefix=q10
SELECT
    c_custkey,
    c_name,
    sum(l_extendedprice * (1 - l_discount)) AS revenue,
    c_acctbal,
    n_name,
    c_address,
    c_phone,
    c_comment
FROM
    customer,
    orders,
    lineitem,
    nation
WHERE
    c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND o_orderDATE >= DATE '1993-10-01'
    AND o_orderDATE < DATE '1993-10-01' + INTERVAL '3' MONTH
    AND l_returnflag = 'R'
    AND c_nationkey = n_nationkey
GROUP BY
    c_custkey,
    c_name,
    c_acctbal,
    c_phone,
    n_name,
    c_address,
    c_comment
ORDER BY
    revenue DESC
LIMIT 20;
----
limit
 ├── save-table-name: q10_limit_1
 ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) revenue:39(float!null) c_acctbal:6(float!null) n_name:35(char!null) c_address:3(varchar!null) c_phone:5(char!null) c_comment:8(varchar!null)
 ├── internal-ordering: -39
 ├── cardinality: [0 - 20]
 ├── immutable
 ├── stats: [rows=20, distinct(1)=20, null(1)=0, distinct(2)=20, null(2)=0, distinct(3)=20, null(3)=0, distinct(5)=20, null(5)=0, distinct(6)=20, null(6)=0, distinct(8)=20, null(8)=0, distinct(35)=20, null(35)=0, distinct(39)=20, null(39)=0]
 ├── key: (1)
 ├── fd: (1)-->(2,3,5,6,8,35,39)
 ├── ordering: -39
 ├── sort
 │    ├── save-table-name: q10_sort_2
 │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:35(char!null) sum:39(float!null)
 │    ├── immutable
 │    ├── stats: [rows=34517.9842, distinct(1)=34517.9842, null(1)=0, distinct(2)=34517.9842, null(2)=0, distinct(3)=34517.9842, null(3)=0, distinct(5)=34517.9842, null(5)=0, distinct(6)=34517.9842, null(6)=0, distinct(8)=34517.9842, null(8)=0, distinct(35)=34517.9842, null(35)=0, distinct(39)=34517.9842, null(39)=0]
 │    ├── key: (1)
 │    ├── fd: (1)-->(2,3,5,6,8,35,39)
 │    ├── ordering: -39
 │    ├── limit hint: 20.00
 │    └── group-by
 │         ├── save-table-name: q10_group_by_3
 │         ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:35(char!null) sum:39(float!null)
 │         ├── grouping columns: c_custkey:1(int!null)
 │         ├── immutable
 │         ├── stats: [rows=34517.9842, distinct(1)=34517.9842, null(1)=0, distinct(2)=34517.9842, null(2)=0, distinct(3)=34517.9842, null(3)=0, distinct(5)=34517.9842, null(5)=0, distinct(6)=34517.9842, null(6)=0, distinct(8)=34517.9842, null(8)=0, distinct(35)=34517.9842, null(35)=0, distinct(39)=34517.9842, null(39)=0]
 │         ├── key: (1)
 │         ├── fd: (1)-->(2,3,5,6,8,35,39)
 │         ├── project
 │         │    ├── save-table-name: q10_project_4
 │         │    ├── columns: column38:38(float!null) c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:35(char!null)
 │         │    ├── immutable
 │         │    ├── stats: [rows=91240.8317, distinct(1)=34517.9842, null(1)=0, distinct(2)=50850.8128, null(2)=0, distinct(3)=50847.7096, null(3)=0, distinct(5)=50850.8128, null(5)=0, distinct(6)=50359.5433, null(6)=0, distinct(8)=50817.3327, null(8)=0, distinct(35)=25, null(35)=0, distinct(38)=45841.1563, null(38)=0]
 │         │    ├── fd: (1)-->(2,3,5,6,8,35)
 │         │    ├── inner-join (hash)
 │         │    │    ├── save-table-name: q10_inner_join_5
 │         │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) o_orderkey:9(int!null) o_custkey:10(int!null) o_orderdate:13(date!null) l_orderkey:18(int!null) l_extendedprice:23(float!null) l_discount:24(float!null) l_returnflag:26(char!null) n_nationkey:34(int!null) n_name:35(char!null)
 │         │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
 │         │    │    ├── stats: [rows=91240.8317, distinct(1)=34517.9842, null(1)=0, distinct(2)=50850.8128, null(2)=0, distinct(3)=50847.7096, null(3)=0, distinct(4)=25, null(4)=0, distinct(5)=50850.8128, null(5)=0, distinct(6)=50359.5433, null(6)=0, distinct(8)=50817.3327, null(8)=0, distinct(9)=39047.6447, null(9)=0, distinct(10)=34517.9842, null(10)=0, distinct(13)=92, null(13)=0, distinct(18)=39047.6447, null(18)=0, distinct(23)=45484.5715, null(23)=0, distinct(24)=11, null(24)=0, distinct(26)=1, null(26)=0, distinct(34)=25, null(34)=0, distinct(35)=25, null(35)=0, distinct(23,24)=45841.1563, null(23,24)=0]
 │         │    │    ├── fd: ()-->(26), (1)-->(2-6,8), (9)-->(10,13), (9)==(18), (18)==(9), (1)==(10), (10)==(1), (34)-->(35), (4)==(34), (34)==(4)
 │         │    │    ├── inner-join (hash)
 │         │    │    │    ├── save-table-name: q10_inner_join_6
 │         │    │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) o_orderkey:9(int!null) o_custkey:10(int!null) o_orderdate:13(date!null) l_orderkey:18(int!null) l_extendedprice:23(float!null) l_discount:24(float!null) l_returnflag:26(char!null)
 │         │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
 │         │    │    │    ├── stats: [rows=91240.8317, distinct(1)=37710.0545, null(1)=0, distinct(2)=68356.5955, null(2)=0, distinct(3)=68348.7409, null(3)=0, distinct(4)=25, null(4)=0, distinct(5)=68356.5955, null(5)=0, distinct(6)=67126.4808, null(6)=0, distinct(8)=68271.9098, null(8)=0, distinct(9)=44561.5336, null(9)=0, distinct(10)=37710.0545, null(10)=0, distinct(13)=92, null(13)=0, distinct(18)=44561.5336, null(18)=0, distinct(23)=56207.9759, null(23)=0, distinct(24)=11, null(24)=0, distinct(26)=1, null(26)=0, distinct(23,24)=56936.0051, null(23,24)=0]
 │         │    │    │    ├── fd: ()-->(26), (1)-->(2-6,8), (9)-->(10,13), (9)==(18), (18)==(9), (1)==(10), (10)==(1)
 │         │    │    │    ├── scan customer
 │         │    │    │    │    ├── save-table-name: q10_scan_7
 │         │    │    │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null)
 │         │    │    │    │    ├── stats: [rows=150000, distinct(1)=148813, null(1)=0, distinct(2)=150000, null(2)=0, distinct(3)=149937, null(3)=0, distinct(4)=25, null(4)=0, distinct(5)=150000, null(5)=0, distinct(6)=140628, null(6)=0, distinct(8)=149323, null(8)=0]
 │         │    │    │    │    │   histogram(1)=  0 15  735  15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15   735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735   15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    735    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15    750    15
 │         │    │    │    │    │                <--- 2 ----- 776 ----- 1422 ----- 2189 ----- 2973 ----- 3583 ----- 4390 ----- 5154 ----- 5962 ----- 6965 ----- 7596 ----- 8303 ----- 9167 ----- 9833 ----- 10695 ----- 11397 ----- 11979 ----- 12651 ----- 13397 ----- 14144 ----- 14951 ----- 15698 ----- 16460 ----- 17203 ----- 17846 ----- 18462 ----- 19390 ----- 20189 ----- 20852 ----- 21642 ----- 22379 ----- 23009 ----- 23856 ----- 24734 ----- 25473 ----- 26231 ----- 26978 ----- 27654 ----- 28276 ----- 29054 ----- 29727 ----- 30527 ----- 31177 ----- 32126 ----- 32984 ----- 33684 ----- 34316 ----- 35070 ----- 35703 ----- 36397 ----- 37156 ----- 37709 ----- 38488 ----- 39131 ----- 39740 ----- 40736 ----- 41459 ----- 42388 ----- 42999 ----- 43844 ----- 44571 ----- 45428 ----- 46283 ----- 46979 ----- 47712 ----- 48708 ----- 49487 ----- 50275 ----- 51131 ----- 51836 ----- 52652 ----- 53389 ----- 54179 ----- 54861 ----- 55609 ----- 56492 ----- 57284 ----- 57917 ----- 58793 ----- 59665 ----- 60285 ----- 60840 ----- 61523 ----- 62354 ----- 63178 ----- 63933 ----- 64642 ----- 65282 ----- 65864 ----- 66755 ----- 67407 ----- 68099 ----- 68875 ----- 69638 ----- 70304 ----- 71016 ----- 71830 ----- 72742 ----- 73590 ----- 74434 ----- 75274 ----- 75861 ----- 76547 ----- 77252 ----- 77978 ----- 78650 ----- 79313 ----- 79925 ----- 80677 ----- 81497 ----- 82205 ----- 82962 ----- 83879 ----- 84815 ----- 85521 ----- 86272 ----- 87140 ----- 87759 ----- 88634 ----- 89452 ----- 90192 ----- 90920 ----- 91756 ----- 92690 ----- 93299 ----- 93950 ----- 94812 ----- 95569 ----- 96295 ----- 96904 ----- 97499 ----- 98144 ----- 98764 ----- 99582 ----- 100453 ----- 101098 ----- 101892 ----- 102700 ----- 103419 ----- 104297 ----- 105040 ----- 105864 ----- 106498 ----- 107196 ----- 108022 ----- 108731 ----- 109398 ----- 110145 ----- 110849 ----- 111758 ----- 112501 ----- 113222 ----- 114019 ----- 114904 ----- 115693 ----- 116350 ----- 116955 ----- 117581 ----- 118366 ----- 119159 ----- 119902 ----- 120535 ----- 121321 ----- 121993 ----- 122769 ----- 123504 ----- 124225 ----- 124992 ----- 125632 ----- 126685 ----- 127641 ----- 128303 ----- 129042 ----- 129589 ----- 130548 ----- 131374 ----- 132325 ----- 133042 ----- 133883 ----- 134716 ----- 135520 ----- 136173 ----- 136858 ----- 137584 ----- 138381 ----- 139162 ----- 139923 ----- 140738 ----- 141557 ----- 142287 ----- 143002 ----- 143794 ----- 144420 ----- 145276 ----- 146100 ----- 146977 ----- 147821 ----- 148440 ----- 149247 ----- 149978
 │         │    │    │    │    │   histogram(4)=  0 6255 0 5190 0 6345 0 5505 0 5520 0 6585 0 6405 0 5895 0 5640 0 5775 0 5745 0 6630 0 6300 0 6255 0 6105 0 5760 0 6270 0 5850 0 6195 0 6330 0 6150 0 5820 0 5790 0 5985 0 5700
 │         │    │    │    │    │                <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 ---- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
 │         │    │    │    │    ├── key: (1)
 │         │    │    │    │    └── fd: (1)-->(2-6,8)
 │         │    │    │    ├── inner-join (lookup lineitem)
 │         │    │    │    │    ├── save-table-name: q10_lookup_join_8
 │         │    │    │    │    ├── columns: o_orderkey:9(int!null) o_custkey:10(int!null) o_orderdate:13(date!null) l_orderkey:18(int!null) l_extendedprice:23(float!null) l_discount:24(float!null) l_returnflag:26(char!null)
 │         │    │    │    │    ├── key columns: [9] = [18]
 │         │    │    │    │    ├── stats: [rows=90518.8126, distinct(9)=55061.5385, null(9)=0, distinct(10)=37710.0545, null(10)=0, distinct(13)=92, null(13)=0, distinct(18)=55061.5385, null(18)=0, distinct(23)=85913.1168, null(23)=0, distinct(24)=11, null(24)=0, distinct(26)=1, null(26)=0, distinct(23,24)=88501.3935, null(23,24)=0]
 │         │    │    │    │    ├── fd: ()-->(26), (9)-->(10,13), (9)==(18), (18)==(9)
 │         │    │    │    │    ├── index-join orders
 │         │    │    │    │    │    ├── save-table-name: q10_index_join_9
 │         │    │    │    │    │    ├── columns: o_orderkey:9(int!null) o_custkey:10(int!null) o_orderdate:13(date!null)
 │         │    │    │    │    │    ├── stats: [rows=55061.5385, distinct(9)=55061.5385, null(9)=0, distinct(10)=42917.9526, null(10)=0, distinct(13)=92, null(13)=0]
 │         │    │    │    │    │    │   histogram(13)=  0      450       6900      600       6600      1350      6900      1050      6300      1050      6750      1050      6900      450       7050      600       530.77     530.77
 │         │    │    │    │    │    │                 <--- '1993-10-01' ------ '1993-10-13' ------ '1993-10-22' ------ '1993-11-04' ------ '1993-11-16' ------ '1993-11-30' ------ '1993-12-16' ------ '1993-12-29' -------- '1993-12-31'
 │         │    │    │    │    │    ├── key: (9)
 │         │    │    │    │    │    ├── fd: (9)-->(10,13)
 │         │    │    │    │    │    └── scan orders@o_od
 │         │    │    │    │    │         ├── save-table-name: q10_scan_10
 │         │    │    │    │    │         ├── columns: o_orderkey:9(int!null) o_orderdate:13(date!null)
 │         │    │    │    │    │         ├── constraint: /13/9: [/'1993-10-01' - /'1993-12-31']
 │         │    │    │    │    │         ├── stats: [rows=55061.5385, distinct(9)=55061.5385, null(9)=0, distinct(13)=92, null(13)=0]
 │         │    │    │    │    │         │   histogram(9)=  0 5.5062 269.8 5.5062  269.8 5.5062  269.8 5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062  269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   269.8  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062   275.31  5.5062
 │         │    │    │    │    │         │                <--- 998 -------- 26593 ------- 56613 ------- 85827 ------- 115587 ------- 140512 ------- 167076 ------- 198882 ------- 228580 ------- 262243 ------- 292064 ------- 316161 ------- 344194 ------- 368550 ------- 402722 ------- 434529 ------- 468807 ------- 495107 ------- 526338 ------- 563239 ------- 597733 ------- 641894 ------- 665730 ------- 688742 ------- 721767 ------- 750050 ------- 787879 ------- 814565 ------- 837381 ------- 866657 ------- 902855 ------- 927172 ------- 952772 ------- 975840 ------- 1008646 ------- 1032066 ------- 1074656 ------- 1104896 ------- 1138369 ------- 1166689 ------- 1194912 ------- 1225222 ------- 1253284 ------- 1284803 ------- 1318499 ------- 1348609 ------- 1376609 ------- 1404933 ------- 1435745 ------- 1460325 ------- 1491648 ------- 1518852 ------- 1542567 ------- 1574277 ------- 1597958 ------- 1624964 ------- 1647555 ------- 1683651 ------- 1717189 ------- 1750563 ------- 1784775 ------- 1812449 ------- 1838850 ------- 1867751 ------- 1891783 ------- 1918790 ------- 1949827 ------- 1986021 ------- 2020134 ------- 2045829 ------- 2077894 ------- 2118912 ------- 2143264 ------- 2176486 ------- 2204838 ------- 2234146 ------- 2260484 ------- 2288512 ------- 2317121 ------- 2344321 ------- 2362567 ------- 2396133 ------- 2423623 ------- 2454884 ------- 2483879 ------- 2520162 ------- 2545574 ------- 2571874 ------- 2608417 ------- 2637477 ------- 2665607 ------- 2692231 ------- 2724261 ------- 2764451 ------- 2798656 ------- 2824775 ------- 2858690 ------- 2881990 ------- 2911814 ------- 2945056 ------- 2981315 ------- 3010306 ------- 3032320 ------- 3064389 ------- 3084166 ------- 3108832 ------- 3136032 ------- 3168484 ------- 3204039 ------- 3229922 ------- 3256549 ------- 3283169 ------- 3315236 ------- 3346756 ------- 3375879 ------- 3408007 ------- 3441827 ------- 3471204 ------- 3505414 ------- 3527938 ------- 3562561 ------- 3598630 ------- 3627270 ------- 3659266 ------- 3686468 ------- 3713505 ------- 3750817 ------- 3777696 ------- 3808129 ------- 3834533 ------- 3871968 ------- 3904931 ------- 3934215 ------- 3960643 ------- 3990336 ------- 4023203 ------- 4057826 ------- 4090691 ------- 4121216 ------- 4159681 ------- 4190726 ------- 4222624 ------- 4246567 ------- 4283653 ------- 4314339 ------- 4342592 ------- 4373829 ------- 4402372 ------- 4431332 ------- 4464452 ------- 4496327 -------- 4526789 -------- 4551109 -------- 4582401 -------- 4615974 -------- 4648482 -------- 4669601 -------- 4705891 -------- 4732869 -------- 4766145 -------- 4805862 -------- 4840677 -------- 4866787 -------- 4895332 -------- 4928100 -------- 4956323 -------- 4992161 -------- 5027008 -------- 5065797 -------- 5099011 -------- 5130592 -------- 5163463 -------- 5197314 -------- 5224994 -------- 5253892 -------- 5277638 -------- 5307105 -------- 5335750 -------- 5369828 -------- 5402528 -------- 5434183 -------- 5464227 -------- 5491072 -------- 5520679 -------- 5543047 -------- 5576708 -------- 5614951 -------- 5646055 -------- 5674721 -------- 5700295 -------- 5732066 -------- 5761255 -------- 5791233 -------- 5819651 -------- 5852291 -------- 5880258 -------- 5909062 -------- 5943111 -------- 5973926 -------- 5998752
 │         │    │    │    │    │         │   histogram(13)=  0      450       6900      600       6600      1350      6900      1050      6300      1050      6750      1050      6900      450       7050      600       530.77     530.77
 │         │    │    │    │    │         │                 <--- '1993-10-01' ------ '1993-10-13' ------ '1993-10-22' ------ '1993-11-04' ------ '1993-11-16' ------ '1993-11-30' ------ '1993-12-16' ------ '1993-12-29' -------- '1993-12-31'
 │         │    │    │    │    │         ├── key: (9)
 │         │    │    │    │    │         └── fd: (9)-->(13)
 │         │    │    │    │    └── filters
 │         │    │    │    │         └── l_returnflag:26 = 'R' [type=bool, outer=(26), constraints=(/26: [/'R' - /'R']; tight), fd=()-->(26)]
 │         │    │    │    └── filters
 │         │    │    │         └── c_custkey:1 = o_custkey:10 [type=bool, outer=(1,10), constraints=(/1: (/NULL - ]; /10: (/NULL - ]), fd=(1)==(10), (10)==(1)]
 │         │    │    ├── scan nation
 │         │    │    │    ├── save-table-name: q10_scan_11
 │         │    │    │    ├── columns: n_nationkey:34(int!null) n_name:35(char!null)
 │         │    │    │    ├── stats: [rows=25, distinct(34)=25, null(34)=0, distinct(35)=25, null(35)=0]
 │         │    │    │    │   histogram(34)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
 │         │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
 │         │    │    │    ├── key: (34)
 │         │    │    │    └── fd: (34)-->(35)
 │         │    │    └── filters
 │         │    │         └── c_nationkey:4 = n_nationkey:34 [type=bool, outer=(4,34), constraints=(/4: (/NULL - ]; /34: (/NULL - ]), fd=(4)==(34), (34)==(4)]
 │         │    └── projections
 │         │         └── l_extendedprice:23 * (1.0 - l_discount:24) [as=column38:38, type=float, outer=(23,24), immutable]
 │         └── aggregations
 │              ├── sum [as=sum:39, type=float, outer=(38)]
 │              │    └── column38:38 [type=float]
 │              ├── const-agg [as=c_name:2, type=varchar, outer=(2)]
 │              │    └── c_name:2 [type=varchar]
 │              ├── const-agg [as=c_address:3, type=varchar, outer=(3)]
 │              │    └── c_address:3 [type=varchar]
 │              ├── const-agg [as=c_phone:5, type=char, outer=(5)]
 │              │    └── c_phone:5 [type=char]
 │              ├── const-agg [as=c_acctbal:6, type=float, outer=(6)]
 │              │    └── c_acctbal:6 [type=float]
 │              ├── const-agg [as=c_comment:8, type=varchar, outer=(8)]
 │              │    └── c_comment:8 [type=varchar]
 │              └── const-agg [as=n_name:35, type=char, outer=(35)]
 │                   └── n_name:35 [type=char]
 └── 20 [type=int]

stats table=q10_limit_1
----
column_names  row_count  distinct_count  null_count
{c_acctbal}   20         20              0
{c_address}   20         20              0
{c_comment}   20         20              0
{c_custkey}   20         20              0
{c_name}      20         20              0
{c_phone}     20         20              0
{n_name}      20         13              0
{revenue}     20         20              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   20.00          1.00           20.00               1.00                0.00            1.00
{c_address}   20.00          1.00           20.00               1.00                0.00            1.00
{c_comment}   20.00          1.00           20.00               1.00                0.00            1.00
{c_custkey}   20.00          1.00           20.00               1.00                0.00            1.00
{c_name}      20.00          1.00           20.00               1.00                0.00            1.00
{c_phone}     20.00          1.00           20.00               1.00                0.00            1.00
{n_name}      20.00          1.00           20.00               1.54                0.00            1.00
{revenue}     20.00          1.00           20.00               1.00                0.00            1.00

stats table=q10_sort_2
----
column_names  row_count  distinct_count  null_count
{c_acctbal}   0          0               0
{c_address}   0          0               0
{c_comment}   0          0               0
{c_custkey}   0          0               0
{c_name}      0          0               0
{c_phone}     0          0               0
{n_name}      0          0               0
{sum}         0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   34518.00       +Inf <==       34518.00            +Inf <==            0.00            1.00
{c_address}   34518.00       +Inf <==       34518.00            +Inf <==            0.00            1.00
{c_comment}   34518.00       +Inf <==       34518.00            +Inf <==            0.00            1.00
{c_custkey}   34518.00       +Inf <==       34518.00            +Inf <==            0.00            1.00
{c_name}      34518.00       +Inf <==       34518.00            +Inf <==            0.00            1.00
{c_phone}     34518.00       +Inf <==       34518.00            +Inf <==            0.00            1.00
{n_name}      34518.00       +Inf <==       34518.00            +Inf <==            0.00            1.00
{sum}         34518.00       +Inf <==       34518.00            +Inf <==            0.00            1.00

stats table=q10_group_by_3
----
column_names  row_count  distinct_count  null_count
{c_acctbal}   37967      37658           0
{c_address}   37967      38065           0
{c_comment}   37967      38086           0
{c_custkey}   37967      37904           0
{c_name}      37967      37859           0
{c_phone}     37967      38026           0
{n_name}      37967      25              0
{sum}         37967      37934           0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   34518.00       1.10           34518.00            1.09                0.00            1.00
{c_address}   34518.00       1.10           34518.00            1.10                0.00            1.00
{c_comment}   34518.00       1.10           34518.00            1.10                0.00            1.00
{c_custkey}   34518.00       1.10           34518.00            1.10                0.00            1.00
{c_name}      34518.00       1.10           34518.00            1.10                0.00            1.00
{c_phone}     34518.00       1.10           34518.00            1.10                0.00            1.00
{n_name}      34518.00       1.10           34518.00            1380.72 <==         0.00            1.00
{sum}         34518.00       1.10           34518.00            1.10                0.00            1.00

stats table=q10_project_4
----
column_names  row_count  distinct_count  null_count
{c_acctbal}   114705     37658           0
{c_address}   114705     38065           0
{c_comment}   114705     38086           0
{c_custkey}   114705     37904           0
{c_name}      114705     37859           0
{c_phone}     114705     38026           0
{column38}    114705     114608          0
{n_name}      114705     25              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   91241.00       1.26           50360.00            1.34                0.00            1.00
{c_address}   91241.00       1.26           50848.00            1.34                0.00            1.00
{c_comment}   91241.00       1.26           50817.00            1.33                0.00            1.00
{c_custkey}   91241.00       1.26           34518.00            1.10                0.00            1.00
{c_name}      91241.00       1.26           50851.00            1.34                0.00            1.00
{c_phone}     91241.00       1.26           50851.00            1.34                0.00            1.00
{column38}    91241.00       1.26           45841.00            2.50 <==            0.00            1.00
{n_name}      91241.00       1.26           25.00               1.00                0.00            1.00

stats table=q10_inner_join_5
----
column_names       row_count  distinct_count  null_count
{c_acctbal}        114705     37658           0
{c_address}        114705     38065           0
{c_comment}        114705     38086           0
{c_custkey}        114705     37904           0
{c_name}           114705     37859           0
{c_nationkey}      114705     25              0
{c_phone}          114705     38026           0
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{n_name}           114705     25              0
{n_nationkey}      114705     25              0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}        91241.00       1.26           50360.00            1.34                0.00            1.00
{c_address}        91241.00       1.26           50848.00            1.34                0.00            1.00
{c_comment}        91241.00       1.26           50817.00            1.33                0.00            1.00
{c_custkey}        91241.00       1.26           34518.00            1.10                0.00            1.00
{c_name}           91241.00       1.26           50851.00            1.34                0.00            1.00
{c_nationkey}      91241.00       1.26           25.00               1.00                0.00            1.00
{c_phone}          91241.00       1.26           50851.00            1.34                0.00            1.00
{l_discount}       91241.00       1.26           11.00               1.00                0.00            1.00
{l_extendedprice}  91241.00       1.26           45485.00            2.34 <==            0.00            1.00
{l_orderkey}       91241.00       1.26           39048.00            1.24                0.00            1.00
{l_returnflag}     91241.00       1.26           1.00                1.00                0.00            1.00
{n_name}           91241.00       1.26           25.00               1.00                0.00            1.00
{n_nationkey}      91241.00       1.26           25.00               1.00                0.00            1.00
{o_custkey}        91241.00       1.26           34518.00            1.10                0.00            1.00
{o_orderdate}      91241.00       1.26           92.00               1.00                0.00            1.00
{o_orderkey}       91241.00       1.26           39048.00            1.24                0.00            1.00

stats table=q10_inner_join_6
----
column_names       row_count  distinct_count  null_count
{c_acctbal}        114705     37658           0
{c_address}        114705     38065           0
{c_comment}        114705     38086           0
{c_custkey}        114705     37904           0
{c_name}           114705     37859           0
{c_nationkey}      114705     25              0
{c_phone}          114705     38026           0
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}        91241.00       1.26           67126.00            1.78                0.00            1.00
{c_address}        91241.00       1.26           68349.00            1.80                0.00            1.00
{c_comment}        91241.00       1.26           68272.00            1.79                0.00            1.00
{c_custkey}        91241.00       1.26           37710.00            1.01                0.00            1.00
{c_name}           91241.00       1.26           68357.00            1.81                0.00            1.00
{c_nationkey}      91241.00       1.26           25.00               1.00                0.00            1.00
{c_phone}          91241.00       1.26           68357.00            1.80                0.00            1.00
{l_discount}       91241.00       1.26           11.00               1.00                0.00            1.00
{l_extendedprice}  91241.00       1.26           56208.00            1.89                0.00            1.00
{l_orderkey}       91241.00       1.26           44562.00            1.09                0.00            1.00
{l_returnflag}     91241.00       1.26           1.00                1.00                0.00            1.00
{o_custkey}        91241.00       1.26           37710.00            1.01                0.00            1.00
{o_orderdate}      91241.00       1.26           92.00               1.00                0.00            1.00
{o_orderkey}       91241.00       1.26           44562.00            1.09                0.00            1.00

stats table=q10_scan_7
----
column_names   row_count  distinct_count  null_count
{c_acctbal}    150000     140628          0
{c_address}    150000     149937          0
{c_comment}    150000     149323          0
{c_custkey}    150000     148813          0
{c_name}       150000     151126          0
{c_nationkey}  150000     25              0
{c_phone}      150000     150872          0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}    150000.00      1.00           140628.00           1.00                0.00            1.00
{c_address}    150000.00      1.00           149937.00           1.00                0.00            1.00
{c_comment}    150000.00      1.00           149323.00           1.00                0.00            1.00
{c_custkey}    150000.00      1.00           148813.00           1.00                0.00            1.00
{c_name}       150000.00      1.00           150000.00           1.01                0.00            1.00
{c_nationkey}  150000.00      1.00           25.00               1.00                0.00            1.00
{c_phone}      150000.00      1.00           150000.00           1.01                0.00            1.00

stats table=q10_lookup_join_8
----
column_names       row_count  distinct_count  null_count
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       90519.00       1.27           11.00               1.00                0.00            1.00
{l_extendedprice}  90519.00       1.27           85913.00            1.24                0.00            1.00
{l_orderkey}       90519.00       1.27           55062.00            1.13                0.00            1.00
{l_returnflag}     90519.00       1.27           1.00                1.00                0.00            1.00
{o_custkey}        90519.00       1.27           37710.00            1.01                0.00            1.00
{o_orderdate}      90519.00       1.27           92.00               1.00                0.00            1.00
{o_orderkey}       90519.00       1.27           55062.00            1.13                0.00            1.00

stats table=q10_index_join_9
----
column_names   row_count  distinct_count  null_count
{o_custkey}    57069      42598           0
{o_orderdate}  57069      92              0
{o_orderkey}   57069      56240           0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}    55062.00       1.04           42918.00            1.01                0.00            1.00
{o_orderdate}  55062.00       1.04           92.00               1.00                0.00            1.00
{o_orderkey}   55062.00       1.04           55062.00            1.02                0.00            1.00

stats table=q10_scan_11
----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
