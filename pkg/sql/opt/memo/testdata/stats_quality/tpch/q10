import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q10
# Returned Item Reporting
# Identifies customers who might be having problems with the parts that are
# shipped to them.
#
# Finds the top 20 customers, in terms of their effect on lost revenue for a
# given quarter, who have returned parts. The query considers only parts that
# were ordered in the specified quarter. The query lists the customer's name,
# address, nation, phone number, account balance, comment information and
# revenue lost. The customers are listed in descending order of lost revenue.
# Revenue lost is defined as sum(l_extendedprice*(1-l_discount)) for all
# qualifying lineitems.
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q10
SELECT
    c_custkey,
    c_name,
    sum(l_extendedprice * (1 - l_discount)) AS revenue,
    c_acctbal,
    n_name,
    c_address,
    c_phone,
    c_comment
FROM
    customer,
    orders,
    lineitem,
    nation
WHERE
    c_custkey = o_custkey
    AND l_orderkey = o_orderkey
    AND o_orderDATE >= DATE '1993-10-01'
    AND o_orderDATE < DATE '1993-10-01' + INTERVAL '3' MONTH
    AND l_returnflag = 'R'
    AND c_nationkey = n_nationkey
GROUP BY
    c_custkey,
    c_name,
    c_acctbal,
    c_phone,
    n_name,
    c_address,
    c_comment
ORDER BY
    revenue DESC
LIMIT 20;
----
----
limit
 ├── save-table-name: q10_limit_1
 ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) revenue:47(float!null) c_acctbal:6(float!null) n_name:41(char!null) c_address:3(varchar!null) c_phone:5(char!null) c_comment:8(varchar!null)
 ├── internal-ordering: -47
 ├── cardinality: [0 - 20]
 ├── immutable
 ├── stats: [rows=20, distinct(1)=20, null(1)=0, distinct(2)=20, null(2)=0, distinct(3)=20, null(3)=0, distinct(5)=20, null(5)=0, distinct(6)=20, null(6)=0, distinct(8)=20, null(8)=0, distinct(41)=20, null(41)=0, distinct(47)=20, null(47)=0]
 ├── key: (1)
 ├── fd: (1)-->(2,3,5,6,8,41,47)
 ├── ordering: -47
 ├── sort
 │    ├── save-table-name: q10_sort_2
 │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:41(char!null) sum:47(float!null)
 │    ├── immutable
 │    ├── stats: [rows=36375.9857, distinct(1)=36375.9857, null(1)=0, distinct(2)=36375.9857, null(2)=0, distinct(3)=36375.9857, null(3)=0, distinct(5)=36375.9857, null(5)=0, distinct(6)=36375.9857, null(6)=0, distinct(8)=36375.9857, null(8)=0, distinct(41)=36375.9857, null(41)=0, distinct(47)=36375.9857, null(47)=0]
 │    ├── key: (1)
 │    ├── fd: (1)-->(2,3,5,6,8,41,47)
 │    ├── ordering: -47
 │    ├── limit hint: 20.00
 │    └── group-by
 │         ├── save-table-name: q10_group_by_3
 │         ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:41(char!null) sum:47(float!null)
 │         ├── grouping columns: c_custkey:1(int!null)
 │         ├── immutable
 │         ├── stats: [rows=36375.9857, distinct(1)=36375.9857, null(1)=0, distinct(2)=36375.9857, null(2)=0, distinct(3)=36375.9857, null(3)=0, distinct(5)=36375.9857, null(5)=0, distinct(6)=36375.9857, null(6)=0, distinct(8)=36375.9857, null(8)=0, distinct(41)=36375.9857, null(41)=0, distinct(47)=36375.9857, null(47)=0]
 │         ├── key: (1)
 │         ├── fd: (1)-->(2,3,5,6,8,41,47)
 │         ├── project
 │         │    ├── save-table-name: q10_project_4
 │         │    ├── columns: column46:46(float!null) c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) n_name:41(char!null)
 │         │    ├── immutable
 │         │    ├── stats: [rows=91493.8381, distinct(1)=36375.9857, null(1)=0, distinct(2)=50971.2848, null(2)=0, distinct(3)=50971.2848, null(3)=0, distinct(5)=50971.2848, null(5)=0, distinct(6)=50466.0195, null(6)=0, distinct(8)=50971.2848, null(8)=0, distinct(41)=25, null(41)=0, distinct(46)=45874.6436, null(46)=0]
 │         │    ├── fd: (1)-->(2,3,5,6,8,41)
 │         │    ├── inner-join (hash)
 │         │    │    ├── save-table-name: q10_inner_join_5
 │         │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_returnflag:30(char!null) n_nationkey:40(int!null) n_name:41(char!null)
 │         │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
 │         │    │    ├── stats: [rows=91493.8381, distinct(1)=36375.9857, null(1)=0, distinct(2)=50971.2848, null(2)=0, distinct(3)=50971.2848, null(3)=0, distinct(4)=25, null(4)=0, distinct(5)=50971.2848, null(5)=0, distinct(6)=50466.0195, null(6)=0, distinct(8)=50971.2848, null(8)=0, distinct(11)=41233.5954, null(11)=0, distinct(12)=36375.9857, null(12)=0, distinct(15)=92, null(15)=0, distinct(22)=41233.5954, null(22)=0, distinct(27)=45565.3974, null(27)=0, distinct(28)=11, null(28)=0, distinct(30)=1, null(30)=0, distinct(40)=25, null(40)=0, distinct(41)=25, null(41)=0, distinct(27,28)=45874.6436, null(27,28)=0]
 │         │    │    ├── fd: ()-->(30), (1)-->(2-6,8), (11)-->(12,15), (11)==(22), (22)==(11), (1)==(12), (12)==(1), (40)-->(41), (4)==(40), (40)==(4)
 │         │    │    ├── inner-join (hash)
 │         │    │    │    ├── save-table-name: q10_inner_join_6
 │         │    │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null) o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_returnflag:30(char!null)
 │         │    │    │    ├── multiplicity: left-rows(zero-or-more), right-rows(exactly-one)
 │         │    │    │    ├── stats: [rows=91493.8381, distinct(1)=40371.9872, null(1)=0, distinct(2)=68494.1885, null(2)=0, distinct(3)=68494.1885, null(3)=0, distinct(4)=25, null(4)=0, distinct(5)=68494.1885, null(5)=0, distinct(6)=67230.5242, null(6)=0, distinct(8)=68494.1885, null(8)=0, distinct(11)=48164.3035, null(11)=0, distinct(12)=40371.9872, null(12)=0, distinct(15)=92, null(15)=0, distinct(22)=48164.3035, null(22)=0, distinct(27)=56272.0607, null(27)=0, distinct(28)=11, null(28)=0, distinct(30)=1, null(30)=0, distinct(27,28)=56901.7579, null(27,28)=0]
 │         │    │    │    ├── fd: ()-->(30), (1)-->(2-6,8), (11)-->(12,15), (11)==(22), (22)==(11), (1)==(12), (12)==(1)
 │         │    │    │    ├── scan customer
 │         │    │    │    │    ├── save-table-name: q10_scan_7
 │         │    │    │    │    ├── columns: c_custkey:1(int!null) c_name:2(varchar!null) c_address:3(varchar!null) c_nationkey:4(int!null) c_phone:5(char!null) c_acctbal:6(float!null) c_comment:8(varchar!null)
 │         │    │    │    │    ├── stats: [rows=150000, distinct(1)=148813, null(1)=0, distinct(2)=150000, null(2)=0, distinct(3)=150000, null(3)=0, distinct(4)=25, null(4)=0, distinct(5)=150000, null(5)=0, distinct(6)=140426, null(6)=0, distinct(8)=150000, null(8)=0]
 │         │    │    │    │    │   histogram(1)=  0  6   772   6   839   6    793   6    666   6    657   6    737   6    787   6    755   6    621   6    752   6    707   6    714   6    756   6    727    6    859    6    729    6    664    6    754    6    751    6    650    6    797    6    718    6    729    6    729    6    807    6    830    6    793    6    673    6    733    6    762    6    690    6    706    6    889    6    728    6    768    6    743    6    734    6    754    6    744    6    753    6    805    6    679    6    757    6    706    6    802    6    687    6    787    6    778    6    780    6    829    6    748    6    718    6    838    6    746    6    700    6    783    6    792    6    698    6    770    6    771    6    713    6    692    6    803    6    680    6    684    6    677    6    693    6    700    6    766    6    749    6    664    6    783    6    699    6    787    6    698    6    702    6    726    6    704    6    662    6    754    6    832    6    646    6    748    6    760    6    689    6    725    6    690    6    758    6    719    6    691    6    650    6    741    6    725    6    703    6    741    6    773    6    773    6    662    6    717    6    748    6    956    6    761    6    726    6    649    6    712    6    768    6    695    6    717    6    736    6    721    6    748    6    690    6    728    6    790    6    633    6    778    6    935    6    664    6    688    6    683    6    693    6    741    6    729    6    731    6    798    6    689    6    677    6    774    6    817    6    821    6    773    6    724    6    714    6    687    6    716    6     857    6     804    6     822    6     875    6     645    6     787    6     718    6     801    6     762    6     757    6     747    6     635    6     688    6     822    6     675    6     726    6     809    6     784    6     681    6     777    6     704    6     901    6     805    6     818    6     656    6     731    6     719    6     721    6     833    6     798    6     779    6     814    6     745    6     773    6     783    6     790    6     876    6     746    6     728    6     774    6     802    6     709    6     694    6     805    6     771    6     731    6     702    6     683    6     835    6     718    6     716    6     732    6     756    6     795    6     697    6     736    6     817    6     825    6     797    6     808    6     856    6     715    6     797    6     715    6
 │         │    │    │    │    │                <--- 24 ----- 831 ----- 1757 ----- 2603 ----- 3203 ----- 3785 ----- 4528 ----- 5363 ----- 6140 ----- 6637 ----- 7408 ----- 8093 ----- 8791 ----- 9570 ----- 10294 ----- 11255 ----- 11983 ----- 12580 ----- 13354 ----- 14124 ----- 14691 ----- 15543 ----- 16249 ----- 16977 ----- 17705 ----- 18576 ----- 19486 ----- 20332 ----- 20948 ----- 21684 ----- 22474 ----- 23126 ----- 23810 ----- 24820 ----- 25546 ----- 26346 ----- 27101 ----- 27839 ----- 28613 ----- 29370 ----- 30143 ----- 31009 ----- 31638 ----- 32418 ----- 33101 ----- 33962 ----- 34607 ----- 35441 ----- 36260 ----- 37083 ----- 37992 ----- 38756 ----- 39463 ----- 40388 ----- 41148 ----- 41819 ----- 42646 ----- 43490 ----- 44157 ----- 44961 ----- 45767 ----- 46464 ----- 47120 ----- 47983 ----- 48614 ----- 49253 ----- 49877 ----- 50534 ----- 51206 ----- 52003 ----- 52768 ----- 53364 ----- 54191 ----- 54861 ----- 55696 ----- 56364 ----- 57039 ----- 57761 ----- 58441 ----- 59034 ----- 59809 ----- 60723 ----- 61281 ----- 62045 ----- 62830 ----- 63479 ----- 64200 ----- 64852 ----- 65634 ----- 66342 ----- 66995 ----- 67560 ----- 68311 ----- 69032 ----- 69710 ----- 70461 ----- 71270 ----- 72079 ----- 72672 ----- 73377 ----- 74140 ----- 75260 ----- 76048 ----- 76770 ----- 77334 ----- 78029 ----- 78829 ----- 79490 ----- 80195 ----- 80937 ----- 81649 ----- 82413 ----- 83064 ----- 83790 ----- 84631 ----- 85157 ----- 85975 ----- 87062 ----- 87659 ----- 88305 ----- 88942 ----- 89599 ----- 90349 ----- 91076 ----- 91807 ----- 92661 ----- 93310 ----- 93934 ----- 94746 ----- 95634 ----- 96529 ----- 97339 ----- 98058 ----- 98757 ----- 99401 ----- 100103 ----- 101060 ----- 101925 ----- 102821 ----- 103809 ----- 104364 ----- 105198 ----- 105905 ----- 106764 ----- 107554 ----- 108335 ----- 109096 ----- 109627 ----- 110274 ----- 111171 ----- 111792 ----- 112499 ----- 113362 ----- 114180 ----- 114796 ----- 115600 ----- 116264 ----- 117284 ----- 118139 ----- 119017 ----- 119578 ----- 120295 ----- 120990 ----- 121688 ----- 122593 ----- 123435 ----- 124244 ----- 125116 ----- 125861 ----- 126659 ----- 127474 ----- 128302 ----- 129281 ----- 130028 ----- 130739 ----- 131538 ----- 132388 ----- 133062 ----- 133705 ----- 134560 ----- 135353 ----- 136070 ----- 136729 ----- 137349 ----- 138257 ----- 138949 ----- 139638 ----- 140358 ----- 141124 ----- 141961 ----- 142611 ----- 143338 ----- 144215 ----- 145106 ----- 145947 ----- 146808 ----- 147752 ----- 148439 ----- 149280 ----- 149967
 │         │    │    │    │    │   histogram(2)=  0           1            1.5e+05           1
 │         │    │    │    │    │                <--- 'Customer#000000024' --------- 'Customer#000149967'
 │         │    │    │    │    │   histogram(3)=  0                     1                     1.5e+05                  1
 │         │    │    │    │    │                <--- '  o42yFlDeaIXAVs,CZ5xLCbcr6AA,KENZINH' --------- 'zzwaB nX4gq,chWKAjsg2v9mjKDMjzE'
 │         │    │    │    │    │   histogram(4)=  0 5970 0 6195 0 6735 0 6255 0 6120 0 5400 0 6390 0 5925 0 6120 0 5985 0 6015 0 6075 0 5985 0 6015 0 6330 0 5985 0 5760 0 5835 0 5400 0 6150 0 5745 0 6375 0 5715 0 5670 0 5850
 │         │    │    │    │    │                <--- 0 ---- 1 ---- 2 ---- 3 ---- 4 ---- 5 ---- 6 ---- 7 ---- 8 ---- 9 ---- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
 │         │    │    │    │    │   histogram(5)=  0          1          1.5e+05          1
 │         │    │    │    │    │                <--- '10-101-662-5213' --------- '34-993-352-7344'
 │         │    │    │    │    │   histogram(6)=  0          15          1.4997e+05       15
 │         │    │    │    │    │                <--- -998.5999755859375 ------------ 9999.5703125
 │         │    │    │    │    │   histogram(8)=  0                                                  1                                                  1.5e+05                                                      1
 │         │    │    │    │    │                <--- ' Ability tonight concern special mother back. Blood share increase energy develop important. De' --------- 'zen view begin yard network. Training indicate question media share fine make. Cultural appear dream fr'
 │         │    │    │    │    ├── key: (1)
 │         │    │    │    │    └── fd: (1)-->(2-6,8)
 │         │    │    │    ├── inner-join (lookup lineitem)
 │         │    │    │    │    ├── save-table-name: q10_lookup_join_8
 │         │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null) l_orderkey:22(int!null) l_extendedprice:27(float!null) l_discount:28(float!null) l_returnflag:30(char!null)
 │         │    │    │    │    ├── key columns: [11] = [22]
 │         │    │    │    │    ├── stats: [rows=90769.8169, distinct(11)=62785.5769, null(11)=0, distinct(12)=40371.9872, null(12)=0, distinct(15)=92, null(15)=0, distinct(22)=62785.5769, null(22)=0, distinct(27)=85832.4186, null(27)=0, distinct(28)=11, null(28)=0, distinct(30)=1, null(30)=0, distinct(27,28)=88053.4917, null(27,28)=0]
 │         │    │    │    │    ├── fd: ()-->(30), (11)-->(12,15), (11)==(22), (22)==(11)
 │         │    │    │    │    ├── index-join orders
 │         │    │    │    │    │    ├── save-table-name: q10_index_join_9
 │         │    │    │    │    │    ├── columns: o_orderkey:11(int!null) o_custkey:12(int!null) o_orderdate:15(date!null)
 │         │    │    │    │    │    ├── stats: [rows=62785.5769, distinct(11)=62785.5769, null(11)=0, distinct(12)=47323.2093, null(12)=0, distinct(15)=92, null(15)=0]
 │         │    │    │    │    │    │   histogram(15)=  0       0        3323.1      300       6150      1350      7050      1200      6450      900       6750      1200      6750      1350      7050      900       7050      900       3525     587.5
 │         │    │    │    │    │    │                 <--- '1993-09-30' -------- '1993-10-07' ------ '1993-10-18' ------ '1993-10-29' ------ '1993-11-07' ------ '1993-11-20' ------ '1993-12-02' ------ '1993-12-13' ------ '1993-12-24' ------ '1993-12-31'
 │         │    │    │    │    │    ├── key: (11)
 │         │    │    │    │    │    ├── fd: (11)-->(12,15)
 │         │    │    │    │    │    └── scan orders@o_od
 │         │    │    │    │    │         ├── save-table-name: q10_scan_10
 │         │    │    │    │    │         ├── columns: o_orderkey:11(int!null) o_orderdate:15(date!null)
 │         │    │    │    │    │         ├── constraint: /15/11: [/'1993-10-01' - /'1993-12-31']
 │         │    │    │    │    │         ├── stats: [rows=62785.5769, distinct(11)=62785.5769, null(11)=0, distinct(15)=92, null(15)=0]
 │         │    │    │    │    │         │   histogram(11)=  0           0            0 0.041857 312.55 0.041857 317.61 0.041857 315.43 0.041857 322.47 0.041857 312.21 0.041857 317.36 0.041857 306.06 0.041857 320.04 0.041857 307.23 0.041857 312.8 0.041857 311.84 0.041857 304.72 0.041857 318.99 0.041857 312.04 0.041857 314.85 0.041857 311.29 0.041857 314.01 0.041857 318.66 0.041857 303.13 0.041857 313.13 0.041857 314.72 0.041857 316.94 0.041857 313.84 0.041857 314.72 0.041857 315.35 0.041857 316.98 0.041857 314.77 0.041857 306.94 0.041857 318.32 0.041857 318.87 0.041857 309.87 0.041857 302.71 0.041857 316.27 0.041857 307.19 0.041857  317.53 0.041857  317.15 0.041857  315.73 0.041857  305.68 0.041857  313.01 0.041857  322.22 0.041857  314.93 0.041857  308.99 0.041857  307.98 0.041857  320.79 0.041857  314.01 0.041857  307.65 0.041857  325.4 0.041857  312.55 0.041857  309.24 0.041857  318.87 0.041857  312.63 0.041857  307.82 0.041857  309.16 0.041857  317.53 0.041857  308.91 0.041857  314.3 0.041857  316.73 0.041857  322.09 0.041857  317.95 0.041857  313.63 0.041857  325.19 0.041857  312.63 0.041857  322.68 0.041857  317.44 0.041857  312.55 0.041857  318.07 0.041857  306.44 0.041857  308.4 0.041857  316.44 0.041857  314.51 0.041857  311.17 0.041857  326.69 0.041857  308.91 0.041857  311.08 0.041857  320.79 0.041857  324.22 0.041857  319.41 0.041857  312.92 0.041857  309.11 0.041857  317.82 0.041857  319.79 0.041857  317.82 0.041857  323.35 0.041857  320.08 0.041857  312.46 0.041857  314.51 0.041857  302.08 0.041857  307.23 0.041857  320.16 0.041857  314.93 0.041857  313.26 0.041857  308.03 0.041857  316.98 0.041857  307.65 0.041857  313.59 0.041857  313.84 0.041857  314.35 0.041857  306.85 0.041857  315.98 0.041857  314.43 0.041857  313.26 0.041857  319.49 0.041857  314.64 0.041857  312.55 0.041857  309.62 0.041857  317.49 0.041857  313.84 0.041857  330.5 0.041857  314.14 0.041857  310.58 0.041857  321.38 0.041857  326.19 0.041857  309.11 0.041857  309.11 0.041857  310.83 0.041857  318.49 0.041857  312.34 0.041857  307.44 0.041857  309.45 0.041857  315.48 0.041857  308.7 0.041857  305.68 0.041857  305.47 0.041857  315.23 0.041857  306.98 0.041857  311.29 0.041857  314.35 0.041857  315.94 0.041857  311.42 0.041857  306.39 0.041857  312.17 0.041857  323.43 0.041857  308.61 0.041857  314.64 0.041857  303.76 0.041857  309.74 0.041857  313.72 0.041857  312.71 0.041857  323.39 0.041857  312 0.041857  316.4 0.041857  308.44 0.041857  313.51 0.041857  316.56 0.041857  319.24 0.041857  311.12 0.041857  308.61 0.041857  314.51 0.041857  321.04 0.041857  314.05 0.041857  320.21 0.041857  313.76 0.041857  316.1 0.041857  311.37 0.041857  319.83 0.041857  314.01 0.041857  314.43 0.041857  313.89 0.041857  318.78 0.041857  312.67 0.041857  325.56 0.041857  322.42 0.041857  324.48 0.041857  315.9 0.041857  320.04 0.041857  319.03 0.041857  320.46 0.041857  313.72 0.041857  321.29 0.041857  328.16 0.041857  320.25 0.041857  324.69 0.041857  324.85 0.041857  325.69 0.041857  322.34 0.041857  313.59 0.041857  318.24 0.041857  314.1 0.041857  328.79 0.041857  328.2 0.041857  313.97 0.041857  324.6 0.041857  310.08 0.041857  314.47 0.041857  323.68 0.041857  309.78 0.041857  321.42 0.041857  311.88 0.041857  319.37 0.041857  317.03 0.041857  322.51 0.041857  321.17 0.041857  337.07 0.041857  328.45 0.041857  322.26 0.041857  320.25 0.041857  323.97 0.041857  328.16 0.041857  320.92 0.041857  0           0
 │         │    │    │    │    │         │                 <--- -9223372036854775808 ---- 101 ---------- 29157 --------- 61863 --------- 92999 --------- 129156 -------- 157991 -------- 190502 -------- 214884 -------- 249314 -------- 274532 ------- 303776 -------- 332320 -------- 355714 -------- 389377 -------- 418086 -------- 448803 -------- 476966 -------- 507076 -------- 540513 -------- 562754 -------- 592226 -------- 622853 -------- 655073 -------- 685059 -------- 715683 -------- 746757 -------- 779008 -------- 809670 -------- 834690 -------- 867879 -------- 901479 -------- 928615 -------- 950533 -------- 982278 -------- 1007489 -------- 1040134 -------- 1072484 -------- 1103842 -------- 1127938 -------- 1157319 -------- 1193281 -------- 1224068 -------- 1250567 -------- 1276354 -------- 1311328 -------- 1341440 -------- 1366977 ------- 1405216 -------- 1434274 -------- 1460965 -------- 1494564 -------- 1523686 -------- 1549351 -------- 1575968 -------- 1608611 -------- 1635047 ------- 1665378 -------- 1697440 -------- 1733315 -------- 1766247 -------- 1796096 -------- 1834183 -------- 1863302 -------- 1899591 -------- 1932163 -------- 1961216 -------- 1994246 -------- 2018885 ------- 2044965 -------- 2076805 -------- 2107271 -------- 2135332 -------- 2174497 -------- 2200929 -------- 2228928 -------- 2263876 -------- 2301283 -------- 2335268 -------- 2364615 -------- 2391201 -------- 2424034 -------- 2458275 -------- 2491110 -------- 2527878 -------- 2562343 -------- 2591331 -------- 2621792 -------- 2643264 -------- 2668485 -------- 2703013 -------- 2733795 -------- 2763365 -------- 2789154 -------- 2821410 -------- 2846946 -------- 2876774 -------- 2906755 -------- 2937121 -------- 2962086 -------- 2993602 -------- 3024004 -------- 3053568 -------- 3087618 -------- 3118176 -------- 3147237 -------- 3174180 -------- 3206791 -------- 3236775 ------- 3278628 -------- 3308834 -------- 3336486 -------- 3371879 -------- 3410690 -------- 3437284 -------- 3463873 -------- 3491715 -------- 3525026 -------- 3553926 -------- 3579297 -------- 3606117 -------- 3637285 ------- 3663559 -------- 3687650 -------- 3711588 -------- 3742565 -------- 3767622 -------- 3795781 -------- 3826148 -------- 3857635 -------- 3885890 -------- 3910499 -------- 3939297 -------- 3976133 -------- 4002372 -------- 4032928 -------- 4055618 -------- 4082657 -------- 4112550 -------- 4141734 -------- 4178532 ----- 4207203 ------- 4239013 -------- 4265127 -------- 4294885 -------- 4326821 -------- 4360679 -------- 4388710 -------- 4414947 -------- 4445413 -------- 4480550 -------- 4510688 -------- 4541253 -------- 4567175 ------- 4594788 -------- 4618983 -------- 4649284 -------- 4675396 -------- 4701797 -------- 4727808 -------- 4757344 -------- 4782470 -------- 4816867 -------- 4849026 -------- 4882661 ------- 4910144 -------- 4940582 -------- 4970307 -------- 5001057 -------- 5026949 -------- 5058309 -------- 5094560 -------- 5125156 -------- 5158945 -------- 5192832 -------- 5227332 -------- 5259426 -------- 5285222 -------- 5314368 ------- 5340545 -------- 5377254 ------- 5413540 -------- 5439617 ------- 5473345 -------- 5496579 -------- 5523009 -------- 5556065 -------- 5579106 -------- 5610562 -------- 5635110 -------- 5665088 -------- 5693382 -------- 5725604 -------- 5756865 -------- 5799463 -------- 5835940 -------- 5867972 -------- 5898564 -------- 5931842 -------- 5968099 -------- 5999174 --- 9223372036854775807
 │         │    │    │    │    │         │   histogram(15)=  0       0        3323.1      300       6150      1350      7050      1200      6450      900       6750      1200      6750      1350      7050      900       7050      900       3525     587.5
 │         │    │    │    │    │         │                 <--- '1993-09-30' -------- '1993-10-07' ------ '1993-10-18' ------ '1993-10-29' ------ '1993-11-07' ------ '1993-11-20' ------ '1993-12-02' ------ '1993-12-13' ------ '1993-12-24' ------ '1993-12-31'
 │         │    │    │    │    │         ├── key: (11)
 │         │    │    │    │    │         └── fd: (11)-->(15)
 │         │    │    │    │    └── filters
 │         │    │    │    │         └── l_returnflag:30 = 'R' [type=bool, outer=(30), constraints=(/30: [/'R' - /'R']; tight), fd=()-->(30)]
 │         │    │    │    └── filters
 │         │    │    │         └── c_custkey:1 = o_custkey:12 [type=bool, outer=(1,12), constraints=(/1: (/NULL - ]; /12: (/NULL - ]), fd=(1)==(12), (12)==(1)]
 │         │    │    ├── scan nation
 │         │    │    │    ├── save-table-name: q10_scan_11
 │         │    │    │    ├── columns: n_nationkey:40(int!null) n_name:41(char!null)
 │         │    │    │    ├── stats: [rows=25, distinct(40)=25, null(40)=0, distinct(41)=25, null(41)=0]
 │         │    │    │    │   histogram(40)=  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1  0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1   0  1
 │         │    │    │    │                 <--- 0 --- 1 --- 2 --- 3 --- 4 --- 5 --- 6 --- 7 --- 8 --- 9 --- 10 --- 11 --- 12 --- 13 --- 14 --- 15 --- 16 --- 17 --- 18 --- 19 --- 20 --- 21 --- 22 --- 23 --- 24
 │         │    │    │    │   histogram(41)=  0      1      23      1
 │         │    │    │    │                 <--- 'ALGERIA' ---- 'VIETNAM'
 │         │    │    │    ├── key: (40)
 │         │    │    │    └── fd: (40)-->(41)
 │         │    │    └── filters
 │         │    │         └── c_nationkey:4 = n_nationkey:40 [type=bool, outer=(4,40), constraints=(/4: (/NULL - ]; /40: (/NULL - ]), fd=(4)==(40), (40)==(4)]
 │         │    └── projections
 │         │         └── l_extendedprice:27 * (1.0 - l_discount:28) [as=column46:46, type=float, outer=(27,28), immutable]
 │         └── aggregations
 │              ├── sum [as=sum:47, type=float, outer=(46)]
 │              │    └── column46:46 [type=float]
 │              ├── const-agg [as=c_name:2, type=varchar, outer=(2)]
 │              │    └── c_name:2 [type=varchar]
 │              ├── const-agg [as=c_address:3, type=varchar, outer=(3)]
 │              │    └── c_address:3 [type=varchar]
 │              ├── const-agg [as=c_phone:5, type=char, outer=(5)]
 │              │    └── c_phone:5 [type=char]
 │              ├── const-agg [as=c_acctbal:6, type=float, outer=(6)]
 │              │    └── c_acctbal:6 [type=float]
 │              ├── const-agg [as=c_comment:8, type=varchar, outer=(8)]
 │              │    └── c_comment:8 [type=varchar]
 │              └── const-agg [as=n_name:41, type=char, outer=(41)]
 │                   └── n_name:41 [type=char]
 └── 20 [type=int]

----Stats for q10_limit_1----
column_names  row_count  distinct_count  null_count
{c_acctbal}   20         20              0
{c_address}   20         20              0
{c_comment}   20         20              0
{c_custkey}   20         20              0
{c_name}      20         20              0
{c_phone}     20         20              0
{n_name}      20         13              0
{revenue}     20         20              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   20.00          1.00           20.00               1.00                0.00            1.00
{c_address}   20.00          1.00           20.00               1.00                0.00            1.00
{c_comment}   20.00          1.00           20.00               1.00                0.00            1.00
{c_custkey}   20.00          1.00           20.00               1.00                0.00            1.00
{c_name}      20.00          1.00           20.00               1.00                0.00            1.00
{c_phone}     20.00          1.00           20.00               1.00                0.00            1.00
{n_name}      20.00          1.00           20.00               1.54                0.00            1.00
{revenue}     20.00          1.00           20.00               1.00                0.00            1.00

----Stats for q10_sort_2----
column_names  row_count  distinct_count  null_count
{c_acctbal}   0          0               0
{c_address}   0          0               0
{c_comment}   0          0               0
{c_custkey}   0          0               0
{c_name}      0          0               0
{c_phone}     0          0               0
{n_name}      0          0               0
{sum}         0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   36376.00       +Inf <==       36376.00            +Inf <==            0.00            1.00
{c_address}   36376.00       +Inf <==       36376.00            +Inf <==            0.00            1.00
{c_comment}   36376.00       +Inf <==       36376.00            +Inf <==            0.00            1.00
{c_custkey}   36376.00       +Inf <==       36376.00            +Inf <==            0.00            1.00
{c_name}      36376.00       +Inf <==       36376.00            +Inf <==            0.00            1.00
{c_phone}     36376.00       +Inf <==       36376.00            +Inf <==            0.00            1.00
{n_name}      36376.00       +Inf <==       36376.00            +Inf <==            0.00            1.00
{sum}         36376.00       +Inf <==       36376.00            +Inf <==            0.00            1.00

----Stats for q10_group_by_3----
column_names  row_count  distinct_count  null_count
{c_acctbal}   37967      37658           0
{c_address}   37967      38065           0
{c_comment}   37967      38086           0
{c_custkey}   37967      37904           0
{c_name}      37967      37859           0
{c_phone}     37967      38026           0
{n_name}      37967      25              0
{sum}         37967      37881           0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   36376.00       1.04           36376.00            1.04                0.00            1.00
{c_address}   36376.00       1.04           36376.00            1.05                0.00            1.00
{c_comment}   36376.00       1.04           36376.00            1.05                0.00            1.00
{c_custkey}   36376.00       1.04           36376.00            1.04                0.00            1.00
{c_name}      36376.00       1.04           36376.00            1.04                0.00            1.00
{c_phone}     36376.00       1.04           36376.00            1.05                0.00            1.00
{n_name}      36376.00       1.04           36376.00            1455.04 <==         0.00            1.00
{sum}         36376.00       1.04           36376.00            1.04                0.00            1.00

----Stats for q10_project_4----
column_names  row_count  distinct_count  null_count
{c_acctbal}   114705     37658           0
{c_address}   114705     38065           0
{c_comment}   114705     38086           0
{c_custkey}   114705     37904           0
{c_name}      114705     37859           0
{c_phone}     114705     38026           0
{column46}    114705     114608          0
{n_name}      114705     25              0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}   91494.00       1.25           50466.00            1.34                0.00            1.00
{c_address}   91494.00       1.25           50971.00            1.34                0.00            1.00
{c_comment}   91494.00       1.25           50971.00            1.34                0.00            1.00
{c_custkey}   91494.00       1.25           36376.00            1.04                0.00            1.00
{c_name}      91494.00       1.25           50971.00            1.35                0.00            1.00
{c_phone}     91494.00       1.25           50971.00            1.34                0.00            1.00
{column46}    91494.00       1.25           45875.00            2.50 <==            0.00            1.00
{n_name}      91494.00       1.25           25.00               1.00                0.00            1.00

----Stats for q10_inner_join_5----
column_names       row_count  distinct_count  null_count
{c_acctbal}        114705     37658           0
{c_address}        114705     38065           0
{c_comment}        114705     38086           0
{c_custkey}        114705     37904           0
{c_name}           114705     37859           0
{c_nationkey}      114705     25              0
{c_phone}          114705     38026           0
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{n_name}           114705     25              0
{n_nationkey}      114705     25              0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}        91494.00       1.25           50466.00            1.34                0.00            1.00
{c_address}        91494.00       1.25           50971.00            1.34                0.00            1.00
{c_comment}        91494.00       1.25           50971.00            1.34                0.00            1.00
{c_custkey}        91494.00       1.25           36376.00            1.04                0.00            1.00
{c_name}           91494.00       1.25           50971.00            1.35                0.00            1.00
{c_nationkey}      91494.00       1.25           25.00               1.00                0.00            1.00
{c_phone}          91494.00       1.25           50971.00            1.34                0.00            1.00
{l_discount}       91494.00       1.25           11.00               1.00                0.00            1.00
{l_extendedprice}  91494.00       1.25           45565.00            2.33 <==            0.00            1.00
{l_orderkey}       91494.00       1.25           41234.00            1.18                0.00            1.00
{l_returnflag}     91494.00       1.25           1.00                1.00                0.00            1.00
{n_name}           91494.00       1.25           25.00               1.00                0.00            1.00
{n_nationkey}      91494.00       1.25           25.00               1.00                0.00            1.00
{o_custkey}        91494.00       1.25           36376.00            1.04                0.00            1.00
{o_orderdate}      91494.00       1.25           92.00               1.00                0.00            1.00
{o_orderkey}       91494.00       1.25           41234.00            1.18                0.00            1.00

----Stats for q10_inner_join_6----
column_names       row_count  distinct_count  null_count
{c_acctbal}        114705     37658           0
{c_address}        114705     38065           0
{c_comment}        114705     38086           0
{c_custkey}        114705     37904           0
{c_name}           114705     37859           0
{c_nationkey}      114705     25              0
{c_phone}          114705     38026           0
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}        91494.00       1.25           67231.00            1.79                0.00            1.00
{c_address}        91494.00       1.25           68494.00            1.80                0.00            1.00
{c_comment}        91494.00       1.25           68494.00            1.80                0.00            1.00
{c_custkey}        91494.00       1.25           40372.00            1.07                0.00            1.00
{c_name}           91494.00       1.25           68494.00            1.81                0.00            1.00
{c_nationkey}      91494.00       1.25           25.00               1.00                0.00            1.00
{c_phone}          91494.00       1.25           68494.00            1.80                0.00            1.00
{l_discount}       91494.00       1.25           11.00               1.00                0.00            1.00
{l_extendedprice}  91494.00       1.25           56272.00            1.89                0.00            1.00
{l_orderkey}       91494.00       1.25           48164.00            1.01                0.00            1.00
{l_returnflag}     91494.00       1.25           1.00                1.00                0.00            1.00
{o_custkey}        91494.00       1.25           40372.00            1.07                0.00            1.00
{o_orderdate}      91494.00       1.25           92.00               1.00                0.00            1.00
{o_orderkey}       91494.00       1.25           48164.00            1.01                0.00            1.00

----Stats for q10_scan_7----
column_names   row_count  distinct_count  null_count
{c_acctbal}    150000     140628          0
{c_address}    150000     149937          0
{c_comment}    150000     149323          0
{c_custkey}    150000     148813          0
{c_name}       150000     151126          0
{c_nationkey}  150000     25              0
{c_phone}      150000     150872          0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{c_acctbal}    150000.00      1.00           140426.00           1.00                0.00            1.00
{c_address}    150000.00      1.00           150000.00           1.00                0.00            1.00
{c_comment}    150000.00      1.00           150000.00           1.00                0.00            1.00
{c_custkey}    150000.00      1.00           148813.00           1.00                0.00            1.00
{c_name}       150000.00      1.00           150000.00           1.01                0.00            1.00
{c_nationkey}  150000.00      1.00           25.00               1.00                0.00            1.00
{c_phone}      150000.00      1.00           150000.00           1.01                0.00            1.00

----Stats for q10_lookup_join_8----
column_names       row_count  distinct_count  null_count
{l_discount}       114705     11              0
{l_extendedprice}  114705     106228          0
{l_orderkey}       114705     48516           0
{l_returnflag}     114705     1               0
{o_custkey}        114705     37904           0
{o_orderdate}      114705     92              0
{o_orderkey}       114705     48516           0
~~~~
column_names       row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_discount}       90770.00       1.26           11.00               1.00                0.00            1.00
{l_extendedprice}  90770.00       1.26           85832.00            1.24                0.00            1.00
{l_orderkey}       90770.00       1.26           62786.00            1.29                0.00            1.00
{l_returnflag}     90770.00       1.26           1.00                1.00                0.00            1.00
{o_custkey}        90770.00       1.26           40372.00            1.07                0.00            1.00
{o_orderdate}      90770.00       1.26           92.00               1.00                0.00            1.00
{o_orderkey}       90770.00       1.26           62786.00            1.29                0.00            1.00

----Stats for q10_index_join_9----
column_names   row_count  distinct_count  null_count
{o_custkey}    57069      42598           0
{o_orderdate}  57069      92              0
{o_orderkey}   57069      56240           0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_custkey}    62786.00       1.10           47323.00            1.11                0.00            1.00
{o_orderdate}  62786.00       1.10           92.00               1.00                0.00            1.00
{o_orderkey}   62786.00       1.10           62786.00            1.12                0.00            1.00

----Stats for q10_scan_10----
column_names   row_count  distinct_count  null_count
{o_orderdate}  57069      92              0
{o_orderkey}   57069      56240           0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{o_orderdate}  62786.00       1.10           92.00               1.00                0.00            1.00
{o_orderkey}   62786.00       1.10           62786.00            1.12                0.00            1.00

----Stats for q10_scan_11----
column_names   row_count  distinct_count  null_count
{n_name}       25         25              0
{n_nationkey}  25         25              0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       25.00          1.00           25.00               1.00                0.00            1.00
{n_nationkey}  25.00          1.00           25.00               1.00                0.00            1.00
----
----
