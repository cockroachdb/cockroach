import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q20
# Potential Part Promotion
# Identifies suppliers in a particular nation having selected parts that may be
# candidates for a promotional offer.
#
# Identifies suppliers who have an excess of a given part available; an excess
# defined to be more than 50% of the parts like the given part that the supplier
# shipped in a given year for a given nation. Only parts whose names share a
# certain naming convention are considered.
#
# TODO:
#   1. Push 'forest%' prefix filter down into Scan
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q20
SELECT
    s_name,
    s_address
FROM
    supplier,
    nation
WHERE
    s_suppkey IN (
        SELECT
            ps_suppkey
        FROM
            partsupp
        WHERE
            ps_partkey IN (
                SELECT
                    p_partkey
                FROM
                    part
                WHERE
                    p_name LIKE 'forest%'
            )
            AND ps_availqty > (
                SELECT
                    0.5 * sum(l_quantity)
                FROM
                    lineitem
                WHERE
                    l_partkey = ps_partkey
                    AND l_suppkey = ps_suppkey
                    AND l_shipdate >= DATE '1994-01-01'
                    AND l_shipdate < DATE '1994-01-01' + INTERVAL '1' YEAR
            )
    )
    AND s_nationkey = n_nationkey
    AND n_name = 'CANADA'
ORDER BY
    s_name;
----
----
sort
 ├── save-table-name: q20_sort_1
 ├── columns: s_name:2(char!null) s_address:3(varchar!null)
 ├── immutable
 ├── stats: [rows=2.016129e-05, distinct(2)=2.01613e-05, null(2)=0, avgsize(2)=4, distinct(3)=2.01613e-05, null(3)=0, avgsize(3)=4]
 ├── ordering: +2
 └── project
      ├── save-table-name: q20_project_2
      ├── columns: s_name:2(char!null) s_address:3(varchar!null)
      ├── immutable
      ├── stats: [rows=2.016129e-05, distinct(2)=2.01613e-05, null(2)=0, avgsize(2)=4, distinct(3)=2.01613e-05, null(3)=0, avgsize(3)=4]
      └── inner-join (lookup nation)
           ├── save-table-name: q20_lookup_join_3
           ├── columns: s_suppkey:1(int!null) s_name:2(char!null) s_address:3(varchar!null) s_nationkey:4(int!null) n_nationkey:10(int!null) n_name:11(char!null)
           ├── key columns: [4] = [10]
           ├── lookup columns are key
           ├── immutable
           ├── stats: [rows=2.016129e-05, distinct(1)=2e-05, null(1)=0, avgsize(1)=4, distinct(2)=2.01613e-05, null(2)=0, avgsize(2)=4, distinct(3)=2.01613e-05, null(3)=0, avgsize(3)=4, distinct(4)=2.01613e-05, null(4)=0, avgsize(4)=4, distinct(10)=2.01613e-05, null(10)=0, avgsize(10)=4, distinct(11)=2.01613e-05, null(11)=0, avgsize(11)=4]
           ├── key: (1)
           ├── fd: ()-->(11), (1)-->(2-4), (4)==(10), (10)==(4)
           ├── project
           │    ├── save-table-name: q20_project_4
           │    ├── columns: s_suppkey:1(int!null) s_name:2(char!null) s_address:3(varchar!null) s_nationkey:4(int!null)
           │    ├── immutable
           │    ├── stats: [rows=2.016129e-05, distinct(1)=2e-05, null(1)=0, avgsize(1)=4, distinct(2)=2.01613e-05, null(2)=0, avgsize(2)=4, distinct(3)=2.01613e-05, null(3)=0, avgsize(3)=4, distinct(4)=2.01613e-05, null(4)=0, avgsize(4)=4]
           │    ├── key: (1)
           │    ├── fd: (1)-->(2-4)
           │    └── inner-join (lookup supplier)
           │         ├── save-table-name: q20_lookup_join_5
           │         ├── columns: s_suppkey:1(int!null) s_name:2(char!null) s_address:3(varchar!null) s_nationkey:4(int!null) ps_suppkey:17(int!null)
           │         ├── key columns: [17] = [1]
           │         ├── lookup columns are key
           │         ├── immutable
           │         ├── stats: [rows=0.2, distinct(1)=2e-05, null(1)=0, avgsize(1)=4, distinct(2)=0.2, null(2)=0, avgsize(2)=4, distinct(3)=0.2, null(3)=0, avgsize(3)=4, distinct(4)=0.2, null(4)=0, avgsize(4)=4, distinct(17)=2e-05, null(17)=0, avgsize(17)=4]
           │         ├── key: (17)
           │         ├── fd: (1)-->(2-4), (1)==(17), (17)==(1)
           │         ├── distinct-on
           │         │    ├── save-table-name: q20_distinct_on_6
           │         │    ├── columns: ps_suppkey:17(int!null)
           │         │    ├── grouping columns: ps_suppkey:17(int!null)
           │         │    ├── immutable
           │         │    ├── stats: [rows=2e-05, distinct(17)=2e-05, null(17)=0, avgsize(17)=4]
           │         │    ├── key: (17)
           │         │    └── inner-join (lookup part)
           │         │         ├── save-table-name: q20_lookup_join_7
           │         │         ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null) p_partkey:23(int!null) p_name:24(varchar!null) sum:52(float!null)
           │         │         ├── key columns: [16] = [23]
           │         │         ├── lookup columns are key
           │         │         ├── immutable
           │         │         ├── stats: [rows=0.002551704, distinct(16)=2e-05, null(16)=0, avgsize(16)=4, distinct(17)=0.0025517, null(17)=0, avgsize(17)=4, distinct(18)=0.0025517, null(18)=0, avgsize(18)=8, distinct(23)=2e-05, null(23)=0, avgsize(23)=4, distinct(24)=2e-05, null(24)=0, avgsize(24)=4, distinct(52)=0.0025517, null(52)=0, avgsize(52)=8]
           │         │         ├── key: (17,23)
           │         │         ├── fd: (16,17)-->(18,52), (23)-->(24), (16)==(23), (23)==(16)
           │         │         ├── select
           │         │         │    ├── save-table-name: q20_select_8
           │         │         │    ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null) sum:52(float!null)
           │         │         │    ├── immutable
           │         │         │    ├── stats: [rows=127.5852, distinct(16)=127.585, null(16)=0, avgsize(16)=4, distinct(17)=127.585, null(17)=0, avgsize(17)=4, distinct(18)=127.585, null(18)=0, avgsize(18)=8, distinct(52)=127.585, null(52)=0, avgsize(52)=8]
           │         │         │    ├── key: (16,17)
           │         │         │    ├── fd: (16,17)-->(18,52)
           │         │         │    ├── group-by (hash)
           │         │         │    │    ├── save-table-name: q20_group_by_9
           │         │         │    │    ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null) sum:52(float!null)
           │         │         │    │    ├── grouping columns: ps_partkey:16(int!null) ps_suppkey:17(int!null)
           │         │         │    │    ├── stats: [rows=382.7556, distinct(16)=382.756, null(16)=0, avgsize(16)=4, distinct(17)=382.756, null(17)=0, avgsize(17)=4, distinct(18)=382.756, null(18)=0, avgsize(18)=8, distinct(52)=382.756, null(52)=0, avgsize(52)=8, distinct(16,17)=382.756, null(16,17)=0, avgsize(16,17)=8]
           │         │         │    │    ├── key: (16,17)
           │         │         │    │    ├── fd: (16,17)-->(18,52)
           │         │         │    │    ├── inner-join (hash)
           │         │         │    │    │    ├── save-table-name: q20_inner_join_10
           │         │         │    │    │    ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null) l_partkey:35(int!null) l_suppkey:36(int!null) l_quantity:38(float!null) l_shipdate:44(date!null)
           │         │         │    │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
           │         │         │    │    │    ├── stats: [rows=382.7556, distinct(16)=382.756, null(16)=0, avgsize(16)=4, distinct(17)=382.756, null(17)=0, avgsize(17)=4, distinct(18)=375.466, null(18)=0, avgsize(18)=4, distinct(35)=382.756, null(35)=0, avgsize(35)=4, distinct(36)=382.756, null(36)=0, avgsize(36)=4, distinct(38)=49.9763, null(38)=0, avgsize(38)=4, distinct(44)=237.1, null(44)=0, avgsize(44)=4, distinct(16,17)=382.756, null(16,17)=0, avgsize(16,17)=8]
           │         │         │    │    │    ├── fd: (16,17)-->(18), (16)==(35), (35)==(16), (17)==(36), (36)==(17)
           │         │         │    │    │    ├── index-join lineitem
           │         │         │    │    │    │    ├── save-table-name: q20_index_join_11
           │         │         │    │    │    │    ├── columns: l_partkey:35(int!null) l_suppkey:36(int!null) l_quantity:38(float!null) l_shipdate:44(date!null)
           │         │         │    │    │    │    ├── stats: [rows=945631.6, distinct(35)=198102, null(35)=0, avgsize(35)=4, distinct(36)=9920, null(36)=0, avgsize(36)=4, distinct(38)=50, null(38)=0, avgsize(38)=4, distinct(44)=365, null(44)=0, avgsize(44)=4]
           │         │         │    │    │    │    │   histogram(44)=  0      4202      26410      3001      27010      3001      28811      3001      28211      4802      28811      1200      28811      3001      28211      1801      27610      3001      27010      3001      28211      3001      28211      1200      27610      3601      28811      2401      27610      3601      28211      1801      28811      1200      27010      4202      27010      3601      27010      3601      26410      3601      27610      2401      28211      4202      27010      3601      25810      3601      28811      3601      28811      2401      27010      3001      28211      2401      28211      2401      28211      2401      17570      2510
           │         │         │    │    │    │    │                 <--- '1994-01-01' ------- '1994-01-11' ------- '1994-01-22' ------- '1994-02-05' ------- '1994-02-18' ------- '1994-03-01' ------- '1994-03-13' ------- '1994-03-26' ------- '1994-04-06' ------- '1994-04-17' ------- '1994-04-27' ------- '1994-05-10' ------- '1994-05-21' ------- '1994-06-03' ------- '1994-06-17' ------- '1994-06-27' ------- '1994-07-13' ------- '1994-07-27' ------- '1994-08-06' ------- '1994-08-19' ------- '1994-08-30' ------- '1994-09-11' ------- '1994-09-21' ------- '1994-10-03' ------- '1994-10-13' ------- '1994-10-26' ------- '1994-11-08' ------- '1994-11-19' ------- '1994-12-01' ------- '1994-12-13' ------- '1994-12-23' ------- '1994-12-31'
           │         │         │    │    │    │    └── scan lineitem@l_sd
           │         │         │    │    │    │         ├── save-table-name: q20_scan_12
           │         │         │    │    │    │         ├── columns: l_orderkey:34(int!null) l_linenumber:37(int!null) l_shipdate:44(date!null)
           │         │         │    │    │    │         ├── constraint: /44/34/37: [/'1994-01-01' - /'1994-12-31']
           │         │         │    │    │    │         ├── stats: [rows=945631.6, distinct(34)=748681, null(34)=0, avgsize(34)=4, distinct(37)=7, null(37)=0, avgsize(37)=4, distinct(44)=365, null(44)=0, avgsize(44)=4]
           │         │         │    │    │    │         │   histogram(34)=  0 94.527 4633.6 94.527  4633.6 94.527  4633.6 94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527  4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4633.6  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527   4728.1  94.527
           │         │         │    │    │    │         │                 <--- 576 --------- 38535 -------- 66885 -------- 93380 -------- 127425 -------- 157218 -------- 184483 -------- 215330 -------- 252869 -------- 283878 -------- 313798 -------- 337056 -------- 372549 -------- 399591 -------- 426245 -------- 460578 -------- 498439 -------- 526049 -------- 554468 -------- 577921 -------- 609187 -------- 639524 -------- 665345 -------- 686180 -------- 721539 -------- 755680 -------- 782756 -------- 814496 -------- 845446 -------- 872130 -------- 910912 -------- 933697 -------- 965184 -------- 1000353 -------- 1038658 -------- 1073667 -------- 1097891 -------- 1131330 -------- 1157732 -------- 1179943 -------- 1206401 -------- 1230150 -------- 1261824 -------- 1293217 -------- 1326754 -------- 1357573 -------- 1390145 -------- 1429312 -------- 1460418 -------- 1491104 -------- 1523937 -------- 1559812 -------- 1591653 -------- 1615174 -------- 1646759 -------- 1670465 -------- 1696321 -------- 1724192 -------- 1748033 -------- 1777570 -------- 1807428 -------- 1836962 -------- 1872481 -------- 1902817 -------- 1928324 -------- 1960775 -------- 1985989 -------- 2019107 -------- 2044613 -------- 2071490 -------- 2101959 -------- 2135555 -------- 2164486 -------- 2186337 -------- 2213989 -------- 2246309 -------- 2276992 -------- 2306403 -------- 2329921 -------- 2354977 -------- 2380711 -------- 2410529 -------- 2437920 -------- 2462017 -------- 2483714 -------- 2513920 -------- 2542855 -------- 2574112 -------- 2596035 -------- 2625031 -------- 2658051 -------- 2695046 -------- 2725222 -------- 2754245 -------- 2777702 -------- 2804896 -------- 2844579 -------- 2873860 -------- 2903459 -------- 2933249 -------- 2965479 -------- 2996160 -------- 3022976 -------- 3053152 -------- 3083623 -------- 3111136 -------- 3144033 -------- 3180134 -------- 3209799 -------- 3239394 -------- 3270886 -------- 3297664 -------- 3329444 -------- 3357574 -------- 3380838 -------- 3412196 -------- 3438917 -------- 3462467 -------- 3498629 -------- 3530208 -------- 3562148 -------- 3589889 -------- 3621063 -------- 3655456 -------- 3686724 -------- 3709029 -------- 3738215 -------- 3767687 -------- 3804547 -------- 3831142 -------- 3875111 -------- 3905605 -------- 3933795 -------- 3966593 -------- 3995558 -------- 4020134 -------- 4052513 -------- 4078949 -------- 4114208 -------- 4149762 -------- 4176135 -------- 4207782 -------- 4241376 -------- 4270502 -------- 4304167 -------- 4333669 -------- 4362818 -------- 4393537 -------- 4423076 -------- 4452064 -------- 4491143 -------- 4522723 -------- 4550883 -------- 4581382 -------- 4616002 -------- 4649410 -------- 4680485 -------- 4715584 -------- 4740036 -------- 4771554 -------- 4799461 -------- 4826690 -------- 4855525 -------- 4887974 -------- 4917479 -------- 4950885 -------- 4984195 -------- 5010113 -------- 5033571 -------- 5065472 -------- 5100512 -------- 5129413 -------- 5160069 -------- 5186596 -------- 5221538 -------- 5252964 -------- 5284069 -------- 5314051 -------- 5353026 -------- 5388961 -------- 5424644 -------- 5452676 -------- 5483553 -------- 5516612 -------- 5551041 -------- 5579878 -------- 5612576 -------- 5643427 -------- 5673666 -------- 5709218 -------- 5737221 -------- 5766119 -------- 5795044 -------- 5826560 -------- 5855943 -------- 5889604 -------- 5917607 -------- 5942535 -------- 5969639 -------- 5999557
           │         │         │    │    │    │         │   histogram(37)=  0 2.3953e+05 0 2.0057e+05 0 1.6757e+05 0 1.4232e+05 0 94563 0 68937 0 32151
           │         │         │    │    │    │         │                 <------ 0 ---------- 1 ---------- 2 ---------- 3 -------- 4 ----- 5 ----- 6 -
           │         │         │    │    │    │         │   histogram(44)=  0      4202      26410      3001      27010      3001      28811      3001      28211      4802      28811      1200      28811      3001      28211      1801      27610      3001      27010      3001      28211      3001      28211      1200      27610      3601      28811      2401      27610      3601      28211      1801      28811      1200      27010      4202      27010      3601      27010      3601      26410      3601      27610      2401      28211      4202      27010      3601      25810      3601      28811      3601      28811      2401      27010      3001      28211      2401      28211      2401      28211      2401      17570      2510
           │         │         │    │    │    │         │                 <--- '1994-01-01' ------- '1994-01-11' ------- '1994-01-22' ------- '1994-02-05' ------- '1994-02-18' ------- '1994-03-01' ------- '1994-03-13' ------- '1994-03-26' ------- '1994-04-06' ------- '1994-04-17' ------- '1994-04-27' ------- '1994-05-10' ------- '1994-05-21' ------- '1994-06-03' ------- '1994-06-17' ------- '1994-06-27' ------- '1994-07-13' ------- '1994-07-27' ------- '1994-08-06' ------- '1994-08-19' ------- '1994-08-30' ------- '1994-09-11' ------- '1994-09-21' ------- '1994-10-03' ------- '1994-10-13' ------- '1994-10-26' ------- '1994-11-08' ------- '1994-11-19' ------- '1994-12-01' ------- '1994-12-13' ------- '1994-12-23' ------- '1994-12-31'
           │         │         │    │    │    │         ├── key: (34,37)
           │         │         │    │    │    │         └── fd: (34,37)-->(44)
           │         │         │    │    │    ├── scan partsupp
           │         │         │    │    │    │    ├── save-table-name: q20_scan_13
           │         │         │    │    │    │    ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null)
           │         │         │    │    │    │    ├── stats: [rows=800000, distinct(16)=199241, null(16)=0, avgsize(16)=4, distinct(17)=9920, null(17)=0, avgsize(17)=4, distinct(18)=9920, null(18)=0, avgsize(18)=4, distinct(16,17)=798302, null(16,17)=0, avgsize(16,17)=8]
           │         │         │    │    │    │    │   histogram(16)=  0           0            0 79.993 3911.6 79.993 3941.6 79.993 3926.6 79.993 3926.6 79.993 3926.6 79.993 3916.6 79.993 3908.6 79.993 3912.6 79.993 3934.6 79.993 3934.6 79.993  3929.6 79.993  3923.6 79.993  3932.6 158.99  3918.6 79.993  3915.6 79.993  3907.6 79.993  3912.6 79.993  3914.6 79.993  3922.6 79.993  3914.6 79.993  3921.6 79.993  3909.6 79.993  3927.6 79.993  3913.6 79.993  3913.6 79.993  3904.6 79.993  3913.6 79.993  3920.6 79.993  3913.6 79.993  3904.6 79.993  3904.6 79.993  3908.6 79.993  3908.6 79.993  3944.6 79.993  3916.6 79.993  3930.6 79.993  3904.6 79.993  3927.6 79.993  3923.6 79.993  3911.6 79.993  3911.6 79.993  3914.6 79.993  3913.6 79.993  3913.6 79.993  3922.6 79.993  3901.6 79.993  3922.6 79.993  3924.6 79.993  3920.6 79.993  3921.6 79.993  3930.6 79.993  3925.6 79.993  3913.6 79.993  3924.6 79.993  3939.6 79.993  3928.6 79.993  3924.6 79.993  3918.6 79.993  3928.6 79.993  3916.6 79.993  3911.6 79.993  3936.6 79.993  3933.6 79.993  3831.6 158.99  3903.6 79.993  3911.6 79.993  3913.6 79.993  3911.6 79.993  3909.6 79.993  3913.6 79.993  3920.6 79.993  3910.6 79.993  3906.6 79.993  3918.6 79.993  3910.6 79.993  3908.6 79.993  3910.6 79.993  3911.6 79.993  3903.6 79.993  3903.6 79.993  3904.6 79.993  3923.6 79.993  3933.6 79.993  3928.6 79.993  3834.6 158.99  3928.6 79.993  3904.6 79.993  3943.6 79.993  3909.6 79.993  3943.6 79.993  3918.6 79.993  3919.6 79.993  3923.6 79.993  3916.6 79.993  3942.6 79.993  3934.6 79.993  3922.6 79.993  3908.6 79.993  3919.6 79.993  3910.6 79.993  3943.6  79.993  3912.6  79.993  3916.6  79.993  3951.6  79.993  3919.6  79.993  3906.6  79.993  3920.6  79.993  3941.6  79.993  3913.6  79.993  3905.6  79.993  3909.6  79.993  3909.6  79.993  3905.6  79.993  3913.6  79.993  3918.6  79.993  3934.6  79.993  3902.6  79.993  3907.6  79.993  3923.6  79.993  3922.6  79.993  3926.6  79.993  3917.6  79.993  3827.6  158.99  3911.6  79.993  3911.6  79.993  3937.6  79.993  3904.6  79.993  3975.6  79.993  3905.6  158.99  3917.6  79.993  3918.6  79.993  3906.6  79.993  3930.6  79.993  3917.6  79.993  3909.6  79.993  3916.6  79.993  3912.6  79.993  3922.6  79.993  3912.6  79.993  3907.6  79.993  3905.6  79.993  3912.6  79.993  3931.6  79.993  3913.6  79.993  3918.6  79.993  3920.6  79.993  3911.6  79.993  3902.6  79.993  3917.6  79.993  3920.6  79.993  3915.6  79.993  3904.6  79.993  4056.6  79.993  4020.6  79.993  4006.6  79.993  4046.6  79.993  4006.6  79.993  3998.6  79.993  4012.6  79.993  3985.6  79.993  3991.6  79.993  4009.6  79.993  3989.6  79.993  4032.6  79.993  3989.6  79.993  3990.6  79.993  3985.6  79.993  4024.6  79.993  3993.6  79.993  4000.6  79.993  4039.6  79.993  3987.6  79.993  4016.6  79.993  4017.6  79.993  3990.6  79.993  3998.6  79.993  4002.6  79.993  4005.6  79.993  4003.6  79.993  4000.6  79.993  4026.6  79.993  3995.6  79.993  3997.6  79.993  4014.6  79.993  4008.6  79.993  4002.6  79.993  3989.6  79.993  4017.6  79.993  4003.6  79.993  3988.6  79.993  4028.6  79.993  3997.6  79.993  4000.6  79.993  3998.6  158.99  3904.6  79.993  3990.6  79.993  3989.6  79.993  3997.6  79.993  3988.6  79.993  0           0
           │         │         │    │    │    │    │                 <--- -9223372036854775808 ---- 5 ---------- 925 --------- 2147 -------- 3243 -------- 4346 -------- 5444 -------- 6433 -------- 7290 -------- 8225 -------- 9393 -------- 10561 -------- 11687 -------- 12755 -------- 13905 -------- 14921 -------- 15897 -------- 16739 -------- 17675 -------- 18640 -------- 19705 -------- 20671 -------- 21719 -------- 22602 -------- 23714 -------- 24672 -------- 25620 -------- 26379 -------- 27327 -------- 28366 -------- 29320 -------- 30070 -------- 30837 -------- 31707 -------- 32567 -------- 33809 -------- 34795 -------- 35930 -------- 36688 -------- 37801 -------- 38874 -------- 39798 -------- 40717 -------- 41686 -------- 42635 -------- 43586 -------- 44647 -------- 45188 -------- 46250 -------- 47331 -------- 48366 -------- 49411 -------- 50547 -------- 51636 -------- 52588 -------- 53673 -------- 54877 -------- 55992 -------- 57071 -------- 58085 -------- 59202 -------- 60194 -------- 61109 -------- 62289 -------- 63452 -------- 64350 -------- 65061 -------- 65983 -------- 66930 -------- 67848 -------- 68740 -------- 69687 -------- 70729 -------- 71625 -------- 72441 -------- 73462 -------- 74357 -------- 75226 -------- 76123 -------- 77037 -------- 77774 -------- 78521 -------- 79269 -------- 80341 -------- 81504 -------- 82626 -------- 83571 -------- 84691 -------- 85448 -------- 86681 -------- 87565 -------- 88799 -------- 89810 -------- 90834 -------- 91901 -------- 92892 -------- 94119 -------- 95284 -------- 96346 -------- 97205 -------- 98231 -------- 99141 -------- 100372 -------- 101314 -------- 102304 -------- 103594 -------- 104620 -------- 105437 -------- 106475 -------- 107696 -------- 108646 -------- 109445 -------- 110330 -------- 111220 -------- 112020 -------- 112978 -------- 113996 -------- 115166 -------- 115838 -------- 116694 -------- 117766 -------- 118830 -------- 119934 -------- 120936 -------- 121757 -------- 122685 -------- 123602 -------- 124791 -------- 125549 -------- 126970 -------- 127770 -------- 128776 -------- 129788 -------- 130602 -------- 131740 -------- 132748 -------- 133632 -------- 134629 -------- 135564 -------- 136625 -------- 137559 -------- 138398 -------- 139204 -------- 140136 -------- 141281 -------- 142230 -------- 143246 -------- 144284 -------- 145212 -------- 145869 -------- 146873 -------- 147910 -------- 148889 -------- 149656 -------- 151106 -------- 152338 -------- 153457 -------- 154854 -------- 155973 -------- 157005 -------- 158178 -------- 159002 -------- 159939 -------- 161091 -------- 162000 -------- 163314 -------- 164230 -------- 165157 -------- 165980 -------- 167242 -------- 168207 -------- 169271 -------- 170628 -------- 171503 -------- 172711 -------- 173922 -------- 174853 -------- 175886 -------- 176965 -------- 178073 -------- 179166 -------- 180231 -------- 181505 -------- 182510 -------- 183541 -------- 184734 -------- 185872 -------- 186957 -------- 187866 -------- 189075 -------- 190166 -------- 191061 -------- 192354 -------- 193380 -------- 194445 -------- 195479 -------- 196243 -------- 197170 -------- 198076 -------- 199103 -------- 199994 --- 9223372036854775807
           │         │         │    │    │    │    │   histogram(17)=  0 240 3920 160  3840  160  3840  160  3920  80   3760  240  3920  80   3920  160  3920  80   3920  80   3920  160  3760  320  3920  80   3920  80   3840  160  3920  80   3760  240  3840  240  3920  80   3920  80   3840  160   3920   80   3920   80   3920   80   3920  240   3920  320   3920   80   3920   80   3920   80   3920   80   3920  160   3920  160   3920   80   3920  160   3680  320   3920  160   3840  240   3920   80   3920   80   3840  160   3920   80   3920   80   3840  160   3920   80   3920  320   3920   80   3920  160   3920   80   3920  160   3920  160   3920   80   3920   80   3840  320   3920   80   3680  320   3920  160   3680  400   3840  240   3840  160   3920  240   3920   80   3920  320   3920  320   3920  160   3760  320   3760  240   3920   80   3920   80   3840  160   3840  320   3840  160   3920  160   3920   80   3920   80   3920   80   3920   80   3920  160   3920   80   3840  240   3920   80   3840  160   3840  160   3840  240   3840  160   3920   80   3920  160   3920   80   3840  160   3920   80   3920  240   3920  160   3920  160   3840  160   3920  160   3840   80   3840  240   3840  160   3760  160   3920  160   3840   80   3840  160   3920   80   3920   80   3920   80   3920   80   3840  160   3920  240   3760  160   3840   80   3840  320   3760  160   3680  240   3840  160   3760  320   3840  240   3840  160   3840   80   3840  160   3840   80   3920   80   3920  240   3760  160   3840   80   3920  160   3600  320   3920  160   3840  240   3840   80   3840  160   3840  160   3680  320   3760  240   3840   80   3840  160   3760  400   3840  160   3840  160   3680  320   3840   80   3840   80   3920   80   3840  160   3920  160   3840   80   3920   80   3840  160   3920  320   3760  160   3840  160   3840   80   3840  160   3840   80   3680  320   3920   80   3920  160   3840   80   3840  240   3840   80   3920   80   3920   80   3760  240   3920  160   3840  160   3840  240   3840   80   3680  240   3920   80   3920   80   3680  320   3920   80   3920   80   3920  160   3840  240   3840  160   3840  160   3680  240   3760  160   3920   80   3920   80   3760  240   3840  240   3840   80   3840  160   3760  240   3920  160   3840  240   3680  320   3840  160   3840   80   3760  160   3920  240   3840   80   3840   80   3840  160   3920   80   3680  320   3920  160   3760  160   3840  160   3920   80
           │         │         │    │    │    │    │                 <--- 1 ------ 48 ------ 112 ------ 174 ------ 233 ------ 271 ------ 318 ------ 364 ------ 415 ------ 468 ------ 521 ------ 565 ------ 617 ------ 658 ------ 713 ------ 767 ------ 817 ------ 878 ------ 930 ------ 978 ------ 1034 ------ 1095 ------ 1150 ------ 1193 ------ 1243 ------ 1294 ------ 1348 ------ 1402 ------ 1468 ------ 1507 ------ 1552 ------ 1614 ------ 1673 ------ 1731 ------ 1780 ------ 1834 ------ 1881 ------ 1940 ------ 1994 ------ 2041 ------ 2096 ------ 2153 ------ 2199 ------ 2256 ------ 2304 ------ 2349 ------ 2401 ------ 2451 ------ 2498 ------ 2546 ------ 2599 ------ 2643 ------ 2683 ------ 2731 ------ 2772 ------ 2827 ------ 2869 ------ 2915 ------ 2973 ------ 3023 ------ 3078 ------ 3129 ------ 3184 ------ 3236 ------ 3296 ------ 3353 ------ 3413 ------ 3473 ------ 3521 ------ 3566 ------ 3607 ------ 3657 ------ 3718 ------ 3775 ------ 3813 ------ 3868 ------ 3924 ------ 3971 ------ 4008 ------ 4065 ------ 4123 ------ 4174 ------ 4231 ------ 4269 ------ 4332 ------ 4385 ------ 4436 ------ 4484 ------ 4537 ------ 4588 ------ 4633 ------ 4685 ------ 4733 ------ 4783 ------ 4834 ------ 4874 ------ 4918 ------ 4953 ------ 5008 ------ 5052 ------ 5096 ------ 5147 ------ 5197 ------ 5245 ------ 5292 ------ 5341 ------ 5396 ------ 5449 ------ 5498 ------ 5547 ------ 5602 ------ 5651 ------ 5703 ------ 5742 ------ 5786 ------ 5827 ------ 5865 ------ 5935 ------ 5980 ------ 6050 ------ 6096 ------ 6153 ------ 6208 ------ 6270 ------ 6309 ------ 6358 ------ 6412 ------ 6464 ------ 6518 ------ 6577 ------ 6640 ------ 6676 ------ 6735 ------ 6792 ------ 6835 ------ 6877 ------ 6916 ------ 6968 ------ 7025 ------ 7061 ------ 7107 ------ 7159 ------ 7221 ------ 7264 ------ 7300 ------ 7356 ------ 7390 ------ 7448 ------ 7495 ------ 7547 ------ 7605 ------ 7648 ------ 7707 ------ 7755 ------ 7818 ------ 7858 ------ 7904 ------ 7951 ------ 7992 ------ 8049 ------ 8098 ------ 8144 ------ 8194 ------ 8234 ------ 8282 ------ 8323 ------ 8376 ------ 8433 ------ 8474 ------ 8514 ------ 8564 ------ 8623 ------ 8676 ------ 8734 ------ 8784 ------ 8819 ------ 8857 ------ 8907 ------ 8955 ------ 9012 ------ 9060 ------ 9103 ------ 9157 ------ 9200 ------ 9249 ------ 9301 ------ 9339 ------ 9381 ------ 9430 ------ 9474 ------ 9529 ------ 9579 ------ 9631 ------ 9673 ------ 9732 ------ 9780 ------ 9832 ------ 9886 ------ 9941 ------ 9997
           │         │         │    │    │    │    │   histogram(18)=  0 80  7.9984e+05   80
           │         │         │    │    │    │    │                 <--- 1 ------------ 9998
           │         │         │    │    │    │    ├── key: (16,17)
           │         │         │    │    │    │    └── fd: (16,17)-->(18)
           │         │         │    │    │    └── filters
           │         │         │    │    │         ├── l_partkey:35 = ps_partkey:16 [type=bool, outer=(16,35), constraints=(/16: (/NULL - ]; /35: (/NULL - ]), fd=(16)==(35), (35)==(16)]
           │         │         │    │    │         └── l_suppkey:36 = ps_suppkey:17 [type=bool, outer=(17,36), constraints=(/17: (/NULL - ]; /36: (/NULL - ]), fd=(17)==(36), (36)==(17)]
           │         │         │    │    └── aggregations
           │         │         │    │         ├── sum [as=sum:52, type=float, outer=(38)]
           │         │         │    │         │    └── l_quantity:38 [type=float]
           │         │         │    │         └── const-agg [as=ps_availqty:18, type=int, outer=(18)]
           │         │         │    │              └── ps_availqty:18 [type=int]
           │         │         │    └── filters
           │         │         │         └── ps_availqty:18 > (sum:52 * 0.5) [type=bool, outer=(18,52), immutable, constraints=(/18: (/NULL - ])]
           │         │         └── filters
           │         │              └── p_name:24 LIKE 'forest%' [type=bool, outer=(24), constraints=(/24: [/'forest' - /'foresu'); tight)]
           │         └── filters (true)
           └── filters
                └── n_name:11 = 'CANADA' [type=bool, outer=(11), constraints=(/11: [/'CANADA' - /'CANADA']; tight), fd=()-->(11)]

----Stats for q20_sort_1----
column_names  row_count  distinct_count  null_count
{s_address}   186        186             0
{s_name}      186        186             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_address}   0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_name}      0.00           +Inf <==       0.00                +Inf <==            0.00            1.00

----Stats for q20_project_2----
column_names  row_count  distinct_count  null_count
{s_address}   186        186             0
{s_name}      186        186             0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_address}   0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_name}      0.00           +Inf <==       0.00                +Inf <==            0.00            1.00

----Stats for q20_lookup_join_3----
column_names   row_count  distinct_count  null_count
{n_name}       186        1               0
{n_nationkey}  186        1               0
{s_address}    186        186             0
{s_name}       186        186             0
{s_nationkey}  186        1               0
{s_suppkey}    186        186             0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{n_nationkey}  0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_address}    0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_name}       0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_nationkey}  0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_suppkey}    0.00           +Inf <==       0.00                +Inf <==            0.00            1.00

----Stats for q20_project_4----
column_names   row_count  distinct_count  null_count
{s_address}    4397       4369            0
{s_name}       4397       4373            0
{s_nationkey}  4397       25              0
{s_suppkey}    4397       4397            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_address}    0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_name}       0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_nationkey}  0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_suppkey}    0.00           +Inf <==       0.00                +Inf <==            0.00            1.00

----Stats for q20_lookup_join_5----
column_names   row_count  distinct_count  null_count
{ps_suppkey}   4397       4397            0
{s_address}    4397       4369            0
{s_name}       4397       4373            0
{s_nationkey}  4397       25              0
{s_suppkey}    4397       4397            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_suppkey}   0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_address}    0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_name}       0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_nationkey}  0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{s_suppkey}    0.00           +Inf <==       0.00                +Inf <==            0.00            1.00

----Stats for q20_distinct_on_6----
column_names  row_count  distinct_count  null_count
{ps_suppkey}  4397       4397            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_suppkey}  0.00           +Inf <==       0.00                +Inf <==            0.00            1.00

----Stats for q20_lookup_join_7----
column_names   row_count  distinct_count  null_count
{p_name}       5833       2106            0
{p_partkey}    5833       2106            0
{ps_availqty}  5833       4441            0
{ps_partkey}   5833       2106            0
{ps_suppkey}   5833       4434            0
{sum}          5833       164             0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}       0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{p_partkey}    0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{ps_availqty}  0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{ps_partkey}   0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{ps_suppkey}   0.00           +Inf <==       0.00                +Inf <==            0.00            1.00
{sum}          0.00           +Inf <==       0.00                +Inf <==            0.00            1.00

----Stats for q20_select_8----
column_names   row_count  distinct_count  null_count
{ps_availqty}  542095     9920            0
{ps_partkey}   542095     197197          0
{ps_suppkey}   542095     9920            0
{sum}          542095     246             0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_availqty}  128.00         4235.12 <==    128.00              77.50 <==           0.00            1.00
{ps_partkey}   128.00         4235.12 <==    128.00              1540.60 <==         0.00            1.00
{ps_suppkey}   128.00         4235.12 <==    128.00              77.50 <==           0.00            1.00
{sum}          128.00         4235.12 <==    128.00              1.92 <==            0.00            1.00

----Stats for q20_group_by_9----
column_names   row_count  distinct_count  null_count
{ps_availqty}  543210     9920            0
{ps_partkey}   543210     197252          0
{ps_suppkey}   543210     9920            0
{sum}          543210     246             0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_availqty}  383.00         1418.30 <==    383.00              25.90 <==           0.00            1.00
{ps_partkey}   383.00         1418.30 <==    383.00              515.02 <==          0.00            1.00
{ps_suppkey}   383.00         1418.30 <==    383.00              25.90 <==           0.00            1.00
{sum}          383.00         1418.30 <==    383.00              1.56                0.00            1.00

----Stats for q20_inner_join_10----
column_names   row_count  distinct_count  null_count
{l_partkey}    909455     197252          0
{l_quantity}   909455     50              0
{l_shipdate}   909455     365             0
{l_suppkey}    909455     9920            0
{ps_availqty}  909455     9920            0
{ps_partkey}   909455     197252          0
{ps_suppkey}   909455     9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_partkey}    383.00         2374.56 <==    383.00              515.02 <==          0.00            1.00
{l_quantity}   383.00         2374.56 <==    50.00               1.00                0.00            1.00
{l_shipdate}   383.00         2374.56 <==    237.00              1.54                0.00            1.00
{l_suppkey}    383.00         2374.56 <==    383.00              25.90 <==           0.00            1.00
{ps_availqty}  383.00         2374.56 <==    375.00              26.45 <==           0.00            1.00
{ps_partkey}   383.00         2374.56 <==    383.00              515.02 <==          0.00            1.00
{ps_suppkey}   383.00         2374.56 <==    383.00              25.90 <==           0.00            1.00

----Stats for q20_index_join_11----
column_names  row_count  distinct_count  null_count
{l_partkey}   909455     197252          0
{l_quantity}  909455     50              0
{l_shipdate}  909455     365             0
{l_suppkey}   909455     9920            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_partkey}   945632.00      1.04           198102.00           1.00                0.00            1.00
{l_quantity}  945632.00      1.04           50.00               1.00                0.00            1.00
{l_shipdate}  945632.00      1.04           365.00              1.00                0.00            1.00
{l_suppkey}   945632.00      1.04           9920.00             1.00                0.00            1.00

----Stats for q20_scan_12----
column_names    row_count  distinct_count  null_count
{l_linenumber}  909455     7               0
{l_orderkey}    909455     266035          0
{l_shipdate}    909455     365             0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}  945632.00      1.04           7.00                1.00                0.00            1.00
{l_orderkey}    945632.00      1.04           748681.00           2.81 <==            0.00            1.00
{l_shipdate}    945632.00      1.04           365.00              1.00                0.00            1.00

----Stats for q20_scan_13----
column_names   row_count  distinct_count  null_count
{ps_availqty}  800000     9920            0
{ps_partkey}   800000     199241          0
{ps_suppkey}   800000     9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_availqty}  800000.00      1.00           9920.00             1.00                0.00            1.00
{ps_partkey}   800000.00      1.00           199241.00           1.00                0.00            1.00
{ps_suppkey}   800000.00      1.00           9920.00             1.00                0.00            1.00
----
----
