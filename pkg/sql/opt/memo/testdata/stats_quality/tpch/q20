import file=tpch_schema
----

import file=tpch_stats
----

# --------------------------------------------------
# Q20
# Potential Part Promotion
# Identifies suppliers in a particular nation having selected parts that may be
# candidates for a promotional offer.
#
# Identifies suppliers who have an excess of a given part available; an excess
# defined to be more than 50% of the parts like the given part that the supplier
# shipped in a given year for a given nation. Only parts whose names share a
# certain naming convention are considered.
#
# TODO:
#   1. Push 'forest%' prefix filter down into Scan
# --------------------------------------------------
stats-quality database=tpch stats-quality-prefix=q20
SELECT
    s_name,
    s_address
FROM
    supplier,
    nation
WHERE
    s_suppkey IN (
        SELECT
            ps_suppkey
        FROM
            partsupp
        WHERE
            ps_partkey IN (
                SELECT
                    p_partkey
                FROM
                    part
                WHERE
                    p_name LIKE 'forest%'
            )
            AND ps_availqty > (
                SELECT
                    0.5 * sum(l_quantity)
                FROM
                    lineitem
                WHERE
                    l_partkey = ps_partkey
                    AND l_suppkey = ps_suppkey
                    AND l_shipdate >= DATE '1994-01-01'
                    AND l_shipdate < DATE '1994-01-01' + INTERVAL '1' YEAR
            )
    )
    AND s_nationkey = n_nationkey
    AND n_name = 'CANADA'
ORDER BY
    s_name;
----
----
sort
 ├── save-table-name: q20_sort_1
 ├── columns: s_name:2(char!null) s_address:3(varchar!null)
 ├── immutable
 ├── stats: [rows=1e-06, distinct(2)=1e-06, null(2)=0, distinct(3)=1e-06, null(3)=0]
 ├── ordering: +2
 └── project
      ├── save-table-name: q20_project_2
      ├── columns: s_name:2(char!null) s_address:3(varchar!null)
      ├── immutable
      ├── stats: [rows=1e-06, distinct(2)=1e-06, null(2)=0, distinct(3)=1e-06, null(3)=0]
      └── inner-join (lookup nation)
           ├── save-table-name: q20_lookup_join_3
           ├── columns: s_suppkey:1(int!null) s_name:2(char!null) s_address:3(varchar!null) s_nationkey:4(int!null) n_nationkey:10(int!null) n_name:11(char!null)
           ├── key columns: [4] = [10]
           ├── lookup columns are key
           ├── immutable
           ├── stats: [rows=1e-06, distinct(1)=1.66666666e-07, null(1)=0, distinct(2)=1e-06, null(2)=0, distinct(3)=1e-06, null(3)=0, distinct(4)=1e-06, null(4)=0, distinct(10)=1e-06, null(10)=0, distinct(11)=1e-06, null(11)=0]
           ├── key: (1)
           ├── fd: ()-->(11), (1)-->(2-4), (4)==(10), (10)==(4)
           ├── project
           │    ├── save-table-name: q20_project_4
           │    ├── columns: s_suppkey:1(int!null) s_name:2(char!null) s_address:3(varchar!null) s_nationkey:4(int!null)
           │    ├── immutable
           │    ├── stats: [rows=1e-06, distinct(1)=1.66666666e-07, null(1)=0, distinct(2)=1e-06, null(2)=0, distinct(3)=1e-06, null(3)=0, distinct(4)=1e-06, null(4)=0]
           │    ├── key: (1)
           │    ├── fd: (1)-->(2-4)
           │    └── inner-join (lookup supplier)
           │         ├── save-table-name: q20_lookup_join_5
           │         ├── columns: s_suppkey:1(int!null) s_name:2(char!null) s_address:3(varchar!null) s_nationkey:4(int!null) ps_suppkey:17(int!null)
           │         ├── key columns: [17] = [1]
           │         ├── lookup columns are key
           │         ├── immutable
           │         ├── stats: [rows=0.00166666666, distinct(1)=1.66666666e-07, null(1)=0, distinct(2)=0.00166666666, null(2)=0, distinct(3)=0.00166666666, null(3)=0, distinct(4)=0.00166666666, null(4)=0, distinct(17)=1.66666666e-07, null(17)=0]
           │         ├── key: (17)
           │         ├── fd: (1)-->(2-4), (1)==(17), (17)==(1)
           │         ├── distinct-on
           │         │    ├── save-table-name: q20_distinct_on_6
           │         │    ├── columns: ps_suppkey:17(int!null)
           │         │    ├── grouping columns: ps_suppkey:17(int!null)
           │         │    ├── immutable
           │         │    ├── stats: [rows=1.66666666e-07, distinct(17)=1.66666666e-07, null(17)=0]
           │         │    ├── key: (17)
           │         │    └── inner-join (lookup part)
           │         │         ├── save-table-name: q20_lookup_join_7
           │         │         ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null) p_partkey:23(int!null) p_name:24(varchar!null) sum:52(float!null)
           │         │         ├── key columns: [16] = [23]
           │         │         ├── lookup columns are key
           │         │         ├── immutable
           │         │         ├── stats: [rows=2.11745534e-05, distinct(16)=1.66666667e-07, null(16)=0, distinct(17)=2.11745534e-05, null(17)=0, distinct(18)=2.11745534e-05, null(18)=0, distinct(23)=1.66666667e-07, null(23)=0, distinct(24)=1.66666667e-07, null(24)=0, distinct(52)=2.11745534e-05, null(52)=0]
           │         │         ├── key: (17,23)
           │         │         ├── fd: (16,17)-->(18,52), (23)-->(24), (16)==(23), (23)==(16)
           │         │         ├── select
           │         │         │    ├── save-table-name: q20_select_8
           │         │         │    ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null) sum:52(float!null)
           │         │         │    ├── immutable
           │         │         │    ├── stats: [rows=127.04732, distinct(16)=127.04732, null(16)=0, distinct(17)=127.04732, null(17)=0, distinct(18)=127.04732, null(18)=0, distinct(52)=127.04732, null(52)=0]
           │         │         │    ├── key: (16,17)
           │         │         │    ├── fd: (16,17)-->(18,52)
           │         │         │    ├── group-by
           │         │         │    │    ├── save-table-name: q20_group_by_9
           │         │         │    │    ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null) sum:52(float!null)
           │         │         │    │    ├── grouping columns: ps_partkey:16(int!null) ps_suppkey:17(int!null)
           │         │         │    │    ├── stats: [rows=381.14196, distinct(16)=381.14196, null(16)=0, distinct(17)=381.14196, null(17)=0, distinct(18)=381.14196, null(18)=0, distinct(52)=381.14196, null(52)=0, distinct(16,17)=381.14196, null(16,17)=0]
           │         │         │    │    ├── key: (16,17)
           │         │         │    │    ├── fd: (16,17)-->(18,52)
           │         │         │    │    ├── inner-join (hash)
           │         │         │    │    │    ├── save-table-name: q20_inner_join_10
           │         │         │    │    │    ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null) l_partkey:35(int!null) l_suppkey:36(int!null) l_quantity:38(float!null) l_shipdate:44(date!null)
           │         │         │    │    │    ├── multiplicity: left-rows(exactly-one), right-rows(zero-or-more)
           │         │         │    │    │    ├── stats: [rows=381.14196, distinct(16)=381.14196, null(16)=0, distinct(17)=381.14196, null(17)=0, distinct(18)=373.912838, null(18)=0, distinct(35)=381.14196, null(35)=0, distinct(36)=381.14196, null(36)=0, distinct(38)=49.9755425, null(38)=0, distinct(44)=236.532917, null(44)=0, distinct(16,17)=381.14196, null(16,17)=0]
           │         │         │    │    │    ├── fd: (16,17)-->(18), (16)==(35), (35)==(16), (17)==(36), (36)==(17)
           │         │         │    │    │    ├── index-join lineitem
           │         │         │    │    │    │    ├── save-table-name: q20_index_join_11
           │         │         │    │    │    │    ├── columns: l_partkey:35(int!null) l_suppkey:36(int!null) l_quantity:38(float!null) l_shipdate:44(date!null)
           │         │         │    │    │    │    ├── stats: [rows=941644.906, distinct(35)=198074.93, null(35)=0, distinct(36)=9920, null(36)=0, distinct(38)=50, null(38)=0, distinct(44)=365, null(44)=0]
           │         │         │    │    │    │    │   histogram(44)=  0       0        23409      3601      28810      2400      26409      3001      27010      3001      28210      4201      26409      3601      28810      4201      28210      1800      25209      4801      27010      2400      28810      1800      28810      4201      28810      3001      25809      4201      28810      1800      27610      3001      28810      2400      27010      2400      28810      3001      26409      3601      28810      1800      26409      3001      26409      3601      28810      3001      27010      4201      28210      1800      25809      4801      28210      1800      28810      2400      28210      1800      22590      2510
           │         │         │    │    │    │    │                 <--- '1993-12-31' ------- '1994-01-14' ------- '1994-01-26' ------- '1994-02-07' ------- '1994-02-18' ------- '1994-03-03' ------- '1994-03-17' ------- '1994-03-27' ------- '1994-04-07' ------- '1994-04-18' ------- '1994-05-02' ------- '1994-05-18' ------- '1994-05-30' ------- '1994-06-12' ------- '1994-06-21' ------- '1994-07-03' ------- '1994-07-13' ------- '1994-07-24' ------- '1994-08-05' ------- '1994-08-19' ------- '1994-08-28' ------- '1994-09-08' ------- '1994-09-19' ------- '1994-09-29' ------- '1994-10-13' ------- '1994-10-24' ------- '1994-11-06' ------- '1994-11-16' ------- '1994-11-29' ------- '1994-12-12' ------- '1994-12-21' ------- '1994-12-31'
           │         │         │    │    │    │    └── scan lineitem@l_sd
           │         │         │    │    │    │         ├── save-table-name: q20_scan_12
           │         │         │    │    │    │         ├── columns: l_orderkey:34(int!null) l_linenumber:37(int!null) l_shipdate:44(date!null)
           │         │         │    │    │    │         ├── constraint: /44/34/37: [/'1994-01-01' - /'1994-12-31']
           │         │         │    │    │    │         ├── stats: [rows=941644.906, distinct(34)=746265.624, null(34)=0, distinct(37)=7, null(37)=0, distinct(44)=365, null(44)=0]
           │         │         │    │    │    │         │   histogram(34)=  0 94.129 4614 94.129  4614 94.129  4614 94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129  4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4614  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129   4708.2  94.129
           │         │         │    │    │    │         │                 <--- 1827 ------ 34496 ------ 63716 ------ 98439 ------ 123939 ------ 148738 ------ 182148 ------ 209924 ------ 238370 ------ 270693 ------ 295108 ------ 324678 ------ 359395 ------ 394149 ------ 417027 ------ 443588 ------ 477184 ------ 505383 ------ 532930 ------ 561569 ------ 591975 ------ 620994 ------ 640451 ------ 671013 ------ 697697 ------ 727335 ------ 761927 ------ 794691 ------ 826017 ------ 853923 ------ 886402 ------ 917824 ------ 957025 ------ 986721 ------ 1015266 ------ 1039936 ------ 1071427 ------ 1101894 ------ 1134758 ------ 1166758 ------ 1194502 ------ 1227714 ------ 1257283 ------ 1296486 ------ 1323655 ------ 1355584 ------ 1380899 ------ 1411457 ------ 1442050 ------ 1472769 ------ 1499779 ------ 1529156 ------ 1562241 ------ 1591973 ------ 1615366 ------ 1643077 ------ 1675046 ------ 1709153 ------ 1740705 ------ 1765219 ------ 1799268 ------ 1834467 ------ 1867684 ------ 1895621 ------ 1925123 ------ 1961186 ------ 1986343 ------ 2015366 ------ 2056420 ------ 2082050 ------ 2109863 ------ 2144065 ------ 2170976 ------ 2194950 ------ 2225635 ------ 2257088 ------ 2287237 ------ 2318500 ------ 2352833 ------ 2384454 ------ 2416996 ------ 2444995 ------ 2473863 ------ 2502596 ------ 2528004 ------ 2552994 ------ 2582850 ------ 2611847 ------ 2635874 ------ 2658404 ------ 2692800 ------ 2728451 ------ 2757316 ------ 2785923 ------ 2815746 ------ 2842273 ------ 2873253 ------ 2898884 ------ 2921506 ------ 2950438 ------ 2975687 ------ 3006145 ------ 3032416 ------ 3060706 ------ 3081606 ------ 3107234 ------ 3136576 ------ 3166787 ------ 3198118 ------ 3224199 ------ 3246855 ------ 3274533 ------ 3305156 ------ 3342849 ------ 3370567 ------ 3398336 ------ 3420039 ------ 3453315 ------ 3482470 ------ 3515873 ------ 3546375 ------ 3576711 ------ 3605570 ------ 3633986 ------ 3666820 ------ 3696037 ------ 3722403 ------ 3752609 ------ 3788226 ------ 3815649 ------ 3849542 ------ 3881062 ------ 3912836 ------ 3947072 ------ 3976963 ------ 4007653 ------ 4031782 ------ 4064992 ------ 4091649 ------ 4122051 ------ 4163459 ------ 4192800 ------ 4224160 ------ 4252550 ------ 4284514 ------ 4316292 ------ 4343845 ------ 4378723 ------ 4402400 ------ 4429539 ------ 4462208 -------- 4499655 -------- 4529734 -------- 4553408 -------- 4592321 -------- 4617218 -------- 4645987 -------- 4670951 -------- 4704710 -------- 4740965 -------- 4776195 -------- 4810085 -------- 4848674 -------- 4880199 -------- 4912195 -------- 4943712 -------- 4976358 -------- 5006080 -------- 5030945 -------- 5066915 -------- 5092134 -------- 5130084 -------- 5162915 -------- 5190757 -------- 5226980 -------- 5255876 -------- 5282979 -------- 5321952 -------- 5359844 -------- 5390855 -------- 5417990 -------- 5452545 -------- 5483234 -------- 5513511 -------- 5551559 -------- 5593699 -------- 5623360 -------- 5651270 -------- 5680262 -------- 5705031 -------- 5734499 -------- 5762342 -------- 5787495 -------- 5812449 -------- 5842597 -------- 5870146 -------- 5898596 -------- 5939457 -------- 5965574 -------- 5999808
           │         │         │    │    │    │         │   histogram(37)=  0 2.3579e+05 0 1.9991e+05 0 1.6724e+05 0 1.3673e+05 0 1.016e+05 0 67327 0 33052
           │         │         │    │    │    │         │                 <------ 0 ---------- 1 ---------- 2 ---------- 3 ---------- 4 ------- 5 ----- 6 -
           │         │         │    │    │    │         │   histogram(44)=  0       0        23409      3601      28810      2400      26409      3001      27010      3001      28210      4201      26409      3601      28810      4201      28210      1800      25209      4801      27010      2400      28810      1800      28810      4201      28810      3001      25809      4201      28810      1800      27610      3001      28810      2400      27010      2400      28810      3001      26409      3601      28810      1800      26409      3001      26409      3601      28810      3001      27010      4201      28210      1800      25809      4801      28210      1800      28810      2400      28210      1800      22590      2510
           │         │         │    │    │    │         │                 <--- '1993-12-31' ------- '1994-01-14' ------- '1994-01-26' ------- '1994-02-07' ------- '1994-02-18' ------- '1994-03-03' ------- '1994-03-17' ------- '1994-03-27' ------- '1994-04-07' ------- '1994-04-18' ------- '1994-05-02' ------- '1994-05-18' ------- '1994-05-30' ------- '1994-06-12' ------- '1994-06-21' ------- '1994-07-03' ------- '1994-07-13' ------- '1994-07-24' ------- '1994-08-05' ------- '1994-08-19' ------- '1994-08-28' ------- '1994-09-08' ------- '1994-09-19' ------- '1994-09-29' ------- '1994-10-13' ------- '1994-10-24' ------- '1994-11-06' ------- '1994-11-16' ------- '1994-11-29' ------- '1994-12-12' ------- '1994-12-21' ------- '1994-12-31'
           │         │         │    │    │    │         ├── key: (34,37)
           │         │         │    │    │    │         └── fd: (34,37)-->(44)
           │         │         │    │    │    ├── scan partsupp
           │         │         │    │    │    │    ├── save-table-name: q20_scan_13
           │         │         │    │    │    │    ├── columns: ps_partkey:16(int!null) ps_suppkey:17(int!null) ps_availqty:18(int!null)
           │         │         │    │    │    │    ├── stats: [rows=800000, distinct(16)=199241, null(16)=0, distinct(17)=9920, null(17)=0, distinct(18)=9920, null(18)=0, distinct(16,17)=798302, null(16,17)=0]
           │         │         │    │    │    │    │   histogram(16)=  0 80  3923   80   3928   80   3938   80   3933   80   3925   80   3914   80   3921   80   3919   80   3914   80   3937   80    3920   80    3928   80    3910   80    3929   80    3948   80    3914   80    3910   80    3927   80    3939   80    3921   80    3917   80    3914   80    3929   80    3920   80    3930   80    3910   80    3908   80    3916   80    3959   80    3914   80    3918   80    3928   80    3917   80    3922   80    3913   80    3956   160   3841   160   3921   80    3906   80    3916   80    3927   80    3931   80    3909   80    3910   80    3913   80    3917   80    3918   80    3909   80    3912   80    3936   80    3914   80    3920   80    3922   80    3920   80    3907   80    3913   80    3933   160   3912   80    3907   80    3921   80    3916   80    3913   80    3919   80    3905   80    3909   80    3911   80    3917   80    3909   80    3907   80    3927   80    3914   80    3921   80    3927   80    3935   80    3910   80    3933   80    3912   80    3918   80    3919   80    3920   80    3918   80    3940   80    3914   80    3906   160   3924   80    3921   80    3971   80    3933   80    3910   80    3923   80    3906   80    3932   80    3905   80    3946   80    3927   80    3934   80    3912   80    3916   80    3914    80    3912    80    3915    80    3907    80    3908    80    3913    80    3915    80    3913    80    3920    80    3920    80    3912    80    3912    80    3908    80    3912    80    3955    80    3910    80    3911    80    3949    80    3907    80    3909    80    3912    80    3920    80    3926    80    3912    80    3926    80    3919    80    3918    80    3911   160    3910    80    3921    80    3908    80    3922    80    3905    80    3904    80    3924    80    3919    80    3929    80    3934    80    3909    80    3910    80    3921    80    3921    80    3908    80    3908    80    3923    80    3924    80    3916    80    3915    80    3925    80    3940    80    3927    80    3937    80    3908    80    3916    80    3919    80    3938    80    4002    80    4016    80    3985    80    3989    80    4006    80    3995    80    4000    80    4002    80    4013    80    3986    80    4005    80    3988    80    3998    80    3993    80    3994    80    4007    80    4007    80    3995    80    4003    80    4003    80    3988    80    4012    80    3985    80    3995    80    3994    80    3988    80    4005    80    3909   160    4018    80    3992    80    3991    80    4010    80    4014    80    3998    80    3999    80    3987    80    4007    80    3989    80    3993    80    3989    80    3993    80    3990    80    3988    80    4013    80    3987    80
           │         │         │    │    │    │    │                 <--- 4 ------ 1075 ------ 2193 ------ 3395 ------ 4554 ------ 5642 ------ 6598 ------ 7647 ------ 8671 ------ 9629 ------ 10824 ------ 11863 ------ 12983 ------ 13869 ------ 14999 ------ 16276 ------ 17233 ------ 18118 ------ 19228 ------ 20442 ------ 21483 ------ 22478 ------ 23437 ------ 24567 ------ 25601 ------ 26740 ------ 27623 ------ 28466 ------ 29449 ------ 30794 ------ 31739 ------ 32753 ------ 33870 ------ 34865 ------ 35923 ------ 36861 ------ 38210 ------ 39252 ------ 40292 ------ 41082 ------ 42064 ------ 43174 ------ 44318 ------ 45170 ------ 46050 ------ 46986 ------ 47983 ------ 48991 ------ 49860 ------ 50781 ------ 51973 ------ 52921 ------ 53950 ------ 55008 ------ 56036 ------ 56828 ------ 57761 ------ 58943 ------ 59859 ------ 60661 ------ 61709 ------ 62686 ------ 63627 ------ 64644 ------ 65398 ------ 66264 ------ 67171 ------ 68167 ------ 69030 ------ 69846 ------ 70957 ------ 71901 ------ 72947 ------ 74057 ------ 75238 ------ 76120 ------ 77281 ------ 78194 ------ 79205 ------ 80232 ------ 81265 ------ 82271 ------ 83492 ------ 84447 ------ 85223 ------ 86300 ------ 87345 ------ 88757 ------ 89916 ------ 90792 ------ 91861 ------ 92641 ------ 93799 ------ 94551 ------ 95816 ------ 96926 ------ 98099 ------ 99012 ------ 99995 ------ 100942 ------ 101861 ------ 102829 ------ 103627 ------ 104458 ------ 105386 ------ 106347 ------ 107282 ------ 108318 ------ 109347 ------ 110259 ------ 111179 ------ 112020 ------ 112934 ------ 114258 ------ 115141 ------ 116042 ------ 117324 ------ 118118 ------ 118986 ------ 119911 ------ 120948 ------ 122047 ------ 122964 ------ 124063 ------ 125086 ------ 126093 ------ 127009 ------ 127890 ------ 128937 ------ 129774 ------ 130828 ------ 131573 ------ 132266 ------ 133346 ------ 134371 ------ 135496 ------ 136668 ------ 137535 ------ 138422 ------ 139464 ------ 140513 ------ 141339 ------ 142180 ------ 143249 ------ 144332 ------ 145311 ------ 146282 ------ 147367 ------ 148588 ------ 149692 ------ 150886 ------ 151707 ------ 152690 ------ 153715 ------ 154916 ------ 155992 ------ 157204 ------ 157983 ------ 158874 ------ 159994 ------ 160981 ------ 162034 ------ 163111 ------ 164294 ------ 165106 ------ 166214 ------ 167072 ------ 168103 ------ 169058 ------ 170034 ------ 171163 ------ 172290 ------ 173278 ------ 174363 ------ 175448 ------ 176294 ------ 177466 ------ 178235 ------ 179221 ------ 180188 ------ 181055 ------ 182160 ------ 183035 ------ 184258 ------ 185197 ------ 186126 ------ 187288 ------ 188478 ------ 189509 ------ 190552 ------ 191370 ------ 192500 ------ 193385 ------ 194340 ------ 195218 ------ 196178 ------ 197078 ------ 197942 ------ 199128 ------ 199971
           │         │         │    │    │    │    │   histogram(17)=  0 80  3920  80  3920 160  3840  160  3920  160  3840  160  3840  240  3920  160  3920  160  3840  160  3840  160  3840  240  3920  160  3920  160  3920  160  3840  160  3760  320  3680  320  3840  160  3840  240  3840  160  3920   80   3920  160   3920   80   3840  160   3920  160   3920   80   3920   80   3920  160   3760  240   3840  160   3840  320   3920  160   3920   80   3840  160   3920   80   3920   80   3920  160   3920  160   3920   80   3840  160   3920   80   3920  240   3760  320   3920   80   3920   80   3920   80   3840  240   3760  240   3920  240   3920   80   3920   80   3840  240   3920   80   3920   80   3760  240   3920   80   3920   80   3840  160   3920  160   3840  160   3920   80   3920  240   3920   80   3920   80   3840  160   3920   80   3920   80   3920   80   3760  240   3920  160   3920   80   3840  160   3840  320   3920  160   3840  240   3840  240   3760  320   3840  160   3920   80   3600  400   3920  160   3760  240   3840  160   3920   80   3920  160   3920   80   3920  320   3920  240   3840  160   3920   80   3920   80   3920   80   3920   80   3840  160   3920   80   3920   80   3920   80   3920   80   3760  240   3840  160   3680  320   3760  240   3920   80   3920  320   3760  240   3920   80   3920  160   3920   80   3920   80   3920   80   3840  240   3920   80   3840  160   3920   80   3920   80   3920  240   3760  160   3760  240   3920   80   3760  320   3760  240   3760  160   3680  320   3920   80   3920   80   3920  240   3760  160   3840   80   3920  160   3760  400   3840   80   3840   80   3840   80   3920   80   3840  160   3920   80   3760  240   3840  160   3840  160   3840  160   3840  160   3840  160   3920  400   3840   80   3840  240   3840   80   3840   80   3840   80   3840  160   3840  160   3840   80   3920  320   3760  240   3760  240   3680  320   3760  160   3760  160   3680  320   3840  240   3840  160   3680  240   3840  160   3840  160   3840  160   3760  240   3600  320   3840  160   3920  320   3840   80   3840   80   3600  320   3920  240   3760  160   3840  160   3840  240   3680  240   3840  240   3680  240   3840   80   3920  240   3840  240   3840   80   3840   80   3840   80   3920  160   3840   80   3920   80   3920  160   3680  240   3920  240   3840   80   3840  160   3840   80   3920   80   3760  240   3920   80   3680  320   3840  160   3920   80
           │         │         │    │    │    │    │                 <--- 4 ------ 45 ------ 99 ------ 142 ------ 195 ------ 240 ------ 294 ------ 345 ------ 397 ------ 450 ------ 495 ------ 548 ------ 594 ------ 645 ------ 701 ------ 749 ------ 795 ------ 856 ------ 902 ------ 946 ------ 991 ------ 1043 ------ 1087 ------ 1142 ------ 1198 ------ 1262 ------ 1309 ------ 1359 ------ 1423 ------ 1469 ------ 1517 ------ 1570 ------ 1623 ------ 1673 ------ 1713 ------ 1764 ------ 1804 ------ 1851 ------ 1890 ------ 1929 ------ 1971 ------ 2020 ------ 2070 ------ 2124 ------ 2170 ------ 2240 ------ 2279 ------ 2330 ------ 2372 ------ 2423 ------ 2486 ------ 2531 ------ 2585 ------ 2633 ------ 2676 ------ 2721 ------ 2778 ------ 2834 ------ 2884 ------ 2945 ------ 2996 ------ 3047 ------ 3095 ------ 3151 ------ 3217 ------ 3260 ------ 3302 ------ 3349 ------ 3404 ------ 3457 ------ 3507 ------ 3559 ------ 3596 ------ 3644 ------ 3690 ------ 3730 ------ 3774 ------ 3817 ------ 3881 ------ 3930 ------ 3989 ------ 4045 ------ 4099 ------ 4153 ------ 4208 ------ 4262 ------ 4317 ------ 4365 ------ 4405 ------ 4452 ------ 4502 ------ 4565 ------ 4613 ------ 4652 ------ 4708 ------ 4773 ------ 4825 ------ 4861 ------ 4913 ------ 4954 ------ 5015 ------ 5061 ------ 5102 ------ 5167 ------ 5217 ------ 5278 ------ 5327 ------ 5382 ------ 5435 ------ 5497 ------ 5537 ------ 5588 ------ 5651 ------ 5705 ------ 5760 ------ 5805 ------ 5845 ------ 5898 ------ 5942 ------ 5984 ------ 6027 ------ 6068 ------ 6121 ------ 6158 ------ 6203 ------ 6257 ------ 6311 ------ 6368 ------ 6421 ------ 6482 ------ 6520 ------ 6565 ------ 6608 ------ 6656 ------ 6713 ------ 6770 ------ 6834 ------ 6882 ------ 6935 ------ 6976 ------ 7026 ------ 7071 ------ 7116 ------ 7170 ------ 7218 ------ 7261 ------ 7298 ------ 7348 ------ 7391 ------ 7440 ------ 7487 ------ 7537 ------ 7581 ------ 7628 ------ 7677 ------ 7724 ------ 7765 ------ 7822 ------ 7861 ------ 7913 ------ 7961 ------ 8012 ------ 8065 ------ 8118 ------ 8181 ------ 8220 ------ 8261 ------ 8314 ------ 8365 ------ 8420 ------ 8475 ------ 8516 ------ 8574 ------ 8619 ------ 8658 ------ 8724 ------ 8771 ------ 8834 ------ 8885 ------ 8938 ------ 8990 ------ 9041 ------ 9102 ------ 9159 ------ 9212 ------ 9281 ------ 9326 ------ 9378 ------ 9424 ------ 9477 ------ 9535 ------ 9577 ------ 9632 ------ 9672 ------ 9731 ------ 9771 ------ 9831 ------ 9876 ------ 9926 ------ 9999
           │         │         │    │    │    │    │   histogram(18)=  0 80  7.9984e+05   80
           │         │         │    │    │    │    │                 <--- 1 ------------ 9999
           │         │         │    │    │    │    ├── key: (16,17)
           │         │         │    │    │    │    └── fd: (16,17)-->(18)
           │         │         │    │    │    └── filters
           │         │         │    │    │         ├── l_partkey:35 = ps_partkey:16 [type=bool, outer=(16,35), constraints=(/16: (/NULL - ]; /35: (/NULL - ]), fd=(16)==(35), (35)==(16)]
           │         │         │    │    │         └── l_suppkey:36 = ps_suppkey:17 [type=bool, outer=(17,36), constraints=(/17: (/NULL - ]; /36: (/NULL - ]), fd=(17)==(36), (36)==(17)]
           │         │         │    │    └── aggregations
           │         │         │    │         ├── sum [as=sum:52, type=float, outer=(38)]
           │         │         │    │         │    └── l_quantity:38 [type=float]
           │         │         │    │         └── const-agg [as=ps_availqty:18, type=int, outer=(18)]
           │         │         │    │              └── ps_availqty:18 [type=int]
           │         │         │    └── filters
           │         │         │         └── ps_availqty:18 > (sum:52 * 0.5) [type=bool, outer=(18,52), immutable, constraints=(/18: (/NULL - ])]
           │         │         └── filters
           │         │              └── p_name:24 LIKE 'forest%' [type=bool, outer=(24), constraints=(/24: [/'forest' - /'foresu'); tight)]
           │         └── filters (true)
           └── filters
                └── n_name:11 = 'CANADA' [type=bool, outer=(11), constraints=(/11: [/'CANADA' - /'CANADA']; tight), fd=()-->(11)]

----Stats for q20_sort_1----
column_names  row_count  distinct_count  null_count
{s_address}   0          0               0
{s_name}      0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_address}   0.00           1.00           0.00                1.00                0.00            1.00
{s_name}      0.00           1.00           0.00                1.00                0.00            1.00

----Stats for q20_project_2----
column_names  row_count  distinct_count  null_count
{s_address}   0          0               0
{s_name}      0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_address}   0.00           1.00           0.00                1.00                0.00            1.00
{s_name}      0.00           1.00           0.00                1.00                0.00            1.00

----Stats for q20_lookup_join_3----
column_names   row_count  distinct_count  null_count
{n_name}       0          0               0
{n_nationkey}  0          0               0
{s_address}    0          0               0
{s_name}       0          0               0
{s_nationkey}  0          0               0
{s_suppkey}    0          0               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{n_name}       0.00           1.00           0.00                1.00                0.00            1.00
{n_nationkey}  0.00           1.00           0.00                1.00                0.00            1.00
{s_address}    0.00           1.00           0.00                1.00                0.00            1.00
{s_name}       0.00           1.00           0.00                1.00                0.00            1.00
{s_nationkey}  0.00           1.00           0.00                1.00                0.00            1.00
{s_suppkey}    0.00           1.00           0.00                1.00                0.00            1.00

----Stats for q20_project_4----
column_names   row_count  distinct_count  null_count
{s_address}    0          0               0
{s_name}       0          0               0
{s_nationkey}  0          0               0
{s_suppkey}    0          0               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{s_address}    0.00           1.00           0.00                1.00                0.00            1.00
{s_name}       0.00           1.00           0.00                1.00                0.00            1.00
{s_nationkey}  0.00           1.00           0.00                1.00                0.00            1.00
{s_suppkey}    0.00           1.00           0.00                1.00                0.00            1.00

----Stats for q20_lookup_join_5----
column_names   row_count  distinct_count  null_count
{ps_suppkey}   0          0               0
{s_address}    0          0               0
{s_name}       0          0               0
{s_nationkey}  0          0               0
{s_suppkey}    0          0               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_suppkey}   0.00           1.00           0.00                1.00                0.00            1.00
{s_address}    0.00           1.00           0.00                1.00                0.00            1.00
{s_name}       0.00           1.00           0.00                1.00                0.00            1.00
{s_nationkey}  0.00           1.00           0.00                1.00                0.00            1.00
{s_suppkey}    0.00           1.00           0.00                1.00                0.00            1.00

----Stats for q20_distinct_on_6----
column_names  row_count  distinct_count  null_count
{ps_suppkey}  0          0               0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_suppkey}  0.00           1.00           0.00                1.00                0.00            1.00

----Stats for q20_lookup_join_7----
column_names   row_count  distinct_count  null_count
{p_name}       0          0               0
{p_partkey}    0          0               0
{ps_availqty}  0          0               0
{ps_partkey}   0          0               0
{ps_suppkey}   0          0               0
{sum}          0          0               0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{p_name}       0.00           1.00           0.00                1.00                0.00            1.00
{p_partkey}    0.00           1.00           0.00                1.00                0.00            1.00
{ps_availqty}  0.00           1.00           0.00                1.00                0.00            1.00
{ps_partkey}   0.00           1.00           0.00                1.00                0.00            1.00
{ps_suppkey}   0.00           1.00           0.00                1.00                0.00            1.00
{sum}          0.00           1.00           0.00                1.00                0.00            1.00

----Stats for q20_select_8----
column_names   row_count  distinct_count  null_count
{ps_availqty}  541940     9920            0
{ps_partkey}   541940     197367          0
{ps_suppkey}   541940     9920            0
{sum}          541940     245             0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_availqty}  127.00         4267.24 <==    127.00              78.11 <==           0.00            1.00
{ps_partkey}   127.00         4267.24 <==    127.00              1554.07 <==         0.00            1.00
{ps_suppkey}   127.00         4267.24 <==    127.00              78.11 <==           0.00            1.00
{sum}          127.00         4267.24 <==    127.00              1.93 <==            0.00            1.00

----Stats for q20_group_by_9----
column_names   row_count  distinct_count  null_count
{ps_availqty}  543101     9920            0
{ps_partkey}   543101     197437          0
{ps_suppkey}   543101     9920            0
{sum}          543101     246             0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_availqty}  381.00         1425.46 <==    381.00              26.04 <==           0.00            1.00
{ps_partkey}   381.00         1425.46 <==    381.00              518.21 <==          0.00            1.00
{ps_suppkey}   381.00         1425.46 <==    381.00              26.04 <==           0.00            1.00
{sum}          381.00         1425.46 <==    381.00              1.55                0.00            1.00

----Stats for q20_inner_join_10----
column_names   row_count  distinct_count  null_count
{l_partkey}    909665     197437          0
{l_quantity}   909665     50              0
{l_shipdate}   909665     365             0
{l_suppkey}    909665     9920            0
{ps_availqty}  909665     9920            0
{ps_partkey}   909665     197437          0
{ps_suppkey}   909665     9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_partkey}    381.00         2387.57 <==    381.00              518.21 <==          0.00            1.00
{l_quantity}   381.00         2387.57 <==    50.00               1.00                0.00            1.00
{l_shipdate}   381.00         2387.57 <==    237.00              1.54                0.00            1.00
{l_suppkey}    381.00         2387.57 <==    381.00              26.04 <==           0.00            1.00
{ps_availqty}  381.00         2387.57 <==    374.00              26.52 <==           0.00            1.00
{ps_partkey}   381.00         2387.57 <==    381.00              518.21 <==          0.00            1.00
{ps_suppkey}   381.00         2387.57 <==    381.00              26.04 <==           0.00            1.00

----Stats for q20_index_join_11----
column_names  row_count  distinct_count  null_count
{l_partkey}   909665     197437          0
{l_quantity}  909665     50              0
{l_shipdate}  909665     365             0
{l_suppkey}   909665     9920            0
~~~~
column_names  row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_partkey}   941645.00      1.04           198075.00           1.00                0.00            1.00
{l_quantity}  941645.00      1.04           50.00               1.00                0.00            1.00
{l_shipdate}  941645.00      1.04           365.00              1.00                0.00            1.00
{l_suppkey}   941645.00      1.04           9920.00             1.00                0.00            1.00

----Stats for q20_scan_12----
column_names    row_count  distinct_count  null_count
{l_linenumber}  909665     7               0
{l_orderkey}    909665     266316          0
{l_shipdate}    909665     365             0
~~~~
column_names    row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{l_linenumber}  941645.00      1.04           7.00                1.00                0.00            1.00
{l_orderkey}    941645.00      1.04           746266.00           2.80 <==            0.00            1.00
{l_shipdate}    941645.00      1.04           365.00              1.00                0.00            1.00

----Stats for q20_scan_13----
column_names   row_count  distinct_count  null_count
{ps_availqty}  800000     9920            0
{ps_partkey}   800000     199241          0
{ps_suppkey}   800000     9920            0
~~~~
column_names   row_count_est  row_count_err  distinct_count_est  distinct_count_err  null_count_est  null_count_err
{ps_availqty}  800000.00      1.00           9920.00             1.00                0.00            1.00
{ps_partkey}   800000.00      1.00           199241.00           1.00                0.00            1.00
{ps_suppkey}   800000.00      1.00           9920.00             1.00                0.00            1.00
----
----
