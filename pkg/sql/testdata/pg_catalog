# Verify pg_catalog database handles mutation statements correctly.

query error user root does not have DROP privilege on database pg_catalog
ALTER DATABASE pg_catalog RENAME TO not_pg_catalog

statement error user root does not have CREATE privilege on database pg_catalog
CREATE TABLE pg_catalog.t (x INT)

query error user root does not have DROP privilege on database pg_catalog
DROP DATABASE pg_catalog


# Verify other databases can't be called "pg_catalog".

statement ok
CREATE DATABASE other_db

statement error the new database name "pg_catalog" already exists
ALTER DATABASE other_db RENAME TO pg_catalog

statement error database "pg_catalog" already exists
CREATE DATABASE pg_catalog

statement ok
DROP DATABASE other_db

# the following query checks that the planDataSource instantiated from
# a virtual table in the FROM clause is properly deallocated even when
# query preparation causes an error. #9853
query error unknown function
SELECT * FROM pg_catalog.pg_class c WHERE nonexistent_function()

# Verify pg_catalog can be used like a normal database.

statement ok
SET DATABASE = pg_catalog

statement ok
SET DATABASE = test


# Verify pg_catalog handles reflection correctly.

query T
SHOW TABLES FROM pg_catalog
----
pg_am
pg_attrdef
pg_attribute
pg_class
pg_constraint
pg_database
pg_depend
pg_description
pg_index
pg_indexes
pg_namespace
pg_proc
pg_roles
pg_settings
pg_tables
pg_type
pg_views

query TT colnames
SHOW CREATE TABLE pg_catalog.pg_namespace
----
Table                  CreateTable
pg_catalog.pg_namespace  CREATE TABLE "pg_catalog.pg_namespace" (
                           oid INT NULL,
                           nspname STRING NOT NULL DEFAULT '',
                           nspowner INT NULL,
                           aclitem STRING NULL
                       )

query TTBT colnames
SHOW COLUMNS FROM pg_catalog.pg_namespace
----
Field     Type    Null  Default
oid       INT     true   NULL
nspname   STRING  false  ''
nspowner  INT     true   NULL
aclitem   STRING  true   NULL

query TTTTTTT colnames
SHOW INDEXES FROM pg_catalog.pg_namespace
----
Table  Name  Unique  Seq  Column  Direction  Storing

query TTTTT colnames
SHOW CONSTRAINTS FROM pg_catalog.pg_namespace
----
Table         Name     Type  Column(s)  Details

query TTT colnames
SHOW GRANTS ON pg_catalog.pg_namespace
----
Table  User  Privileges


# Verify selecting from pg_catalog.

statement ok
CREATE DATABASE constraint_db

statement ok
CREATE TABLE constraint_db.t1 (
  p FLOAT PRIMARY KEY,
  a INT UNIQUE,
  b INT,
  c INT DEFAULT 12,
  UNIQUE INDEX index_key(b, c)
)

statement ok
CREATE TABLE constraint_db.t2 (
    t1_ID INT,
    CONSTRAINT fk FOREIGN KEY (t1_ID) REFERENCES constraint_db.t1(a),
    INDEX (t1_ID)
)

statement ok
CREATE TABLE constraint_db.t3 (
    a INT,
    b INT CHECK (b > 11),
    c STRING DEFAULT 'FOO',
    CONSTRAINT fk FOREIGN KEY (a, b) REFERENCES constraint_db.t1(b, c),
    INDEX (a, b DESC) STORING (c)
)

statement ok
CREATE VIEW constraint_db.v1 AS SELECT p,a,b,c FROM constraint_db.t1;

## pg_catalog.pg_namespace

query ITIT colnames
SELECT * FROM pg_catalog.pg_namespace
----
oid         nspname             nspowner  aclitem
3061586988  constraint_db       NULL      NULL
3816276882  information_schema  NULL      NULL
3178318485  pg_catalog          NULL      NULL
1793492844  system              NULL      NULL
2091240128  test                NULL      NULL

## pg_catalog.pg_tables

query TTTTBBBB colnames
SELECT * FROM pg_catalog.pg_tables WHERE schemaname = 'constraint_db'
----
schemaname     tablename  tableowner  tablespace  hasindexes  hasrules  hastriggers  rowsecurity
constraint_db  t1         NULL        NULL        true        false     false        false
constraint_db  t2         NULL        NULL        true        false     false        false
constraint_db  t3         NULL        NULL        true        false     false        false

query TB colnames
SELECT tablename, hasindexes FROM pg_catalog.pg_tables WHERE schemaname = 'information_schema' AND tablename LIKE '%table%'
----
tablename          hasindexes
table_constraints  false
table_privileges   false
tables             false

## pg_catalog.pg_views

query TTTT colnames
SELECT * FROM pg_catalog.pg_views
----
schemaname     viewname  viewowner  definition
constraint_db  v1        NULL       SELECT p, a, b, c FROM constraint_db.t1

## pg_catalog.pg_class

query ITIIIIII colnames
SELECT c.oid, relname, relnamespace, reltype, relowner, relam, relfilenode, reltablespace
FROM pg_catalog.pg_class c
JOIN pg_catalog.pg_namespace n ON c.relnamespace = n.oid
WHERE n.nspname = 'constraint_db'
----
oid         relname       relnamespace  reltype  relowner  relam  relfilenode  reltablespace
2265044713  t1            3061586988    0        NULL      NULL   0            0
1759889455  primary       3061586988    0        NULL      NULL   0            0
1759889452  t1_a_key      3061586988    0        NULL      NULL   0            0
1759889453  index_key     3061586988    0        NULL      NULL   0            0
2030599329  t2            3061586988    0        NULL      NULL   0            0
559702615   primary       3061586988    0        NULL      NULL   0            0
559702612   t2_t1_ID_idx  3061586988    0        NULL      NULL   0            0
2064007441  t3            3061586988    0        NULL      NULL   0            0
4171047647  primary       3061586988    0        NULL      NULL   0            0
4171047644  t3_a_b_idx    3061586988    0        NULL      NULL   0            0
2332993830  v1            3061586988    0        NULL      NULL   0            0

query TIRIIBB colnames
SELECT relname, relpages, reltuples, relallvisible, reltoastrelid, relhasindex, relisshared
FROM pg_catalog.pg_class c
JOIN pg_catalog.pg_namespace n ON c.relnamespace = n.oid
WHERE n.nspname = 'constraint_db'
----
relname       relpages  reltuples  relallvisible  reltoastrelid  relhasindex  relisshared
t1            NULL      NULL       0              0              true         false
primary       NULL      NULL       0              0              false        false
t1_a_key      NULL      NULL       0              0              false        false
index_key     NULL      NULL       0              0              false        false
t2            NULL      NULL       0              0              true         false
primary       NULL      NULL       0              0              false        false
t2_t1_ID_idx  NULL      NULL       0              0              false        false
t3            NULL      NULL       0              0              true         false
primary       NULL      NULL       0              0              false        false
t3_a_b_idx    NULL      NULL       0              0              false        false
v1            NULL      NULL       0              0              false        false

query TBTIIBB colnames
SELECT relname, relistemp, relkind, relnatts, relchecks, relhasoids, relhaspkey
FROM pg_catalog.pg_class c
JOIN pg_catalog.pg_namespace n ON c.relnamespace = n.oid
WHERE n.nspname = 'constraint_db'
----
relname       relistemp  relkind  relnatts  relchecks  relhasoids  relhaspkey
t1            false      r        4         0          false       true
primary       false      i        1         0          false       false
t1_a_key      false      i        1         0          false       false
index_key     false      i        2         0          false       false
t2            false      r        2         0          false       true
primary       false      i        1         0          false       false
t2_t1_ID_idx  false      i        1         0          false       false
t3            false      r        4         1          false       true
primary       false      i        1         0          false       false
t3_a_b_idx    false      i        2         0          false       false
v1            false      v        4         0          false       false

query TBBBITT colnames
SELECT relname, relhasrules, relhastriggers, relhassubclass, relfrozenxid, relacl, reloptions
FROM pg_catalog.pg_class c
JOIN pg_catalog.pg_namespace n ON c.relnamespace = n.oid
WHERE n.nspname = 'constraint_db'
----
relname       relhasrules  relhastriggers  relhassubclass  relfrozenxid  relacl  reloptions
t1            false        false           false           0             NULL    NULL
primary       false        false           false           0             NULL    NULL
t1_a_key      false        false           false           0             NULL    NULL
index_key     false        false           false           0             NULL    NULL
t2            false        false           false           0             NULL    NULL
primary       false        false           false           0             NULL    NULL
t2_t1_ID_idx  false        false           false           0             NULL    NULL
t3            false        false           false           0             NULL    NULL
primary       false        false           false           0             NULL    NULL
t3_a_b_idx    false        false           false           0             NULL    NULL
v1            false        false           false           0             NULL    NULL

## pg_catalog.pg_attribute

query ITTIIIIII colnames
SELECT attrelid, c.relname, attname, atttypid, attstattarget, attlen, attnum, attndims, attcacheoff
FROM pg_catalog.pg_attribute a
JOIN pg_catalog.pg_class c ON a.attrelid = c.oid
JOIN pg_catalog.pg_namespace n ON c.relnamespace = n.oid
WHERE n.nspname = 'constraint_db'
----
attrelid    relname       attname  atttypid  attstattarget  attlen  attnum  attndims  attcacheoff
2265044713  t1            p        701       0              8       1       0         -1
2265044713  t1            a        20        0              8       2       0         -1
2265044713  t1            b        20        0              8       3       0         -1
2265044713  t1            c        20        0              8       4       0         -1
1759889455  primary       p        701       0              8       1       0         -1
1759889452  t1_a_key      a        20        0              8       1       0         -1
1759889453  index_key     b        20        0              8       1       0         -1
1759889453  index_key     c        20        0              8       2       0         -1
2030599329  t2            t1_ID    20        0              8       1       0         -1
559702612   t2_t1_ID_idx  t1_ID    20        0              8       1       0         -1
2064007441  t3            a        20        0              8       1       0         -1
2064007441  t3            b        20        0              8       2       0         -1
2064007441  t3            c        25        0              -1      3       0         -1
4171047644  t3_a_b_idx    a        20        0              8       1       0         -1
4171047644  t3_a_b_idx    b        20        0              8       2       0         -1
2332993830  v1            p        701       0              8       1       0         -1
2332993830  v1            a        20        0              8       2       0         -1
2332993830  v1            b        20        0              8       3       0         -1
2332993830  v1            c        20        0              8       4       0         -1

query TTIBTTBB colnames
SELECT c.relname, attname, atttypmod, attbyval, attstorage, attalign, attnotnull, atthasdef
FROM pg_catalog.pg_attribute a
JOIN pg_catalog.pg_class c ON a.attrelid = c.oid
JOIN pg_catalog.pg_namespace n ON c.relnamespace = n.oid
WHERE n.nspname = 'constraint_db'
----
relname       attname  atttypmod  attbyval  attstorage  attalign  attnotnull  atthasdef
t1            p        -1         NULL      NULL        NULL      true        false
t1            a        -1         NULL      NULL        NULL      false       false
t1            b        -1         NULL      NULL        NULL      false       false
t1            c        -1         NULL      NULL        NULL      false       true
primary       p        -1         NULL      NULL        NULL      true        false
t1_a_key      a        -1         NULL      NULL        NULL      false       false
index_key     b        -1         NULL      NULL        NULL      false       false
index_key     c        -1         NULL      NULL        NULL      false       true
t2            t1_ID    -1         NULL      NULL        NULL      false       false
t2_t1_ID_idx  t1_ID    -1         NULL      NULL        NULL      false       false
t3            a        -1         NULL      NULL        NULL      false       false
t3            b        -1         NULL      NULL        NULL      false       false
t3            c        -1         NULL      NULL        NULL      false       true
t3_a_b_idx    a        -1         NULL      NULL        NULL      false       false
t3_a_b_idx    b        -1         NULL      NULL        NULL      false       false
v1            p        -1         NULL      NULL        NULL      true        false
v1            a        -1         NULL      NULL        NULL      true        false
v1            b        -1         NULL      NULL        NULL      true        false
v1            c        -1         NULL      NULL        NULL      true        false

query TTBBITTT colnames
SELECT c.relname, attname, attisdropped, attislocal, attinhcount, attacl, attoptions, attfdwoptions
FROM pg_catalog.pg_attribute a
JOIN pg_catalog.pg_class c ON a.attrelid = c.oid
JOIN pg_catalog.pg_namespace n ON c.relnamespace = n.oid
WHERE n.nspname = 'constraint_db'
----
relname       attname  attisdropped  attislocal  attinhcount  attacl  attoptions  attfdwoptions
t1            p        false         true        0            NULL    NULL        NULL
t1            a        false         true        0            NULL    NULL        NULL
t1            b        false         true        0            NULL    NULL        NULL
t1            c        false         true        0            NULL    NULL        NULL
primary       p        false         true        0            NULL    NULL        NULL
t1_a_key      a        false         true        0            NULL    NULL        NULL
index_key     b        false         true        0            NULL    NULL        NULL
index_key     c        false         true        0            NULL    NULL        NULL
t2            t1_ID    false         true        0            NULL    NULL        NULL
t2_t1_ID_idx  t1_ID    false         true        0            NULL    NULL        NULL
t3            a        false         true        0            NULL    NULL        NULL
t3            b        false         true        0            NULL    NULL        NULL
t3            c        false         true        0            NULL    NULL        NULL
t3_a_b_idx    a        false         true        0            NULL    NULL        NULL
t3_a_b_idx    b        false         true        0            NULL    NULL        NULL
v1            p        false         true        0            NULL    NULL        NULL
v1            a        false         true        0            NULL    NULL        NULL
v1            b        false         true        0            NULL    NULL        NULL
v1            c        false         true        0            NULL    NULL        NULL


## pg_catalog.pg_am

query ITIT colnames
SELECT *
FROM pg_catalog.pg_am
----
oid         amname  amhandler  amtype
2631952481  prefix  NULL       i

## pg_catalog.pg_attrdef

query ITIITT colnames
SELECT ad.oid, c.relname, adrelid, adnum, adbin, adsrc
FROM pg_catalog.pg_attrdef ad
JOIN pg_catalog.pg_class c ON ad.adrelid = c.oid
JOIN pg_catalog.pg_namespace n ON c.relnamespace = n.oid
WHERE n.nspname = 'constraint_db'
----
oid         relname  adrelid     adnum  adbin  adsrc
1889966686  t1       2265044713  4      12     12
390509283   t3       2064007441  3      'FOO'  'FOO'

## pg_catalog.pg_indexes

query TTTT colnames
SELECT schemaname, tablename, indexname, tablespace
FROM pg_catalog.pg_indexes
WHERE schemaname = 'constraint_db'
----
schemaname     tablename  indexname     tablespace
constraint_db  t1         primary       NULL
constraint_db  t1         t1_a_key      NULL
constraint_db  t1         index_key     NULL
constraint_db  t2         primary       NULL
constraint_db  t2         t2_t1_ID_idx  NULL
constraint_db  t3         primary       NULL
constraint_db  t3         t3_a_b_idx    NULL

query TTT colnames
SELECT tablename, indexname, indexdef
FROM pg_catalog.pg_indexes
WHERE schemaname = 'constraint_db'
----
tablename  indexname     indexdef
t1         primary       CREATE UNIQUE INDEX "primary" ON constraint_db.t1 (p ASC)
t1         t1_a_key      CREATE UNIQUE INDEX t1_a_key ON constraint_db.t1 (a ASC)
t1         index_key     CREATE UNIQUE INDEX index_key ON constraint_db.t1 (b ASC, c ASC)
t2         primary       CREATE UNIQUE INDEX "primary" ON constraint_db.t2 (rowid ASC)
t2         t2_t1_ID_idx  CREATE INDEX t2_t1_ID_idx ON constraint_db.t2 (t1_ID ASC)
t3         primary       CREATE UNIQUE INDEX "primary" ON constraint_db.t3 (rowid ASC)
t3         t3_a_b_idx    CREATE INDEX t3_a_b_idx ON constraint_db.t3 (a ASC, b DESC) STORING (c)

## pg_catalog.pg_index

query IIIBBB colnames
SELECT indexrelid, indrelid, indnatts, indisunique, indisprimary, indisexclusion
from pg_catalog.pg_index
WHERE indnatts = 2
----
indexrelid  indrelid    indnatts  indisunique  indisprimary  indisexclusion
1759889453  2265044713  2         true         false         false
4171047644  2064007441  2         false        false         false
1957505477  512379281   2         true         true          false
1657267940  4118504190  2         true         true          false
2471030497  2866928465  2         true         true          false

query IBBBBB colnames
SELECT indexrelid, indimmediate, indisclustered, indisvalid, indcheckxmin, indisready
from pg_catalog.pg_index
WHERE indnatts = 2
----
indexrelid  indimmediate  indisclustered  indisvalid  indcheckxmin  indisready
1759889453  true          false           true        false         false
4171047644  false         false           true        false         false
1957505477  true          false           true        false         false
1657267940  true          false           true        false         false
2471030497  true          false           true        false         false

query IIBBTIIITT colnames
SELECT indexrelid, indrelid, indislive, indisreplident, indkey, indcollation, indclass, indoption, indexprs, indpred
from pg_catalog.pg_index
WHERE indnatts = 2
----
indexrelid  indrelid    indislive  indisreplident  indkey  indcollation  indclass  indoption  indexprs  indpred
1759889453  2265044713  true       false           {3,4}   0             0         0          NULL      NULL
4171047644  2064007441  true       false           {1,2}   0             0         0          NULL      NULL
1957505477  512379281   true       false           {1,6}   0             0         0          NULL      NULL
1657267940  4118504190  true       false           {1,2}   0             0         0          NULL      NULL
2471030497  2866928465  true       false           {1,7}   0             0         0          NULL      NULL

## pg_catalog.pg_constraint
##
## These order of this virtual table is non-deterministic, so all queries must
## explicitly add an ORDER BY clause.

query ITIT colnames
SELECT con.oid, conname, connamespace, contype
FROM pg_catalog.pg_constraint con
JOIN pg_catalog.pg_namespace n ON con.connamespace = n.oid
WHERE n.nspname = 'constraint_db'
ORDER BY con.oid
----
oid         conname    connamespace  contype
1201123740  index_key  3061586988    u
1201123741  t1_a_key   3061586988    u
1226447819  fk         3061586988    f
1326888659  primary    3061586988    p
1517731673  check_b    3061586988    c
1830805222  fk         3061586988    f
3366881539  primary    3061586988    p
4143295131  primary    3061586988    p

query TTBBBIII colnames
SELECT conname, contype, condeferrable, condeferred, convalidated, conrelid, contypid, conindid
FROM pg_catalog.pg_constraint con
JOIN pg_catalog.pg_namespace n ON con.connamespace = n.oid
WHERE n.nspname = 'constraint_db'
ORDER BY con.oid
----
conname    contype  condeferrable  condeferred  convalidated  conrelid    contypid  conindid
index_key  u        false          false        true          2265044713  0         1759889453
t1_a_key   u        false          false        true          2265044713  0         1759889452
fk         f        false          false        true          2030599329  0         1759889452
primary    p        false          false        true          2265044713  0         1759889455
check_b    c        false          false        true          2064007441  0         0
fk         f        false          false        true          2064007441  0         1759889453
primary    p        false          false        true          2064007441  0         4171047647
primary    p        false          false        true          2030599329  0         559702615

query T
SELECT conname
FROM pg_catalog.pg_constraint con
JOIN pg_catalog.pg_namespace n ON con.connamespace = n.oid
WHERE n.nspname = 'constraint_db' AND contype NOT IN ('c', 'f', 'p', 'u')
ORDER BY con.oid
----

query TITTT colnames
SELECT conname, confrelid, confupdtype, confdeltype, confmatchtype
FROM pg_catalog.pg_constraint con
JOIN pg_catalog.pg_namespace n ON con.connamespace = n.oid
WHERE n.nspname = 'constraint_db' AND contype IN ('c', 'p', 'u')
ORDER BY con.oid
----
conname    confrelid  confupdtype  confdeltype  confmatchtype
index_key  0          NULL         NULL         NULL
t1_a_key   0          NULL         NULL         NULL
primary    0          NULL         NULL         NULL
check_b    0          NULL         NULL         NULL
primary    0          NULL         NULL         NULL
primary    0          NULL         NULL         NULL

query TITTT colnames
SELECT conname, confrelid, confupdtype, confdeltype, confmatchtype
FROM pg_catalog.pg_constraint con
JOIN pg_catalog.pg_namespace n ON con.connamespace = n.oid
WHERE n.nspname = 'constraint_db' AND contype = 'f'
ORDER BY con.oid
----
conname  confrelid   confupdtype  confdeltype  confmatchtype
fk       2265044713  a            a            s
fk       2265044713  a            a            s

query TBIBT colnames
SELECT conname, conislocal, coninhcount, connoinherit, conkey
FROM pg_catalog.pg_constraint con
JOIN pg_catalog.pg_namespace n ON con.connamespace = n.oid
WHERE n.nspname = 'constraint_db'
ORDER BY con.oid
----
conname    conislocal  coninhcount  connoinherit  conkey
index_key  true        0            true          {3,4}
t1_a_key   true        0            true          {2}
fk         true        0            true          {1}
primary    true        0            true          {1}
check_b    true        0            true          NULL
fk         true        0            true          {1,2}
primary    true        0            true          {4}
primary    true        0            true          {2}

query TTTTTTTT colnames
SELECT conname, confkey, conpfeqop, conppeqop, conffeqop, conexclop, conbin, consrc
FROM pg_catalog.pg_constraint con
JOIN pg_catalog.pg_namespace n ON con.connamespace = n.oid
WHERE n.nspname = 'constraint_db' AND contype IN ('c', 'p', 'u')
ORDER BY con.oid
----
conname    confkey  conpfeqop  conppeqop  conffeqop  conexclop  conbin  consrc
index_key  NULL     NULL       NULL       NULL       NULL       NULL    NULL
t1_a_key   NULL     NULL       NULL       NULL       NULL       NULL    NULL
primary    NULL     NULL       NULL       NULL       NULL       NULL    NULL
check_b    NULL     NULL       NULL       NULL       NULL       b > 11  b > 11
primary    NULL     NULL       NULL       NULL       NULL       NULL    NULL
primary    NULL     NULL       NULL       NULL       NULL       NULL    NULL

query TTTTTTTT colnames
SELECT conname, confkey, conpfeqop, conppeqop, conffeqop, conexclop, conbin, consrc
FROM pg_catalog.pg_constraint con
JOIN pg_catalog.pg_namespace n ON con.connamespace = n.oid
WHERE n.nspname = 'constraint_db' AND contype = 'f'
ORDER BY con.oid
----
conname  confkey  conpfeqop  conppeqop  conffeqop  conexclop  conbin  consrc
fk       {2}      NULL       NULL       NULL       NULL       NULL    NULL
fk       {3,4}    NULL       NULL       NULL       NULL       NULL    NULL

## pg_catalog.pg_depend

query IIIIIIT colnames
SELECT classid, objid, objsubid, refclassid, refobjid, refobjsubid, deptype
FROM pg_catalog.pg_depend
ORDER BY objid
----
classid   objid       objsubid  refclassid  refobjid    refobjsubid  deptype
71078581  1226447819  0         1652754864  1759889452  0            n
71078581  1830805222  0         1652754864  1759889453  0            n

# All entries in pg_depend are dependency links from the pg_constraint system
# table to the pg_class system table.

query IITT colnames
SELECT DISTINCT classid, refclassid, cla.relname AS tablename, refcla.relname AS reftablename
FROM pg_catalog.pg_depend
JOIN pg_class cla ON classid=cla.oid
JOIN pg_class refcla ON refclassid=refcla.oid
----
classid   refclassid  tablename      reftablename
71078581  1652754864  pg_constraint  pg_class

# All entries in pg_depend are foreign key constraints that reference an index
# in pg_class.

query TT colnames
SELECT relname, relkind
FROM pg_depend
JOIN pg_class ON refobjid=pg_class.oid
ORDER BY relname
----
relname    relkind
index_key  i
t1_a_key   i


# All entries are pg_depend are linked to a foreign key constraint whose
# supporting index is the referenced object id.

query T colnames
SELECT DISTINCT pg_constraint.contype
FROM pg_depend
JOIN pg_constraint ON objid=pg_constraint.oid AND refobjid=pg_constraint.conindid
----
contype
f

## pg_catalog.pg_type

query ITIIIBT colnames
SELECT oid, typname, typnamespace, typowner, typlen, typbyval, typtype
FROM pg_catalog.pg_type
ORDER BY oid
----
oid   typname      typnamespace  typowner  typlen  typbyval  typtype
16    bool         NULL          NULL      1       true      b
17    bytes        NULL          NULL      -1      false     b
20    int          NULL          NULL      8       true      b
21    int          NULL          NULL      8       true      b
23    int          NULL          NULL      8       true      b
25    string       NULL          NULL      -1      false     b
700   float        NULL          NULL      8       true      b
701   float        NULL          NULL      8       true      b
1005  int[]        NULL          NULL      -1      false     b
1007  int[]        NULL          NULL      -1      false     b
1009  string[]     NULL          NULL      -1      false     b
1016  int[]        NULL          NULL      -1      false     b
1043  string       NULL          NULL      -1      false     b
1082  date         NULL          NULL      8       true      b
1114  timestamp    NULL          NULL      24      true      b
1184  timestamptz  NULL          NULL      24      true      b
1186  interval     NULL          NULL      24      true      b
1700  decimal      NULL          NULL      -1      false     b
2283  anyelement   NULL          NULL      -1      false     b

query ITTBBTIII colnames
SELECT oid, typname, typcategory, typispreferred, typisdefined, typdelim, typrelid, typelem, typarray
FROM pg_catalog.pg_type
ORDER BY oid
----
oid   typname      typcategory  typispreferred  typisdefined  typdelim  typrelid  typelem  typarray
16    bool         B            false           true          ,         0         0        0
17    bytes        U            false           true          ,         0         0        0
20    int          N            false           true          ,         0         0        0
21    int          N            false           true          ,         0         0        0
23    int          N            false           true          ,         0         0        0
25    string       S            false           true          ,         0         0        0
700   float        N            false           true          ,         0         0        0
701   float        N            false           true          ,         0         0        0
1005  int[]        A            false           true          ,         0         0        0
1007  int[]        A            false           true          ,         0         0        0
1009  string[]     A            false           true          ,         0         0        0
1016  int[]        A            false           true          ,         0         0        0
1043  string       S            false           true          ,         0         0        0
1082  date         D            false           true          ,         0         0        0
1114  timestamp    D            false           true          ,         0         0        0
1184  timestamptz  D            false           true          ,         0         0        0
1186  interval     T            false           true          ,         0         0        0
1700  decimal      N            false           true          ,         0         0        0
2283  anyelement   P            false           true          ,         0         0        0

query ITIIIIIII colnames
SELECT oid, typname, typinput, typoutput, typreceive, typsend, typmodin, typmodout, typanalyze
FROM pg_catalog.pg_type
ORDER BY oid
----
oid   typname      typinput  typoutput  typreceive  typsend  typmodin  typmodout  typanalyze
16    bool         0         0          0           0        0         0          0
17    bytes        0         0          0           0        0         0          0
20    int          0         0          0           0        0         0          0
21    int          0         0          0           0        0         0          0
23    int          0         0          0           0        0         0          0
25    string       0         0          0           0        0         0          0
700   float        0         0          0           0        0         0          0
701   float        0         0          0           0        0         0          0
1005  int[]        0         0          0           0        0         0          0
1007  int[]        0         0          0           0        0         0          0
1009  string[]     0         0          0           0        0         0          0
1016  int[]        0         0          0           0        0         0          0
1043  string       0         0          0           0        0         0          0
1082  date         0         0          0           0        0         0          0
1114  timestamp    0         0          0           0        0         0          0
1184  timestamptz  0         0          0           0        0         0          0
1186  interval     0         0          0           0        0         0          0
1700  decimal      0         0          0           0        0         0          0
2283  anyelement   0         0          0           0        0         0          0

query ITTTBII colnames
SELECT oid, typname, typalign, typstorage, typnotnull, typbasetype, typtypmod
FROM pg_catalog.pg_type
ORDER BY oid
----
oid   typname      typalign  typstorage  typnotnull  typbasetype  typtypmod
16    bool         NULL      NULL        false       0            -1
17    bytes        NULL      NULL        false       0            -1
20    int          NULL      NULL        false       0            -1
21    int          NULL      NULL        false       0            -1
23    int          NULL      NULL        false       0            -1
25    string       NULL      NULL        false       0            -1
700   float        NULL      NULL        false       0            -1
701   float        NULL      NULL        false       0            -1
1005  int[]        NULL      NULL        false       0            -1
1007  int[]        NULL      NULL        false       0            -1
1009  string[]     NULL      NULL        false       0            -1
1016  int[]        NULL      NULL        false       0            -1
1043  string       NULL      NULL        false       0            -1
1082  date         NULL      NULL        false       0            -1
1114  timestamp    NULL      NULL        false       0            -1
1184  timestamptz  NULL      NULL        false       0            -1
1186  interval     NULL      NULL        false       0            -1
1700  decimal      NULL      NULL        false       0            -1
2283  anyelement   NULL      NULL        false       0            -1

query ITIITTT colnames
SELECT oid, typname, typndims, typcollation, typdefaultbin, typdefault, typacl
FROM pg_catalog.pg_type
ORDER BY oid
----
oid   typname      typndims  typcollation  typdefaultbin  typdefault  typacl
16    bool         0         0             NULL           NULL        NULL
17    bytes        0         0             NULL           NULL        NULL
20    int          0         0             NULL           NULL        NULL
21    int          0         0             NULL           NULL        NULL
23    int          0         0             NULL           NULL        NULL
25    string       0         0             NULL           NULL        NULL
700   float        0         0             NULL           NULL        NULL
701   float        0         0             NULL           NULL        NULL
1005  int[]        0         0             NULL           NULL        NULL
1007  int[]        0         0             NULL           NULL        NULL
1009  string[]     0         0             NULL           NULL        NULL
1016  int[]        0         0             NULL           NULL        NULL
1043  string       0         0             NULL           NULL        NULL
1082  date         0         0             NULL           NULL        NULL
1114  timestamp    0         0             NULL           NULL        NULL
1184  timestamptz  0         0             NULL           NULL        NULL
1186  interval     0         0             NULL           NULL        NULL
1700  decimal      0         0             NULL           NULL        NULL
2283  anyelement   0         0             NULL           NULL        NULL

## pg_catalog.pg_database

query ITIITTBB colnames
SELECT oid, datname, datdba, encoding, datcollate, datctype, datistemplate, datallowconn
FROM pg_catalog.pg_database
ORDER BY oid
----
oid         datname             datdba  encoding  datcollate  datctype    datistemplate  datallowconn
1793492844  system              NULL    6         en_US.utf8  en_US.utf8  false          true
2091240128  test                NULL    6         en_US.utf8  en_US.utf8  false          true
3061586988  constraint_db       NULL    6         en_US.utf8  en_US.utf8  false          true
3178318485  pg_catalog          NULL    6         en_US.utf8  en_US.utf8  false          true
3816276882  information_schema  NULL    6         en_US.utf8  en_US.utf8  false          true

query ITIIIIIT colnames
SELECT oid, datname, datconnlimit, datlastsysoid, datfrozenxid, datminmxid, dattablespace, datacl
FROM pg_catalog.pg_database
ORDER BY oid
----
oid         datname             datconnlimit  datlastsysoid  datfrozenxid  datminmxid  dattablespace  datacl
1793492844  system              -1            NULL           NULL          NULL        NULL           NULL
2091240128  test                -1            NULL           NULL          NULL        NULL           NULL
3061586988  constraint_db       -1            NULL           NULL          NULL        NULL           NULL
3178318485  pg_catalog          -1            NULL           NULL          NULL        NULL           NULL
3816276882  information_schema  -1            NULL           NULL          NULL        NULL           NULL

## pg_catalog.pg_proc

query TITITTI colnames
SELECT proname, pronamespace, proowner, prolang, procost, prorows, provariadic
FROM pg_catalog.pg_proc
WHERE proname='substring';
----
proname    pronamespace  proowner  prolang  procost  prorows  provariadic
substring  3178318485    NULL      0        NULL     NULL     0
substring  3178318485    NULL      0        NULL     NULL     0
substring  3178318485    NULL      0        NULL     NULL     0
substring  3178318485    NULL      0        NULL     NULL     0

query TTBBBB colnames
SELECT proname, protransform, proisagg, proiswindow, prosecdef, proleakproof
FROM pg_catalog.pg_proc
WHERE proname='substring';
----
proname    protransform  proisagg  proiswindow  prosecdef  proleakproof
substring  NULL          false     false        false      true
substring  NULL          false     false        false      true
substring  NULL          false     false        false      true
substring  NULL          false     false        false      true

query TBBTT colnames
SELECT proname, proisstrict, proretset, provolatile, proparallel
FROM pg_catalog.pg_proc
WHERE proname='substring';
----
proname    proisstrict  proretset  provolatile  proparallel
substring  false        false      NULL         NULL
substring  false        false      NULL         NULL
substring  false        false      NULL         NULL
substring  false        false      NULL         NULL

query TIIITTTT colnames
SELECT proname, pronargs, pronargdefaults, prorettype, proargtypes, proallargtypes, proargmodes, proargdefaults
FROM pg_catalog.pg_proc
WHERE proname='substring';
----
proname    pronargs  pronargdefaults  prorettype  proargtypes  proallargtypes  proargmodes  proargdefaults
substring  2         0                25          25, 20       NULL            NULL         NULL
substring  3         0                25          25, 20, 20   NULL            NULL         NULL
substring  2         0                25          25, 25       NULL            NULL         NULL
substring  3         0                25          25, 25, 25   NULL            NULL         NULL

query TTTTTT colnames
SELECT proname, protrftypes, prosrc, probin, proconfig, proacl
FROM pg_catalog.pg_proc
WHERE proname='substring';
----
proname    protrftypes  prosrc     probin  proconfig  proacl
substring  NULL         substring  NULL    NULL       NULL
substring  NULL         substring  NULL    NULL       NULL
substring  NULL         substring  NULL    NULL       NULL
substring  NULL         substring  NULL    NULL       NULL

query TIIITT colnames
SELECT proname, provariadic, pronargs, prorettype, proargtypes, proargmodes
FROM pg_catalog.pg_proc
WHERE proname='least'
----
proname  provariadic  pronargs  prorettype  proargtypes  proargmodes
least    2283         1         2283        2283         v

## pg_catalog.pg_roles

query ITBBBBBBI colnames
SELECT oid, rolname, rolsuper, rolinherit, rolcreaterole, rolcreatedb, rolcatupdate, rolcanlogin, rolconnlimit
FROM pg_catalog.pg_roles
ORDER BY rolname;
----
oid         rolname   rolsuper  rolinherit  rolcreaterole  rolcreatedb  rolcatupdate  rolcanlogin  rolconnlimit
4230608961  root      true      false       true           true         false         true         -1
4079356392  testuser  false     false       false          false        false         true         -1

query ITTTT colnames
SELECT oid, rolname, rolpassword, rolvaliduntil, rolconfig
FROM pg_catalog.pg_roles
ORDER BY rolname;
----
oid         rolname   rolpassword  rolvaliduntil  rolconfig
4230608961  root      ********     NULL           {}
4079356392  testuser  ********     NULL           {}

## pg_catalog.pg_description

query IIIT colnames
SELECT * FROM pg_catalog.pg_description
----
objoid  classoid  objsubid  description

## pg_catalog.pg_settings

query TTTTTT colnames
SELECT name, setting, category, short_desc, extra_desc, vartype FROM pg_catalog.pg_settings
----
name                           setting       category  short_desc  extra_desc  vartype
database                       test          NULL      NULL        NULL        string
default_transaction_isolation  SERIALIZABLE  NULL      NULL        NULL        string
max_index_keys                 32            NULL      NULL        NULL        string
syntax                         Traditional   NULL      NULL        NULL        string
time zone                      UTC           NULL      NULL        NULL        string
transaction isolation level    SERIALIZABLE  NULL      NULL        NULL        string
transaction priority           NORMAL        NULL      NULL        NULL        string

query TTTTTTT colnames
SELECT name, setting, unit, context, enumvals, boot_val, reset_val FROM pg_catalog.pg_settings
----
name                           setting       unit  context  enumvals  boot_val      reset_val
database                       test          NULL  user     NULL      test          test
default_transaction_isolation  SERIALIZABLE  NULL  user     NULL      SERIALIZABLE  SERIALIZABLE
max_index_keys                 32            NULL  user     NULL      32            32
syntax                         Traditional   NULL  user     NULL      Traditional   Traditional
time zone                      UTC           NULL  user     NULL      UTC           UTC
transaction isolation level    SERIALIZABLE  NULL  user     NULL      SERIALIZABLE  SERIALIZABLE
transaction priority           NORMAL        NULL  user     NULL      NORMAL        NORMAL

query TTTTTT colnames
SELECT name, source, min_val, max_val, sourcefile, sourceline FROM pg_catalog.pg_settings
----
name                           source  min_val  max_val  sourcefile  sourceline
database                       NULL    NULL     NULL     NULL        NULL
default_transaction_isolation  NULL    NULL     NULL     NULL        NULL
max_index_keys                 NULL    NULL     NULL     NULL        NULL
syntax                         NULL    NULL     NULL     NULL        NULL
time zone                      NULL    NULL     NULL     NULL        NULL
transaction isolation level    NULL    NULL     NULL     NULL        NULL
transaction priority           NULL    NULL     NULL     NULL        NULL
