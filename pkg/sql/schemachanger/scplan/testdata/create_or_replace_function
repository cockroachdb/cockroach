setup
CREATE TABLE t(
  a INT PRIMARY KEY,
  b INT,
  C INT,
  INDEX t_idx_b(b),
  INDEX t_idx_c(c)
);
CREATE SEQUENCE sq1;
CREATE VIEW v AS SELECT a FROM t;
CREATE TYPE notmyworkday AS ENUM ('Monday', 'Tuesday');
CREATE FUNCTION f(a notmyworkday) RETURNS INT VOLATILE LANGUAGE SQL AS $$
  SELECT a FROM t;
  SELECT b FROM t@t_idx_b;
  SELECT c FROM t@t_idx_c;
  SELECT a FROM v;
  SELECT nextval('sq1');
$$;
----

ops
CREATE OR REPLACE FUNCTION f(a notmyworkday) RETURNS INT IMMUTABLE LANGUAGE SQL AS $$
  SELECT 1;
$$;
----
StatementPhase stage 1 of 1 with 8 MutationType ops
  transitions:
    [[FunctionVolatility:{DescID: 109, Int32Value: VOLATILE}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionParams:{DescID: 109, SeqNum: 0}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionBody:{DescID: 109, SeqNum: 0, Value: SELECT a FROM defaultdb.public.t;
    SELECT b FROM defaultdb.public.t@t_idx_b;
    SELECT c FROM defaultdb.public.t@t_idx_c;
    SELECT a FROM defaultdb.public.v;
    SELECT nextval(105:::REGCLASS);}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionVolatility:{DescID: 109, Int32Value: IMMUTABLE}, PUBLIC], ABSENT] -> PUBLIC
    [[FunctionBody:{DescID: 109, SeqNum: 1, Value: SELECT 1;}, PUBLIC], ABSENT] -> PUBLIC
    [[FunctionParams:{DescID: 109, SeqNum: 1}, PUBLIC], ABSENT] -> PUBLIC
  ops:
    *scop.RemoveBackReferenceInTypes
      BackReferencedDescriptorID: 109
      TypeIDs:
      - 107
      - 108
    *scop.RemoveBackReferencesInRelations
      BackReferencedID: 109
      RelationIDs:
      - 104
      - 104
      - 104
      - 106
      - 105
    *scop.RemoveBackReferenceInFunctions
      BackReferencedDescriptorID: 109
    *scop.SetFunctionVolatility
      FunctionID: 109
      Volatility: 2
    *scop.SetFunctionBody
      Body:
        Body: SELECT 1;
        FunctionID: 109
        Lang:
          Lang: 1
        SeqNum: 1
        UsesTypeIDs:
        - 107
        - 108
    *scop.UpdateFunctionTypeReferences
      FunctionID: 109
      TypeIDs:
      - 107
      - 108
    *scop.UpdateFunctionRelationReferences
      FunctionID: 109
    *scop.SetFunctionParams
      FunctionID: 109
      Params:
      - name: a
        class:
          class: 0
        type:
          type: |
            family: EnumFamily
            width: 0
            precision: 0
            locale: ""
            visible_type: 0
            oid: 100107
            time_precision_is_set: false
            udt_metadata: <
              array_type_oid: 100108
            >
          closedtypeids:
          - 107
          - 108
          typename: public.notmyworkday
        defaultexpr: ""
PreCommitPhase stage 1 of 2 with 1 MutationType op
  transitions:
    [[FunctionVolatility:{DescID: 109, Int32Value: VOLATILE}, ABSENT], ABSENT] -> PUBLIC
    [[FunctionParams:{DescID: 109, SeqNum: 0}, ABSENT], ABSENT] -> PUBLIC
    [[FunctionBody:{DescID: 109, SeqNum: 0, Value: SELECT a FROM defaultdb.public.t;
    SELECT b FROM defaultdb.public.t@t_idx_b;
    SELECT c FROM defaultdb.public.t@t_idx_c;
    SELECT a FROM defaultdb.public.v;
    SELECT nextval(105:::REGCLASS);}, ABSENT], ABSENT] -> PUBLIC
    [[FunctionVolatility:{DescID: 109, Int32Value: IMMUTABLE}, PUBLIC], PUBLIC] -> ABSENT
    [[FunctionBody:{DescID: 109, SeqNum: 1, Value: SELECT 1;}, PUBLIC], PUBLIC] -> ABSENT
    [[FunctionParams:{DescID: 109, SeqNum: 1}, PUBLIC], PUBLIC] -> ABSENT
  ops:
    *scop.UndoAllInTxnImmediateMutationOpSideEffects
      {}
PreCommitPhase stage 2 of 2 with 8 MutationType ops
  transitions:
    [[FunctionVolatility:{DescID: 109, Int32Value: VOLATILE}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionParams:{DescID: 109, SeqNum: 0}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionBody:{DescID: 109, SeqNum: 0, Value: SELECT a FROM defaultdb.public.t;
    SELECT b FROM defaultdb.public.t@t_idx_b;
    SELECT c FROM defaultdb.public.t@t_idx_c;
    SELECT a FROM defaultdb.public.v;
    SELECT nextval(105:::REGCLASS);}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionVolatility:{DescID: 109, Int32Value: IMMUTABLE}, PUBLIC], ABSENT] -> PUBLIC
    [[FunctionBody:{DescID: 109, SeqNum: 1, Value: SELECT 1;}, PUBLIC], ABSENT] -> PUBLIC
    [[FunctionParams:{DescID: 109, SeqNum: 1}, PUBLIC], ABSENT] -> PUBLIC
  ops:
    *scop.RemoveBackReferenceInTypes
      BackReferencedDescriptorID: 109
      TypeIDs:
      - 107
      - 108
    *scop.RemoveBackReferencesInRelations
      BackReferencedID: 109
      RelationIDs:
      - 104
      - 104
      - 104
      - 106
      - 105
    *scop.RemoveBackReferenceInFunctions
      BackReferencedDescriptorID: 109
    *scop.SetFunctionVolatility
      FunctionID: 109
      Volatility: 2
    *scop.SetFunctionBody
      Body:
        Body: SELECT 1;
        FunctionID: 109
        Lang:
          Lang: 1
        SeqNum: 1
        UsesTypeIDs:
        - 107
        - 108
    *scop.UpdateFunctionTypeReferences
      FunctionID: 109
      TypeIDs:
      - 107
      - 108
    *scop.UpdateFunctionRelationReferences
      FunctionID: 109
    *scop.SetFunctionParams
      FunctionID: 109
      Params:
      - name: a
        class:
          class: 0
        type:
          type: |
            family: EnumFamily
            width: 0
            precision: 0
            locale: ""
            visible_type: 0
            oid: 100107
            time_precision_is_set: false
            udt_metadata: <
              array_type_oid: 100108
            >
          closedtypeids:
          - 107
          - 108
          typename: public.notmyworkday
        defaultexpr: ""
