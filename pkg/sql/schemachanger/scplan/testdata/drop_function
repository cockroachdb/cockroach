setup
CREATE TABLE t(
  a INT PRIMARY KEY,
  b INT,
  C INT,
  INDEX t_idx_b(b),
  INDEX t_idx_c(c)
);
CREATE SEQUENCE sq1;
CREATE VIEW v AS SELECT a FROM t;
CREATE TYPE notmyworkday AS ENUM ('Monday', 'Tuesday');
CREATE FUNCTION f(a notmyworkday) RETURNS INT VOLATILE LANGUAGE SQL AS $$
  SELECT a FROM t;
  SELECT b FROM t@t_idx_b;
  SELECT c FROM t@t_idx_c;
  SELECT a FROM v;
  SELECT nextval('sq1');
$$;
----

ops
DROP FUNCTION f;
----
StatementPhase stage 1 of 1 with 12 MutationType ops
  transitions:
    [[Owner:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[UserPrivileges:{DescID: 10005, Name: admin}, ABSENT], PUBLIC] -> ABSENT
    [[UserPrivileges:{DescID: 10005, Name: public}, ABSENT], PUBLIC] -> ABSENT
    [[UserPrivileges:{DescID: 10005, Name: root}, ABSENT], PUBLIC] -> ABSENT
    [[Function:{DescID: 10005}, ABSENT], PUBLIC] -> DROPPED
    [[SchemaChild:{DescID: 10005, ReferencedDescID: 101}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionName:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionVolatility:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionLeakProof:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionNullInputBehavior:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionBody:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
  ops:
    *scop.MarkDescriptorAsDropped
      DescriptorID: 10005
    *scop.RemoveObjectParent
      ObjectID: 10005
      ParentSchemaID: 101
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.FunctionName
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.FunctionVolatility
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.FunctionLeakProof
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.FunctionNullInputBehavior
    *scop.RemoveBackReferenceInTypes
      BackReferencedDescriptorID: 10005
      TypeIDs:
      - 10003
      - 10004
    *scop.RemoveBackReferencesInRelations
      BackReferencedID: 10005
      RelationIDs:
      - 10000
      - 10000
      - 10000
      - 10002
      - 10001
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.Owner
    *scop.RemoveUserPrivileges
      DescriptorID: 10005
      User: admin
    *scop.RemoveUserPrivileges
      DescriptorID: 10005
      User: public
    *scop.RemoveUserPrivileges
      DescriptorID: 10005
      User: root
PreCommitPhase stage 1 of 2 with 1 MutationType op
  transitions:
    [[Owner:{DescID: 10005}, ABSENT], ABSENT] -> PUBLIC
    [[UserPrivileges:{DescID: 10005, Name: admin}, ABSENT], ABSENT] -> PUBLIC
    [[UserPrivileges:{DescID: 10005, Name: public}, ABSENT], ABSENT] -> PUBLIC
    [[UserPrivileges:{DescID: 10005, Name: root}, ABSENT], ABSENT] -> PUBLIC
    [[Function:{DescID: 10005}, ABSENT], DROPPED] -> PUBLIC
    [[SchemaChild:{DescID: 10005, ReferencedDescID: 101}, ABSENT], ABSENT] -> PUBLIC
    [[FunctionName:{DescID: 10005}, ABSENT], ABSENT] -> PUBLIC
    [[FunctionVolatility:{DescID: 10005}, ABSENT], ABSENT] -> PUBLIC
    [[FunctionLeakProof:{DescID: 10005}, ABSENT], ABSENT] -> PUBLIC
    [[FunctionNullInputBehavior:{DescID: 10005}, ABSENT], ABSENT] -> PUBLIC
    [[FunctionBody:{DescID: 10005}, ABSENT], ABSENT] -> PUBLIC
  ops:
    *scop.UndoAllInTxnImmediateMutationOpSideEffects
      {}
PreCommitPhase stage 2 of 2 with 19 MutationType ops
  transitions:
    [[Owner:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[UserPrivileges:{DescID: 10005, Name: admin}, ABSENT], PUBLIC] -> ABSENT
    [[UserPrivileges:{DescID: 10005, Name: public}, ABSENT], PUBLIC] -> ABSENT
    [[UserPrivileges:{DescID: 10005, Name: root}, ABSENT], PUBLIC] -> ABSENT
    [[Function:{DescID: 10005}, ABSENT], PUBLIC] -> DROPPED
    [[SchemaChild:{DescID: 10005, ReferencedDescID: 101}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionName:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionVolatility:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionLeakProof:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionNullInputBehavior:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
    [[FunctionBody:{DescID: 10005}, ABSENT], PUBLIC] -> ABSENT
  ops:
    *scop.MarkDescriptorAsDropped
      DescriptorID: 10005
    *scop.RemoveObjectParent
      ObjectID: 10005
      ParentSchemaID: 101
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.FunctionName
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.FunctionVolatility
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.FunctionLeakProof
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.FunctionNullInputBehavior
    *scop.RemoveBackReferenceInTypes
      BackReferencedDescriptorID: 10005
      TypeIDs:
      - 10003
      - 10004
    *scop.RemoveBackReferencesInRelations
      BackReferencedID: 10005
      RelationIDs:
      - 10000
      - 10000
      - 10000
      - 10002
      - 10001
    *scop.NotImplementedForPublicObjects
      DescID: 10005
      ElementType: scpb.Owner
    *scop.RemoveUserPrivileges
      DescriptorID: 10005
      User: admin
    *scop.RemoveUserPrivileges
      DescriptorID: 10005
      User: public
    *scop.RemoveUserPrivileges
      DescriptorID: 10005
      User: root
    *scop.SetJobStateOnDescriptor
      DescriptorID: 10000
      Initialize: true
    *scop.SetJobStateOnDescriptor
      DescriptorID: 10001
      Initialize: true
    *scop.SetJobStateOnDescriptor
      DescriptorID: 10002
      Initialize: true
    *scop.SetJobStateOnDescriptor
      DescriptorID: 10003
      Initialize: true
    *scop.SetJobStateOnDescriptor
      DescriptorID: 10004
      Initialize: true
    *scop.SetJobStateOnDescriptor
      DescriptorID: 10005
      Initialize: true
    *scop.CreateSchemaChangerJob
      Authorization:
        AppName: $ internal-test
        UserName: root
      DescriptorIDs:
      - 10000
      - 10001
      - 10002
      - 10003
      - 10004
      - 10005
      JobID: 1
      NonCancelable: true
      RunningStatus: PostCommitNonRevertiblePhase stage 1 of 1 with 1 MutationType op pending
      Statements:
      - statement: DROP FUNCTION f
        redactedstatement: DROP FUNCTION ‹""›.‹""›.‹f›
        statementtag: DROP FUNCTION
PostCommitNonRevertiblePhase stage 1 of 1 with 8 MutationType ops
  transitions:
    [[Function:{DescID: 10005}, ABSENT], DROPPED] -> ABSENT
  ops:
    *scop.DeleteDescriptor
      DescriptorID: 10005
    *scop.RemoveJobStateFromDescriptor
      DescriptorID: 10000
      JobID: 1
    *scop.RemoveJobStateFromDescriptor
      DescriptorID: 10001
      JobID: 1
    *scop.RemoveJobStateFromDescriptor
      DescriptorID: 10002
      JobID: 1
    *scop.RemoveJobStateFromDescriptor
      DescriptorID: 10003
      JobID: 1
    *scop.RemoveJobStateFromDescriptor
      DescriptorID: 10004
      JobID: 1
    *scop.RemoveJobStateFromDescriptor
      DescriptorID: 10005
      JobID: 1
    *scop.UpdateSchemaChangerJob
      DescriptorIDsToRemove:
      - 10000
      - 10001
      - 10002
      - 10003
      - 10004
      - 10005
      IsNonCancelable: true
      JobID: 1
