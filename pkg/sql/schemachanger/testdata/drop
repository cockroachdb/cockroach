setup
CREATE DATABASE db;
CREATE SCHEMA db.sc;
----
...
+database {0 0 db} -> 104
+schema {104 0 public} -> 105
+schema {104 0 sc} -> 106

test
DROP SCHEMA db.sc;
----
checking for feature: DROP SCHEMA
begin transaction #1
# begin StatementPhase
## StatementPhase stage 1 of 1 with 2 MutationType ops
delete comment for descriptor #106 of type SchemaCommentType
# end StatementPhase
# begin PreCommitPhase
## PreCommitPhase stage 1 of 1 with 5 MutationType ops
create job #1: "schema change job"
  descriptor IDs: [104 106]
upsert descriptor #104
   database:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP SCHEMA ‹db›.‹sc›
  +        statement: DROP SCHEMA db.sc
  +        statementTag: DROP SCHEMA
  +    targetRanks:
  +    - 1
  +    targets:
  +    - elementProto:
  +        schemaEntry:
  +          databaseId: 104
  +          schemaId: 106
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
     id: 104
     modificationTime: {}
  ...
       public:
         id: 105
  -    sc:
  -      id: 106
  -  version: "2"
  +  version: "3"
upsert descriptor #106
   schema:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP SCHEMA ‹db›.‹sc›
  +        statement: DROP SCHEMA db.sc
  +        statementTag: DROP SCHEMA
  +    targetRanks:
  +    - 0
  +    - 2
  +    targets:
  +    - elementProto:
  +        schema:
  +          schemaId: 106
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        schemaComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          schemaId: 106
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
     id: 106
     modificationTime: {}
  ...
         withGrantOption: 2
       version: 2
  -  version: "1"
  +  state: DROP
  +  version: "2"
# end PreCommitPhase
commit transaction #1
# begin PostCommitPhase
begin transaction #2
commit transaction #2
begin transaction #3
## PostCommitNonRevertiblePhase stage 1 of 1 with 6 MutationType ops
write *eventpb.DropSchema to event log for descriptor #106: DROP SCHEMA ‹db›.‹sc›
update progress of schema change job #1
set schema change job #1 to non-cancellable
delete schema namespace entry {104 0 sc} -> 106
upsert descriptor #104
   database:
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP SCHEMA ‹db›.‹sc›
  -        statement: DROP SCHEMA db.sc
  -        statementTag: DROP SCHEMA
  -    targetRanks:
  -    - 1
  -    targets:
  -    - elementProto:
  -        schemaEntry:
  -          databaseId: 104
  -          schemaId: 106
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
     id: 104
     modificationTime: {}
  ...
       public:
         id: 105
  -  version: "3"
  +  version: "4"
delete descriptor #106
commit transaction #3
# end PostCommitPhase

setup
CREATE SCHEMA db.sc;
CREATE TABLE db.sc.t (k INT, v STRING);
CREATE TYPE db.sc.e AS ENUM('a', 'b', 'c');
----
...
+schema {104 0 sc} -> 107
+object {104 107 t} -> 108
+object {104 107 e} -> 109
+object {104 107 _e} -> 110

test
DROP TABLE db.sc.t;
----
checking for feature: DROP TABLE
begin transaction #1
# begin StatementPhase
## StatementPhase stage 1 of 1 with 6 MutationType ops
delete comment for descriptor #108 of type TableCommentType
delete comment for descriptor #108 of type ColumnCommentType
delete comment for descriptor #108 of type ColumnCommentType
delete comment for descriptor #108 of type IndexCommentType
delete comment for constraint on #108, constraint id: 1
# end StatementPhase
# begin PreCommitPhase
## PreCommitPhase stage 1 of 1 with 4 MutationType ops
create job #1: "schema change job"
  descriptor IDs: [108]
delete object namespace entry {104 107 t} -> 108
upsert descriptor #108
  ...
     createAsOfTime:
       wallTime: "1"
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - DELETE_AND_WRITE_ONLY
  +    - ABSENT
  +    - ABSENT
  +    - DELETE_AND_WRITE_ONLY
  +    - ABSENT
  +    - VALIDATED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP TABLE ‹db›.‹sc›.‹t›
  +        statement: DROP TABLE db.sc.t
  +        statementTag: DROP TABLE
  +    targetRanks:
  +    - 0
  +    - 1
  +    - 2
  +    - 3
  +    - 4
  +    - 5
  +    - 6
  +    - 7
  +    - 8
  +    - 9
  +    - 10
  +    - 11
  +    - 12
  +    - 13
  +    - 14
  +    - 15
  +    - 16
  +    - 17
  +    targets:
  +    - elementProto:
  +        table:
  +          tableId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 104
  +          descriptorId: 108
  +          name: t
  +          schemaId: 107
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 108
  +          owner: root
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 108
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 108
  +          username: public
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 108
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnName:
  +          columnId: 1
  +          name: k
  +          tableId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        column:
  +          columnId: 1
  +          familyName: primary
  +          nullable: true
  +          pgAttributeNum: 1
  +          tableId: 108
  +          type:
  +            family: IntFamily
  +            oid: 20
  +            width: 64
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnComment:
  +          columnId: 1
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnName:
  +          columnId: 2
  +          name: v
  +          tableId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        column:
  +          columnId: 2
  +          familyName: primary
  +          nullable: true
  +          pgAttributeNum: 2
  +          tableId: 108
  +          type:
  +            family: StringFamily
  +            oid: 25
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnComment:
  +          columnId: 2
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        primaryIndex:
  +          indexId: 1
  +          keyColumnDirections:
  +          - ASC
  +          keyColumnIds:
  +          - 3
  +          shardedDescriptor: {}
  +          sourceIndexId: 1
  +          storingColumnIds:
  +          - 1
  +          - 2
  +          tableId: 108
  +          unique: true
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        indexName:
  +          indexId: 1
  +          name: t_pkey
  +          tableId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        constraintComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          constraintId: 1
  +          tableId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        indexComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          indexId: 1
  +          tableId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 108
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
     families:
     - columnIds:
  ...
     replacementOf:
       time: {}
  +  state: DROP
     unexposedParentSchemaId: 107
  -  version: "1"
  +  version: "2"
# end PreCommitPhase
commit transaction #1
# begin PostCommitPhase
begin transaction #2
commit transaction #2
begin transaction #3
## PostCommitNonRevertiblePhase stage 1 of 1 with 4 MutationType ops
create job #2: "GC for dropping descriptor 108"
  descriptor IDs: [108]
write *eventpb.DropTable to event log for descriptor #108: DROP TABLE ‹db›.‹sc›.‹t›
update progress of schema change job #1
set schema change job #1 to non-cancellable
upsert descriptor #108
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - DELETE_AND_WRITE_ONLY
  -    - ABSENT
  -    - ABSENT
  -    - DELETE_AND_WRITE_ONLY
  -    - ABSENT
  -    - VALIDATED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP TABLE ‹db›.‹sc›.‹t›
  -        statement: DROP TABLE db.sc.t
  -        statementTag: DROP TABLE
  -    targetRanks:
  -    - 0
  -    - 1
  -    - 2
  -    - 3
  -    - 4
  -    - 5
  -    - 6
  -    - 7
  -    - 8
  -    - 9
  -    - 10
  -    - 11
  -    - 12
  -    - 13
  -    - 14
  -    - 15
  -    - 16
  -    - 17
  -    targets:
  -    - elementProto:
  -        table:
  -          tableId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 104
  -          descriptorId: 108
  -          name: t
  -          schemaId: 107
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 108
  -          owner: root
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 108
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 108
  -          username: public
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 108
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnName:
  -          columnId: 1
  -          name: k
  -          tableId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        column:
  -          columnId: 1
  -          familyName: primary
  -          nullable: true
  -          pgAttributeNum: 1
  -          tableId: 108
  -          type:
  -            family: IntFamily
  -            oid: 20
  -            width: 64
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnComment:
  -          columnId: 1
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnName:
  -          columnId: 2
  -          name: v
  -          tableId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        column:
  -          columnId: 2
  -          familyName: primary
  -          nullable: true
  -          pgAttributeNum: 2
  -          tableId: 108
  -          type:
  -            family: StringFamily
  -            oid: 25
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnComment:
  -          columnId: 2
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        primaryIndex:
  -          indexId: 1
  -          keyColumnDirections:
  -          - ASC
  -          keyColumnIds:
  -          - 3
  -          shardedDescriptor: {}
  -          sourceIndexId: 1
  -          storingColumnIds:
  -          - 1
  -          - 2
  -          tableId: 108
  -          unique: true
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        indexName:
  -          indexId: 1
  -          name: t_pkey
  -          tableId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        constraintComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          constraintId: 1
  -          tableId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        indexComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          indexId: 1
  -          tableId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 108
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
     families:
     - columnIds:
  ...
     state: DROP
     unexposedParentSchemaId: 107
  -  version: "2"
  +  version: "3"
commit transaction #3
# end PostCommitPhase

test
DROP SCHEMA db.sc CASCADE;
----
checking for feature: DROP SCHEMA
begin transaction #1
# begin StatementPhase
## StatementPhase stage 1 of 1 with 4 MutationType ops
delete comment for descriptor #107 of type SchemaCommentType
# end StatementPhase
# begin PreCommitPhase
## PreCommitPhase stage 1 of 1 with 11 MutationType ops
create job #1: "schema change job"
  descriptor IDs: [104 107 109 110]
delete object namespace entry {104 107 e} -> 109
delete object namespace entry {104 107 _e} -> 110
upsert descriptor #104
   database:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP SCHEMA ‹db›.‹sc› CASCADE
  +        statement: DROP SCHEMA db.sc CASCADE
  +        statementTag: DROP SCHEMA
  +    targetRanks:
  +    - 5
  +    targets:
  +    - elementProto:
  +        schemaEntry:
  +          databaseId: 104
  +          schemaId: 107
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
     id: 104
     modificationTime: {}
  ...
       public:
         id: 105
  -    sc:
  -      id: 107
  -  version: "4"
  +  version: "5"
upsert descriptor #107
   schema:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP SCHEMA ‹db›.‹sc› CASCADE
  +        statement: DROP SCHEMA db.sc CASCADE
  +        statementTag: DROP SCHEMA
  +    targetRanks:
  +    - 4
  +    - 6
  +    targets:
  +    - elementProto:
  +        schema:
  +          dependentObjects:
  +          - 109
  +          - 110
  +          schemaId: 107
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        schemaComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          schemaId: 107
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
     id: 107
     modificationTime: {}
  ...
         withGrantOption: 2
       version: 2
  -  version: "1"
  +  state: DROP
  +  version: "2"
upsert descriptor #109
   type:
     arrayTypeId: 110
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP SCHEMA ‹db›.‹sc› CASCADE
  +        statement: DROP SCHEMA db.sc CASCADE
  +        statementTag: DROP SCHEMA
  +    targetRanks:
  +    - 0
  +    - 1
  +    targets:
  +    - elementProto:
  +        type:
  +          typeId: 109
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 104
  +          descriptorId: 109
  +          name: e
  +          schemaId: 107
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
     enumMembers:
     - logicalRepresentation: a
  ...
         withGrantOption: 2
       version: 2
  -  version: "1"
  +  state: DROP
  +  version: "2"
upsert descriptor #110
  ...
       family: ArrayFamily
       oid: 100110
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP SCHEMA ‹db›.‹sc› CASCADE
  +        statement: DROP SCHEMA db.sc CASCADE
  +        statementTag: DROP SCHEMA
  +    targetRanks:
  +    - 2
  +    - 3
  +    targets:
  +    - elementProto:
  +        type:
  +          typeId: 110
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 2
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 104
  +          descriptorId: 110
  +          name: _e
  +          schemaId: 107
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 2
  +      targetStatus: ABSENT
     id: 110
     kind: ALIAS
  ...
         withGrantOption: 2
       version: 2
  -  version: "1"
  +  state: DROP
  +  version: "2"
# end PreCommitPhase
commit transaction #1
# begin PostCommitPhase
begin transaction #2
commit transaction #2
begin transaction #3
## PostCommitNonRevertiblePhase stage 1 of 1 with 12 MutationType ops
write *eventpb.DropSchema to event log for descriptor #107: DROP SCHEMA ‹db›.‹sc› CASCADE
write *eventpb.DropType to event log for descriptor #110: DROP SCHEMA ‹db›.‹sc› CASCADE
update progress of schema change job #1
set schema change job #1 to non-cancellable
delete schema namespace entry {104 0 sc} -> 107
upsert descriptor #104
   database:
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP SCHEMA ‹db›.‹sc› CASCADE
  -        statement: DROP SCHEMA db.sc CASCADE
  -        statementTag: DROP SCHEMA
  -    targetRanks:
  -    - 5
  -    targets:
  -    - elementProto:
  -        schemaEntry:
  -          databaseId: 104
  -          schemaId: 107
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
     id: 104
     modificationTime: {}
  ...
       public:
         id: 105
  -  version: "5"
  +  version: "6"
delete descriptor #107
delete descriptor #109
delete descriptor #110
commit transaction #3
# end PostCommitPhase

test
DROP DATABASE db CASCADE;
----
checking for feature: DROP DATABASE
begin transaction #1
# begin StatementPhase
## StatementPhase stage 1 of 1 with 5 MutationType ops
delete comment for descriptor #105 of type SchemaCommentType
delete comment for descriptor #104 of type DatabaseCommentType
delete role settings for database on #104
# end StatementPhase
# begin PreCommitPhase
## PreCommitPhase stage 1 of 1 with 6 MutationType ops
create job #1: "schema change job"
  descriptor IDs: [104 105]
upsert descriptor #104
   database:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - ABSENT
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db› CASCADE
  +        statement: DROP DATABASE db CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 1
  +    - 3
  +    - 4
  +    - 5
  +    targets:
  +    - elementProto:
  +        schemaEntry:
  +          databaseId: 104
  +          schemaId: 105
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        database:
  +          databaseId: 104
  +          dependentObjects:
  +          - 105
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        databaseComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          databaseId: 104
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        databaseRoleSetting:
  +          databaseId: 104
  +          roleName: TODO(fqazi) Roles are not currently fetched from database_role_settings
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
     id: 104
     modificationTime: {}
  ...
         withGrantOption: 2
       version: 2
  -  schemas:
  -    public:
  -      id: 105
  -  version: "5"
  +  schemas: {}
  +  state: DROP
  +  version: "6"
upsert descriptor #105
   schema:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db› CASCADE
  +        statement: DROP DATABASE db CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 0
  +    - 2
  +    targets:
  +    - elementProto:
  +        schema:
  +          schemaId: 105
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        schemaComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          schemaId: 105
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
     id: 105
     modificationTime: {}
  ...
         withGrantOption: 2
       version: 2
  -  version: "1"
  +  state: DROP
  +  version: "2"
# end PreCommitPhase
commit transaction #1
# begin PostCommitPhase
begin transaction #2
commit transaction #2
begin transaction #3
## PostCommitNonRevertiblePhase stage 1 of 1 with 9 MutationType ops
create job #2: "GC for dropping descriptors and parent database 104"
  descriptor IDs: []
write *eventpb.DropDatabase to event log for descriptor #104: DROP DATABASE ‹db› CASCADE
update progress of schema change job #1
set schema change job #1 to non-cancellable
delete database namespace entry {0 0 db} -> 104
delete schema namespace entry {104 0 public} -> 105
upsert descriptor #104
   database:
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - ABSENT
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db› CASCADE
  -        statement: DROP DATABASE db CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 1
  -    - 3
  -    - 4
  -    - 5
  -    targets:
  -    - elementProto:
  -        schemaEntry:
  -          databaseId: 104
  -          schemaId: 105
  -      metadata:
  -        sourceElementId: 2
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        database:
  -          databaseId: 104
  -          dependentObjects:
  -          - 105
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        databaseComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          databaseId: 104
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        databaseRoleSetting:
  -          databaseId: 104
  -          roleName: TODO(fqazi) Roles are not currently fetched from database_role_settings
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
     id: 104
     modificationTime: {}
  ...
       version: 2
     state: DROP
  -  version: "6"
  +  version: "7"
delete descriptor #105
commit transaction #3
# end PostCommitPhase

setup
CREATE DATABASE db1;
CREATE SCHEMA db1.sc1;
CREATE SEQUENCE db1.public.sq1;
CREATE SEQUENCE db1.sc1.sq1;
CREATE TABLE db1.sc1.t1 (id INT PRIMARY KEY, name varchar(256), val int DEFAULT nextval('db1.sc1.sq1'));
CREATE TABLE db1.public.t1 (id INT PRIMARY KEY, name varchar(256), val int DEFAULT nextval('db1.public.sq1'));
CREATE VIEW db1.sc1.v1 AS (SELECT name FROM db1.sc1.t1);
CREATE VIEW db1.sc1.v2 AS (SELECT name AS n1, name AS n2 FROM db1.sc1.v1);
CREATE VIEW db1.sc1.v3 AS (SELECT name, n1 FROM db1.sc1.v1, db1.sc1.v2);
CREATE VIEW db1.sc1.v4 AS (SELECT n2, n1 FROM db1.sc1.v2);
CREATE TYPE db1.sc1.typ AS ENUM('a');
CREATE VIEW db1.sc1.v5 AS (SELECT 'a'::db1.sc1.typ::string AS k, n2, n1 from db1.sc1.v4);
----
...
+database {0 0 db1} -> 111
+schema {111 0 public} -> 112
+schema {111 0 sc1} -> 113
+object {111 112 sq1} -> 114
+object {111 113 sq1} -> 115
+object {111 113 t1} -> 116
+object {111 112 t1} -> 117
+object {111 113 v1} -> 118
+object {111 113 v2} -> 119
+object {111 113 v3} -> 120
+object {111 113 v4} -> 121
+object {111 113 typ} -> 122
+object {111 113 _typ} -> 123
+object {111 113 v5} -> 124

test
DROP DATABASE db1 CASCADE
----
checking for feature: DROP DATABASE
begin transaction #1
# begin StatementPhase
## StatementPhase stage 1 of 1 with 37 MutationType ops
delete comment for descriptor #114 of type TableCommentType
delete comment for descriptor #117 of type TableCommentType
delete comment for descriptor #117 of type ColumnCommentType
delete comment for descriptor #117 of type ColumnCommentType
delete comment for descriptor #117 of type ColumnCommentType
delete comment for descriptor #117 of type IndexCommentType
delete comment for descriptor #112 of type SchemaCommentType
delete comment for descriptor #115 of type TableCommentType
delete comment for descriptor #116 of type TableCommentType
delete comment for descriptor #116 of type ColumnCommentType
delete comment for descriptor #116 of type ColumnCommentType
delete comment for descriptor #116 of type ColumnCommentType
delete comment for descriptor #116 of type IndexCommentType
delete comment for descriptor #118 of type TableCommentType
delete comment for descriptor #119 of type TableCommentType
delete comment for descriptor #120 of type TableCommentType
delete comment for descriptor #121 of type TableCommentType
delete comment for descriptor #124 of type TableCommentType
delete comment for descriptor #113 of type SchemaCommentType
delete comment for descriptor #111 of type DatabaseCommentType
delete comment for constraint on #117, constraint id: 1
delete comment for constraint on #116, constraint id: 1
delete role settings for database on #111
# end StatementPhase
# begin PreCommitPhase
## PreCommitPhase stage 1 of 1 with 56 MutationType ops
create job #1: "schema change job"
  descriptor IDs: [111 112 113 114 115 116 117 118 119 120 121 122 123 124]
delete object namespace entry {111 112 sq1} -> 114
delete object namespace entry {111 113 sq1} -> 115
delete object namespace entry {111 113 t1} -> 116
delete object namespace entry {111 112 t1} -> 117
delete object namespace entry {111 113 v1} -> 118
delete object namespace entry {111 113 v2} -> 119
delete object namespace entry {111 113 v3} -> 120
delete object namespace entry {111 113 v4} -> 121
delete object namespace entry {111 113 typ} -> 122
delete object namespace entry {111 113 _typ} -> 123
delete object namespace entry {111 113 v5} -> 124
upsert descriptor #111
   database:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - ABSENT
  +    - ABSENT
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 32
  +    - 118
  +    - 120
  +    - 121
  +    - 122
  +    targets:
  +    - elementProto:
  +        schemaEntry:
  +          databaseId: 111
  +          schemaId: 112
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        schemaEntry:
  +          databaseId: 111
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        database:
  +          databaseId: 111
  +          dependentObjects:
  +          - 112
  +          - 113
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        databaseComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          databaseId: 111
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        databaseRoleSetting:
  +          databaseId: 111
  +          roleName: TODO(fqazi) Roles are not currently fetched from database_role_settings
  +      metadata:
  +        sourceElementId: 1
  +        subWorkId: 1
  +      targetStatus: ABSENT
     id: 111
     modificationTime: {}
  ...
         withGrantOption: 2
       version: 2
  -  schemas:
  -    public:
  -      id: 112
  -    sc1:
  -      id: 113
  -  version: "2"
  +  schemas: {}
  +  state: DROP
  +  version: "3"
upsert descriptor #112
   schema:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 31
  +    - 33
  +    targets:
  +    - elementProto:
  +        schema:
  +          dependentObjects:
  +          - 114
  +          - 117
  +          schemaId: 112
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        schemaComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          schemaId: 112
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
     id: 112
     modificationTime: {}
  ...
         withGrantOption: 2
       version: 2
  -  version: "1"
  +  state: DROP
  +  version: "2"
upsert descriptor #113
   schema:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 117
  +    - 119
  +    targets:
  +    - elementProto:
  +        schema:
  +          dependentObjects:
  +          - 115
  +          - 116
  +          - 118
  +          - 119
  +          - 120
  +          - 121
  +          - 122
  +          - 123
  +          - 124
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        schemaComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 2
  +        subWorkId: 1
  +      targetStatus: ABSENT
     id: 113
     modificationTime: {}
  ...
         withGrantOption: 2
       version: 2
  -  version: "1"
  +  state: DROP
  +  version: "2"
upsert descriptor #114
  ...
     createAsOfTime:
       wallTime: "1"
  -  dependedOnBy:
  -  - byId: true
  -    columnIds:
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 0
  +    - 1
  +    - 2
       - 3
  -    id: 117
  +    - 4
  +    - 5
  +    - 6
  +    - 7
  +    - 8
  +    targets:
  +    - elementProto:
  +        sequence:
  +          sequenceId: 114
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 114
  +          name: sq1
  +          schemaId: 112
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 114
  +          owner: root
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 114
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 114
  +          username: public
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 114
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 114
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 114
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        relationDependedOnBy:
  +          columnId: 3
  +          dependedOn: 117
  +          tableId: 114
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
     families:
     - columnIds:
  ...
       sequenceOwner: {}
       start: "1"
  +  state: DROP
     unexposedParentSchemaId: 112
  -  version: "2"
  +  version: "3"
upsert descriptor #115
  ...
     createAsOfTime:
       wallTime: "1"
  -  dependedOnBy:
  -  - byId: true
  -    columnIds:
  -    - 3
  -    id: 116
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 34
  +    - 35
  +    - 36
  +    - 37
  +    - 38
  +    - 39
  +    - 40
  +    - 41
  +    - 42
  +    targets:
  +    - elementProto:
  +        sequence:
  +          sequenceId: 115
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 115
  +          name: sq1
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 115
  +          owner: root
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 115
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 115
  +          username: public
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 115
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 115
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 115
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        relationDependedOnBy:
  +          columnId: 3
  +          dependedOn: 116
  +          tableId: 115
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
     families:
     - columnIds:
  ...
       sequenceOwner: {}
       start: "1"
  +  state: DROP
     unexposedParentSchemaId: 113
  -  version: "2"
  +  version: "3"
upsert descriptor #116
  ...
         visibleType: 7
         width: 256
  -  - defaultExpr: nextval(115:::REGCLASS)
  -    id: 3
  +  - id: 3
       name: val
       nullable: true
  ...
         oid: 20
         width: 64
  -    usesSequenceIds:
  -    - 115
     createAsOfTime:
       wallTime: "1"
  -  dependedOnBy:
  -  - columnIds:
  -    - 2
  -    id: 118
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - ABSENT
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - DELETE_AND_WRITE_ONLY
  +    - ABSENT
  +    - ABSENT
  +    - DELETE_AND_WRITE_ONLY
  +    - ABSENT
  +    - ABSENT
  +    - DELETE_AND_WRITE_ONLY
  +    - ABSENT
  +    - VALIDATED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 43
  +    - 44
  +    - 45
  +    - 46
  +    - 47
  +    - 48
  +    - 49
  +    - 50
  +    - 51
  +    - 52
  +    - 53
  +    - 54
  +    - 55
  +    - 56
  +    - 57
  +    - 58
  +    - 59
  +    - 60
  +    - 61
  +    - 62
  +    - 63
  +    - 64
  +    - 65
  +    targets:
  +    - elementProto:
  +        defaultExpression:
  +          columnId: 3
  +          defaultExpr: nextval(115:::REGCLASS)
  +          tableId: 116
  +          usesSequenceIds:
  +          - 115
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        table:
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 116
  +          name: t1
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 116
  +          owner: root
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 116
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 116
  +          username: public
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 116
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnName:
  +          columnId: 1
  +          name: id
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        column:
  +          columnId: 1
  +          familyName: primary
  +          pgAttributeNum: 1
  +          tableId: 116
  +          type:
  +            family: IntFamily
  +            oid: 20
  +            width: 64
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnComment:
  +          columnId: 1
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnName:
  +          columnId: 2
  +          name: name
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        column:
  +          columnId: 2
  +          familyName: primary
  +          nullable: true
  +          pgAttributeNum: 2
  +          tableId: 116
  +          type:
  +            family: StringFamily
  +            oid: 1043
  +            visibleType: 7
  +            width: 256
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnComment:
  +          columnId: 2
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnName:
  +          columnId: 3
  +          name: val
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        column:
  +          columnId: 3
  +          defaultExpr: nextval(115:::REGCLASS)
  +          familyName: primary
  +          nullable: true
  +          pgAttributeNum: 3
  +          tableId: 116
  +          type:
  +            family: IntFamily
  +            oid: 20
  +            width: 64
  +          usesSequenceIds:
  +          - 115
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnComment:
  +          columnId: 3
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        primaryIndex:
  +          indexId: 1
  +          keyColumnDirections:
  +          - ASC
  +          keyColumnIds:
  +          - 1
  +          shardedDescriptor: {}
  +          sourceIndexId: 1
  +          storingColumnIds:
  +          - 2
  +          - 3
  +          tableId: 116
  +          unique: true
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        indexName:
  +          indexId: 1
  +          name: t1_pkey
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        constraintComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          constraintId: 1
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        indexComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          indexId: 1
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        relationDependedOnBy:
  +          columnId: 2
  +          dependedOn: 118
  +          tableId: 116
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
     families:
     - columnIds:
  ...
     replacementOf:
       time: {}
  +  state: DROP
     unexposedParentSchemaId: 113
  -  version: "2"
  +  version: "3"
upsert descriptor #117
  ...
         visibleType: 7
         width: 256
  -  - defaultExpr: nextval(114:::REGCLASS)
  -    id: 3
  +  - id: 3
       name: val
       nullable: true
  ...
         oid: 20
         width: 64
  -    usesSequenceIds:
  -    - 114
     createAsOfTime:
       wallTime: "1"
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - ABSENT
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - DELETE_AND_WRITE_ONLY
  +    - ABSENT
  +    - ABSENT
  +    - DELETE_AND_WRITE_ONLY
  +    - ABSENT
  +    - ABSENT
  +    - DELETE_AND_WRITE_ONLY
  +    - ABSENT
  +    - VALIDATED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 9
  +    - 10
  +    - 11
  +    - 12
  +    - 13
  +    - 14
  +    - 15
  +    - 16
  +    - 17
  +    - 18
  +    - 19
  +    - 20
  +    - 21
  +    - 22
  +    - 23
  +    - 24
  +    - 25
  +    - 26
  +    - 27
  +    - 28
  +    - 29
  +    - 30
  +    targets:
  +    - elementProto:
  +        defaultExpression:
  +          columnId: 3
  +          defaultExpr: nextval(114:::REGCLASS)
  +          tableId: 117
  +          usesSequenceIds:
  +          - 114
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        table:
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 117
  +          name: t1
  +          schemaId: 112
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 117
  +          owner: root
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 117
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 117
  +          username: public
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 117
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnName:
  +          columnId: 1
  +          name: id
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        column:
  +          columnId: 1
  +          familyName: primary
  +          pgAttributeNum: 1
  +          tableId: 117
  +          type:
  +            family: IntFamily
  +            oid: 20
  +            width: 64
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnComment:
  +          columnId: 1
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnName:
  +          columnId: 2
  +          name: name
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        column:
  +          columnId: 2
  +          familyName: primary
  +          nullable: true
  +          pgAttributeNum: 2
  +          tableId: 117
  +          type:
  +            family: StringFamily
  +            oid: 1043
  +            visibleType: 7
  +            width: 256
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnComment:
  +          columnId: 2
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnName:
  +          columnId: 3
  +          name: val
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        column:
  +          columnId: 3
  +          defaultExpr: nextval(114:::REGCLASS)
  +          familyName: primary
  +          nullable: true
  +          pgAttributeNum: 3
  +          tableId: 117
  +          type:
  +            family: IntFamily
  +            oid: 20
  +            width: 64
  +          usesSequenceIds:
  +          - 114
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        columnComment:
  +          columnId: 3
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        primaryIndex:
  +          indexId: 1
  +          keyColumnDirections:
  +          - ASC
  +          keyColumnIds:
  +          - 1
  +          shardedDescriptor: {}
  +          sourceIndexId: 1
  +          storingColumnIds:
  +          - 2
  +          - 3
  +          tableId: 117
  +          unique: true
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        indexName:
  +          indexId: 1
  +          name: t1_pkey
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        constraintComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          constraintId: 1
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        indexComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          indexId: 1
  +          tableId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 117
  +      metadata:
  +        sourceElementId: 3
  +        subWorkId: 1
  +      targetStatus: ABSENT
     families:
     - columnIds:
  ...
     replacementOf:
       time: {}
  +  state: DROP
     unexposedParentSchemaId: 112
  -  version: "1"
  +  version: "2"
upsert descriptor #118
  ...
     createAsOfTime:
       wallTime: "1"
  -  dependedOnBy:
  -  - columnIds:
  -    - 1
  -    id: 119
  -  - columnIds:
  -    - 1
  -    id: 120
  -  dependsOn:
  -  - 116
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 66
  +    - 67
  +    - 68
  +    - 69
  +    - 70
  +    - 71
  +    - 72
  +    - 73
  +    - 74
  +    - 75
  +    targets:
  +    - elementProto:
  +        view:
  +          tableId: 118
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 118
  +          name: v1
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 118
  +          owner: root
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 118
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 118
  +          username: public
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 118
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 118
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 118
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        relationDependedOnBy:
  +          columnId: 1
  +          dependedOn: 119
  +          tableId: 118
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        relationDependedOnBy:
  +          columnId: 1
  +          dependedOn: 120
  +          tableId: 118
  +      metadata:
  +        sourceElementId: 8
  +        subWorkId: 1
  +      targetStatus: ABSENT
     formatVersion: 3
     id: 118
  ...
     replacementOf:
       time: {}
  +  state: DROP
     unexposedParentSchemaId: 113
  -  version: "3"
  +  version: "4"
     viewQuery: (SELECT name FROM db1.sc1.t1)
upsert descriptor #119
  ...
     createAsOfTime:
       wallTime: "1"
  -  dependedOnBy:
  -  - columnIds:
  -    - 1
  -    - 2
  -    id: 120
  -  - columnIds:
  -    - 1
  -    - 2
  -    id: 121
  -  dependsOn:
  -  - 118
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 76
  +    - 77
  +    - 78
  +    - 79
  +    - 80
  +    - 81
  +    - 82
  +    - 83
  +    - 84
  +    - 85
  +    targets:
  +    - elementProto:
  +        view:
  +          tableId: 119
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 119
  +          name: v2
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 119
  +          owner: root
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 119
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 119
  +          username: public
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 119
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 119
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 119
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        relationDependedOnBy:
  +          columnId: 1
  +          dependedOn: 120
  +          tableId: 119
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        relationDependedOnBy:
  +          columnId: 1
  +          dependedOn: 121
  +          tableId: 119
  +      metadata:
  +        sourceElementId: 9
  +        subWorkId: 1
  +      targetStatus: ABSENT
     formatVersion: 3
     id: 119
  ...
     replacementOf:
       time: {}
  +  state: DROP
     unexposedParentSchemaId: 113
  -  version: "3"
  +  version: "4"
     viewQuery: (SELECT name AS n1, name AS n2 FROM db1.sc1.v1)
upsert descriptor #120
  ...
     createAsOfTime:
       wallTime: "1"
  -  dependsOn:
  -  - 118
  -  - 119
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 86
  +    - 87
  +    - 88
  +    - 89
  +    - 90
  +    - 91
  +    - 92
  +    - 93
  +    targets:
  +    - elementProto:
  +        view:
  +          tableId: 120
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 120
  +          name: v3
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 120
  +          owner: root
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 120
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 120
  +          username: public
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 120
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 120
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 120
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
     formatVersion: 3
     id: 120
  ...
     replacementOf:
       time: {}
  +  state: DROP
     unexposedParentSchemaId: 113
  -  version: "1"
  +  version: "2"
     viewQuery: (SELECT name, n1 FROM db1.sc1.v1, db1.sc1.v2)
upsert descriptor #121
  ...
     createAsOfTime:
       wallTime: "1"
  -  dependedOnBy:
  -  - columnIds:
  -    - 1
  -    - 2
  -    id: 124
  -  dependsOn:
  -  - 119
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 94
  +    - 95
  +    - 96
  +    - 97
  +    - 98
  +    - 99
  +    - 100
  +    - 101
  +    - 102
  +    targets:
  +    - elementProto:
  +        view:
  +          tableId: 121
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 121
  +          name: v4
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 121
  +          owner: root
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 121
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 121
  +          username: public
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 121
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 121
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 121
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        relationDependedOnBy:
  +          columnId: 1
  +          dependedOn: 124
  +          tableId: 121
  +      metadata:
  +        sourceElementId: 10
  +        subWorkId: 1
  +      targetStatus: ABSENT
     formatVersion: 3
     id: 121
  ...
     replacementOf:
       time: {}
  +  state: DROP
     unexposedParentSchemaId: 113
  -  version: "2"
  +  version: "3"
     viewQuery: (SELECT n2, n1 FROM db1.sc1.v2)
upsert descriptor #122
   type:
     arrayTypeId: 123
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 113
  +    - 114
  +    targets:
  +    - elementProto:
  +        type:
  +          typeId: 122
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 122
  +          name: typ
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 1
  +      targetStatus: ABSENT
     enumMembers:
     - logicalRepresentation: a
  ...
         withGrantOption: 2
       version: 2
  -  referencingDescriptorIds:
  -  - 124
  -  version: "2"
  +  referencingDescriptorIds: []
  +  state: DROP
  +  version: "3"
upsert descriptor #123
  ...
       family: ArrayFamily
       oid: 100123
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 115
  +    - 116
  +    targets:
  +    - elementProto:
  +        type:
  +          typeId: 123
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 2
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 123
  +          name: _typ
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 6
  +        subWorkId: 2
  +      targetStatus: ABSENT
     id: 123
     kind: ALIAS
  ...
         withGrantOption: 2
       version: 2
  -  referencingDescriptorIds:
  -  - 124
  -  version: "2"
  +  referencingDescriptorIds: []
  +  state: DROP
  +  version: "3"
upsert descriptor #124
  ...
     createAsOfTime:
       wallTime: "1"
  -  dependsOn:
  -  - 121
  +  declarativeSchemaChangerState:
  +    authorization: {}
  +    currentStatuses:
  +    - DROPPED
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    - ABSENT
  +    jobId: "1"
  +    relevantStatements:
  +    - statement:
  +        redactedStatement: DROP DATABASE ‹db1› CASCADE
  +        statement: DROP DATABASE db1 CASCADE
  +        statementTag: DROP DATABASE
  +    targetRanks:
  +    - 103
  +    - 104
  +    - 105
  +    - 106
  +    - 107
  +    - 108
  +    - 109
  +    - 110
  +    - 111
  +    - 112
  +    targets:
  +    - elementProto:
  +        view:
  +          tableId: 124
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        namespace:
  +          databaseId: 111
  +          descriptorId: 124
  +          name: v5
  +          schemaId: 113
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        owner:
  +          descriptorId: 124
  +          owner: root
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 124
  +          privileges: 2
  +          username: admin
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 124
  +          username: public
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        userPrivileges:
  +          descriptorId: 124
  +          privileges: 2
  +          username: root
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        tableComment:
  +          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  +            when doing decomposition
  +          tableId: 124
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        viewDependsOnType:
  +          tableId: 124
  +          typeId: 122
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        viewDependsOnType:
  +          tableId: 124
  +          typeId: 123
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
  +    - elementProto:
  +        locality:
  +          descriptorId: 124
  +      metadata:
  +        sourceElementId: 12
  +        subWorkId: 1
  +      targetStatus: ABSENT
     dependsOnTypes:
     - 122
  ...
     replacementOf:
       time: {}
  +  state: DROP
     unexposedParentSchemaId: 113
  -  version: "1"
  +  version: "2"
     viewQuery: (SELECT 'a':::sc1.typ::STRING AS k, n2, n1 FROM db1.sc1.v4)
# end PreCommitPhase
commit transaction #1
# begin PostCommitPhase
begin transaction #2
commit transaction #2
begin transaction #3
## PostCommitNonRevertiblePhase stage 1 of 1 with 46 MutationType ops
create job #2: "GC for dropping descriptors 114 117 115 116 118 119 120 121 124 and parent database 111"
  descriptor IDs: [114 117 115 116 118 119 120 121 124]
write *eventpb.DropDatabase to event log for descriptor #111: DROP DATABASE ‹db1› CASCADE
write *eventpb.DropType to event log for descriptor #123: DROP DATABASE ‹db1› CASCADE
update progress of schema change job #1
set schema change job #1 to non-cancellable
delete database namespace entry {0 0 db1} -> 111
delete schema namespace entry {111 0 public} -> 112
delete schema namespace entry {111 0 sc1} -> 113
upsert descriptor #111
   database:
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - ABSENT
  -    - ABSENT
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 32
  -    - 118
  -    - 120
  -    - 121
  -    - 122
  -    targets:
  -    - elementProto:
  -        schemaEntry:
  -          databaseId: 111
  -          schemaId: 112
  -      metadata:
  -        sourceElementId: 2
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        schemaEntry:
  -          databaseId: 111
  -          schemaId: 113
  -      metadata:
  -        sourceElementId: 2
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        database:
  -          databaseId: 111
  -          dependentObjects:
  -          - 112
  -          - 113
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        databaseComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          databaseId: 111
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        databaseRoleSetting:
  -          databaseId: 111
  -          roleName: TODO(fqazi) Roles are not currently fetched from database_role_settings
  -      metadata:
  -        sourceElementId: 1
  -        subWorkId: 1
  -      targetStatus: ABSENT
     id: 111
     modificationTime: {}
  ...
       version: 2
     state: DROP
  -  version: "3"
  +  version: "4"
upsert descriptor #114
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 0
  -    - 1
  -    - 2
  -    - 3
  -    - 4
  -    - 5
  -    - 6
  -    - 7
  -    - 8
  -    targets:
  -    - elementProto:
  -        sequence:
  -          sequenceId: 114
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 111
  -          descriptorId: 114
  -          name: sq1
  -          schemaId: 112
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 114
  -          owner: root
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 114
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 114
  -          username: public
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 114
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 114
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 114
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        relationDependedOnBy:
  -          columnId: 3
  -          dependedOn: 117
  -          tableId: 114
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
     families:
     - columnIds:
  ...
     state: DROP
     unexposedParentSchemaId: 112
  -  version: "3"
  +  version: "4"
upsert descriptor #115
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 34
  -    - 35
  -    - 36
  -    - 37
  -    - 38
  -    - 39
  -    - 40
  -    - 41
  -    - 42
  -    targets:
  -    - elementProto:
  -        sequence:
  -          sequenceId: 115
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 111
  -          descriptorId: 115
  -          name: sq1
  -          schemaId: 113
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 115
  -          owner: root
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 115
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 115
  -          username: public
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 115
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 115
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 115
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        relationDependedOnBy:
  -          columnId: 3
  -          dependedOn: 116
  -          tableId: 115
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
     families:
     - columnIds:
  ...
     state: DROP
     unexposedParentSchemaId: 113
  -  version: "3"
  +  version: "4"
upsert descriptor #116
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - ABSENT
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - DELETE_AND_WRITE_ONLY
  -    - ABSENT
  -    - ABSENT
  -    - DELETE_AND_WRITE_ONLY
  -    - ABSENT
  -    - ABSENT
  -    - DELETE_AND_WRITE_ONLY
  -    - ABSENT
  -    - VALIDATED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 43
  -    - 44
  -    - 45
  -    - 46
  -    - 47
  -    - 48
  -    - 49
  -    - 50
  -    - 51
  -    - 52
  -    - 53
  -    - 54
  -    - 55
  -    - 56
  -    - 57
  -    - 58
  -    - 59
  -    - 60
  -    - 61
  -    - 62
  -    - 63
  -    - 64
  -    - 65
  -    targets:
  -    - elementProto:
  -        defaultExpression:
  -          columnId: 3
  -          defaultExpr: nextval(115:::REGCLASS)
  -          tableId: 116
  -          usesSequenceIds:
  -          - 115
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        table:
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 111
  -          descriptorId: 116
  -          name: t1
  -          schemaId: 113
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 116
  -          owner: root
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 116
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 116
  -          username: public
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 116
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnName:
  -          columnId: 1
  -          name: id
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        column:
  -          columnId: 1
  -          familyName: primary
  -          pgAttributeNum: 1
  -          tableId: 116
  -          type:
  -            family: IntFamily
  -            oid: 20
  -            width: 64
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnComment:
  -          columnId: 1
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnName:
  -          columnId: 2
  -          name: name
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        column:
  -          columnId: 2
  -          familyName: primary
  -          nullable: true
  -          pgAttributeNum: 2
  -          tableId: 116
  -          type:
  -            family: StringFamily
  -            oid: 1043
  -            visibleType: 7
  -            width: 256
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnComment:
  -          columnId: 2
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnName:
  -          columnId: 3
  -          name: val
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        column:
  -          columnId: 3
  -          defaultExpr: nextval(115:::REGCLASS)
  -          familyName: primary
  -          nullable: true
  -          pgAttributeNum: 3
  -          tableId: 116
  -          type:
  -            family: IntFamily
  -            oid: 20
  -            width: 64
  -          usesSequenceIds:
  -          - 115
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnComment:
  -          columnId: 3
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        primaryIndex:
  -          indexId: 1
  -          keyColumnDirections:
  -          - ASC
  -          keyColumnIds:
  -          - 1
  -          shardedDescriptor: {}
  -          sourceIndexId: 1
  -          storingColumnIds:
  -          - 2
  -          - 3
  -          tableId: 116
  -          unique: true
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        indexName:
  -          indexId: 1
  -          name: t1_pkey
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        constraintComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          constraintId: 1
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        indexComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          indexId: 1
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        relationDependedOnBy:
  -          columnId: 2
  -          dependedOn: 118
  -          tableId: 116
  -      metadata:
  -        sourceElementId: 6
  -        subWorkId: 1
  -      targetStatus: ABSENT
     families:
     - columnIds:
  ...
     state: DROP
     unexposedParentSchemaId: 113
  -  version: "3"
  +  version: "4"
upsert descriptor #117
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - ABSENT
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - DELETE_AND_WRITE_ONLY
  -    - ABSENT
  -    - ABSENT
  -    - DELETE_AND_WRITE_ONLY
  -    - ABSENT
  -    - ABSENT
  -    - DELETE_AND_WRITE_ONLY
  -    - ABSENT
  -    - VALIDATED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 9
  -    - 10
  -    - 11
  -    - 12
  -    - 13
  -    - 14
  -    - 15
  -    - 16
  -    - 17
  -    - 18
  -    - 19
  -    - 20
  -    - 21
  -    - 22
  -    - 23
  -    - 24
  -    - 25
  -    - 26
  -    - 27
  -    - 28
  -    - 29
  -    - 30
  -    targets:
  -    - elementProto:
  -        defaultExpression:
  -          columnId: 3
  -          defaultExpr: nextval(114:::REGCLASS)
  -          tableId: 117
  -          usesSequenceIds:
  -          - 114
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        table:
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 111
  -          descriptorId: 117
  -          name: t1
  -          schemaId: 112
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 117
  -          owner: root
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 117
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 117
  -          username: public
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 117
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnName:
  -          columnId: 1
  -          name: id
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        column:
  -          columnId: 1
  -          familyName: primary
  -          pgAttributeNum: 1
  -          tableId: 117
  -          type:
  -            family: IntFamily
  -            oid: 20
  -            width: 64
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnComment:
  -          columnId: 1
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnName:
  -          columnId: 2
  -          name: name
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        column:
  -          columnId: 2
  -          familyName: primary
  -          nullable: true
  -          pgAttributeNum: 2
  -          tableId: 117
  -          type:
  -            family: StringFamily
  -            oid: 1043
  -            visibleType: 7
  -            width: 256
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnComment:
  -          columnId: 2
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnName:
  -          columnId: 3
  -          name: val
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        column:
  -          columnId: 3
  -          defaultExpr: nextval(114:::REGCLASS)
  -          familyName: primary
  -          nullable: true
  -          pgAttributeNum: 3
  -          tableId: 117
  -          type:
  -            family: IntFamily
  -            oid: 20
  -            width: 64
  -          usesSequenceIds:
  -          - 114
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        columnComment:
  -          columnId: 3
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        primaryIndex:
  -          indexId: 1
  -          keyColumnDirections:
  -          - ASC
  -          keyColumnIds:
  -          - 1
  -          shardedDescriptor: {}
  -          sourceIndexId: 1
  -          storingColumnIds:
  -          - 2
  -          - 3
  -          tableId: 117
  -          unique: true
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        indexName:
  -          indexId: 1
  -          name: t1_pkey
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        constraintComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          constraintId: 1
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        indexComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          indexId: 1
  -          tableId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 117
  -      metadata:
  -        sourceElementId: 3
  -        subWorkId: 1
  -      targetStatus: ABSENT
     families:
     - columnIds:
  ...
     state: DROP
     unexposedParentSchemaId: 112
  -  version: "2"
  +  version: "3"
upsert descriptor #118
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 66
  -    - 67
  -    - 68
  -    - 69
  -    - 70
  -    - 71
  -    - 72
  -    - 73
  -    - 74
  -    - 75
  -    targets:
  -    - elementProto:
  -        view:
  -          tableId: 118
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 111
  -          descriptorId: 118
  -          name: v1
  -          schemaId: 113
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 118
  -          owner: root
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 118
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 118
  -          username: public
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 118
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 118
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 118
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        relationDependedOnBy:
  -          columnId: 1
  -          dependedOn: 119
  -          tableId: 118
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        relationDependedOnBy:
  -          columnId: 1
  -          dependedOn: 120
  -          tableId: 118
  -      metadata:
  -        sourceElementId: 8
  -        subWorkId: 1
  -      targetStatus: ABSENT
     formatVersion: 3
     id: 118
  ...
     state: DROP
     unexposedParentSchemaId: 113
  -  version: "4"
  +  version: "5"
     viewQuery: (SELECT name FROM db1.sc1.t1)
upsert descriptor #119
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 76
  -    - 77
  -    - 78
  -    - 79
  -    - 80
  -    - 81
  -    - 82
  -    - 83
  -    - 84
  -    - 85
  -    targets:
  -    - elementProto:
  -        view:
  -          tableId: 119
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 111
  -          descriptorId: 119
  -          name: v2
  -          schemaId: 113
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 119
  -          owner: root
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 119
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 119
  -          username: public
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 119
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 119
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 119
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        relationDependedOnBy:
  -          columnId: 1
  -          dependedOn: 120
  -          tableId: 119
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        relationDependedOnBy:
  -          columnId: 1
  -          dependedOn: 121
  -          tableId: 119
  -      metadata:
  -        sourceElementId: 9
  -        subWorkId: 1
  -      targetStatus: ABSENT
     formatVersion: 3
     id: 119
  ...
     state: DROP
     unexposedParentSchemaId: 113
  -  version: "4"
  +  version: "5"
     viewQuery: (SELECT name AS n1, name AS n2 FROM db1.sc1.v1)
upsert descriptor #120
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 86
  -    - 87
  -    - 88
  -    - 89
  -    - 90
  -    - 91
  -    - 92
  -    - 93
  -    targets:
  -    - elementProto:
  -        view:
  -          tableId: 120
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 111
  -          descriptorId: 120
  -          name: v3
  -          schemaId: 113
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 120
  -          owner: root
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 120
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 120
  -          username: public
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 120
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 120
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 120
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
     formatVersion: 3
     id: 120
  ...
     state: DROP
     unexposedParentSchemaId: 113
  -  version: "2"
  +  version: "3"
     viewQuery: (SELECT name, n1 FROM db1.sc1.v1, db1.sc1.v2)
upsert descriptor #121
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 94
  -    - 95
  -    - 96
  -    - 97
  -    - 98
  -    - 99
  -    - 100
  -    - 101
  -    - 102
  -    targets:
  -    - elementProto:
  -        view:
  -          tableId: 121
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 111
  -          descriptorId: 121
  -          name: v4
  -          schemaId: 113
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 121
  -          owner: root
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 121
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 121
  -          username: public
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 121
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 121
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 121
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        relationDependedOnBy:
  -          columnId: 1
  -          dependedOn: 124
  -          tableId: 121
  -      metadata:
  -        sourceElementId: 10
  -        subWorkId: 1
  -      targetStatus: ABSENT
     formatVersion: 3
     id: 121
  ...
     state: DROP
     unexposedParentSchemaId: 113
  -  version: "3"
  +  version: "4"
     viewQuery: (SELECT n2, n1 FROM db1.sc1.v2)
upsert descriptor #124
  ...
     createAsOfTime:
       wallTime: "1"
  -  declarativeSchemaChangerState:
  -    authorization: {}
  -    currentStatuses:
  -    - DROPPED
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    - ABSENT
  -    jobId: "1"
  -    relevantStatements:
  -    - statement:
  -        redactedStatement: DROP DATABASE ‹db1› CASCADE
  -        statement: DROP DATABASE db1 CASCADE
  -        statementTag: DROP DATABASE
  -    targetRanks:
  -    - 103
  -    - 104
  -    - 105
  -    - 106
  -    - 107
  -    - 108
  -    - 109
  -    - 110
  -    - 111
  -    - 112
  -    targets:
  -    - elementProto:
  -        view:
  -          tableId: 124
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        namespace:
  -          databaseId: 111
  -          descriptorId: 124
  -          name: v5
  -          schemaId: 113
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        owner:
  -          descriptorId: 124
  -          owner: root
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 124
  -          privileges: 2
  -          username: admin
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 124
  -          username: public
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        userPrivileges:
  -          descriptorId: 124
  -          privileges: 2
  -          username: root
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        tableComment:
  -          comment: TODO(fqazi) Comments are not currently fetched from system.comments
  -            when doing decomposition
  -          tableId: 124
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        viewDependsOnType:
  -          tableId: 124
  -          typeId: 122
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        viewDependsOnType:
  -          tableId: 124
  -          typeId: 123
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
  -    - elementProto:
  -        locality:
  -          descriptorId: 124
  -      metadata:
  -        sourceElementId: 12
  -        subWorkId: 1
  -      targetStatus: ABSENT
     dependsOnTypes:
     - 122
  ...
     state: DROP
     unexposedParentSchemaId: 113
  -  version: "2"
  +  version: "3"
     viewQuery: (SELECT 'a':::sc1.typ::STRING AS k, n2, n1 FROM db1.sc1.v4)
delete descriptor #112
delete descriptor #113
delete descriptor #122
delete descriptor #123
commit transaction #3
# end PostCommitPhase
