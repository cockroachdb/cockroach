/* setup */
CREATE TABLE t(
  a INT PRIMARY KEY,
  b INT,
  C INT,
  INDEX t_idx_b(b),
  INDEX t_idx_c(c)
);
CREATE SEQUENCE sq1;
CREATE VIEW v AS SELECT a FROM t;
CREATE TYPE notmyworkday AS ENUM ('Monday', 'Tuesday');
CREATE FUNCTION f(a notmyworkday) RETURNS INT VOLATILE LANGUAGE SQL AS $$
  SELECT a FROM t;
  SELECT b FROM t@t_idx_b;
  SELECT c FROM t@t_idx_c;
  SELECT a FROM v;
  SELECT nextval('sq1');
$$;
CREATE TABLE t2(a notmyworkday);

/* test */
EXPLAIN (DDL) DROP FUNCTION f;
----
Schema change plan for DROP FUNCTION ‹""›.‹""›.‹f›;
 ├── StatementPhase
 │    └── Stage 1 of 1 in StatementPhase
 │         ├── 11 elements transitioning toward ABSENT
 │         │    ├── PUBLIC → ABSENT  Owner:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  UserPrivileges:{DescID: 10005 (f-), Name: "admin"}
 │         │    ├── PUBLIC → ABSENT  UserPrivileges:{DescID: 10005 (f-), Name: "public"}
 │         │    ├── PUBLIC → ABSENT  UserPrivileges:{DescID: 10005 (f-), Name: "root"}
 │         │    ├── PUBLIC → DROPPED Function:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  SchemaChild:{DescID: 10005 (f-), ReferencedDescID: 101 (public)}
 │         │    ├── PUBLIC → ABSENT  FunctionName:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  FunctionVolatility:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  FunctionLeakProof:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  FunctionNullInputBehavior:{DescID: 10005 (f-)}
 │         │    └── PUBLIC → ABSENT  FunctionBody:{DescID: 10005 (f-)}
 │         └── 12 Mutation operations
 │              ├── MarkDescriptorAsDropped {"DescriptorID":10005}
 │              ├── RemoveObjectParent {"ObjectID":10005,"ParentSchemaID":101}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.FunctionNam..."}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.FunctionVol..."}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.FunctionLea..."}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.FunctionNul..."}
 │              ├── RemoveBackReferenceInTypes {"BackReferencedDescriptorID":10005}
 │              ├── RemoveBackReferencesInRelations {"BackReferencedID":10005}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.Owner"}
 │              ├── RemoveUserPrivileges {"DescriptorID":10005,"User":"admin"}
 │              ├── RemoveUserPrivileges {"DescriptorID":10005,"User":"public"}
 │              └── RemoveUserPrivileges {"DescriptorID":10005,"User":"root"}
 ├── PreCommitPhase
 │    ├── Stage 1 of 2 in PreCommitPhase
 │    │    ├── 11 elements transitioning toward ABSENT
 │    │    │    ├── ABSENT  → PUBLIC Owner:{DescID: 10005 (f-)}
 │    │    │    ├── ABSENT  → PUBLIC UserPrivileges:{DescID: 10005 (f-), Name: "admin"}
 │    │    │    ├── ABSENT  → PUBLIC UserPrivileges:{DescID: 10005 (f-), Name: "public"}
 │    │    │    ├── ABSENT  → PUBLIC UserPrivileges:{DescID: 10005 (f-), Name: "root"}
 │    │    │    ├── DROPPED → PUBLIC Function:{DescID: 10005 (f-)}
 │    │    │    ├── ABSENT  → PUBLIC SchemaChild:{DescID: 10005 (f-), ReferencedDescID: 101 (public)}
 │    │    │    ├── ABSENT  → PUBLIC FunctionName:{DescID: 10005 (f-)}
 │    │    │    ├── ABSENT  → PUBLIC FunctionVolatility:{DescID: 10005 (f-)}
 │    │    │    ├── ABSENT  → PUBLIC FunctionLeakProof:{DescID: 10005 (f-)}
 │    │    │    ├── ABSENT  → PUBLIC FunctionNullInputBehavior:{DescID: 10005 (f-)}
 │    │    │    └── ABSENT  → PUBLIC FunctionBody:{DescID: 10005 (f-)}
 │    │    └── 1 Mutation operation
 │    │         └── UndoAllInTxnImmediateMutationOpSideEffects
 │    └── Stage 2 of 2 in PreCommitPhase
 │         ├── 11 elements transitioning toward ABSENT
 │         │    ├── PUBLIC → ABSENT  Owner:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  UserPrivileges:{DescID: 10005 (f-), Name: "admin"}
 │         │    ├── PUBLIC → ABSENT  UserPrivileges:{DescID: 10005 (f-), Name: "public"}
 │         │    ├── PUBLIC → ABSENT  UserPrivileges:{DescID: 10005 (f-), Name: "root"}
 │         │    ├── PUBLIC → DROPPED Function:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  SchemaChild:{DescID: 10005 (f-), ReferencedDescID: 101 (public)}
 │         │    ├── PUBLIC → ABSENT  FunctionName:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  FunctionVolatility:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  FunctionLeakProof:{DescID: 10005 (f-)}
 │         │    ├── PUBLIC → ABSENT  FunctionNullInputBehavior:{DescID: 10005 (f-)}
 │         │    └── PUBLIC → ABSENT  FunctionBody:{DescID: 10005 (f-)}
 │         └── 19 Mutation operations
 │              ├── MarkDescriptorAsDropped {"DescriptorID":10005}
 │              ├── RemoveObjectParent {"ObjectID":10005,"ParentSchemaID":101}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.FunctionNam..."}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.FunctionVol..."}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.FunctionLea..."}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.FunctionNul..."}
 │              ├── RemoveBackReferenceInTypes {"BackReferencedDescriptorID":10005}
 │              ├── RemoveBackReferencesInRelations {"BackReferencedID":10005}
 │              ├── NotImplementedForPublicObjects {"DescID":10005,"ElementType":"scpb.Owner"}
 │              ├── RemoveUserPrivileges {"DescriptorID":10005,"User":"admin"}
 │              ├── RemoveUserPrivileges {"DescriptorID":10005,"User":"public"}
 │              ├── RemoveUserPrivileges {"DescriptorID":10005,"User":"root"}
 │              ├── SetJobStateOnDescriptor {"DescriptorID":10000,"Initialize":true}
 │              ├── SetJobStateOnDescriptor {"DescriptorID":10001,"Initialize":true}
 │              ├── SetJobStateOnDescriptor {"DescriptorID":10002,"Initialize":true}
 │              ├── SetJobStateOnDescriptor {"DescriptorID":10003,"Initialize":true}
 │              ├── SetJobStateOnDescriptor {"DescriptorID":10004,"Initialize":true}
 │              ├── SetJobStateOnDescriptor {"DescriptorID":10005,"Initialize":true}
 │              └── CreateSchemaChangerJob {"NonCancelable":true,"RunningStatus":"PostCommitNonRev..."}
 └── PostCommitNonRevertiblePhase
      └── Stage 1 of 1 in PostCommitNonRevertiblePhase
           ├── 1 element transitioning toward ABSENT
           │    └── DROPPED → ABSENT Function:{DescID: 10005 (f-)}
           └── 8 Mutation operations
                ├── DeleteDescriptor {"DescriptorID":10005}
                ├── RemoveJobStateFromDescriptor {"DescriptorID":10000}
                ├── RemoveJobStateFromDescriptor {"DescriptorID":10001}
                ├── RemoveJobStateFromDescriptor {"DescriptorID":10002}
                ├── RemoveJobStateFromDescriptor {"DescriptorID":10003}
                ├── RemoveJobStateFromDescriptor {"DescriptorID":10004}
                ├── RemoveJobStateFromDescriptor {"DescriptorID":10005}
                └── UpdateSchemaChangerJob {"IsNonCancelable":true,"RunningStatus":"all stages compl..."}
