setup
SET serial_normalization = sql_sequence;
CREATE TABLE defaultdb.t (
    i INT8 PRIMARY KEY,
    j INT8 DEFAULT 42 NOT NULL,
    k INT8 NOT NULL,
    l SERIAL,
    INDEX (j),
    INDEX (j, k)
);
----

build
ALTER TABLE defaultdb.t DROP COLUMN j
----
- [[Column:{DescID: 104, ColumnID: 2}, ABSENT], PUBLIC]
  details:
    columnId: 2
    pgAttributeNum: 2
    tableId: 104
- [[ColumnDefaultExpression:{DescID: 104, ColumnID: 2}, ABSENT], PUBLIC]
  details:
    columnId: 2
    embeddedExpr:
      expr: 42:::INT8
    tableId: 104
- [[ColumnName:{DescID: 104, Name: j, ColumnID: 2}, ABSENT], PUBLIC]
  details:
    columnId: 2
    name: j
    tableId: 104
- [[ColumnType:{DescID: 104, ColumnFamilyID: 0, ColumnID: 2}, ABSENT], PUBLIC]
  details:
    columnId: 2
    embeddedTypeT:
      type:
        family: IntFamily
        oid: 20
        width: 64
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 1
    indexId: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 2}, ABSENT], PUBLIC]
  details:
    columnId: 1
    indexId: 2
    kind: KEY_SUFFIX
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 3}, ABSENT], PUBLIC]
  details:
    columnId: 1
    indexId: 3
    kind: KEY_SUFFIX
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 4}, PUBLIC], ABSENT]
  details:
    columnId: 1
    indexId: 4
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 5}, PUBLIC], ABSENT]
  details:
    columnId: 1
    indexId: 5
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 2
    indexId: 1
    kind: STORED
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 2}, ABSENT], PUBLIC]
  details:
    columnId: 2
    indexId: 2
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 3}, ABSENT], PUBLIC]
  details:
    columnId: 2
    indexId: 3
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 3, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 3
    indexId: 1
    kind: STORED
    ordinalInKind: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 3, IndexID: 3}, ABSENT], PUBLIC]
  details:
    columnId: 3
    indexId: 3
    ordinalInKind: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 3, IndexID: 4}, PUBLIC], ABSENT]
  details:
    columnId: 3
    indexId: 4
    kind: STORED
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 3, IndexID: 5}, PUBLIC], ABSENT]
  details:
    columnId: 3
    indexId: 5
    kind: STORED
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 4, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 4
    indexId: 1
    kind: STORED
    ordinalInKind: 2
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 4, IndexID: 4}, PUBLIC], ABSENT]
  details:
    columnId: 4
    indexId: 4
    kind: STORED
    ordinalInKind: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 4, IndexID: 5}, PUBLIC], ABSENT]
  details:
    columnId: 4
    indexId: 5
    kind: STORED
    ordinalInKind: 1
    tableId: 104
- [[IndexName:{DescID: 104, Name: t_j_idx, IndexID: 2}, ABSENT], PUBLIC]
  details:
    indexId: 2
    name: t_j_idx
    tableId: 104
- [[IndexName:{DescID: 104, Name: t_j_k_idx, IndexID: 3}, ABSENT], PUBLIC]
  details:
    indexId: 3
    name: t_j_k_idx
    tableId: 104
- [[IndexName:{DescID: 104, Name: t_pkey, IndexID: 1}, ABSENT], PUBLIC]
  details:
    indexId: 1
    name: t_pkey
    tableId: 104
- [[IndexName:{DescID: 104, Name: t_pkey, IndexID: 4}, PUBLIC], ABSENT]
  details:
    indexId: 4
    name: t_pkey
    tableId: 104
- [[PrimaryIndex:{DescID: 104, IndexID: 1, ConstraintID: 1}, ABSENT], PUBLIC]
  details:
    embeddedIndex:
      constraintId: 1
      indexId: 1
      isUnique: true
      tableId: 104
- [[PrimaryIndex:{DescID: 104, IndexID: 4, ConstraintID: 1, TemporaryIndexID: 5, SourceIndexID: 1}, PUBLIC], ABSENT]
  details:
    embeddedIndex:
      constraintId: 1
      indexId: 4
      isUnique: true
      sourceIndexId: 1
      tableId: 104
      temporaryIndexId: 5
- [[SecondaryIndex:{DescID: 104, IndexID: 2, ConstraintID: 0}, ABSENT], PUBLIC]
  details:
    embeddedIndex:
      indexId: 2
      tableId: 104
- [[SecondaryIndex:{DescID: 104, IndexID: 3, ConstraintID: 0}, ABSENT], PUBLIC]
  details:
    embeddedIndex:
      indexId: 3
      tableId: 104
- [[TemporaryIndex:{DescID: 104, IndexID: 5, SourceIndexID: 1}, TRANSIENT_ABSENT], ABSENT]
  details:
    embeddedIndex:
      constraintId: 1
      indexId: 5
      isUnique: true
      sourceIndexId: 1
      tableId: 104

build
ALTER TABLE defaultdb.t DROP COLUMN k
----
- [[Column:{DescID: 104, ColumnID: 3}, ABSENT], PUBLIC]
  details:
    columnId: 3
    pgAttributeNum: 3
    tableId: 104
- [[ColumnName:{DescID: 104, Name: k, ColumnID: 3}, ABSENT], PUBLIC]
  details:
    columnId: 3
    name: k
    tableId: 104
- [[ColumnType:{DescID: 104, ColumnFamilyID: 0, ColumnID: 3}, ABSENT], PUBLIC]
  details:
    columnId: 3
    embeddedTypeT:
      type:
        family: IntFamily
        oid: 20
        width: 64
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 1
    indexId: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 3}, ABSENT], PUBLIC]
  details:
    columnId: 1
    indexId: 3
    kind: KEY_SUFFIX
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 4}, PUBLIC], ABSENT]
  details:
    columnId: 1
    indexId: 4
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 5}, PUBLIC], ABSENT]
  details:
    columnId: 1
    indexId: 5
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 2
    indexId: 1
    kind: STORED
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 3}, ABSENT], PUBLIC]
  details:
    columnId: 2
    indexId: 3
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 4}, PUBLIC], ABSENT]
  details:
    columnId: 2
    indexId: 4
    kind: STORED
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 5}, PUBLIC], ABSENT]
  details:
    columnId: 2
    indexId: 5
    kind: STORED
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 3, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 3
    indexId: 1
    kind: STORED
    ordinalInKind: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 3, IndexID: 3}, ABSENT], PUBLIC]
  details:
    columnId: 3
    indexId: 3
    ordinalInKind: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 4, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 4
    indexId: 1
    kind: STORED
    ordinalInKind: 2
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 4, IndexID: 4}, PUBLIC], ABSENT]
  details:
    columnId: 4
    indexId: 4
    kind: STORED
    ordinalInKind: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 4, IndexID: 5}, PUBLIC], ABSENT]
  details:
    columnId: 4
    indexId: 5
    kind: STORED
    ordinalInKind: 1
    tableId: 104
- [[IndexName:{DescID: 104, Name: t_j_k_idx, IndexID: 3}, ABSENT], PUBLIC]
  details:
    indexId: 3
    name: t_j_k_idx
    tableId: 104
- [[IndexName:{DescID: 104, Name: t_pkey, IndexID: 1}, ABSENT], PUBLIC]
  details:
    indexId: 1
    name: t_pkey
    tableId: 104
- [[IndexName:{DescID: 104, Name: t_pkey, IndexID: 4}, PUBLIC], ABSENT]
  details:
    indexId: 4
    name: t_pkey
    tableId: 104
- [[PrimaryIndex:{DescID: 104, IndexID: 1, ConstraintID: 1}, ABSENT], PUBLIC]
  details:
    embeddedIndex:
      constraintId: 1
      indexId: 1
      isUnique: true
      tableId: 104
- [[PrimaryIndex:{DescID: 104, IndexID: 4, ConstraintID: 1, TemporaryIndexID: 5, SourceIndexID: 1}, PUBLIC], ABSENT]
  details:
    embeddedIndex:
      constraintId: 1
      indexId: 4
      isUnique: true
      sourceIndexId: 1
      tableId: 104
      temporaryIndexId: 5
- [[SecondaryIndex:{DescID: 104, IndexID: 3, ConstraintID: 0}, ABSENT], PUBLIC]
  details:
    embeddedIndex:
      indexId: 3
      tableId: 104
- [[TemporaryIndex:{DescID: 104, IndexID: 5, SourceIndexID: 1}, TRANSIENT_ABSENT], ABSENT]
  details:
    embeddedIndex:
      constraintId: 1
      indexId: 5
      isUnique: true
      sourceIndexId: 1
      tableId: 104

build
ALTER TABLE defaultdb.t DROP COLUMN l
----
- [[Column:{DescID: 104, ColumnID: 4}, ABSENT], PUBLIC]
  details:
    columnId: 4
    pgAttributeNum: 4
    tableId: 104
- [[ColumnDefaultExpression:{DescID: 104, ColumnID: 4}, ABSENT], PUBLIC]
  details:
    columnId: 4
    embeddedExpr:
      expr: nextval(105:::REGCLASS)
      usesSequenceIds:
      - 105
    tableId: 104
- [[ColumnName:{DescID: 104, Name: l, ColumnID: 4}, ABSENT], PUBLIC]
  details:
    columnId: 4
    name: l
    tableId: 104
- [[ColumnType:{DescID: 104, ColumnFamilyID: 0, ColumnID: 4}, ABSENT], PUBLIC]
  details:
    columnId: 4
    embeddedTypeT:
      type:
        family: IntFamily
        oid: 20
        width: 64
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 1
    indexId: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 4}, PUBLIC], ABSENT]
  details:
    columnId: 1
    indexId: 4
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 1, IndexID: 5}, PUBLIC], ABSENT]
  details:
    columnId: 1
    indexId: 5
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 2
    indexId: 1
    kind: STORED
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 4}, PUBLIC], ABSENT]
  details:
    columnId: 2
    indexId: 4
    kind: STORED
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 2, IndexID: 5}, PUBLIC], ABSENT]
  details:
    columnId: 2
    indexId: 5
    kind: STORED
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 3, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 3
    indexId: 1
    kind: STORED
    ordinalInKind: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 3, IndexID: 4}, PUBLIC], ABSENT]
  details:
    columnId: 3
    indexId: 4
    kind: STORED
    ordinalInKind: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 3, IndexID: 5}, PUBLIC], ABSENT]
  details:
    columnId: 3
    indexId: 5
    kind: STORED
    ordinalInKind: 1
    tableId: 104
- [[IndexColumn:{DescID: 104, ColumnID: 4, IndexID: 1}, ABSENT], PUBLIC]
  details:
    columnId: 4
    indexId: 1
    kind: STORED
    ordinalInKind: 2
    tableId: 104
- [[IndexName:{DescID: 104, Name: t_pkey, IndexID: 1}, ABSENT], PUBLIC]
  details:
    indexId: 1
    name: t_pkey
    tableId: 104
- [[IndexName:{DescID: 104, Name: t_pkey, IndexID: 4}, PUBLIC], ABSENT]
  details:
    indexId: 4
    name: t_pkey
    tableId: 104
- [[Namespace:{DescID: 105, Name: t_l_seq, ReferencedDescID: 100}, ABSENT], PUBLIC]
  details:
    databaseId: 100
    descriptorId: 105
    name: t_l_seq
    schemaId: 101
- [[ObjectParent:{DescID: 105, ReferencedDescID: 101}, ABSENT], PUBLIC]
  details:
    objectId: 105
    parentSchemaId: 101
- [[Owner:{DescID: 105}, ABSENT], PUBLIC]
  details:
    descriptorId: 105
    owner: root
- [[PrimaryIndex:{DescID: 104, IndexID: 1, ConstraintID: 1}, ABSENT], PUBLIC]
  details:
    embeddedIndex:
      constraintId: 1
      indexId: 1
      isUnique: true
      tableId: 104
- [[PrimaryIndex:{DescID: 104, IndexID: 4, ConstraintID: 1, TemporaryIndexID: 5, SourceIndexID: 1}, PUBLIC], ABSENT]
  details:
    embeddedIndex:
      constraintId: 1
      indexId: 4
      isUnique: true
      sourceIndexId: 1
      tableId: 104
      temporaryIndexId: 5
- [[Sequence:{DescID: 105}, ABSENT], PUBLIC]
  details:
    sequenceId: 105
- [[SequenceOwner:{DescID: 104, ColumnID: 4, ReferencedDescID: 105}, ABSENT], PUBLIC]
  details:
    columnId: 4
    sequenceId: 105
    tableId: 104
- [[TemporaryIndex:{DescID: 104, IndexID: 5, SourceIndexID: 1}, TRANSIENT_ABSENT], ABSENT]
  details:
    embeddedIndex:
      constraintId: 1
      indexId: 5
      isUnique: true
      sourceIndexId: 1
      tableId: 104
- [[UserPrivileges:{DescID: 105, Name: admin}, ABSENT], PUBLIC]
  details:
    descriptorId: 105
    privileges: 2
    userName: admin
- [[UserPrivileges:{DescID: 105, Name: root}, ABSENT], PUBLIC]
  details:
    descriptorId: 105
    privileges: 2
    userName: root
