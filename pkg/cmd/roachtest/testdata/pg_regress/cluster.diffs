diff -U3 --label=/mnt/data1/postgres/src/test/regress/expected/cluster.out --label=/mnt/data1/postgres/src/test/regress/results/cluster.out /mnt/data1/postgres/src/test/regress/expected/cluster.out /mnt/data1/postgres/src/test/regress/results/cluster.out
--- /mnt/data1/postgres/src/test/regress/expected/cluster.out
+++ /mnt/data1/postgres/src/test/regress/results/cluster.out
@@ -3,11 +3,13 @@
 --
 CREATE TABLE clstr_tst_s (rf_a SERIAL PRIMARY KEY,
 	b INT);
+NOTICE:  using sequential values in a primary key does not perform as well as using random UUIDs. See https://www.cockroachlabs.com/docs/_version_/serial.html
 CREATE TABLE clstr_tst (a SERIAL PRIMARY KEY,
 	b INT,
 	c TEXT,
 	d TEXT,
 	CONSTRAINT clstr_tst_con FOREIGN KEY (b) REFERENCES clstr_tst_s);
+NOTICE:  using sequential values in a primary key does not perform as well as using random UUIDs. See https://www.cockroachlabs.com/docs/_version_/serial.html
 CREATE INDEX clstr_tst_b ON clstr_tst (b);
 CREATE INDEX clstr_tst_c ON clstr_tst (c);
 CREATE INDEX clstr_tst_c_b ON clstr_tst (c,b);
@@ -19,231 +21,145 @@
 INSERT INTO clstr_tst_s (b) SELECT b FROM clstr_tst_s;
 INSERT INTO clstr_tst_s (b) SELECT b FROM clstr_tst_s;
 CREATE TABLE clstr_tst_inh () INHERITS (clstr_tst);
+ERROR:  at or near "(": syntax error: unimplemented: this syntax
+DETAIL:  source SQL:
+CREATE TABLE clstr_tst_inh () INHERITS (clstr_tst)
+                                       ^
+HINT:  You have attempted to use a feature that is not yet implemented.
+See: https://go.crdb.dev/issue-v/22456/_version_
 INSERT INTO clstr_tst (b, c) VALUES (11, 'once');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(11) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (10, 'diez');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(10) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (31, 'treinta y uno');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(31) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (22, 'veintidos');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(22) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (3, 'tres');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(3) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (20, 'veinte');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(20) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (23, 'veintitres');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(23) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (21, 'veintiuno');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(21) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (4, 'cuatro');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(4) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (14, 'catorce');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(14) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (2, 'dos');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(2) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (18, 'dieciocho');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(18) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (27, 'veintisiete');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(27) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (25, 'veinticinco');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(25) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (13, 'trece');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(13) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (28, 'veintiocho');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(28) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (32, 'treinta y dos');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(32) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (5, 'cinco');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(5) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (29, 'veintinueve');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(29) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (1, 'uno');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(1) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (24, 'veinticuatro');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(24) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (30, 'treinta');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(30) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (12, 'doce');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(12) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (17, 'diecisiete');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(17) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (9, 'nueve');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(9) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (19, 'diecinueve');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(19) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (26, 'veintiseis');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(26) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (15, 'quince');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(15) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (7, 'siete');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(7) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (16, 'dieciseis');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(16) is not present in table "clstr_tst_s".
 INSERT INTO clstr_tst (b, c) VALUES (8, 'ocho');
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(8) is not present in table "clstr_tst_s".
 -- This entry is needed to test that TOASTED values are copied correctly.
 INSERT INTO clstr_tst (b, c, d) VALUES (6, 'seis', repeat('xyzzy', 100000));
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+DETAIL:  Key (b)=(6) is not present in table "clstr_tst_s".
 CLUSTER clstr_tst_c ON clstr_tst;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstr_tst_c ON clstr_tst
+^
 SELECT a,b,c,substring(d for 30), length(d) from clstr_tst;
- a  | b  |       c       |           substring            | length 
-----+----+---------------+--------------------------------+--------
- 10 | 14 | catorce       |                                |       
- 18 |  5 | cinco         |                                |       
-  9 |  4 | cuatro        |                                |       
- 26 | 19 | diecinueve    |                                |       
- 12 | 18 | dieciocho     |                                |       
- 30 | 16 | dieciseis     |                                |       
- 24 | 17 | diecisiete    |                                |       
-  2 | 10 | diez          |                                |       
- 23 | 12 | doce          |                                |       
- 11 |  2 | dos           |                                |       
- 25 |  9 | nueve         |                                |       
- 31 |  8 | ocho          |                                |       
-  1 | 11 | once          |                                |       
- 28 | 15 | quince        |                                |       
- 32 |  6 | seis          | xyzzyxyzzyxyzzyxyzzyxyzzyxyzzy | 500000
- 29 |  7 | siete         |                                |       
- 15 | 13 | trece         |                                |       
- 22 | 30 | treinta       |                                |       
- 17 | 32 | treinta y dos |                                |       
-  3 | 31 | treinta y uno |                                |       
-  5 |  3 | tres          |                                |       
- 20 |  1 | uno           |                                |       
-  6 | 20 | veinte        |                                |       
- 14 | 25 | veinticinco   |                                |       
- 21 | 24 | veinticuatro  |                                |       
-  4 | 22 | veintidos     |                                |       
- 19 | 29 | veintinueve   |                                |       
- 16 | 28 | veintiocho    |                                |       
- 27 | 26 | veintiseis    |                                |       
- 13 | 27 | veintisiete   |                                |       
-  7 | 23 | veintitres    |                                |       
-  8 | 21 | veintiuno     |                                |       
-(32 rows)
+ a | b | c | substring | length 
+---+---+---+-----------+--------
+(0 rows)
 
 SELECT a,b,c,substring(d for 30), length(d) from clstr_tst ORDER BY a;
- a  | b  |       c       |           substring            | length 
-----+----+---------------+--------------------------------+--------
-  1 | 11 | once          |                                |       
-  2 | 10 | diez          |                                |       
-  3 | 31 | treinta y uno |                                |       
-  4 | 22 | veintidos     |                                |       
-  5 |  3 | tres          |                                |       
-  6 | 20 | veinte        |                                |       
-  7 | 23 | veintitres    |                                |       
-  8 | 21 | veintiuno     |                                |       
-  9 |  4 | cuatro        |                                |       
- 10 | 14 | catorce       |                                |       
- 11 |  2 | dos           |                                |       
- 12 | 18 | dieciocho     |                                |       
- 13 | 27 | veintisiete   |                                |       
- 14 | 25 | veinticinco   |                                |       
- 15 | 13 | trece         |                                |       
- 16 | 28 | veintiocho    |                                |       
- 17 | 32 | treinta y dos |                                |       
- 18 |  5 | cinco         |                                |       
- 19 | 29 | veintinueve   |                                |       
- 20 |  1 | uno           |                                |       
- 21 | 24 | veinticuatro  |                                |       
- 22 | 30 | treinta       |                                |       
- 23 | 12 | doce          |                                |       
- 24 | 17 | diecisiete    |                                |       
- 25 |  9 | nueve         |                                |       
- 26 | 19 | diecinueve    |                                |       
- 27 | 26 | veintiseis    |                                |       
- 28 | 15 | quince        |                                |       
- 29 |  7 | siete         |                                |       
- 30 | 16 | dieciseis     |                                |       
- 31 |  8 | ocho          |                                |       
- 32 |  6 | seis          | xyzzyxyzzyxyzzyxyzzyxyzzyxyzzy | 500000
-(32 rows)
+ a | b | c | substring | length 
+---+---+---+-----------+--------
+(0 rows)
 
 SELECT a,b,c,substring(d for 30), length(d) from clstr_tst ORDER BY b;
- a  | b  |       c       |           substring            | length 
-----+----+---------------+--------------------------------+--------
- 20 |  1 | uno           |                                |       
- 11 |  2 | dos           |                                |       
-  5 |  3 | tres          |                                |       
-  9 |  4 | cuatro        |                                |       
- 18 |  5 | cinco         |                                |       
- 32 |  6 | seis          | xyzzyxyzzyxyzzyxyzzyxyzzyxyzzy | 500000
- 29 |  7 | siete         |                                |       
- 31 |  8 | ocho          |                                |       
- 25 |  9 | nueve         |                                |       
-  2 | 10 | diez          |                                |       
-  1 | 11 | once          |                                |       
- 23 | 12 | doce          |                                |       
- 15 | 13 | trece         |                                |       
- 10 | 14 | catorce       |                                |       
- 28 | 15 | quince        |                                |       
- 30 | 16 | dieciseis     |                                |       
- 24 | 17 | diecisiete    |                                |       
- 12 | 18 | dieciocho     |                                |       
- 26 | 19 | diecinueve    |                                |       
-  6 | 20 | veinte        |                                |       
-  8 | 21 | veintiuno     |                                |       
-  4 | 22 | veintidos     |                                |       
-  7 | 23 | veintitres    |                                |       
- 21 | 24 | veinticuatro  |                                |       
- 14 | 25 | veinticinco   |                                |       
- 27 | 26 | veintiseis    |                                |       
- 13 | 27 | veintisiete   |                                |       
- 16 | 28 | veintiocho    |                                |       
- 19 | 29 | veintinueve   |                                |       
- 22 | 30 | treinta       |                                |       
-  3 | 31 | treinta y uno |                                |       
- 17 | 32 | treinta y dos |                                |       
-(32 rows)
+ a | b | c | substring | length 
+---+---+---+-----------+--------
+(0 rows)
 
 SELECT a,b,c,substring(d for 30), length(d) from clstr_tst ORDER BY c;
- a  | b  |       c       |           substring            | length 
-----+----+---------------+--------------------------------+--------
- 10 | 14 | catorce       |                                |       
- 18 |  5 | cinco         |                                |       
-  9 |  4 | cuatro        |                                |       
- 26 | 19 | diecinueve    |                                |       
- 12 | 18 | dieciocho     |                                |       
- 30 | 16 | dieciseis     |                                |       
- 24 | 17 | diecisiete    |                                |       
-  2 | 10 | diez          |                                |       
- 23 | 12 | doce          |                                |       
- 11 |  2 | dos           |                                |       
- 25 |  9 | nueve         |                                |       
- 31 |  8 | ocho          |                                |       
-  1 | 11 | once          |                                |       
- 28 | 15 | quince        |                                |       
- 32 |  6 | seis          | xyzzyxyzzyxyzzyxyzzyxyzzyxyzzy | 500000
- 29 |  7 | siete         |                                |       
- 15 | 13 | trece         |                                |       
- 22 | 30 | treinta       |                                |       
- 17 | 32 | treinta y dos |                                |       
-  3 | 31 | treinta y uno |                                |       
-  5 |  3 | tres          |                                |       
- 20 |  1 | uno           |                                |       
-  6 | 20 | veinte        |                                |       
- 14 | 25 | veinticinco   |                                |       
- 21 | 24 | veinticuatro  |                                |       
-  4 | 22 | veintidos     |                                |       
- 19 | 29 | veintinueve   |                                |       
- 16 | 28 | veintiocho    |                                |       
- 27 | 26 | veintiseis    |                                |       
- 13 | 27 | veintisiete   |                                |       
-  7 | 23 | veintitres    |                                |       
-  8 | 21 | veintiuno     |                                |       
-(32 rows)
+ a | b | c | substring | length 
+---+---+---+-----------+--------
+(0 rows)
 
 -- Verify that inheritance link still works
 INSERT INTO clstr_tst_inh VALUES (0, 100, 'in child table');
+ERROR:  relation "clstr_tst_inh" does not exist
 SELECT a,b,c,substring(d for 30), length(d) from clstr_tst;
- a  |  b  |       c        |           substring            | length 
-----+-----+----------------+--------------------------------+--------
- 10 |  14 | catorce        |                                |       
- 18 |   5 | cinco          |                                |       
-  9 |   4 | cuatro         |                                |       
- 26 |  19 | diecinueve     |                                |       
- 12 |  18 | dieciocho      |                                |       
- 30 |  16 | dieciseis      |                                |       
- 24 |  17 | diecisiete     |                                |       
-  2 |  10 | diez           |                                |       
- 23 |  12 | doce           |                                |       
- 11 |   2 | dos            |                                |       
- 25 |   9 | nueve          |                                |       
- 31 |   8 | ocho           |                                |       
-  1 |  11 | once           |                                |       
- 28 |  15 | quince         |                                |       
- 32 |   6 | seis           | xyzzyxyzzyxyzzyxyzzyxyzzyxyzzy | 500000
- 29 |   7 | siete          |                                |       
- 15 |  13 | trece          |                                |       
- 22 |  30 | treinta        |                                |       
- 17 |  32 | treinta y dos  |                                |       
-  3 |  31 | treinta y uno  |                                |       
-  5 |   3 | tres           |                                |       
- 20 |   1 | uno            |                                |       
-  6 |  20 | veinte         |                                |       
- 14 |  25 | veinticinco    |                                |       
- 21 |  24 | veinticuatro   |                                |       
-  4 |  22 | veintidos      |                                |       
- 19 |  29 | veintinueve    |                                |       
- 16 |  28 | veintiocho     |                                |       
- 27 |  26 | veintiseis     |                                |       
- 13 |  27 | veintisiete    |                                |       
-  7 |  23 | veintitres     |                                |       
-  8 |  21 | veintiuno      |                                |       
-  0 | 100 | in child table |                                |       
-(33 rows)
+ a | b | c | substring | length 
+---+---+---+-----------+--------
+(0 rows)
 
 -- Verify that foreign key link still works
 INSERT INTO clstr_tst (b, c) VALUES (1111, 'this should fail');
-ERROR:  insert or update on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
+ERROR:  insert on table "clstr_tst" violates foreign key constraint "clstr_tst_con"
 DETAIL:  Key (b)=(1111) is not present in table "clstr_tst_s".
 SELECT conname FROM pg_constraint WHERE conrelid = 'clstr_tst'::regclass
 ORDER BY 1;
@@ -256,20 +172,17 @@
 SELECT relname, relkind,
     EXISTS(SELECT 1 FROM pg_class WHERE oid = c.reltoastrelid) AS hastoast
 FROM pg_class c WHERE relname LIKE 'clstr_tst%' ORDER BY relname;
-       relname        | relkind | hastoast 
-----------------------+---------+----------
- clstr_tst            | r       | t
- clstr_tst_a_seq      | S       | f
- clstr_tst_b          | i       | f
- clstr_tst_b_c        | i       | f
- clstr_tst_c          | i       | f
- clstr_tst_c_b        | i       | f
- clstr_tst_inh        | r       | t
- clstr_tst_pkey       | i       | f
- clstr_tst_s          | r       | f
- clstr_tst_s_pkey     | i       | f
- clstr_tst_s_rf_a_seq | S       | f
-(11 rows)
+     relname      | relkind | hastoast 
+------------------+---------+----------
+ clstr_tst        | r       | f
+ clstr_tst_b      | i       | f
+ clstr_tst_b_c    | i       | f
+ clstr_tst_c      | i       | f
+ clstr_tst_c_b    | i       | f
+ clstr_tst_pkey   | i       | f
+ clstr_tst_s      | r       | f
+ clstr_tst_s_pkey | i       | f
+(8 rows)
 
 -- Verify that indisclustered is correctly set
 SELECT pg_class.relname FROM pg_index, pg_class, pg_class AS pg_class_2
@@ -277,25 +190,33 @@
 	AND indrelid=pg_class_2.oid
 	AND pg_class_2.relname = 'clstr_tst'
 	AND indisclustered;
-   relname   
--------------
- clstr_tst_c
-(1 row)
+ relname 
+---------
+(0 rows)
 
 -- Try changing indisclustered
 ALTER TABLE clstr_tst CLUSTER ON clstr_tst_b_c;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+ALTER TABLE clstr_tst CLUSTER ON clstr_tst_b_c
+                      ^
+HINT:  try \h ALTER TABLE
 SELECT pg_class.relname FROM pg_index, pg_class, pg_class AS pg_class_2
 WHERE pg_class.oid=indexrelid
 	AND indrelid=pg_class_2.oid
 	AND pg_class_2.relname = 'clstr_tst'
 	AND indisclustered;
-    relname    
----------------
- clstr_tst_b_c
-(1 row)
+ relname 
+---------
+(0 rows)
 
 -- Try turning off all clustering
 ALTER TABLE clstr_tst SET WITHOUT CLUSTER;
+ERROR:  at or near "without": syntax error
+DETAIL:  source SQL:
+ALTER TABLE clstr_tst SET WITHOUT CLUSTER
+                          ^
+HINT:  try \h ALTER TABLE
 SELECT pg_class.relname FROM pg_index, pg_class, pg_class AS pg_class_2
 WHERE pg_class.oid=indexrelid
 	AND indrelid=pg_class_2.oid
@@ -307,6 +228,10 @@
 
 -- Verify that toast tables are clusterable
 CLUSTER pg_toast.pg_toast_826 USING pg_toast_826_index;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER pg_toast.pg_toast_826 USING pg_toast_826_index
+^
 -- Verify that clustering all tables does in fact cluster the right ones
 CREATE USER regress_clstr_user;
 CREATE TABLE clstr_1 (a INT PRIMARY KEY);
@@ -323,9 +248,20 @@
 INSERT INTO clstr_3 VALUES (1);
 -- "CLUSTER <tablename>" on a table that hasn't been clustered
 CLUSTER clstr_2;
-ERROR:  there is no previously clustered index for table "clstr_2"
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstr_2
+^
 CLUSTER clstr_1_pkey ON clstr_1;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstr_1_pkey ON clstr_1
+^
 CLUSTER clstr_2 USING clstr_2_pkey;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstr_2 USING clstr_2_pkey
+^
 SELECT * FROM clstr_1 UNION ALL
   SELECT * FROM clstr_2 UNION ALL
   SELECT * FROM clstr_3;
@@ -335,8 +271,8 @@
  2
  1
  2
- 2
  1
+ 2
 (6 rows)
 
 -- revert to the original state
@@ -352,7 +288,17 @@
 -- this user can only cluster clstr_1 and clstr_3, but the latter
 -- has not been clustered
 SET SESSION AUTHORIZATION regress_clstr_user;
+ERROR:  at or near "regress_clstr_user": syntax error: unimplemented: this syntax
+DETAIL:  source SQL:
+SET SESSION AUTHORIZATION regress_clstr_user
+                          ^
+HINT:  You have attempted to use a feature that is not yet implemented.
+See: https://go.crdb.dev/issue-v/40283/_version_
 CLUSTER;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER
+^
 SELECT * FROM clstr_1 UNION ALL
   SELECT * FROM clstr_2 UNION ALL
   SELECT * FROM clstr_3;
@@ -360,10 +306,10 @@
 ---
  1
  2
- 2
  1
  2
  1
+ 2
 (6 rows)
 
 -- cluster a single table using the indisclustered bit previously set
@@ -371,6 +317,10 @@
 INSERT INTO clstr_1 VALUES (2);
 INSERT INTO clstr_1 VALUES (1);
 CLUSTER clstr_1;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstr_1
+^
 SELECT * FROM clstr_1;
  a 
 ---
@@ -401,37 +351,37 @@
 -----
   20
   30
- 100
   35
   80
+ 100
 (5 rows)
 
 CLUSTER clustertest_pkey ON clustertest;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clustertest_pkey ON clustertest
+^
 SELECT * FROM clustertest;
- key 
------
-  20
-  30
-  35
-  80
- 100
-(5 rows)
-
+ERROR:  current transaction is aborted, commands ignored until end of transaction block
 COMMIT;
 SELECT * FROM clustertest;
  key 
 -----
+  10
   20
   30
-  35
-  80
- 100
+  40
+  50
 (5 rows)
 
 -- check that temp tables can be clustered
 create temp table clstr_temp (col1 int primary key, col2 text);
 insert into clstr_temp values (2, 'two'), (1, 'one');
 cluster clstr_temp using clstr_temp_pkey;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+cluster clstr_temp using clstr_temp_pkey
+^
 select * from clstr_temp;
  col1 | col2 
 ------+------
@@ -441,91 +391,215 @@
 
 drop table clstr_temp;
 RESET SESSION AUTHORIZATION;
+ERROR:  at or near "authorization": syntax error
+DETAIL:  source SQL:
+RESET SESSION AUTHORIZATION
+              ^
+HINT:  try \h RESET
 -- check clustering an empty table
 DROP TABLE clustertest;
 CREATE TABLE clustertest (f1 int PRIMARY KEY);
 CLUSTER clustertest USING clustertest_pkey;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clustertest USING clustertest_pkey
+^
 CLUSTER clustertest;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clustertest
+^
 -- Check that partitioned tables can be clustered
 CREATE TABLE clstrpart (a int) PARTITION BY RANGE (a);
+ERROR:  at or near "EOF": syntax error
+DETAIL:  source SQL:
+CREATE TABLE clstrpart (a int) PARTITION BY RANGE (a)
+                                                     ^
+HINT:  try \h CREATE TABLE
 CREATE TABLE clstrpart1 PARTITION OF clstrpart FOR VALUES FROM (1) TO (10) PARTITION BY RANGE (a);
+ERROR:  at or near "partition": syntax error
+DETAIL:  source SQL:
+CREATE TABLE clstrpart1 PARTITION OF clstrpart FOR VALUES FROM (1) TO (10) PARTITION BY RANGE (a)
+                        ^
+HINT:  try \h CREATE TABLE
 CREATE TABLE clstrpart11 PARTITION OF clstrpart1 FOR VALUES FROM (1) TO (5);
+ERROR:  at or near "partition": syntax error
+DETAIL:  source SQL:
+CREATE TABLE clstrpart11 PARTITION OF clstrpart1 FOR VALUES FROM (1) TO (5)
+                         ^
+HINT:  try \h CREATE TABLE
 CREATE TABLE clstrpart12 PARTITION OF clstrpart1 FOR VALUES FROM (5) TO (10) PARTITION BY RANGE (a);
+ERROR:  at or near "partition": syntax error
+DETAIL:  source SQL:
+CREATE TABLE clstrpart12 PARTITION OF clstrpart1 FOR VALUES FROM (5) TO (10) PARTITION BY RANGE (a)
+                         ^
+HINT:  try \h CREATE TABLE
 CREATE TABLE clstrpart2 PARTITION OF clstrpart FOR VALUES FROM (10) TO (20);
+ERROR:  at or near "partition": syntax error
+DETAIL:  source SQL:
+CREATE TABLE clstrpart2 PARTITION OF clstrpart FOR VALUES FROM (10) TO (20)
+                        ^
+HINT:  try \h CREATE TABLE
 CREATE TABLE clstrpart3 PARTITION OF clstrpart DEFAULT PARTITION BY RANGE (a);
+ERROR:  at or near "partition": syntax error
+DETAIL:  source SQL:
+CREATE TABLE clstrpart3 PARTITION OF clstrpart DEFAULT PARTITION BY RANGE (a)
+                        ^
+HINT:  try \h CREATE TABLE
 CREATE TABLE clstrpart33 PARTITION OF clstrpart3 DEFAULT;
+ERROR:  at or near "partition": syntax error
+DETAIL:  source SQL:
+CREATE TABLE clstrpart33 PARTITION OF clstrpart3 DEFAULT
+                         ^
+HINT:  try \h CREATE TABLE
 CREATE INDEX clstrpart_only_idx ON ONLY clstrpart (a);
+ERROR:  at or near "only": syntax error
+DETAIL:  source SQL:
+CREATE INDEX clstrpart_only_idx ON ONLY clstrpart (a)
+                                   ^
+HINT:  try \h CREATE INDEX
 CLUSTER clstrpart USING clstrpart_only_idx; -- fails
-ERROR:  cannot cluster on invalid index "clstrpart_only_idx"
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstrpart USING clstrpart_only_idx
+^
 DROP INDEX clstrpart_only_idx;
+ERROR:  index "clstrpart_only_idx" does not exist
 CREATE INDEX clstrpart_idx ON clstrpart (a);
+ERROR:  relation "clstrpart" does not exist
 -- Check that clustering sets new relfilenodes:
 CREATE TEMP TABLE old_cluster_info AS SELECT relname, level, relfilenode, relkind FROM pg_partition_tree('clstrpart'::regclass) AS tree JOIN pg_class c ON c.oid=tree.relid ;
+ERROR:  unknown function: pg_partition_tree()
 CLUSTER clstrpart USING clstrpart_idx;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstrpart USING clstrpart_idx
+^
 CREATE TEMP TABLE new_cluster_info AS SELECT relname, level, relfilenode, relkind FROM pg_partition_tree('clstrpart'::regclass) AS tree JOIN pg_class c ON c.oid=tree.relid ;
+ERROR:  unknown function: pg_partition_tree()
 SELECT relname, old.level, old.relkind, old.relfilenode = new.relfilenode FROM old_cluster_info AS old JOIN new_cluster_info AS new USING (relname) ORDER BY relname COLLATE "C";
-   relname   | level | relkind | ?column? 
--------------+-------+---------+----------
- clstrpart   |     0 | p       | t
- clstrpart1  |     1 | p       | t
- clstrpart11 |     2 | r       | f
- clstrpart12 |     2 | p       | t
- clstrpart2  |     1 | r       | f
- clstrpart3  |     1 | p       | t
- clstrpart33 |     2 | r       | f
-(7 rows)
-
+ERROR:  relation "old_cluster_info" does not exist
 -- Partitioned indexes aren't and can't be marked un/clustered:
 \d clstrpart
-       Partitioned table "public.clstrpart"
- Column |  Type   | Collation | Nullable | Default 
---------+---------+-----------+----------+---------
- a      | integer |           |          | 
-Partition key: RANGE (a)
-Indexes:
-    "clstrpart_idx" btree (a)
-Number of partitions: 3 (Use \d+ to list them.)
-
+ERROR:  at or near ".": syntax error
+DETAIL:  source SQL:
+SELECT c.oid,
+  n.nspname,
+  c.relname
+FROM pg_catalog.pg_class c
+     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
+WHERE c.relname OPERATOR(pg_catalog.~) '^(clstrpart)$' COLLATE pg_catalog.default
+                                                                         ^
 CLUSTER clstrpart;
-ERROR:  there is no previously clustered index for table "clstrpart"
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstrpart
+^
 ALTER TABLE clstrpart SET WITHOUT CLUSTER;
-ERROR:  cannot mark index clustered in partitioned table
+ERROR:  at or near "without": syntax error
+DETAIL:  source SQL:
+ALTER TABLE clstrpart SET WITHOUT CLUSTER
+                          ^
+HINT:  try \h ALTER TABLE
 ALTER TABLE clstrpart CLUSTER ON clstrpart_idx;
-ERROR:  cannot mark index clustered in partitioned table
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+ALTER TABLE clstrpart CLUSTER ON clstrpart_idx
+                      ^
+HINT:  try \h ALTER TABLE
 DROP TABLE clstrpart;
+ERROR:  relation "clstrpart" does not exist
 -- Ownership of partitions is checked
 CREATE TABLE ptnowner(i int unique) PARTITION BY LIST (i);
+ERROR:  at or near "EOF": syntax error
+DETAIL:  source SQL:
+CREATE TABLE ptnowner(i int unique) PARTITION BY LIST (i)
+                                                         ^
+HINT:  try \h CREATE TABLE
 CREATE INDEX ptnowner_i_idx ON ptnowner(i);
+ERROR:  relation "ptnowner" does not exist
 CREATE TABLE ptnowner1 PARTITION OF ptnowner FOR VALUES IN (1);
+ERROR:  at or near "partition": syntax error
+DETAIL:  source SQL:
+CREATE TABLE ptnowner1 PARTITION OF ptnowner FOR VALUES IN (1)
+                       ^
+HINT:  try \h CREATE TABLE
 CREATE ROLE regress_ptnowner;
 CREATE TABLE ptnowner2 PARTITION OF ptnowner FOR VALUES IN (2);
+ERROR:  at or near "partition": syntax error
+DETAIL:  source SQL:
+CREATE TABLE ptnowner2 PARTITION OF ptnowner FOR VALUES IN (2)
+                       ^
+HINT:  try \h CREATE TABLE
 ALTER TABLE ptnowner1 OWNER TO regress_ptnowner;
+ERROR:  relation "ptnowner1" does not exist
 ALTER TABLE ptnowner OWNER TO regress_ptnowner;
+ERROR:  relation "ptnowner" does not exist
 CREATE TEMP TABLE ptnowner_oldnodes AS
   SELECT oid, relname, relfilenode FROM pg_partition_tree('ptnowner') AS tree
   JOIN pg_class AS c ON c.oid=tree.relid;
+ERROR:  unknown function: pg_partition_tree()
 SET SESSION AUTHORIZATION regress_ptnowner;
+ERROR:  at or near "regress_ptnowner": syntax error: unimplemented: this syntax
+DETAIL:  source SQL:
+SET SESSION AUTHORIZATION regress_ptnowner
+                          ^
+HINT:  You have attempted to use a feature that is not yet implemented.
+See: https://go.crdb.dev/issue-v/40283/_version_
 CLUSTER ptnowner USING ptnowner_i_idx;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER ptnowner USING ptnowner_i_idx
+^
 RESET SESSION AUTHORIZATION;
+ERROR:  at or near "authorization": syntax error
+DETAIL:  source SQL:
+RESET SESSION AUTHORIZATION
+              ^
+HINT:  try \h RESET
 SELECT a.relname, a.relfilenode=b.relfilenode FROM pg_class a
   JOIN ptnowner_oldnodes b USING (oid) ORDER BY a.relname COLLATE "C";
-  relname  | ?column? 
------------+----------
- ptnowner  | t
- ptnowner1 | f
- ptnowner2 | t
-(3 rows)
-
+ERROR:  relation "ptnowner_oldnodes" does not exist
 DROP TABLE ptnowner;
+ERROR:  relation "ptnowner" does not exist
 DROP ROLE regress_ptnowner;
 -- Test CLUSTER with external tuplesorting
 create table clstr_4 as select * from tenk1;
+NOTICE:  CREATE TABLE ... AS does not copy over indexes, default expressions, or constraints; the new table has a hidden rowid primary key column
 create index cluster_sort on clstr_4 (hundred, thousand, tenthous);
 -- ensure we don't use the index in CLUSTER nor the checking SELECTs
 set enable_indexscan = off;
+ERROR:  unimplemented: the configuration setting "enable_indexscan" is not supported
+HINT:  You have attempted to use a feature that is not yet implemented.
+
+Please check the public issue tracker to check whether this problem is
+already tracked. If you cannot find it there, please report the error
+with details by creating a new issue.
+
+If you would rather not post publicly, please contact us directly
+using the support form.
+
+We appreciate your feedback.
+
 -- Use external sort:
 set maintenance_work_mem = '1MB';
+ERROR:  unimplemented: the configuration setting "maintenance_work_mem" is not supported
+HINT:  You have attempted to use a feature that is not yet implemented.
+
+Please check the public issue tracker to check whether this problem is
+already tracked. If you cannot find it there, please report the error
+with details by creating a new issue.
+
+If you would rather not post publicly, please contact us directly
+using the support form.
+
+We appreciate your feedback.
+
 cluster clstr_4 using cluster_sort;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+cluster clstr_4 using cluster_sort
+^
 select * from
 (select hundred, lag(hundred) over () as lhundred,
         thousand, lag(thousand) over () as lthousand,
@@ -536,126 +610,123 @@
 (0 rows)
 
 reset enable_indexscan;
+ERROR:  unimplemented: the configuration setting "enable_indexscan" is not supported
+HINT:  You have attempted to use a feature that is not yet implemented.
+
+Please check the public issue tracker to check whether this problem is
+already tracked. If you cannot find it there, please report the error
+with details by creating a new issue.
+
+If you would rather not post publicly, please contact us directly
+using the support form.
+
+We appreciate your feedback.
+
 reset maintenance_work_mem;
+ERROR:  unimplemented: the configuration setting "maintenance_work_mem" is not supported
+HINT:  You have attempted to use a feature that is not yet implemented.
+
+Please check the public issue tracker to check whether this problem is
+already tracked. If you cannot find it there, please report the error
+with details by creating a new issue.
+
+If you would rather not post publicly, please contact us directly
+using the support form.
+
+We appreciate your feedback.
+
 -- test CLUSTER on expression index
 CREATE TABLE clstr_expression(id serial primary key, a int, b text COLLATE "C");
+ERROR:  at or near ")": syntax error: invalid locale C: language: tag is not well-formed
+DETAIL:  source SQL:
+CREATE TABLE clstr_expression(id serial primary key, a int, b text COLLATE "C")
+                                                                              ^
 INSERT INTO clstr_expression(a, b) SELECT g.i % 42, 'prefix'||g.i FROM generate_series(1, 133) g(i);
+ERROR:  relation "clstr_expression" does not exist
 CREATE INDEX clstr_expression_minus_a ON clstr_expression ((-a), b);
+ERROR:  relation "clstr_expression" does not exist
 CREATE INDEX clstr_expression_upper_b ON clstr_expression ((upper(b)));
+ERROR:  relation "clstr_expression" does not exist
 -- verify indexes work before cluster
 BEGIN;
 SET LOCAL enable_seqscan = false;
+WARNING:  setting session var "enable_seqscan" is a no-op
 EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE upper(b) = 'PREFIX3';
-                          QUERY PLAN                           
----------------------------------------------------------------
- Index Scan using clstr_expression_upper_b on clstr_expression
-   Index Cond: (upper(b) = 'PREFIX3'::text)
-(2 rows)
-
+ERROR:  at or near "off": syntax error
+DETAIL:  source SQL:
+EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE upper(b) = 'PREFIX3'
+               ^
+HINT:  try \h <SELECTCLAUSE>
 SELECT * FROM clstr_expression WHERE upper(b) = 'PREFIX3';
- id | a |    b    
-----+---+---------
-  3 | 3 | prefix3
-(1 row)
-
+ERROR:  current transaction is aborted, commands ignored until end of transaction block
 EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE -a = -3 ORDER BY -a, b;
-                          QUERY PLAN                           
----------------------------------------------------------------
- Index Scan using clstr_expression_minus_a on clstr_expression
-   Index Cond: ((- a) = '-3'::integer)
-(2 rows)
-
+ERROR:  at or near "off": syntax error
+DETAIL:  source SQL:
+EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE -a = -3 ORDER BY -a, b
+               ^
+HINT:  try \h <SELECTCLAUSE>
 SELECT * FROM clstr_expression WHERE -a = -3 ORDER BY -a, b;
- id  | a |     b     
------+---+-----------
- 129 | 3 | prefix129
-   3 | 3 | prefix3
-  45 | 3 | prefix45
-  87 | 3 | prefix87
-(4 rows)
-
+ERROR:  current transaction is aborted, commands ignored until end of transaction block
 COMMIT;
 -- and after clustering on clstr_expression_minus_a
 CLUSTER clstr_expression USING clstr_expression_minus_a;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstr_expression USING clstr_expression_minus_a
+^
 WITH rows AS
   (SELECT ctid, lag(a) OVER (ORDER BY ctid) AS la, a FROM clstr_expression)
 SELECT * FROM rows WHERE la < a;
- ctid | la | a 
-------+----+---
-(0 rows)
-
+ERROR:  relation "clstr_expression" does not exist
 BEGIN;
 SET LOCAL enable_seqscan = false;
+WARNING:  setting session var "enable_seqscan" is a no-op
 EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE upper(b) = 'PREFIX3';
-                          QUERY PLAN                           
----------------------------------------------------------------
- Index Scan using clstr_expression_upper_b on clstr_expression
-   Index Cond: (upper(b) = 'PREFIX3'::text)
-(2 rows)
-
+ERROR:  at or near "off": syntax error
+DETAIL:  source SQL:
+EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE upper(b) = 'PREFIX3'
+               ^
+HINT:  try \h <SELECTCLAUSE>
 SELECT * FROM clstr_expression WHERE upper(b) = 'PREFIX3';
- id | a |    b    
-----+---+---------
-  3 | 3 | prefix3
-(1 row)
-
+ERROR:  current transaction is aborted, commands ignored until end of transaction block
 EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE -a = -3 ORDER BY -a, b;
-                          QUERY PLAN                           
----------------------------------------------------------------
- Index Scan using clstr_expression_minus_a on clstr_expression
-   Index Cond: ((- a) = '-3'::integer)
-(2 rows)
-
+ERROR:  at or near "off": syntax error
+DETAIL:  source SQL:
+EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE -a = -3 ORDER BY -a, b
+               ^
+HINT:  try \h <SELECTCLAUSE>
 SELECT * FROM clstr_expression WHERE -a = -3 ORDER BY -a, b;
- id  | a |     b     
------+---+-----------
- 129 | 3 | prefix129
-   3 | 3 | prefix3
-  45 | 3 | prefix45
-  87 | 3 | prefix87
-(4 rows)
-
+ERROR:  current transaction is aborted, commands ignored until end of transaction block
 COMMIT;
 -- and after clustering on clstr_expression_upper_b
 CLUSTER clstr_expression USING clstr_expression_upper_b;
+ERROR:  at or near "cluster": syntax error
+DETAIL:  source SQL:
+CLUSTER clstr_expression USING clstr_expression_upper_b
+^
 WITH rows AS
   (SELECT ctid, lag(b) OVER (ORDER BY ctid) AS lb, b FROM clstr_expression)
 SELECT * FROM rows WHERE upper(lb) > upper(b);
- ctid | lb | b 
-------+----+---
-(0 rows)
-
+ERROR:  relation "clstr_expression" does not exist
 BEGIN;
 SET LOCAL enable_seqscan = false;
+WARNING:  setting session var "enable_seqscan" is a no-op
 EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE upper(b) = 'PREFIX3';
-                          QUERY PLAN                           
----------------------------------------------------------------
- Index Scan using clstr_expression_upper_b on clstr_expression
-   Index Cond: (upper(b) = 'PREFIX3'::text)
-(2 rows)
-
+ERROR:  at or near "off": syntax error
+DETAIL:  source SQL:
+EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE upper(b) = 'PREFIX3'
+               ^
+HINT:  try \h <SELECTCLAUSE>
 SELECT * FROM clstr_expression WHERE upper(b) = 'PREFIX3';
- id | a |    b    
-----+---+---------
-  3 | 3 | prefix3
-(1 row)
-
+ERROR:  current transaction is aborted, commands ignored until end of transaction block
 EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE -a = -3 ORDER BY -a, b;
-                          QUERY PLAN                           
----------------------------------------------------------------
- Index Scan using clstr_expression_minus_a on clstr_expression
-   Index Cond: ((- a) = '-3'::integer)
-(2 rows)
-
+ERROR:  at or near "off": syntax error
+DETAIL:  source SQL:
+EXPLAIN (COSTS OFF) SELECT * FROM clstr_expression WHERE -a = -3 ORDER BY -a, b
+               ^
+HINT:  try \h <SELECTCLAUSE>
 SELECT * FROM clstr_expression WHERE -a = -3 ORDER BY -a, b;
- id  | a |     b     
------+---+-----------
- 129 | 3 | prefix129
-   3 | 3 | prefix3
-  45 | 3 | prefix45
-  87 | 3 | prefix87
-(4 rows)
-
+ERROR:  current transaction is aborted, commands ignored until end of transaction block
 COMMIT;
 -- clean up
 DROP TABLE clustertest;
@@ -664,4 +735,5 @@
 DROP TABLE clstr_3;
 DROP TABLE clstr_4;
 DROP TABLE clstr_expression;
+ERROR:  relation "clstr_expression" does not exist
 DROP USER regress_clstr_user;
