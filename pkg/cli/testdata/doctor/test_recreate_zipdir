debug doctor recreate zipdir testdata/doctor/debugzip
----
debug doctor recreate zipdir testdata/doctor/debugzip
BEGIN;
SELECT 1/(1-sign(count(*))) FROM system.descriptor WHERE id >= 52;
SELECT crdb_internal.unsafe_delete_descriptor(id, true) FROM system.descriptor WHERE id >= 50;
SELECT crdb_internal.unsafe_delete_namespace_entry("parentID", "parentSchemaID", name, id) FROM system.namespace WHERE id >= 50;
COMMIT;
BEGIN;
SELECT crdb_internal.unsafe_upsert_descriptor(50, decode('12340a0964656661756c74646210321a1d0a090a0561646d696e10020a080a04726f6f7410021204726f6f7418012200280140004a00', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(0, 0, 'defaultdb', 50, true);
SELECT crdb_internal.unsafe_upsert_descriptor(51, decode('12330a08706f73746772657310331a1d0a090a0561646d696e10020a080a04726f6f7410021204726f6f7418012200280140004a00', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(0, 0, 'postgres', 51, true);
SELECT crdb_internal.unsafe_upsert_descriptor(53, decode('0ad5040a0575736572731835203428013a0042250a02696410011a0d080e10001800300050861760002000300068007000780080010088010042270a046369747910021a0d080710001800300750930860002000300068007000780080010088010042270a046e616d6510031a0d0807100018003007509308600020013000680070007800800100880100422a0a076164647265737310041a0d0807100018003007509308600020013000680070007800800100880100422e0a0b6372656469745f6361726410051a0d0807100018003007509308600020013000680070007800800100880100480652570a077072696d617279100118012204636974792202696430023001400040004a10080010001a00200028003000380040005a007a0408002000800100880100900101980100a20106080012001800a80100b20100ba010060026a1d0a090a0561646d696e10020a080a04726f6f7410021204726f6f741801800101880103980100b2013d0a077072696d61727910001a0269641a04636974791a046e616d651a07616464726573731a0b6372656469745f63617264200120022003200420052800b80101c20100e80100f2010408001200f801008002009202009a0200aa02270836100210041802180120352a11666b5f636974795f7265665f75736572733002380040004800aa02270837100210041802180120352a11666b5f636974795f7265665f75736572733002380040004800aa0227083a100110021802180120352a11666b5f636974795f7265665f75736572733002380040004800b20200b80200c0021dc80200e00200f00200', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(52, 29, 'users', 53, true);
SELECT crdb_internal.unsafe_upsert_descriptor(54, decode('0aeb060a0876656869636c65731836203428013a0042250a02696410011a0d080e10001800300050861760002000300068007000780080010088010042270a046369747910021a0d080710001800300750930860002000300068007000780080010088010042270a047479706510031a0d0807100018003007509308600020013000680070007800800100880100422b0a086f776e65725f696410041a0d080e10001800300050861760002001300068007000780080010088010042300a0d6372656174696f6e5f74696d6510051a0d080510001800300050da0860002001300068007000780080010088010042290a0673746174757310061a0d080710001800300750930860002001300068007000780080010088010042330a1063757272656e745f6c6f636174696f6e10071a0d080710001800300750930860002001300068007000780080010088010042260a0365787410081a0d081210001800300050da1d600020013000680070007800800100880100480952570a077072696d617279100118012204636974792202696430023001400040004a10080010001a00200028003000380040005a007a0408002000800100880100900101980100a20106080012001800a80100b20100ba01005a7d0a2576656869636c65735f6175746f5f696e6465785f666b5f636974795f7265665f75736572731002180022046369747922086f776e65725f6964300230043801400040004a10080010001a00200028003000380040005a007a0408002000800100880100900101980100a20106080012001800a80100b20100ba010060036a1d0a090a0561646d696e10020a080a04726f6f7410021204726f6f741801800102880103980100b201650a077072696d61727910001a0269641a04636974791a04747970651a086f776e65725f69641a0d6372656174696f6e5f74696d651a067374617475731a1063757272656e745f6c6f636174696f6e1a03657874200120022003200420052006200720082800b80101c20100e80100f2010408001200f801008002009202009a0200a202270836100210041802180120352a11666b5f636974795f7265665f75736572733000380040004800aa02320837100310051802180120362a1c666b5f76656869636c655f636974795f7265665f76656869636c65733002380040004800b20200b80200c0021dc80200e00200f00200', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(52, 29, 'vehicles', 54, true);
SELECT crdb_internal.unsafe_upsert_descriptor(55, decode('0aeb090a0572696465731837203428013a0042250a02696410011a0d080e10001800300050861760002000300068007000780080010088010042270a046369747910021a0d0807100018003007509308600020003000680070007800800100880100422f0a0c76656869636c655f6369747910031a0d0807100018003007509308600020013000680070007800800100880100422b0a0872696465725f696410041a0d080e100018003000508617600020013000680070007800800100880100422d0a0a76656869636c655f696410051a0d080e10001800300050861760002001300068007000780080010088010042300a0d73746172745f6164647265737310061a0d0807100018003007509308600020013000680070007800800100880100422e0a0b656e645f6164647265737310071a0d0807100018003007509308600020013000680070007800800100880100422d0a0a73746172745f74696d6510081a0d080510001800300050da08600020013000680070007800800100880100422b0a08656e645f74696d6510091a0d080510001800300050da08600020013000680070007800800100880100422a0a07726576656e7565100a1a0d08031002180a300050a40d600020013000680070007800800100880100480b52570a077072696d617279100118012204636974792202696430023001400040004a10080010001a00200028003000380040005a007a0408002000800100880100900101980100a20106080012001800a80100b20100ba01005a7a0a2272696465735f6175746f5f696e6465785f666b5f636974795f7265665f757365727310021800220463697479220872696465725f6964300230043801400040004a10080010001a00200028003000380040005a007a0408002000800100880100900101980100a20106080012001800a80100b20100ba01005a91010a2d72696465735f6175746f5f696e6465785f666b5f76656869636c655f636974795f7265665f76656869636c657310031800220c76656869636c655f63697479220a76656869636c655f69643003300538023801400040004a10080010001a00200028003000380040005a007a0408002000800100880100900101980100a20106080012001800a80100b20100ba010060046a1d0a090a0561646d696e10020a080a04726f6f7410021204726f6f741801800103880103980100a201380a1376656869636c655f63697479203d20636974791217636865636b5f76656869636c655f636974795f6369747918002802280330003800b2018a010a077072696d61727910001a0269641a04636974791a0c76656869636c655f636974791a0872696465725f69641a0a76656869636c655f69641a0d73746172745f616464726573731a0b656e645f616464726573731a0a73746172745f74696d651a08656e645f74696d651a07726576656e7565200120022003200420052006200720082009200a2800b80101c20100e80100f2010408001200f801008002009202009a0200a202270837100210041802180120352a11666b5f636974795f7265665f75736572733000380040004800a202320837100310051802180120362a1c666b5f76656869636c655f636974795f7265665f76656869636c65733000380040004800aa02270838100110021802180120372a11666b5f636974795f7265665f72696465733002380040004800b20200b80200c0021dc80200e00200f00200', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(52, 29, 'rides', 55, true);
SELECT crdb_internal.unsafe_upsert_descriptor(56, decode('0aa8040a1a76656869636c655f6c6f636174696f6e5f686973746f726965731838203428013a0042270a046369747910011a0d0807100018003007509308600020003000680070007800800100880100422a0a07726964655f696410021a0d080e100018003000508617600020003000680070007800800100880100422c0a0974696d657374616d7010031a0d080510001800300050da0860002000300068007000780080010088010042260a036c617410041a0d080210401800300050bd0560002001300068007000780080010088010042270a046c6f6e6710051a0d080210401800300050bd056000200130006800700078008001008801004806526b0a077072696d617279100118012204636974792207726964655f6964220974696d657374616d703001300230034000400040004a10080010001a00200028003000380040005a007a0408002000800100880100900101980100a20106080012001800a80100b20100ba010060026a1d0a090a0561646d696e10020a080a04726f6f7410021204726f6f741801800102880103980100b2013c0a077072696d61727910001a04636974791a07726964655f69641a0974696d657374616d701a036c61741a046c6f6e67200120022003200420052800b80101c20100e80100f2010408001200f801008002009202009a0200a202270838100110021802180120372a11666b5f636974795f7265665f72696465733000380040004800b20200b80200c0021dc80200e00200f00200', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(52, 29, 'vehicle_location_histories', 56, true);
SELECT crdb_internal.unsafe_upsert_descriptor(57, decode('0afd030a0b70726f6d6f5f636f6465731839203428013a0042270a04636f646510011a0d0807100018003007509308600020003000680070007800800100880100422e0a0b6465736372697074696f6e10021a0d080710001800300750930860002001300068007000780080010088010042300a0d6372656174696f6e5f74696d6510031a0d080510001800300050da0860002001300068007000780080010088010042320a0f65787069726174696f6e5f74696d6510041a0d080510001800300050da0860002001300068007000780080010088010042280a0572756c657310051a0d081210001800300050da1d6000200130006800700078008001008801004806524f0a077072696d617279100118012204636f6465300140004a10080010001a00200028003000380040005a007a0408002000800100880100900101980100a20106080012001800a80100b20100ba010060026a1d0a090a0561646d696e10020a080a04726f6f7410021204726f6f741801800101880103980100b201510a077072696d61727910001a04636f64651a0b6465736372697074696f6e1a0d6372656174696f6e5f74696d651a0f65787069726174696f6e5f74696d651a0572756c6573200120022003200420052800b80101c20100e80100f2010408001200f801008002009202009a0200b20200b80200c0021dc80200e00200f00200', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(52, 29, 'promo_codes', 57, true);
SELECT crdb_internal.unsafe_upsert_descriptor(58, decode('0aa8040a10757365725f70726f6d6f5f636f646573183a203428013a0042270a046369747910011a0d0807100018003007509308600020003000680070007800800100880100422a0a07757365725f696410021a0d080e10001800300050861760002000300068007000780080010088010042270a04636f646510031a0d0807100018003007509308600020003000680070007800800100880100422c0a0974696d657374616d7010041a0d080510001800300050da08600020013000680070007800800100880100422d0a0b75736167655f636f756e7410051a0c08011040180030005014600020013000680070007800800100880100480652660a077072696d617279100118012204636974792207757365725f69642204636f64653001300230034000400040004a10080010001a00200028003000380040005a007a0408002000800100880100900101980100a20106080012001800a80100b20100ba010060026a1d0a090a0561646d696e10020a080a04726f6f7410021204726f6f741801800102880103980100b201440a077072696d61727910001a04636974791a07757365725f69641a04636f64651a0974696d657374616d701a0b75736167655f636f756e74200120022003200420052800b80101c20100e80100f2010408001200f801008002009202009a0200a20227083a100110021802180120352a11666b5f636974795f7265665f75736572733000380040004800b20200b80200c0021dc80200e00200f00200', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(52, 29, 'user_promo_codes', 58, true);
COMMIT;
