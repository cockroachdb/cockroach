debug doctor recreate zipdir testdata/doctor/debugzip-json
----
debug doctor recreate zipdir testdata/doctor/debugzip-json
BEGIN;
SELECT 1/(1-sign(count(*))) FROM system.descriptor WHERE id >= 104;
SELECT crdb_internal.unsafe_delete_descriptor(id, true) FROM system.descriptor WHERE id >= 100;
SELECT crdb_internal.unsafe_delete_namespace_entry("parentID", "parentSchemaID", name, id) FROM system.namespace WHERE id >= 100;
COMMIT;
BEGIN;
SELECT crdb_internal.unsafe_upsert_descriptor(100, decode('12590a0964656661756c74646210641a300a0b0a0561646d696e100218020a0d0a067075626c696310801018000a0a0a04726f6f74100218021204726f6f741802220028013a0c0a067075626c69631202086540004a005a021000', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(0, 0, 'defaultdb', 100, true);
SELECT crdb_internal.unsafe_upsert_descriptor(101, decode('2247086412067075626c6963186522310a0b0a0561646d696e100218020a0d0a067075626c696310840418000a0a0a04726f6f7410021802120561646d696e18022a00300140004a00', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(100, 0, 'public', 101, true);
SELECT crdb_internal.unsafe_upsert_descriptor(102, decode('12580a08706f73746772657310661a300a0b0a0561646d696e100218020a0d0a067075626c696310801018000a0a0a04726f6f74100218021204726f6f741802220028013a0c0a067075626c69631202086740004a005a021000', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(0, 0, 'postgres', 102, true);
SELECT crdb_internal.unsafe_upsert_descriptor(103, decode('2247086612067075626c6963186722310a0b0a0561646d696e100218020a0d0a067075626c696310840418000a0a0a04726f6f7410021802120561646d696e18022a00300140004a00', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(102, 0, 'public', 103, true);
SELECT crdb_internal.unsafe_upsert_descriptor(104, decode('12540a046d6f767210681a300a0b0a0561646d696e100218020a0d0a067075626c696310801018000a0a0a04726f6f74100218021204726f6f741802220028013a0c0a067075626c69631202086940004a005a021000', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(0, 0, 'movr', 104, true);
SELECT crdb_internal.unsafe_upsert_descriptor(105, decode('2247086812067075626c6963186922310a0b0a0561646d696e100218020a0d0a067075626c696310840418000a0a0a04726f6f7410021802120561646d696e18022a00300140004a00', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(104, 0, 'public', 105, true);
SELECT crdb_internal.unsafe_upsert_descriptor(106, decode('0ae0050a057573657273186a206828013a0042280a02696410011a0d080e100018003000508617600020003000680070007800800100880100980100422a0a046369747910021a0d0807100018003007509308600020003000680070007800800100880100980100422a0a046e616d6510031a0d0807100018003007509308600020013000680070007800800100880100980100422d0a076164647265737310041a0d080710001800300750930860002001300068007000780080010088010098010042310a0b6372656469745f6361726410051a0d08071000180030075093086000200130006800700078008001008801009801004806529a010a0a75736572735f706b657910011801220463697479220269642a046e616d652a07616464726573732a0b6372656469745f6361726430023001400040004a10080010001a00200028003000380040005a007003700470057a0408002000800100880100900104980101a20106080012001800a80100b20100ba0100c00100c801f8c2998282bfb0b317d00101e00100e901000000000000000060026a210a0b0a0561646d696e100218020a0a0a04726f6f74100218021204726f6f741802800101880103980100b2013d0a077072696d61727910001a0269641a04636974791a046e616d651a07616464726573731a0b6372656469745f63617264200120022003200420052800b80101c20100e80100f2010408001200f801008002009202009a0200aa0233086b1002100418021801206a2a1b76656869636c65735f636974795f6f776e65725f69645f666b657930003800400048007002aa0230086c1002100418021801206a2a1872696465735f636974795f72696465725f69645f666b657930003800400048007003aa023a086f1001100218021801206a2a22757365725f70726f6d6f5f636f6465735f636974795f757365725f69645f666b657930003800400048007002b20200b80200c00269c80200e00200800300880304a80300b00300d00300', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(104, 105, 'users', 106, true);
SELECT crdb_internal.unsafe_upsert_descriptor(107, decode('0ab5080a0876656869636c6573186b206828013a0042280a02696410011a0d080e100018003000508617600020003000680070007800800100880100980100422a0a046369747910021a0d0807100018003007509308600020003000680070007800800100880100980100422a0a047479706510031a0d0807100018003007509308600020013000680070007800800100880100980100422e0a086f776e65725f696410041a0d080e10001800300050861760002001300068007000780080010088010098010042330a0d6372656174696f6e5f74696d6510051a0d080510001800300050da08600020013000680070007800800100880100980100422c0a0673746174757310061a0d080710001800300750930860002001300068007000780080010088010098010042360a1063757272656e745f6c6f636174696f6e10071a0d080710001800300750930860002001300068007000780080010088010098010042290a0365787410081a0d081210001800300050da1d600020013000680070007800800100880100980100480952c5010a0d76656869636c65735f706b657910011801220463697479220269642a04747970652a086f776e65725f69642a0d6372656174696f6e5f74696d652a067374617475732a1063757272656e745f6c6f636174696f6e2a0365787430023001400040004a10080010001a00200028003000380040005a007003700470057006700770087a0408002000800100880100900104980101a20106080012001800a80100b20100ba0100c00100c801a8c1b58582bfb0b317d00101e00100e90100000000000000005a9b010a2576656869636c65735f6175746f5f696e6465785f666b5f636974795f7265665f75736572731002180022046369747922086f776e65725f6964300230043801400040004a10080010001a00200028003000380040005a007a0408002000800100880100900103980100a20106080012001800a80100b20100ba0100c00100c801a8c1b58582bfb0b317d00100e00100e901000000000000000060036a210a0b0a0561646d696e100218020a0a0a04726f6f74100218021204726f6f741802800101880103980100b201650a077072696d61727910001a0269641a04636974791a04747970651a086f776e65725f69641a0d6372656174696f6e5f74696d651a067374617475731a1063757272656e745f6c6f636174696f6e1a03657874200120022003200420052006200720082800b80101c20100e80100f2010408001200f801008002009202009a0200a20233086b1002100418021801206a2a1b76656869636c65735f636974795f6f776e65725f69645f666b657930003800400048007002aa023a086c1003100518021801206b2a2272696465735f76656869636c655f636974795f76656869636c655f69645f666b657930003800400048007004b20200b80200c00269c80200e00200800300880305a80300b00300d00300', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(104, 105, 'vehicles', 107, true);
SELECT crdb_internal.unsafe_upsert_descriptor(108, decode('0a970c0a057269646573186c206828013a0042280a02696410011a0d080e100018003000508617600020003000680070007800800100880100980100422a0a046369747910021a0d080710001800300750930860002000300068007000780080010088010098010042320a0c76656869636c655f6369747910031a0d0807100018003007509308600020013000680070007800800100880100980100422e0a0872696465725f696410041a0d080e10001800300050861760002001300068007000780080010088010098010042300a0a76656869636c655f696410051a0d080e10001800300050861760002001300068007000780080010088010098010042330a0d73746172745f6164647265737310061a0d080710001800300750930860002001300068007000780080010088010098010042310a0b656e645f6164647265737310071a0d080710001800300750930860002001300068007000780080010088010098010042300a0a73746172745f74696d6510081a0d080510001800300050da08600020013000680070007800800100880100980100422e0a08656e645f74696d6510091a0d080510001800300050da08600020013000680070007800800100880100980100422d0a07726576656e7565100a1a0d08031002180a300050a40d600020013000680070007800800100880100980100480b52e7010a0a72696465735f706b657910011801220463697479220269642a0c76656869636c655f636974792a0872696465725f69642a0a76656869636c655f69642a0d73746172745f616464726573732a0b656e645f616464726573732a0a73746172745f74696d652a08656e645f74696d652a07726576656e756530023001400040004a10080010001a00200028003000380040005a007003700470057006700770087009700a7a0408002000800100880100900104980101a20106080012001800a80100b20100ba0100c00100c80188f68d8982bfb0b317d00101e00100e90100000000000000005a98010a2272696465735f6175746f5f696e6465785f666b5f636974795f7265665f757365727310021800220463697479220872696465725f6964300230043801400040004a10080010001a00200028003000380040005a007a0408002000800100880100900103980100a20106080012001800a80100b20100ba0100c00100c80188f68d8982bfb0b317d00100e00100e90100000000000000005aaf010a2d72696465735f6175746f5f696e6465785f666b5f76656869636c655f636974795f7265665f76656869636c657310031800220c76656869636c655f63697479220a76656869636c655f69643003300538023801400040004a10080010001a00200028003000380040005a007a0408002000800100880100900103980100a20106080012001800a80100b20100ba0100c00100c80188f68d8982bfb0b317d00100e00100e901000000000000000060046a210a0b0a0561646d696e100218020a0a0a04726f6f74100218021204726f6f741802800101880103980100a2013a0a1376656869636c655f63697479203d20636974791217636865636b5f76656869636c655f636974795f63697479180128022803300038004002b2018a010a077072696d61727910001a0269641a04636974791a0c76656869636c655f636974791a0872696465725f69641a0a76656869636c655f69641a0d73746172745f616464726573731a0b656e645f616464726573731a0a73746172745f74696d651a08656e645f74696d651a07726576656e7565200120022003200420052006200720082009200a2800b80101c20100e80100f2010408001200f801008002009202009a0200a20230086c1002100418021801206a2a1872696465735f636974795f72696465725f69645f666b657930003800400048007003a2023a086c1003100518021801206b2a2272696465735f76656869636c655f636974795f76656869636c655f69645f666b657930003800400048007004aa0244086d1001100218021801206c2a2c76656869636c655f6c6f636174696f6e5f686973746f726965735f636974795f726964655f69645f666b657930003800400048007002b20200b80200c00269c80200e00200800300880305a80300b00300d00300', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(104, 105, 'rides', 108, true);
SELECT crdb_internal.unsafe_upsert_descriptor(109, decode('0aaa050a1a76656869636c655f6c6f636174696f6e5f686973746f72696573186d206828013a00422a0a046369747910011a0d0807100018003007509308600020003000680070007800800100880100980100422d0a07726964655f696410021a0d080e100018003000508617600020003000680070007800800100880100980100422f0a0974696d657374616d7010031a0d080510001800300050da0860002000300068007000780080010088010098010042290a036c617410041a0d080210401800300050bd05600020013000680070007800800100880100980100422a0a046c6f6e6710051a0d080210401800300050bd05600020013000680070007800800100880100980100480652b0010a1f76656869636c655f6c6f636174696f6e5f686973746f726965735f706b6579100118012204636974792207726964655f6964220974696d657374616d702a036c61742a046c6f6e673001300230034000400040004a10080010001a00200028003000380040005a00700470057a0408002000800100880100900104980101a20106080012001800a80100b20100ba0100c00100c8018094eb8c82bfb0b317d00101e00100e901000000000000000060026a210a0b0a0561646d696e100218020a0a0a04726f6f74100218021204726f6f741802800101880103980100b2013c0a077072696d61727910001a04636974791a07726964655f69641a0974696d657374616d701a036c61741a046c6f6e67200120022003200420052800b80101c20100e80100f2010408001200f801008002009202009a0200a20244086d1001100218021801206c2a2c76656869636c655f6c6f636174696f6e5f686973746f726965735f636974795f726964655f69645f666b657930003800400048007002b20200b80200c00269c80200e00200800300880303a80300b00300d00300', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(104, 105, 'vehicle_location_histories', 109, true);
SELECT crdb_internal.unsafe_upsert_descriptor(110, decode('0a80050a0b70726f6d6f5f636f646573186e206828013a00422a0a04636f646510011a0d080710001800300750930860002000300068007000780080010088010098010042310a0b6465736372697074696f6e10021a0d080710001800300750930860002001300068007000780080010088010098010042330a0d6372656174696f6e5f74696d6510031a0d080510001800300050da0860002001300068007000780080010088010098010042350a0f65787069726174696f6e5f74696d6510041a0d080510001800300050da08600020013000680070007800800100880100980100422b0a0572756c657310051a0d081210001800300050da1d600020013000680070007800800100880100980100480652b2010a1070726f6d6f5f636f6465735f706b6579100118012204636f64652a0b6465736372697074696f6e2a0d6372656174696f6e5f74696d652a0f65787069726174696f6e5f74696d652a0572756c6573300140004a10080010001a00200028003000380040005a0070027003700470057a0408002000800100880100900104980101a20106080012001800a80100b20100ba0100c00100c801a8df8a9082bfb0b317d00101e00100e901000000000000000060026a210a0b0a0561646d696e100218020a0a0a04726f6f74100218021204726f6f741802800101880103980100b201510a077072696d61727910001a04636f64651a0b6465736372697074696f6e1a0d6372656174696f6e5f74696d651a0f65787069726174696f6e5f74696d651a0572756c6573200120022003200420052800b80101c20100e80100f2010408001200f801008002009202009a0200b20200b80200c00269c80200e00200800300880302a80300b00300d00300', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(104, 105, 'promo_codes', 110, true);
SELECT crdb_internal.unsafe_upsert_descriptor(111, decode('0aa3050a10757365725f70726f6d6f5f636f646573186f206828013a00422a0a046369747910011a0d0807100018003007509308600020003000680070007800800100880100980100422d0a07757365725f696410021a0d080e100018003000508617600020003000680070007800800100880100980100422a0a04636f646510031a0d0807100018003007509308600020003000680070007800800100880100980100422f0a0974696d657374616d7010041a0d080510001800300050da0860002001300068007000780080010088010098010042300a0b75736167655f636f756e7410051a0c08011040180030005014600020013000680070007800800100880100980100480652ae010a15757365725f70726f6d6f5f636f6465735f706b6579100118012204636974792207757365725f69642204636f64652a0974696d657374616d702a0b75736167655f636f756e743001300230034000400040004a10080010001a00200028003000380040005a00700470057a0408002000800100880100900104980101a20106080012001800a80100b20100ba0100c00100c80190d1b29382bfb0b317d00101e00100e901000000000000000060026a210a0b0a0561646d696e100218020a0a0a04726f6f74100218021204726f6f741802800101880103980100b201440a077072696d61727910001a04636974791a07757365725f69641a04636f64651a0974696d657374616d701a0b75736167655f636f756e74200120022003200420052800b80101c20100e80100f2010408001200f801008002009202009a0200a2023a086f1001100218021801206a2a22757365725f70726f6d6f5f636f6465735f636974795f757365725f69645f666b657930003800400048007002b20200b80200c00269c80200e00200800300880303a80300b00300d00300', 'hex'), true);
SELECT crdb_internal.unsafe_upsert_namespace_entry(104, 105, 'user_promo_codes', 111, true);
COMMIT;
