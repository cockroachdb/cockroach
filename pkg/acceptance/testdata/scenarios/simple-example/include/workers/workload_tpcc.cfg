role worker
  :prepare  $COCKROACH workload init tpcc \\
  			--drop --db db$node --pprofport $pprof \\
			--warehouses=5 \\
			$(cat ../$node/pgurl) >>start.log 2>&1
  :start	$COCKROACH workload run tpcc --db db$node --pprofport $pprof \\
  			--ramp=10s --warehouses=5 --active-warehouses=2 --duration=15m --split --scatter \\
			--wait-fraction=.01 \\
		    --display-every=2s --display-format=incremental-json --tolerate-errors \\
			$(cat ../$node/pgurl) \\
			& echo $!>wpid
  :stop     kill $(cat wpid) && sleep 1 && kill -9 $(cat wpid) || true; rm -f start.log
  cleanup	if test -e wpid; then kill $(cat wpid) && sleep 1 && kill -9 $(cat wpid) || true; fi; touch start.log
  # Note: we need to "touch" the file prior to looking because
  # otherwise "tail" may wait too long to detect the first output.
  spotlight touch start.log; tail -F start.log
  signal	errors delta at      .*"time":"(?P<ts_rfc3339>)".*"errs":(?P<delta>[^,]*),.*newOrder.*
  signal	throughput scalar at .*"time":"(?P<ts_rfc3339>)".*"avgt":(?P<scalar>[^,]*),.*newOrder.*
  signal	lat50 scalar at      .*"time":"(?P<ts_rfc3339>)".*"p50l":(?P<scalar>[^,]*),.*newOrder.*
  signal	lat95 scalar at      .*"time":"(?P<ts_rfc3339>)".*"p95l":(?P<scalar>[^,]*),.*newOrder.*
  signal	lat99 scalar at      .*"time":"(?P<ts_rfc3339>)".*"p99l":(?P<scalar>[^,]*),.*newOrder.*
  signal import event at [IWEF](?P<ts_log>)\s+\d+\s+(?P<event>.*dataload.*imported.*)$
  signal error event at (?P<ts_now>)(?P<event>[eE]rror:.*)
end
