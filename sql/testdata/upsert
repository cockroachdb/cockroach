statement ok
CREATE TABLE abcd (
  a INT,
  b INT,
  c INT,
  d INT,
  PRIMARY KEY (a, b),
  INDEX y (c),
  UNIQUE INDEX z (d)
)

statement error missing "b" primary key column
UPSERT INTO abcd (a, c) VALUES (1, 1)

statement error missing "a" primary key column
UPSERT INTO abcd (b, c) VALUES (1, 1)

statement error RETURNING is not supported with UPSERT
UPSERT INTO abcd VALUES (1, 1, 1, 1) RETURNING *

statement ok
UPSERT INTO abcd VALUES (1, 1, 1, 1)

statement ok
UPSERT INTO abcd VALUES (2, 2, 2, 2)

statement ok
UPSERT INTO abcd VALUES (1, 2, 3, 3), (1, 1, 5, 5), (6, 6, 6, 6)

query IIII
SELECT * FROM abcd ORDER BY (a, b)
----
1 1 5 5
1 2 3 3
2 2 2 2
6 6 6 6

statement ok
UPSERT INTO abcd VALUES (1, 1, 3, 1)

statement ok
UPSERT INTO abcd (a, b, d) VALUES (2, 2, 4)

query IIII
SELECT * FROM abcd ORDER BY (a, b)
----
1 1 3 1
1 2 3 3
2 2 2 4
6 6 6 6

query IIII
SELECT * FROM abcd@z WHERE d=4
----
2 2 2 4
